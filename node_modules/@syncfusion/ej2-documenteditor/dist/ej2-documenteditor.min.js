/*!
*  filename: ej2-documenteditor.min.js
*  version : 28.2.12
*  Copyright Syncfusion Inc. 2001 - 2024. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionNavigations"),require("SyncfusionCompression"),require("SyncfusionPopups"),require("SyncfusionButtons"),require("SyncfusionLists"),require("SyncfusionInputs"),require("SyncfusionDropdowns"),require("SyncfusionCalendars"),require("SyncfusionSplitbuttons"),require("SyncfusionData"),require("SyncfusionOfficeChart"),require("SyncfusionFileUtils")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionNavigations","SyncfusionCompression","SyncfusionPopups","SyncfusionButtons","SyncfusionLists","SyncfusionInputs","SyncfusionDropdowns","SyncfusionCalendars","SyncfusionSplitbuttons","SyncfusionData","SyncfusionOfficeChart","SyncfusionFileUtils"],t):"object"==typeof exports?exports.SyncfusionDocumenteditor=t(require("SyncfusionBase"),require("SyncfusionNavigations"),require("SyncfusionCompression"),require("SyncfusionPopups"),require("SyncfusionButtons"),require("SyncfusionLists"),require("SyncfusionInputs"),require("SyncfusionDropdowns"),require("SyncfusionCalendars"),require("SyncfusionSplitbuttons"),require("SyncfusionData"),require("SyncfusionOfficeChart"),require("SyncfusionFileUtils")):e.SyncfusionDocumenteditor=t(e.SyncfusionBase,e.SyncfusionNavigations,e.SyncfusionCompression,e.SyncfusionPopups,e.SyncfusionButtons,e.SyncfusionLists,e.SyncfusionInputs,e.SyncfusionDropdowns,e.SyncfusionCalendars,e.SyncfusionSplitbuttons,e.SyncfusionData,e.SyncfusionOfficeChart,e.SyncfusionFileUtils)}(self,((e,t,i,n,r,o,s,a,l,d,h,c,p)=>(()=>{"use strict";var u={766:t=>{t.exports=e},741:e=>{e.exports=r},570:e=>{e.exports=l},50:e=>{e.exports=i},74:e=>{e.exports=h},778:e=>{e.exports=a},115:e=>{e.exports=p},323:e=>{e.exports=s},90:e=>{e.exports=o},215:e=>{e.exports=t},35:e=>{e.exports=c},197:e=>{e.exports=n},295:e=>{e.exports=d}},g={};function m(e){var t=g[e];if(void 0!==t)return t.exports;var i=g[e]={exports:{}};return u[e](i,i.exports,m),i.exports}m.d=(e,t)=>{for(var i in t)m.o(t,i)&&!m.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var f={};return(()=>{var e,t,i,n;m.r(f),m.d(f,{AddUserDialog:()=>nl,AutoResizeSettings:()=>xp,Base64:()=>Ta,BaseHistoryInfo:()=>wc,BlockContainer:()=>Wl,BlockWidget:()=>Ll,BodyWidget:()=>Ol,BookmarkDialog:()=>Mh,BookmarkElementBox:()=>td,BordersAndShadingDialog:()=>Jh,BreakElementBox:()=>zd,BulletsAndNumberingDialog:()=>Kh,CONTROL_CHARACTERS:()=>o,CellFormatHistoryInfo:()=>vc,CellHistoryFormat:()=>yc,CellOptionsDialog:()=>Qh,ChangesSingleView:()=>gl,CharacterRangeType:()=>e,ChartArea:()=>wd,ChartCategory:()=>bd,ChartCategoryAxis:()=>Wd,ChartData:()=>Cd,ChartDataFormat:()=>Hd,ChartDataLabels:()=>Pd,ChartDataTable:()=>Od,ChartElementBox:()=>yd,ChartErrorBar:()=>kd,ChartFill:()=>Ed,ChartLayout:()=>Nd,ChartLegend:()=>xd,ChartSeries:()=>Id,ChartSeriesFormat:()=>Fd,ChartTitleArea:()=>Td,ChartTrendLines:()=>Sd,CheckBoxFormField:()=>Kl,CheckBoxFormFieldDialog:()=>tc,CheckBoxState:()=>od,CollaborativeEditing:()=>Ec,CollaborativeEditingHandler:()=>ap,CollaborativeEditingSettings:()=>Pp,ColumnLayout:()=>Pl,ColumnSizeInfo:()=>Ad,ColumnsDialog:()=>oc,Comment:()=>s,CommentCharacterElementBox:()=>Bd,CommentEditInfo:()=>Ud,CommentElementBox:()=>Ld,CommentPane:()=>Bh,CommentReviewPane:()=>Oh,CommentView:()=>Lh,ContainerServerActionSettings:()=>Sp,ContentControl:()=>id,ContentControlListItems:()=>rd,ContentControlProperties:()=>nd,ContextMenu:()=>Wh,CustomXmlPart:()=>ad,Dictionary:()=>l,DocumentEditor:()=>Ip,DocumentEditorContainer:()=>Nu,DocumentEditorSettings:()=>bp,DocumentHelper:()=>xl,DocumentSettings:()=>Cp,DropDownFormField:()=>Xl,DropDownFormFieldDialog:()=>nc,EditRangeEndElementBox:()=>fd,EditRangeStartElementBox:()=>vd,Editor:()=>Pc,EditorHistory:()=>xc,ElementBox:()=>ql,EnforceProtectionDialog:()=>ol,ErrorTextElementBox:()=>Ql,FieldElementBox:()=>_l,FieldTextElementBox:()=>$l,FillFormat:()=>ud,FontDialog:()=>Xh,FontScheme:()=>fl,FontSchemeStruct:()=>vl,FontScriptType:()=>t,FootNoteWidget:()=>Dl,Footnote:()=>Jl,FootnoteElementBox:()=>Yl,FootnoteEndnoteMarkerElementBox:()=>_d,FormField:()=>jl,FormFieldPopUp:()=>hl,FormFieldSettings:()=>Fp,HeaderFooterWidget:()=>Bl,HelperMethods:()=>Pa,HistoryInfo:()=>Cc,HtmlExport:()=>Jc,Hyperlink:()=>dc,HyperlinkDialog:()=>Dh,ImageElementBox:()=>gd,ImageResizer:()=>Sc,ImageResizingPoints:()=>Tc,ImageSizeInfo:()=>hc,Layout:()=>_a,LayoutViewer:()=>Il,LineFormat:()=>pd,LineWidget:()=>zl,ListDialog:()=>_h,ListTextElementBox:()=>md,LocaleId:()=>i,MajorMinorFontScheme:()=>ml,Margin:()=>El,MentionDataEditInfo:()=>Vd,ModifiedLevel:()=>cc,ModifiedParagraphFormat:()=>pc,Optimized:()=>$c,OptionsPane:()=>Mc,Padding:()=>Hl,Page:()=>Dd,PageLayoutViewer:()=>kl,PageSetupDialog:()=>Uh,ParagraphDialog:()=>Vh,ParagraphWidget:()=>Rl,Point:()=>Sa,Print:()=>pa,Rect:()=>Tl,Regular:()=>ep,Renderer:()=>Qa,RestrictEditing:()=>ll,Revision:()=>xa,RevisionCollection:()=>Ia,RowFormatHistoryInfo:()=>fc,RowHistoryFormat:()=>uc,Search:()=>Rc,SearchWidgetInfo:()=>Oc,SectionBreakType:()=>n,SelectedImageInfo:()=>Hc,Selection:()=>Yc,SelectionBorder:()=>Uc,SelectionBorders:()=>Vc,SelectionCellFormat:()=>Gc,SelectionCharacterFormat:()=>Ac,SelectionColumnFormat:()=>Zc,SelectionHeaderFooter:()=>qc,SelectionImageFormat:()=>Xc,SelectionParagraphFormat:()=>zc,SelectionRowFormat:()=>Kc,SelectionSectionFormat:()=>_c,SelectionTableFormat:()=>jc,SelectionWidgetInfo:()=>lc,ServerActionSettings:()=>kp,SfdtExport:()=>sp,SfdtReader:()=>ip,ShapeBase:()=>dd,ShapeCommon:()=>ld,ShapeElementBox:()=>hd,SpellCheckDialog:()=>ec,SpellChecker:()=>Qc,StyleDialog:()=>Gh,StylesDialog:()=>$h,TabDialog:()=>sc,TabElementBox:()=>ed,TabStopListInfo:()=>qd,TableCellWidget:()=>Vl,TableDialog:()=>Rh,TableFormatHistoryInfo:()=>mc,TableHistoryInfo:()=>gc,TableOfContentsDialog:()=>Ah,TableOptionsDialog:()=>Yh,TablePosition:()=>Ml,TablePropertiesDialog:()=>Zh,TableResizer:()=>Ic,TableRowWidget:()=>Ul,TableWidget:()=>Al,TextElementBox:()=>Zl,TextExport:()=>op,TextFormField:()=>Gl,TextFormFieldDialog:()=>ic,TextFrame:()=>cd,TextHelper:()=>za,TextPosition:()=>ac,TextSearch:()=>Wc,TextSearchResult:()=>Bc,TextSearchResults:()=>Lc,Themes:()=>yl,Toolbar:()=>bu,TrackChangesPane:()=>ul,UnProtectDocumentDialog:()=>sl,WAbstractList:()=>Aa,WBorder:()=>fa,WBorders:()=>va,WCellFormat:()=>Ma,WCharacterFormat:()=>ka,WCharacterStyle:()=>Oa,WColumn:()=>Md,WColumnFormat:()=>ma,WLevelOverride:()=>Ua,WList:()=>zh,WListFormat:()=>ya,WListLevel:()=>Va,WParagraphFormat:()=>ba,WParagraphStyle:()=>Wa,WRowFormat:()=>Ca,WSectionFormat:()=>ga,WShading:()=>Da,WStyle:()=>Na,WStyles:()=>La,WTabStop:()=>wa,WTableFormat:()=>Ra,WTableHolder:()=>Rd,WTableStyle:()=>Ba,WUniqueFormat:()=>d,WUniqueFormats:()=>h,WebLayoutViewer:()=>Fl,Widget:()=>Nl,WordExport:()=>rp,WrapPosition:()=>Ha,XmlHttpRequestHandler:()=>c,XmlMapping:()=>sd,XmlPane:()=>Nc,Zoom:()=>$a,abstractListIdProperty:()=>ls,abstractListsProperty:()=>oe,actionCompleteEvent:()=>R,afterFieldFillEvent:()=>b,afterFormFieldFillEvent:()=>C,afterSpacingProperty:()=>yt,afterWidthProperty:()=>hi,aftercontentControlFillEvent:()=>H,alignTablesRowByRowProperty:()=>ke,allCapsProperty:()=>rt,allowAutoFitProperty:()=>vi,allowBreakAcrossPagesProperty:()=>si,allowOverlapProperty:()=>Do,allowSpaceOfSameStyleInTableProperty:()=>Ys,alternativeTextProperty:()=>Mn,appearanceProperty:()=>Zs,authorProperty:()=>Ar,autoShapeTypeProperty:()=>nr,backgroundColorProperty:()=>Fi,backgroundProperty:()=>se,backwardProperty:()=>Qi,basedOnProperty:()=>Oe,baselineAlignmentProperty:()=>_e,bdoProperty:()=>Qe,beforeAutoResize:()=>J,beforeCommentActionEvent:()=>W,beforeFieldFillEvent:()=>w,beforeFileOpenEvent:()=>z,beforeFormFieldFillEvent:()=>x,beforePaneSwitchEvent:()=>L,beforeSpacingProperty:()=>wt,beforeWidthProperty:()=>di,beforeXmlHttpRequestSend:()=>_,beforecontentControlFillEvent:()=>T,belowTextProperty:()=>Un,bidiProperty:()=>Ye,blocksProperty:()=>Go,boldBidiProperty:()=>it,boldProperty:()=>Ae,bookmarkTypeProperty:()=>fs,bordersProperty:()=>Et,bottomMarginProperty:()=>Vt,bottomProperty:()=>gr,breakClearTypeProperty:()=>$e,breakCodeProperty:()=>ti,categoryTypeProperty:()=>xn,categoryXNameProperty:()=>Ai,cellFormatProperty:()=>So,cellSpacingProperty:()=>yi,cellWidthProperty:()=>ii,cellsProperty:()=>Ho,characterFormatProperty:()=>ie,characterSpacingProperty:()=>ct,chartAreaProperty:()=>Fn,chartCategoryProperty:()=>In,chartDataProperty:()=>Mi,chartDataTableProperty:()=>Ln,chartLegendProperty:()=>Tn,chartPrimaryCategoryAxisProperty:()=>Hn,chartPrimaryValueAxisProperty:()=>En,chartSeriesProperty:()=>kn,chartTitleAreaProperty:()=>Pn,chartTitleProperty:()=>Nn,chartTypeProperty:()=>Wn,checkBoxProperty:()=>Sr,checkedProperty:()=>Br,checkedStateProperty:()=>go,colorProperty:()=>or,columnCountProperty:()=>la,columnFirstProperty:()=>ks,columnIndexProperty:()=>ia,columnLastProperty:()=>Fs,columnSpanProperty:()=>ni,columnsProperty:()=>Yt,commentBeginEvent:()=>E,commentCharacterTypeProperty:()=>Mr,commentDeleteEvent:()=>O,commentEndEvent:()=>N,commentIdProperty:()=>Rr,commentsProperty:()=>le,compatibilityModeProperty:()=>He,complexScriptProperty:()=>ot,contentChangeEvent:()=>u,contentControlEvent:()=>S,contentControlListItemsProperty:()=>mo,contentControlPropertiesProperty:()=>$r,contextualSpacingProperty:()=>Ht,continuationNoticeProperty:()=>ms,continuationSeparatorProperty:()=>gs,cryptAlgorithmClassProperty:()=>we,cryptAlgorithmSidProperty:()=>Ce,cryptAlgorithmTypeProperty:()=>be,cryptProviderTypeProperty:()=>ye,cryptSpinCountProperty:()=>xe,customContextMenuBeforeOpenEvent:()=>P,customContextMenuSelectEvent:()=>F,customMarkerProperty:()=>Yr,customXmlPartProperty:()=>Fo,customXmlProperty:()=>he,dataFormatProperty:()=>Di,dataLabelProperty:()=>rn,dataPointsProperty:()=>ln,dateCalendarTypeProperty:()=>ao,dateDisplayFormatProperty:()=>co,dateDisplayLocaleProperty:()=>ho,dateProperty:()=>Vr,dateStorageFormatProperty:()=>lo,defaultFont:()=>X,defaultTabWidthProperty:()=>ce,defaultValueProperty:()=>Er,deletePositionProperty:()=>bs,descriptionProperty:()=>No,diagonalDownProperty:()=>Wi,diagonalUpProperty:()=>Ni,differentFirstPageProperty:()=>Bt,differentOddAndEvenPagesProperty:()=>Lt,directionProperty:()=>ji,displayTextProperty:()=>wo,distanceBottomProperty:()=>Uo,distanceLeftProperty:()=>Ao,distanceRightProperty:()=>Mo,distanceTopProperty:()=>Ro,doNotUseHTMLParagraphAutoSpacingProperty:()=>Ie,documentChangeEvent:()=>g,documentLoadFailedEvent:()=>$,doneProperty:()=>zr,dropDownItemsProperty:()=>Lr,dropDownListProperty:()=>Tr,editRangeIdProperty:()=>Is,editableRangeStartProperty:()=>Ts,editingPointsProperty:()=>ca,enabledProperty:()=>Ir,endStyleProperty:()=>Gi,endnoteNumberFormatProperty:()=>_t,endnotesProperty:()=>Te,enforcementProperty:()=>me,equalWidthProperty:()=>$t,errorBarProperty:()=>on,evenFooterProperty:()=>Jo,evenHeaderProperty:()=>Zo,fieldTypeProperty:()=>Cr,fillFormatProperty:()=>Kn,fillProperty:()=>sr,firstLineIndentProperty:()=>ft,firstPageFooterProperty:()=>Qo,firstPageHeaderProperty:()=>Yo,firstSliceAngleProperty:()=>dn,followCharacterProperty:()=>is,fontColorProperty:()=>Xe,fontFamilyAsciiProperty:()=>st,fontFamilyBidiProperty:()=>tt,fontFamilyFarEastProperty:()=>at,fontFamilyNonFarEastProperty:()=>lt,fontFamilyProperty:()=>Ze,fontHintTypeProperty:()=>qe,fontNameProperty:()=>ea,fontProperty:()=>vo,fontSchemeListProperty:()=>Bs,fontSchemeNameProperty:()=>Ns,fontSchemeProperty:()=>Es,fontSizeBidiProperty:()=>et,fontSizeProperty:()=>Ke,fontSubstitutionTableProperty:()=>te,fontTypefaceProperty:()=>Ls,footNoteNumberFormatProperty:()=>jt,footerDistanceProperty:()=>Ot,footerProperty:()=>Xo,footnoteTypeProperty:()=>Xr,footnotesProperty:()=>Se,foreColorProperty:()=>Vi,foregroundColorProperty:()=>Pi,formFieldDataProperty:()=>br,formFieldShadingProperty:()=>Fe,formatProperty:()=>Nr,formattingProperty:()=>pe,forwardProperty:()=>Yi,gapWidthProperty:()=>On,getImageHeightProperty:()=>vr,getImageWidthProperty:()=>yr,gridAfterProperty:()=>gi,gridAfterWidthProperty:()=>mi,gridAfterWidthTypeProperty:()=>fi,gridBeforeProperty:()=>ci,gridBeforeWidthProperty:()=>pi,gridBeforeWidthTypeProperty:()=>ui,gridProperty:()=>aa,groupProperty:()=>Ss,hasBordersProperty:()=>Cn,hasFieldEndProperty:()=>wr,hasHorizontalBorderProperty:()=>wn,hasMajorGridLinesProperty:()=>qs,hasMinorGridLinesProperty:()=>_s,hasNoneStyleProperty:()=>Ti,hasPlaceHolderTextProperty:()=>ro,hasVerticalBorderProperty:()=>bn,hashValueProperty:()=>fe,headerDistanceProperty:()=>Wt,headerProperty:()=>Ko,headersFootersProperty:()=>$o,heightProperty:()=>qn,heightRelativePercentProperty:()=>Qn,heightScaleProperty:()=>jn,heightTypeProperty:()=>li,helpTextProperty:()=>kr,highlightColorProperty:()=>Ge,holeSizeProperty:()=>hn,horizontalAlignmentProperty:()=>_o,horizontalOriginProperty:()=>qo,horizontalPositionAbsProperty:()=>Ii,horizontalPositionProperty:()=>jo,horizontalProperty:()=>Ei,horizontalRelativePercentProperty:()=>Yn,horizontalRuleProperty:()=>Vn,idProperty:()=>Po,imageStringProperty:()=>lr,imagesProperty:()=>na,incrementalOps:()=>ha,initialEndNoteNumberProperty:()=>Zt,initialFootNoteNumberProperty:()=>Xt,initialProperty:()=>Ur,inlineFormatProperty:()=>$s,inlinesProperty:()=>Qr,interceptProperty:()=>$i,internalAutoResize:()=>Z,internalDocumentEditorSettingsChange:()=>G,internalOptionPaneChange:()=>Q,internalStyleCollectionChange:()=>K,internalZoomFactorChange:()=>p,internalviewChangeEvent:()=>q,isAfterCellMarkProperty:()=>oa,isAfterParagraphMarkProperty:()=>ra,isAfterRowMarkProperty:()=>sa,isAfterTableMarkProperty:()=>da,isAutoMajorProperty:()=>Us,isBubbleSizeProperty:()=>pn,isCategoryNameProperty:()=>un,isCheckedProperty:()=>po,isCompressedProperty:()=>ta,isCreatedUsingHtmlSpanTagProperty:()=>xr,isDisplayEquationProperty:()=>tn,isDisplayRSquaredProperty:()=>en,isHeaderProperty:()=>ai,isInlineImageProperty:()=>cr,isLeaderLinesProperty:()=>vn,isLegalStyleNumberingProperty:()=>Oo,isLegendKeyProperty:()=>cn,isMappedProperty:()=>bo,isMetaFileProperty:()=>pr,isPercentageProperty:()=>fn,isSeriesNameProperty:()=>gn,isTemporaryProperty:()=>so,isValueProperty:()=>mn,isWordMlProperty:()=>Co,italicBidiProperty:()=>nt,italicProperty:()=>Ue,itemIDProperty:()=>Gr,keepLinesTogetherProperty:()=>St,keepWithNextProperty:()=>Ft,keyDownEvent:()=>U,lastParagraphMarkCopiedProperty:()=>Pe,layoutInCellProperty:()=>tr,layoutProperty:()=>Li,layoutXProperty:()=>qi,layoutYProperty:()=>_i,leaderProperty:()=>Cs,leftIndentProperty:()=>gt,leftMarginProperty:()=>Mt,leftProperty:()=>fr,lengthProperty:()=>hr,levelNumberProperty:()=>os,levelOverridesProperty:()=>ps,levelsProperty:()=>hs,lineBetweenColumnsProperty:()=>ei,lineFormatProperty:()=>Gn,lineFormatTypeProperty:()=>Js,lineProperty:()=>Ui,lineSpacingProperty:()=>xt,lineSpacingTypeProperty:()=>It,lineStyleProperty:()=>Oi,lineWidthProperty:()=>Bi,linkProperty:()=>Le,listFormatProperty:()=>kt,listIdProperty:()=>ht,listLevelNumberProperty:()=>ut,listLevelPatternProperty:()=>ts,listsProperty:()=>re,localeIdBidiProperty:()=>Me,localeIdFarEastProperty:()=>Re,localeIdProperty:()=>De,lockAnchorProperty:()=>ir,lockContentControlProperty:()=>eo,lockContentsProperty:()=>to,majorFontSchemeProperty:()=>Ws,majorTickMarkProperty:()=>js,majorUnitProperty:()=>As,markerColorProperty:()=>Zi,markerSizeProperty:()=>Ji,markerStyleProperty:()=>Xi,maxLengthProperty:()=>Hr,maximumValueProperty:()=>Vs,metaFileImageStringProperty:()=>dr,minimumValueProperty:()=>zs,minorFontSchemeProperty:()=>Os,minorTickMarkProperty:()=>Gs,multiLineProperty:()=>oo,nameProperty:()=>We,nextProperty:()=>Be,nsidProperty:()=>ds,numberFormatProperty:()=>ss,numberOfColumnsProperty:()=>Qt,numberValueProperty:()=>Ki,outlineLevelProperty:()=>Tt,overlapProperty:()=>Bn,overrideListLevelProperty:()=>cs,pageHeightProperty:()=>Rt,pageNumberStyleProperty:()=>Jt,pageStartingNumberProperty:()=>qt,pageWidthProperty:()=>Dt,panoseProperty:()=>Rs,paraStyleNameProperty:()=>as,paragraphFormatProperty:()=>ne,patternProperty:()=>zi,plotAreaProperty:()=>Sn,positionProperty:()=>ws,positioningProperty:()=>Bo,preferredWidthProperty:()=>Ci,preferredWidthTypeProperty:()=>xi,prefixMappingProperty:()=>xo,propertiesProperty:()=>vs,protectionTypeChangeEvent:()=>j,protectionTypeProperty:()=>ge,replyCommentsProperty:()=>qr,requestNavigateEvent:()=>D,restartIndexForEndnotesProperty:()=>Kt,restartIndexForFootnotesProperty:()=>Gt,restartLevelProperty:()=>rs,restartPageNumberingProperty:()=>zt,revisionActionEvent:()=>B,revisionIdProperty:()=>jr,revisionIdsProperty:()=>dt,revisionTypeProperty:()=>_r,revisionsProperty:()=>de,rgbProperty:()=>Xs,rightIndentProperty:()=>mt,rightMarginProperty:()=>At,rightProperty:()=>mr,rowFormatProperty:()=>To,rowSpanProperty:()=>ri,rowsProperty:()=>Eo,saltValueProperty:()=>ve,scalingProperty:()=>pt,searchResultsChangeEvent:()=>A,sectionFormatProperty:()=>es,sectionsProperty:()=>ee,selectedIndexProperty:()=>Dr,selectionChangeEvent:()=>v,separatorProperty:()=>us,seriesFormatProperty:()=>sn,seriesNameProperty:()=>nn,serviceFailureEvent:()=>I,shadingProperty:()=>wi,shadowProperty:()=>Si,shapeIdProperty:()=>Rn,showSeriesKeysProperty:()=>yn,sizeProperty:()=>Or,sizeTypeProperty:()=>Wr,spaceAfterAutoProperty:()=>bt,spaceBeforeAutoProperty:()=>Ct,spaceProperty:()=>Hs,startAtProperty:()=>ns,statusTextProperty:()=>Fr,storeItemIdProperty:()=>ko,strikethroughProperty:()=>je,styleNameProperty:()=>Je,stylesProperty:()=>ae,symbolCodeProperty:()=>Zr,symbolFontNameProperty:()=>Jr,tabJustificationProperty:()=>ys,tabLeaderProperty:()=>xs,tableAlignmentProperty:()=>bi,tableFormatProperty:()=>Lo,tabsProperty:()=>Nt,tagProperty:()=>io,textAlignmentProperty:()=>vt,textFrameProperty:()=>rr,textInputProperty:()=>Pr,textProperty:()=>Dn,textVerticalAlignmentProperty:()=>ar,textWrappingStyleProperty:()=>Xn,textWrappingTypeProperty:()=>Zn,textureProperty:()=>ki,themeFontLanguagesProperty:()=>Ee,themesProperty:()=>Ne,tickLabelPositionProperty:()=>Ks,titleProperty:()=>no,toolbarClickEvent:()=>V,topMarginProperty:()=>Ut,topProperty:()=>ur,trackChangeEvent:()=>M,trackChanges:()=>Y,trackChangesProperty:()=>ue,trendLinesProperty:()=>an,typeProperty:()=>Ms,typefaceProperty:()=>Ds,uncheckedStateProperty:()=>uo,underlineColorProperty:()=>ze,underlineProperty:()=>Ve,userProperty:()=>Ps,valueProperty:()=>yo,verticalAlignmentProperty:()=>oi,verticalOriginProperty:()=>Vo,verticalPositionProperty:()=>zo,verticalProperty:()=>Hi,verticalRelativePercentProperty:()=>Jn,viewChangeEvent:()=>k,visibleProperty:()=>An,weightProperty:()=>Qs,widowControlProperty:()=>Pt,widthProperty:()=>zn,widthRelativePercentProperty:()=>$n,widthScaleProperty:()=>_n,wrapTextAroundProperty:()=>Wo,xPathProperty:()=>Io,xmlMappingProperty:()=>fo,xmlProperty:()=>Kr,yValueProperty:()=>Ri,zOrderPositionProperty:()=>er,zoomFactorChangeEvent:()=>y}),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.WordSplit=2]="WordSplit",e[e.Number=4]="Number",e[e.Tab=6]="Tab"}(e||(e={})),function(e){e[e.English=0]="English",e[e.Hindi=1]="Hindi",e[e.Korean=2]="Korean",e[e.Chinese=3]="Chinese",e[e.Arabic=4]="Arabic",e[e.Hebrew=5]="Hebrew",e[e.Japanese=6]="Japanese",e[e.Thai=7]="Thai",e[e.SpecialCharacter=8]="SpecialCharacter"}(t||(t={})),function(e){e[e.af_ZA=1078]="af_ZA",e[e.sq_AL=1052]="sq_AL",e[e.am_ET=1118]="am_ET",e[e.gsw_FR=1156]="gsw_FR",e[e.ar_DZ=5121]="ar_DZ",e[e.ar_BH=15361]="ar_BH",e[e.ar_EG=3073]="ar_EG",e[e.ar_IQ=2049]="ar_IQ",e[e.ar_JO=11265]="ar_JO",e[e.ar_KW=13313]="ar_KW",e[e.ar_LB=12289]="ar_LB",e[e.ar_LY=4097]="ar_LY",e[e.ar_MA=6145]="ar_MA",e[e.ar_OM=8193]="ar_OM",e[e.ar_QA=16385]="ar_QA",e[e.ar_SA=1025]="ar_SA",e[e.ar_SY=10241]="ar_SY",e[e.ar_TN=7169]="ar_TN",e[e.ar_AE=14337]="ar_AE",e[e.ar_YE=9217]="ar_YE",e[e.hy_AM=1067]="hy_AM",e[e.as_IN=1101]="as_IN",e[e.az_Cyrl_AZ=2092]="az_Cyrl_AZ",e[e.az_Latn_AZ=1068]="az_Latn_AZ",e[e.ba_RU=1133]="ba_RU",e[e.eu_ES=1069]="eu_ES",e[e.be_BY=1059]="be_BY",e[e.bn_BD=2117]="bn_BD",e[e.bn_IN=1093]="bn_IN",e[e.bs_Cyrl_BA=8218]="bs_Cyrl_BA",e[e.bs_Latn_BA=5146]="bs_Latn_BA",e[e.bg_BG=1026]="bg_BG",e[e.br_FR=1150]="br_FR",e[e.my_MM=1109]="my_MM",e[e.ca_ES=1027]="ca_ES",e[e.chr_US=1116]="chr_US",e[e.zh_HK=3076]="zh_HK",e[e.zh_MO=5124]="zh_MO",e[e.zh_CN=2052]="zh_CN",e[e.zh_SG=4100]="zh_SG",e[e.zh_TW=1028]="zh_TW",e[e.co_FR=1155]="co_FR",e[e.hr_BA=4122]="hr_BA",e[e.hr_HR=1050]="hr_HR",e[e.cs_CZ=1029]="cs_CZ",e[e.da_DK=1030]="da_DK",e[e.prs_AF=1164]="prs_AF",e[e.dv_MV=1125]="dv_MV",e[e.nl_BE=2067]="nl_BE",e[e.nl_NL=1043]="nl_NL",e[e.bin_NG=1126]="bin_NG",e[e.et_EE=1061]="et_EE",e[e.en_AU=3081]="en_AU",e[e.en_BZ=10249]="en_BZ",e[e.en_CA=4105]="en_CA",e[e.en_029=9225]="en_029",e[e.en_HK=15369]="en_HK",e[e.en_IN=16393]="en_IN",e[e.en_ID=14345]="en_ID",e[e.en_IE=6153]="en_IE",e[e.en_JM=8201]="en_JM",e[e.en_MY=17417]="en_MY",e[e.en_NZ=5129]="en_NZ",e[e.en_PH=13321]="en_PH",e[e.en_SG=18441]="en_SG",e[e.en_ZA=7177]="en_ZA",e[e.en_TT=11273]="en_TT",e[e.en_GB=2057]="en_GB",e[e.en_US=1033]="en_US",e[e.en_ZW=12297]="en_ZW",e[e.fo_FO=1080]="fo_FO",e[e.fil_PH=1124]="fil_PH",e[e.fi_FI=1035]="fi_FI",e[e.fr_BE=2060]="fr_BE",e[e.fr_CM=11276]="fr_CM",e[e.fr_CA=3084]="fr_CA",e[e.fr_CD=9228]="fr_CD",e[e.fr_CI=12300]="fr_CI",e[e.fr_FR=1036]="fr_FR",e[e.fr_HT=15372]="fr_HT",e[e.fr_LU=5132]="fr_LU",e[e.fr_ML=13324]="fr_ML",e[e.fr_MC=6156]="fr_MC",e[e.fr_MA=14348]="fr_MA",e[e.fr_RE=8204]="fr_RE",e[e.fr_SN=10252]="fr_SN",e[e.fr_CH=4108]="fr_CH",e[e.fy_NL=1122]="fy_NL",e[e.ff_NG=1127]="ff_NG",e[e.gd_GB=1084]="gd_GB",e[e.gl_ES=1110]="gl_ES",e[e.ka_GE=1079]="ka_GE",e[e.de_AT=3079]="de_AT",e[e.de_DE=1031]="de_DE",e[e.de_LI=5127]="de_LI",e[e.de_LU=4103]="de_LU",e[e.de_CH=2055]="de_CH",e[e.el_GR=1032]="el_GR",e[e.gn_PY=1140]="gn_PY",e[e.gu_IN=1095]="gu_IN",e[e.kl_GL=1135]="kl_GL",e[e.ha_Latn_NG=1128]="ha_Latn_NG",e[e.haw_US=1141]="haw_US",e[e.he_IL=1037]="he_IL",e[e.hi_IN=1081]="hi_IN",e[e.hu_HU=1038]="hu_HU",e[e.ibb_NG=1129]="ibb_NG",e[e.is_IS=1039]="is_IS",e[e.ig_NG=1136]="ig_NG",e[e.id_ID=1057]="id_ID",e[e.iu_Latn_CA=2141]="iu_Latn_CA",e[e.iu_Cans_CA=1117]="iu_Cans_CA",e[e.it_IT=1040]="it_IT",e[e.it_CH=2064]="it_CH",e[e.ga_IE=2108]="ga_IE",e[e.xh_ZA=1076]="xh_ZA",e[e.zu_ZA=1077]="zu_ZA",e[e.kn_IN=1099]="kn_IN",e[e.kr_NG=1137]="kr_NG",e[e.ks_Deva=2144]="ks_Deva",e[e.ks_Arab=1120]="ks_Arab",e[e.kk_KZ=1087]="kk_KZ",e[e.km_KH=1107]="km_KH",e[e.kok_IN=1111]="kok_IN",e[e.ko_KR=1042]="ko_KR",e[e.ky_KG=1088]="ky_KG",e[e.qut_GT=1158]="qut_GT",e[e.rw_RW=1159]="rw_RW",e[e.lo_LA=1108]="lo_LA",e[e.la_Latn=1142]="la_Latn",e[e.lv_LV=1062]="lv_LV",e[e.lt_LT=1063]="lt_LT",e[e.dsb_DE=2094]="dsb_DE",e[e.lb_LU=1134]="lb_LU",e[e.mk_MK=1071]="mk_MK",e[e.ms_BN=2110]="ms_BN",e[e.ms_MY=1086]="ms_MY",e[e.ml_IN=1100]="ml_IN",e[e.mt_MT=1082]="mt_MT",e[e.mni_IN=1112]="mni_IN",e[e.mi_NZ=1153]="mi_NZ",e[e.mr_IN=1102]="mr_IN",e[e.arn_CL=1146]="arn_CL",e[e.mn_MN=1104]="mn_MN",e[e.mn_Mong_CN=2128]="mn_Mong_CN",e[e.ne_NP=1121]="ne_NP",e[e.ne_IN=2145]="ne_IN",e[e.nb_NO=1044]="nb_NO",e[e.nn_NO=2068]="nn_NO",e[e.oc_FR=1154]="oc_FR",e[e.or_IN=1096]="or_IN",e[e.om_Ethi_ET=1138]="om_Ethi_ET",e[e.pap_AN=1145]="pap_AN",e[e.ps_AF=1123]="ps_AF",e[e.fa_IR=1065]="fa_IR",e[e.pl_PL=1045]="pl_PL",e[e.pt_BR=1046]="pt_BR",e[e.pt_PT=2070]="pt_PT",e[e.pa_IN=1094]="pa_IN",e[e.pa_PK=2118]="pa_PK",e[e.quz_BO=1131]="quz_BO",e[e.guz_EC=2155]="guz_EC",e[e.guz_PE=3179]="guz_PE",e[e.ro_RO=1048]="ro_RO",e[e.ro_MO=2072]="ro_MO",e[e.rm_CH=1047]="rm_CH",e[e.ru_RU=1049]="ru_RU",e[e.ru_MO=2073]="ru_MO",e[e.smn_FI=9275]="smn_FI",e[e.smj_NO=4155]="smj_NO",e[e.smj_SE=5179]="smj_SE",e[e.se_FI=3131]="se_FI",e[e.se_NO=1083]="se_NO",e[e.se_SE=2107]="se_SE",e[e.sms_FI=8251]="sms_FI",e[e.sma_NO=6203]="sma_NO",e[e.sma_SE=7227]="sma_SE",e[e.sa_IN=1103]="sa_IN",e[e.sr_Cyrl_BA=7194]="sr_Cyrl_BA",e[e.sr_Cyrl_CS=3098]="sr_Cyrl_CS",e[e.sr_Latn_BA=6170]="sr_Latn_BA",e[e.sr_Latn_CS=2074]="sr_Latn_CS",e[e.nso_ZA=1132]="nso_ZA",e[e.tn_ZA=1074]="tn_ZA",e[e.sd_Arab_PK=2137]="sd_Arab_PK",e[e.sd_Deva_IN=1113]="sd_Deva_IN",e[e.si_LK=1115]="si_LK",e[e.sk_SK=1051]="sk_SK",e[e.sl_SI=1060]="sl_SI",e[e.so_SO=1143]="so_SO",e[e.es_AR=11274]="es_AR",e[e.es_BO=16394]="es_BO",e[e.es_CL=13322]="es_CL",e[e.es_CO=9226]="es_CO",e[e.es_CR=5130]="es_CR",e[e.es_DO=7178]="es_DO",e[e.es_EC=12298]="es_EC",e[e.es_SV=17418]="es_SV",e[e.es_GT=4106]="es_GT",e[e.es_HN=18442]="es_HN",e[e.es_MX=2058]="es_MX",e[e.es_NI=19466]="es_NI",e[e.es_PA=6154]="es_PA",e[e.es_PY=15370]="es_PY",e[e.es_PE=10250]="es_PE",e[e.es_PR=20490]="es_PR",e[e.es_ES=3082]="es_ES",e[e.es_ES_tradnl=1034]="es_ES_tradnl",e[e.es_US=21514]="es_US",e[e.es_UY=14346]="es_UY",e[e.es_VE=8202]="es_VE",e[e.st_ZA=1072]="st_ZA",e[e.sw_KE=1089]="sw_KE",e[e.sv_FI=2077]="sv_FI",e[e.sv_SE=1053]="sv_SE",e[e.syr_SY=1114]="syr_SY",e[e.tg_Cyrl_TJ=1064]="tg_Cyrl_TJ",e[e.tzm_Arab_MA=1119]="tzm_Arab_MA",e[e.tzm_Latn_DZ=2143]="tzm_Latn_DZ",e[e.ta_IN=1097]="ta_IN",e[e.tt_RU=1092]="tt_RU",e[e.te_IN=1098]="te_IN",e[e.th_TH=1054]="th_TH",e[e.bo_CN=1105]="bo_CN",e[e.ti_ER=2163]="ti_ER",e[e.ti_ET=1139]="ti_ET",e[e.ts_ZA=1073]="ts_ZA",e[e.tr_TR=1055]="tr_TR",e[e.tk_TM=1090]="tk_TM",e[e.ug_CN=1152]="ug_CN",e[e.uk_UA=1058]="uk_UA",e[e.hsb_DE=1070]="hsb_DE",e[e.ur_PK=1056]="ur_PK",e[e.uz_Cyrl_UZ=2115]="uz_Cyrl_UZ",e[e.uz_Latn_UZ=1091]="uz_Latn_UZ",e[e.ve_ZA=1075]="ve_ZA",e[e.vi_VN=1066]="vi_VN",e[e.cy_GB=1106]="cy_GB",e[e.wo_SN=1160]="wo_SN",e[e.sah_RU=1157]="sah_RU",e[e.ii_CN=1144]="ii_CN",e[e.yi_Hebr=1085]="yi_Hebr",e[e.yo_NG=1130]="yo_NG",e[e.ja_JP=1041]="ja_JP"}(i||(i={})),function(e){e.EvenPage="EvenPage",e.NewPage="NewPage",e.Continuous="NoBreak",e.OddPage="OddPage"}(n||(n={}));var r,o={Tab:"\t",Paragraph:"\n",LineBreak:"\v",PageBreak:"\f",ColumnBreak:"",Image:"",Table:"",Row:"",Cell:"",Marker_Start:"",Marker_End:"",Field_Separator:"",Section_Break:""},s=function(e,t,i){this.id=e,this.commentProperties=t,this.text=i},a=m(766),l=function(){function e(){this.keysInternal=[],this.valuesInternal=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.valuesInternal},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){if((0,a.isNullOrUndefined)(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(t)),1},e.prototype.get=function(e){if((0,a.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return t<0||t>this.keysInternal.length-1?void 0:this.valuesInternal[t]},e.prototype.set=function(e,t){if((0,a.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[i]=t},e.prototype.remove=function(e){if((0,a.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);if(t<0||t>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(t,1),this.valuesInternal.splice(t,1),!0},e.prototype.containsKey=function(e){if((0,a.isNullOrUndefined)(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return!(t<0||t>this.keysInternal.length-1)},e.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},e.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},e}(),d=function(){function e(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new l}return e.prototype.isEqual=function(e,t,i){var n=!1;switch(this.uniqueFormatType){case 1:n=this.isBorderEqual(e,t,i);break;case 2:n=this.isCharacterFormatEqual(e,t,i);break;case 3:n=this.isParagraphFormatEqual(e,t,i);break;case 4:n=this.isCellFormatEqual(e,t,i);break;case 5:n=this.isShadingEqual(e,t,i);break;case 6:n=this.isRowFormatEqual(e,t,i);break;case 7:n=this.isListFormatEqual(e,t,i);break;case 8:n=this.isTableFormatEqual(e,t,i);break;case 9:n=this.isListLevelEqual(e,t,i);break;case 10:n=this.isSectionFormatEqual(e,t,i);break;case 11:n=this.isColumnFormatEqual(e,t,i)}return n},e.prototype.isNotEqual=function(t,i,n,r,o){var s=void 0,l=e.getPropertyType(o,t);this.propertiesHash.containsKey(l)&&(s=this.propertiesHash.get(l));var d=void 0;return t===n?d=r:i.containsKey(l)&&(d=i.get(l)),!(s===d||!(0,a.isNullOrUndefined)(s)&&!(0,a.isNullOrUndefined)(d)&&s===d)},e.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t);break;case 11:i=this.getColumnFormatType(t)}return i},e.getRowFormatType=function(e){switch(e){case"allowBreakAcrossPages":return 1;case"isHeader":return 2;case"height":return 3;case"heightType":return 4;case"gridBefore":return 5;case"gridBeforeWidth":return 6;case"gridBeforeWidthType":return 7;case"gridAfter":return 8;case"gridAfterWidth":return 9;case"gridAfterWidthType":return 10;case"leftMargin":return 11;case"topMargin":return 12;case"bottomMargin":return 13;case"rightMargin":return 14;case"leftIndent":return 15;default:return 0}},e.getListFormatType=function(e){switch(e){case"listId":return 1;case"listLevelNumber":return 2;case"nsid":return 3;default:return 0}},e.getTableFormatType=function(e){switch(e){case"leftMargin":return 1;case"rightMargin":return 2;case"topMargin":return 3;case"bottomMargin":return 4;case"cellSpacing":return 5;case"leftIndent":return 6;case"tableAlignment":return 7;case"preferredWidth":return 8;case"preferredWidthType":return 9;case"bidi":return 10;case"allowAutoFit":return 11;case"horizontalPositionAbs":return 12;case"horizontalPosition":return 13;default:return 0}},e.getListLevelType=function(e){switch(e){case"listLevelPattern":return 1;case"startAt":return 2;case"followCharacter":return 3;case"numberFormat":return 4;case"restartLevel":return 5;case"isLegalStyleNumbering":return 6;case"paraStyleName":return 7;default:return 0}},e.getShadingPropertyType=function(e){switch(e){case"backgroundColor":return 1;case"foregroundColor":return 2;case"textureStyle":return 3;default:return 0}},e.getCellFormatPropertyType=function(e){switch(e){case"leftMargin":return 1;case"rightMargin":return 2;case"topMargin":return 3;case"bottomMargin":return 4;case"columnSpan":return 5;case"rowSpan":return 6;case"verticalAlignment":return 7;case"preferredWidthType":return 8;case"preferredWidth":return 9;case"cellWidth":return 10;default:return 0}},e.getBorderPropertyType=function(e){switch(e){case"color":return 1;case"lineStyle":return 2;case"lineWidth":return 3;case"shadow":return 4;case"space":return 5;case"hasNoneStyle":return 6;default:return 0}},e.getCharacterFormatPropertyType=function(e){switch(e){case"fontColor":return 1;case"fontFamily":return 2;case"fontSize":return 3;case"bold":return 4;case"italic":return 5;case"underline":return 6;case"strikethrough":return 7;case"baselineAlignment":return 8;case"highlightColor":return 9;case"bidi":return 10;case"bdo":return 11;case"boldBidi":return 12;case"italicBidi":return 13;case"fontFamilyBidi":return 14;case"fontSizeBidi":return 15;case"allCaps":return 16;case"localeIdBidi":return 17;case"complexScript":return 18;case"fontFamilyFarEast":return 19;case"fontFamilyAscii":return 20;case"fontFamilyNonFarEast":return 21;case"localeIdAscii":return 22;case"localeIdFarEast":return 23;case"characterSpacing":return 24;case"scaling":return 25;case"underlineColor":return 27;case"fontHintType":return 28;default:return 0}},e.getParaFormatPropertyType=function(e){switch(e){case"leftIndent":return 1;case"rightIndent":return 2;case"firstLineIndent":return 3;case"textAlignment":return 4;case"beforeSpacing":return 5;case"afterSpacing":return 6;case"lineSpacing":return 7;case"lineSpacingType":return 8;case"outlineLevel":return 9;case"bidi":return 10;case"contextualSpacing":return 11;case"keepWithNext":return 12;case"keepLinesTogether":return 13;case"widowControl":return 14;case"spaceBeforeAuto":return 15;case"spaceAfterAuto":return 16;default:return 0}},e.getColumnFormatType=function(e){switch(e){case"width":return 1;case"space":return 2;default:return 0}},e.getSectionFormatType=function(e){switch(e){case"headerDistance":return 1;case"footerDistance":return 2;case"differentFirstPage":return 3;case"differentOddAndEvenPages":return 4;case"pageWidth":return 5;case"pageHeight":return 6;case"leftMargin":return 7;case"topMargin":return 8;case"rightMargin":return 9;case"bottomMargin":return 10;case"bidi":return 11;case"restartPageNumbering":return 12;case"pageStartingNumber":return 13;case"endnoteNumberFormat":return 14;case"endnotePosition":return 15;case"footNoteNumberFormat":return 16;case"footnotePosition":return 17;case"restartIndexForEndnotes":return 18;case"restartIndexForFootnotes":return 19;case"initialFootNoteNumber":return 20;case"initialEndNoteNumber":return 21;case"pageNumberStyle":return 22;case"numberOfColumns":return 23;case"equalWidth":return 24;case"lineBetweenColumns":return 25;case"columns":return 26;case"breakCode":return 27;default:return 0}},e.prototype.isBorderEqual=function(e,t,i){return!this.isNotEqual("color",e,t,i,1)&&(!this.isNotEqual("lineStyle",e,t,i,1)&&(!this.isNotEqual("lineWidth",e,t,i,1)&&(!this.isNotEqual("shadow",e,t,i,1)&&(!this.isNotEqual("space",e,t,i,1)&&!this.isNotEqual("hasNoneStyle",e,t,i,1)))))},e.prototype.isCharacterFormatEqual=function(e,t,i){return!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamily",e,t,i,2)&&(!this.isNotEqual("fontSize",e,t,i,2)&&(!this.isNotEqual("bold",e,t,i,2)&&(!this.isNotEqual("italic",e,t,i,2)&&(!this.isNotEqual("underline",e,t,i,2)&&(!this.isNotEqual("strikethrough",e,t,i,2)&&(!this.isNotEqual("baselineAlignment",e,t,i,2)&&(!this.isNotEqual("highlightColor",e,t,i,2)&&(!this.isNotEqual("bidi",e,t,i,2)&&(!this.isNotEqual("bdo",e,t,i,2)&&(!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamilyBidi",e,t,i,2)&&(!this.isNotEqual("fontSizeBidi",e,t,i,2)&&(!this.isNotEqual("boldBidi",e,t,i,2)&&(!this.isNotEqual("italicBidi",e,t,i,2)&&(!this.isNotEqual("allCaps",e,t,i,2)&&(!this.isNotEqual("localeIdBidi",e,t,i,2)&&(!this.isNotEqual("localeIdAscii",e,t,i,2)&&(!this.isNotEqual("localeIdFarEast",e,t,i,2)&&(!this.isNotEqual("complexScript",e,t,i,2)&&(!this.isNotEqual("fontFamilyFarEast",e,t,i,2)&&(!this.isNotEqual("fontFamilyAscii",e,t,i,2)&&(!this.isNotEqual("fontFamilyNonFarEast",e,t,i,2)&&(!this.isNotEqual("characterSpacing",e,t,i,2)&&(!this.isNotEqual("scaling",e,t,i,2)&&(!this.isNotEqual("underlineColor",e,t,i,2)&&!this.isNotEqual("fontHintType",e,t,i,2)))))))))))))))))))))))))))},e.prototype.isParagraphFormatEqual=function(e,t,i){return!this.isNotEqual("leftIndent",e,t,i,3)&&(!this.isNotEqual("rightIndent",e,t,i,3)&&(!this.isNotEqual("firstLineIndent",e,t,i,3)&&(!this.isNotEqual("textAlignment",e,t,i,3)&&(!this.isNotEqual("beforeSpacing",e,t,i,3)&&(!this.isNotEqual("afterSpacing",e,t,i,3)&&(!this.isNotEqual("spaceBeforeAuto",e,t,i,3)&&(!this.isNotEqual("spaceAfterAuto",e,t,i,3)&&(!this.isNotEqual("lineSpacing",e,t,i,3)&&(!this.isNotEqual("lineSpacingType",e,t,i,3)&&(!this.isNotEqual("outlineLevel",e,t,i,3)&&(!this.isNotEqual("bidi",e,t,i,3)&&(!this.isNotEqual("contextualSpacing",e,t,i,3)&&(!this.isNotEqual("keepWithNext",e,t,i,3)&&(!this.isNotEqual("keepLinesTogether",e,t,i,3)&&!this.isNotEqual("widowControl",e,t,i,3)))))))))))))))},e.prototype.isCellFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,4)&&(!this.isNotEqual("rightMargin",e,t,i,4)&&(!this.isNotEqual("topMargin",e,t,i,4)&&(!this.isNotEqual("bottomMargin",e,t,i,4)&&(!this.isNotEqual("columnSpan",e,t,i,4)&&(!this.isNotEqual("rowSpan",e,t,i,4)&&(!this.isNotEqual("verticalAlignment",e,t,i,4)&&(!this.isNotEqual("preferredWidthType",e,t,i,4)&&(!this.isNotEqual("preferredWidth",e,t,i,4)&&!this.isNotEqual("cellWidth",e,t,i,4)))))))))},e.prototype.isShadingEqual=function(e,t,i){return!this.isNotEqual("backgroundColor",e,t,i,5)&&(!this.isNotEqual("foregroundColor",e,t,i,5)&&!this.isNotEqual("textureStyle",e,t,i,5))},e.prototype.isRowFormatEqual=function(e,t,i){return!this.isNotEqual("allowBreakAcrossPages",e,t,i,6)&&(!this.isNotEqual("isHeader",e,t,i,6)&&(!this.isNotEqual("height",e,t,i,6)&&(!this.isNotEqual("heightType",e,t,i,6)&&(!this.isNotEqual("gridBefore",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidth",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidthType",e,t,i,6)&&(!this.isNotEqual("gridAfter",e,t,i,6)&&(!this.isNotEqual("gridAfterWidth",e,t,i,6)&&(!this.isNotEqual("gridAfterWidthType",e,t,i,6)&&(!this.isNotEqual("leftMargin",e,t,i,6)&&(!this.isNotEqual("topMargin",e,t,i,6)&&(!this.isNotEqual("bottomMargin",e,t,i,6)&&(!this.isNotEqual("rightMargin",e,t,i,6)&&!this.isNotEqual("leftIndent",e,t,i,6))))))))))))))},e.prototype.isListFormatEqual=function(e,t,i){return!this.isNotEqual("listId",e,t,i,7)&&(!this.isNotEqual("listLevelNumber",e,t,i,7)&&!this.isNotEqual("nsid",e,t,i,7))},e.prototype.isTableFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,8)&&(!this.isNotEqual("rightMargin",e,t,i,8)&&(!this.isNotEqual("topMargin",e,t,i,8)&&(!this.isNotEqual("bottomMargin",e,t,i,8)&&(!this.isNotEqual("cellSpacing",e,t,i,8)&&(!this.isNotEqual("leftIndent",e,t,i,8)&&(!this.isNotEqual("tableAlignment",e,t,i,8)&&(!this.isNotEqual("preferredWidth",e,t,i,8)&&(!this.isNotEqual("preferredWidthType",e,t,i,8)&&(!this.isNotEqual("bidi",e,t,i,8)&&(!this.isNotEqual("allowAutoFit",e,t,i,8)&&(!this.isNotEqual("horizontalPositionAbs",e,t,i,8)&&!this.isNotEqual("horizontalPosition",e,t,i,8))))))))))))},e.prototype.isListLevelEqual=function(e,t,i){return!this.isNotEqual("listLevelPattern",e,t,i,9)&&(!this.isNotEqual("startAt",e,t,i,9)&&(!this.isNotEqual("followCharacter",e,t,i,9)&&(!this.isNotEqual("numberFormat",e,t,i,9)&&(!this.isNotEqual("paraStyleName",e,t,i,9)&&(!this.isNotEqual("restartLevel",e,t,i,9)&&!this.isNotEqual("isLegalStyleNumbering",e,t,i,9))))))},e.prototype.isSectionFormatEqual=function(e,t,i){return!this.isNotEqual("headerDistance",e,t,i,10)&&(!this.isNotEqual("footerDistance",e,t,i,10)&&(!this.isNotEqual("differentFirstPage",e,t,i,10)&&(!this.isNotEqual("differentOddAndEvenPages",e,t,i,10)&&(!this.isNotEqual("pageWidth",e,t,i,10)&&(!this.isNotEqual("pageHeight",e,t,i,10)&&(!this.isNotEqual("leftMargin",e,t,i,10)&&(!this.isNotEqual("topMargin",e,t,i,10)&&(!this.isNotEqual("rightMargin",e,t,i,10)&&(!this.isNotEqual("bottomMargin",e,t,i,10)&&(!this.isNotEqual("bidi",e,t,i,10)&&(!this.isNotEqual("restartPageNumbering",e,t,i,10)&&(!this.isNotEqual("pageStartingNumber",e,t,i,10)&&(!this.isNotEqual("endnoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("endnotePosition",e,t,i,10)&&(!this.isNotEqual("footNoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("footnotePosition",e,t,i,10)&&(!this.isNotEqual("restartIndexForEndnotes",e,t,i,10)&&(!this.isNotEqual("restartIndexForFootnotes",e,t,i,10)&&(!this.isNotEqual("initialFootNoteNumber",e,t,i,10)&&(!this.isNotEqual("initialEndNoteNumber",e,t,i,10)&&(!this.isNotEqual("pageNumberStyle",e,t,i,10)&&(!this.isNotEqual("numberOfColumns",e,t,i,10)&&(!this.isNotEqual("equalWidth",e,t,i,10)&&(!this.isNotEqual("lineBetweenColumns",e,t,i,10)&&!this.isNotEqual("breakCode",e,t,i,10)))))))))))))))))))))))))},e.prototype.isColumnFormatEqual=function(e,t,i){return!this.isNotEqual("width",e,t,i,11)&&!this.isNotEqual("space",e,t,i,11)},e.prototype.cloneItems=function(t,i,n,r){for(var o=e.getPropertyType(r,i),s=t.propertiesHash.keys,a=0;a<s.length;a++)s[a]===o?this.propertiesHash.add(o,n):this.propertiesHash.add(s[a],t.propertiesHash.get(s[a]));t.propertiesHash.containsKey(o)||this.propertiesHash.add(o,n)},e.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,n=0;n<i.length;n++)t.containsKey(i[n])||t.add(i[n],this.propertiesHash.get(i[n]));return t},e.prototype.cloneProperties=function(){for(var e=new l,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0},e}(),h=function(){function e(){this.items=[]}return e.prototype.addUniqueFormat=function(e,t){for(var i=void 0,n=0;n<this.items.length;n++)if(this.items[n].isEqual(e,void 0,void 0)){i=this.items[n];break}return(0,a.isNullOrUndefined)(i)?((i=new d(t)).propertiesHash=e,i.referenceCount=1,this.items.push(i)):i.referenceCount++,i},e.prototype.updateUniqueFormat=function(e,t,i){for(var n=void 0,r=0;r<this.items.length;r++)if(this.items[r].isEqual(e.propertiesHash,t,i)){n=this.items[r];break}return(0,a.isNullOrUndefined)(n)?((n=new d(e.uniqueFormatType)).cloneItems(e,t,i,e.uniqueFormatType),n.referenceCount=1,this.items.push(n)):n.referenceCount++,this.remove(e),n},e.prototype.remove=function(e){e.referenceCount--,e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy(),e=void 0)},e.prototype.clear=function(){if((0,a.isNullOrUndefined)(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},e.prototype.destroy=function(){this.clear(),this.items=void 0},e}(),c=function(){function e(){this.mode=!0}return e.prototype.send=function(e,t,i){var n=this;this.xmlHttpRequest=new XMLHttpRequest;var r=0;i=!!(0,a.isNullOrUndefined)(i)||i,(0,a.isNullOrUndefined)(t)||(this.xmlHttpRequest.withCredentials=t.withCredentials,r=t.timeout>=0?t.timeout:0,this.customHeaders=t.headers),this.xmlHttpRequest.onreadystatechange=function(){n.stateChange(n)},this.xmlHttpRequest.onerror=function(){n.error(n)},this.mode?this.sendRequest(e,r,i):setTimeout((function(){n.sendRequest(e,r,i)}))},e.prototype.sendRequest=function(e,t,i){this.xmlHttpRequest.open("POST",this.url,i),i&&(this.xmlHttpRequest.timeout=t),this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType),this.setCustomAjaxHeaders(),this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);var n=e instanceof FormData?e:JSON.stringify(e);this.xmlHttpRequest.send(n)},e.prototype.stateChange=function(e){if(4===e.xmlHttpRequest.readyState&&200===e.xmlHttpRequest.status){var t={name:"onSuccess",data:this.responseType?e.xmlHttpRequest.response:e.xmlHttpRequest.responseText,readyState:e.xmlHttpRequest.readyState,status:e.xmlHttpRequest.status};e.successHandler(t)}else if(4===e.xmlHttpRequest.readyState&&200!==e.xmlHttpRequest.status){t={name:"onFailure",status:e.xmlHttpRequest.status,statusText:e.xmlHttpRequest.statusText,url:e.url};e.failureHandler(t)}},e.prototype.error=function(e){var t={name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText};e.errorHandler(t)},e.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e),e},e.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(e),e},e.prototype.errorHandler=function(e){return this.onError&&this.onError(e),e},e.prototype.setCustomAjaxHeaders=function(){for(var e=0;e<this.customHeaders.length;e++)for(var t=this.customHeaders[e],i=0,n=Object.keys(t);i<n.length;i++){var r=n[i];this.xmlHttpRequest.setRequestHeader(r,t[r])}},e}(),p="internalZoomFactorChange",u="contentChange",g="documentChange",v="selectionChange",y="zoomFactorChange",w="beforeFieldFill",b="afterFieldFill",C="afterFormFieldFill",x="beforeFormFieldFill",I="serviceFailure",k="viewChange",F="customContextMenuSelect",P="customContextMenuBeforeOpen",S="contentControl",T="beforeContentControlFill",H="afterContentControlFill",E="commentBegin",N="commentEnd",W="beforeCommentAction",O="commentDelete",B="beforeAcceptRejectChanges",L="beforePaneSwitch",D="requestNavigate",R="actionComplete",M="trackChange",A="searchResultsChange",U="keyDown",V="toolbarClick",z="beforeFileOpen",q="internalviewChange",_="beforeXmlHttpRequestSend",j="protectionTypeChange",G="internalDocumentEditorSettingsChange",K="internalStyleCollectionChange",X="Times New Roman",Z="internalAutoResize",J="beforeAutoResize",Y="trackChanges",Q="internalOptionPaneChange",$="documentLoadFailed",ee=["sections","sec"],te=["fontSubstitutionTable","fst"],ie=["characterFormat","cf"],ne=["paragraphFormat","pf"],re=["lists","li"],oe=["abstractLists","al"],se=["background","bg"],ae=["styles","sty"],le=["comments","cm"],de=["revisions","r"],he=["customXml","cx"],ce=["defaultTabWidth","dtw"],pe=["formatting","fmt"],ue=["trackChanges","tc"],ge=["protectionType","pt"],me=["enforcement","enf"],fe=["hashValue","hv"],ve=["saltValue","sv"],ye=["cryptProviderType","cpt"],we=["cryptAlgorithmClass","cac"],be=["cryptAlgorithmType","cat"],Ce=["cryptAlgorithmSid","cas"],xe=["cryptSpinCount","csc"],Ie=["dontUseHTMLParagraphAutoSpacing","dhtml"],ke=["alignTablesRowByRow","atrr"],Fe=["formFieldShading","ffs"],Pe=["lastParagraphMarkCopied","lpmc"],Se=["footnotes","fn"],Te=["endnotes","en"],He=["compatibilityMode","comp"],Ee=["themeFontLanguages","tfl"],Ne=["themes","thm"],We=["name","n"],Oe=["basedOn","b"],Be=["next","nx"],Le=["link","l"],De=["localeId","id"],Re=["localeIdFarEast","idfe"],Me=["localeIdBidi","idbi"],Ae=["bold","b"],Ue=["italic","i"],Ve=["underline","u"],ze=["underlineColor","uc"],qe=["fontHintType","fht"],_e=["baselineAlignment","ba"],je=["strikethrough","st"],Ge=["highlightColor","hc"],Ke=["fontSize","fsz"],Xe=["fontColor","fc"],Ze=["fontFamily","ff"],Je=["styleName","stn"],Ye=["bidi","bi"],Qe=["bdo","bdo"],$e=["breakClearType","bct"],et=["fontSizeBidi","fszbi"],tt=["fontFamilyBidi","ffbi"],it=["boldBidi","bbi"],nt=["italicBidi","ibi"],rt=["allCaps","ac"],ot=["complexScript","cs"],st=["fontFamilyAscii","ffa"],at=["fontFamilyFarEast","fffe"],lt=["fontFamilyNonFarEast","ffnfe"],dt=["revisionIds","rids"],ht=["listId","lid"],ct=["characterSpacing","csp"],pt=["scaling","sc"],ut=["listLevelNumber","lilno"],gt=["leftIndent","lin"],mt=["rightIndent","rin"],ft=["firstLineIndent","fin"],vt=["textAlignment","ta"],yt=["afterSpacing","as"],wt=["beforeSpacing","bs"],bt=["spaceAfterAuto","saa"],Ct=["spaceBeforeAuto","sba"],xt=["lineSpacing","ls"],It=["lineSpacingType","lst"],kt=["listFormat","lif"],Ft=["keepWithNext","kwn"],Pt=["widowControl","wc"],St=["keepLinesTogether","klt"],Tt=["outlineLevel","ol"],Ht=["contextualSpacing","cs"],Et=["borders","bdrs"],Nt=["tabs","tb"],Wt=["headerDistance","hd"],Ot=["footerDistance","fd"],Bt=["differentFirstPage","dfp"],Lt=["differentOddAndEvenPages","doep"],Dt=["pageWidth","pw"],Rt=["pageHeight","ph"],Mt=["leftMargin","lm"],At=["rightMargin","rm"],Ut=["topMargin","tm"],Vt=["bottomMargin","bm"],zt=["restartPageNumbering","rpn"],qt=["pageStartingNumber","psn"],_t=["endnoteNumberFormat","enf"],jt=["footNoteNumberFormat","fnf"],Gt=["restartIndexForFootnotes","rif"],Kt=["restartIndexForEndnotes","rie"],Xt=["initialFootNoteNumber","ifn"],Zt=["initialEndNoteNumber","ien"],Jt=["pageNumberStyle","pgns"],Yt=["columns","cols"],Qt=["numberOfColumns","ncols"],$t=["equalWidth","eqw"],ei=["lineBetweenColumns","lbtc"],ti=["breakCode","bc"],ii=["cellWidth","cw"],ni=["columnSpan","colsp"],ri=["rowSpan","rwsp"],oi=["verticalAlignment","va"],si=["allowBreakAcrossPages","abrk"],ai=["isHeader","hdr"],li=["heightType","ht"],di=["beforeWidth","bw"],hi=["afterWidth","aw"],ci=["gridBefore","gb"],pi=["gridBeforeWidth","gbw"],ui=["gridBeforeWidthType","gbwt"],gi=["gridAfter","ga"],mi=["gridAfterWidth","gaw"],fi=["gridAfterWidthType","gawt"],vi=["allowAutoFit","auft"],yi=["cellSpacing","csp"],wi=["shading","sd"],bi=["tableAlignment","ta"],Ci=["preferredWidth","pw"],xi=["preferredWidthType","pwt"],Ii=["horizontalPositionAbs","hpa"],ki=["texture","t"],Fi=["backgroundColor","bgc"],Pi=["foregroundColor","fgc"],Si=["shadow","sh"],Ti=["hasNoneStyle","hns"],Hi=["vertical","v"],Ei=["horizontal","h"],Ni=["diagonalUp","du"],Wi=["diagonalDown","dd"],Oi=["lineStyle","ls"],Bi=["lineWidth","lw"],Li=["layout","l"],Di=["dataFormat","df"],Ri=["yValue","y"],Mi=["chartData","chd"],Ai=["categoryXName","cx"],Ui=["line","l"],Vi=["foreColor","fc"],zi=["pattern","pt"],qi=["layoutX","x"],_i=["layoutY","y"],ji=["direction","dir"],Gi=["endStyle","est"],Ki=["numberValue","no"],Xi=["markerStyle","mst"],Zi=["markerColor","mc"],Ji=["markerSize","msz"],Yi=["forward","fw"],Qi=["backward","bw"],$i=["intercept","itr"],en=["isDisplayRSquared","idrs"],tn=["isDisplayEquation","ideq"],nn=["seriesName","sn"],rn=["dataLabel","sl"],on=["errorBar","eb"],sn=["seriesFormat","sf"],an=["trendLines","tl"],ln=["dataPoints","dp"],dn=["firstSliceAngle","fsa"],hn=["holeSize","hsz"],cn=["isLegendKey","lk"],pn=["isBubbleSize","bsz"],un=["isCategoryName","icn"],gn=["isSeriesName","isn"],mn=["isValue","iv"],fn=["isPercentage","ip"],vn=["isLeaderLines","il"],yn=["showSeriesKeys","sk"],wn=["hasHorzBorder","hhbdr"],bn=["hasVertBorder","hvbdr"],Cn=["hasBorders","hbdr"],xn=["categoryType","ct"],In=["chartCategory","c"],kn=["chartSeries","cs"],Fn=["chartArea","ca"],Pn=["chartTitleArea","cta"],Sn=["plotArea","pa"],Tn=["chartLegend","cl"],Hn=["chartPrimaryCategoryAxis","cpca"],En=["chartPrimaryValueAxis","cpva"],Nn=["chartTitle","ctt"],Wn=["chartType","ct"],On=["gapWidth","gw"],Bn=["overlap","o"],Ln=["chartDataTable","cdt"],Dn=["text","tlp"],Rn=["shapeId","sid"],Mn=["alternativeText","at"],An=["visible","v"],Un=["belowText","b"],Vn=["horizontalRule","ihr"],zn=["width","w"],qn=["height","h"],_n=["widthScale","ws"],jn=["heightScale","hs"],Gn=["lineFormat","lf"],Kn=["fillFormat","ff"],Xn=["textWrappingStyle","tws"],Zn=["textWrappingType","twt"],Jn=["verticalRelativePercent","vrp"],Yn=["horizontalRelativePercent","hrp"],Qn=["heightRelativePercent","hrp"],$n=["widthRelativePercent","wrp"],er=["zOrderPosition","z"],tr=["layoutInCell","lc"],ir=["lockAnchor","la"],nr=["autoShapeType","ast"],rr=["textFrame","tf"],or=["color","c"],sr=["fill","f"],ar=["textVerticalAlignment","tva"],lr=["imageString","img"],dr=["metaFileImageString","mtimg"],hr=["length","l"],cr=["isInlineImage","inimg"],pr=["isMetaFile","imf"],ur=["top","tp"],gr=["bottom","bt"],mr=["right","rg"],fr=["left","lt"],vr=["getimageheight","gih"],yr=["getimagewidth","giw"],wr=["hasFieldEnd","hfe"],br=["formFieldData","ffd"],Cr=["fieldType","ft"],xr=["isCreatedUsingHtmlSpanTag","ishst"],Ir=["enabled","e"],kr=["helpText","h"],Fr=["statusText","st"],Pr=["textInput","ti"],Sr=["checkBox","c"],Tr=["dropDownList","ddl"],Hr=["maxLength","ml"],Er=["defaultValue","dv"],Nr=["format","f"],Wr=["sizeType","szt"],Or=["size","sz"],Br=["checked","chk"],Lr=["dropDownItems","ddi"],Dr=["selectedIndex","si"],Rr=["commentId","cid"],Mr=["commentCharacterType","cct"],Ar=["author","a"],Ur=["initial","i"],Vr=["date","dt"],zr=["done","dn"],qr=["replyComments","rc"],_r=["revisionType","rt"],jr=["revisionId","rid"],Gr=["itemID","iid"],Kr=["xml","x"],Xr=["footnoteType","fnt"],Zr=["symbolCode","sc"],Jr=["symbolFontName","sfn"],Yr=["customMarker","cm"],Qr=["inlines","i"],$r=["contentControlProperties","ccp"],eo=["lockContentControl","lcc"],to=["lockContents","lc"],io=["tag","tg"],no=["title","tt"],ro=["hasPlaceHolderText","hpt"],oo=["multiline","mul"],so=["isTemporary","it"],ao=["dateCalendarType","dtct"],lo=["dateStorageFormat","dtsf"],ho=["dateDisplayLocale","dtdl"],co=["dateDisplayFormat","dtdf"],po=["isChecked","ichk"],uo=["uncheckedState","uchk"],go=["checkedState","chks"],mo=["contentControlListItems","ccli"],fo=["xmlMapping","x"],vo=["font","f"],yo=["value","v"],wo=["displayText","dt"],bo=["isMapped","imap"],Co=["isWordMl","iwml"],xo=["prefixMapping","pmap"],Io=["xPath","xp"],ko=["storeItemId","siid"],Fo=["customXmlPart","cxp"],Po=["id","i"],So=["cellFormat","tcpr"],To=["rowFormat","trpr"],Ho=["cells","c"],Eo=["rows","r"],No=["description","desc"],Wo=["wrapTextAround","wta"],Oo=["isLegalStyleNumbering","isLgl"],Bo=["positioning","p"],Lo=["tableFormat","tblpr"],Do=["allowOverlap","ao"],Ro=["distanceTop","dt"],Mo=["distanceRight","dr"],Ao=["distanceLeft","dl"],Uo=["distanceBottom","db"],Vo=["verticalOrigin","vo"],zo=["verticalPosition","vp"],qo=["horizontalOrigin","ho"],_o=["horizontalAlignment","ha"],jo=["horizontalPosition","hp"],Go=["blocks","b"],Ko=["header","h"],Xo=["footer","f"],Zo=["evenHeader","eh"],Jo=["evenFooter","ef"],Yo=["firstPageHeader","fph"],Qo=["firstPageFooter","fpf"],$o=["headersFooters","hf"],es=["sectionFormat","secpr"],ts=["listLevelPattern","lilp"],is=["followCharacter","fchar"],ns=["startAt","sa"],rs=["restartLevel","rl"],os=["levelNumber","lvlno"],ss=["numberFormat","nf"],as=["paraStyleName","psty"],ls=["abstractListId","alid"],ds="nsid",hs=["levels","lvl"],cs=["overrideListLevel","o"],ps=["levelOverrides","lo"],us=["separator","s"],gs=["continuationSeparator","cs"],ms=["continuationNotice","cn"],fs=["bookmarkType","bkt"],vs=["properties","p"],ys=["tabJustification","tj"],ws=["position","p"],bs=["deletePosition","dp"],Cs=["leader","l"],xs=["tabLeader","tl"],Is=["editRangeId","erid"],ks=["columnFirst","cft"],Fs=["columnLast","clt"],Ps=["user","u"],Ss=["group","g"],Ts=["editableRangeStart","ers"],Hs=["space","sp"],Es=["fontScheme","fsc"],Ns=["fontSchemeName","fscn"],Ws=["majorFontScheme","majfs"],Os=["minorFontScheme","minfs"],Bs=["fontSchemeList","fsl"],Ls=["fontTypeface","ft"],Ds=["typeface","t"],Rs=["panose","p"],Ms=["type","t"],As=["majorUnit","maju"],Us=["isAutoMajor","iam"],Vs=["maximumValue","maxv"],zs=["minimumValue","minv"],qs=["hasMajorGridLines","hmajgl"],_s=["hasMinorGridLines","hmingl"],js=["majorTickMark","majtm"],Gs=["minorTickMark","mintm"],Ks=["tickLabelPosition","tlp"],Xs=["rgb","rgb"],Zs=["appearance","a"],Js=["lineFormatType","lft"],Ys=["allowSpaceOfSameStyleInTable","stytbl"],Qs=["weight","w"],$s=["inlineFormat","inf"],ea=["fontName","fn"],ta=["isCompressed","comp"],ia=["columnIndex","ci"],na=["images","imgs"],ra=["isAfterParagraphMark","apm"],oa=["isAfterCellMark","acm"],sa=["isAfterRowMark","arm"],aa=["grid","grd"],la=["columnCount","colc"],da=["isAfterTableMark","atm"],ha=["iOps"],ca=["editingpoints","ep"],pa=function(){function e(){var e=this;this.windowPrint=void 0,this.closePrintWindow=function(){e.windowPrint&&!e.windowPrint.closed&&e.windowPrint.close()}}return e.prototype.getModuleName=function(){return"Print"},e.prototype.print=function(e,t){this.printWindow(e,void 0!==navigator?navigator.userAgent:"",t)},e.prototype.printWindow=function(e,t,i){var n=this.getPageHeight(e.pages),r=this.getPageWidth(e.pages),o=document.createElement("div");o.style.width="100%",o.style.height="100%",o.style.overflow="scroll",this.generatePrintContent(e,o),(0,a.isNullOrUndefined)(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no")),this.windowPrint=i;var s=r.toString()+"px "+n.toString()+"px";r>n&&(s="landscape"),-1!==t.indexOf("Chrome")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html><head><title>"+e.owner.documentName+"</title><style>img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }@media print{ body { margin: 0cm; size:"+s+"; }}</style></head> <body><center>")):-1!==t.indexOf("Firefox")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html moznomarginboxes mozdisallowselectionprint><head><title>"+e.owner.documentName+"</title><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }@media print{ body { margin: 0cm; size:"+s+"; }}</style></head> <body><center>")):i.document.write("<html><head><title>"+e.owner.documentName+"</title><style>@page{margin:0;size:"+s+";}</style></head><body><center>"),i.document.write(o.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),o=void 0,i.document.close(),i.focus(),window.addEventListener("beforeunload",this.closePrintWindow);var l=Number(setInterval((function(){i.ready&&(i.print(),i.close(),clearInterval(l))}),500))},e.prototype.exportAsImage=function(e,t,i){var n;if(!(0,a.isNullOrUndefined)(t)&&t<=e.pages.length&&t>=1){var r=e.pages[t-1],o=r.boundingRectangle.height,s=r.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(r,0,0,0,0);var l=e.render.pageCanvas.toDataURL(i,1);e.render.isPrinting=!1,(n=new Image).src=l,n.setAttribute("style","margin:0px;display:block;width:"+s.toString()+"px;height:"+o.toString()+"px;")}return n},e.prototype.generatePrintContent=function(e,t){for(var i="",n=0;n<e.pages.length;n++){var r=e.pages[n],o=r.boundingRectangle.height,s=r.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(r,0,0,s,0);var a=e.render.pageCanvas.toDataURL();e.render.isPrinting=!1;var l=n==e.pages.length-1?"":"<br/>";i+="<div><img src="+a+' style="margin:0px;display:block;width: '+s.toString()+"px; height:"+o.toString()+'px; "/></div>'+l}t.innerHTML=i},e.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},e.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},e.prototype.destroy=function(){window.removeEventListener("beforeunload",this.closePrintWindow),this.windowPrint=void 0},e}(),ua=m(215),ga=function(){function e(e){this.uniqueSectionFormat=void 0,this.columns=[],this.ownerBase=e,this.columns=[],this.removedHeaderFooters=[]}return Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(e){this.setPropertyValue("restartPageNumbering",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(e){this.setPropertyValue("pageStartingNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(e){this.setPropertyValue("endnoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(e){this.setPropertyValue("restartIndexForEndnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(e){this.setPropertyValue("restartIndexForFootnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(e){this.setPropertyValue("footNoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(e){this.setPropertyValue("initialFootNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(e){this.setPropertyValue("initialEndNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumberStyle",{get:function(){return this.getPropertyValue("pageNumberStyle")},set:function(e){this.setPropertyValue("pageNumberStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return this.getPropertyValue("numberOfColumns")},set:function(e){this.setPropertyValue("numberOfColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.getPropertyValue("equalWidth")},set:function(e){this.setPropertyValue("equalWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.getPropertyValue("lineBetweenColumns")},set:function(e){this.setPropertyValue("lineBetweenColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.getPropertyValue("breakCode")},set:function(e){this.setPropertyValue("breakCode",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageHeader",{get:function(){return this.getPropertyValue("firstPageHeader")},set:function(e){this.setPropertyValue("firstPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageFooter",{get:function(){return this.getPropertyValue("firstPageFooter")},set:function(e){this.setPropertyValue("firstPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageHeader",{get:function(){return this.getPropertyValue("oddPageHeader")},set:function(e){this.setPropertyValue("oddPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageFooter",{get:function(){return this.getPropertyValue("oddPageFooter")},set:function(e){this.setPropertyValue("oddPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageHeader",{get:function(){return this.getPropertyValue("evenPageHeader")},set:function(e){this.setPropertyValue("evenPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageFooter",{get:function(){return this.getPropertyValue("evenPageFooter")},set:function(e){this.setPropertyValue("evenPageFooter",e)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.uniqueSectionFormat)||e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0,this.ownerBase=void 0,this.columns=void 0,this.removedHeaderFooters=void 0},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueSectionFormat)){var t=d.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);return this.uniqueSectionFormat.propertiesHash.containsKey(t)}return!1},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":case"bidi":case"restartPageNumbering":case"lineBetweenColumns":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"pageStartingNumber":case"initialFootNoteNumber":case"initialEndNoteNumber":case"numberOfColumns":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":case"pageNumberStyle":t="Arabic";break;case"equalWidth":t=!0;break;case"breakCode":t="NewPage";break;case"firstPageHeader":case"firstPageFooter":case"oddPageHeader":case"oddPageFooter":case"evenPageHeader":case"evenPageFooter":t=void 0}return t},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(i))return this.uniqueSectionFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(t,i);else{var n=d.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,t);if(this.uniqueSectionFormat.propertiesHash.containsKey(n)&&this.uniqueSectionFormat.propertiesHash.get(n)===i)return;this.uniqueSectionFormat=e.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,t,i)}},e.prototype.initializeUniqueSectionFormat=function(t,i){var n=new l;this.addUniqueSectionFormat("headerDistance",t,i,n),this.addUniqueSectionFormat("footerDistance",t,i,n),this.addUniqueSectionFormat("differentFirstPage",t,i,n),this.addUniqueSectionFormat("differentOddAndEvenPages",t,i,n),this.addUniqueSectionFormat("pageWidth",t,i,n),this.addUniqueSectionFormat("pageHeight",t,i,n),this.addUniqueSectionFormat("leftMargin",t,i,n),this.addUniqueSectionFormat("topMargin",t,i,n),this.addUniqueSectionFormat("rightMargin",t,i,n),this.addUniqueSectionFormat("bottomMargin",t,i,n),this.addUniqueSectionFormat("bidi",t,i,n),this.addUniqueSectionFormat("restartPageNumbering",t,i,n),this.addUniqueSectionFormat("pageStartingNumber",t,i,n),this.addUniqueSectionFormat("endnoteNumberFormat",t,i,n),this.addUniqueSectionFormat("endnotePosition",t,i,n),this.addUniqueSectionFormat("footNoteNumberFormat",t,i,n),this.addUniqueSectionFormat("footnotePosition",t,i,n),this.addUniqueSectionFormat("restartIndexForEndnotes",t,i,n),this.addUniqueSectionFormat("restartIndexForFootnotes",t,i,n),this.addUniqueSectionFormat("initialFootNoteNumber",t,i,n),this.addUniqueSectionFormat("initialEndNoteNumber",t,i,n),this.addUniqueSectionFormat("pageNumberStyle",t,i,n),this.addUniqueSectionFormat("numberOfColumns",t,i,n),this.addUniqueSectionFormat("equalWidth",t,i,n),this.addUniqueSectionFormat("lineBetweenColumns",t,i,n),this.addUniqueSectionFormat("breakCode",t,i,n),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueSectionFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i?r.add(o,n):r.add(o,e.getPropertyDefaultValue(t))},e.prototype.copyFormat=function(e,t){t&&(t.isUndoing||t.isRedoing)?(this.uniqueSectionFormat=e.uniqueSectionFormat,this.columns=e.columns,this.removedHeaderFooters=e.removedHeaderFooters):(0,a.isNullOrUndefined)(e)||(this.removedHeaderFooters=e.removedHeaderFooters,!(0,a.isNullOrUndefined)(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&(this.updateUniqueSectionFormat(e),this.columns=e.columns))},e.prototype.updateUniqueSectionFormat=function(t){var i=void 0;this.uniqueSectionFormat&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0)),this.uniqueSectionFormat=new d(e.uniqueFormatType),(0,a.isNullOrUndefined)(i)&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat)),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e;return t.uniqueSectionFormat=this.uniqueSectionFormat,t.columns=this.columns,t},e.clear=function(){this.uniqueSectionFormats.clear()},e.uniqueSectionFormats=new h,e.uniqueFormatType=10,e}(),ma=function(){function e(e){this.uniqueColumnFormat=void 0,this.ownerBase=e}return e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.uniqueColumnFormat)||e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0,this.ownerBase=void 0},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueColumnFormat)){var t=d.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,e);return this.uniqueColumnFormat.propertiesHash.containsKey(t)}return!1},Object.defineProperty(e.prototype,"index",{get:function(){return this.indexIn},set:function(e){this.indexIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.getPropertyValue("width")},set:function(e){this.setPropertyValue("width",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueColumnFormat)&&this.uniqueColumnFormat.propertiesHash.containsKey(i))return this.uniqueColumnFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"width":t=36;break;case"space":t=0}return t},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueColumnFormat))this.initializeUniqueColumnFormat(t,i);else{var n=d.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,t);if(this.uniqueColumnFormat.propertiesHash.containsKey(n)&&this.uniqueColumnFormat.propertiesHash.get(n)===i)return;this.uniqueColumnFormat=e.uniqueColumnFormats.updateUniqueFormat(this.uniqueColumnFormat,t,i)}},e.prototype.initializeUniqueColumnFormat=function(t,i){var n=new l;this.addUniqueColumnFormat("width",t,i,n),this.addUniqueColumnFormat("space",t,i,n),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueColumnFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i?r.add(o,n):r.add(o,e.getPropertyDefaultValue(t))},e.prototype.updateUniqueColumnFormat=function(t){var i=void 0;this.uniqueColumnFormat&&(i=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat),0===this.uniqueColumnFormat.referenceCount&&(e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0)),this.uniqueColumnFormat=new d(e.uniqueFormatType),(0,a.isNullOrUndefined)(i)&&(i=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat)),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.width=this.width,t.space=this.space,t},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.uniqueColumnFormat)||(this.width=e.width,this.space=e.space)},e.clear=function(){this.uniqueColumnFormats.clear()},e.uniqueColumnFormats=new h,e.uniqueFormatType=11,e}(),fa=function(){function e(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueBorderFormat)){var n=this.uniqueBorderFormat.propertiesHash.get(i);if(!(0,a.isNullOrUndefined)(n))return n}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueBorderFormat))this.initializeUniqueBorder(t,i);else{var n=d.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,t);if(this.uniqueBorderFormat.propertiesHash.containsKey(n)&&this.uniqueBorderFormat.propertiesHash.get(n)===i)return;this.uniqueBorderFormat=e.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,t,i)}},e.prototype.initializeUniqueBorder=function(t,i){var n=new l;this.addUniqueBorderFormat("color",t,i,n),this.addUniqueBorderFormat("lineStyle",t,i,n),this.addUniqueBorderFormat("lineWidth",t,i,n),this.addUniqueBorderFormat("shadow",t,i,n),this.addUniqueBorderFormat("space",t,i,n),this.addUniqueBorderFormat("hasNoneStyle",t,i,n),this.uniqueBorderFormat=e.uniqueBorderFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueBorderFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":case"space":t=0;break;case"shadow":case"hasNoneStyle":t=!1}return t},e.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":case"DashDotStroked":case"Outset":return this.lineWidth>=.5?this.lineWidth:.5;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75}return this.lineWidth>=.5?this.lineWidth:.5},e.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var n=0;n<i.length;n++)i[parseInt(n.toString(),10)]>=0?i[parseInt(n.toString(),10)]=i[parseInt(n.toString(),10)]*t:i[parseInt(n.toString(),10)]=Math.abs(i[parseInt(n.toString(),10)]);return i},e.prototype.getBorderWeight=function(){var e=0,t=(this.getNumberOfLines(),this.getBorderNumber());switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=this.lineWidth*t;break;case"Dot":case"DashLargeGap":e=1}return e},e.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":case"SingleWavy":case"DashDotStroked":case"Outset":case"Inset":case"Thick":e=1;break;case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"Emboss3D":case"Engrave3D":e=3;break;case"Triple":case"ThinThickThinSmallGap":case"ThinThickThinMediumGap":case"ThinThickThinLargeGap":e=5;break;case"DoubleWavy":e=2}return e},e.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.hasValues=function(){return this.hasValue("color")||this.hasValue("lineStyle")||this.hasValue("lineWidth")||this.hasValue("shadow")||this.hasValue("space")||this.hasValue("hasNoneStyle")},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueBorderFormat)){var t=d.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);return this.uniqueBorderFormat.propertiesHash.containsKey(t)}return!1},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.color=this.color,t.lineStyle=this.lineStyle,t.lineWidth=this.lineWidth,t.shadow=this.shadow,t.space=this.space,t},e.prototype.clearFormat=function(){(0,a.isNullOrUndefined)(this.uniqueBorderFormat)||e.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},e.prototype.destroy=function(){this.clearFormat(),this.ownerBase=void 0},e.prototype.isEqualFormat=function(e){var t=!1;return this.color===e.color&&this.lineStyle===e.lineStyle&&this.lineWidth===e.lineWidth&&this.shadow===e.shadow&&this.space===e.space&&(t=!0),t},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.uniqueBorderFormat)||(e.hasValue("color")&&(this.color=e.color),e.hasValue("lineStyle")&&(this.lineStyle=e.lineStyle),e.hasValue("lineWidth")&&(this.lineWidth=e.lineWidth),e.hasValue("shadow")&&(this.shadow=e.shadow),e.hasValue("space")&&(this.space=e.space),e.hasValue("hasNoneStyle")&&(this.hasNoneStyle=e.hasNoneStyle))},e.clear=function(){this.uniqueBorderFormats.clear()},e.uniqueBorderFormats=new h,e.uniqueFormatType=1,e}(),va=function(){function e(e){this.leftIn=new fa(this),this.rightIn=new fa(this),this.topIn=new fa(this),this.bottomIn=new fa(this),this.horizontalIn=new fa(this),this.verticalIn=new fa(this),this.diagonalUpIn=new fa(this),this.diagonalDownIn=new fa(this),this.isParsing=!1,this.ownerBase=e}return Object.defineProperty(e.prototype,"left",{get:function(){return this.ownerBase instanceof ba?this.getPropertyValue("left"):this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.ownerBase instanceof ba?this.getPropertyValue("right"):this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.ownerBase instanceof ba?this.getPropertyValue("top"):this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.ownerBase instanceof ba?this.getPropertyValue("bottom"):this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.ownerBase instanceof ba?this.getPropertyValue("horizontal"):this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.ownerBase instanceof ba?this.getPropertyValue("vertical"):this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){var t=this.getBorder(e);if(this.isParsing)return t;if(t.hasValues())return t;var i=this.ownerBase.baseStyle;if(!(0,a.isNullOrUndefined)(i)){for(var n=this;!(0,a.isNullOrUndefined)(i);){var r=void 0;if(this.ownerBase.listFormat.hasValue("listId")||(r=i.paragraphFormat.getListPargaraphFormat(e)),i.paragraphFormat.borders.getBorder(e).hasValues()){n=i.paragraphFormat.borders;break}if(!(0,a.isNullOrUndefined)(r)&&r.borders.getBorder(e).hasValues()){n=r.borders;break}i=i.basedOn}if(!(0,a.isNullOrUndefined)(i))return n.getBorder(e)}return this.getDefaultValue(e)},e.prototype.getDefaultValue=function(e){var t,i=this.documentParagraphFormat();return(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(i.borders)||(t=i.borders.getBorder(e)),t},e.prototype.documentParagraphFormat=function(){var e;return this.ownerBase instanceof ba&&(e=this.ownerBase.getDocumentParagraphFormat()),e},e.prototype.getBorder=function(e){switch(e){case"left":return this.leftIn;case"right":return this.rightIn;case"top":return this.topIn;case"bottom":return this.bottomIn;case"vertical":return this.verticalIn;case"horizontal":return this.horizontalIn}},e.prototype.clearFormat=function(){(0,a.isNullOrUndefined)(this.leftIn)||this.leftIn.clearFormat(),(0,a.isNullOrUndefined)(this.topIn)||this.topIn.clearFormat(),(0,a.isNullOrUndefined)(this.bottomIn)||this.bottomIn.clearFormat(),(0,a.isNullOrUndefined)(this.rightIn)||this.rightIn.clearFormat(),(0,a.isNullOrUndefined)(this.horizontalIn)||this.horizontalIn.clearFormat(),(0,a.isNullOrUndefined)(this.verticalIn)||this.verticalIn.clearFormat(),(0,a.isNullOrUndefined)(this.diagonalDown)||this.diagonalDown.clearFormat(),(0,a.isNullOrUndefined)(this.diagonalUp)||this.diagonalUp.clearFormat()},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.leftIn)||this.leftIn.destroy(),(0,a.isNullOrUndefined)(this.topIn)||this.topIn.destroy(),(0,a.isNullOrUndefined)(this.bottomIn)||this.bottomIn.destroy(),(0,a.isNullOrUndefined)(this.rightIn)||this.rightIn.destroy(),(0,a.isNullOrUndefined)(this.horizontalIn)||this.horizontalIn.destroy(),(0,a.isNullOrUndefined)(this.verticalIn)||this.verticalIn.destroy(),(0,a.isNullOrUndefined)(this.diagonalDown)||this.diagonalDown.destroy(),(0,a.isNullOrUndefined)(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0,this.ownerBase=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.top=(0,a.isNullOrUndefined)(this.topIn)?void 0:this.topIn.cloneFormat(),t.bottom=(0,a.isNullOrUndefined)(this.bottomIn)?void 0:this.bottomIn.cloneFormat(),t.left=(0,a.isNullOrUndefined)(this.leftIn)?void 0:this.leftIn.cloneFormat(),t.right=(0,a.isNullOrUndefined)(this.rightIn)?void 0:this.rightIn.cloneFormat(),t.horizontal=(0,a.isNullOrUndefined)(this.horizontalIn)?void 0:this.horizontalIn.cloneFormat(),t.vertical=(0,a.isNullOrUndefined)(this.verticalIn)?void 0:this.verticalIn.cloneFormat(),t.diagonalUp=(0,a.isNullOrUndefined)(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),t.diagonalDown=(0,a.isNullOrUndefined)(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),t},e.prototype.copyFormat=function(e){if(!(0,a.isNullOrUndefined)(e.getBorder("left"))&&e.getBorder("left")instanceof fa){var t=new fa(this);t.copyFormat(e.getBorder("left")),this.left=t}if(!(0,a.isNullOrUndefined)(e.getBorder("right"))&&e.getBorder("right")instanceof fa){var i=new fa(this);i.copyFormat(e.getBorder("right")),this.right=i}if(!(0,a.isNullOrUndefined)(e.getBorder("top"))&&e.getBorder("top")instanceof fa){var n=new fa(this);n.copyFormat(e.getBorder("top")),this.top=n}if(!(0,a.isNullOrUndefined)(e.getBorder("bottom"))&&e.getBorder("bottom")instanceof fa){var r=new fa(this);r.copyFormat(e.getBorder("bottom")),this.bottom=r}if(!(0,a.isNullOrUndefined)(e.getBorder("horizontal"))&&e.getBorder("horizontal")instanceof fa){var o=new fa(this);o.copyFormat(e.getBorder("horizontal")),this.horizontal=o}if(!(0,a.isNullOrUndefined)(e.getBorder("vertical"))&&e.getBorder("vertical")instanceof fa){var s=new fa(this);s.copyFormat(e.getBorder("vertical")),this.vertical=s}!(0,a.isNullOrUndefined)(e.diagonalDown)&&e.diagonalDown instanceof fa&&(this.diagonalDown=new fa(this),this.diagonalDown.copyFormat(e.diagonalDown)),!(0,a.isNullOrUndefined)(e.diagonalUp)&&e.diagonalUp instanceof fa&&(this.diagonalUp=new fa(this),this.diagonalUp.copyFormat(e.diagonalUp))},e}(),ya=function(){function e(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"nsid",{get:function(){return this.getPropertyValue("nsid")},set:function(e){this.setPropertyValue("nsid",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){if(e>=0){if(!(0,a.isNullOrUndefined)(this.ownerBase)){var t=this.ownerBase.getDocumentHelperObject();(0,a.isNullOrUndefined)(t)||(this.list=t.getListById(e))}}else!(0,a.isNullOrUndefined)(this.list)&&e<0&&(this.list=void 0);this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){var e=void 0;if((0,a.isNullOrUndefined)(this.list))for(var t=this.baseStyle;!(0,a.isNullOrUndefined)(t)&&t instanceof Wa;){if(t.paragraphFormat.listFormat.list){e=t.paragraphFormat.listFormat.list;break}t=t.basedOn}else e=this.list;return(0,a.isNullOrUndefined)(e)?void 0:e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){n=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(n))return this.uniqueListFormat.propertiesHash.get(n)}else if(this.baseStyle instanceof Wa){for(var i=this.baseStyle;!(0,a.isNullOrUndefined)(i)&&!i.paragraphFormat.listFormat.hasValue(t);)i=i.basedOn;if(!(0,a.isNullOrUndefined)(i)){var n=d.getPropertyType(e.uniqueFormatType,t);return i.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(n)}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueListFormat))this.initializeUniqueListFormat(t,i);else{var n=d.getPropertyType(this.uniqueListFormat.uniqueFormatType,t);if(this.uniqueListFormat.propertiesHash.containsKey(n)&&this.uniqueListFormat.propertiesHash.get(n)===i)return;this.uniqueListFormat=e.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,t,i)}},e.prototype.initializeUniqueListFormat=function(t,i){var n=new l;this.addUniqueListFormat("listId",t,i,n),this.addUniqueListFormat("listLevelNumber",t,i,n),this.addUniqueListFormat("nsid",t,i,n),this.uniqueListFormat=e.uniqueListFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueListFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":case"nsid":t=-1;break;case"listLevelNumber":t=0}return t},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber,this.nsid=e.nsid),(0,a.isNullOrUndefined)(e.baseStyle)||(this.baseStyle=e.baseStyle),(0,a.isNullOrUndefined)(e.list)||(this.list=e.list))},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueListFormat)){var t=d.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);return this.uniqueListFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){(0,a.isNullOrUndefined)(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.uniqueListFormat)||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0,this.ownerBase=void 0,this.baseStyle=void 0},e.clear=function(){this.uniqueListFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.cloneListFormat=function(){var t=new e(void 0);return t.list=this.list,t.listId=this.listId,t.nsid=this.nsid,t.baseStyle=this.baseStyle,t.listLevelNumber=this.listLevelNumber,t.uniqueListFormat=this.uniqueListFormat,t},e.uniqueListFormats=new h,e.uniqueFormatType=7,e}(),wa=function(){function e(){}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.deletePosition=this.deletePosition,t.position=this.position,t.tabJustification=this.tabJustification,t.tabLeader=this.tabLeader,t},e.prototype.equals=function(e){return this.position===e.position&&this.deletePosition===e.deletePosition&&this.tabJustification===e.tabJustification&&this.tabLeader===e.tabLeader},e.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0},e}(),ba=function(){function e(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new ya(this),this.borders=new va(this),this.tabs=[]}return e.prototype.getUpdatedTabs=function(){for(var e=[],t=new l,i=0,n=this.getTabStopsFromListFormat();i<n.length;i++){var r=n[i];t.containsKey(r.position)||t.add(r.position,r)}if(!(0,a.isNullOrUndefined)(this.baseStyle)&&this.baseStyle instanceof Wa){for(var o=this.baseStyle;!(0,a.isNullOrUndefined)(o);){for(var s=0,d=o.paragraphFormat.tabs;s<d.length;s++){var h=d[s];t.containsKey(h.position)||t.add(h.position,h)}o=o.basedOn}var c=[];t.keys.forEach((function(e){c.push(t.get(e))}));for(var p=0;p<c.length;p++){r=c[p];this.isValidTabStop(c,r)||t.remove(r.position)}for(var u=0,g=t.keys;u<g.length;u++){var m=g[u];this.hasTabStop(parseFloat(m.toFixed(4)))||e.push(t.get(m))}}return e=(e=e.concat(this.tabs.filter((function(e){return 0!==e.position&&0===e.deletePosition})))).sort((function(e,t){return e.position-t.position}))},e.prototype.getTabStopsFromListFormat=function(){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var e=this.listFormat.listLevel;if(e&&e.paragraphFormat)return e.paragraphFormat.tabs}return[]},e.prototype.isValidTabStop=function(e,t){for(var i=0;i<e.length;i++)if(t!=e[i]&&(parseFloat(e[i].position.toFixed(4))===parseFloat(t.position.toFixed(4))||parseFloat(e[i].deletePosition.toFixed(4))===parseFloat(t.position.toFixed(4))))return!1;return!0},e.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===e||parseFloat(this.tabs[t].deletePosition.toFixed(4))===e)return!0;return!1},Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.getPropertyValue("spaceBeforeAuto")},set:function(e){this.setPropertyValue("spaceBeforeAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.getPropertyValue("spaceAfterAuto")},set:function(e){this.setPropertyValue("spaceAfterAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){var e=this.getPropertyValue("textAlignment");return this.bidi&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(e){this.setPropertyValue("keepWithNext",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(e){this.setPropertyValue("keepLinesTogether",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(e){this.setPropertyValue("widowControl",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(e){this.setPropertyValue("contextualSpacing",e)},enumerable:!0,configurable:!0}),e.prototype.getListFormatParagraphFormat=function(t){var i=this.getListPargaraphFormat(t);if(!(0,a.isNullOrUndefined)(i))return i.uniqueParagraphFormat.propertiesHash.get(d.getPropertyType(e.uniqueFormatType,t))},e.prototype.getListPargaraphFormat=function(t){if(this.listFormat.hasValue("listId")&&this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var i=this.listFormat.listLevel,n=d.getPropertyType(e.uniqueFormatType,t);return(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(i.paragraphFormat.uniqueParagraphFormat)||!i.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(n)?void 0:i.paragraphFormat}if(this.listFormat.hasValue("listId")&&-1===this.listFormat.listId&&("leftIndent"===t||"firstLineIndent"===t)){var r=new e;return this.hasValue("leftIndent")||(r.leftIndent=0),this.hasValue("firstLineIndent")||(r.firstLineIndent=0),r}},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){l=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(l))return this.uniqueParagraphFormat.propertiesHash.get(l)}else{var i=this.getListFormatParagraphFormat(t);if(this.baseStyle instanceof Wa){for(var n=this,r=this.baseStyle;!(0,a.isNullOrUndefined)(r);){var o=void 0;if(this.listFormat.hasValue("listId")||(o=r.paragraphFormat.getListPargaraphFormat(t)),r.paragraphFormat.hasValue(t)){n=r.paragraphFormat;break}if(!(0,a.isNullOrUndefined)(o)&&o.hasValue(t)){if(r.paragraphFormat.listFormat.listLevelNumber!==this.listFormat.listLevelNumber){var s=this.listFormat.listLevel,l=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(s)&&!(0,a.isNullOrUndefined)(s.paragraphFormat.uniqueParagraphFormat)&&s.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(l)){n=s.paragraphFormat;break}}n=o;break}r=r.basedOn}if(!(0,a.isNullOrUndefined)(r)){if(!(0,a.isNullOrUndefined)(i)&&this.listFormat.hasValue("listId")&&-1===n.listFormat.listId&&n.listFormat.listLevelNumber<=1||!(0,a.isNullOrUndefined)(i)&&this.listFormat.listId!==n.listFormat.listId&&n.listFormat.listLevelNumber<=1)return i;var l=d.getPropertyType(e.uniqueFormatType,t);return n.uniqueParagraphFormat.propertiesHash.get(l)}}if(!(0,a.isNullOrUndefined)(i))return i}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var i=d.getPropertyType(e.uniqueFormatType,t),n=this.getDocumentParagraphFormat(),r=!0;this.ownerBase&&this.ownerBase instanceof Rl&&(r=this.ownerBase.containerWidget instanceof Wl||this.ownerBase.containerWidget instanceof cd||this.ownerBase.containerWidget instanceof Vl);var o=!(0,a.isNullOrUndefined)(this.ownerBase)&&!(0,a.isNullOrUndefined)(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&!(0,a.isNullOrUndefined)(this.ownerBase.bodyWidget.page.documentHelper)&&this.ownerBase.bodyWidget.page.documentHelper.owner.editorModule&&this.ownerBase.bodyWidget.page.documentHelper.owner.editorModule.isPaste;if(r&&!o&&!(0,a.isNullOrUndefined)(n)&&!(0,a.isNullOrUndefined)(n.uniqueParagraphFormat)){var s=n.uniqueParagraphFormat.propertiesHash.get(i);if(!(0,a.isNullOrUndefined)(s))return s}return e.getPropertyDefaultValue(t)},e.prototype.getDocumentParagraphFormat=function(){var e;if(!(0,a.isNullOrUndefined)(this.ownerBase)){var t=this.getDocumentHelperObject();(0,a.isNullOrUndefined)(t)||(e=t.paragraphFormat)}return e},e.prototype.getDocumentHelperObject=function(){var e;if(this.ownerBase instanceof Rl){var t=this.ownerBase.bodyWidget;(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(t.page)||(0,a.isNullOrUndefined)(t.page.documentHelper)||(e=t.page.documentHelper)}return e},e.prototype.setPropertyValue=function(t,i,n){if(((0,a.isNullOrUndefined)(i)||""===i&&!n)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueParagraphFormat)||(0,a.isNullOrUndefined)(this.uniqueParagraphFormat.propertiesHash)&&(0,a.isNullOrUndefined)(this.uniqueParagraphFormat.uniqueFormatType)&&(0,a.isNullOrUndefined)(this.uniqueParagraphFormat.referenceCount))this.initializeUniqueParagraphFormat(t,i);else{var r=d.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,t);if(this.uniqueParagraphFormat.propertiesHash.containsKey(r)&&this.uniqueParagraphFormat.propertiesHash.get(r)===i)return;this.uniqueParagraphFormat=e.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,t,i)}},e.prototype.initializeUniqueParagraphFormat=function(t,i){var n=new l;this.addUniqueParaFormat("leftIndent",t,i,n),this.addUniqueParaFormat("rightIndent",t,i,n),this.addUniqueParaFormat("firstLineIndent",t,i,n),this.addUniqueParaFormat("textAlignment",t,i,n),this.addUniqueParaFormat("beforeSpacing",t,i,n),this.addUniqueParaFormat("afterSpacing",t,i,n),this.addUniqueParaFormat("spaceBeforeAuto",t,i,n),this.addUniqueParaFormat("spaceAfterAuto",t,i,n),this.addUniqueParaFormat("lineSpacing",t,i,n),this.addUniqueParaFormat("lineSpacingType",t,i,n),this.addUniqueParaFormat("outlineLevel",t,i,n),this.addUniqueParaFormat("bidi",t,i,n),this.addUniqueParaFormat("contextualSpacing",t,i,n),this.addUniqueParaFormat("keepWithNext",t,i,n),this.addUniqueParaFormat("keepLinesTogether",t,i,n),this.addUniqueParaFormat("widowControl",t,i,n),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueParaFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":case"beforeSpacing":case"afterSpacing":t=0;break;case"textAlignment":t="Left";break;case"spaceBeforeAuto":case"spaceAfterAuto":case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"widowControl":t=!0}return t},e.prototype.clearIndent=function(){this.clearPropertyValue("leftIndent"),this.clearPropertyValue("firstLineIndent")},e.prototype.clearPropertyValue=function(e){if(this.setPropertyValue(e,void 0,!0),!(0,a.isNullOrUndefined)(this.uniqueParagraphFormat)){var t=d.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);this.uniqueParagraphFormat.propertiesHash.containsKey(t)&&this.uniqueParagraphFormat.propertiesHash.remove(t)}},e.prototype.clearFormat=function(){(0,a.isNullOrUndefined)(this.listFormat)||this.listFormat.clearFormat(),(0,a.isNullOrUndefined)(this.borders)||this.borders.clearFormat(),(0,a.isNullOrUndefined)(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,(0,a.isNullOrUndefined)(this.getDocumentHelperObject())||(this.baseStyle=this.getDocumentHelperObject().styles.findByName("Normal"))},e.prototype.destroy=function(){if((0,a.isNullOrUndefined)(this.uniqueParagraphFormat)||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,(0,a.isNullOrUndefined)(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,this.tabs&&this.tabs.length>0){for(var t=0;t<this.tabs.length;t++)this.tabs[t].destroy();this.tabs=[],this.tabs=void 0}(0,a.isNullOrUndefined)(this.borders)||this.borders.destroy(),this.borders=void 0,this.baseStyle=void 0,this.ownerBase=void 0},e.prototype.copyFormat=function(e){if(!(0,a.isNullOrUndefined)(e)&&((0,a.isNullOrUndefined)(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),(0,a.isNullOrUndefined)(e.borders)||((0,a.isNullOrUndefined)(this.borders)&&(this.borders=new va(this)),this.borders.copyFormat(e.borders)),(0,a.isNullOrUndefined)(e.listFormat)||((0,a.isNullOrUndefined)(this.listFormat)&&(this.listFormat=new ya(this)),this.listFormat.copyFormat(e.listFormat)),(0,a.isNullOrUndefined)(e.baseStyle)||(this.baseStyle=e.baseStyle),!(0,a.isNullOrUndefined)(e.tabs)))for(var t=0;t<e.tabs.length;t++)this.tabs[t]=e.tabs[t]},e.prototype.updateUniqueParagraphFormat=function(t){var i=void 0;this.uniqueParagraphFormat&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0)),this.uniqueParagraphFormat=new d(e.uniqueFormatType),(0,a.isNullOrUndefined)(i)&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat)),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueParagraphFormat=this.uniqueParagraphFormat,t.baseStyle=this.baseStyle,(0,a.isNullOrUndefined)(this.listFormat)?t.listFormat=void 0:(t.listFormat=this.listFormat.cloneListFormat(),t.listFormat.ownerBase=t),t.borders=(0,a.isNullOrUndefined)(this.borders)?void 0:this.borders.cloneFormat(),t},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueParagraphFormat)&&!(0,a.isNullOrUndefined)(this.uniqueParagraphFormat.propertiesHash)){var t=d.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);return this.uniqueParagraphFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueParagraphFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e,this.listFormat.applyStyle(this.baseStyle)},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.assignFormat=function(e,t){t=!(0,a.isNullOrUndefined)(t)&&t,e.hasValue("leftIndent")&&(this.leftIndent=e.getValue("leftIndent")),e.hasValue("rightIndent")&&(this.rightIndent=e.getValue("rightIndent")),e.hasValue("firstLineIndent")&&(this.firstLineIndent=e.getValue("firstLineIndent")),e.hasValue("beforeSpacing")&&(this.beforeSpacing=e.getValue("beforeSpacing")),e.hasValue("afterSpacing")&&(this.afterSpacing=e.getValue("afterSpacing")),e.hasValue("spaceBeforeAuto")&&(this.spaceBeforeAuto=e.getValue("spaceBeforeAuto")),e.hasValue("spaceAfterAuto")&&(this.spaceAfterAuto=e.getValue("spaceAfterAuto")),e.hasValue("lineSpacing")&&(this.lineSpacing=e.getValue("lineSpacing")),e.hasValue("lineSpacingType")&&(this.lineSpacingType=e.getValue("lineSpacingType")),e.hasValue("textAlignment")&&(this.textAlignment=e.getValue("textAlignment")),e.hasValue("outlineLevel")&&(this.outlineLevel=e.getValue("outlineLevel")),!t&&e.hasValue("bidi")&&(this.bidi=e.getValue("bidi")),e.hasValue("contextualSpacing")&&(this.contextualSpacing=e.getValue("contextualSpacing")),e.hasValue("keepWithNext")&&(this.keepWithNext=e.getValue("keepWithNext")),e.hasValue("keepLinesTogether")&&(this.keepLinesTogether=e.getValue("keepLinesTogether")),e.hasValue("widowControl")&&(this.widowControl=e.getValue("widowControl"))},e.uniqueParagraphFormats=new h,e.uniqueFormatType=3,e}(),Ca=function(){function e(e){this.uniqueRowFormat=void 0,this.borders=new va(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.revisions=[],this.removedIds=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(i))return this.uniqueRowFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueRowFormat))this.initializeUniqueRowFormat(t,i);else{var n=d.getPropertyType(this.uniqueRowFormat.uniqueFormatType,t);if(this.uniqueRowFormat.propertiesHash.containsKey(n)&&this.uniqueRowFormat.propertiesHash.get(n)===i)return;this.uniqueRowFormat=e.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,t,i)}},e.prototype.initializeUniqueRowFormat=function(t,i){var n=new l;this.addUniqueRowFormat("allowBreakAcrossPages",t,i,n),this.addUniqueRowFormat("isHeader",t,i,n),this.addUniqueRowFormat("height",t,i,n),this.addUniqueRowFormat("heightType",t,i,n),this.addUniqueRowFormat("gridBefore",t,i,n),this.addUniqueRowFormat("gridBeforeWidth",t,i,n),this.addUniqueRowFormat("gridBeforeWidthType",t,i,n),this.addUniqueRowFormat("gridAfter",t,i,n),this.addUniqueRowFormat("gridAfterWidth",t,i,n),this.addUniqueRowFormat("gridgridAfterWidth",t,i,n),this.addUniqueRowFormat("gridBeforeWidthType",t,i,n),this.addUniqueRowFormat("leftMargin",t,i,n),this.addUniqueRowFormat("rightMargin",t,i,n),this.addUniqueRowFormat("topMargin",t,i,n),this.addUniqueRowFormat("bottomMargin",t,i,n),this.addUniqueRowFormat("leftIndent",t,i,n),this.uniqueRowFormat=e.uniqueRowFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueRowFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":case"gridBefore":case"gridBeforeWidth":case"gridAfter":case"gridAfterWidth":case"leftIndent":t=0;break;case"heightType":t="Auto";break;case"gridBeforeWidthType":case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0}return t},e.prototype.containsMargins=function(){return!((0,a.isNullOrUndefined)(this.leftMargin)&&(0,a.isNullOrUndefined)(this.rightMargin)&&(0,a.isNullOrUndefined)(this.bottomMargin)&&(0,a.isNullOrUndefined)(this.topMargin))},e.prototype.cloneFormat=function(){var t=new e;return t.allowBreakAcrossPages=this.allowBreakAcrossPages,t.heightType=this.heightType,t.height=this.height,t.isHeader=this.isHeader,t.gridBefore=this.gridBefore,t.gridBeforeWidth=this.gridBeforeWidth,t.gridBeforeWidthType=this.gridBeforeWidthType,t.gridAfter=this.gridAfter,t.gridAfterWidth=this.gridAfterWidth,t.gridAfterWidthType=this.gridAfterWidthType,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.leftIndent=this.leftIndent,this.revisions.length>0?t.removedIds=xa.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueRowFormat)){var t=d.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);return this.uniqueRowFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.revisions=e.revisions),(0,a.isNullOrUndefined)(e.borders)||(this.borders=new va(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)),e.revisions.length>0?this.removedIds=xa.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.borders)||this.borders.destroy(),(0,a.isNullOrUndefined)(this.uniqueRowFormat)||e.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},e.clear=function(){this.uniqueRowFormats.clear()},e.uniqueRowFormats=new h,e.uniqueFormatType=6,e}(),xa=function(){function e(e,t,i){this.author=null,this.date=null,this.range=[],this.revisionID="",this.isContentRemoved=!1,this.isTableRevision=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,this.author=t,(0,a.isNullOrUndefined)(this.author)&&(this.author="Unknown"),this.date=i,this.owner=e}return e.prototype.handleAcceptReject=function(e,t){this.owner.selectionModule.selectRevision(this);var i=this.owner.selectionModule,n=i.start,r=i.end;i.start.isExistBefore(i.end)||(n=i.end,r=i.start);var o,s=i.getParagraphInfo(n),l=!(0,a.isNullOrUndefined)(e)&&("MoveFrom"===this.revisionType||"Deletion"===this.revisionType)&&e||("Insertion"===this.revisionType||"MoveTo"===this.revisionType)&&!e;if(l){var d=this.owner.editorModule.getSelectedComments();d.commentEndInfo.length>0||d.commentStartInfo.length>0?o=this.owner.editorModule.checkAndRemoveComments(!1,!0):l=!1}this.owner.editorModule.initHistory(e?"Accept Change":"Reject Change");var h=i.getHyperlinkField();if(e&&"Deletion"===this.revisionType&&!(0,a.isNullOrUndefined)(h)&&-1!==this.range.indexOf(h)&&-1!==this.range.indexOf(h.fieldEnd)&&this.range.indexOf(h.fieldSeparator)===this.range.indexOf(h.fieldEnd)-1&&(this.owner.editorHistoryModule.currentBaseHistoryInfo.isHyperlinkField=!0),this.owner.editorHistoryModule.currentBaseHistoryInfo.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,this)),"Deletion"===this.revisionType?(s=i.getParagraphInfo(this.owner.selectionModule.start),i.editPosition=this.owner.selectionModule.getHierarchicalIndex(s.paragraph,s.offset.toString())):i.editPosition=this.owner.selectionModule.getHierarchicalIndex(s.paragraph,s.offset.toString()),this.owner.editorModule.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType){this.owner.isShiftingEnabled=!0;for(var c=0;this.range.length>0&&(this.range[c]instanceof ql||this.range[c]instanceof ka||this.range[c]instanceof Ca);){if(this.range[c]instanceof td&&e&&"Deletion"===this.revisionType){var p=this.range[c];this.owner.documentHelper.bookmarks.containsKey(p.name)&&this.owner.documentHelper.bookmarks.remove(p.name)}this.unlinkRangeItem(this.range[c],this,e,n,r)?c++:c=0}}if(this.isTableRevision=!1,this.isContentRemoved){var u=i.getTextPosBasedOnLogicalIndex(i.editPosition);this.owner.selectionModule.selectContent(u,!0),this.owner.editorModule.updateEndPosition()}else i.selectRange(n,r),this.owner.editorModule.updateHistoryPosition(r,!1);if(this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"BackSpace"!==this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistoryModule){this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistoryModule.currentBaseHistoryInfo.action="TrackingPageBreak",this.owner.trackChangesPane.isTrackingPageBreak=!1);var g=this.owner.editorHistoryModule;if(!g.currentHistoryInfo||"Accept All"!==g.currentHistoryInfo.action&&"Reject All"!==g.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),g.updateHistory(),l&&this.owner.editorHistory&&!(0,a.isNullOrUndefined)(this.owner.editorHistory.currentHistoryInfo)){for(var m=0;m<o.length;m++)this.owner.editorModule.initInsertInline(o[m],!1);this.owner.editorHistory.currentHistoryInfo.endPosition=this.owner.selection.startOffset,this.owner.editorHistory.updateComplexHistory()}}if(t&&this.owner.selectionModule.start.paragraph.isInsideTable){var f=this.owner.selectionModule.start.paragraph.containerWidget.ownerTable;this.owner.documentHelper.layout.reLayoutTable(f)}this.owner.editorModule.reLayout(this.owner.selectionModule),s.paragraph.isInHeaderFooter&&this.owner.editorModule.updateHeaderFooterWidget()},e.prototype.handleGroupAcceptReject=function(e){if(this.owner.trackChangesPane.tableRevisions.containsKey(this)){this.owner.editorModule.initComplexHistory(e?"Accept All":"Reject All");for(var t=this.owner.trackChangesPane.tableRevisions.get(this),i=t.length-1;i>=0;i--)e?t[i].handleAcceptReject(!0):t[i].handleAcceptReject(!1);if(this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateComplexHistory(),this.owner.selectionModule.start.paragraph.isInsideTable){var n=this.owner.selectionModule.start.paragraph.containerWidget.ownerTable;this.owner.documentHelper.layout.reLayoutTable(n)}}},e.prototype.accept=function(){var e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Accept",source:this};this.owner.trigger(B,e),e.cancel||this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof Ca&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!0):this.handleAcceptReject(!0,!0))},e.prototype.reject=function(){var e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Reject",source:this};this.owner.trigger(B,e),e.cancel||this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof Ca&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!1):this.handleAcceptReject(!1,!0))},e.prototype.select=function(){this.owner.selectionModule.selectRevision(this)},e.prototype.unlinkRangeItem=function(e,t,i,n,r){if(this.isTableRevision)return this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1;var o=!(0,a.isNullOrUndefined)(i)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&i||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!i;if(this.owner.selectionModule.isTOC()){if(o)this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistoryModule.currentBaseHistoryInfo.action="BackSpace";else{for(;this.range.length>0;){var s=this.range[0];this.removeRangeRevisionForItem(s),0===t.range.length&&this.owner.revisions.remove(t)}this.owner.editorModule.addRemovedNodes(this.revisionID),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="AcceptTOC"}return!1}if(e instanceof ql&&!this.canSkipTableItems)if(o){if(this.skipeElementRemoval(e))return this.skipUnLinkElement=!0,!0;this.owner.editorModule.addRemovedNodes(e.clone())}else{var l=this.owner.selectionModule.getHyperlinkField();if(i||(0,a.isNullOrUndefined)(l)||l!=e||(0,a.isNullOrUndefined)(l.fieldEnd))this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(n,r);else{if(this.owner.editorModule.initComplexHistory("ClearRevisions"),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(n,r),!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule)){this.owner.editorHistoryModule.currentBaseHistoryInfo.isHyperlinkField=!0;var d=this.owner.selectionModule.getParagraphInfo(r),h=this.owner.selectionModule.getHierarchicalIndex(d.paragraph,d.offset.toString());this.owner.editorHistoryModule.currentBaseHistoryInfo.endPosition=h,this.owner.editorHistoryModule.currentBaseHistoryInfo.selectionEnd=h,this.owner.editorHistoryModule.updateHistory()}this.owner.enableTrackChanges?(this.owner.enableTrackChanges=!1,this.owner.editorModule.updateHyperlinkFormat(this.owner.selectionModule),this.owner.enableTrackChanges=!0):this.owner.editorModule.updateHyperlinkFormat(this.owner.selectionModule),this.owner.editorHistoryModule&&!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentHistoryInfo)&&this.owner.editorHistoryModule.updateComplexHistory()}this.owner.trackChangesPane.isTrackingPageBreak=!1}else if(!this.canSkipTableItems&&e instanceof ka&&!o)this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(n,r);else if(e instanceof Ca&&!o){this.isTableRevision=!0;var c=e.ownerBase.ownerTable,p=e.ownerBase;this.owner.editorHistoryModule.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editorModule.cloneTableToHistoryInfo(c.combineWidget(this.owner.viewer))}if(o=o&&!this.canSkipTableItems,e instanceof ql&&o){var u=e.line.paragraph;if(this.removeRevisionItemsFromRange(e),e instanceof Yl?"Footnote"===e.footnoteType?this.owner.editorModule.removeFootnote(e):this.owner.editorModule.removeEndnote(e):e instanceof hd&&this.owner.editorModule.removeDeletedShapeRevision(e),this.removeItem(e),this.isContentRemoved=!0,!(0,a.isNullOrUndefined)(u)&&!(0,a.isNullOrUndefined)(u.bodyWidget)&&u.bodyWidget instanceof Bl&&((0,a.isNullOrUndefined)(u.bodyWidget.page)||!(0,a.isNullOrUndefined)(u.bodyWidget.page)&&-1===u.bodyWidget.page.index)||this.owner.documentHelper.layout.reLayoutParagraph(u,0,0),(0,a.isNullOrUndefined)(u.childWidgets)){var g=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.owner.selectionModule.editPosition);this.owner.selectionModule.selectContent(g,!0)}}else if(e instanceof ka&&o){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(e),1===t.range.length)this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,!0);else{this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,!0),this.removeRevisionFromPara(n,r);var m=t.range.indexOf(e);for(t.range.splice(m,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])}this.owner.editorHistoryModule.currentBaseHistoryInfo.action="BackSpace",this.owner.editorHistoryModule.currentBaseHistoryInfo.isAcceptOrReject=i?"Accept":"Reject"}else if(e instanceof Ca&&o){c=(c=e.ownerBase.ownerTable).combineWidget(this.owner.viewer);p=e.ownerBase;this.removeRevisionItemsFromRange(e),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="DeleteCells",this.owner.editorModule.cloneTableToHistoryInfo(c),this.owner.editorModule.removeDeletedCellRevision(p),this.isContentRemoved=!0,c.removeChild(c.childWidgets.indexOf(p)),this.canSkipTableItems=!0,this.owner.editorModule.removeFieldInBlock(p),this.owner.editorModule.removeFieldInBlock(p,!0),this.owner.editorModule.removeFieldInBlock(p,void 0,!0),0===c.childWidgets.length?(this.owner.selectionModule.editPosition=this.owner.selectionModule.getHierarchicalIndex(c,"0"),this.owner.editorModule.removeBlock(c)):this.owner.editorModule.updateTable(c,!0)}return e instanceof Ca&&o||this.skipUnLinkElement||(this.removeRangeRevisionForItem(e),o&&e instanceof td&&this.owner.editorModule.removedBookmarkElements.push(e),e instanceof td&&this.owner.documentHelper.bookmarks.containsKey(e.name)&&(this.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(this.owner.editorHistory.currentBaseHistoryInfo)&&this.owner.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:e.name}),this.owner.documentHelper.bookmarks.remove(e.name))),0===t.range.length&&this.owner.revisions.remove(t),!1},e.prototype.removeRevisionFromPara=function(e,t){for(var i=this.owner.selectionModule.getParagraphInfo(e),n=this.owner.selectionModule.getParagraphInfo(t),r=i.paragraph;r instanceof Rl;){if(r.characterFormat.revisions.length>0)for(var o=0;o<r.characterFormat.revisions.length;o++)if(0===r.characterFormat.revisions[o].range.length){var s=r.characterFormat.revisions.indexOf(r.characterFormat.revisions[o]);r.characterFormat.revisions.splice(s,1),o--}r=n.paragraph===r?void 0:r.nextWidget}},e.prototype.updateRevisionID=function(){for(this.owner.editorModule.addRemovedNodes(this.revisionID);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0],!0);this.owner.trackChangesPane.updateCurrentTrackChanges(this)},e.prototype.removeRevisionItemsFromRange=function(e){if(e.revisions.length>0)for(var t=0;t<e.revisions.length;t++){var i=e.revisions[t];if(this.revisionID!==i.revisionID){var n=i.range.indexOf(e);e.revisions[t].range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e.revisions[t])}0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.removeRangeRevisionForItem=function(e,t){var i=e.revisions.indexOf(this);if(i>=0){e.revisions.splice(i,1);var n=this.range.indexOf(e);this.range.splice(n,1),t||this.owner.trackChangesPane.updateCurrentTrackChanges(this)}},e.prototype.skipeElementRemoval=function(e){var t=e.paragraph;if(t.characterFormat.revisions.length>0)for(var i=0;i<t.characterFormat.revisions.length;i++){var n=t.characterFormat.revisions[i];if(n.range.indexOf(e)>=0&&n.revisionID===this.revisionID)return!0}return!1},e.prototype.removeRevisionFromRow=function(e){this.owner.editorModule.unlinkRangeFromRevision(e.rowFormat);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.owner.editorModule.removeRevisionForCell(i,!1)}},e.prototype.removeItem=function(e){var t=e.line.paragraph;this.owner.editorModule.unLinkFieldCharacter(e);var i=e.line.children.indexOf(e),n=e.previousNode;e.line.children.splice(i,1),(0,a.isNullOrUndefined)(n)||this.owner.editorModule.combineElementRevisionToPrevNxt(n);var r=e.line.paragraph.floatingElements.indexOf(e);e.line.paragraph.floatingElements.splice(r,1);var o=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);o>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(o,1),this.owner.editorModule.removeEmptyLine(t)},e.prototype.canSkipCloning=function(){if(!(0,a.isNullOrUndefined)(this.owner)&&this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"DeleteCells"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action)return!0;return!1},e.prototype.destroy=function(){this.author=void 0,this.revisionType=void 0,this.revisionID=void 0,this.date=void 0,this.range=[],this.range=void 0,this.owner=void 0},e.prototype.clone=function(){if(this.canSkipCloning())return this;var t=new e(void 0,this.author,this.date);return t.revisionID=this.revisionID,t.revisionType=this.revisionType,t},e.cloneRevisions=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].revisionID);return t},e}(),Ia=function(){function e(e){this.changes=[],this.skipGroupAcceptReject=!1,this.owner=e}return e.prototype.get=function(e){if(e>=this.changes.length||e<0)throw new ReferenceError("Provided index is not within the range");return this.changes[e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){if(!((0,a.isNullOrUndefined)(e)||this.changes.indexOf(e)<0)&&(this.changes.splice(this.changes.indexOf(e),1),-1!==this.owner.trackChangesPane.revisions.indexOf(e))){var t=this.owner.trackChangesPane.revisions.indexOf(e),i=!(this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.get(e)[this.owner.trackChangesPane.tableRevisions.get(e).length-1]!==e),n=this.owner.trackChangesPane.changes.get(e);i&&this.owner.trackChangesPane.changesInfoDiv.removeChild(n.outerSingleDiv),this.owner.trackChangesPane.revisions.splice(t,1),this.owner.trackChangesPane.changes.remove(e),this.owner.trackChangesPane.renderedChanges.containsKey(e)&&this.owner.trackChangesPane.renderedChanges.remove(e),this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.remove(e)}},e.prototype.acceptAll=function(){this.owner.isReadOnly||this.owner.documentHelper.isTrackedOnlyMode||this.handleRevisionCollection(!0)},e.prototype.rejectAll=function(){this.owner.isReadOnly||this.owner.documentHelper.isTrackedOnlyMode||this.handleRevisionCollection(!1)},e.prototype.handleRevisionCollection=function(e,t){this.skipGroupAcceptReject=!0;var i=this.owner.selectionModule,n=i.start,r=i.end,o=t||this.changes;if(!(o.length<=0)){for(i.start.isExistBefore(i.end)||(n=i.end,r=i.start),n=n.clone(),r=r.clone(),e?this.owner.editorModule.initComplexHistory("Accept All"):this.owner.editorModule.initComplexHistory("Reject All");o.length>0;)e?o[0].accept():o[0].reject(),t&&o.splice(0,1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget();if(!(0,a.isNullOrUndefined)(i.editPosition)){var s=i.getTextPosBasedOnLogicalIndex(i.editPosition);this.owner.selectionModule.selectContent(s,!0)}this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.updateComplexHistory(),(0,a.isNullOrUndefined)(i.editPosition)&&this.owner.editorHistoryModule.undoStack.pop()),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.reLayout(this.owner.selectionModule,!1),this.owner.editorModule.isSkipOperationsBuild=!1,this.skipGroupAcceptReject=!1}},e.prototype.clear=function(){this.changes=[]},e.prototype.destroy=function(){if(this.changes){for(var e=0;e<this.changes.length;e++){this.changes[e].destroy()}this.changes=[]}this.changes=void 0,this.owner=void 0},e}(),ka=function(){function e(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.removedIds=[],this.revisions=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"characterSpacing",{get:function(){return this.getPropertyValue("characterSpacing")},set:function(e){this.setPropertyValue("characterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this.getPropertyValue("scaling")},set:function(e){this.setPropertyValue("scaling",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underlineColor",{get:function(){return this.getPropertyValue("underlineColor")},set:function(e){this.setPropertyValue("underlineColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontHintType",{get:function(){return this.getPropertyValue("fontHintType")},set:function(e){this.setPropertyValue("fontHintType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdBidi",{get:function(){return this.getPropertyValue("localeIdBidi")},set:function(e){this.setPropertyValue("localeIdBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdFarEast",{get:function(){return this.getPropertyValue("localeIdFarEast")},set:function(e){this.setPropertyValue("localeIdFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdAscii",{get:function(){return this.getPropertyValue("localeIdAscii")},set:function(e){this.setPropertyValue("localeIdAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(e){this.setPropertyValue("bdo",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(e){this.setPropertyValue("boldBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(e){this.setPropertyValue("italicBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(e){this.setPropertyValue("fontSizeBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(e){this.setPropertyValue("fontFamilyBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(e){this.setPropertyValue("allCaps",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lowercase",{get:function(){return this.getPropertyValue("Lowercase")},set:function(e){this.setPropertyValue("Lowercase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Uppercase",{get:function(){return this.getPropertyValue("Uppercase")},set:function(e){this.setPropertyValue("Uppercase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SentenceCase",{get:function(){return this.getPropertyValue("SentenceCase")},set:function(e){this.setPropertyValue("SentenceCase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ToggleCase",{get:function(){return this.getPropertyValue("ToggleCase")},set:function(e){this.setPropertyValue("ToggleCase",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CapitalizeEachWord",{get:function(){return this.getPropertyValue("CapitalizeEachWord")},set:function(e){this.setPropertyValue("CapitalizeEachWord",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"complexScript",{get:function(){return this.getPropertyValue("complexScript")},set:function(e){this.setPropertyValue("complexScript",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyFarEast",{get:function(){return this.getPropertyValue("fontFamilyFarEast")},set:function(e){this.setPropertyValue("fontFamilyFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyAscii",{get:function(){return this.getPropertyValue("fontFamilyAscii")},set:function(e){this.setPropertyValue("fontFamilyAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyNonFarEast",{get:function(){return this.getPropertyValue("fontFamilyNonFarEast")},set:function(e){this.setPropertyValue("fontFamilyNonFarEast",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(i))return this.uniqueCharacterFormat.propertiesHash.get(i)}else{var n=this.checkCharacterStyle(t);if(!(0,a.isNullOrUndefined)(n))return n;if(!(0,a.isNullOrUndefined)(this.baseCharStyle)){var r=void 0,o=void 0;if((0,a.isNullOrUndefined)(this.ownerBase)||(r=this.ownerBase.paragraph,o=this.ownerBase.line),!(0,a.isNullOrUndefined)(r)&&!(0,a.isNullOrUndefined)(o))for(var s=o.children.length,l=0;l<s;l++){var h=this.ownerBase.line.children[l];if(h instanceof Zl){var c=h.text;if(c.startsWith("HYPERLINK"))-1!==c.indexOf("_Toc")&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle)}}}var p=this.checkBaseStyle(t);if(!(0,a.isNullOrUndefined)(p))return p}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var i=d.getPropertyType(e.uniqueFormatType,t),n=this.documentCharacterFormat();return(0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(n.uniqueCharacterFormat)||!n.uniqueCharacterFormat.propertiesHash.containsKey(i)?e.getPropertyDefaultValue(t):n.uniqueCharacterFormat.propertiesHash.get(i)},e.prototype.documentCharacterFormat=function(){var e;if(!(0,a.isNullOrUndefined)(this.ownerBase)&&(this.ownerBase instanceof ql?e=this.ownerBase.paragraph:this.ownerBase instanceof Rl&&(e=this.ownerBase),e)){var t=e.bodyWidget;if(t&&t.page&&t.page.documentHelper)return t.page.documentHelper.characterFormat}},e.prototype.checkBaseStyle=function(t){var i;for((0,a.isNullOrUndefined)(this.ownerBase)||((0,a.isNullOrUndefined)(this.ownerBase.paragraph)?this.ownerBase instanceof Rl&&!(0,a.isNullOrUndefined)(this.ownerBase.paragraphFormat)?i=this.ownerBase.paragraphFormat.baseStyle:(0,a.isNullOrUndefined)(this.ownerBase instanceof Wa)||(i=this.ownerBase.basedOn):i=this.ownerBase.paragraph.paragraphFormat.baseStyle);!(0,a.isNullOrUndefined)(i)&&!i.characterFormat.hasValue(t);){if(!(0,a.isNullOrUndefined)(i.link)&&(0,a.isNullOrUndefined)(i.basedOn)&&"Character"==i.link.type&&i.link.characterFormat.hasValue(t)&&"Normal"!=i.name){i=i.link;break}i=i.basedOn}if(!(0,a.isNullOrUndefined)(i)){var n=d.getPropertyType(e.uniqueFormatType,t);return i.characterFormat.uniqueCharacterFormat.propertiesHash.get(n)}},e.prototype.checkCharacterStyle=function(t){var i=this.baseCharStyle;if(!(0,a.isNullOrUndefined)(i))for(;!(0,a.isNullOrUndefined)(i)&&"Default Paragraph Font"!==i.name;){if(i.characterFormat.hasValue(t)){if("bold"===t&&!(0,a.isNullOrUndefined)(this.ownerBase)&&this.ownerBase instanceof Zl&&!(0,a.isNullOrUndefined)(this.ownerBase.paragraph)&&!(0,a.isNullOrUndefined)(this.ownerBase.paragraph.paragraphFormat.baseStyle)&&this.ownerBase.paragraph.paragraphFormat.baseStyle instanceof Wa&&this.ownerBase.paragraph.paragraphFormat.baseStyle.characterFormat&&i.name!==this.ownerBase.paragraph.paragraphFormat.baseStyle.name&&i.characterFormat.hasValue(t)===this.ownerBase.paragraph.paragraphFormat.baseStyle.characterFormat.hasValue(t))return this.hasValue(t);var n=d.getPropertyType(e.uniqueFormatType,t);return i.characterFormat.uniqueCharacterFormat.propertiesHash.get(n)}i=i.basedOn}},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueCharacterFormat)||(0,a.isNullOrUndefined)(this.uniqueCharacterFormat.propertiesHash)&&(0,a.isNullOrUndefined)(this.uniqueCharacterFormat.uniqueFormatType)&&(0,a.isNullOrUndefined)(this.uniqueCharacterFormat.referenceCount))this.initializeUniqueCharacterFormat(t,i);else{var n=d.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,t);if(this.uniqueCharacterFormat.propertiesHash.containsKey(n)&&this.uniqueCharacterFormat.propertiesHash.get(n)===i)return;this.uniqueCharacterFormat=e.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,t,i)}},e.prototype.initializeUniqueCharacterFormat=function(t,i){var n=new l;this.addUniqueCharacterFormat("fontColor",t,i,n),this.addUniqueCharacterFormat("fontFamily",t,i,n),this.addUniqueCharacterFormat("fontSize",t,i,n),this.addUniqueCharacterFormat("bold",t,i,n),this.addUniqueCharacterFormat("italic",t,i,n),this.addUniqueCharacterFormat("underline",t,i,n),this.addUniqueCharacterFormat("underlineColor",t,i,n),this.addUniqueCharacterFormat("fontHintType",t,i,n),this.addUniqueCharacterFormat("strikethrough",t,i,n),this.addUniqueCharacterFormat("baselineAlignment",t,i,n),this.addUniqueCharacterFormat("highlightColor",t,i,n),this.addUniqueCharacterFormat("styleName",t,i,n),this.addUniqueCharacterFormat("bidi",t,i,n),this.addUniqueCharacterFormat("bdo",t,i,n),this.addUniqueCharacterFormat("fontFamilyBidi",t,i,n),this.addUniqueCharacterFormat("fontSizeBidi",t,i,n),this.addUniqueCharacterFormat("boldBidi",t,i,n),this.addUniqueCharacterFormat("italicBidi",t,i,n),this.addUniqueCharacterFormat("allCaps",t,i,n),this.addUniqueCharacterFormat("Uppercase",t,i,n),this.addUniqueCharacterFormat("Lowercase",t,i,n),this.addUniqueCharacterFormat("SentenceCase",t,i,n),this.addUniqueCharacterFormat("ToggleCase",t,i,n),this.addUniqueCharacterFormat("CapitalizeEachWord",t,i,n),this.addUniqueCharacterFormat("localeIdAscii",t,i,n),this.addUniqueCharacterFormat("localeIdFarEast",t,i,n),this.addUniqueCharacterFormat("localeIdBidi",t,i,n),this.addUniqueCharacterFormat("fontFamilyFarEast",t,i,n),this.addUniqueCharacterFormat("fontFamilyAscii",t,i,n),this.addUniqueCharacterFormat("fontFamilyNonFarEast",t,i,n),this.addUniqueCharacterFormat("complexScript",t,i,n),this.addUniqueCharacterFormat("characterSpacing",t,i,n),this.addUniqueCharacterFormat("scaling",t,i,n),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueCharacterFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":case"bidi":case"boldBidi":case"italicBidi":case"allCaps":case"Uppercase":case"Lowercase":case"CapitalizeEachWord":case"SentenceCase":case"ToggleCase":case"complexScript":t=!1;break;case"fontSize":case"fontSizeBidi":t=11;break;case"underline":case"strikethrough":case"bdo":t="None";break;case"underlineColor":case"fontFamilyFarEast":case"fontFamilyAscii":case"fontFamilyNonFarEast":t=void 0;break;case"fontHintType":t="Default";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":case"fontFamilyBidi":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"localeIdAscii":case"localeIdFarEast":case"localeIdBidi":case"characterSpacing":t=0;break;case"scaling":t=100}return t},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.bidi===e.bidi&&this.bdo===e.bdo&&this.allCaps===e.allCaps&&this.Uppercase===e.Uppercase&&this.Lowercase===e.Lowercase&&this.ToggleCase===e.ToggleCase&&this.SentenceCase===e.SentenceCase&&this.CapitalizeEachWord===e.CapitalizeEachWord&&this.localeIdBidi===e.localeIdBidi&&this.localeIdAscii===e.localeIdAscii&&this.localeIdFarEast===e.localeIdFarEast&&this.complexScript===e.complexScript&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyBidi===e.fontFamilyBidi&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.characterSpacing===e.characterSpacing&&this.scaling===e.scaling&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueCharacterFormat=this.uniqueCharacterFormat,t.baseCharStyle=this.baseCharStyle,this.revisions.length>0?t.removedIds=xa.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueCharacterFormat)&&!(0,a.isNullOrUndefined)(this.uniqueCharacterFormat.propertiesHash)){var t=d.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);return this.uniqueCharacterFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){(0,a.isNullOrUndefined)(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.uniqueCharacterFormat)||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0,this.ownerBase=void 0},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(!(0,a.isNullOrUndefined)(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),(0,a.isNullOrUndefined)(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle),e.revisions.length>0?this.removedIds=xa.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.isEqualTocFormat=function(e){return this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.copyTocFormat=function(e){(0,a.isNullOrUndefined)(e.bold)||(this.bold=e.bold),(0,a.isNullOrUndefined)(e.italic)||(this.italic=e.italic),(0,a.isNullOrUndefined)(e.strikethrough)||(this.strikethrough=e.strikethrough),(0,a.isNullOrUndefined)(e.highlightColor)||(this.highlightColor=e.highlightColor),(0,a.isNullOrUndefined)(e.fontFamily)||(this.fontFamily=e.fontFamily,this.fontFamilyAscii=e.fontFamily,this.fontFamilyFarEast=e.fontFamily,this.fontFamilyNonFarEast=e.fontFamily)},e.prototype.updateUniqueCharacterFormat=function(t){var i=void 0;this.uniqueCharacterFormat&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0)),this.uniqueCharacterFormat=new d(e.uniqueFormatType),(0,a.isNullOrUndefined)(i)&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat)),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(i,e.uniqueFormatType)},e.clear=function(){this.uniqueCharacterFormats.clear()},e.prototype.applyStyle=function(e){this.baseCharStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){(0,a.isNullOrUndefined)(this.getValue("bold"))&&(this.bold=e.getValue("bold")),(0,a.isNullOrUndefined)(this.getValue("italic"))&&(this.italic=e.getValue("italic")),(0,a.isNullOrUndefined)(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),(0,a.isNullOrUndefined)(this.getValue("boldBidi"))&&(this.boldBidi=e.getValue("boldBidi")),(0,a.isNullOrUndefined)(this.getValue("italicBidi"))&&(this.italicBidi=e.getValue("italicBidi")),(0,a.isNullOrUndefined)(this.getValue("fontSizeBidi"))&&(this.fontSizeBidi=e.getValue("fontSizeBidi")),(0,a.isNullOrUndefined)(this.getValue("characterSpacing"))&&(this.characterSpacing=e.getValue("characterSpacing")),(0,a.isNullOrUndefined)(this.getValue("scaling"))&&(this.scaling=e.getValue("scaling")),(0,a.isNullOrUndefined)(this.getValue("fontFamily"))?this.fontFamily=e.getValue("fontFamily"):((0,a.isNullOrUndefined)(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamily")),(0,a.isNullOrUndefined)(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamily")),(0,a.isNullOrUndefined)(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamily"))),(0,a.isNullOrUndefined)(this.getValue("underline"))&&(this.underline=e.getValue("underline")),(0,a.isNullOrUndefined)(this.getValue("fontHintType"))&&(this.fontHintType=e.getValue("fontHintType")),(0,a.isNullOrUndefined)(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),(0,a.isNullOrUndefined)(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),(0,a.isNullOrUndefined)(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),(0,a.isNullOrUndefined)(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor")),(0,a.isNullOrUndefined)(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),(0,a.isNullOrUndefined)(this.getValue("bdo"))&&(this.bdo=e.getValue("bdo")),(0,a.isNullOrUndefined)(this.getValue("allCaps"))&&(this.allCaps=e.getValue("allCaps")),(0,a.isNullOrUndefined)(this.getValue("Lowercase"))&&(this.Lowercase=e.getValue("Lowercase")),(0,a.isNullOrUndefined)(this.getValue("SentenceCase"))&&(this.SentenceCase=e.getValue("SentenceCase")),(0,a.isNullOrUndefined)(this.getValue("ToggleCase"))&&(this.ToggleCase=e.getValue("ToggleCase")),(0,a.isNullOrUndefined)(this.getValue("CapitalizeEachWord"))&&(this.CapitalizeEachWord=e.getValue("CapitalizeEachWord")),(0,a.isNullOrUndefined)(this.getValue("Uppercase"))&&(this.Uppercase=e.getValue("Uppercase")),(0,a.isNullOrUndefined)(this.getValue("localeIdBidi"))&&(this.localeIdBidi=e.getValue("localeIdBidi")),(0,a.isNullOrUndefined)(this.getValue("localeIdAscii"))&&(this.localeIdAscii=e.getValue("localeIdAscii")),(0,a.isNullOrUndefined)(this.getValue("localeIdFarEast"))&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),(0,a.isNullOrUndefined)(this.getValue("complexScript"))&&(this.complexScript=e.getValue("complexScript")),(0,a.isNullOrUndefined)(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamilyAscii")),(0,a.isNullOrUndefined)(this.getValue("fontFamilyBidi"))&&(this.fontFamilyBidi=e.getValue("fontFamilyBidi")),(0,a.isNullOrUndefined)(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamilyFarEast")),(0,a.isNullOrUndefined)(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamilyNonFarEast"))},e.prototype.assignFormat=function(e){e.hasValue("bold")&&(this.bold=e.getValue("bold")),e.hasValue("italic")&&(this.italic=e.getValue("italic")),e.hasValue("fontSize")&&(this.fontSize=e.getValue("fontSize")),e.hasValue("characterSpacing")&&(this.characterSpacing=e.getValue("characterSpacing")),e.hasValue("scaling")&&(this.scaling=e.getValue("scaling")),e.hasValue("fontFamily")&&(this.fontFamily=e.getValue("fontFamily"),this.fontFamilyFarEast=e.getValue("fontFamily"),this.fontFamilyAscii=e.getValue("fontFamily"),this.fontFamilyNonFarEast=e.getValue("fontFamily"),this.fontFamilyBidi=e.getValue("fontFamily")),e.hasValue("underline")&&(this.underline=e.getValue("underline")),e.hasValue("fontHintType")&&(this.fontHintType=e.getValue("fontHintType")),e.hasValue("strikethrough")&&(this.strikethrough=e.getValue("strikethrough")),e.hasValue("baselineAlignment")&&(this.baselineAlignment=e.getValue("baselineAlignment")),e.hasValue("highlightColor")&&(this.highlightColor=e.getValue("highlightColor")),e.hasValue("fontColor")&&(this.fontColor=e.getValue("fontColor")),e.hasValue("bidi")&&(this.bidi=e.getValue("bidi")),e.hasValue("bdo")&&(this.bdo=e.getValue("bdo")),e.hasValue("allCaps")&&(this.allCaps=e.getValue("allCaps")),e.hasValue("Lowercase")&&(this.Lowercase=e.getValue("Lowercase")),e.hasValue("SentenceCase")&&(this.SentenceCase=e.getValue("SentenceCase")),e.hasValue("ToggleCase")&&(this.ToggleCase=e.getValue("ToggleCase")),e.hasValue("CapitalizeEachWord")&&(this.CapitalizeEachWord=e.getValue("CapitalizeEachWord")),e.hasValue("Uppercase")&&(this.Uppercase=e.getValue("Uppercase")),e.hasValue("localeIdBidi")&&(this.localeIdBidi=e.getValue("localeIdBidi")),e.hasValue("localeIdAscii")&&(this.localeIdAscii=e.getValue("localeIdAscii")),e.hasValue("localeIdFarEast")&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),e.hasValue("complexScript")&&(this.complexScript=e.getValue("complexScript"))},e.prototype.hasValueWithParent=function(e){var t=this.hasValue(e);!t&&!(0,a.isNullOrUndefined)(this.baseCharStyle)&&this.baseCharStyle instanceof Oa&&(t=this.baseCharStyle.characterFormat.hasValue(e));var i=this.documentCharacterFormat();return t||(0,a.isNullOrUndefined)(i)||(t=i.hasValue(e)),t},e.uniqueCharacterFormats=new h,e.uniqueFormatType=2,e}(),Fa=m(50),Pa=function(){function e(){}return e.insert=function(e,t,i){return t>=0?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},e.replaceSpecialChars=function(e){return e=(e=(e=e.replace("^[\\s]*","")).replace("^[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\“\\”\\//0123456789]+","")).replace("[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\“\\”\\//0123456789]+$","")},e.getSpellCheckData=function(e){for(var t=[],i=0,n=(e=(e=(e=(e=(e=(e=(e=e.replace("\r\n"," ")).replace("\n"," ")).replace("\r"," ")).replace("\v"," ")).replace("\t"," ")).replace("/"," ")).replace(String.fromCharCode(160)," ")).split(" ");i<n.length;i++){var r=n[i],o={};o.Text=this.replaceSpecialChars(r),o.HasSpellError=!1,t.push(o)}return t},e.checkTextFormat=function(e){return!(!/^(M{0,3})(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/i.test(e)&&!/^[0-9]+$/.test(e))},e.sanitizeString=function(e){return(0,a.isNullOrUndefined)(e)?"":a.SanitizeHtmlHelper.sanitize(e).replace(/&amp;/g,"&").replace(/&nbsp;/g,String.fromCharCode(160)).replace(/&gt;/g,">").replace(/&lt;/g,"<")},e.getSfdtDocument=function(e){if(e=e instanceof Object?e:JSON.parse(e),!(0,a.isNullOrUndefined)(e.sfdt)){var t=new Fa.ZipArchive;t.open(JSON.stringify(e.sfdt));var i=t.items[0],n=new Uint8Array(i.data),r=new TextDecoder("utf-8").decode(n);e=JSON.parse(r)}return e},e.generateUniqueId=function(e,t){var i=!(0,a.isNullOrUndefined)(t),n=Math.floor(1e8*Math.random());return i?this.isSameListIDExists(n,void 0,t,i)?this.generateUniqueId(void 0,t):n:this.isSameListIDExists(n,e)?this.generateUniqueId(e):n},e.generateHexDecimal=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},e.numberToHexDecimal=function(e){return(e>>>0).toString(16).toUpperCase()},e.isSameListIDExists=function(e,t,i,n){if(n)for(var r=0;r<i.length;r++){if(e===i[parseInt(r.toString(),10)].nsid)return!0}else for(var o=0;o<t.length;o++){if(e===t[parseInt(o.toString(),10)].nsid)return!0}return!1},e.remove=function(e,t){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},e.indexOfAny=function(e,t){for(var i=void 0,n=0;n<t.length;n++){var r=e.indexOf(t[parseInt(n.toString(),10)]);(-1!==r&&(0,a.isNullOrUndefined)(i)||-1!==r&&r<i)&&(i=r)}return(0,a.isNullOrUndefined)(i)?-1:i},e.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>=0;i--)for(var n=0;n<=t.length-1;n++)if(e[parseInt(i.toString(),10)]===t[parseInt(n.toString(),10)])return i;return-1},e.convertArgbToRgb=function(e){return e.length>=8?e.substr(0,6):e},e.convertRgbToHex=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},e.getNumberFromString=function(e){for(var t=[],i="",n=0,r=e;n<r.length;n++){var o=r[n];/\d|\./.test(o)?i+=o:i&&(t.push(parseFloat(i)),i="")}return i&&t.push(parseFloat(i)),parseFloat(t.join(""))},e.convertHexToRgb=function(e){var t,i,n;if(e){e=e.replace(/[^0-9A-â€Œâ€‹F]/gi,"");var r=parseInt(e,16);return 8===e.length?(t=r>>32&255,i=r>>16&255,n=r>>8&255):6===e.length&&(t=r>>16&255,i=r>>8&255,n=255&r),{r:t,g:i,b:n}}},e.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},e.convertNodeListToArray=function(e){var t=[];if(!(0,a.isNullOrUndefined)(e))for(var i=0;i<e.length;i++)t.push(e[parseInt(i.toString(),10)]);return t},e.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},e.isVeryDark=function(e){var t=e.substring(1);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<=60},e.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Middle";case 2:return"Bottom";default:return e}},e.convertPointToPixel=function(t){return t=e.round(t,5),e.round(96*t/72,5)},e.convertPixelToPoint=function(t){return e.round(72*t/96,5)},e.isLinkedFieldCharacter=function(e){return e instanceof _l&&0===e.fieldType?!(0,a.isNullOrUndefined)(e.fieldEnd):e instanceof _l&&2===e.fieldType?!(0,a.isNullOrUndefined)(e.fieldBegin)&&!(0,a.isNullOrUndefined)(e.fieldEnd):!(0,a.isNullOrUndefined)(e.fieldBegin)},e.removeSpace=function(e){if(!(0,a.isNullOrUndefined)(e)&&0!==e.length)for(var t=0;t<e.length;t++)" "===e.charAt(t)&&(e=e.replace(" ",""));return e},e.trimStart=function(e){for(var t=0;t<e.length&&" "===e[parseInt(t.toString(),10)];t++);return e.substring(t,e.length)},e.trimEnd=function(e){for(var t=e.length-1;t>=0&&" "===e[parseInt(t.toString(),10)];t--);return e.substring(0,t+1)},e.endsWith=function(e){return!(0,a.isNullOrUndefined)(e)&&0!==e.length&&" "===e[e.length-1]},e.addSpace=function(e){var t="";if(e>0)for(var i=0;i<e;i++)t+=" ";return t},e.getBoolValue=function(e){return e?1:0},e.getBoolInfo=function(e,t){return 1===t?this.getBoolValue(e):e},e.parseBoolValue=function(e){return e instanceof String?!(0,a.isNullOrUndefined)(e)&&"f"!==e&&"0"!==e&&"off"!==e&&"false"!==e:1==e},e.getBaselineAlignmentEnumValue=function(e){switch(e){case"Normal":return 0;case"Superscript":return 1;case"Subscript":return 2}},e.getUnderlineEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Words":return 2;case"Double":return 3;case"Dotted":return 4;case"Thick":return 5;case"Dash":return 6;case"DashLong":return 7;case"DotDash":return 8;case"DotDotDash":return 9;case"Wavy":return 10;case"DottedHeavy":return 11;case"DashHeavy":return 12;case"DashLongHeavy":return 13;case"DotDashHeavy":return 14;case"DotDotDashHeavy":return 15;case"WavyHeavy":return 16;case"WavyDouble":return 17}},e.getFontHintTypeEnumValue=function(e){switch(e){case"Default":return 0;case"EastAsia":return 1;case"CS":return 2}},e.getStrikeThroughEnumValue=function(e){switch(e){case"None":return 0;case"SingleStrike":return 1;case"DoubleStrike":return 2}},e.getHighlightColorEnumValue=function(e){switch(e){case"NoColor":return 0;case"Yellow":return 1;case"BrightGreen":return 2;case"Turquoise":return 3;case"Pink":return 4;case"Blue":return 5;case"Red":return 6;case"DarkBlue":return 7;case"Teal":return 8;case"Green":return 9;case"Violet":return 10;case"DarkRed":return 11;case"DarkYellow":return 12;case"Gray50":return 13;case"Gray25":return 14;case"Black":return 15}},e.getBiDirectionalOverride=function(e){switch(e){case"None":return 0;case"LTR":return 1;case"RTL":return 2}},e.getBreakClearType=function(e){switch(e){case"None":return 0;case"Left":return 1;case"Right":return 2;case"All":return 3}},e.getOutlineLevelEnumValue=function(e){switch(e){case"BodyText":return 0;case"Level1":return 1;case"Level2":return 2;case"Level3":return 3;case"Level4":return 4;case"Level5":return 5;case"Level6":return 6;case"Level7":return 7;case"Level8":return 8;case"Level9":return 9}},e.getTextAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Justify":return 3}},e.getLineStyleEnumValue=function(e){switch(e){case"Single":return 0;case"None":return 1;case"Dot":return 2;case"DashSmallGap":return 3;case"DashLargeGap":return 4;case"DashDot":return 5;case"DashDotDot":return 6;case"Double":return 7;case"Triple":return 8;case"ThinThickSmallGap":return 9;case"ThickThinSmallGap":return 10;case"ThinThickThinSmallGap":return 11;case"ThinThickMediumGap":return 12;case"ThickThinMediumGap":return 13;case"ThinThickThinMediumGap":return 14;case"ThinThickLargeGap":return 15;case"ThickThinLargeGap":return 16;case"ThinThickThinLargeGap":return 17;case"SingleWavy":return 18;case"DoubleWavy":return 19;case"DashDotStroked":return 20;case"Emboss3D":return 21;case"Engrave3D":return 22;case"Outset":return 23;case"Inset":return 24;case"Thick":return 25;case"Cleared":return 26}},e.getLineSpacingTypeEnumValue=function(e){switch(e){case"Multiple":return 0;case"AtLeast":return 1;case"Exactly":return 2}},e.writeBorder=function(t,i){var n={};return n[or[i]]=t.hasValue("color")?t.color:void 0,n[Ti[i]]=t.hasValue("hasNoneStyle")?e.getBoolInfo(t.hasNoneStyle,i):void 0,n[Oi[i]]=t.hasValue("lineStyle")?1==i?this.getLineStyleEnumValue(t.lineStyle):t.lineStyle:void 0,n[Bi[i]]=t.hasValue("lineWidth")?t.lineWidth:void 0,n[Si[i]]=t.hasValue("shadow")?e.getBoolInfo(t.shadow,i):void 0,n[Hs[i]]=t.hasValue("space")?t.space:void 0,n},e.writeBorders=function(e,t){var i={};return i[ur[t]]=this.writeBorder(e.getBorder("top"),t),i[fr[t]]=this.writeBorder(e.getBorder("left"),t),i[mr[t]]=this.writeBorder(e.getBorder("right"),t),i[gr[t]]=this.writeBorder(e.getBorder("bottom"),t),i[Ei[t]]=this.writeBorder(e.getBorder("horizontal"),t),i[Hi[t]]=this.writeBorder(e.getBorder("vertical"),t),i},e.writeParagraphFormat=function(t,i,n,r){r=(0,a.isNullOrUndefined)(r)?0:r,t[Et[r]]=this.writeBorders(n.borders,r),t[gt[r]]=i?n.leftIndent:n.getValue("leftIndent"),t[mt[r]]=i?n.rightIndent:n.getValue("rightIndent"),t[ft[r]]=i?n.firstLineIndent:n.getValue("firstLineIndent"),t[vt[r]]=i?1==r?this.getTextAlignmentEnumValue(n.textAlignment):n.textAlignment:1==r?this.getTextAlignmentEnumValue(n.getValue("textAlignment")):n.getValue("textAlignment"),t[wt[r]]=i?n.beforeSpacing:n.getValue("beforeSpacing"),t[yt[r]]=i?n.afterSpacing:n.getValue("afterSpacing"),t[Ct[r]]=i?e.getBoolInfo(n.spaceBeforeAuto,r):n.getValue("spaceBeforeAuto"),t[bt[r]]=i?e.getBoolInfo(n.spaceAfterAuto,r):n.getValue("spaceAfterAuto"),t[xt[r]]=i?n.lineSpacing:n.getValue("lineSpacing"),t[It[r]]=i?1==r?this.getLineSpacingTypeEnumValue(n.lineSpacingType):n.lineSpacingType:1==r?this.getLineSpacingTypeEnumValue(n.getValue("lineSpacingType")):n.getValue("lineSpacingType"),t[Je[r]]=(0,a.isNullOrUndefined)(n.baseStyle)?void 0:n.baseStyle.name,t[Tt[r]]=i?1==r?this.getOutlineLevelEnumValue(n.outlineLevel):n.outlineLevel:1==r?this.getOutlineLevelEnumValue(n.getValue("outlineLevel")):n.getValue("outlineLevel"),t[Ye[r]]=i?e.getBoolInfo(n.bidi,r):n.getValue("bidi"),t[St[r]]=i?e.getBoolInfo(n.keepLinesTogether,r):n.getValue("keepLinesTogether"),t[Ft[r]]=i?e.getBoolInfo(n.keepWithNext,r):n.getValue("keepWithNext"),t[Ht[r]]=i?e.getBoolInfo(n.contextualSpacing,r):n.getValue("contextualSpacing"),t[Pt[r]]=i?e.getBoolInfo(n.widowControl,r):n.getValue("widowControl")},e.writeCharacterFormat=function(t,i,n,r,o){r=(0,a.isNullOrUndefined)(r)?0:r,t[Ae[r]]=o||i?e.getBoolInfo(n.bold,r):n.getValue("bold"),t[Ue[r]]=o||i?e.getBoolInfo(n.italic,r):n.getValue("italic"),t[Ke[r]]=o?n.fontSize:i?this.toWriteInline(n,"fontSize"):n.getValue("fontSize"),t[Ze[r]]=o?n.fontFamily:i?this.toWriteInline(n,"fontFamily"):n.getValue("fontFamily"),t[Ve[r]]=o?n.underline:i?1==r?e.getUnderlineEnumValue(n.underline):n.underline:1==r?e.getUnderlineEnumValue(n.getValue("underline")):n.getValue("underline"),t[ze[r]]=o?n.underlineColor:i?this.toWriteInline(n,"underlineColor"):n.getValue("underlineColor"),t[qe[r]]=o?n.fontHintType:i?1==r?e.getFontHintTypeEnumValue(n.fontHintType):n.fontHintType:1==r?e.getFontHintTypeEnumValue(n.getValue("fontHintType")):n.getValue("fontHintType"),t[je[r]]=o?n.strikethrough:i?1==r?e.getStrikeThroughEnumValue(n.strikethrough):n.strikethrough:1==r?e.getStrikeThroughEnumValue(n.getValue("strikethrough")):n.getValue("strikethrough"),t[_e[r]]=o?n.baselineAlignment:i?1==r?e.getBaselineAlignmentEnumValue(n.baselineAlignment):n.baselineAlignment:1==r?e.getBaselineAlignmentEnumValue(n.getValue("baselineAlignment")):n.getValue("baselineAlignment"),t[Ge[r]]=o?n.highlightColor:i?1==r?e.getHighlightColorEnumValue(n.highlightColor):n.highlightColor:1==r?e.getHighlightColorEnumValue(n.getValue("highlightColor")):n.getValue("highlightColor"),t[Xe[r]]=o?n.fontColor:i?this.toWriteInline(n,"fontColor"):n.getValue("fontColor"),t[Je[r]]=(0,a.isNullOrUndefined)(n.baseCharStyle)?void 0:n.baseCharStyle.name,t[Ye[r]]=o?n.bidi:i?e.getBoolInfo(n.bidi,r):n.getValue("bidi"),t[Qe[r]]=o?n.bdo:i?1==r?e.getBiDirectionalOverride(n.bdo):n.bdo:1==r?e.getBiDirectionalOverride(n.getValue("bdo")):n.getValue("bdo"),t[it[r]]=o?n.boldBidi:i?e.getBoolInfo(n.boldBidi,r):n.getValue("boldBidi"),t[nt[r]]=o?n.italicBidi:i?e.getBoolInfo(n.italicBidi,r):n.getValue("italicBidi"),t[et[r]]=o||i?n.fontSizeBidi:n.getValue("fontSizeBidi"),t[tt[r]]=o||i?n.fontFamilyBidi:n.getValue("fontFamilyBidi"),t[rt[r]]=o?n.allCaps:i?e.getBoolInfo(n.allCaps,r):n.getValue("allCaps"),t[Me[r]]=o||i?n.localeIdBidi:n.getValue("localeIdBidi"),t[De[r]]=o?n.localeIdBidi:i?n.localeIdAscii:n.getValue("localeIdAscii"),t[Re[r]]=o||i?n.localeIdFarEast:n.getValue("localeIdFarEast"),t[ot[r]]=o?n.complexScript:i?e.getBoolInfo(n.complexScript,r):n.getValue("complexScript"),t[st[r]]=o?n.fontFamilyAscii:i?this.toWriteInline(n,"fontFamilyAscii"):n.getValue("fontFamilyAscii"),t[lt[r]]=o?n.fontFamilyNonFarEast:i?this.toWriteInline(n,"fontFamilyNonFarEast"):n.getValue("fontFamilyNonFarEast"),t[at[r]]=o?n.fontFamilyFarEast:i?this.toWriteInline(n,"fontFamilyFarEast"):n.getValue("fontFamilyFarEast"),t[ct[r]]=o?n.characterSpacing:i?this.toWriteInline(n,"characterSpacing"):n.getValue("characterSpacing"),t[pt[r]]=o?n.scaling:i?this.toWriteInline(n,"scaling"):n.getValue("scaling"),(n.hasValue("fontFamily")||o)&&((0,a.isNullOrUndefined)(t[st[r]])&&(t[st[r]]=n.fontFamily),(0,a.isNullOrUndefined)(t[lt[r]])&&(t[lt[r]]=n.fontFamily))},e.isThemeFont=function(e){return"majorAscii"==e||"majorBidi"==e||"majorEastAsia"==e||"majorHAnsi"==e||"minorAscii"==e||"minorBidi"==e||"minorEastAsia"==e||"minorHAnsi"==e},e.toWriteInline=function(e,t){return!(0,a.isNullOrUndefined)(e.ownerBase)&&e.ownerBase instanceof ql?e.hasValue(t)?e[t]:e.getValue(t):e[t]},e.round=function(e,t){for(var i=e,n=0;n<t;n++)i*=10;i=Math.round(i);for(n=0;n<t;n++)i/=10;return i},e.removeInvalidXmlChars=function(e){return e.replace(/[^\x09\x0A\x0C\x0D\v\f\r\u000E\x20-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}]/gu,"")},e.commentInlines=function(e,t,i){var n=this,r=[],o=e.split(/<\/?div>/).filter(Boolean).map((function(e){return e.trim()}));if((o=o.filter(Boolean).map((function(e){return"<br>"===e?e:e.split(/<br\s*\/?>/)})).flat()).forEach((function(e){var o={};(o[Qr[i]]=[],""!==e&&"<br>"!==e)&&e.match(/(<[^>]+>[^<]*<\/[^>]+>|[^<]+)/g).forEach((function(e){var r={"&nbsp;":" ","&lt;":"<","&gt;":">","&amp;":"&"};if(e=e.replace(/&nbsp;|&lt;|&gt;|&amp;/g,(function(e){return r[e]})),0===e.indexOf("<span")){var s=e.match(/<span[^>]*>([^<]*)<\/span>/),a=s?s[1].trim():"",l=n.getEmailIdByName(a,t);o=n.serializeMentions(a,l,o,i)}else{var d={};d[Dn[i]]=e,o[Qr[i]].push(d)}}));r.push(o)})),0==r.length){var s={};s[Qr[i]]=[];s[Qr[i]].push({}),r.push(s)}return r},e.parseCommentAsText=function(e){var t=document.createElement("div");t.innerHTML=e.text;var i=t.querySelectorAll("span.e-mention-chip"),n=JSON.stringify(e.mentions),r=JSON.parse(n),o=0;if(i.length!==r.length)throw new Error("The lengths of spanElements and inputData do not match");i.forEach((function(e){if(o in r){var t=r[o];if(t&&"string"==typeof t.value&&"string"==typeof t.text){var i=document.createElement("a");i.href="mailto:"+t.value,i.textContent="@"+t.text,e.replaceWith(i)}o++}}));var s=t.innerHTML;return s=s.replace(/<br>/g,"\r\n")},e.getEmailIdByName=function(e,t){for(var i=0,n=t;i<n.length;i++){var r=n[i];if(r.text===e)return(0,a.isNullOrUndefined)(r.value)?r.text+".com":r.value}return""},e.serializeMentions=function(e,t,i,n){var r={};r[ie[n]]={},r[Cr[n]]=0,r[wr[n]]=!0,i[Qr[n]].push(r);var o={};o[ie[n]]={},o[Dn[n]]=' HYPERLINK "mailto:'+t+'" ',i[Qr[n]].push(o);var s={};s[ie[n]]={},s[Cr[n]]=2,i[Qr[n]].push(s);var a={};a[ie[n]]={underline:"Single",fontColor:"#0563c1",bidi:!1},a[Dn[n]]=e,i[Qr[n]].push(a);var l={};return l[ie[n]]={},l[Cr[n]]=1,i[Qr[n]].push(l),i},e.reverseString=function(e){if(!(0,a.isNullOrUndefined)(e)&&""!==e){var t=e.split("");e=t.reverse().join("")}return e},e.formatClippedString=function(e){var t="",i="";return this.startsWith(e,"data:image/svg+xml;base64,")?(t=".svg",i=e.replace("data:image/svg+xml;base64,","")):this.startsWith(e,"data:image/svg+xml;utf8,")?(t=".svg",i=e.replace("data:image/svg+xml;utf8,","")):this.startsWith(e,"data:image/bmp;base64,")?(t=".bmp",i=e.replace("data:image/bmp;base64,","")):this.startsWith(e,"data:image/x-emf;base64,")?(t=".emf",i=e.replace("data:image/x-emf;base64,","")):this.startsWith(e,"data:image/exif;base64,")?(t=".exif",i=e.replace("data:image/exif;base64,","")):this.startsWith(e,"data:image/gif;base64,")?(t=".gif",i=e.replace("data:image/gif;base64,","")):this.startsWith(e,"data:image/icon;base64,")?(t=".ico",i=e.replace("data:image/icon;base64,","")):this.startsWith(e,"data:image/jpeg;base64,")?(t=".jpeg",i=e.replace("data:image/jpeg;base64,","")):this.startsWith(e,"data:image/jpg;base64,")?(t=".jpg",i=e.replace("data:image/jpg;base64,","")):this.startsWith(e,"data:image/png;base64,")?(t=".png",i=e.replace("data:image/png;base64,","")):this.startsWith(e,"data:image/tiff;base64,")?(t=".tif",i=e.replace("data:image/tiff;base64,","")):this.startsWith(e,"data:image/x-wmf;base64,")?(t=".wmf",i=e.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},e.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.formatText=function(e,t){var i=t;switch(e.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},e.formatNumber=function(e,t){var i=new a.Internationalization,n=t.split(".");t=n[0];var r=i.parseNumber(t);if("NaN"===t.toString())return"";""===e&&(e="0");var o={format:e};return i.formatNumber(r,o)},e.formatDate=function(e,t){var i=new a.Internationalization,n=new Date(t);if(isNaN(n.getDate()))return"";if(""===e)return t;-1!==e.indexOf("am/pm")&&(e=e.replace(/am\/pm/gi,"a"));var r={format:e};return i.formatDate(n,r)},e.capitaliseFirst=function(e,t,i){var n="";if("Titlecase"===t){for(var r=i?e.split(i):e.split(" "),o=0;o<r.length;o++)n+=i?r[parseInt(o.toString(),10)].charAt(0).toUpperCase()+r[parseInt(o.toString(),10)].slice(1,r[parseInt(o.toString(),10)].length):this.capitaliseFirstInternal(r[parseInt(o.toString(),10)]),r.length>=0&&!i&&(n+=" ");i||(n=this.capitaliseFirst(n,"Titlecase","\r"))}else"FirstCapital"===t&&(n=this.capitaliseFirstInternal(e));return n},e.lowerFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1,e.length)},e.capitaliseFirstInternal=function(e){return e.charAt(0).toUpperCase()+e.slice(1,e.length).toLowerCase()},e.getModifiedDate=function(t){var i=e.getLocaleDate(t);return i.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+i.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},e.getUtcDate=function(e){return(0,a.isNullOrUndefined)(e)&&(e=new Date),new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()},e.getLocaleDate=function(e){var t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},e.getCompatibilityModeValue=function(e){var t;switch(e){case 1:t="11";break;case 2:t="12";break;case 3:t="14";break;default:t="15"}return t},e.getUniqueElementId=function(){return"de_element"+Date.now().toString(36)+Math.random().toString(36).substring(2)},e.splitSpaceInTextElementBox=function(t,i){var n=t.text,r="";if(i)for(;e.startsWith(n," ");)r+=" ",n=n.substring(1);else for(;e.endsWith(n);)r+=" ",n=n.slice(0,-1);if(""!=r){var o=new Zl;if(o.characterFormat.copyFormat(t.characterFormat),t.revisions.length>0){for(var s=0;s<t.revisions.length;s++){var a=t.revisions[s];o.revisions.push(a);var l=a.range.indexOf(t);l<0?a.range.push(o):a.range.splice(l+1,0,o)}o.isMarkedForRevision=t.isMarkedForRevision}o.line=t.line;var d=o.line.children;i?(t.text=r,o.text=n):(t.text=n,o.text=r),d.splice(d.indexOf(t)+1,0,o)}},e.getTextIndexAfterWhitespace=function(e,t){var i=e.length,n=e.indexOf(" ",t)+1;if(0===n||n===i)return n;for(;" "===e[n]&&++n!==i;);return n},e.splitWordByMaxLength=function(t,i,n){for(var r=t.text,o=0,s=r.length,a="",l=t.characterFormat,d=t.revisions,h=i.children.indexOf(t);o<s;){var c=o+90;c>s&&(c=s);var p=e.getTextIndexAfterWhitespace(r,c);if((0===p||p>s)&&(p=c),a=r.substring(o,p),0===o)t.text=a,t.isWidthUpdated=!1;else{var u=new Zl;if(u.text=a,u.line=i,u.characterFormat.copyFormat(l),d.length>0)for(var g=0;g<d.length;g++){var m=d[g];u.revisions.push(m);var f=m.range.indexOf(t);n||f<0?m.range.push(u):m.range.splice(f+1,0,u)}n?i.children.push(u):(i.children.splice(h+1,0,u),h++)}o=p}},e.wordBefore="\\b",e.wordAfter="\\b",e.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","”","　","،","؟","؛","’","‘"],e}(),Sa=function(){function e(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},e.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0},e}(),Ta=function(){function e(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return e.prototype.encodeString=function(e){var t,i,n,r,o,s,a,l="",d=0;for(e=this.unicodeEncode(e);d<e.length;)r=(t=e.charCodeAt(d++))>>2,o=(3&t)<<4|(i=e.charCodeAt(d++))>>4,s=(15&i)<<2|(n=e.charCodeAt(d++))>>6,a=63&n,isNaN(i)?s=a=64:isNaN(n)&&(a=64),l=l+this.keyStr.charAt(r)+this.keyStr.charAt(o)+this.keyStr.charAt(s)+this.keyStr.charAt(a);return l},e.prototype.unicodeEncode=function(e){for(var t=e.replace(/\r\n/g,"\n"),i="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?i+=String.fromCharCode(r):r>127&&r<2048?(i+=String.fromCharCode(r>>6|192),i+=String.fromCharCode(63&r|128)):(i+=String.fromCharCode(r>>12|224),i+=String.fromCharCode(r>>6&63|128),i+=String.fromCharCode(63&r|128))}return i},e.prototype.decodeString=function(e){var t,i,n,r,o,s,a=0,l=0,d=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===this.keyStr.charAt(64)&&d--,e.charAt(e.length-2)===this.keyStr.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var h=new Uint8Array(0|d);a<e.length;)t=this.keyStr.indexOf(e.charAt(a++))<<2|(r=this.keyStr.indexOf(e.charAt(a++)))>>4,i=(15&r)<<4|(o=this.keyStr.indexOf(e.charAt(a++)))>>2,n=(3&o)<<6|(s=this.keyStr.indexOf(e.charAt(a++))),h[l++]=t,64!==o&&(h[l++]=i),64!==s&&(h[l++]=n);return h},e.prototype.destroy=function(){this.keyStr=void 0},e}(),Ha=function(){function e(e,t){this.x=0,this.width=0,this.x=e,this.width=t}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),e}(),Ea=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},r(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Na=function(){},Wa=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new ba(i),i.characterFormat=new ka(i),i}return Ea(t,e),t.prototype.clear=function(){this.characterFormat&&this.characterFormat.clearFormat(),this.paragraphFormat&&this.paragraphFormat.clearFormat()},t.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.link=e.link,this.characterFormat.copyFormat(e.characterFormat),this.paragraphFormat.copyFormat(e.paragraphFormat)},t}(Na),Oa=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.characterFormat=new ka(i),i}return Ea(t,e),t.prototype.clear=function(){this.characterFormat&&this.characterFormat.clearFormat()},t.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.characterFormat.copyFormat(e.characterFormat)},t}(Na),Ba=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i}return Ea(t,e),t.prototype.destroy=function(){this.ownerBase=void 0,this.name=void 0,this.next=void 0,this.basedOn=void 0,this.link=void 0},t}(Na),La=function(){function e(){this.collection=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.collection=this.collection.filter((function(t){return t.name!==e.name}))},e.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},e.prototype.getItem=function(e){return this.collection.length>e?this.collection[parseInt(e.toString(),10)]:null},e.prototype.indexOf=function(e){return this.collection.indexOf(e)},e.prototype.contains=function(e){var t=this.collection.indexOf(e);return t>-1&&t<this.collection.length},e.prototype.clear=function(){if(this.collection&&this.collection.length>0)for(var e=0;e<this.collection.length;e++){var t=this.collection[parseInt(e.toString(),10)];(t instanceof Oa||t instanceof Wa)&&t.clear()}this.collection=[]},e.prototype.findByName=function(e,t){for(var i,n=0,r=this.collection;n<r.length;n++){var o=r[n];o.name===e&&(i=o,(0,a.isNullOrUndefined)(t)||o.type!==t&&(i=void 0))}return i},e.prototype.getStyleNames=function(e){return this.collection.filter((function(t){return t.type===e})).map((function(e){return e.name}))},e.prototype.getStyles=function(e){for(var t=[],i=0,n=this.collection.filter((function(t){return t.type===e})).map((function(e){return e}));i<n.length;i++){var r=n[i],o={},s={};"Paragraph"===e&&(s.paragraphFormat={},Pa.writeParagraphFormat(s.paragraphFormat,!0,r.paragraphFormat)),"Table"!==e&&(s.characterFormat={},Pa.writeCharacterFormat(s.characterFormat,!0,r.characterFormat)),o.name=r.name,o.style=JSON.stringify(s),(0,a.isNullOrUndefined)(e)||(o.type=e,"Paragraph"!==o.type||(0,a.isNullOrUndefined)(r.link)||(o.type="Linked")),t.push(o)}return t},e.prototype.destroy=function(){if(this.collection&&this.collection.length>0)for(var e=0;e<this.collection.length;e++){var t=this.collection[parseInt(e.toString(),10)];(t instanceof Oa||t instanceof Wa||t instanceof Ba)&&t.destroy()}this.collection=[],this.collection=void 0},e}(),Da=function(){function e(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(i))return this.uniqueShadingFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueShadingFormat))this.initializeUniqueShading(t,i);else{var n=d.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,t);if(this.uniqueShadingFormat.propertiesHash.containsKey(n)&&this.uniqueShadingFormat.propertiesHash.get(n)===i)return;this.uniqueShadingFormat=e.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,t,i)}},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},e.prototype.initializeUniqueShading=function(t,i){var n=new l;this.addUniqueShading("backgroundColor",t,i,n),this.addUniqueShading("foregroundColor",t,i,n),this.addUniqueShading("textureStyle",t,i,n),this.uniqueShadingFormat=e.uniqueShadingFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueShading=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i?r.add(o,n):r.add(o,e.getPropertyDefaultValue(t))},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.uniqueShadingFormat)||e.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.backgroundColor=this.backgroundColor,t.foregroundColor=this.foregroundColor,t.textureStyle=this.textureStyle,t},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.uniqueShadingFormat)||(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueShadingFormat)){var t=d.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);return this.uniqueShadingFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueShadingFormats.clear()},e.uniqueShadingFormats=new h,e.uniqueFormatType=5,e}(),Ra=function(){function e(e){this.uniqueTableFormat=void 0,this.borders=new va(this),this.shading=new Da(this),this._title=void 0,this._description=void 0,this.ownerBase=void 0,this._styleName=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(e){this.setPropertyValue("allowAutoFit",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||e>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||e>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(e){this.setPropertyValue("horizontalPositionAbs",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(e){this.setPropertyValue("horizontalPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleName",{get:function(){return this._styleName},set:function(e){this._styleName=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(i))return this.uniqueTableFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueTableFormat))this.initializeUniqueTableFormat(t,i);else{var n=d.getPropertyType(this.uniqueTableFormat.uniqueFormatType,t);if(this.uniqueTableFormat.propertiesHash.containsKey(n)&&this.uniqueTableFormat.propertiesHash.get(n)===i)return;this.uniqueTableFormat=e.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,t,i)}},e.prototype.initializeUniqueTableFormat=function(t,i){var n=new l;this.addUniqueTableFormat("allowAutoFit",t,i,n),this.addUniqueTableFormat("cellSpacing",t,i,n),this.addUniqueTableFormat("leftMargin",t,i,n),this.addUniqueTableFormat("topMargin",t,i,n),this.addUniqueTableFormat("bottomMargin",t,i,n),this.addUniqueTableFormat("rightMargin",t,i,n),this.addUniqueTableFormat("leftIndent",t,i,n),this.addUniqueTableFormat("tableAlignment",t,i,n),this.addUniqueTableFormat("preferredWidth",t,i,n),this.addUniqueTableFormat("preferredWidthType",t,i,n),this.addUniqueTableFormat("bidi",t,i,n),this.addUniqueTableFormat("horizontalPositionAbs",t,i,n),this.addUniqueTableFormat("horizontalPosition",t,i,n),this.uniqueTableFormat=e.uniqueTableFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueTableFormat=function(t,i,n,r){var o;o=d.getPropertyType(e.uniqueFormatType,t),t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowAutoFit":case"bidi":t=!1;break;case"cellSpacing":case"topMargin":case"bottomMargin":case"leftIndent":case"preferredWidth":case"horizontalPosition":t=0;break;case"leftMargin":case"rightMargin":t=5.4;break;case"tableAlignment":t="Left";break;case"preferredWidthType":t="Point";break;case"horizontalPositionAbs":t=null}return t},e.prototype.assignTableMarginValue=function(e,t,i,n){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=n},e.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.borders)||this.borders.destroy(),(0,a.isNullOrUndefined)(this.shading)||this.shading.destroy(),(0,a.isNullOrUndefined)(this.uniqueTableFormat)||e.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.ownerBase=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.leftIndent=this.leftIndent,t.tableAlignment=this.tableAlignment,t.cellSpacing=this.cellSpacing,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.horizontalPositionAbs=this.horizontalPositionAbs,t.horizontalPosition=this.horizontalPosition,t.borders=(0,a.isNullOrUndefined)(this.borders)?void 0:this.borders.cloneFormat(),t.shading=(0,a.isNullOrUndefined)(this.shading)?void 0:this.shading.cloneFormat(),t.bidi=this.bidi,t.allowAutoFit=this.allowAutoFit,t.styleName=this.styleName,t.title=this.title,t.description=this.description,t},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueTableFormat)){var t=d.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);return this.uniqueTableFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.allowAutoFit=e.allowAutoFit,this.horizontalPosition=e.horizontalPosition,this.horizontalPositionAbs=e.horizontalPositionAbs,this.styleName=e.styleName),(0,a.isNullOrUndefined)(e.borders)||(this.borders=new va(this),this.borders.copyFormat(e.borders)),(0,a.isNullOrUndefined)(e.shading)||(this.shading=new Da(this),this.shading.copyFormat(e.shading)),(0,a.isNullOrUndefined)(e.title)||(this.title=e.title),(0,a.isNullOrUndefined)(e.description)||(this.description=e.description))},e.clear=function(){this.uniqueTableFormats.clear()},e.uniqueTableFormats=new h,e.uniqueFormatType=8,e}(),Ma=function(){function e(e){this.uniqueCellFormat=void 0,this.borders=new va(this),this.shading=new Da(this),this.ownerBase=e,this.borders=new va(this),this.shading=new Da(this)}return Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=d.getPropertyType(e.uniqueFormatType,t);if(!(0,a.isNullOrUndefined)(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(i))return this.uniqueCellFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueCellFormat))this.initializeUniqueCellFormat(t,i);else{var n=d.getPropertyType(this.uniqueCellFormat.uniqueFormatType,t);if(this.uniqueCellFormat.propertiesHash.containsKey(n)&&this.uniqueCellFormat.propertiesHash.get(n)===i)return;this.uniqueCellFormat=e.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,t,i)}},e.prototype.initializeUniqueCellFormat=function(t,i){var n=new l;this.addUniqueCellFormat("leftMargin",t,i,n),this.addUniqueCellFormat("topMargin",t,i,n),this.addUniqueCellFormat("bottomMargin",t,i,n),this.addUniqueCellFormat("rightMargin",t,i,n),this.addUniqueCellFormat("cellWidth",t,i,n),this.addUniqueCellFormat("columnSpan",t,i,n),this.addUniqueCellFormat("rowSpan",t,i,n),this.addUniqueCellFormat("preferredWidth",t,i,n),this.addUniqueCellFormat("verticalAlignment",t,i,n),this.addUniqueCellFormat("preferredWidthType",t,i,n),this.uniqueCellFormat=e.uniqueCellFormats.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueCellFormat=function(t,i,n,r){var o=d.getPropertyType(e.uniqueFormatType,t);t===i&&r.add(o,n)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":case"preferredWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},e.prototype.containsMargins=function(){return!((0,a.isNullOrUndefined)(this.leftMargin)&&(0,a.isNullOrUndefined)(this.rightMargin)&&(0,a.isNullOrUndefined)(this.bottomMargin)&&(0,a.isNullOrUndefined)(this.topMargin))},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.borders)||this.borders.destroy(),(0,a.isNullOrUndefined)(this.shading)||this.shading.destroy(),(0,a.isNullOrUndefined)(this.uniqueCellFormat)||e.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.verticalAlignment=this.verticalAlignment,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.cellWidth=this.cellWidth,t.borders=(0,a.isNullOrUndefined)(this.borders)?void 0:this.borders.cloneFormat(),t.shading=(0,a.isNullOrUndefined)(this.shading)?void 0:this.shading.cloneFormat(),t},e.prototype.hasValue=function(e){if(!(0,a.isNullOrUndefined)(this.uniqueCellFormat)){var t=d.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);return this.uniqueCellFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),(0,a.isNullOrUndefined)(e.shading)||(this.shading=new Da(this),this.shading.copyFormat(e.shading)),(0,a.isNullOrUndefined)(e.borders)||(this.borders=new va(this),this.borders.copyFormat(e.borders)))},e.prototype.initializeCellBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},e.clear=function(){this.uniqueCellFormats.clear()},e.uniqueCellFormats=new h,e.uniqueFormatType=4,e}(),Aa=function(){function e(){this.abstractListIdIn=-1,this.nsid=-1,this.levels=[],this.nsid=parseInt(Pa.generateHexDecimal(),16)}return Object.defineProperty(e.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),e.prototype.clear=function(){if(!(0,a.isNullOrUndefined)(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.clearFormat(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.destroy(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}this.levels=void 0},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levels.length;i++)t.levels.push(this.levels[parseInt(i.toString(),10)].clone(t));return t},e}(),Ua=function(){function e(){}return e.prototype.clear=function(){(0,a.isNullOrUndefined)(this.overrideListLevel)||this.overrideListLevel.clearFormat(),this.overrideListLevel=void 0},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},e.prototype.clone=function(){var t=new e;return t.startAt=this.startAt,t.levelNumber=this.levelNumber,(0,a.isNullOrUndefined)(this.overrideListLevel)||(t.overrideListLevel=this.overrideListLevel.clone(t)),t},e}(),Va=function(){function e(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,this.ownerBase=e,this.characterFormat=new ka(void 0),this.paragraphFormat=new ba(void 0)}return Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paraStyleName",{get:function(){return this.getPropertyValue("paraStyleName")},set:function(e){this.setPropertyValue("paraStyleName",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegalStyleNumbering",{get:function(){return this.getPropertyValue("isLegalStyleNumbering")},set:function(e){this.setPropertyValue("isLegalStyleNumbering",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){var i=d.getPropertyType(e.uniqueFormatType,t);return!(0,a.isNullOrUndefined)(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(i)?this.uniqueListLevel.propertiesHash.get(i):e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if(((0,a.isNullOrUndefined)(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),(0,a.isNullOrUndefined)(this.uniqueListLevel))this.initializeUniqueWListLevel(t,i);else{var n=d.getPropertyType(this.uniqueListLevel.uniqueFormatType,t);if(this.uniqueListLevel.propertiesHash.containsKey(n)&&this.uniqueListLevel.propertiesHash.get(n)===i)return;this.uniqueListLevel=e.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,t,i)}},e.prototype.initializeUniqueWListLevel=function(t,i){var n=new l;this.addUniqueWListLevel("listLevelPattern",t,i,n),this.addUniqueWListLevel("startAt",t,i,n),this.addUniqueWListLevel("followCharacter",t,i,n),this.addUniqueWListLevel("numberFormat",t,i,n),this.addUniqueWListLevel("paraStyleName",t,i,n),this.addUniqueWListLevel("restartLevel",t,i,n),this.addUniqueWListLevel("isLegalStyleNumbering",t,i,n),this.uniqueListLevel=e.uniqueListLevels.addUniqueFormat(n,e.uniqueFormatType)},e.prototype.addUniqueWListLevel=function(t,i,n,r){var o;o=d.getPropertyType(e.uniqueFormatType,t),t===i?r.add(o,n):r.add(o,e.getPropertyDefaultValue(t))},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":case"restartLevel":t=0;break;case"followCharacter":t="Tab";break;case"paraStyleName":case"numberFormat":t="";break;case"isLegalStyleNumbering":t=!1}return t},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,(0,a.isNullOrUndefined)(this.characterFormat)||(this.characterFormat.destroy(),this.characterFormat=void 0),(0,a.isNullOrUndefined)(this.paragraphFormat)||(this.paragraphFormat.destroy(),this.paragraphFormat=void 0)},e.prototype.clearFormat=function(){(0,a.isNullOrUndefined)(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat&&this.characterFormat.clearFormat(),this.characterFormat=void 0,this.paragraphFormat&&this.paragraphFormat.clearFormat(),this.paragraphFormat=void 0},e.clear=function(){this.uniqueListLevels.clear()},e.prototype.clone=function(t){var i=new e(t);return i.paragraphFormat=this.paragraphFormat.cloneFormat(),i.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(i.uniqueListLevel=this.uniqueListLevel,i.uniqueListLevel.referenceCount++),i},e.dotBullet=String.fromCharCode(61623),e.squareBullet=String.fromCharCode(61607),e.arrowBullet=String.fromCharCode(10148),e.circleBullet=String.fromCharCode(61551)+String.fromCharCode(32),e.uniqueListLevels=new h,e.uniqueFormatType=9,e}(),za=function(){function i(e){this.paragraphMarkInfo={},this.documentHelper=e,(0,a.isNullOrUndefined)(e)||(this.context=e.containerContext)}return Object.defineProperty(i.prototype,"paragraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineBreakMark",{get:function(){return"↲"},enumerable:!0,configurable:!0}),i.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},i.prototype.repeatChar=function(e,t){for(var i="",n=0;n<t;n++)i+=e;return i},i.prototype.getParagraphMarkWidth=function(e){return this.getParagraphMarkSize(e).Width},i.prototype.getParagraphMarkSize=function(e){var t=this.getFormatText(e);if(this.paragraphMarkInfo[""+t])return this.paragraphMarkInfo[""+t];var i=this.getWidth(this.paragraphMark,e),n=this.getHeight(e),r={Width:i,Height:n.Height,BaselineOffset:n.BaselineOffset};return this.paragraphMarkInfo[""+t]=r},i.prototype.getTextSize=function(e,t){var i=0,n=t.bidi||this.isRTLText(e.text),r=this.setText(e.text,n,t.bdo);"\r"===r&&(r=String.fromCharCode(182)),i=this.getWidth(r,t,e.scriptType),e.width=i;var o=this.getHeight(t,e.scriptType);return"Word2003"===this.documentHelper.compatibilityMode&&e.isColumnBreak||(e.height=o.Height),e.baselineOffset=o.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(Pa.trimEnd(e.text),t,e.scriptType)),e.trimEndWidth=i,i},i.prototype.getHeight=function(e,t){var i=this.getFontNameToRender(t,e),n=this.getFormatText(e,i);if(!(0,a.isNullOrUndefined)(this.documentHelper.heightInfoCollection[""+n]))return this.documentHelper.heightInfoCollection[""+n];var r=this.documentHelper.owner.textMeasureHelper.getHeightInternal(e,i);return this.documentHelper.heightInfoCollection[""+n]=r,r},i.prototype.getFormatText=function(e,t){var i="";i=(0,a.isNullOrUndefined)(t)?e.fontFamily.toLocaleLowerCase():t.toLocaleLowerCase();var n=e.bidi||e.complexScript;return i+=";"+(n?e.fontSizeBidi:e.fontSize),(n?e.boldBidi:e.bold)&&(i+=";bold"),(n?e.italicBidi:e.italic)&&(i+=";italic"),i},i.prototype.measureTextExcludingSpaceAtEnd=function(e,t,i){return this.getWidth(Pa.trimEnd(e),t,i)},i.prototype.getWidth=function(e,t,i){e.match("\v")&&e.replace("\v",this.lineBreakMark);var n,r,o,s=t.bidi||t.complexScript,a=s?t.fontSizeBidi:t.fontSize;n=s?t.boldBidi?"bold":"":t.bold?"bold":"",r=s?t.italicBidi?"italic":"":t.italic?"italic":"",o=this.getFontNameToRender(i,t),a=0===a?.5:a/("Normal"===t.baselineAlignment?1:1.5),this.context.font=n+" "+r+" "+a+'pt "'+o+'"',this.context.letterSpacing=t.characterSpacing+"pt";var l=t.scaling/100;return t.allCaps&&(e=e.toUpperCase()),"̶"===e&&(e+="A"),Math.abs(this.context.measureText(e).width*l)},i.prototype.setText=function(e,t,i,n){if((0,a.isNullOrUndefined)(n)&&(n=!1),0===e.length)return"";var r=t;if(!r&&"RTL"===i||r&&"LTR"===i)e=Pa.reverseString(e);else if(n&&r&&Pa.endsWith(e)){var o=e.length-Pa.trimEnd(e).length;e=Pa.addSpace(o)+Pa.trimEnd(e)}return e},i.prototype.measureText=function(e,t,i){var n=this.getWidth(e,t,i),r=this.getHeight(t,i);return{Width:n,Height:r.Height,BaselineOffset:r.BaselineOffset}},i.prototype.updateTextSize=function(e,t){var i=new ka(void 0),n=e.listLevel.characterFormat,r=t.characterFormat;i.fontSize=n.hasValue("fontSize")?n.fontSize:r.fontSize,i.fontFamily=n.hasValue("fontFamily")?n.fontFamily:r.fontFamily;var o,s,a="Normal"===n.baselineAlignment?r.baselineAlignment:n.baselineAlignment;o=n.hasValue("bold")?n.bold?"bold":"":r.bold?"bold":"",s=n.hasValue("italic")?n.italic?"italic":"":r.italic?"italic":"",i.baselineAlignment=a,o&&(i.bold=!0),s&&(i.italic=!0);var l=i.bidi||this.isRTLText(e.text),d=this.setText(e.text,l,i.bdo);e.width=this.getWidth(d,i);var h=this.getHeight(i);e.height=h.Height,e.baselineOffset=h.BaselineOffset,i.destroy()},i.prototype.containsSpecialCharAlone=function(e){for(var t="*|.:[]{}-`;()@&$#%!~?, '",i=0;i<e.length;i++)if(-1===t.indexOf(e.charAt(i)))return!1;return!0},i.prototype.containsNumberAlone=function(e){if(""===e)return!1;for(var t=0;t<e.length;t++)if(-1==="0123456789".indexOf(e.charAt(t)))return!1;return!0},i.prototype.containsCombinationText=function(e){return!(!e.text.match(/^[0-9]+$/)||!e.paragraph.bidi)},i.prototype.inverseCharacter=function(e){switch(e){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return e}},i.prototype.containsSpecialChar=function(e){for(var t="*|.:[]{}-`;()@&$#%!~? ",i=0;i<e.length;i++)if(-1!==t.indexOf(e.charAt(i)))return!0;return!1},i.prototype.isRTLText=function(e){var t=!1;if(!(0,a.isNullOrUndefined)(e))for(var i=0;i<e.length;i++){var n=e[i];if(n>=String.fromCharCode(1424)&&n<=String.fromCharCode(1535)||n>=String.fromCharCode(64285)&&n<=String.fromCharCode(64335)||n>=String.fromCharCode(1536)&&n<=String.fromCharCode(1791)||n>=String.fromCharCode(1872)&&n<=String.fromCharCode(1919)||n>=String.fromCharCode(2208)&&n<=String.fromCharCode(2303)||n>=String.fromCharCode(64336)&&n<=String.fromCharCode(65023)||n>=String.fromCharCode(65136)&&n<=String.fromCharCode(65279)||n>=String.fromCharCode(43392)&&n<=String.fromCharCode(43487)||n>=String.fromCharCode(1792)&&n<=String.fromCharCode(1871)||n>=String.fromCharCode(1920)&&n<=String.fromCharCode(1983)||n>=String.fromCharCode(2112)&&n<=String.fromCharCode(2143)||n>=String.fromCharCode(1984)&&n<=String.fromCharCode(2047)||n>=String.fromCharCode(2048)&&n<=String.fromCharCode(2111)||n>=String.fromCharCode(11568)&&n<=String.fromCharCode(11647)){t=!0;break}}return t},i.prototype.isUnicodeText=function(e,t){var i=!1;if(!(0,a.isNullOrUndefined)(e))for(var n=0;n<e.length;n++){var r=e[n];if((r>="　"&&r<="ヿ"||r>="＀"&&r<="￯"||r>="一"&&r<="龯"||r>="㐀"&&r<="䶿"||r>="가"&&r<="￯"||r>="඀"&&r<="෿")&&0!==t){i=!0;break}}return i},i.prototype.getRtlLanguage=function(e){return(0,a.isNullOrUndefined)(e)||""===e?{isRtl:!1,id:0}:e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)?{isRtl:!0,id:1}:e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)?{isRtl:!0,id:2}:e>=String.fromCharCode(43392)&&e<=String.fromCharCode(43487)?{isRtl:!0,id:3}:e>=String.fromCharCode(1792)&&e<=String.fromCharCode(1871)?{isRtl:!0,id:4}:e>=String.fromCharCode(1920)&&e<=String.fromCharCode(1983)?{isRtl:!0,id:5}:e>=String.fromCharCode(2112)&&e<=String.fromCharCode(2143)?{isRtl:!0,id:6}:e>=String.fromCharCode(1984)&&e<=String.fromCharCode(2047)?{isRtl:!0,id:7}:e>=String.fromCharCode(2048)&&e<=String.fromCharCode(2111)?{isRtl:!0,id:8}:e>=String.fromCharCode(11568)&&e<=String.fromCharCode(11647)?{isRtl:!0,id:9}:{isRtl:!1,id:0}},i.prototype.splitTextByConsecutiveLtrAndRtl=function(t,n,r,o,s,l){var d=o.length,h=[];if((0,a.isNullOrUndefined)(t)||""===t)return h;for(var c=-1,p="",u="",g="",m="",f=0;f<t.length;f++){var v=0,y=!1;((0,a.isNullOrUndefined)(s.value)?n:!s.value)&&this.isNumber(t[f])?(m+=t[f],v=4):this.isWordSplitChar(t[f])?(v=2,y=n||32==t.charCodeAt(f)&&""==g,g+=t[f]):this.isRTLText(t[f])&&!this.isNumber(t[f])?(s.value=!1,l.value=!0,u+=t[f],v=1):(s.value=!0,p+=t[f]),""!=m&&4!=v&&(h.push(m),o.push(e.Number),m=""),""!=u&&1!=v&&(h.push(u),o.push(e.RightToLeft),u=""),""!=p&&0!=v&&(h.push(p),c=h.length-1,o.push(e.LeftToRight),p=""),""==g||2==v&&!y||(h.push(g),o.push(e.WordSplit),g="")}if(""!=m?(h.push(m),o.push(e.Number)):""!=u?(h.push(u),o.push(e.RightToLeft)):""!=p?(h.push(p),c=h.length-1,o.push(e.LeftToRight)):""!=g&&(h.push(g),o.push(e.WordSplit)),l.value||!(0,a.isNullOrUndefined)(s.value)&&!s.value)for(f=1;f<h.length;f++){(b=o[f+d])==e.WordSplit&&1==h[f].length&&f+d+1<o.length&&o[f+d-1]!=e.WordSplit&&(o[f+d-1]!=e.Number||i.isNumberNonReversingCharacter(h[f],n))&&o[f+d-1]==o[f+d+1]&&(h[f-1]=h[f-1]+h[f]+h[f+1],h.splice(f,1),h.splice(f,1),o.splice(f+d,1),o.splice(f+d,1),f--)}else if(-1!=c)if(n)for(f=1;f<c;f++){if((b=o[f+d])==e.WordSplit&&f<c&&o[f+d-1]==e.LeftToRight){p="";for(var w=f+1;w<=c;w++)p+=h[w],h.splice(w,1),o.splice(w+d,1),w--,c--;h[f-1]=h[f-1]+h[f]+p,h.splice(f,1),o.splice(f+d,1),f--,c--}}else h.length=0,h.push(t);else n||(h.length=0,h.push(t));if(n)for(f=1;f<h.length;f++){var b;(b=o[f+d])==e.WordSplit&&1==h[f].length&&f+d+1<o.length&&o[f+d-1]!=e.WordSplit&&(o[f+d-1]!=e.Number||i.isNumberNonReversingCharacter(h[f],n)||!r)&&o[f+d-1]==o[f+d+1]?(h[f-1]=h[f-1]+h[f]+h[f+1],h.splice(f,1),h.splice(f,1),o.splice(f+d,1),o.splice(f+d,1),f--):b==e.WordSplit&&o[f+d-1]==e.Number&&this.isNonWordSplitCharacter(h[f])&&!r?(h[f-1]=h[f-1]+h[f],h.splice(f,1),o.splice(f+d,1),f--):b!=e.LeftToRight||o[f+d-1]!=e.Number&&o[f+d-1]!=e.LeftToRight||(h[f-1]=h[f-1]+h[f],o[f+d-1]=e.LeftToRight,h.splice(f,1),o.splice(f+d,1),f--)}return h},i.prototype.isRightToLeftLanguage=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e||10655==e},i.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))||(e>=String.fromCharCode(1632)&&e<=String.fromCharCode(1641)||e>=String.fromCharCode(1776)&&e<=String.fromCharCode(1785))},i.prototype.isWordSplitChar=function(e){for(var t=0;t<i.wordSplitCharacters.length;t++)if(i.wordSplitCharacters[t]===e)return!0;return!1},i.isNumberNonReversingCharacter=function(e,t){for(var n=0;n<i.numberNonReversingCharacters.length;n++){var r=i.numberNonReversingCharacters[n];if(e[0]==r&&(47!=r.charCodeAt(0)||!t))return!0}return!1},i.prototype.isNonWordSplitCharacter=function(e){for(var t=!1,i=0;i<e.length;i++){var n=e.charCodeAt(i);if(35!=n&&36!=n&&37!=n){t=!1;break}t=!0}return t},i.prototype.getFontNameToRender=function(e,i){return(0,a.isNullOrUndefined)(e)?i.fontFamily:i.bidi||i.complexScript?this.getFontNameBidiToRender(e,i):(this.isEastAsiaScript(e)||"EastAsia"===i.fontHintType&&e===t.SpecialCharacter)&&!(0,a.isNullOrUndefined)(i.fontFamilyFarEast)?this.getFontNameEAToRender(e,i):this.getFontNameAsciiToRender(e,i)},i.prototype.isEastAsiaScript=function(e){return e==t.Japanese||e==t.Korean||e==t.Chinese},i.prototype.getFontNameEAToRender=function(e,t){var i=t.fontFamilyFarEast;return(0,a.isNullOrUndefined)(i)||Pa.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,"EastAsia"):i},i.prototype.getFontNameAsciiToRender=function(e,t){var i=t.fontFamilyAscii;return Pa.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,"Default"):t.fontFamily},i.prototype.getFontNameBidiToRender=function(e,t){var i=t.fontFamilyBidi;return!(0,a.isNullOrUndefined)(i)||Pa.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,"CS"):i},i.prototype.getFontNameFromTheme=function(e,t,i,n){var r;if(!this.documentHelper.hasThemes||(0,a.isNullOrUndefined)(this.documentHelper.themes)||(0,a.isUndefined)(this.documentHelper.themes.fontScheme)||(r=this.documentHelper.themes.fontScheme),"majorAscii"==t||"majorBidi"==t||"majorEastAsia"==t||"majorHAnsi"==t){var o=void 0;null!=r&&null!=r.majorFontScheme&&(o=r.majorFontScheme),t=this.updateFontNameFromTheme(e,o,i,t,n)}else if("minorAscii"==t||"minorBidi"==t||"minorEastAsia"==t||"minorHAnsi"==t){var s=void 0;null!=r&&null!=r.majorFontScheme&&(s=r.minorFontScheme),t=this.updateFontNameFromTheme(e,s,i,t,n)}return((0,a.isNullOrUndefined)(t)||Pa.isThemeFont(t))&&(t=X),t},i.prototype.updateFontNameFromTheme=function(e,t,i,n,r){var o="";if(null!=t&&null!=t.fontSchemeList&&t.fontSchemeList.length>0&&t.fontSchemeList.forEach((function(e){("cs"!=e.name||"majorBidi"!=n&&"minorBidi"!=n)&&("ea"!=e.name||"majorEastAsia"!=n&&"minorEastAsia"!=n)&&("latin"!=e.name||"majorAscii"!=n&&"majorHAnsi"!=n&&"minorAscii"!=n&&"minorHAnsi"!=n)||(o=e.typeface)})),null!=t&&null!=t.fontTypeface)if("CS"==r)(e.complexScript||e.bidi||"majorAscii"!==n&&"majorHAnsi"!==n&&"minorAscii"!==n&&"minorHAnsi"!==n)&&(!e.bidi||"majorHAnsi"!==n&&"minorHAnsi"!==n)?t.fontTypeface.containsKey("Arab")&&(o=t.fontTypeface.get("Arab")):n=o;else if("EastAsia"==r)(0,a.isNullOrUndefined)(this.documentHelper.themeFontLanguage)||(n=this.getFontNameWithFontScript(t,this.documentHelper.themeFontLanguage.localeIdFarEast,r),(0,a.isNullOrUndefined)(n)||(o=n));else if((0,a.isNullOrUndefined)(o)&&!(0,a.isNullOrUndefined)(this.documentHelper.themeFontLanguage)&&("minorBidi"===n||"majorBidi"===n))return n=this.getFontNameWithFontScript(t,this.documentHelper.themeFontLanguage.localeIdBidi,r);return(0,a.isNullOrUndefined)(o)&&(o=X),n=o},i.prototype.getFontNameWithFontScript=function(e,t,i){var n=null,r=t.toString(),o=e.fontTypeface;return("gu_IN"!=r&&1095!=t||!o.containsKey("Gujr"))&&("hi_IN"!=r&&"mr_IN"!=r&&1081!=t&&1102!=t||!o.containsKey("Deva"))&&("ko_KR"!=r&&1042!=t||!o.containsKey("Hang"))?"zh_CN"!=r&&"zh_SG"!=r&&2052!=t||!o.containsKey("Hans")?("zh_TW"!=r&&"zh_HK"!=r&&"zh_MO"!=r||!o.containsKey("Hant"))&&!(("ja_JP"==r||1041==t)&&o.containsKey("Jpan")||("ta_IN"==r||1097==t)&&o.containsKey("Taml")||("te_IN"==r||1098==t)&&o.containsKey("Telu")||("he_IL"==r||"yi_Hebr"==r||1037==t)&&o.containsKey("Hebr"))?"th_TH"!=r&&1054!=t||!o.containsKey("Thai")?"CS"==i&&o.containsKey("Arab")&&(n=o.get("Arab")):n=o.get("Thai"):n=o.get("Arab"):n=o.get("Hans"):n=o.get("Arab"),n},i.prototype.destroy=function(){this.documentHelper=void 0,this.context=void 0,this.paragraphMarkInfo={},this.paragraphMarkInfo=void 0},i.wordSplitCharacters=[String.fromCharCode(32),String.fromCharCode(33),String.fromCharCode(34),String.fromCharCode(35),String.fromCharCode(36),String.fromCharCode(37),String.fromCharCode(38),String.fromCharCode(39),String.fromCharCode(40),String.fromCharCode(41),String.fromCharCode(42),String.fromCharCode(43),String.fromCharCode(44),String.fromCharCode(45),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(59),String.fromCharCode(60),String.fromCharCode(61),String.fromCharCode(62),String.fromCharCode(63),String.fromCharCode(64),String.fromCharCode(91),String.fromCharCode(92),String.fromCharCode(93),String.fromCharCode(94),String.fromCharCode(95),String.fromCharCode(96),String.fromCharCode(123),String.fromCharCode(124),String.fromCharCode(125),String.fromCharCode(126),String.fromCharCode(1548),String.fromCharCode(1563),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8216),String.fromCharCode(8217),String.fromCharCode(8221),String.fromCharCode(12288),String.fromCharCode(8207)],i.numberNonReversingCharacters=[String.fromCharCode(44),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(1548)],i}(),qa=1.35,_a=function(){function t(e){this.islayoutFootnote=!1,this.isMultiColumnDoc=!1,this.allowLayout=!0,this.isReplaceAll=!1,this.isTextFormat=!1,this.isSectionBreakCont=!1,this.isReplacingAll=!1,this.footHeight=0,this.existFootnoteHeight=0,this.isfootMove=!1,this.footnoteHeight=0,this.isTableFootNote=!1,this.isRelayout=!1,this.isRelayoutneed=!1,this.isOverlapFloatTable=!1,this.isInitialLoad=!0,this.isInsertFormField=!1,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.isRtlFieldCode=!1,this.isRTLLayout=!1,this.isSkipFirstLineIndent=!1,this.currentCell=void 0,this.isFootnoteContentChanged=!1,this.isEndnoteContentChanged=!1,this.keepWithNext=!1,this.is2013Justification=!1,this.nextElementToLayout=void 0,this.endNoteHeight=0,this.isMultiColumnSplit=!1,this.isMultiColumnLayout=!1,this.skipUpdateContainerWidget=!1,this.isIFfield=!1,this.isLayoutWhole=!1,this.isBidiReLayout=!1,this.defaultTabWidthPixel=48,this.isRelayoutFootnote=!1,this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1,this.isWrapText=!1,this.isYPositionUpdated=!1,this.isXPositionUpdated=!1,this.hasFloatingElement=!1,this.isFootNoteLayoutStart=!1,this.wrapPosition=[],this.shiftedFloatingItemsFromTable=[],this.isDocumentContainsRtl=!1,this.isPastingContent=!1,this.layoutedFootnoteElement=[],this.isAllColumnHasAutoWidthType=!1,this.documentHelper=e}return t.prototype.isSameStyle=function(e,t){var i=void 0;if(t?e.nextWidget instanceof Rl&&(i=e.nextWidget):e.previousWidget instanceof Rl&&(i=e.previousWidget),(0,a.isNullOrUndefined)(i)){if(e.paragraphFormat.contextualSpacing&&e.isInsideTable&&(!this.documentHelper.allowSpaceOfSameStyleInTable||"Word2013"===this.documentHelper.compatibilityMode))if(0===e.index)i=this.updateFirstParagraphSpacingBasedOnContextualSpacing(e,t);else if(e.index===e.associatedCell.childWidgets.length-1&&(i=this.updateLastParagraphSpacingBasedOnContextualSpacing(e))===e)return!0;if((0,a.isNullOrUndefined)(i))return!1}if(i instanceof Rl&&e.paragraphFormat.baseStyle===i.paragraphFormat.baseStyle&&(!e.isInsideTable||!this.documentHelper.allowSpaceOfSameStyleInTable)){if(e.paragraphFormat.listFormat.listId>=0&&i.paragraphFormat.listFormat.listId>=0&&!e.paragraphFormat.contextualSpacing){if(t&&e.paragraphFormat.spaceAfterAuto)return!0;if(!t&&e.paragraphFormat.spaceBeforeAuto)return!0}return e.paragraphFormat.contextualSpacing}return!1},t.prototype.updateFirstParagraphSpacingBasedOnContextualSpacing=function(e,t){var i,n=e.associatedCell,r=n.ownerRow,o=r.ownerTable;if(i=t?(0,a.isNullOrUndefined)(e.nextRenderedWidget)?(0,a.isNullOrUndefined)(n.nextRenderedWidget)?void 0:n.nextRenderedWidget.firstChild:e.nextRenderedWidget:(0,a.isNullOrUndefined)(e.previousRenderedWidget)?(0,a.isNullOrUndefined)(n.previousRenderedWidget)?void 0:n.previousRenderedWidget.firstChild:e.previousRenderedWidget,0===n.index&&0===e.index){if(0!==r.index)return(0,a.isNullOrUndefined)(i)&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0?e:i;if(!o.isInsideTable||0!=o.index)return o.previousRenderedWidget;i=this.checkOwnerTablePrevItem(o,e)}else if(0===e.index&&!t){var s=r.childWidgets[n.index-1];if(s.childWidgets[s.childWidgets.length-1]instanceof Al&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}return i},t.prototype.updateLastParagraphSpacingBasedOnContextualSpacing=function(e){var t,i=e.associatedCell,n=i.ownerRow;if(i.index===n.childWidgets.length-1&&e.index===i.childWidgets.length-1){if("Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}else if(e.index===i.childWidgets.length-1){for(t=n.childWidgets[i.index+1].firstChild;t instanceof Al;)t=t.childWidgets[0].childWidgets[0].childWidgets[0]}return t},t.prototype.checkOwnerTablePrevItem=function(e,t){var i=e.associatedCell.ownerRow;if(i.index>0){if("Normal"===t.paragraphFormat.baseStyle.name&&t.paragraphFormat.listFormat.listId<0)return t}else{if(!i.ownerTable.isInsideTable||0!==i.ownerTable.index)return i.ownerTable.previousRenderedWidget;this.checkOwnerTablePrevItem(i.ownerTable,t)}},Object.defineProperty(t.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),t.prototype.layout=function(){},t.prototype.destroy=function(){this.documentHelper=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isSkipFirstLineIndent=void 0,this.isFieldCode=void 0,this.footnoteHeight=void 0,this.isMultiColumnDoc=void 0,this.isIFfield=void 0,this.isPastingContent=void 0},t.prototype.layoutItems=function(e,t,i){for(var n,r=this,o=0,s=0,l=0;l<e.length;l++){var d=e[l];d.sectionFormat.numberOfColumns>1&&(this.isMultiColumnDoc=!0);var h=e[l+1];this.viewer.columnLayoutArea.setColumns(d.sectionFormat);var c=this.documentHelper.pages[this.documentHelper.pages.length-1],p=void 0;if((0,a.isNullOrUndefined)(c)||(0,a.isNullOrUndefined)(c.bodyWidgets[c.bodyWidgets.length-1])||0!==c.bodyWidgets[c.bodyWidgets.length-1].childWidgets.length||(0,a.isNullOrUndefined)(c.bodyWidgets[c.bodyWidgets.length-1].previousSplitWidget)||(p=c.bodyWidgets[c.bodyWidgets.length-1].previousSplitWidget),l>0&&!(0,a.isNullOrUndefined)(p)&&!(0,a.isNullOrUndefined)(p.lastChild)&&!(p.lastChild instanceof Al)){var u=p.lastChild,g=u.previousRenderedWidget;if(u.isSectionBreak&&g instanceof Rl&&g.isEndsWithPageBreak&&(u=g),"Word2013"===this.documentHelper.compatibilityMode&&(u.isEndsWithPageBreak||u.isEndsWithColumnBreak)&&0===c.bodyWidgets[0].childWidgets.length)this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1)[0].destroy(),c=this.documentHelper.pages[this.documentHelper.pages.length-1]}var m=d.sectionFormat.breakCode,f=void 0;if(0!==l&&"Word2010"===this.documentHelper.compatibilityMode&&"NewColumn"===m){var v=e[l-1].getSplitWidgets();if((f=v[v.length-1]).sectionFormat.columns.length>1&&d.sectionFormat.columns.length>1&&f.sectionFormat.columns.length===d.sectionFormat.columns.length&&f.sectionFormat.columns.length-1!==f.columnIndex&&!(f.lastChild instanceof Rl&&f.lastChild.isEndsWithPageBreak)){var y=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(f);(0,a.isNullOrUndefined)(y)||(d.columnIndex=y.index,d.isWord2010NextColumn=!0,d.y=f.y,this.viewer.clientActiveArea.height-=d.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=d.y)}}d.isWord2010NextColumn||"NoBreak"===m||(m="NewPage");var w=void 0;if(0!==l&&(w=c.bodyWidgets[c.bodyWidgets.length-1].lastChild)){g=w.previousRenderedWidget;w instanceof Rl&&w.isSectionBreak&&g instanceof Rl&&(w=g)}if(0===l&&!i||0!==l&&!d.isWord2010NextColumn&&((0,a.isNullOrUndefined)(m)||"NewPage"===m||o!==d.sectionFormat.pageHeight||s!==d.sectionFormat.pageWidth||!(0,a.isNullOrUndefined)(w)&&w.isEndsWithPageBreak))n=this.viewer.createNewPage(d);else{var b=this.documentHelper.viewer.clientActiveArea.y,C=this.documentHelper.viewer.clientActiveArea.height;if(i){var x=this.getBodyWidget(c.bodyWidgets[c.bodyWidgets.length-1],!0),I=this.getNextWidgetHeight(x);this.viewer.updateClientArea(x,x.page),C=this.viewer.clientActiveArea.height-(I-this.viewer.clientActiveArea.y),b=I,i=!1}(n=c).bodyWidgets.push(d),n.bodyWidgets[n.bodyWidgets.length-1].page=n,this.documentHelper.viewer.updateClientArea(d,n),this.documentHelper.viewer.clientActiveArea.y=b,this.documentHelper.viewer.clientActiveArea.height=C}if(o=d.sectionFormat.pageHeight,s=d.sectionFormat.pageWidth,this.addBodyWidget(this.viewer.clientActiveArea,d),this.documentHelper.pages.length>1){for(var k=0,F=0;F<this.documentHelper.pages.length;F++){var P=this.documentHelper.pages[F];if(P.sectionIndex>d.index||P===n)break;k++}k<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(k,n)}if(this.layoutSection(d,0,h),d.isWord2010NextColumn&&!(0,a.isNullOrUndefined)(f)){var S=this.getNextWidgetHeight(f);this.viewer.clientActiveArea.y<S&&(this.viewer.updateClientArea(f,f.page),this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.height-(S-this.viewer.clientActiveArea.y),this.viewer.clientActiveArea.y=S)}}t||this.layoutComments(this.documentHelper.comments),this.updateFieldElements(),"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement(),setTimeout((function(){r.documentHelper&&(r.documentHelper.isScrollHandler=!0,r.documentHelper.clearContent(),r.viewer.updateScrollBars(),r.documentHelper.isScrollHandler=!1,r.isInitialLoad=!1)}),50)},t.prototype.layoutComments=function(e){(0,a.isNullOrUndefined)(e)||this.viewer.owner.commentReviewPane.layoutComments(e)},t.prototype.layoutSection=function(e,t,i){var n,r,o=e.firstChild;do{if(!this.isLayoutWhole&&o instanceof Al&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&o.calculateGrid(),!(0,a.isNullOrUndefined)(o)){this.viewer.updateClientAreaForBlock(o,!0,void 0,!0,!0);o.containerWidget.indexInOwner;n=this.layoutBlock(o,t),t=0,this.viewer.updateClientAreaForBlock(o,!1),o=n}}while(o);if(o=e.firstChild,this.viewer instanceof kl&&e.sectionFormat.numberOfColumns>1&&!(0,a.isNullOrUndefined)(i)&&"NoBreak"===i.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex))if(this.getColumnBreak(e)){var s=e.getSplitWidgets(),l=s[s.length-1];if((0,a.isNullOrUndefined)(e.page.nextPage)){var d=this.getBodyWidget(l,!0);this.viewer.updateClientArea(d,d.page);var h=this.getNextWidgetHeight(d);this.viewer.clientActiveArea.height-=h-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=h}else this.splitBodyWidgetBasedOnColumn(l)}else(0,a.isNullOrUndefined)(e.page.nextPage)||(e=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0]),this.splitBodyWidgetBasedOnColumn(e);for(o&&o.bodyWidget&&o.bodyWidget.page&&(r=o.bodyWidget.page);r;)r.footnoteWidget?(this.layoutfootNote(r.footnoteWidget),r=r.nextPage):r=r.nextPage;r=void 0,o=void 0},t.prototype.reLayoutMultiColumn=function(e,t,i){this.isInitialLoad=!0,e=e.getSplitWidgets()[0],this.combineMultiColumnForRelayout(e),e.sectionFormat.numberOfColumns>1&&(this.isMultiColumnDoc=!0),this.isMultiColumnSplit=!1;var n=e.previousRenderedWidget,r=e.nextRenderedWidget,o=!1;if(!t&&!(0,a.isNullOrUndefined)(e.firstChild)&&e.firstChild instanceof Rl&&e.y!==e.firstChild.y&&(e.y=e.firstChild.y),t&&r&&e.page!==r.page&&e.firstChild instanceof Rl){var s=0;if((c=e.firstChild).isEmpty())s=this.documentHelper.textHelper.getParagraphMarkSize(c.characterFormat).Height;else{var l=c.childWidgets[0];s=this.getMaxElementHeight(l)}var d=c.previousRenderedWidget;e.y===this.viewer.clientActiveArea.y&&s>this.viewer.clientActiveArea.height&&(d=(0,a.isNullOrUndefined)(d)?c:d,this.moveBlocksToNextPage(d),this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),o=!0)}else if(!(0,a.isNullOrUndefined)(n)&&n.page!==e.page&&e.firstChild instanceof Rl&&n.lastChild instanceof Rl){var h=n.lastChild,c=e.firstChild;if(e instanceof Ol&&n.lastChild&&h instanceof Rl&&"NoBreak"===n.sectionFormat.breakCode&&e.page.index!==n.page.index&&e.index!==n.index){var p=n;p.sectionFormat.columns.length>1&&(p=this.getBodyWidget(p,!0));var u=Pa.round(this.getNextWidgetHeight(p)+c.height,2);if(!n.lastChild.isEndsWithPageBreak&&!n.lastChild.isEndsWithColumnBreak&&u<=Pa.round(this.viewer.clientActiveArea.bottom,2)){for(var g=n.page,m=e.page,f=0;f<m.bodyWidgets.length;f++){var v=m.bodyWidgets[f];m.bodyWidgets.splice(m.bodyWidgets.indexOf(v),1),g.bodyWidgets.splice(g.bodyWidgets.length,0,v),v.page=g,f--}e.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}o||(this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=e.y),this.addBodyWidget(this.viewer.clientActiveArea,e),this.clearBlockWidget(e.childWidgets,!0,!0,!0),this.isMultiColumnLayout=!0,this.reLayoutMultiColumnBlock(e,r,i),this.isMultiColumnLayout=!1,this.isInitialLoad=!1;var y=e.getSplitWidgets(),w=y[y.length-1],b=this.getBodyWidget(w,!0);this.viewer.updateClientArea(b,b.page);var C=this.getNextWidgetHeight(b);if(this.viewer.clientActiveArea.height-=C-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=C,!(0,a.isNullOrUndefined)(w)&&!(0,a.isNullOrUndefined)(w.nextRenderedWidget)){r=w.nextRenderedWidget;var x=this.documentHelper.viewer.clientActiveArea.y,I=this.documentHelper.viewer.clientActiveArea.height;this.documentHelper.viewer.updateClientArea(r,r.page),this.documentHelper.viewer.clientActiveArea.y=x,this.documentHelper.viewer.clientActiveArea.height=I,this.documentHelper.blockToShift=r.firstChild}((0,a.isNullOrUndefined)(w.nextRenderedWidget)||!(0,a.isNullOrUndefined)(w.nextRenderedWidget)&&"NoBreak"!==w.sectionFormat.breakCode&&w.nextRenderedWidget.sectionFormat.pageHeight!==w.sectionFormat.pageHeight&&w.nextRenderedWidget.sectionFormat.pageWidth!==w.sectionFormat.pageWidth)&&(this.documentHelper.blockToShift=void 0)},t.prototype.combineMultiColumnForRelayout=function(e){var t=e.getSplitWidgets(),i=t[0];for(e=t[t.length-1];e!==i;){for(var n=e.previousRenderedWidget,r=!1,o=0;o<e.childWidgets.length;o++)e.childWidgets[o]instanceof Ll&&!(0,a.isNullOrUndefined)(e.childWidgets[o].previousSplitWidget)&&!(0,a.isNullOrUndefined)(e.childWidgets[o].previousSplitWidget.previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page!==e.childWidgets[o].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(r=!0),e.childWidgets[o]instanceof Ll&&!(0,a.isNullOrUndefined)(e.childWidgets[o].previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page===e.childWidgets[o].bodyWidget.page&&!r?(e.childWidgets[o].combineWidget(this.viewer),n.lastChild instanceof Al&&this.updateCellHeightInCombinedTable(n.lastChild),o--):(n.childWidgets.push(e.childWidgets[o]),e.childWidgets[o].containerWidget=n,e.childWidgets[o].containerWidget.page=n.page,e.childWidgets.splice(0,1),o--);e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},t.prototype.reLayoutMultiColumnBlock=function(e,t,i){var n,r=e.firstChild;do{r instanceof Al&&"Auto"===r.tableFormat.preferredWidthType&&!r.tableFormat.allowAutoFit&&r.calculateGrid(),(0,a.isNullOrUndefined)(r)||(this.viewer.updateClientAreaForBlock(r,!0,void 0,!0),n=this.layoutBlock(r,0,r.index<i),this.viewer.updateClientAreaForBlock(r,!1),r=n)}while(r&&-1!==e.getSplitWidgets().indexOf(r.bodyWidget));if(r=e.firstChild,this.viewer instanceof kl&&e.sectionFormat.numberOfColumns>1&&!(0,a.isNullOrUndefined)(t)&&"NoBreak"===t.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex)){var o=e.getSplitWidgets(),s=o[o.length-1];if(this.getColumnBreak(e))if(e.page!==s.page)this.splitBodyWidgetBasedOnColumn(s);else{var l=this.getBodyWidget(s,!0);this.viewer.updateClientArea(l,l.page);var d=this.getNextWidgetHeight(l);this.viewer.clientActiveArea.height-=d-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=d}else(0,a.isNullOrUndefined)(e.page.nextPage)||this.splitBodyWidgetBasedOnColumn(s)}},t.prototype.splitBodyWidgetBasedOnColumn=function(e){var t=e=this.getBodyWidget(e,!0);if(this.isMultiColumnSplit=!0,!this.isInitialLoad&&e.sectionFormat.equalWidth){var i=this.documentHelper.selection.startOffset,n=this.documentHelper.selection.endOffset;this.combineMultiColumn(e),this.layoutMultiColumnBody(e,!1),i!==this.documentHelper.selection.startOffset&&this.documentHelper.selection.select(i,n)}this.combineMultiColumn(e);for(var r=this.getCountOrLine(e,void 0,void 0,!0).lineCount,o=Math.round(r/e.sectionFormat.numberOfColumns);e;){var s=this.getCountOrLine(e,o,!0,!1),l=s.lineWidget,d=s.lineCount;if(!(0,a.isNullOrUndefined)(l)){if(l.paragraph.containerWidget instanceof Ol)this.moveToNextLine(l,!0,l.indexInOwner);else if(l.paragraph.containerWidget instanceof Vl){var h=[l.paragraph.containerWidget.ownerTable],c=[l.paragraph.containerWidget.ownerRow],p=l.paragraph.containerWidget.index;h[h.length-1].isInsideTable&&(h[h.length-1]=this.getParentTable(h[h.length-1]),c[c.length-1]=this.getParentRow(c[c.length-1])),this.updateWidgetsToTable(h,c,c[c.length-1],!1,d,p,!0);for(var u=h[h.length-1],g=c[c.length-1].nextRenderedWidget;g;)this.clearRowWidget(g,!0,!0,!1),g=(g=this.layoutRow(h,g)).nextRenderedWidget;!(0,a.isNullOrUndefined)(u.nextRenderedWidget)&&e.sectionFormat.equalWidth&&(this.documentHelper.blockToShift=u.nextRenderedWidget,this.documentHelper.layout.shiftLayoutedItems(!1))}var m=this.getBodyWidget(l.paragraph.bodyWidget,!0),f=this.getBodyWidget(m,!1);if(!m.sectionFormat.equalWidth&&f.sectionFormat.numberOfColumns-1===f.columnIndex&&(0,a.isNullOrUndefined)(f.nextSplitWidget)){var v=m,y=this.getCountOrLine(m).lineCount;this.layoutMultiColumnBody(v,!0),y!==this.getCountOrLine(m).lineCount&&this.splitBodyWidgetBasedOnColumn(m)}if((0,a.isNullOrUndefined)(f.nextSplitWidget)){this.viewer.updateClientArea(m,m.page);var w=this.getNextWidgetHeight(m);this.viewer.clientActiveArea.height-=w-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=w,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height}}if(e=e.nextRenderedWidget,!(0,a.isNullOrUndefined)(e)&&e.columnIndex===e.sectionFormat.numberOfColumns-1)break}this.isMultiColumnSplit=!1,this.isInitialLoad||(e=this.getBodyWidget(t,!1),(0,a.isNullOrUndefined)(e.nextRenderedWidget)||(this.documentHelper.blockToShift=e.nextRenderedWidget.firstChild))},t.prototype.getColumnBreak=function(e){var t=this.getBodyWidget(e,!0);if(t.sectionFormat.numberOfColumns<=1)return!1;for(;t;){if(t.lastChild instanceof Rl&&t.lastChild.isEndsWithColumnBreak)return!0;if((0,a.isNullOrUndefined)(t.nextRenderedWidget)||t.index!==t.nextRenderedWidget.index)break;t=t.nextRenderedWidget}return!1},t.prototype.layoutMultiColumnBody=function(e,t){for(var i=!1;e;){i||(this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,e instanceof Dl?(this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY):this.viewer.clientActiveArea.y=e.y),i=!t;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];r instanceof Al&&this.clearTableWidget(r,!0,!0,!0),this.viewer.updateClientAreaForBlock(r,!0);var o=!1;r instanceof Rl&&!(0,a.isNullOrUndefined)(r.paragraphFormat)&&-1!==r.paragraphFormat.listFormat.listId&&(o=0===r.paragraphFormat.listFormat.listLevelNumber),this.layoutBlock(r,0,o),this.viewer.updateClientAreaForBlock(r,!1)}if(e.columnIndex===e.sectionFormat.numberOfColumns-1||!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&e.sectionIndex!==e.nextRenderedWidget.sectionIndex)break;e=e.nextRenderedWidget}},t.prototype.getNextWidgetHeight=function(e){for(var t=0,i=0;e&&e.childWidgets.length>0;){var n=e.lastChild;if(n instanceof Rl&&n.isSectionBreak&&n.previousRenderedWidget instanceof Al&&"Word2013"!==this.documentHelper.compatibilityMode&&(n=n.previousRenderedWidget),t=n.height,n instanceof Al&&(t=this.getHeight(n)),(t+=n.y)>i&&(i=t),!(0,a.isNullOrUndefined)(e)&&e.columnIndex===e.sectionFormat.numberOfColumns-1||0===e.sectionFormat.numberOfColumns||!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&e.sectionIndex!==e.nextRenderedWidget.sectionIndex)break;e=e.nextRenderedWidget}return i},t.prototype.getHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},t.prototype.getBookmarkMargin=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];if(!(0,a.isNullOrUndefined)(n.margin)&&n instanceof td){t=n.margin.top+n.margin.bottom;break}}return t},t.prototype.getCountOrLine=function(e,t,i,n){for(var r,o,s=0,l=!1,d=0,h=0,c=0;e;){for(var p=0;p<e.childWidgets.length;p++){var u=e.childWidgets[p];if(u instanceof Rl){if(u.isSectionBreak)continue;for(var g=0;g<u.childWidgets.length;g++){var m=u.childWidgets[g];if(c=0,(0,a.isNullOrUndefined)(m.margin)||(c=m.margin.top+m.margin.bottom+this.getBookmarkMargin(m)),i){if(d+=m.height-c,Math.round(t)<Math.round(d)){r=u.childWidgets[g],l=!0;break}0}else s++,d+=m.height-c}}else u instanceof Al&&(o=this.getCountOrLineTable(u,t,i,d,!1,n),n?d+=o.lineCount:i?(0,a.isNullOrUndefined)(o.lineWidget)?d=o.lineCount:(r=o.lineWidget,h=o.lineCount,l=!0):s+=o.lineCount);if(l&&i)break}if(l&&i)break;if(!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&e.index!==e.nextRenderedWidget.index)break;e=e.nextRenderedWidget}return n?{lineWidget:void 0,lineCount:d}:i?{lineWidget:r,lineCount:h}:{lineWidget:void 0,lineCount:s}},t.prototype.getCountOrLineTable=function(e,t,i,n,r,o){for(var s,l,d=0,h=!1,c=0,p=0,u=0,g=0,m=0,f=0,v=0;v<e.childWidgets.length;v++){var y=e.childWidgets[v],w=void 0,b=void 0;u=0,g=0,m=0,f=0;for(var C=0;C<y.childWidgets.length;C++){for(var x=y.childWidgets[C],I=0;I<x.childWidgets.length;I++){if((S=x.childWidgets[I])instanceof Rl&&S.childWidgets.length>0)for(var k=0;k<S.childWidgets.length;k++)u++,w=x,m+=S.childWidgets[k].height;else u+=(l=this.getCountOrLineTable(S,t,i,n,!0,o)).lineCount,m+=l.lineCount}g<u&&(g=u),f<m&&(f=m,b=w),u=0,m=0}if(!i||r)c+=g,p+=f;else for(var F=0,P=0;P<b.childWidgets.length;P++){var S;if((S=b.childWidgets[P])instanceof Rl)for(C=0;C<S.childWidgets.length;C++){if(n+=S.childWidgets[C].height,Math.round(t)<Math.round(n)){s=S.childWidgets[C],h=!0,n=0,d=F;break}if(F++,h&&i)break}else{if(l=this.getCountOrLineTable(S,t,i,n,!1,o),!(0,a.isNullOrUndefined)(l.lineWidget)){h=!0,n=0,s=l.lineWidget,d=F+=l.lineCount;break}F+=l.lineCount,n+=S.height}if(h&&i)break}if(g=0,h&&i)break}return o?{lineWidget:void 0,lineCount:p}:i?i&&(0,a.isNullOrUndefined)(s)&&r?{lineWidget:void 0,lineCount:c}:i&&(0,a.isNullOrUndefined)(s)&&!r?{lineWidget:void 0,lineCount:n}:{lineWidget:s,lineCount:d}:{lineWidget:void 0,lineCount:c}},t.prototype.combineMultiColumn=function(e){for(e=this.getBodyWidget(e,!1);e&&0!==e.columnIndex;){var t=e.previousRenderedWidget;if(t.lastChild instanceof Rl&&t.lastChild.isEndsWithColumnBreak)break;for(var i=!1,n=0;n<e.childWidgets.length;n++)e.childWidgets[n]instanceof Ll&&!(0,a.isNullOrUndefined)(e.childWidgets[n].previousSplitWidget)&&!(0,a.isNullOrUndefined)(e.childWidgets[n].previousSplitWidget.previousSplitWidget)&&e.childWidgets[n].previousSplitWidget.bodyWidget.page!==e.childWidgets[n].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(i=!0),e.childWidgets[n]instanceof Ll&&!(0,a.isNullOrUndefined)(e.childWidgets[n].previousSplitWidget)&&e.childWidgets[n].previousSplitWidget.bodyWidget.page===e.childWidgets[n].bodyWidget.page&&!i?(e.childWidgets[n].combineWidget(this.viewer),t.lastChild instanceof Al&&this.updateCellHeightInCombinedTable(t.lastChild),n--):(t.childWidgets.push(e.childWidgets[n]),e.childWidgets[n].containerWidget=t,e.childWidgets[n].containerWidget.page=t.page,e.childWidgets.splice(0,1),n--);e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},t.prototype.updateCellHeightInCombinedTable=function(e){for(var t=0,i=0,n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++){for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)i+=s.childWidgets[a].height;i>t&&(t=i),i=0;for(var l=0;l<r.childWidgets.length;l++)r.childWidgets[l].height=t}t=0}},t.prototype.layoutHeaderFooter=function(e,t,i){var n=t.getCurrentPageHeaderFooter(e,!0);if(n){var r=n;(0,a.isNullOrUndefined)(n.page)&&(n.page=i,n.height=0,this.clearBlockWidget(n.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!0),this.layoutHeaderFooterItems(t,n)),(n=r.clone()).parentHeaderFooter=r,this.clearBlockWidget(n.childWidgets,!0,!0,!0);var o=n;o.page=i,o.height=0,this.updateRevisionsToHeaderFooter(o,i),t.updateHFClientArea(e.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,o),e.sectionFormat.topMargin<i.boundingRectangle.bottom&&i.headerWidget.floatingElements.length>0&&"Behind"!==i.headerWidget.floatingElements[0].textWrappingStyle&&(i.headerWidget=this.shiftItemsForVerticalAlignment(o))}if(n=t.getCurrentPageHeaderFooter(e,!1)){r=n;(0,a.isNullOrUndefined)(n.page)&&(n.page=i,n.height=0,this.clearBlockWidget(n.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!1),this.layoutHeaderFooterItems(t,n)),(n=r.clone()).parentHeaderFooter=r,this.clearBlockWidget(n.childWidgets,!0,!0,!0);var s=n;s.page=i,s.height=0,t.updateHFClientArea(e.sectionFormat,!1),this.updateRevisionsToHeaderFooter(s,i),i.footerWidget=this.layoutHeaderFooterItems(t,s)}},t.prototype.shiftItemsForVerticalAlignment=function(e){for(var t=e.floatingElements,i=0;i<t.length;i++){var n=t[i],r=n.verticalOrigin,o=n.paragraph;if("Margin"===r&&!o.isInsideTable){var s=n.verticalPosition;if(0!=s){var a=(s+=this.viewer.clientActiveArea.y)-n.y;if(n.y=s,n instanceof hd)for(var l=0;l<n.textFrame.childWidgets.length;l++){var d=n.textFrame.childWidgets[l];d instanceof Rl&&(d.y=d.y+a)}}}}return e},t.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),n=e.clone();this.documentHelper.headersFooters[t][i]=n;for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];o instanceof Al&&this.clearTableWidget(o,!1,!0)}return n},t.prototype.updateRevisionsToHeaderFooter=function(e,t){var i=e.childWidgets;if(e instanceof Bl&&i.length>0)for(var n=0;n<i.length;n++)if(i[n].childWidgets.length>0)for(var r=i[n].childWidgets,o=0;o<r.length;o++){var s=r[o].children;if(s)for(var a=0;a<s.length;a++)if(s[a].removedIds.length>0)for(var l=s[a].removedIds,d=0;d<l.length;d++){var h=this.documentHelper.revisionsInternal.get(l[d]);s[a].revisions[d]=h,this.updateRevisionRange(h,t)}}},t.prototype.updateRevisionRange=function(e,t){for(var i=0;i<e.range.length;i++){var n=e.range[i];n instanceof Zl?(0,a.isNullOrUndefined)(n.line.paragraph.bodyWidget.page)&&(n.line.paragraph.bodyWidget.page=t):n instanceof ka&&(0,a.isNullOrUndefined)(n.ownerBase.bodyWidget.page)&&(n.ownerBase.bodyWidget.page=t)}},t.prototype.linkFieldInHeaderFooter=function(e){var t=e.firstChild;do{t instanceof Rl?this.linkFieldInParagraph(t):this.linkFieldInTable(t)}while(t=t.nextWidget)},t.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(r instanceof _l&&(0!==r.fieldType||0===r.fieldType&&-1===this.documentHelper.fields.indexOf(r))&&r.linkFieldCharacter(this.documentHelper),r instanceof $l&&!(0,a.isNullOrUndefined)(r.previousElement)&&r.previousElement instanceof _l&&r.fieldBegin!==r.previousElement.fieldBegin&&(r.fieldBegin=r.previousElement.fieldBegin),r instanceof hd){var o=r.textFrame.firstChild;if(o)do{o instanceof Rl?this.linkFieldInParagraph(o):this.linkFieldInTable(o)}while(o=o.nextWidget)}else if(r instanceof Bd){var s=this.getCommentById(this.documentHelper.comments,r.commentId);(0,a.isNullOrUndefined)(s)||(0===r.commentType?s.commentStart=r:s.commentEnd=r,r.comment=s)}}},t.prototype.getCommentById=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.commentId===t)return n}},t.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s instanceof Rl?this.linkFieldInParagraph(s):this.linkFieldInTable(s)}},t.prototype.layoutHeaderFooterItems=function(e,t){if(this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length){var i=new Rl,n=new zl(i);i.childWidgets.push(n),t.childWidgets.push(i),i.containerWidget=t}this.linkFieldInHeaderFooter(t);for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];o instanceof Al&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&!o.isGridUpdated&&o.calculateGrid(),e.updateClientAreaForBlock(o,!0),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1)}var s=t.headerFooterType;return"OddFooter"!==s&&"EvenFooter"!==s&&"FirstPageFooter"!==s||this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},t.prototype.shiftChildLocation=function(e,t){var i=t.y+e,n=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40;e=(i=Math.max(i,n))-t.y;for(var r=t.y=i,o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];if(s instanceof Rl){s.x=s.x,s.y=0===o?s.y+e:r,r+=s.height;for(var a=0;a<s.childWidgets.length;a++)for(var l=s.childWidgets[a],d=0;d<l.children.length;d++){var h=l.children[d];if(h instanceof dd&&"Inline"!==h.textWrappingStyle){if("Paragraph"===h.verticalOrigin||"Line"===h.verticalOrigin)h.y=s.y+h.verticalPosition;else{var c=this.getFloatingItemPoints(h);h.y=c.y}if(h instanceof hd){var p=h.textFrame.marginTop;this.updateChildLocationForCellOrShape(h.y+p,h)}}}}else this.shiftChildLocationForTableWidget(s,e),r+=s.height}},t.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n instanceof Ul&&this.shiftChildLocationForTableRowWidget(n,t)}},t.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},t.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof Rl?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},t.prototype.layoutBlock=function(e,t,i){var n;if(e instanceof Rl){(this.isInitialLoad||!this.isRelayout&&e.paragraphFormat.bidi&&this.isDocumentContainsRtl)&&(e.splitTextRangeByScriptType(0),e.splitLtrAndRtlText(0),e.combineconsecutiveRTL(0)),n=this.layoutParagraph(e,t,i);var r=this.checkAndRelayoutPreviousOverlappingBlock(e);r&&(n=r)}else n=this.layoutTable(e,t),this.checkAndRelayoutPreviousOverlappingBlock(e),this.updateTableYPositionBasedonTextWrap(n);return n.nextRenderedWidget},t.prototype.updateTableYPositionBasedonTextWrap=function(e){var t=this;if(!((0,a.isNullOrUndefined)(e.bodyWidget)||e.containerWidget instanceof cd)){var i=e.y,n=new Tl(e.x,e.y,e.width,e.height);e.bodyWidget.floatingElements.forEach((function(r){if(r instanceof hd&&!r.paragraph.isInsideTable){var o=new Tl(r.x,r.y,r.width,r.height);if(("TopAndBottom"===r.textWrappingStyle||"Square"===r.textWrappingStyle)&&n.isIntersecting(o)){e.y=r.y+r.height+r.distanceBottom,t.updateChildLocationForTable(e.y,e);var s=e.y-i;t.viewer.cutFromTop(t.viewer.clientActiveArea.y+s)}}}))}},t.prototype.shiftWrapStyle=function(e){return"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Inline"===e.textWrappingStyle},t.prototype.checkAndRelayoutPreviousOverlappingBlock=function(e){if(!(e.containerWidget instanceof cd||this.isRelayoutOverlap)){var t=e.previousWidget;if(e instanceof Rl)if(e.floatingElements.length>0)for(var i=0,n=0;n<e.floatingElements.length;n++){var r=e.floatingElements[n];if(!this.shiftWrapStyle(r)){for(var o=new Tl(r.x,r.y,r.width,r.height);t;){if(e.isInsideTable&&i>this.viewer.clientArea.height){this.startOverlapWidget=void 0,this.endOverlapWidget=void 0;break}if(t instanceof Rl){var s=new Tl(t.x,t.y,t.width,t.height);o.isIntersecting(s)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}i+=t.height,t=t.previousWidget}t=e.previousWidget}}else{var a=e.getSplitWidgets();if(a)return a[a.length-1]}else{var l=e;if(!l.wrapTextAround)return l;for(var d=new Tl(l.x,l.y,l.getTableCellWidth(),l.height);t;){if(t instanceof Rl){var h=new Tl(t.x,t.y,t.width,t.height);d.isIntersecting(h)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}if(e instanceof Rl&&e.containerWidget instanceof Ol&&e.floatingElements.length>0&&!this.shiftWrapStyle(e.floatingElements[0])&&e.containerWidget.firstChild!=e&&e.y+e.floatingElements[0].height>this.viewer.clientArea.bottom){var c=e.previousWidget;c&&c instanceof Rl&&c.y+c.height+this.getLineHeigth(e,e.floatingElements[0].line)+e.floatingElements[0].height>this.viewer.clientArea.bottom&&(this.moveToNextPage(this.viewer,e.floatingElements[0].line,!1,!1,!0),this.startOverlapWidget=e,this.endOverlapWidget=e)}this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.skipRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,e),this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1),this.startOverlapWidget=void 0,this.endOverlapWidget=void 0}return e},t.prototype.getLineHeigth=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++)t!=e.childWidgets[n]&&(i+=e.childWidgets[n].height);return i},t.prototype.addParagraphWidget=function(e,t){return t.isEmpty()&&!(0,a.isNullOrUndefined)(t.paragraphFormat)&&("Center"===t.paragraphFormat.textAlignment||"Right"===t.paragraphFormat.textAlignment||"Justify"===t.paragraphFormat.textAlignment&&t.paragraphFormat.bidi)&&-1===t.paragraphFormat.listFormat.listId?(this.updateXPositionForEmptyParagraph(e,t),t.y=e.y):(this.viewer.clientActiveArea.width<=0&&this.viewer instanceof Fl?t.x=this.previousPara:(t.x=e.x,this.previousPara=t.x),t.width=e.width,t.y=e.y,t.clientX=void 0,t.hasOwnProperty("absoluteXPosition")&&delete t.absoluteXPosition),t},t.prototype.updateXPositionForEmptyParagraph=function(e,t){if(t.isEmpty()&&!(0,a.isNullOrUndefined)(t.paragraphFormat)){var i=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat);t.clientX=e.x;var n=e.x;t.absoluteXPosition={width:e.width,x:e.x},"Center"===t.paragraphFormat.textAlignment?n+=(e.width-i)/2:n+=e.width-i,t.width=i,t.x=n}},t.prototype.addLineWidget=function(e){var t=void 0;return(t=new zl(e)).width=e.width,e.childWidgets.push(t),t.paragraph=e,t},t.prototype.isFirstElementWithPageBreak=function(e){var t=!1;if(this.viewer instanceof kl){var i=e.childWidgets[0];if(i)for(var n=i.children[0];n;){if(!(n instanceof td&&n.name.indexOf("_")>=0)){n instanceof Zl&&("\f"===n.text||n.text===String.fromCharCode(14))&&(t=!0);break}n=n.nextElement}}return t},t.prototype.layoutfootNote=function(e){if("Pages"===this.documentHelper.owner.layoutType){var t=e.page.index,i=this.viewer.clientActiveArea.clone(),n=this.viewer.clientArea.clone();"Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1&&!this.isInitialLoad&&(this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0)),"Endnote"===e.footNoteType&&e.bodyWidgets[0].sectionFormat.numberOfColumns>1&&(this.isInitialLoad||this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0),this.viewer.clientActiveArea=i);var r=0;e.sectionFormat.columns.length>1&&"Footnote"===e.footNoteType&&(this.viewer.updateClientArea(e,e.page),r=this.viewer.clientActiveArea.width),"Footnote"===e.footNoteType&&(this.viewer.updateFootnoteClientArea(e.sectionFormat,e),e.sectionFormat.columns.length>1&&(this.viewer.clientActiveArea.width=r,this.viewer.clientArea.width=r)),e.height=0;var o=void 0,s=0;this.isRelayoutFootnote=!1;var l=0;this.viewer instanceof kl&&e.bodyWidgets.length>0&&("Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1||"Endnote"===e.footNoteType&&e.bodyWidgets[0].sectionFormat.columns.length>1)&&(this.isLayoutWhole&&this.updateColumnIndex(e.bodyWidgets[0],!1),this.splitFootNoteWidgetBasedOnColumn(e.bodyWidgets[0]));for(var d=e.bodyWidgets[0],h=0,c=0;c<e.bodyWidgets.length;c++){if(e.bodyWidgets[c].columnIndex!==d.columnIndex&&("Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1||"Endnote"===e.footNoteType&&e.bodyWidgets[c].sectionFormat.columns.length>1)&&(this.viewer.updateClientArea(e.bodyWidgets[c],e.bodyWidgets[c].page),r=this.viewer.clientActiveArea.width,h=this.viewer.clientActiveArea.x,"Footnote"===e.footNoteType&&this.viewer.updateFootnoteClientArea(e.sectionFormat,e),this.viewer.clientActiveArea.x=h,this.viewer.clientArea.x=h,this.viewer.clientActiveArea.width=r,this.viewer.clientArea.width=r,this.viewer.cutFromTop(e.y+s)),0===c){var p=new Rl;p.characterFormat=new ka,p.paragraphFormat=new ba,p.index=0;var u=new zl(p);p.childWidgets.push(u),s=this.documentHelper.textHelper.getParagraphMarkSize(p.characterFormat).Height,e.height+=s,e.y=this.viewer.clientActiveArea.y,"Endnote"===e.footNoteType&&this.viewer.updateClientArea(e.bodyWidgets[c],e.bodyWidgets[c].page,!0),this.viewer.cutFromTop(e.y+s),e.margin=new El(0,s,0,0)}l="Endnote"===e.footNoteType?0:l;for(var g=0;g<e.bodyWidgets[c].childWidgets.length&&(o=e.bodyWidgets[c].childWidgets[g],"Footnote"!==e.footNoteType&&1!==e.bodyWidgets[c].getSplitWidgets().length||(o.index=l,l++),o.containerWidget=e.bodyWidgets[c],o.containerWidget.page=e.page,o.containerWidget.containerWidget=e,this.viewer.updateClientAreaForBlock(o,!0),o instanceof Al&&(this.clearTableWidget(o,!0,!0,!0),this.isRelayoutFootnote=!0,"Footnote"===e.footNoteType&&(this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY)),this.layoutBlock(o,0),!(0,a.isNullOrUndefined)(e.bodyWidgets[c]));g++)e.bodyWidgets[c].columnIndex===d.columnIndex&&(e.height+=o.height),this.viewer.updateClientAreaForBlock(o,!1);d=e.bodyWidgets[c]}if(e.sectionFormat.columns.length>1){var m=this.getFootNoteBodyHeight(e.bodyWidgets[0]);e.height=m+s}if("Footnote"===e.footNoteType&&this.shiftChildWidgetInFootnote(e),"Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1&&e.page.bodyWidgets[e.page.bodyWidgets.length-1].sectionFormat.columns.length>1){var f=this.getBodyWidget(e.page.bodyWidgets[e.page.bodyWidgets.length-1],!0);if(this.getNextWidgetHeight(f)>e.y){this.footnoteHeight=e.height;var v=this.isLayoutWhole;this.isLayoutWhole=!1,this.layoutMultiColumnBody(f,!0),this.isLayoutWhole=v}}if(this.viewer.clientActiveArea=i,this.viewer.clientArea=n,!this.islayoutFootnote&&this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height>e.y){this.viewer.clientActiveArea.height-=e.height;var y=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-e.y;this.viewer.clientActiveArea.height-=y}if("Endnote"===e.footNoteType){var w=void 0;if((0,a.isNullOrUndefined)(e.page.nextPage)||(0,a.isNullOrUndefined)(e.page.nextPage.endnoteWidget)?e.page.index!==t&&(w=e):w=e.page.nextPage.endnoteWidget,!(0,a.isNullOrUndefined)(w)){var b=this.getBodyWidget(w.page.bodyWidgets[w.page.bodyWidgets.length-1],!0);this.viewer.updateClientArea(b,b.page),this.layoutfootNote(w)}}}return this.footnoteHeight=0,e},t.prototype.getFootNoteBodyHeight=function(e){for(var t=0;e&&0===e.columnIndex;){for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;e=e.nextRenderedWidget}return t},t.prototype.splitFootNoteWidgetBasedOnColumn=function(e){for(var t=this.getCountOrLine(e,void 0,void 0,!0).lineCount,i=Math.round(t/e.sectionFormat.numberOfColumns);e;){var n=this.getCountOrLine(e,i,!0,!1),r=this.viewer.clientActiveArea.clone(),o=this.viewer.clientArea.clone();if(0===n.lineWidget.paragraph.indexInOwner&&0===n.lineWidget.indexInOwner)this.updateColumnIndex(n.lineWidget.paragraph.bodyWidget,!0);else{this.splitParagraph(n.lineWidget.paragraph,n.lineWidget.indexInOwner,void 0);var s=this.moveBlocksToNextPage(n.lineWidget.paragraph.previousRenderedWidget);this.viewer.clientActiveArea=r,this.viewer.clientArea=o,(0,a.isNullOrUndefined)(s.nextRenderedWidget)||this.updateColumnIndex(s.nextRenderedWidget,!0)}if(n.lineWidget.paragraph.bodyWidget.columnIndex===n.lineWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns-1)break;e=e.nextRenderedWidget}},t.prototype.updateColumnIndex=function(e,t){for(;e;)t?e.columnIndex++:e.columnIndex=0,e=e.nextRenderedWidget},t.prototype.shiftChildWidgetInFootnote=function(e){var t=e.page,i=e.y-e.height;if(1===t.bodyWidgets[0].childWidgets.length&&t.bodyWidgets[0].firstChild){var n=t.bodyWidgets[0].firstChild.y,r=this.getBodyWidgetHeight(t.bodyWidgets[0]);i<n+r&&(i=n+r)}e.y=i;for(var o=i+=e.margin.top,s=e.bodyWidgets[0],a=0;a<e.bodyWidgets.length;a++){e.bodyWidgets[a].columnIndex!==s.columnIndex&&(i=o),s=e.bodyWidgets[a];for(var l=0;l<e.bodyWidgets[a].childWidgets.length;l++){var d=e.bodyWidgets[a].childWidgets[l];d instanceof Rl?(d.y=i,i+=d.height):(this.shiftChildLocationForTableWidget(d,i-d.y),i+=d.height)}}},t.prototype.getBodyWidgetHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},t.prototype.checkBlockHasField=function(e){if(!(e instanceof Rl))return this.checkTableHasField(e);for(var t=0,i=e.childWidgets;t<i.length;t++)for(var n=0,r=i[t].children;n<r.length;n++){var o=r[n];if(o instanceof _l&&(2===o.fieldType||1===o.fieldType)&&this.documentHelper.fieldStacks.length>0&&o.fieldBegin===this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1])return!0}return!1},t.prototype.checkTableHasField=function(e){for(var t=0,i=e.childWidgets;t<i.length;t++)for(var n=0,r=i[t].childWidgets;n<r.length;n++)for(var o=0,s=r[n].childWidgets;o<s.length;o++){var a=s[o];if(this.checkBlockHasField(a))return!0}return!1},t.prototype.layoutParagraph=function(e,t,i){if(this.isFieldCode&&!this.checkBlockHasField(e))return 0===e.childWidgets.length&&this.addLineWidget(e),e.isFieldCodeBlock=!0,e;if(e.isSectionBreak&&e.previousRenderedWidget instanceof Al&&"Word2013"!==this.documentHelper.compatibilityMode)return e;e.x=0,e.textWrapWidth=!1,this.addParagraphWidget(this.viewer.clientActiveArea,e);var n=!0;if(this.isFirstElementWithPageBreak(e)||(this.layoutListItems(e,i),n=!1),e.isEmptyInternal(!0)&&!this.checkIsFieldParagraph(e))this.layoutEmptyLineWidget(e,!0);else{var r=t<e.childWidgets.length?e.childWidgets[t]:void 0;for(this.isRelayoutOverlap||e.containerWidget instanceof cd||this.layoutFloatElements(e);r instanceof zl;){if(e!==r.paragraph&&0===r.indexInOwner&&n&&(r.previousLine.isEndsWithColumnBreak?(this.viewer.updateClientAreaForBlock(e,!0),this.layoutListItems(r.paragraph),this.viewer.updateClientAreaForBlock(e,!1)):this.layoutListItems(r.paragraph)),r.isFirstLine()&&(0,a.isNullOrUndefined)(this.fieldBegin)&&!(0,a.isNullOrUndefined)(e.paragraphFormat)){var o=-Pa.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(o)}r.marginTop=0,e=(r=this.layoutLine(r,0)).paragraph,r=r.nextLine}}return this.updateWidgetToPage(this.viewer,e),e.isLayouted=!0,e.isFieldCodeBlock=!1,e},t.prototype.checkIsFieldParagraph=function(e){if((0,a.isNullOrUndefined)(e.childWidgets)||0===e.childWidgets.length)return!1;for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(r instanceof _l&&r.hasFieldEnd)return!0}return!1},t.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},t.prototype.layoutFloatElements=function(e){var t=this;e.floatingElements.forEach((function(e){e instanceof dd&&"Inline"!==e.textWrappingStyle&&(t.isRelayoutOverlap||t.layoutShape(e))}))},t.prototype.layoutShape=function(e){if(!(e instanceof hd&&e.isHorizontalRule)){if("Inline"!==e.textWrappingStyle){var t=this.getFloatingItemPoints(e);e.x=t.x,e.y=t.y,!e.paragraph.isInsideTable&&0!==e.paragraph.indexInOwner&&e.verticalPosition>=0&&Math.round(e.paragraph.y)>=Math.round(e.y)&&this.viewer.clientArea.bottom<=e.y+e.height&&("Line"==e.verticalOrigin||"Paragraph"==e.verticalOrigin)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&(this.moveToNextPage(this.viewer,e.line),this.updateShapeBaseLocation(e.line.paragraph));var i=e.paragraph.bodyWidget;-1===i.floatingElements.indexOf(e)&&(i.floatingElements.push(e),i.floatingElements.sort((function(e,t){return e.y-t.y}))),-1===e.paragraph.floatingElements.indexOf(e)&&e.paragraph.floatingElements.push(e)}else if(0===e.width&&0!==e.widthScale){var n=Pa.convertPointToPixel(e.line.paragraph.getContainerWidth());e.width=n/100*e.widthScale}var r=this.viewer.clientArea,o=this.viewer.clientActiveArea;if(e instanceof hd){var s=e.textFrame.childWidgets;this.viewer.updateClientAreaForTextBoxShape(e,!0);for(var a=0;a<s.length;a++){var l=s[a];this.viewer.updateClientAreaForBlock(l,!0),l instanceof Al&&this.clearTableWidget(l,!0,!0),this.layoutBlock(l,0),this.viewer.updateClientAreaForBlock(l,!1)}}this.viewer.clientActiveArea=o,this.viewer.clientArea=r}},t.prototype.moveElementFromNextLine=function(e){var t=e.nextLine;for(t&&!e.paragraph.bodyWidget.sectionFormat.equalWidth&&e.paragraph.bodyWidget.columnIndex!==t.paragraph.bodyWidget.columnIndex&&(t=void 0);t instanceof zl;){if(t.children.length>0){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1),t=e.nextLine}},t.prototype.layoutLine=function(e,t){var i=e.paragraph;0===e.children.length&&this.moveElementFromNextLine(e);var n=e.children[t],r=!0;if(n instanceof _l&&e.children[e.children.length-1]instanceof _l){r=!1;for(var o=0;o<e.children.length;o++)if(2==e.children[o].fieldType&&null!=e.children[o].nextElement&&!(e.children[o].nextElement instanceof _l)){r=!0;break}}this.clearLineMeasures(),e.marginTop=0;for(i.bodyWidget.indexInOwner,e.indexInOwner;n instanceof ql;){if(n instanceof md||(n.padding.left=0),r?this.layoutElement(n,i):(this.layoutElement(n,i,!0),r=!0),e=n.line,n instanceof Zl){var s=n;!(0,a.isNullOrUndefined)(s.errorCollection)&&s.errorCollection.length>0&&(s.ischangeDetected=!0)}if(this.isRTLLayout)n=void 0,this.isRTLLayout=!1;else{var l=i.childWidgets.indexOf(n.line);if(l>0&&this.hasFloatingElement)this.hasFloatingElement=!1,i.bodyWidget.floatingElements.length>0&&n instanceof Zl&&!(i.containerWidget instanceof Vl)&&(n=i.childWidgets[l].children[0]);else{if(this.hasFloatingElement=!1,!this.is2013Justification||(0,a.isNullOrUndefined)(this.nextElementToLayout)||!(0,a.isNullOrUndefined)(n.paragraph.containerWidget.containerShape)&&n.paragraph.containerWidget.containerShape===this.nextElementToLayout){if((n=n.nextElement)instanceof Zl&&0==n.text.indexOf(" ")&&n.text.length>2&&(0,a.isNullOrUndefined)(n.nextElement)&&n.text.trim().length>0){n.text=n.text.substring(1,n.text.length),n.isWidthUpdated=!1;var d=n.line.children.indexOf(n);if(n.line.children.splice(d,1),(s=new Zl).text=" ",s.line=n.line,s.characterFormat.copyFormat(n.characterFormat),n.revisions.length>0)for(var h=0;h<n.revisions.length;h++){var c=n.revisions[h];s.revisions.push(c);var p=c.range.indexOf(n);p<0?c.range.push(s):c.range.splice(p,0,s)}n.line.children.splice(d,0,s),n.line.children.splice(d+1,0,n),n=s}}else n=this.nextElementToLayout;this.nextElementToLayout=void 0}}}return e},t.prototype.layoutElement=function(e,t,i){if(!((e.isColumnBreak||e.isPageBreak)&&t.isInHeaderFooter||e instanceof hd&&e.isHorizontalRule)){var n=e.line,r="",o=e.indexInOwner;if(this.viewer.owner.editorModule&&this.viewer.owner.editorHistoryModule&&this.viewer.owner.editorHistoryModule.isRedoing&&!(0,a.isNullOrUndefined)(e.paragraph.containerWidget.footNoteReference)&&this.viewer.owner.enableTrackChanges&&e.removedIds.length>0&&this.viewer.owner.editorModule.constructRevisionFromID(e,!0),e instanceof _l){if(0===e.fieldType&&(-1===this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.push(e),(0,a.isNullOrUndefined)(e.formFieldData)||-1!==this.documentHelper.formFields.indexOf(e)||this.isInsertFormField||this.documentHelper.formFields.push(e)),this.layoutFieldCharacters(e),e.line.isLastLine()&&(0,a.isNullOrUndefined)(e.nextNode)&&!this.isFieldCode)!(0,a.isNullOrUndefined)(t.containerWidget)&&t.floatingElements.length>0&&!(t.containerWidget instanceof cd)&&this.isConsiderAsEmptyLineWidget(e.line)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(n);else if((0,a.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine())this.moveElementFromNextLine(n),e.line.isLastLine()&&(0,a.isNullOrUndefined)(e.nextNode)&&!this.isFieldCode&&(2!==e.fieldType&&(0,a.isNullOrUndefined)(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(n));else if((0,a.isNullOrUndefined)(e.nextElement)&&0===this.viewer.clientActiveArea.width)this.moveToNextLine(n),n.paragraph.lastChild===n&&!(0,a.isNullOrUndefined)(n.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(n);else if(i){var s=this.documentHelper.textHelper.getHeight(t.characterFormat);e.height=s.Height}}else{if(e instanceof md||this.isFieldCode||e instanceof td||e instanceof fd||e instanceof vd||e instanceof id||e instanceof dd&&"Inline"!==e.textWrappingStyle){if(!this.isInitialLoad&&e instanceof id&&0===e.type&&"Block"===e.contentControlWidgetType&&!(0,a.isNullOrUndefined)(e.paragraph)&&e.paragraph.firstChild.children[0]===e&&!(0,a.isNullOrUndefined)(e.reference)&&!(0,a.isNullOrUndefined)(e.reference.paragraph)&&e.reference.paragraph.lastChild.children[e.reference.paragraph.lastChild.children.length-1]!==e.reference){e.contentControlWidgetType="Inline",e.reference.contentControlWidgetType="Inline",e.contentControlProperties.contentControlWidgetType="Inline";var l=e.paragraph;for(l===e.reference.paragraph&&e.reference.paragraph.contentControlProperties&&(e.reference.paragraph.contentControlProperties=void 0);l instanceof Rl&&l&&l.contentControlProperties&&l!==e.reference.paragraph;)l.contentControlProperties=void 0,l=l.nextRenderedWidget}if(e instanceof td)if(0!==e.bookmarkType||this.documentHelper.bookmarks.containsKey(e.name)){if(1===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)){var d=this.documentHelper.bookmarks.get(e.name);if(((0,a.isNullOrUndefined)(d.reference)||(0,a.isNullOrUndefined)(d.reference.paragraph)||(0,a.isNullOrUndefined)(d.reference.paragraph.bodyWidget))&&(d.reference=e,e.reference=d),(0,a.isNullOrUndefined)(d.properties)){if(!(0,a.isNullOrUndefined)(this.documentHelper.selection)){f=d.reference.paragraph.associatedCell;(0,a.isNullOrUndefined)(f)||(f.isRenderBookmarkEnd=!1,this.documentHelper.selection.isRenderBookmarkAtEnd(d.reference)&&(f.isRenderBookmarkEnd=!0))}}else if(!(0,a.isNullOrUndefined)(e.paragraph.associatedCell)){var h=this.documentHelper.selection.getLastParagraph(e.paragraph.associatedCell).lastChild;if(!(0,a.isNullOrUndefined)(h))if(h.children[h.children.length-1]==e){for(var c=parseInt(e.reference.properties.columnLast),p=e.paragraph.associatedCell.ownerRow,u=void 0,g=c;(0,a.isNullOrUndefined)(u)&&g>-1;)u=p.getCellUsingColumnIndex(p.rowIndex,g),(0,a.isNullOrUndefined)(u)&&g--;(0,a.isNullOrUndefined)(u)||(p.isRenderBookmarkEnd=!0)}}}else if(0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&((0,a.isNullOrUndefined)(e.reference)&&this.documentHelper.bookmarks.remove(e.name),!(0,a.isNullOrUndefined)(e.properties))){m=parseInt(e.properties.columnFirst);if(e.paragraph.isInsideTable){f=(b=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(b.rowIndex,m);(0,a.isNullOrUndefined)(f)||(f.isRenderBookmarkStart=!0)}}}else if(this.documentHelper.bookmarks.add(e.name,e),!(0,a.isNullOrUndefined)(e.properties)){var m=parseInt(e.properties.columnFirst);if(e.paragraph.isInsideTable){var f=(b=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(b.rowIndex,m);(0,a.isNullOrUndefined)(f)||(f.isRenderBookmarkStart=!0)}}if(e instanceof vd||e instanceof fd){if(e instanceof vd){var v=""!==e.user?e.user:e.group;if(this.documentHelper.editRanges.containsKey(v)){var y=this.documentHelper.editRanges.get(v);-1===y.indexOf(e)&&y.push(e)}else{var w=[];w.push(e),this.documentHelper.editRanges.add(v,w)}}if(e instanceof vd&&(this.documentHelper.owner.currentUser===e.user||"Everyone"===e.group&&""===e.user)){if(-1!=e.columnFirst&&-1!=e.columnLast){f=(b=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(b.rowIndex,e.columnFirst);(0,a.isNullOrUndefined)(f)||(f.isRenderEditRangeStart=!0,b.editRangeID.add(e.editRangeId,e))}}else if(e instanceof fd&&(this.documentHelper.owner.currentUser===e.editRangeStart.user||"Everyone"===e.editRangeStart.group&&""===e.editRangeStart.user)){var b;if(-1!=e.editRangeStart.columnFirst&&-1!=e.editRangeStart.columnLast)if((b=e.paragraph.associatedCell.ownerRow).editRangeID.containsKey(e.editRangeStart.editRangeId)){f=b.getCellUsingColumnIndex(b.rowIndex,e.editRangeStart.columnFirst);(0,a.isNullOrUndefined)(f)||f.isRenderEditRangeStart&&(f.isRenderEditRangeEnd=!0)}else for(var C=e.paragraph.associatedCell.ownerTable,x=b.rowIndex-1;x>=0;x--){var I=C.childWidgets[x];if(I.editRangeID.containsKey(e.editRangeStart.editRangeId)){var k=I.getCellUsingColumnIndex(I.rowIndex,e.editRangeStart.columnFirst);if(!(0,a.isNullOrUndefined)(k)&&k.isRenderEditRangeStart){k.isRenderEditRangeEnd=!0;break}}}}}if(e instanceof dd&&"Inline"!==e.textWrappingStyle&&-1==t.floatingElements.indexOf(e)&&e instanceof hd&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),-1===t.bodyWidget.floatingElements.indexOf(e)&&t.bodyWidget.floatingElements.push(e)),e instanceof id&&-1===this.documentHelper.contentControlCollection.indexOf(e)){if(0===e.type)this.isInitialLoad?this.documentHelper.contentControlCollection.push(e):this.documentHelper.owner.editorModule.insertContentControlInCollection(e);else if(1===e.type){var F=e.paragraph.bodyWidget.page;for(x=0;x<this.documentHelper.contentControlCollection.length;x++){var P=this.documentHelper.contentControlCollection[x],S=P.line.paragraph.isInHeaderFooter;S&&e.contentControlProperties===P.contentControlProperties&&F===P.line.paragraph.bodyWidget.page?(e.reference=P,P.reference=e):S||e.contentControlProperties!==P.contentControlProperties||(e.reference=P,P.reference=e)}}e instanceof id&&t.bodyWidget.floatingElements.length>0&&this.adjustPosition(e,e.line.paragraph.bodyWidget)}return(0,a.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(n),void(e.line.isLastLine()&&(0,a.isNullOrUndefined)(e.nextElement)&&(this.hasValidElement(n.paragraph)&&!t.isContainsShapeAlone()?this.moveToNextLine(n):this.isInitialLoad||this.hasValidElement(n.paragraph)||!n.paragraph.paragraphFormat.bidi||-1===n.paragraph.paragraphFormat.listFormat.listId?this.layoutEmptyLineWidget(n.paragraph,!1,n,!1):this.moveToNextLine(n)))}if(e instanceof Zl&&"NoColor"!=e.characterFormat.highlightColor&&""!=e.text.trim()&&e.text!=e.text.trim()){var T=t.firstChild;h=t.lastChild;!(0,a.isNullOrUndefined)(T)&&T instanceof zl&&T.children.length>0&&e===T.children[0]&&Pa.splitSpaceInTextElementBox(e,!0),!(0,a.isNullOrUndefined)(h)&&h instanceof zl&&h.children.length>0&&e===h.children[h.children.length-1]&&Pa.splitSpaceInTextElementBox(e,!1)}var H=e.width;e instanceof $l&&!this.isTocField(e.fieldBegin)?""!==(r=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page))?e.text=r:r=e.text:e instanceof Yl?""!==(r=this.startAt(e,r))&&(e.text=r):e instanceof Zl&&(!(0,a.isNullOrUndefined)(e.paragraph.containerWidget.footNoteReference)&&e.line.isFirstLine()&&0===e.paragraph.index&&0===e.indexInOwner&&!this.documentHelper.owner.editorModule.handledEnter&&e instanceof _d&&(e.text=e.paragraph.containerWidget.footNoteReference.text),this.checkAndSplitTabOrLineBreakCharacter(e.text,e),r=e.text),e instanceof Zl&&(!e.isWidthUpdated||0===e.width||this.isInitialLoad||this.viewer.owner.editorModule&&this.viewer.owner.editorModule.isMeasureParaWidth?(H=this.documentHelper.textHelper.getTextSize(e,e.characterFormat),e.isWidthUpdated=!0):H=e.trimEndWidth,"\t"===e.text?(H=this.getTabWidth(t,this.viewer,o,n,e),e.width=H):e.text!==String.fromCharCode(31)&&e.text!==String.fromCharCode(14)||(e.width=H=0)),(0,a.isNullOrUndefined)(t.containerWidget)||!(t.bodyWidget.floatingElements.length>0)||e instanceof hd&&"Inline"==e.textWrappingStyle||t.containerWidget instanceof cd||e instanceof Bd||t.containerWidget instanceof Vl&&t.containerWidget.ownerTable.containerWidget instanceof cd||(this.adjustPosition(e,e.line.paragraph.bodyWidget),t.textWrapWidth&&(t.x-=e.padding.left,t.textWrapWidth=!1));var E,N=n.isFirstLine()&&0===e.indexInOwner?this.getBeforeSpacing(t):0;if(this.viewer instanceof kl&&(e instanceof hd&&"Inline"===e.textWrappingStyle||!(e instanceof hd))&&this.viewer.clientActiveArea.height<N+e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!(e instanceof Zl&&("\f"!==e.text&&e.text!==String.fromCharCode(14)||"\f"===e.text&&t.isPageBreak()&&"Word2013"===this.documentHelper.compatibilityMode))&&e instanceof Zl||this.moveToNextPage(this.viewer,n),e instanceof $l&&this.updateFieldText(e),!e.previousElement||!(e.previousElement instanceof hd&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof hd||this.cutClientWidth(e.previousElement,void 0,e instanceof Zl&&"\f"===e.text)),e instanceof hd&&"Inline"===e.textWrappingStyle){-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),e.width>this.viewer.clientActiveArea.width&&(this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(n,e));var W=this.is2013Justification;this.layoutShape(e),this.is2013Justification=W}if(e instanceof Yl&&(!e.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType&&this.layoutFootEndNoteElement(e),e instanceof Yl&&(this.isfootMove&&(this.moveToNextPage(this.viewer,e.line),!e.previousElement||!(e.previousElement instanceof hd&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof hd||this.cutClientWidth(e.previousElement),this.isfootMove=!1),t.paragraphFormat.keepWithNext&&t.paragraphFormat.keepLinesTogether&&e.isLayout&&!this.isLayoutWhole&&!(0,a.isNullOrUndefined)(t.bodyWidget.page.footnoteWidget)&&0!==t.bodyWidget.page.footnoteWidget.y&&t.bodyWidget.page.footnoteWidget.y<this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height)){var O=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-t.bodyWidget.page.footnoteWidget.y;this.viewer.clientActiveArea.height-=O}if(parseFloat(H.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap){if(this.addElementToLine(t,e),(0,a.isNullOrUndefined)(e.nextElement)&&!e.line.isLastLine()){var B=e.line.nextLine.children[0];B instanceof Zl&&0==B.text.indexOf(" ")&&this.moveElementFromNextLine(n)}(0,a.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(n):!e.line.isLastLine()&&(0,a.isNullOrUndefined)(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(n),n.paragraph.lastChild===n&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(n))}else if(e instanceof Zl){if("\t"===e.text){var L=e.line,D=!1;if(0!==e.indexInOwner&&e instanceof ed?(D=!0,this.addSplittedLineWidget(L,L.children.indexOf(e)-1)):(this.isWrapText&&this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width===this.viewer.clientActiveArea.right&&(this.isWrapText=!1),this.addSplittedLineWidget(L,L.children.indexOf(e))),this.moveToNextLine(L),L.paragraph.bodyWidget.floatingElements.length>0&&D)return this.nextElementToLayout=e,void(this.hasFloatingElement=!0);e.width=this.getTabWidth(t,this.viewer,o,e.line,e),D&&(this.addElementToLine(t,e),(0,a.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(e.line))}else do{if(n=e.line,e.previousElement instanceof _l&&2==e.previousElement.fieldType&&!(0,a.isNullOrUndefined)(e.previousElement.fieldBeginInternal)&&e.previousElement.fieldBeginInternal.formFieldData instanceof Xl||this.splitTextForClientArea(n,e,e.text,e.trimEndWidth,e.characterFormat),this.checkLineWidgetWithClientArea(n,e),e instanceof $l&&!this.isInitialLoad&&this.updateFieldText(e),e.line!==n&&!(0,a.isNullOrUndefined)(this.nextElementToLayout)&&this.is2013Justification)return}while(e.line!==n&&this.cutClientWidth(e))}else do{n=e.line,this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(n,e),e instanceof $l&&this.updateFieldText(e)}while(e.line!==n&&this.cutClientWidth(e,!0));if(!(0,a.isNullOrUndefined)(e.nextNode)&&e.nextNode instanceof id&&(E=e.nextNode),("\v"===r||"\f"===r||"\r"===r||r===String.fromCharCode(14))&&!E){var R=n.children.indexOf(e);R>-1&&this.addSplittedLineWidget(n,R)}if(e.line.isLastLine()&&(0,a.isNullOrUndefined)(e.nextElement)||"\v"===r||"\f"===r||"\r"===r||r===String.fromCharCode(14)){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);if(this.moveToNextLine(e.line),"\v"===r&&(0,a.isNullOrUndefined)(e.nextNode))this.layoutEmptyLineWidget(t,!0,n,!0);else if(("\f"===r||r===String.fromCharCode(14))&&this.viewer instanceof kl&&!(e.line.paragraph.containerWidget instanceof Vl)){var M=this.isRTLLayout;if(this.isRTLLayout=!1,(0,a.isNullOrUndefined)(e.nextNode)||e.nextNode instanceof id)if(r===String.fromCharCode(14))this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.layoutEmptyLineWidget(e.line.nextLine.paragraph,!1,e.line.nextLine,!0);else{var A=t.nextWidget;"\f"===r&&A instanceof Rl&&A.isSectionBreak||this.moveToNextPage(this.viewer,e.line,!0)}else(0,a.isNullOrUndefined)(e.line.nextLine)||this.moveToNextPage(this.viewer,e.line.nextLine,!1);this.isRTLLayout=M}}this.isXPositionUpdated=!1}}},t.prototype.adjustPosition=function(e,t){var i=this.viewer.clientActiveArea,n=this.viewer.clientActiveArea.x,r=this.viewer.clientActiveArea.y,o=this.viewer.clientActiveArea.width,s=this.adjustClientAreaBasedOnTextWrap(e,new Tl(i.x,i.y,i.width,i.height));this.viewer.clientActiveArea.width=s.width;var l=this.viewer.clientActiveArea.x-n;if(e.line.isFirstLine()&&this.getFirstElement(e.line)===e&&l>0&&!this.isSkipFirstLineIndent){var d=e.line.paragraph.paragraphFormat.firstLineIndent;l+=Pa.convertPointToPixel(d>0?d:0)}if(this.isSkipFirstLineIndent=!1,e.padding.left=l>0?l:0,o!==this.viewer.clientActiveArea.width){var h=new Ha(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width);this.updateWrapPosition(h)}if(0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1),this.isYPositionUpdated){if(e.line.isFirstLine()){if(!(0,a.isNullOrUndefined)(e.line.paragraph.associatedCell)){var c=e.line.paragraph.previousRenderedWidget;(0,a.isNullOrUndefined)(c)?e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-r:e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-c.y+c.height}e.line.paragraph.y=this.viewer.clientActiveArea.y}else e.line.children[0]===e&&(e.line.marginTop+=this.viewer.clientActiveArea.y-r);e.line.paragraph.containerWidget instanceof Bl&&(e.line.paragraph.containerWidget.height+=this.viewer.clientActiveArea.y-r),e instanceof md||(this.isYPositionUpdated=!1)}},t.prototype.getFirstElement=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(!(i instanceof dd&&"Inline"!==i.textWrappingStyle))return i}},t.prototype.updateWrapPosition=function(e){for(var t=0;t<this.wrapPosition.length;t++){var i=this.wrapPosition[t];if(!(Math.abs(i.right-e.right)>1))return}this.wrapPosition.push(e)},t.prototype.isFirstitemInPage=function(e,t){return!e.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},t.prototype.isTextFitBelow=function(e,t,i){return!1},t.prototype.isNeedToWrapForTopAndBottom=function(e,t,i,n,r,o,s,l,d,h,c,p,u){if(e.isInsideTable&&"TopAndBottom"===r&&!(d instanceof Al)){var g=d.paragraph;if(!(0,a.isNullOrUndefined)(g)&&!(0,a.isNullOrUndefined)(g.associatedCell)){var m=g.isInsideTable,f=g.associatedCell,v=e.associatedCell;if(!(0,a.isNullOrUndefined)(f)&&!(0,a.isNullOrUndefined)(v)&&f!==v||!m&&"Word2013"!==this.documentHelper.compatibilityMode)return!1}}return i!==l&&n!==l&&"TopAndBottom"===r&&(c.y>=o.y&&c.y<o.bottom||(c.y+u>o.y||this.isTextFitBelow(o,c.y+u,d))&&c.y+u<o.bottom||c.y<o.y&&c.y+u>o.bottom&&o.height>0)&&!(s&&(h||t instanceof gd&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},t.prototype.isNeedToWrapForSquareTightAndThrough=function(e,t,i,n,r,o,s,a,l,d,h,c,p){return e.floatingElements.length>0&&i!==a&&n!==a&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(h.y+p)>Math.round(o.y)||this.isTextFitBelow(o,h.y+p,l))&&Math.round(h.y)<Math.round(o.y+o.height)&&!(s&&(d||t instanceof gd&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},t.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(e,t,i,n,r,o,s,a,l,d,h,c,p){return e.floatingElements.length>0&&i!==a&&n!==a&&"Inline"!==r&&"Behind"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&(Math.round(h.y+p)>=Math.round(o.y)&&Math.round(h.y)<Math.round(o.bottom)||Math.round(h.y+p)<=Math.round(o.bottom)&&Math.round(h.y+p)>=Math.round(o.y))&&!(s&&d)},t.prototype.isNeedToWrapLeafWidget=function(e,t){return e.bodyWidget.floatingElements.length>0&&!(t instanceof dd&&("InFrontOfText"===t.textWrappingStyle||"Behind"===t.textWrappingStyle))},t.prototype.getMinWidth=function(e,t,i,n){var r=e.text,o=r.split(" ");""!==r&&""===r.trim()&&e&&e.line.paragraph&&e.previousNode&&e.nextNode&&e.line.paragraph.isEmpty&&(o=[""]);var s=this.documentHelper.textHelper.measureText(o[0],e.characterFormat,e.scriptType).Width,a=this.getNextSibling(e);if(1===o.length&&a){var l=a.text;s+=this.getNextTextRangeWidth(a,l,t,i,n)}return s},t.prototype.getNextTextRangeWidth=function(e,t,i,n,r){for(var o=e,s=new Tl(0,0,0,0),a=this.isNextSibligSizeNeedToBeMeasure(s,e,r,i,n);a&&this.isLeafWidgetNextSiblingIsTextRange(o)&&i+s.width<r.width&&(o=this.getNextSibling(o),this.isNextSibligSizeNeedToBeMeasure(s,o,r,i,n));)o.text;return s.width},t.prototype.isLeafWidgetNextSiblingIsTextRange=function(e){var t=this.getNextSibling(e);return!!(t&&t instanceof Zl)},t.prototype.isNextSibligSizeNeedToBeMeasure=function(e,t,i,n,r){var o=null,s=t;if(s){if(-1!==(o=s.text).indexOf(" ")||-1!==o.indexOf("-")||-1!==o.indexOf("_")&&n+e.width+this.documentHelper.textHelper.measureText(o.split("-")[0],s.characterFormat,s.scriptType).Width<i.width||"\t"===s.text){var a=s.width;return o!==o.split(" ")[0]&&(a=this.documentHelper.textHelper.measureText(o.split(" ")[0],s.characterFormat,s.scriptType).Width),n+e.width+a>i.width&&o.indexOf("-")&&o!==o.split("-")[0]+"-"&&(a=this.documentHelper.textHelper.measureText(o.split("-")[0]+"-",s.characterFormat,s.scriptType).Width),e.width+=a,!1}if(s.text.length>0){var l=this.documentHelper.textHelper.measureText(s.text,s.characterFormat,s.scriptType);e.height+=l.Height,e.width+=l.Width}}return!0},t.prototype.isNeedDoIntermediateWrapping=function(e,t,i,n,r,o,s,a,l){return e>l&&((Math.round(i.width)<=Math.round(a)||i.width<n&&s.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||i.width<e&&"Largest"===t)||(Math.round(o.x-r.x+r.leftIndent)<l||s instanceof Zl&&this.isFloatingItemOnLeft(i,a,o))&&("Left"!==t||e<l)},t.prototype.isFloatingItemOnLeft=function(e,t,i){return!1},t.prototype.getNextSibling=function(e){for(var t=e.nextNode,i=!1;t;){if(t instanceof _l||t instanceof td||i||t instanceof md)t instanceof _l&&(0===t.fieldType?i=!0:2===t.fieldType&&(i=!1));else if(t instanceof Zl)break;t=t.nextNode}return t},t.prototype.adjustClientAreaBasedOnTextWrap=function(e,t){var i=e.line.paragraph,n=i.bodyWidget,r=this.viewer,o=t.y,s=this.isFirstitemInPage(e,o);if(s&&o,s=(0,a.isNullOrUndefined)(i.previousWidget),this.isNeedToWrapLeafWidget(i,e)){var l=r.clientArea;n.floatingElements.sort((function(e,t){return e.y-t.y})),n.floatingElements.sort((function(e,t){return e.x-t.x}));for(var d=0;d<n.floatingElements.length;d++){var h=n.floatingElements[d],c=!1;if(c=h instanceof dd?h.allowOverlap:h.positioning.allowOverlap,(!(i.isInsideTable&&h instanceof Al)||h.isInsideTable)&&!(this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(h instanceof Al?h:h.line.paragraph,e.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(h instanceof Al?h:h.line.paragraph,this.endOverlapWidget))){h.x;var p=0,u=0,g=0,m=0,f=0;h instanceof dd?(p=h.distanceLeft,u=h.distanceTop,g=h.distanceRight,m=h.distanceBottom,f=h.width):(f=h.getTableCellWidth(),p=h.positioning.distanceLeft,u=h.positioning.distanceTop,g=h.positioning.distanceRight,m=h.positioning.distanceBottom);var v=new Tl(h.x-p,h.y-u,f+p+g,h.height+u+m),y=h instanceof Al?"Square":h.textWrappingStyle,w=h instanceof Al?"Both":h.textWrappingType,b=24;r.clientArea.y,h.height;if(!(l.x>v.right+b||l.right<v.x-b))if(this.isNeedToWrapForSquareTightAndThrough(n,e,-1,-1,y,v,c,1,h,!1,t,e.width,e.height)){var C=0,x=0,I=0,k=Pa.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent),F=Pa.convertPointToPixel(i.paragraphFormat.leftIndent),P=Pa.convertPointToPixel(i.paragraphFormat.rightIndent);k=0===e.indexInOwner&&e.line.isFirstLine()&&k>0?k:0;var S=e instanceof Zl||e instanceof md?e:null,T=h instanceof Al?h.containerWidget:h.line.paragraph.containerWidget,H=!1;if(e.line.paragraph){t.x>=v.x&&"Left"!==w&&(C=P),t.x<v.x&&"Right"!==w&&(x=F);var E=i.paragraphFormat.listFormat,N=this.getListLevel(E.list,E.listLevelNumber);t.x===l.x+F&&E&&E.baseStyle&&N&&0!==N.paragraphFormat.leftIndent&&(I=F,H=!0)}var W=0,O=!1,B=void 0,L=0,D=void 0;if(h instanceof Al&&(B=h,D=h.positioning.horizontalAlignment,W=this.getMaximumRightCellBorderWidth(h),O=this.getDefaultBorderSpacingValue(W,O,D),L=h.tableFormat.borders.left.lineWidth/2),t.x+L>=v.x&&t.x<v.right&&"Left"!==w){t.width=t.width-(v.right-t.x)-C,this.isWrapText=!0;if((0,a.isNullOrUndefined)(B)||(b=this.getMinimumWidthRequiredForTable(O,D,W)),Math.round(t.width)<b||t.width<e.width&&"\t"===e.text||v.x<i.x+F){t.width=this.viewer.clientArea.right-v.right-(H?I:0);var R=0;if(R=(0,a.isNullOrUndefined)(S)?e.width:this.getMinWidth(e,e.width,e.height,t),Math.round(t.width)<b||t.width<R){if(v.x-(i.x+i.leftIndent)>b&&this.viewer.clientArea.right-v.right>b)t.width=0;else{var M=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=v.bottom+M-t.y,t.y=v.bottom+M}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var A=t.x;if(t.x=v.right+(H?I:0)+k,t.width-=k,this.isSkipFirstLineIndent=!0,"Square"===y&&t.width<0&&e.width>0){M=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=v.bottom+M-t.y,t.y=v.bottom+M,t.x=A}this.viewer.updateClientAreaForTextWrap(t)}}else{A=t.x;if(t.x=v.right+(H?I:0)+k,t.width=this.viewer.clientArea.right-v.right-(H?I:0)-k,this.isSkipFirstLineIndent=!0,"Square"===y&&t.width<0&&e.width>0){M=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=v.bottom+M-t.y,t.y=v.bottom+M,t.x=A}this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(t)}}else if(v.x>=t.x&&t.right>v.x){t.width=v.x-t.x-C;var U=this.viewer.clientArea.right-v.right;U=U>0?U:0,this.isWrapText=!0;var V=!1;R=0;if(R=(0,a.isNullOrUndefined)(S)?e.width:this.getMinWidth(S,e.width,e.height,t),(0,a.isNullOrUndefined)(B)||(b=this.getMinimumWidthRequiredForTable(O,D,W)),this.isNeedDoIntermediateWrapping(U,w,t,e.width,e.paragraph,v,e,R,b)){if(t.width=U,this.isWrapText=!0,(t.x+R>v.x||"Right"===w||l.x>v.x-24)&&(t.x=v.right,t.width>R||"Right"===w?this.viewer.updateClientAreaForTextWrap(t):t.width<R&&e.line.children[0]!==e&&"Both"===w&&h instanceof dd&&(this.viewer.updateClientAreaForTextWrap(t),V=!0)),t.width<b&&!(R<U&&"Tight"===y)||t.width<R&&Math.round(t.right)===Math.round(this.viewer.clientArea.right)&&"Both"===w){var z=v;if(Math.round(t.x)===Math.round(n.sectionFormat.leftMargin+i.paragraphFormat.leftIndent)){M=0;t.y=z.bottom+M,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height=t.height-(z.height+M),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else if(!V&&Math.round(t.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===w){M=0;t.y=z.bottom+M,t.width=this.viewer.clientArea.width,t.height=t.height-(z.height+M),t.x=this.viewer.clientArea.x+x,this.viewer.updateClientAreaForTextWrap(t),this.isYPositionUpdated=!0,this.isWrapText=!1}else t.width=0,this.viewer.updateClientAreaForTextWrap(t)}}else(e.line.isFirstLine()&&0===e.indexInOwner||0===U&&e.line.children[0]===e)&&"Square"===y&&Math.round(t.width)<=Math.round(R)&&i.containerWidget===T?(t.x=l.x,t.y=v.bottom,t.width=l.width,t.height-=v.bottom-t.y,this.isYPositionUpdated=!0):Math.round(t.width)<=Math.round(R)&&Math.round(t.x-x)!==Math.round(this.viewer.clientArea.x)&&(t.width=0),this.viewer.updateClientAreaForTextWrap(t)}"Both"!==w&&(this.isWrapText=!1)}else if(this.isNeedToWrapForTopAndBottom(i,e,-1,-1,y,v,c,1,h,!1,t,e.width,e.height)){M=0;var q=t.y;t.y=v.bottom+M,this.isYPositionUpdated=!0,t.height=t.height-(v.bottom-q+M),t.y!==o&&e instanceof Zl&&!(h instanceof Al)&&e.line.isFirstLine()&&(t.y+=e.margin.top,o=t.y),this.viewer.updateClientAreaForTextWrap(t)}}}}return t},t.prototype.adjustClientAreaBasedOnTextWrapForTable=function(e,t){if((0,a.isNullOrUndefined)(e.containerWidget)||(0,a.isNullOrUndefined)(e.bodyWidget))return t;var i=e.bodyWidget,n=this.viewer,r=t.y;if((0,a.isNullOrUndefined)(e.previousWidget)&&r,i.floatingElements.length>0){var o=n.clientActiveArea;i.floatingElements.sort((function(e,t){return e.y-t.y})),i.floatingElements.sort((function(e,t){return e.x-t.x}));for(var s=0;s<i.floatingElements.length;s++){var l=i.floatingElements[s],d=!1;if(d=l instanceof dd?l.allowOverlap:l.positioning.allowOverlap,(!(e.isInsideTable&&l instanceof Al)||l.isInsideTable)&&!(l instanceof Al&&l.wrapTextAround&&l.positioning.allowOverlap&&e.wrapTextAround&&e.positioning.allowOverlap)){var h=e.getTableCellWidth(),c=l instanceof dd,p=c?l.distanceLeft:l.positioning.distanceLeft,u=c?l.distanceTop:l.positioning.distanceTop,g=c?l.distanceRight:l.positioning.distanceRight,m=c?l.distanceBottom:l.positioning.distanceBottom,f=c?l.width:l.getTableCellWidth(),v=new Tl(l.x-p,l.y-u,f+p+g,l.height+u+m),y=l instanceof Al?"Square":l.textWrappingStyle,w=l instanceof Al?"Both":l.textWrappingType,b=24,C=e.childWidgets.length>0?e.childWidgets[0].rowFormat.height:0,x=this.getNestedTable(e).firstChild.firstChild.firstChild.characterFormat,I=this.documentHelper.textHelper.measureText(" ",x);if(C<I.Height&&(C=I.Height),!(o.x>v.right+b||o.right<v.x-b)&&this.isNeedToWrapForSquareTightAndThroughForTable(i,e,-1,-1,y,v,d,1,l,!1,t,h,C)&&!(this.isRelayout&&l instanceof Al&&"Paragraph"===l.positioning.verticalOrigin&&e.index<l.index)&&t.x>=v.x&&t.x<v.right&&"Left"!==w){t.width=t.width-(v.right-t.x),this.isWrapText=!0;if(Math.round(t.width)<b||t.width<h||v.x<e.x){t.width=this.viewer.clientArea.right-v.right;var k=h;if(Math.round(t.width)<b||t.width<k){if(v.x-e.x>b&&this.viewer.clientArea.right-v.right>b)t.width=0;else{var F=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=v.bottom+F-t.y,t.y=v.bottom+F}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var P=t.x;if(t.x=v.right,"Square"===y&&t.width<0&&h>0){this.isYPositionUpdated=!0,t.height-=v.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=v.bottom+0,t.x=P}this.viewer.updateClientAreaForTextWrap(t)}}else{P=t.x;if(t.x=v.right+e.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-v.right,"Square"===y&&t.width<0&&h>0){F=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=v.bottom+F-t.y,t.y=v.bottom+F,t.x=P}this.viewer.updateClientAreaForTextWrap(t)}}}}}return t},t.prototype.getNestedTable=function(e){for(var t=e;t.firstChild.firstChild.firstChild instanceof Al;)t=t.firstChild.firstChild.firstChild;return t},t.prototype.startAt=function(e,t){return"Footnote"===e.footnoteType?(this.startat=e.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(e)+this.startat)):(this.startat=e.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(e)+this.startat)),t},t.prototype.layoutFootEndNoteElement=function(e){var t;this.isFootnoteContentChanged=!0;var i,n=!1,r=this.documentHelper.footnoteCollection.indexOf(e),o=1;this.islayoutFootnote=!0;var s=new Tl(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),l=new Tl(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),d=e.paragraph.bodyWidget,h=!1,c=0;if(d.page.footnoteWidget)for(var p=0;p<d.page.footnoteWidget.bodyWidgets.length;p++){o=d.page.footnoteWidget.bodyWidgets.length;var u=this.documentHelper.footnoteCollection.indexOf(d.page.footnoteWidget.bodyWidgets[p].footNoteReference);if(u>r&&u-r==1){o=p,n=!0;break}}if(e.isLayout=!0,"Footnote"===e.footnoteType){if(d.page.footnoteWidget&&d.page.footnoteWidget instanceof Dl)t=d.page.footnoteWidget;else{h=!0,(t=new Dl).footNoteType="Footnote",t.page=d.page;var g=new Rl;g.characterFormat=new ka,g.paragraphFormat=new ba,g.index=0;var m=new zl(g);g.childWidgets.push(m),c=this.documentHelper.textHelper.getParagraphMarkSize(g.characterFormat).Height,t.margin=new El(0,c,0,0)}this.isFootNoteLayoutStart=!0,h&&(d.page.footnoteWidget=t);var f=e.bodyWidget;this.viewer.updateClientArea(t,t.page),this.viewer.clientArea.y=s.y,this.viewer.clientActiveArea.y=l.y;for(var v=0;v<e.bodyWidget.childWidgets.length;v++){var y=e.bodyWidget.childWidgets[v];y.containerWidget=f,f.page=d.page,f.sectionFormat=t.sectionFormat,y.containerWidget.containerWidget=t,this.viewer.updateClientAreaForBlock(y,!0),y instanceof Al&&this.clearTableWidget(y,!0,!0),this.layoutBlock(y,0),c+=y.height,y.y=0,this.viewer.updateClientAreaForBlock(y,!1),f.height+=y.height}if(t.sectionFormat.columns.length>1&&!(0===t.bodyWidgets.length&&f.childWidgets.length<=1&&f.childWidgets[0].childWidgets.length<=1)&&(c/=t.sectionFormat.numberOfColumns),this.isFootNoteLayoutStart=!1,i=!1,c>=l.height&&(this.isfootMove=!0),n?t.bodyWidgets.splice(o,0,f):t.bodyWidgets.push(f),e.line.paragraph.isInsideTable){var w=this.getParentTable(e.line.paragraph.associatedCell.ownerTable);if((0,a.isNullOrUndefined)(w.footnoteElement)&&(w.footnoteElement=[]),-1==w.footnoteElement.indexOf(e)){w.footnoteElement.push(e),this.layoutedFootnoteElement.push(e);var b=e.line.paragraph.containerWidget.ownerTable;-1==b.footnoteElement.indexOf(e)&&b.footnoteElement.push(e)}}t.height+=c,i=!0,this.viewer.clientActiveArea=l,this.viewer.clientActiveArea.height-=c,this.footnoteHeight+=c,this.viewer.clientArea=s}return i},t.prototype.layoutEndNoteElement=function(){var e=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var t=void 0,i=void 0,n=void 0,r=this.documentHelper.pages[e-1],o=r.bodyWidgets[0],s=r.bodyWidgets[r.bodyWidgets.length-1];if(this.viewer instanceof kl&&s.sectionFormat.numberOfColumns>1){var a=this.getBodyWidget(s,!0);this.splitBodyWidgetBasedOnColumn(a)}for(var l=0;l<this.documentHelper.endnoteCollection.length;l++){t=this.documentHelper.endnoteCollection[l],o.page.endnoteWidget instanceof Dl&&"Endnote"===o.page.endnoteWidget.footNoteType?i=o.page.endnoteWidget:(n=!0,(i=new Dl).footNoteType="Endnote",i.page=o.page);var d=t.bodyWidget;d.page=i.page;for(var h=0;h<t.bodyWidget.childWidgets.length;h++){var c=t.bodyWidget.childWidgets[h];c.containerWidget=d,c.containerWidget.containerWidget=i}-1===i.bodyWidgets.indexOf(d)&&(d.index=i.bodyWidgets.length,i.bodyWidgets.push(d),d.sectionFormat=i.page.bodyWidgets[i.page.bodyWidgets.length-1].sectionFormat),n&&(o.page.endnoteWidget=i)}this.layoutfootNote(i)}},t.prototype.hasValidElement=function(e){var t=e.firstChild;if(t)for(var i=t.children[0];i;){if(i instanceof _l&&(i=this.documentHelper.getNextValidElementForField(i),!(0,a.isNullOrUndefined)(i)&&!i.line.paragraph.equals(e)))return!1;if(i instanceof Zl||i instanceof gd)return!0;(0,a.isNullOrUndefined)(i)||(i=i.nextNode)}return!1},t.prototype.isConsiderAsEmptyLineWidget=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(!(i instanceof dd&&"Inline"!==i.textWrappingStyle)&&i.width>0)return!1}return!0},t.prototype.updateFieldText=function(e){var t=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.documentHelper.textHelper.getTextSize(e,e.characterFormat))},t.prototype.checkLineWidgetWithClientArea=function(e,t){if(e!==t.line||t.line===e&&(0,a.isNullOrUndefined)(t.nextElement)&&!t.line.isLastLine()){if(this.moveToNextLine(e),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable){var i=void 0;t.line.paragraph.previousRenderedWidget instanceof Al&&t.line.paragraph.previousRenderedWidget.wrapTextAround&&(i=t.line.paragraph.previousRenderedWidget,this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-Pa.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.viewer.clientActiveArea.x+=e.paragraph.leftIndent,this.isOverlapFloatTable=!1}e!==t.line&&(this.isRTLLayout=!1)}t.line!==e&&this.viewer instanceof kl&&this.viewer.clientActiveArea.height<t.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,t.line):t.line===e&&(0,a.isNullOrUndefined)(t.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(e)},t.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var i=Pa.indexOfAny(e,["\t","\v","\f"]);if(i>-1){var n=e[i];("\t"===n&&"\t"!==e||"\v"===n&&"\v"!==e||"\f"===n&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,i,n)}},t.prototype.moveFromNextPage=function(e){var t=e.nextLine;if(t&&-1===e.paragraph.childWidgets.indexOf(t)){var i=t.paragraph;t.paragraph.childWidgets.splice(t.indexInOwner,1),e.paragraph.childWidgets.push(t),t.paragraph=e.paragraph,0===i.childWidgets.length&&i.destroy()}},t.prototype.cutClientWidth=function(e,t,i){if(this.is2013Justification)return!1;this.clearLineMeasures();var n=e.line;n.marginTop=0;for(var r=0,o=0;o<n.children.length;o++){var s=n.children[o];if(t&&s instanceof hd&&"Inline"===s.textWrappingStyle&&this.layoutShape(s),!this.isRelayoutOverlap&&s instanceof ed&&"\t"===s.text&&(s.width=this.getTabWidth(n.paragraph,this.viewer,0,n,s)),r+=s.width,e===s)break}var l=this.viewer.clientActiveArea.width-r<0,d=e.line.paragraph.bodyWidget;return d&&d.floatingElements.length>0?(this.hasFloatingElement=!0,i||(this.isXPositionUpdated=!0),!1):(l?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof Zl&&this.splitTextElementWordByWord(e),(0,a.isNullOrUndefined)(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(n)),l)},t.prototype.layoutFieldCharacters=function(e){if(0===e.fieldType){if(!(0,a.isNullOrUndefined)(e.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(e),!this.isFieldCode&&(!(0,a.isNullOrUndefined)(e.fieldEnd)||e.hasFieldEnd)){if(-1===this.documentHelper.fieldStacks.indexOf(e)&&this.documentHelper.fieldStacks.push(e),this.isRelayout){var t=Pa.trimEnd(this.documentHelper.selection.getFieldCode(e));this.isIFfield=Pa.startsWith(t,"IF")}this.isFieldCode=!0,e.hasFieldEnd=!0}}else if(this.documentHelper.fieldStacks.length>0){var i;if(2===e.fieldType)(i=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldSeparator!==e||(0,a.isNullOrUndefined)(i.fieldEnd)&&!i.hasFieldEnd||(this.isFieldCode=!1);else e===(i=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1,this.isIFfield=!1)}},t.prototype.checkAndUpdateFieldData=function(e){if(e.hasFieldEnd&&!(0,a.isNullOrUndefined)(e.fieldEnd)){if((0,a.isNullOrUndefined)(e.fieldSeparator)){var t=new _l(2);t.fieldBegin=e,t.fieldEnd=e.fieldEnd,t.line=e.line,e.line.children.splice(e.fieldEnd.indexInOwner,0,t),e.fieldSeparator=t,e.fieldEnd.fieldSeparator=t}var i=e.fieldEnd.previousNode;if(i instanceof _l&&2===i.fieldType){var n=e.formFieldData;if(n instanceof Kl){var r=new Zl;r.skipformFieldLength=!0,r.line=e.line;var o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,r),r.characterFormat.copyFormat(e.characterFormat),n.checked?r.text=String.fromCharCode(9745):r.text=String.fromCharCode(9744),this.setCheckBoxFontSize(n,r.characterFormat)}else if(n instanceof Xl){var s=new Zl;s.characterFormat.copyFormat(e.characterFormat),s.skipformFieldLength=!0,s.line=e.line,n.dropdownItems.length>0?s.text=n.dropdownItems[n.selectedIndex]:s.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5);o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,s)}}}},t.prototype.setCheckBoxFontSize=function(e,t){"Auto"!==e.sizeType?t.fontSize=e.size*qa:t.fontSize=t.fontSize*qa},t.prototype.layoutEmptyLineWidget=function(e,t,i,n){this.clearLineMeasures();var r=e.paragraphFormat,o=0,s=0;n=!(0,a.isNullOrUndefined)(n)&&n;var l,d=r.borders,h=this.documentHelper.canRenderBorder(e),c=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Height,p=0;if(e.childWidgets.length>0&&!n){if(this.isUpdateMarginForCurrentLine(i),(l=e.childWidgets[0]).children.length>0){(r.bidi||this.isContainsRtl(l))&&this.shiftElementsForRTLLayouting(l,r.bidi);var u=l.isFirstLine(),g=l.isLastLine(),m=0;if(u&&(p=this.getBeforeSpacing(e),m=Pa.convertPointToPixel(r.firstLineIndent)),"Left"!==(S=r.textAlignment)&&this.viewer.textWrap&&("Justify"!==S||!g||"Justify"===S&&r.bidi)){var f=this.getSubWidth(l,"Justify"===S,s,m,g);o=f[0].subWidth,s=f[0].spaceCount}}}else l=t?this.addLineWidget(e):i;if(l.isFirstLine()&&(p=this.getBeforeSpacing(e)),!((0,a.isNullOrUndefined)(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||e.containerWidget instanceof cd||e.containerWidget instanceof Vl&&e.containerWidget.ownerTable.containerWidget instanceof cd)){var v=new Zl;v.line=l,l.children.push(v),v.text="¶",v.characterFormat=e.characterFormat,v.width=this.documentHelper.textHelper.getTextSize(v,v.characterFormat),this.adjustPosition(v,e.bodyWidget),e.x+=v.padding.left,0!==v.padding.left&&(e.textWrapWidth=!0),t&&this.checkInbetweenShapeOverlap(l),l.children.splice(v.indexInOwner,1)}!(this.viewer instanceof kl&&this.viewer.clientActiveArea.height<p+c&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y)||l.isFirstLine()&&(0,a.isNullOrUndefined)(l.paragraph.previousWidget)&&!l.isEndnoteLineWidget()||e.isSectionBreak||this.moveToNextPage(this.viewer,l);var y=this.getLineSpacing(e,c);!isNaN(this.maxTextHeight)&&c<this.maxTextHeight&&(c=this.maxTextHeight);var w=0,b=0,C=0,x=c,I=e.paragraphFormat.lineSpacingType;"Multiple"===I?y>c?b+=y-c:w+=y-c:("Exactly"===I||y>w+x+b)&&(w+=y-(w+x+b)),w+=p,b+=Pa.convertPointToPixel(this.getAfterSpacing(e)),"None"!=d.top.lineStyle&&l.isFirstLine()&&!h.skipTopBorder&&(w+=Pa.convertPointToPixel(d.top.lineWidth+d.top.space)),"None"!=d.bottom.lineStyle&&l.isLastLine()&&!h.skipBottomBorder&&(b+=Pa.convertPointToPixel(d.bottom.lineWidth+d.bottom.space));for(var k=l.renderedElements,F=0;F<k.length;F++){var P=k[F];if(0===F&&P instanceof md||e.paragraphFormat.bidi&&k[k.length-1]instanceof md){var S;"Right"===(S=e.paragraphFormat.textAlignment)?C=o:"Center"===S&&(C=o/2),P.margin=new El(C,w,0,b),P.line=l,l.height=w+x+b;break}}l.margin=new El(0,w,0,b),l.height=w+x+b,this.adjustPositionBasedOnTopAndBottom(l),(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&e.isInsideTable&&e.previousRenderedWidget instanceof Al&&1==e.childWidgets.length&&(l.height=0);var T=e.previousRenderedWidget;if(e.isSectionBreak&&T instanceof Rl&&e.index>0)this.layoutSectionBreakParagraph(e,T),T.isEndsWithPageBreak&&this.moveToNextPage(this.viewer,l,!0);else{this.viewer.cutFromTop(this.viewer.clientActiveArea.y+l.height);var H=e.previousRenderedWidget;if(H){var E=H.getSplitWidgets();e.isSectionBreak&&E.length>0&&E[E.length-1]instanceof Al&&E[E.length-1].wrapTextAround&&this.viewer.cutFromTop(E[E.length-1].y+E[E.length-1].height)}}this.wrapPosition=[]},t.prototype.layoutSectionBreakParagraph=function(e,t){var i=t.lastChild,n=e.firstChild;i.margin&&(n.margin=new El(0,i.margin.top,0,i.margin.bottom)),n.height=i.height,e.height=i.height,e.y=this.getLineYPosition(t),e.width=t.width,e.x=this.getLineXPosition(t)},t.prototype.getLineYPosition=function(e){for(var t=e.y,i=0;i<e.childWidgets.length-1;i++)t+=e.childWidgets[i].height;return t},t.prototype.getLineXPosition=function(e){var t=e.lastChild,i=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat);return e.x+this.getLineWidth(t)+i.Width},t.prototype.getLineWidth=function(e){for(var t=0,i=0;i<e.children.length;i++)e.children[i]instanceof hd||(t+=e.children[i].width);return t},t.prototype.isUpdateMarginForCurrentLine=function(e){var t=!0;if(!(0,a.isNullOrUndefined)(e)&&!e.isFirstLine()){for(var i=0;i<e.children.length;i++)if(!(e.children[i]instanceof vd||e.children[i]instanceof fd)){t=!1;break}t&&(e.margin=new El(0,0,0,0))}},t.prototype.adjustPositionBasedOnTopAndBottom=function(e){!(0,a.isNullOrUndefined)(e.paragraph.bodyWidget)&&!(0,a.isNullOrUndefined)(e.paragraph.bodyWidget.page.headerWidget)&&e.paragraph.bodyWidget.page.headerWidget.floatingElements.length>0&&e.paragraph===e.paragraph.bodyWidget.childWidgets[0]&&0===e.indexInOwner&&this.checkInbetweenShapeOverlap(e,e.paragraph.bodyWidget.page.headerWidget.floatingElements)},t.prototype.layoutListItems=function(e,t){this.isFieldCode||(!(0,a.isNullOrUndefined)(e.paragraphFormat)&&!(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat)&&!(0,a.isNullOrUndefined)(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))&&e.paragraphFormat.listFormat.listLevelNumber>=0&&e.paragraphFormat.listFormat.listLevelNumber<9&&!t?(this.clearListElementBox(e),this.layoutList(e,this.documentHelper)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},t.prototype.layoutList=function(e,t){var i=t.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber,r=this.getListLevel(i,n);if(!(0,a.isNullOrUndefined)(r)&&!(0,a.isNullOrUndefined)(r.numberFormat)){var o=e.childWidgets[0];(0,a.isNullOrUndefined)(o)&&(o=new zl(e),e.childWidgets.push(o));var s=new md(r,!1);if(s.line=o,"Bullet"===r.listLevelPattern?(s.text=r.numberFormat,this.updateListValues(i,n)):s.text=this.getListNumber(e.paragraphFormat.listFormat),""!==r.numberFormat){if(this.viewer.updateClientWidth(-Pa.convertPointToPixel(e.paragraphFormat.firstLineIndent)),this.documentHelper.isIosDevice||this.documentHelper.isLinuxOS){var l=s.text;(l=l===String.fromCharCode(61623)?String.fromCharCode(9679):l===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):l)!==s.text&&(s.text=l)}var d;t.textHelper.updateTextSize(s,e),this.viewer instanceof kl&&this.viewer.clientActiveArea.height<s.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(d=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+s.width);var h=s;if(o.children.splice(0,0,s),"None"!==r.followCharacter){if(s=new md(r,!0),"Tab"===r.followCharacter){s.text="\t";var c=o.children.indexOf(s),p=this.getTabWidth(e,this.viewer,c,o,s);t.textHelper.updateTextSize(s,e),s.width=p}else s.text=" ",t.textHelper.updateTextSize(s,e);this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+s.width),o.children.splice(1,0,s),s.line=o}if((0,a.isNullOrUndefined)(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||h instanceof hd||e.containerWidget instanceof cd||(this.adjustPosition(h,h.line.paragraph.bodyWidget),h instanceof md&&h.padding&&h.padding.left>0&&e.paragraphFormat.firstLineIndent<0&&(h.padding.left-=Pa.convertPointToPixel(h.line.paragraph.paragraphFormat.firstLineIndent)),this.isYPositionUpdated&&(this.viewer.clientActiveArea.width>h.width+s.width&&(this.viewer.clientActiveArea.width-=h.width+s.width),this.isYPositionUpdated=!1)),d)return this.moveToNextPage(this.viewer,o,void 0,!0),this.cutClientWidth(s),this.hasFloatingElement=!1,void(this.isXPositionUpdated=!1);"None"!==r.followCharacter&&this.viewer.updateClientWidth(Pa.convertPointToPixel(e.paragraphFormat.firstLineIndent))}}},t.prototype.addBodyWidget=function(e,t){var i;return(i=t||new Ol).width=e.width,i.x=e.x,i.y=e.y,i},t.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new Va(e),n=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0===n?String.fromCharCode(61623):1===n?String.fromCharCode(61551)+String.fromCharCode(32):String.fromCharCode(61607),i.characterFormat.fontFamily=i.numberFormat===String.fromCharCode(61607)?"Wingdings":"Symbol"):(i.listLevelPattern=this.getListLevelPattern(n),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new ba(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},t.prototype.addSplittedLineWidget=function(e,t,i){var n=t;if(this.isWrapText)(0,a.isNullOrUndefined)(i)||(e.children.splice(n+1,0,i),i.line=e);else{var r=!1,o=e.paragraph,s=[],l=o.childWidgets.indexOf(e);(0,a.isNullOrUndefined)(i)||s.push(i);var d=void 0,h=e.children[n];h instanceof Bd&&0===h.commentType&&0!=n?n-=1:h.isColumnBreak&&(0,a.isNullOrUndefined)(h.nextNode)&&(r=!0);for(var c=n+1;c<e.children.length;c++)s.push(e.children[c]);if(s.length>0||r){d=l===o.childWidgets.length-1?new zl(o):o.childWidgets[l+1];for(var p=0;p<s.length;p++)s[p].line=d;s.length>0&&(e.children.splice(n+1,e.children.length-1),!(0,a.isNullOrUndefined)(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(n+1,e.layoutedElements.length-1),d.children=s.concat(d.children)),-1===o.childWidgets.indexOf(d)&&o.childWidgets.splice(l+1,0,d)}}},t.prototype.addElementToLine=function(e,t){t instanceof dd&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width)),"Justify"===e.paragraphFormat.textAlignment&&t instanceof Zl&&this.splitTextElementWordByWord(t),t instanceof gd&&(t.line.skipClipImage=!t.isInlineImage)},t.prototype.splitElementForClientArea=function(e,t){if(t.line.children.length>0){var i=t.previousElement,n=t.indexInOwner;t.line.children.length>1&&i&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(n-=1),this.addSplittedLineWidget(t.line,n)}},t.prototype.splitByWord=function(t,i,n,r,o,s){var a=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,r,o,s,n.scriptType);if(a>0&&a<n.length){var l=t.children.indexOf(n),d=new Zl;if(r=r.substring(a),d.text=r," "===r[0])a+=r.length-(r=Pa.trimStart(r)).length;if(d.characterFormat.copyFormat(n.characterFormat),d.width=this.documentHelper.textHelper.getWidth(d.text,s,d.scriptType)," "===d.text[d.text.length-1]?d.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(d.text),s,d.scriptType):d.trimEndWidth=d.width,d.characterRange=n.characterRange,d.scriptType=n.scriptType,n.text=n.text.substr(0,a)," "!==n.text&&Pa.endsWith(n.text)&&s.bidi&&n.characterRange===e.RightToLeft&&!this.isWrapText){var h=this.spitTextElementByWhitespace(n,s);l=t.children.indexOf(h)}n.width=this.documentHelper.textHelper.getWidth(n.text,n.characterFormat,n.scriptType)," "===n.text[n.text.length-1]?n.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(n.text),n.characterFormat,n.scriptType):n.trimEndWidth=n.width,n.revisions.length>0&&(this.updateRevisionForSplittedElement(n,d,!0),d.isMarkedForRevision=n.isMarkedForRevision),d.height=n.height,d.baselineOffset=n.baselineOffset,this.splitErrorCollection(n,d),this.addSplittedLineWidget(t,l,d),this.addElementToLine(i,n),0===n.width&&t.children.splice(l,1)}},t.prototype.spitTextElementByWhitespace=function(t,i){var n=t.line,r=n.children.indexOf(t),o=t.text,s=new Zl,a=o.length-1;return t.text=o.substring(0,a),s.text=o.substring(a),s.characterFormat.copyFormat(t.characterFormat),s.line=n,s.characterRange=e.WordSplit,s.scriptType=t.scriptType,s.height=t.height,s.baselineOffset=t.baselineOffset,s.width=this.documentHelper.textHelper.getWidth(s.text,i,s.scriptType),n.children.splice(r+1,0,s),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,s,a>0,!0),s.isMarkedForRevision=t.isMarkedForRevision),s},t.prototype.splitErrorCollection=function(e,t){if(e.errorCollection.length>0){for(var i=[],n=e.ignoreOnceItems,r=0;r<e.errorCollection.length;r++)i.push(e.errorCollection[r]);for(var o=0;o<e.errorCollection.length;o++){var s=e.text.indexOf(e.errorCollection[o].text),a=e.errorCollection[o];s<0?(i.splice(0,1),t.errorCollection.push(a)):t.text.indexOf(a.text)>0&&t.errorCollection.push(a)}t.ignoreOnceItems=n,e.ignoreOnceItems=[],e.errorCollection=i}},t.prototype.splitByCharacter=function(e,t,i,n,r){var o=e.paragraph,s="AtLeast"===o.paragraphFormat.lineSpacingType?o.paragraphFormat.afterSpacing:0,l=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,i,n,r,t.scriptType);if(!(0===l&&t.previousNode instanceof gd&&"Right"===t.previousNode.textWrappingType)){0===l&&!(0,a.isNullOrUndefined)(t)&&t.length>0&&Math.max(t.height,s)<=this.viewer.clientArea.height&&0===this.viewer.clientActiveArea.width&&0===e.children.indexOf(t)&&(l=1);var d=0;if(l<t.length&&(d=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,l),r,t.scriptType),i=i.substring(l)),d>this.viewer.clientActiveArea.width&&t.indexInOwner>0)this.addSplittedLineWidget(e,t.indexInOwner-1);else{var h=e.children.indexOf(t);if(l<t.length){var c=new Zl;c.text=i,c.errorCollection=t.errorCollection,c.scriptType=t.scriptType,t.text=t.text.substr(0,l),c.characterFormat.copyFormat(t.characterFormat),c.width=this.documentHelper.textHelper.getWidth(c.text,r,c.scriptType)," "===c.text[c.text.length-1]?c.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(c.text),r,c.scriptType):c.trimEndWidth=c.width,c.characterRange=t.characterRange,t.width=this.documentHelper.textHelper.getWidth(t.text,r,t.scriptType)," "===t.text[t.text.length-1]?t.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(t.text),r,t.scriptType):t.trimEndWidth=t.width,c.height=t.height,c.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,c),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,c,l>0),c.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(o,t),this.addSplittedLineWidget(e,h),0===t.width&&e.children.splice(h,1)}else this.addSplittedLineWidget(e,h),this.addElementToLine(o,t)}}},t.prototype.updateRevisionForSplittedElement=function(e,t,i,n){if(e.revisions.length>0)for(var r=0;r<e.revisions.length;r++){var o=e.revisions[r];if(i){t.revisions.push(o),(s=o.range.indexOf(e))<0?o.range.push(t):n?o.range.splice(s,0,t):o.range.splice(s+1,0,t)}else{var s=o.range.indexOf(e);o.range.splice(s,1),o.range.splice(s,0,t),t.revisions.push(o)}}},t.prototype.splitTextElementWordByWord=function(t){var i=t.line,n=i.children.indexOf(t),r=n,o=t.padding.left;t.padding.left=0;var s,a=t.text;if(a.trim().indexOf(" ")>=0){i.children.splice(n,1),s=t.characterFormat;for(var l=t.length-Pa.trimStart(a).length;l<t.length&&0!==(l=this.getTextIndexAfterSpace(a,l))&&l!==t.length;)if(l<t.length){var d=new Zl,h=a.substring(0,l);if(" "===(a=a.substring(l)).substring(0,1)&&(l+=a.length-Pa.trimStart(a).length),d.text=h,d.characterFormat.copyFormat(t.characterFormat),d.line=i,d.height=t.height,d.baselineOffset=t.baselineOffset,d.characterRange=t.characterRange,d.scriptType=t.scriptType,i.children.splice(n,0,d),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,d,l>0,!0),d.isMarkedForRevision=t.isMarkedForRevision)," "!==d.text&&Pa.endsWith(d.text)&&s.bidi&&d.characterRange===e.RightToLeft){var c=this.spitTextElementByWhitespace(d,s);n=i.children.indexOf(c)}d.width=this.documentHelper.textHelper.getWidth(d.text,s,d.scriptType)," "===d.text[d.text.length-1]?d.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(d.text),s,d.scriptType):d.trimEndWidth=d.width,t.text=a,t.width=this.documentHelper.textHelper.getWidth(t.text,t.characterFormat,t.scriptType)," "===t.text[t.text.length-1]?t.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(t.text),t.characterFormat,t.scriptType):t.trimEndWidth=t.width,0===t.width&&-1!==i.children.indexOf(t)&&i.children.splice(i.children.indexOf(t),1),l=0,n++}t.text=a,i.children.splice(n,0,t)}i.children[r].padding.left=o},t.prototype.isSplitByHyphen=function(e,t){if(!(0,a.isNullOrUndefined)(e.previousElement)&&(e.previousElement instanceof Zl||e.previousElement instanceof md)){var i=e.previousElement.text;return"-"===t.substring(0,1)&&" "!==i.substring(i.length-1,i.length)}return"-"===t.substring(0,1)},t.prototype.splitTextForClientArea=function(e,t,i,n,r){var o=e.paragraph,s=!0,a=-1;if(" "===i.substring(0,1)||this.isSplitByHyphen(t,i))a=1;else{var l=n,d=0;if(0==(d=Pa.trimEnd(i).indexOf(" ")+1)&&(d=Pa.trimEnd(i).indexOf("-")+1),(a=d)>0&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,a),r,t.scriptType)),this.viewer.clientActiveArea.width<l&&!this.documentHelper.textHelper.isUnicodeText(i,t.scriptType)&&!this.isWordFittedByJustification(t,l)&&(s=this.checkPreviousElement(e,e.children.indexOf(t))))return}var h=!0;this.documentHelper.textHelper.isUnicodeText(i,t.scriptType)&&3===t.scriptType&&i.length-1===i.indexOf(" ")&&(h=!1),n<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):s&&(a>0||-1!==i.indexOf(" ")&&h||-1!==i.indexOf("-"))?this.splitByWord(e,o,t,i,n,r):this.splitByCharacter(e,t,i,n,r)},t.prototype.splitByLineBreakOrTab=function(e,t,i,n){var r=t.line.children.indexOf(t),o=t.text,s=o.substring(i),a="\t"===n?new ed:new Zl;if(a.line=t.line,this.updateRevisionForSplittedElement(t,a,!0),a.characterFormat.copyFormat(t.characterFormat),a.characterRange=t.characterRange,t.line.children.splice(r+1,0,a),t.isWidthUpdated=!1,i>0&&1===s.length)a.text=o.substring(i),t.text=o.substring(0,i);else if(i>0){a.text=n;var l=new Zl;l.line=t.line,l.text=o.substring(i+1),this.updateRevisionForSplittedElement(t,l,!0),l.characterFormat.copyFormat(t.characterFormat),l.characterRange=t.characterRange,t.line.children.splice(r+2,0,l),t.text=o.substring(0,i)}else""!==s&&(a.text=o.substring(i+1),t.text=n)},t.prototype.moveToNextLine=function(e,t,i){var n=e.paragraph,r=n.paragraphFormat,o=e.isFirstLine(),s=e.isLastLine(),l=0,d=0,h=0,c=0,p=0,u=0,g=r.borders;this.updateLineWidget(e),d=(l=this.maxTextHeight)-this.maxTextBaseline;var m=0,f=!1,v=this.documentHelper.canRenderBorder(n);if(!n.bodyWidget||n.bodyWidget instanceof Bl||(m=this.documentHelper.pages.indexOf(n.bodyWidget.page)),o&&(c=this.getBeforeSpacing(n,m),u=Pa.convertPointToPixel(r.firstLineIndent)),s&&(h=Pa.convertPointToPixel(this.getAfterSpacing(n))),(r.bidi||this.isContainsRtl(e))&&(this.shiftElementsForRTLLayouting(e,r.bidi),this.isRTLLayout=!0),isNaN(this.maxTextHeight)){var y=this.documentHelper.textHelper.measureText("a",n.characterFormat);d=(l=y.Height)-y.BaselineOffset}else d=(l=this.maxTextHeight)-this.maxTextBaseline;p=this.getLineSpacing(n,l),(e.skipClipImage||n.paragraphFormat.lineSpacing>=14||p<0)&&"Exactly"===r.lineSpacingType&&p<d+this.maxBaseline&&(p=d+this.maxBaseline);var w,b=0,C=0,x=r.textAlignment,I=0,k=0;if("Left"!==x&&this.viewer.textWrap&&("Justify"!==x||!s||"Justify"===x&&r.bidi||this.is2013Justification&&s)&&(b=(w=this.getSubWidth(e,"Justify"===x,C,u,s))[0].subWidth,C=w[0].spaceCount,I=w[0].totalSpaceCount,k=w[0].trimmedSpaceWidth,f=e.isEndsWithPageBreak||e.isEndsWithColumnBreak||e.isEndsWithLineBreak||e.paragraph.bidi||this.isRTLLayout),!f&&w&&1===w.length&&this.viewer.clientActiveArea.width>0&&!s&&!this.is2013Justification&&"Justify"===x&&"Word2013"===this.documentHelper.compatibilityMode){var F=this.viewer.clientActiveArea.width,P=this.getTotalSpaceWidth(e),S=0;return S=F/I/(P/I)*100<=33?P/8:P/4,this.viewer.clientActiveArea.x-=S,this.viewer.clientActiveArea.width+=S,this.is2013Justification=!0,void(t?this.splitParagraphForMultiColumn(e,i):(this.moveElementFromNextLine(e),this.nextElementToLayout=e.children[e.children.length-1]))}this.is2013Justification&&s&&b>0&&(b=0,C=0),this.is2013Justification=!1,this.nextElementToLayout=void 0;for(var T=!1,H=0,E=r.lineSpacingType,N=!1,W=e.renderedElements,O=0,B=0,L=0,D=this.viewer.clientArea.x,R=0;R<W.length;R++){var M=0,A=0,U=0,V=W[R];if(!(0,a.isNullOrUndefined)(w)&&N&&V.padding.left>0&&w.length>H+1){var z=b;"Justify"===x?z=b*w[H].spaceCount:"Center"===x&&(z=b/2),V.padding.left=V.padding.left-z;var q=w[++H];b=q.subWidth,C=q.spaceCount}if(!(V instanceof dd&&"Inline"!==V.textWrappingStyle)){N=!0;var _=this.alignLineElements(V,M,A,d,T,b,x,C,R===W.length-1);if("Justify"===x&&V instanceof dd&&"Inline"===V.textWrappingStyle&&0!==b&&(V.x=D,V instanceof hd))for(var j=0;j<V.textFrame.childWidgets.length;j++){var G=(J=V.textFrame.childWidgets[j]).bidi?J.rightIndent:J.leftIndent;J.x=D+Pa.convertPointToPixel(G+V.textFrame.marginLeft)}D+=V.width,e.maxBaseLine=this.maxBaseline,M=_.topMargin,A=_.bottomMargin,T=_.addSubWidth,C=_.whiteSpaceCount,"Multiple"===E?p>l?A+=p-l:M+=p-l:("Exactly"===E||p>M+V.height+A)&&(M+=p-(M+V.height+A)),m>0&&n===n.bodyWidget.childWidgets[0]&&this.documentHelper.pages[m].sectionIndex===this.documentHelper.pages[m-1].sectionIndex?M+=0:M+=c,"None"!=g.top.lineStyle&&e.isFirstLine()&&!v.skipTopBorder&&(M+=Pa.convertPointToPixel(g.top.lineWidth+g.top.space)),"None"!=g.bottom.lineStyle&&e.isLastLine()&&!v.skipBottomBorder&&(A+=Pa.convertPointToPixel(g.bottom.lineWidth+g.bottom.space)),A+=h;var K=R>0?W[R-1]:void 0;if((0===R||!(V instanceof dd&&"Inline"!==V.textWrappingStyle)&&K instanceof dd&&"Inline"!==K.textWrappingStyle&&K.indexInOwner<V.indexInOwner||V.padding.left>0)&&(e.height=M+V.height+A,"Right"===x||"Justify"===x&&r.bidi&&(s||k<0)?U=k<0?k:b:"Center"===x&&(U=b<0?b:b/2)),V.margin=new El(U,M,0,A),V.line=e,O<V.height&&(O=V.height,B=V.margin.bottom,L=V.margin.top),V instanceof hd&&"Inline"===V.textWrappingStyle){if(0!==R||V.margin.left>0){var X=W[0].margin.left;V.x+=X;for(var Z=0;Z<V.textFrame.childWidgets.length;Z++){var J;(J=V.textFrame.childWidgets[Z])instanceof Al?J.updateChildWidgetLeft(J.x+X):J.x+=X}}this.updateShapeYPosition(V)}}}if(e.margin=new El(0,L,0,B),this.adjustPositionBasedOnTopAndBottom(e),this.checkInbetweenShapeOverlap(e),!t&&e.isLastLine()&&0===e.indexInOwner&&e.paragraph.paragraphFormat.widowControl){var Y=e.paragraph.previousSplitWidget;if(!(0,a.isNullOrUndefined)(Y)&&!Y.isEndsWithPageBreak&&!Y.isEndsWithColumnBreak&&0!==Y.indexInOwner){var Q=Y.childWidgets.length-1;2===Y.childWidgets.length&&(Q=0),this.splitParagraph(Y,Q,e.paragraph),this.updateClientAreaForNextBlock(e,e.paragraph)}}else t&&this.splitParagraphForMultiColumn(e,i);t||this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.wrapPosition=[]},t.prototype.updateShapeYPosition=function(e){if(e.margin.top>0){e.y+=e.margin.top;for(var t=0;t<e.textFrame.childWidgets.length;t++)e.textFrame.childWidgets[t].y+=e.margin.top}},t.prototype.getBodyWidget=function(e,t){if(t)for(;e&&0!==e.columnIndex;)e=e.previousRenderedWidget;else for(;e&&!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&e.columnIndex!==e.sectionFormat.numberOfColumns-1&&e.index===e.nextRenderedWidget.index;)e=e.nextRenderedWidget;return e},t.prototype.splitParagraphForMultiColumn=function(e,t){this.splitParagraph(e.paragraph,t,void 0),(0,a.isNullOrUndefined)(e.paragraph.previousRenderedWidget)&&0==t||!(0,a.isNullOrUndefined)(e.paragraph.previousRenderedWidget)&&e.paragraph.previousRenderedWidget.bodyWidget.sectionIndex!==e.paragraph.bodyWidget.sectionIndex?this.moveBlocksToNextPage(e.paragraph):this.moveBlocksToNextPage(e.paragraph.previousRenderedWidget);var i=this.viewer.clientActiveArea.height;if(this.viewer.updateClientArea(e.paragraph.bodyWidget,e.paragraph.bodyWidget.page),this.viewer.clientActiveArea.y=e.paragraph.bodyWidget.y,this.viewer.clientActiveArea.height=i,e.paragraph.bodyWidget.sectionFormat.equalWidth||e.paragraph.bodyWidget.sectionFormat.numberOfColumns-1===e.paragraph.bodyWidget.columnIndex){var n=e.paragraph;this.documentHelper.blockToShift=n,this.shiftLayoutedItems(!1,!0)}},t.prototype.checkInbetweenShapeOverlap=function(e,t){var i=this;if(!(e.paragraph.containerWidget instanceof cd)&&e.paragraph.bodyWidget){var n,r=this.getLineY(e),o=e.paragraph.isInsideTable,s=e.paragraph.y,l=!0;(0,a.isNullOrUndefined)(t)&&(l=!1,t=e.paragraph.bodyWidget.floatingElements),t.sort((function(e,t){return e.y-t.y})),t.forEach((function(t){if(!(o&&t.line&&!t.line.paragraph.isInsideTable||(0,a.isNullOrUndefined)(t.line))){var d;d="TopAndBottom"===t.textWrappingStyle&&t instanceof gd&&!e.paragraph.isEmpty()?new Tl(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.children[0].height):new Tl(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.height);var h=new Tl(t.x,t.y-t.distanceTop,t.width,t.height);if(!(t.line&&i.isRelayout&&!i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,e.paragraph)||i.isRelayout&&i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,i.endOverlapWidget))){var c="TopAndBottom"===t.textWrappingStyle,p=t.y+t.height+t.distanceBottom-r;n&&c&&n.y+n.height+n.distanceBottom+e.height>t.y-t.distanceTop&&n.y-n.distanceTop<t.y-t.distanceTop&&t.y+t.height+t.distanceBottom>n.y+n.height+n.distanceBottom?(n=t,e.paragraph.isEmpty()&&l?(e.paragraph.y=s,e.paragraph.y+=p):e.marginTop=p):c&&!n&&d.isIntersecting(h)&&(n=t,e.paragraph.isEmpty()&&l?e.paragraph.y+=p:e.marginTop=p)}}})),n?this.viewer.cutFromTop(n.y+n.height+n.distanceBottom):this.isRelayoutOverlap&&(e.marginTop=0)}},t.prototype.getLineY=function(e){var t=e.paragraph,i=t.y;if(!t.isEmpty())for(var n=t.firstChild;n!==e;)i=i+n.height+n.marginTop,n=n.nextLine;return i},t.prototype.updateLineWidget=function(e){for(var t=0,i=0,n=!1,r=!1,o=0;o<e.children.length;o++){var s=e.children[o];if(s instanceof _l&&2===s.fieldType&&(r=!1),!(r||(s instanceof _l&&0===s.fieldType&&(r=!0),s instanceof dd&&"Inline"!==s.textWrappingStyle)))if(s instanceof Zl&&0===s.text.replace(/\s+/g,"").length&&s.text!==String.fromCharCode(160))t<s.height&&(t=s.height,i=s.baselineOffset);else if(s instanceof Zl||s instanceof md){var l=s.height,d=s.baselineOffset,h=!1;s instanceof Zl&&s.isCheckBoxElement&&!(0,a.isNullOrUndefined)(s.previousNode)&&s.previousNode instanceof id&&("Cell"===s.previousNode.contentControlWidgetType||"Inline"===s.previousNode.contentControlWidgetType)&&(h=!0),s instanceof Zl&&s.isCheckBoxElement&&!h&&(l/=qa,d/=qa),this.maxTextHeight<l&&(this.maxTextHeight=l,this.maxTextBaseline=d),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}else this.maxBaseline<s.height&&(this.maxBaseline=s.height,s instanceof gd&&(n=!0))}if(0===this.maxTextHeight&&0!==t)if(n)this.maxTextHeight=0,this.maxTextBaseline=0;else{if(e.isLastLine()&&this.documentHelper.selection){var c=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0);this.maxTextHeight=c.height,this.maxTextBaseline=i}else this.maxTextHeight=t,this.maxTextBaseline=i;this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}},t.prototype.reLayoutEndnote=function(){var e=this.documentHelper.pages[this.documentHelper.pages.length-1];if(!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(e.endnoteWidget)){var t=this.viewer.clientActiveArea.clone(),i=this.getBodyWidget(e.bodyWidgets[e.bodyWidgets.length-1],!0);this.viewer.updateClientArea(i,i.page);var n=this.getNextWidgetHeight(i);n>0&&(this.viewer.clientActiveArea.height-=n-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=n),this.layoutfootNote(e.endnoteWidget),this.viewer.clientActiveArea=t}},t.prototype.moveEndnoteToNextPage=function(e,t,i,n){if(i){var r=this.createSplitBody(t),o=this.viewer.createNewPage(r);this.viewer.updateClientArea(r,r.page),r.y=t.y=this.viewer.clientActiveArea.y;for(var s=0;s<e.bodyWidgets.length;s++)e.bodyWidgets[s].page=o,e.bodyWidgets[s].containerWidget=e;e.page.endnoteWidget=void 0,o.endnoteWidget=e,e.page=o}else{var l=t.page;if((0,a.isNullOrUndefined)(l.endnoteWidget)){var d=new Dl;d.footNoteType="Endnote",d.page=l,d.bodyWidgets.push(t),t.containerWidget=d;for(s=n+1;s<e.bodyWidgets.length;s++){var h=e.bodyWidgets[s];e.bodyWidgets.splice(s,1),d.bodyWidgets.push(h),h.containerWidget=d,h.page=l,s--}l.endnoteWidget=d}else{-1===l.endnoteWidget.bodyWidgets.indexOf(t)&&(l.endnoteWidget.bodyWidgets.splice(0,0,t),t.containerWidget=l.endnoteWidget);for(s=e.bodyWidgets.length-1;s>n;s--){h=e.bodyWidgets[s];l.endnoteWidget.bodyWidgets.unshift(h),h.containerWidget=l.endnoteWidget,h.page=l,e.bodyWidgets.splice(s,1)}}}},t.prototype.moveToNextPage=function(e,t,i,n,r){if(!this.isFootNoteLayoutStart){var o,s=t.paragraph,l=!1,d=!1,h=!1,c=0;if(s&&((0,a.isNullOrUndefined)(s.containerWidget)||(0,a.isNullOrUndefined)(s.containerWidget.containerWidget)||!(s.containerWidget.containerWidget instanceof Dl)||"Footnote"!==s.containerWidget.containerWidget.footNoteType)){var p=0;if(s instanceof Dl)return;if(!(0,a.isNullOrUndefined)(s.containerWidget)&&!(0,a.isNullOrUndefined)(s.containerWidget.containerWidget)&&s.containerWidget.containerWidget instanceof Dl&&"Endnote"===s.containerWidget.containerWidget.footNoteType&&(h=!0),!(0,a.isNullOrUndefined)(t)&&(0!==(p=s.childWidgets.indexOf(t))&&((!s.paragraphFormat.keepLinesTogether||(0,a.isNullOrUndefined)(s.previousWidget)||t.previousLine.isEndsWithColumnBreak)&&(1!=p||t.previousLine.isEndsWithPageBreak||t.previousLine.isEndsWithColumnBreak||!s.paragraphFormat.widowControl||(0,a.isNullOrUndefined)(s.previousWidget))||(p=0,l=!0)),(p>0||i)&&(s.height=e.clientActiveArea.y-s.y),0===p&&!s.isEndsWithPageBreak&&!s.isEndsWithColumnBreak)){var u=this.alignBlockElement(s);(0,a.isNullOrUndefined)(u.node)||(p=(o=u.node instanceof Ul?this.splitRow(u.node):u.node)instanceof Al?0:parseInt(u.position.index,10),l=!1,d=!0,(s=o)instanceof Rl?this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!s.paragraphFormat.keepWithNext&&!n&&this.viewer.owner.editorModule.updateWholeListItems(s):this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!n&&this.viewer.owner.editorModule.updateWholeListItems(s))}if((0,a.isNullOrUndefined)(s.bodyWidget)||(0,a.isNullOrUndefined)(s.bodyWidget.containerWidget)||s.bodyWidget.containerWidget instanceof Dl||void 0===s.bodyWidget.page.footnoteWidget||this.layoutfootNote(s.bodyWidget.page.footnoteWidget),this.isMultiColumnSplit){var g=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(s.bodyWidget);if((0,a.isNullOrUndefined)(g))return}var m=s.bodyWidget.page;if(i&&0===p&&!(0,a.isNullOrUndefined)(s.bodyWidget.lastChild)&&s===s.bodyWidget.lastChild&&this.endOverlapWidget&&(this.isRelayoutOverlap=!1),h&&(0,a.isNullOrUndefined)(m.nextPage)&&0===s.bodyWidget.index&&0===s.index&&0===p){var f=s.containerWidget.containerWidget;return void this.moveEndnoteToNextPage(f,s.bodyWidget,!0)}var v=this.moveBlocksToNextPage(s,0===p,p,!1,h);if(h){var y=(f=s.containerWidget.containerWidget).bodyWidgets.indexOf(s.bodyWidget);v.footNoteReference=s.bodyWidget.footNoteReference,this.moveEndnoteToNextPage(f,v,!1,y)}if(m!==v.page&&this.viewer.updateClientArea(v,v.page),this.viewer.updateClientAreaForBlock(s,!0),p>0){if(t.isLastLine()&&i)return;var w=void 0;w=v.firstChild instanceof Rl&&v.firstChild.equals(s)?v.firstChild:new Rl,(w=this.moveChildsToParagraph(s,p,w)).containerWidget=v;for(var b=0;b<w.floatingElements.length;b++){var C=w.floatingElements[b];C.line.paragraph.bodyWidget!==s.bodyWidget&&"Inline"!==C.textWrappingStyle&&s.bodyWidget.floatingElements.splice(s.bodyWidget.floatingElements.indexOf(C),1)}var x=this.getFootNoteWidgetsOf(w);this.moveFootNotesToPage(x,s.bodyWidget,v),s=w,this.viewer.clientActiveArea.height-=this.getFootNoteHeight(x)}else if(!i){if(s.containerWidget.removeChild(s.indexInOwner),s instanceof Rl&&s.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(s,s.containerWidget,!1),h&&0===s.containerWidget.childWidgets.length&&!(0,a.isNullOrUndefined)(s.containerWidget.containerWidget)&&s.containerWidget.containerWidget instanceof Dl)(f=s.containerWidget.containerWidget).bodyWidgets.splice(f.bodyWidgets.indexOf(s.containerWidget),1),v.footNoteReference.bodyWidget=v,(0,a.isNullOrUndefined)(f.page.endnoteWidget)||0!==f.page.endnoteWidget.bodyWidgets.length||(f.page.endnoteWidget=void 0)}if(!i){if(-1===v.childWidgets.indexOf(s)&&(v.childWidgets.splice(0,0,s),s instanceof Rl&&s.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(s,v,!0)),s.containerWidget=v,this.viewer.updateClientAreaLocation(s,this.viewer.clientActiveArea),l||d){s.bodyWidget.page.footnoteWidget&&this.layoutfootNote(s.bodyWidget.page.footnoteWidget),(t.paragraph!==s||s.paragraphFormat.widowControl&&this.isImagePresent(s))&&(s instanceof Al&&this.clearTableWidget(s,!0,!0,!1),this.layoutBlock(s,0,!0),e.updateClientAreaForBlock(s,!1));var I=t.paragraph;if(d){var k=s.nextWidget;if(!(0,a.isNullOrUndefined)(k))do{if(e.updateClientAreaForBlock(k,!0),k===I){this.viewer.updateClientAreaLocation(k,this.viewer.clientActiveArea);break}k instanceof Al&&this.clearTableWidget(k,!0,!0,!1),this.layoutBlock(k,0,!0),e.updateClientAreaForBlock(k,!1),k=k.nextWidget}while(k)}this.updateClientAreaForNextBlock(t,I)}!t.isFirstLine()||0!==t.indexInOwner||t.children[0]instanceof md||r||(c=-Pa.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent),this.viewer.updateClientWidth(c))}}if(i||this.updateShapeBaseLocation(s),r&&this.viewer.updateClientWidth(c),this.isRelayoutOverlap&&this.endOverlapWidget&&(!this.skipRelayoutOverlap||this.endOverlapWidget instanceof Al&&this.endOverlapWidget.wrapTextAround)){var F=this.endOverlapWidget.previousRenderedWidget,P=t.paragraph;for(this.startOverlapWidget=P,P=(t=this.endOverlapWidget.childWidgets[0]).paragraph;P;)P.floatingElements.forEach((function(e){-1!==F.bodyWidget.floatingElements.indexOf(e)&&"Inline"!==e.textWrappingStyle&&(F.bodyWidget.floatingElements.splice(F.bodyWidget.floatingElements.indexOf(e),1),t.paragraph.bodyWidget.floatingElements.push(e))})),P=P!==this.endOverlapWidget?P.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget),this.startOverlapWidget=void 0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y,this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},t.prototype.isImagePresent=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)if(i.children[n]instanceof gd)return!0;return!1},t.prototype.updateShapeBaseLocation=function(e){if(e instanceof Rl&&e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i);i.y=n.y,i.x=n.x,i instanceof hd&&this.updateChildLocationForCellOrShape(i.y,i)}},t.prototype.moveChildsToParagraph=function(e,t,i){i=this.addParagraphWidget(this.viewer.clientActiveArea,i);for(var n=0,r=t;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o.paragraph=i,i.childWidgets.splice(n,0,o),o.paragraph=i,n++}i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index,e.childWidgets.splice(t);for(r=0;r<e.floatingElements.length;r++){var s=e.floatingElements[r];s.line.paragraph!==e&&(i.floatingElements.push(s),e.floatingElements.splice(e.floatingElements.indexOf(s),1),r--)}return i},t.prototype.addRemoveFloatElementsFromBody=function(e,t,i){if(e.floatingElements.length>0)for(var n=0;n<e.floatingElements.length;n++)i?-1===t.floatingElements.indexOf(e.floatingElements[n])&&"Inline"!==e.floatingElements[n].textWrappingStyle&&t.floatingElements.push(e.floatingElements[n]):-1!==t.floatingElements.indexOf(e.floatingElements[n])&&t.floatingElements.splice(t.floatingElements.indexOf(e.floatingElements[n]),1)},t.prototype.alignBlockElement=function(e){if(e instanceof Rl&&(e.isEndsWithPageBreak||e.isEndsWithColumnBreak))return{node:void 0,position:{index:""}};for(var t,i=0,n=this.getPreviousBlock(e);n;){if(n instanceof Rl){if(!n.paragraphFormat.keepWithNext||n.isEndsWithPageBreak||n.isEndsWithColumnBreak)break;if(t=n,n.paragraphFormat.keepLinesTogether)(0,a.isNullOrUndefined)(this.getPreviousBlock(n))?t=void 0:i=0;else if((0,a.isNullOrUndefined)(this.getPreviousBlock(n))&&1===n.childWidgets.length)t=void 0;else if(n.paragraphFormat.widowControl){if((1===(i=n.lastChild.indexInOwner-1)||i<0)&&(i=0),0!==i)break}else if(0!==(i=n.lastChild.indexInOwner))break}else if(n instanceof Ul){var r=n.childWidgets[0];if(!(r.childWidgets.length>0))break;var o=this.documentHelper.getFirstParagraphInCell(r);if(!o.paragraphFormat.keepWithNext)break;o.paragraphFormat.keepWithNext&&((0,a.isNullOrUndefined)(this.getPreviousBlock(n))?t=void 0:i=(t=n).indexInOwner)}n=this.getPreviousBlock(n)}return!(0,a.isNullOrUndefined)(t)&&t instanceof Rl&&0===t.indexInOwner&&t.paragraphFormat.keepWithNext&&t.paragraphFormat.widowControl&&(t=e),{node:t,position:{index:i.toString()}}},t.prototype.getPreviousBlock=function(e){var t;return e instanceof Rl?(t=e.previousWidget,!this.isInitialLoad&&(0,a.isNullOrUndefined)(t)&&e.containerWidget instanceof Ol&&!(0,a.isNullOrUndefined)(e.containerWidget.previousRenderedWidget)&&e.containerWidget.sectionIndex===e.containerWidget.previousRenderedWidget.sectionIndex&&!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof Rl&&(t=e.previousRenderedWidget)):e instanceof Ul&&(t=e.previousWidget,(0,a.isNullOrUndefined)(t)&&(t=e.ownerTable.previousWidget)),t instanceof Al&&(t=t.lastChild),t},t.prototype.splitRow=function(e){var t=e.ownerTable;if(0===e.indexInOwner)return t;for(var i=this.createTableWidget(t),n=e.indexInOwner;n<t.childWidgets.length;){var r=t.childWidgets.splice(n,1)[0];i.childWidgets.push(r),r.containerWidget=i,t.height-=r.height,i.height+=r.height}return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},t.prototype.splitParagraph=function(e,t,i){if(0===t&&(0,a.isNullOrUndefined)(i))return e;var n=!1;if((0,a.isNullOrUndefined)(i))(i=new Rl).containerWidget=e.containerWidget,e.containerWidget.childWidgets.splice(e.indexInOwner+1,0,i),i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index;else if(0===t){n=!0;var r=e;e=i,i=r}for(var o=0,s=t;s<e.childWidgets.length;s++){var l=e.childWidgets[s];l.paragraph=i,n?i.childWidgets.push(l):i.childWidgets.splice(o,0,l),i.height+=l.height,e.height-=l.height,l.paragraph=i,o++}return i.width=e.width,n?(i.containerWidget.childWidgets.splice(i.indexInOwner,1),i.y=e.y,i.x=e.x,i.containerWidget=e.containerWidget,e.containerWidget.childWidgets.unshift(i)):e.childWidgets.splice(t),(0===e.childWidgets.length||n)&&e.containerWidget.childWidgets.splice(e.indexInOwner,1),i},t.prototype.updateClientPositionForBlock=function(e,t){var i=e instanceof Ul?e.ownerTable:e,n=!1;do{if(i instanceof Rl){if(t instanceof Rl&&t.equals(i)){n=!0;break}this.viewer.updateClientAreaForBlock(i,!0),this.addParagraphWidget(this.viewer.clientActiveArea,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}else if(i instanceof Al){this.viewer.updateClientAreaForBlock(i,!0),"Word2013"===this.documentHelper.compatibilityMode||i.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-Pa.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.addTableWidget(this.viewer.clientActiveArea,[i]);var r=i.firstChild;if(t instanceof Ul&&i.equals(t.ownerTable)&&!(0,a.isNullOrUndefined)(r))do{if(r.equals(t)){n=!0;break}this.addTableRowWidget(this.viewer.clientActiveArea,[r]),this.updateChildLocationForRow(this.viewer.clientActiveArea.y,r),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height),i.height+=r.height,r=r.nextWidget}while(r);else this.updateChildLocationForTable(i.y,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}i=i.nextWidget}while(i&&!n)},t.prototype.updateClientAreaForNextBlock=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(e===n)break;this.updateShapeBaseLocation(t),this.checkInbetweenShapeOverlap(n),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height)}},t.prototype.layoutStartEndBlocks=function(e,t){var i,n=e;for(this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e.y,this.viewer.clientActiveArea.y=e.y,i=e instanceof Al?this.documentHelper.getFirstParagraphInFirstCell(e):e,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(i);n;){this.viewer.updateClientAreaForBlock(n,!0),n instanceof Rl?this.layoutParagraph(n,0):(this.clearTableWidget(n,!0,!0,!0),this.layoutTable(n,0)),this.viewer.updateClientAreaForBlock(n,!1);var r=!(0,a.isNullOrUndefined)(n.nextWidget)&&n.nextWidget instanceof Al&&n.nextWidget===t&&"Paragraph"===n.nextWidget.positioning.verticalOrigin;n=n===t||r?void 0:n.nextWidget}},t.prototype.alignLineElements=function(e,t,i,n,r,o,s,l,d){if(e.width>0&&(e instanceof Zl||e instanceof md)){var h=e instanceof Zl?e:void 0,c=e instanceof Zl?h.baselineOffset:e.baselineOffset;if(t+=this.maxBaseline-c,i+=n-(e.height-c),!(0,a.isNullOrUndefined)(h)&&"Justify"===s&&l>0){h.isWidthUpdated=!1;var p=h.width,u=h.text;if(r||(r=(u=Pa.trimStart(u)).length>0),r){var g=u.length-Pa.removeSpace(u).length;d&&(g-=u.length-Pa.trimEnd(u).length),l<g&&(p=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(u,h.characterFormat,h.scriptType),g=l),g>0&&(h.width=p+o*g,l-=g)}}}else r=!0,t+=this.maxBaseline-e.height,i+=n;return{topMargin:t,bottomMargin:i,addSubWidth:r,whiteSpaceCount:l}},t.prototype.updateWidgetToPage=function(e,t,i){if(t.isInsideTable){var n=t.associatedCell;if(t.height=e.clientActiveArea.y-t.y,(0,a.isNullOrUndefined)(t.associatedCell)||(0,a.isNullOrUndefined)(t.associatedCell.ownerRow)||(0,a.isNullOrUndefined)(t.associatedCell.ownerRow.rowFormat))return;"Exactly"===t.associatedCell.ownerRow.rowFormat.heightType?n.height=Pa.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height):"AtLeast"!==t.associatedCell.ownerRow.rowFormat.heightType||i?n.height=n.height+t.height:n.height=Math.max(Pa.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(n,!1,t.indexInOwner)),t.containerWidget=n}else(!t.isEndsWithPageBreak&&!t.isEndsWithColumnBreak||e instanceof Fl)&&(t.height=e.clientActiveArea.y-t.y);this.isRelayoutFootnote&&t.bodyWidget instanceof Dl&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.shiftFootnoteChildLocation(t.bodyWidget,this.viewer)),t.bodyWidget instanceof Bl&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.viewer.owner.enableHeaderAndFooter&&-1!==t.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(t.bodyWidget,this.viewer)),e instanceof Fl&&t.containerWidget instanceof Ol&&(t.containerWidget.height+=t.height)},t.prototype.shiftFooterChildLocation=function(e,t){var i=e.page.bodyWidgets[0].sectionFormat.pageHeight;if(-1!==e.headerFooterType.indexOf("Footer")){var n,r=e.page.bodyWidgets[0].sectionFormat.footerDistance,o=Pa.convertPointToPixel(i-r);e.y+e.height>o?n=o-(e.y+e.height):e.y+e.height<o&&(n=e.y+e.height-o),(0,a.isNullOrUndefined)(n)||(n=o-(e.y+e.height),this.shiftChildLocation(n,e),t.clientActiveArea.y+=n)}},t.prototype.shiftFootnoteChildLocation=function(e,t){var i,n=e.page.bodyWidgets[0].sectionFormat.pageHeight,r=(e.page.bodyWidgets[0].sectionFormat.footerDistance,e.page.bodyWidgets[0].sectionFormat.bottomMargin),o=Pa.convertPointToPixel(n-r);e.y+e.height>o?i=o-(e.y+e.height):e.y+e.height<o&&(i=e.y+e.height-o),(0,a.isNullOrUndefined)(i)||(i=o-(e.y+e.height),this.shiftChildLocation(i,e),t.clientActiveArea.y+=i)},t.prototype.checkPreviousElement=function(e,t){for(var i=e.paragraph,n=!1,r=0,o="Justify"===i.paragraphFormat.textAlignment,s=t-1;s>=0;s--){var l=e.children[s];if(l instanceof Zl&&(l.width>0||!o&&"\t"===l.text)){var d=l.text;if(r=s,d.length>0&&(" "===d[d.length-1]||"-"===d[d.length-1])){if(s===t-1)return this.addSplittedLineWidget(e,t-1),!0;n=!0;break}if(!this.isRelayoutOverlap&&!o&&l instanceof ed&&"\t"===d&&0!==r){r--,n=!0;break}if("\t"===d||this.documentHelper.textHelper.isUnicodeText(d,l.scriptType))return!1;if(d.indexOf(" ")>=0){n=!0;var h=d.lastIndexOf(" ")+1,c=new Zl;c.text=d.substr(h),c.characterFormat.copyFormat(l.characterFormat),c.characterRange=l.characterRange,l.revisions.length>0&&(this.updateRevisionForSplittedElement(l,c,h>0),c.isMarkedForRevision=l.isMarkedForRevision),l.text=d.substr(0,h),this.documentHelper.textHelper.getTextSize(c,l.characterFormat),l.width-=c.width," "===l.text[l.text.length-1]?l.trimEndWidth=this.documentHelper.textHelper.getWidth(Pa.trimEnd(l.text),l.characterFormat,l.scriptType):l.trimEndWidth=l.width,l.height=c.height,0===l.width&&(e.children.splice(s,1),!(0,a.isNullOrUndefined)(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(s,1)),e.children.splice(s+1,0,c),(0,a.isNullOrUndefined)(e.layoutedElements)||e.layoutedElements.splice(s+1,0,c);break}}else if(!(l instanceof md||l instanceof _l||l instanceof Zl&&0===l.width||l instanceof Bd||l instanceof id)){r=s,n=!0;break}}if(n&&++r<e.children.length){var p=0;for(s=r;s<e.children.length;s++)p+=e.children[s].width,this.addSplittedLineWidget(e,s-1),s--;"Justify"===i.paragraphFormat.textAlignment&&"Word2013"===this.documentHelper.compatibilityMode||this.viewer.updateClientWidth(p)}return n},t.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var t=e.childWidgets[0];if(!(0,a.isNullOrUndefined)(t.children)){for(var i=t.children.length-1;i>0&&t.children[i]instanceof md;i--)t.children.splice(i,1);for(i=0;i<t.children.length&&t.children[i]instanceof md;i++)t.children.splice(i,1),i--}}},t.prototype.clearInvalidList=function(e){e&&(-1===e.abstractListId&&-1!==this.documentHelper.abstractLists.indexOf(e.abstractList)&&this.documentHelper.abstractLists.splice(this.documentHelper.abstractLists.indexOf(e.abstractList),1),-1===e.listId&&-1!==this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(e),1))},t.prototype.getListNumber=function(e,t){var i=this.documentHelper.getListById(e.listId),n=e.listLevelNumber,r=this.getListLevel(i,e.listLevelNumber),o=(0,a.isNullOrUndefined)(i.levelOverrides)?void 0:i.levelOverrides[n];if(!(0,a.isNullOrUndefined)(o)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(i)&&(0,a.isNullOrUndefined)(o.overrideListLevel)){this.documentHelper.renderedLevelOverrides.push(i);var s=this.documentHelper.getAbstractListById(i.abstractListId);if(this.documentHelper.renderedLists.containsKey(s)){var l=this.documentHelper.renderedLists.get(s);l.containsKey(n)&&(l.remove(n),this.ClearSubListLevelValues(i,s,n))}}return(0,a.isNullOrUndefined)(t)&&this.updateListValues(i,n),this.getListText(i,n,r)},t.prototype.ClearSubListLevelValues=function(e,t,i){for(var n=this.documentHelper.renderedLists.get(t),r=i+1;r<t.levels.length;){var o=this.getListLevel(e,r);n.containsKey(r)&&o.restartLevel>i&&n.remove(r),r++}},t.prototype.getListStartValue=function(e,t){var i=(0,a.isNullOrUndefined)(t.levelOverrides)?void 0:t.levelOverrides[e];if(!(0,a.isNullOrUndefined)(i)&&(0,a.isNullOrUndefined)(i.overrideListLevel))return i.startAt;var n=this.getListLevel(t,e);return(0,a.isNullOrUndefined)(n)?0:n.startAt},t.prototype.updateListValues=function(e,t){var i=this.documentHelper.getAbstractListById(e.abstractListId),n=this.getListLevel(e,t);if(this.documentHelper.renderedLists.containsKey(i)){var r=this.documentHelper.renderedLists.get(i);if(r.containsKey(t)){var o=r.get(t);r.set(t,o+1);for(var s=t+1;s<this.documentHelper.getAbstractListById(e.abstractListId).levels.length;){d=this.getListLevel(e,s);r.containsKey(s)&&(d.restartLevel>t||"Bullet"===n.listLevelPattern)&&r.remove(s),s++}}else{for(s=t;!r.containsKey(s-1)&&s>0;){d=this.getListLevel(e,s-1);r.add(s-1,this.getListStartValue(s-1,e)),s--}o=this.getListStartValue(t,e);r.add(t,o)}}else{var a=new l;this.documentHelper.renderedLists.add(i,a);for(var d=this.getListLevel(e,t),h=0;h<=t;h++)a.add(h,this.getListStartValue(h,e))}},t.prototype.getListText=function(e,t,i){var n=i.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(e.abstractListId)))for(var r=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(e.abstractListId)),o=r.keys,s=0;s<o.length;s++){var l=o[s],d="%"+(l+1).toString(),h=this.getListLevel(e,l),c=s<t?"LeadingZero"!==h.listLevelPattern?"Arabic":h.listLevelPattern:void 0;if(n.match(d)){if(l>t)return"";n=r.containsKey(l)&&!(0,a.isNullOrUndefined)(h)?n.replace(d,this.getListTextListLevel(h,r.get(l),i.isLegalStyleNumbering?c:void 0)):n.replace(d,"0")}}return n},t.prototype.getAsLetter=function(e){var t=e/26,i=e%26;0===i&&(i=26,t--);for(var n=String.fromCharCode(64+i),r="";t>=0;)r+=n.toString(),t--;return r},t.prototype.getListTextListLevel=function(e,t,i){switch((0,a.isNullOrUndefined)(i)?e.listLevelPattern:i){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":case"Number":case"FarEast":case"Special":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"OrdinalText":return 3082===e.characterFormat.localeIdAscii||3082===this.documentHelper.characterFormat.localeIdAscii?this.getOrdinalTextInSpanish(!0,t.toString()).toUpperCase():this.getOrdinalText(!0,t.toString()).toUpperCase();case"Ordinal":return this.getAsOrdinal(t,e.characterFormat).toString();default:return""}},t.prototype.getFootEndNote=function(e,t){switch(e){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},t.prototype.generateNumber=function(e,t,i){for(var n="";e>=t;)e-=t,n+=i,this.value=e;return n.toString()},t.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},t.prototype.getAsRoman=function(e){var t="";return this.value=e,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),(t+=this.generateNumber(this.value,1,"I")).toString()},t.prototype.getOrdinalText=function(e,t){if(e){t=t.trim();for(var i=0;i<t.length;i++)if(/[a-zA-Z]/.test(t.charAt(i))){e=!1;break}e&&(t=this.numberToWords(parseInt(t),!1))}return t},t.prototype.numberToWords=function(e,t){if(0===e)return"zero";var i="";if(Math.floor(e/1e6)>0&&(i+=this.numberToWords(Math.floor(e/1e6),t)+" million ",t||e%10!=0||(i+="th "),e%=1e6),Math.floor(e/1e3)>0&&(i+=this.numberToWords(Math.floor(e/1e3),t)+" thousand ",t||e%10!=0||(i+="th "),e%=1e3),Math.floor(e/100)>0&&(i+=this.numberToWords(Math.floor(e/100),t)+" hundred ",t||e%10!=0||(i+="th "),e%=100),e>0){""!==i&&t&&(i+="and ");var n=null;n=t?["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"]:["","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"];e<20?i+=n[e]:((t||e%10>0)&&(i+=["","ten","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"][Math.floor(e/10)]),e%10!=0||t?e%10>0&&(i+="-"+n[e%10]):i+=["","tenth","twentieth","thirtieth","fortieth","fiftieth","sixtieth","seventieth","eightieth","ninetieth"][Math.floor(e/10)])}return i},t.prototype.getOrdinalTextInSpanish=function(e,t){if(e){t=t.trim();for(var i=0;i<t.length;i++)if(/[a-zA-Z]/.test(t.charAt(i))){e=!1;break}e&&(t=this.numberToSpanishWords(parseInt(t),!1))}return t},t.prototype.numberToSpanishWords=function(e,t){if(0===e&&t)return"cero";var i="";if(Math.floor(e/1e3)>0&&e<=1e4){i+=t?["","mil","dos mil","tres mil","cuatro mil","cinco mil","seis mil","siete mil","ocho mil","nueve mil","diez mil"][Math.floor(e/1e3)]:["","milésimo","dosmilésimo","tresmilésimo","cuatromilésimo","cincomilésimo","seismilésimo","sietemilésimo","ochomilésimo","nuevemilésimo","diezmilésimo"][Math.floor(e/1e3)],e%=1e3}if(Math.floor(e/100)>0){""!==i&&(i+=" ");i+=t?["","ciento","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"][Math.floor(e/100)]:["","centésimo","ducentésimo","tricentésimo","cuadringentésimo","quingentésimo","sexcentésimo","septingentésimo","octingentésimo","noningentésimo"][Math.floor(e/100)],e%=100}if(e>0&&e<100){""!==i&&(i+=" ");var n=null;n=t?["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciséis","diecisiete","dieciocho","diecinueve"]:["","primero","segundo","tercero","cuarto","quinto","sexto","séptimo","octavo","noveno","décimo","undécimo","duodécimo","decimotercero","decimocuarto","decimoquinto","decimosexto","decimoséptimo","decimoctavo","decimonoveno"];var r=["","diez","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],o=["","décimo","vigésimo","trigésimo","cuadragésimo","quincuagésimo","sexagésimo","septuagésimo","octogésimo","nonagésimo"];e<20?i+=n[e]:e>20&&e<30&&t?i+=["","veintiuno","veintidós","veintitrés","veinticuatro","veinticinco","veintiséis","veintisiete","veintiocho","veintinueve"][e%10]:((t&&e%10>0||t&&e%10==0)&&(i+=r[Math.floor(e/10)]),e%10>0&&!t&&(i+=o[Math.floor(e/10)]),e%10!=0||t?e%10>0&&(i+=t?" y "+n[e%10]:" "+n[e%10]):i+=o[Math.floor(e/10)])}return i},t.prototype.getAsOrdinal=function(e,t){switch(t.localeIdAscii){case 1069:case 8218:case 5146:case 4122:case 1050:case 1029:case 1061:case 1035:case 3079:case 1031:case 5127:case 4103:case 2055:case 1038:case 1060:case 1055:case 1044:case 2068:case 1045:case 6170:case 2074:return e.toString()+".";case 2060:case 11276:case 3084:case 9228:case 12300:case 1036:case 15372:case 5132:case 13324:case 6156:case 14348:case 8204:case 10252:case 4108:return 1==e?e.toString()+"er":e.toString()+"e";case 2067:case 1043:return e.toString()+"e";case 1032:return e.toString()+"o";case 1040:case 2064:return e.toString()+String.fromCharCode(176);case 5130:case 7178:case 12298:case 17418:case 4106:case 1046:case 2070:case 11274:case 16394:case 13322:case 9226:case 18442:case 2058:case 19466:case 6154:case 15370:case 10250:case 20490:case 3082:case 1034:case 21514:case 14346:case 8202:return e.toString()+String.fromCharCode(186);case 1049:case 2073:return e.toString()+"-"+String.fromCharCode(1081);case 2077:case 1053:return this.getOrdinalInSwedish(e);case 1027:return this.getOrdinalInCatalan(e);case 1030:return this.getOrdinalInDanish(e);default:return this.getOrdinalInEnglish(e)}},t.prototype.getOrdinalInEnglish=function(e){switch(e%100){case 11:case 12:case 13:return e.toString()+"th"}switch(e%10){case 1:return e.toString()+"st";case 2:return e.toString()+"nd";case 3:return e.toString()+"rd";default:return e.toString()+"th"}},t.prototype.getOrdinalInSwedish=function(e){return 11==e||12==e?e.toString()+":e":e%10==1||e%10==2?e.toString()+":a":e.toString()+":e"},t.prototype.getOrdinalInCatalan=function(e){switch(e){case 1:return e.toString()+".";case 2:return e.toString()+"n";case 3:return e.toString()+"r";case 4:return e.toString()+"t";case 14:return e.toString()+String.fromCharCode(232)+"h";default:return e.toString()+String.fromCharCode(232)}},t.prototype.getOrdinalInDanish=function(e){if(0==e)return e.toString()+"te";switch(e%100){case 0:return e.toString()+"ende";case 1:return e.toString()+"ste";case 2:return e.toString()+"nden";case 3:return e.toString()+"dje";case 4:return e.toString()+"rde";case 5:case 6:case 11:case 12:case 30:return e.toString()+"te";default:return e.toString()+"nde"}},t.prototype.getListLevel=function(e,t){if(!(0,a.isNullOrUndefined)(e)){var i=this.documentHelper.getAbstractListById(e.abstractListId);!(0,a.isNullOrUndefined)(e)&&i.levels.length<=t&&t>=0&&t<9&&this.addListLevels(i);var n=void 0;if(!(0,a.isNullOrUndefined)(e.levelOverrides)&&!(0,a.isNullOrUndefined)(n=this.getOverrideListLevel(e.levelOverrides,t))&&!(0,a.isNullOrUndefined)(n.overrideListLevel))return(0,a.isNullOrUndefined)(n.startAt)&&(n.overrideListLevel.startAt=i.levels[t].startAt),n.overrideListLevel;if(!(0,a.isNullOrUndefined)(i)&&t>=0&&t<i.levels.length)return i.levels[t]}},t.prototype.getOverrideListLevel=function(e,t){for(var i=0;i<e.length;i++)if(e[i].levelNumber==t)return e[i]},t.prototype.getTabWidth=function(e,t,i,n,r){var o=0,s=!1,l=e.paragraphFormat.getUpdatedTabs(),d=!1,h=e.bodyWidget.sectionFormat,c=(Pa.convertPointToPixel(h.leftMargin),!1);if(!(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat.listLevel)&&!(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat.listLevel.paragraphFormat)){var p=e.paragraphFormat.listFormat.listLevel.paragraphFormat;e.paragraphFormat.leftIndent!==p.leftIndent&&(d=!0)}var u=0,g=t.clientActiveArea.x,m=Pa.convertPointToPixel(e.paragraphFormat.firstLineIndent),f=Pa.convertPointToPixel(e.paragraphFormat.leftIndent);if(!(0,a.isNullOrUndefined)(r)&&n.isFirstLine()?(u=this.viewer.clientArea.x+m,d&&(g+=m)):u=this.viewer.clientArea.x,g<u&&("Word2003"!==this.documentHelper.compatibilityMode||0===l.length))return t.clientArea.x-t.clientActiveArea.x;for(var v=t.clientActiveArea.x-(t.clientArea.x-Pa.convertPointToPixel(e.paragraphFormat.leftIndent)),y=0;y<l.length;y++){var w=l[y],b=Pa.convertPointToPixel(w.position);b<f&&(c=parseFloat(v.toFixed(2))<parseFloat(b.toFixed(2)))}if(n.isFirstLine()&&f>0&&m<0&&(r instanceof md||!c)){if(t.clientArea.x-t.clientActiveArea.x>0)return t.clientArea.x-t.clientActiveArea.x;0===l.length&&e.paragraphFormat.listFormat&&e.paragraphFormat.listFormat.listLevel&&(l=e.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var C=Pa.convertPointToPixel(this.documentHelper.defaultTabWidth);if(0===l.length&&(v>0&&C>Math.round(v)&&d||C===this.defaultTabWidthPixel&&C>Math.round(v)&&v>0))return C-v;var x=!1;if(l.length>0){for(y=l.length-1;y>-1;y--){w=l[y];var I=Pa.convertPointToPixel(w.position);if(!(parseFloat(I.toFixed(2))>parseFloat(v.toFixed(2)))){if(y>0&&Pa.convertPointToPixel(l[y-1].position)>parseFloat(v.toFixed(2)))continue;if(y!=l.length-1){var k=this.getJustificationTabWidth(l[y+1],r,n,e,C,v,o);C=k.defaultTabWidth,o=k.fPosition,v=k.position,s=!0}x=!0;break}}if(!x){var F=this.getJustificationTabWidth(l[0],r,n,e,C,v,o);C=F.defaultTabWidth,o=F.fPosition,v=F.position,s=!0}}if(!s){var P=parseFloat((100*v%(100*C)/100).toFixed(2));P<0&&d&&(P+=C),o=((v-P)/C+1)*C}return parseFloat(o.toFixed(1))===parseFloat(v.toFixed(1))?C:o-v>0?o-v:C},t.prototype.getJustificationTabWidth=function(e,t,i,n,r,o,s){var l=t?this.documentHelper.textHelper.getTextSize(t,t.characterFormat):0;if("Left"===e.tabJustification||"List"===e.tabJustification)s=Pa.convertPointToPixel(e.position),t instanceof ed&&(t.tabLeader=e.tabLeader,t.tabText="");else{var d=Pa.convertPointToPixel(e.position)-o,h=this.getRightTabWidth(t.indexInOwner+1,i,n);if(h<d&&"Decimal"!=e.tabJustification)if("Right"===e.tabJustification){r=d-h;var c=Pa.convertPointToPixel(n.rightIndent),p=this.viewer.clientActiveArea.width+c-r;this.viewer.clientActiveArea.width+=c,p<0?r+=p-h:h>p&&(r-=h-p)}else r=d-h/2;else if("Center"===e.tabJustification&&h/2<d)r=d-h/2;else if("Decimal"===e.tabJustification)if(!(0,a.isNullOrUndefined)(t.nextElement)&&t.nextElement instanceof Zl){var u=t.nextElement;if(-1!=u.text.indexOf(".")){var g=u.text.indexOf("."),m=u.text.substring(0,g);r=d-this.documentHelper.textHelper.getWidth(m,u.characterFormat,u.scriptType)}else r=h<d?d-h:d}else r=d;else r="Right"===e.tabJustification?0:l;s=o,t instanceof ed&&(t.tabLeader=e.tabLeader,t.tabText="")}return{defaultTabWidth:r,fPosition:s,position:o}},t.prototype.getRightTabWidth=function(e,t,i){for(var n=0,r=!1,o=t.children[e];o;){if(o instanceof _l||o instanceof td||r)o instanceof _l&&(0===o.fieldType?r=!0:2===o.fieldType&&(r=!1)),o.width=0;else{if(o instanceof $l&&!this.isTocField(o.fieldBegin)){var s=this.documentHelper.getFieldResult(o.fieldBegin,o.paragraph.bodyWidget.page);""!==s&&(o.text=s)}o instanceof Zl&&this.documentHelper.textHelper.getTextSize(o,o.characterFormat)}if(o instanceof Zl&&"\t"===o.text)return n;n=o instanceof hd&&"Inline"!==o.textWrappingStyle?n:n+o.width,o=o.nextNode}return n},t.prototype.getSplitIndexByWord=function(e,t,i,n,r){for(var o=0,s=t.length;o<s;){var a=this.getTextIndexAfterSpace(t,o);0!==a&&a!==s||(a=s-1);var l=i;if((a<s-1||a===s-1&&" "===t[a-1])&&o!==a&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,a),n,r)),!(l<=e)){0===o&&" "===t[0]&&(o=this.getTextIndexAfterSpace(t,0));break}o=a}return o},t.prototype.getTextSplitIndexByCharacter=function(e,t,i,n,r,o){for(var s=i.length,a=0;a<s;a++){var l=n;if(a+1<s&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a+1),r,o)),l>t)return 0===a&&l>e?s>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:" "===i[a]?this.getTextIndexAfterSpace(i,a):a}return 0},t.prototype.getSubWidth=function(e,t,i,n,r){var o=0,s=!0,a="",l=0,d=e.paragraph.paragraphFormat.bidi;if(this.wrapPosition.length>0){var h=this.getSubWidthBasedOnTextWrap(e,t,i,n,r);if(h.length>0)return h}for(var c=e.renderedElements,p=c.length-1;p>=0;p--){var u=c[p];if(u.width>0&&u instanceof Zl){var g=u.text;if(a=g+a,t&&d&&(s=" "===g&&p-1>=0&&" "===c[p-1].text),!s||""===g.trim()&&"\t"!==g)s?l+=u.width:o+=u.width;else{if(Pa.endsWith(g)){var m=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(g,u.characterFormat,u.scriptType);o+=m,l+=u.width-m}else o+=u.width;s=!1}}else{if(a="a"+a,s=!1,u instanceof dd&&"Inline"!==u.textWrappingStyle)continue;o+=u.width}t||(o=Math.round(o))}var f=a.length-Pa.removeSpace(a).length;i=(a=a.trim()).length-Pa.removeSpace(a).length;var v=this.viewer.clientArea.width-n-o,y=this.viewer.clientArea.width-n-(o+l);return d&&t&&(y<0?l=-l:v=y),v<=0&&!this.is2013Justification||0===i&&t&&!d?(i=0,v=0):t?!r&&i>0||r&&this.is2013Justification&&i>0?v/=i:i=0:l>0&&d&&r&&(v-=l),[{trimmedSpaceWidth:l,subWidth:v,spaceCount:i,totalSpaceCount:f}]},t.prototype.getSubWidthBasedOnTextWrap=function(e,t,i,n,r){for(var o=[],s=0,l="",d=this.wrapPosition.length-1,h=!0,c=e.children.length-1;c>=0;c--){var p=e.children[c];if(p.width>0&&p instanceof Zl){var u=p.text;l=u+l,!h||""===u.trim()&&"\t"!==u?h||(s+=p.width):(Pa.endsWith(u)?s+=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(u,p.characterFormat,p.scriptType):s+=p.width,h=!1)}else l="a"+l,h=!1,p instanceof dd&&"Inline"!==p.textWrappingStyle||(s+=p.width);if((p.padding.left>0||0===c)&&d>=0){for(var g=this.wrapPosition[d--];g.width<=0&&d>=0;)g=this.wrapPosition[d--];var m=this.getSubWidthInfo(e,g.width,s,l,i,t,r);(0,a.isNullOrUndefined)(m)||(s=0,l="",o.unshift(m))}}return o},t.prototype.isWordFittedByJustification=function(e,t){var i=e.line,n=i.paragraph.paragraphFormat,r=n.textAlignment,o=i.isLastLine(),s=0;i.isFirstLine()&&(s=Pa.convertPointToPixel(n.firstLineIndent));var l=this.viewer.clientActiveArea.width;if(0!=t&&l>=t/2){var d=0,h=void 0,c=0;if("Left"!==r&&this.viewer.textWrap&&("Justify"!==r||!o||"Justify"===r&&n.bidi||this.is2013Justification&&o)&&(d=(h=this.getSubWidth(i,"Justify"===r,d,s,o))[0].spaceCount,c=h[0].totalSpaceCount),!(0,a.isNullOrUndefined)(h)&&1==h.length&&l>0&&"Justify"===r&&"Word2013"===this.documentHelper.compatibilityMode&&!this.is2013Justification&&0===n.rightIndent&&0===n.leftIndent){var p=0,u=this.getTotalSpaceWidth(i,c),g=u/c;if(l+(p=((l+u)/c-g)/g*100<=33?u/8:u/4)>=t)return this.viewer.clientActiveArea.x-=p,this.viewer.clientActiveArea.width+=p,this.is2013Justification=!0,!0}}return!1},t.prototype.getTotalSpaceWidth=function(e,t){var i=0,n=0;if(e)for(var r=0;r<e.children.length;r++){var o=e.children[r];if(o instanceof Zl){var s=o.text.length-Pa.removeSpace(o.text).length;if(s>0)i+=s*this.documentHelper.textHelper.getWidth(" ",o.characterFormat,o.scriptType),n+=s}if(!(0,a.isNullOrUndefined)(t)&&n>=t)break}return i},t.prototype.getSubWidthInfo=function(e,t,i,n,r,o,s){if(t>0){var a=t-i;r=(n=n.trim()).length-Pa.removeSpace(n).length;var l=a;return l<=0||0===r&&o&&!e.paragraph.paragraphFormat.bidi?(r=0,l=0):o&&(!s&&r>0?l/=r:r=0),{trimmedSpaceWidth:0,subWidth:l,spaceCount:r,totalSpaceCount:r}}},t.prototype.getBeforeSpacing=function(e,t){var i=0;if(this.documentHelper.dontUseHtmlParagraphAutoSpacing)i=e.paragraphFormat.beforeSpacing;else{var n=e.previousWidget;if(n instanceof Rl){var r=this.getAfterSpacing(n),o=e.paragraphFormat.beforeSpacing;e.paragraphFormat.spaceBeforeAuto&&(o=14),r<o&&(i=o-r)}else n instanceof Al?i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing:t>0&&e===e.bodyWidget.childWidgets[0]?this.documentHelper.pages[t].sectionIndex!==this.documentHelper.pages[t-1].sectionIndex&&(i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing):i=e.paragraphFormat.spaceBeforeAuto?0:e.paragraphFormat.beforeSpacing}return this.isSameStyle(e,!1)?0:Pa.convertPointToPixel(i)},t.prototype.getAfterSpacing=function(e){var t=e.paragraphFormat.afterSpacing;return!this.documentHelper.dontUseHtmlParagraphAutoSpacing&&e.paragraphFormat.spaceAfterAuto&&(t=(0,a.isNullOrUndefined)(e.nextWidget)&&e.isInsideTable?0:14),this.isSameStyle(e,!0)?0:t},t.prototype.getLineSpacing=function(e,t,i){if((0,a.isNullOrUndefined)(e.paragraphFormat))return 0;var n=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":n=Pa.convertPointToPixel(e.paragraphFormat.lineSpacing);break;default:n=e.paragraphFormat.lineSpacing,i&&(n-=1),n*=t}return n},t.prototype.isParagraphFirstLine=function(e,t){var i=e;return!(!(0,a.isNullOrUndefined)(i.childWidgets)&&0!==i.childWidgets.indexOf(t))&&(!(t.children.length>0&&!(0,a.isNullOrUndefined)(e.previousWidget)&&e.previousWidget instanceof Rl)||t.paragraph.index!==e.previousWidget.index)},t.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,i=t.childWidgets[t.childWidgets.length-1],n=i.children[i.children.length-1];return e===n&&(n instanceof _l||!(n instanceof Zl&&"\v"===n.text))},t.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,n=0,r=0;n=e.indexOf(" ",t)+1,1==(r=e.indexOf("-",t)+1)&&(r=e.indexOf("-",r+1)+1),r>0&&n>0?n=Math.min(n,r):r>0&&0==n&&(n=r);var o=n;if(0===o||o===i)return o;for(;" "===e[o]&&++o!==i;);return o},t.prototype.moveNextWidgetsToTable=function(e,t,i){var n=t.indexInOwner,r=e[e.length-1];i&&(n+=1);for(var o=t.containerWidget.childWidgets.splice(n),s=0;s<o.length;s++)r.childWidgets.push(o[s]),o[s].containerWidget=r},t.prototype.addTableCellWidget=function(e,t,i,n){var r,o=0,s=0,l=i,d=0,h=n;if((0,a.isNullOrUndefined)(e.cellFormat)||(e.cellFormat.containsMargins()?(s=(0,a.isNullOrUndefined)(e.cellFormat.leftMargin)?Pa.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):Pa.convertPointToPixel(e.cellFormat.leftMargin),d=(0,a.isNullOrUndefined)(e.cellFormat.rightMargin)?Pa.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):Pa.convertPointToPixel(e.cellFormat.rightMargin)):(s=0===e.columnIndex&&e.ownerRow.rowFormat.hasValue("leftMargin")?Pa.convertPointToPixel(e.ownerRow.rowFormat.leftMargin):Pa.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),d=e.columnIndex===e.ownerTable.tableHolder.columns.length-1&&e.ownerRow.rowFormat.hasValue("rightMargin")?Pa.convertPointToPixel(e.ownerRow.rowFormat.rightMargin):Pa.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),0===(r=(0,a.isNullOrUndefined)(e.ownerTable)||(0,a.isNullOrUndefined)(e.ownerTable.tableFormat)?0:Pa.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))&&e.ownerTable.isContainInsideTable&&!e.ownerTable.header){var c=Vl.getCellTopBorder(e);0===e.topMargin&&.75===c.lineWidth&&(l+=Pa.convertPointToPixel(.5));var p=Vl.getCellLeftBorder(e);e.leftMargin<=.5&&.75===p.lineWidth&&(s+=Pa.convertPointToPixel(.8))}e.margin=new El(s,l,d,h);e.ownerTable.tableFormat.allowAutoFit;var u=e.cellFormat.cellWidth;if("Percent"===e.cellFormat.preferredWidthType&&0!==e.cellFormat.preferredWidth&&u<=0){var g=Pa.convertPointToPixel(e.ownerTable.getTableClientWidth(e.ownerTable.getContainerWidth()));u=e.ownerTable.getCellWidth(e.cellFormat.preferredWidth,e.cellFormat.preferredWidthType,g,e)}e.width=Pa.convertPointToPixel(u),(0,a.isNullOrUndefined)(e.previousWidget)||(o=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan);var m=0;o<e.columnIndex&&(m=Pa.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(o,e.columnIndex)),0===o&&(m-=r/2)),e.x=t.x+m+e.margin.left,e.y=t.y+e.margin.top+r,e.width=e.width-e.margin.left-e.margin.right,r>0&&(e.x+=r,1===e.ownerTable.tableHolder.columns.length?e.width-=2*r:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?e.width-=2*r-r/2:e.width-=r);var f=Pa.convertPointToPixel(Vl.getCellLeftBorder(e).getLineWidth()),v=Pa.convertPointToPixel(Vl.getCellRightBorder(e).getLineWidth()),y=!1;e.leftBorderWidth=e.ownerTable.isBidiTable?v:f;var w="None"===e.cellFormat.borders.left.lineStyle,b="None"===e.cellFormat.borders.right.lineStyle;e.x+=w?e.leftBorderWidth>0?0:e.leftBorderWidth:0,e.width-=w?e.leftBorderWidth>0?0:e.leftBorderWidth:0;e.ownerTable.isBidiTable?e.cellIndex:(e.cellIndex,e.ownerRow.childWidgets.length);return(r>0||e.columnIndex===e.ownerTable.tableHolder.columns.length-1||e.index===e.containerWidget.childWidgets.length-1)&&(e.rightBorderWidth=e.ownerTable.isBidiTable?f:v,e.ownerTable.tableFormat.allowAutoFit||(e.width-=e.rightBorderWidth),this.isInsertTable()||(y=this.checkPreviousMargins(e.ownerTable))),e.margin.right+=b&&!y?0:e.rightBorderWidth,e},t.prototype.checkPreviousMargins=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++){if("None"!==i.childWidgets[i.childWidgets.length-1].cellFormat.borders.right.lineStyle)return!0}return!1},t.prototype.addWidgetToTable=function(e,t,i,n,r,o,s,l,d){var h=t[0],c=h.childWidgets.length,p=void 0,u=i.indexOf(n),g=[];if(u>0?p=i[u-1]:n.previousRenderedWidget instanceof Ul&&n.previousRenderedWidget.ownerTable.equals(n.ownerTable)&&(p=n.previousRenderedWidget),!(0,a.isNullOrUndefined)(p)){if(c=(h=p.containerWidget).childWidgets.indexOf(p)+1,Math.round(n.y)!==Math.round(p.y+p.height)){var m=t.indexOf(h);m+1>=t.length&&this.addTableWidget(e.clientActiveArea,t,!0),c=(h=t[m+1]).childWidgets.length}u>0&&(c=0)}if(this.updateRowHeightBySpannedCell(h,n,c),this.updateRowHeightByCellSpacing(t,n,e),n.containerWidget&&n.containerWidget!==h&&-1!==n.containerWidget.childWidgets.indexOf(n)&&n.containerWidget.childWidgets.splice(n.containerWidget.childWidgets.indexOf(n),1),-1===h.childWidgets.indexOf(n)&&(h.childWidgets.splice(c,0,n),d&&(h.bodyWidget.page.repeatHeaderRowTableWidget=!0)),n.containerWidget=h,!n.ownerTable.isInsideTable){if(r.length>0)(0,a.isNullOrUndefined)(r)||(g=this.getFootnoteBody(r));else if(!(0,a.isNullOrUndefined)(n))for(var f=0;f<n.childWidgets.length;f++)for(var v=n.childWidgets[f],y=0;y<v.childWidgets.length;y++)for(var w=this.getFootNoteWidgetsOf(v.childWidgets[y],!0),b=0;b<w.length;b++)g.splice(g.length,0,w[b]);g.length>0&&(0,a.isNullOrUndefined)(g[0].containerWidget)?this.layoutFootnoteInSplittedRow(n,g):!(0,a.isNullOrUndefined)(g)&&g.length>0&&void 0!==n.bodyWidget.previousRenderedWidget&&l!==n.bodyWidget.page.index&&g[0].containerWidget.page.index!==n.bodyWidget.page.index?this.moveFootNotesToPage(g,g[0].containerWidget.page.bodyWidgets[0],n.bodyWidget):g.length>0&&!this.isInitialLoad&&!(0,a.isNullOrUndefined)(n.bodyWidget.page.footnoteWidget)&&this.layoutfootNote(n.bodyWidget.page.footnoteWidget),r.length=0}h.height=h.height+n.height,this.viewer instanceof kl&&((0,a.isNullOrUndefined)(h.containerWidget)||!(h.containerWidget.childWidgets.indexOf(h)>=0)||h.containerWidget instanceof Bl||(h.containerWidget.height+=n.height)),this.updateHeightForRowWidget(e,!1,t,i,n,!1,o,s),e.cutFromTop(n.y+n.height),this.viewer.clientActiveArea.height-=this.getFootNoteHeight(g),n.ownerTable.isInsideTable||(this.existFootnoteHeight=0)},t.prototype.layoutFootnoteInSplittedRow=function(e,t){if(t&&t.length>0){(0,a.isNullOrUndefined)(e.ownerTable.bodyWidget.page.footnoteWidget)&&this.addEmptyFootNoteToBody(e.ownerTable.bodyWidget);var i=e.ownerTable.bodyWidget.page.footnoteWidget;if(i){for(var n=0;n<t.length;n++)i.bodyWidgets.push(t[n]),t[n].containerWidget=i;this.layoutfootNote(i)}}},t.prototype.getFootNoteHeight=function(e){var t=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)t+=this.getFootnoteHeightInternal(e[i],i);else t=this.getFootnoteHeightInternal(e,0);return t},t.prototype.getFootnoteHeightInternal=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++)i+=e.childWidgets[n].height,(0===e.indexInOwner||-1!==e.indexInOwner&&e.containerWidget&&0===this.existFootnoteHeight&&0===t)&&0===n&&(i+=e.containerWidget.margin.top);return i},t.prototype.updateRowHeightBySpannedCell=function(e,t,i){var n=1;if(0!==e.childWidgets.length&&0!==i){for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];n=(0,a.isNullOrUndefined)(o)||(0,a.isNullOrUndefined)(o.cellFormat)?n:o.cellFormat.rowSpan,this.updateSpannedRowCollection(n,t,o)}if(!(0,a.isNullOrUndefined)(t.ownerTable))for(r=0;r<t.ownerTable.spannedRowCollection.length;r++)if(t.ownerTable.spannedRowCollection.keys[r]===t.index){for(var s=0;s<i;s++){var l=e.childWidgets[s];this.updateRowHeight(l,t)}t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[r]);break}}else this.updateRowHeight(t,t)},t.prototype.updateRowHeight=function(e,t){for(var i=t.index,n=1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(n=(0,a.isNullOrUndefined)(o)||(0,a.isNullOrUndefined)(o.cellFormat)?n:o.cellFormat.rowSpan,this.updateSpannedRowCollection(n,t,o),i-o.rowIndex==n-1){var s=o.y+o.height+o.margin.bottom-t.y;("Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>s)&&t.height<s&&(t.height=s)}}},t.prototype.updateSpannedRowCollection=function(e,t,i){e>1&&!(0,a.isNullOrUndefined)(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+e-1)||t.ownerTable.spannedRowCollection.add(t.index+e-1,t.index))},t.prototype.updateRowHeightByCellSpacing=function(e,t,i){t.ownerTable.tableFormat.cellSpacing>0&&e.length>1&&t.y===i.clientArea.y&&i instanceof kl&&(t.height=t.height-Pa.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},t.prototype.isRowSpanEnd=function(e,t){for(var i=e.index,n=1,r=0;r<this.documentHelper.splittedCellWidgets.length;r++){var o=this.documentHelper.splittedCellWidgets[r];if(n=(0,a.isNullOrUndefined)(o)||(0,a.isNullOrUndefined)(o.cellFormat)?n:o.cellFormat.rowSpan,i-o.rowIndex==n-1)return!0}return!1},t.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t<n.columnIndex)return!0;t+=n.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},t.prototype.splitWidgets=function(e,t,i,n,r,o,s,a,l,d,h){if((!d||0!==a)&&this.isFirstLineFitForRow(t.clientArea.bottom,e)&&e.childWidgets.length>0){if(r=this.getSplittedWidgetForRow(t.clientArea.bottom,i,n,e,s,a,d,void 0,h),s=[],this.documentHelper.splittedCellWidgets.length>0||r!==e){if(o)for(var c=0;c<r.childWidgets.length;c++){r.childWidgets[c].rowIndex!==r.index&&(r.childWidgets.splice(c,1),c--)}this.insertSplittedCellWidgets(t,i,r,e.index-1)}}else this.insertSplittedCellWidgets(t,i,r,e.index-1);return r},t.prototype.getSplittedWidgetForRow=function(e,t,i,n,r,o,s,l,d){var h=void 0,c=n.index;this.isRelayoutneed=!1;for(var p=!1,u=n.height,g=u,m=0,f=0;f<n.childWidgets.length;f++){var v=n.childWidgets[f];if(0===f&&v.childWidgets.length>0&&0===v.columnIndex&&1===v.cellFormat.rowSpan&&"Word2013"===this.documentHelper.compatibilityMode&&0===this.documentHelper.splittedCellWidgets.length&&1===i.length){var y=this.documentHelper.getFirstParagraphInCell(v);if(!(0,a.isNullOrUndefined)(y)&&y.paragraphFormat.keepWithNext&&!(0,a.isNullOrUndefined)(this.getPreviousBlock(n)))return n}var w=this.getSplittedWidget(e,!0,t,i,v,r,o,s,l);if(s&&!(0,a.isNullOrUndefined)(w)&&0!==w.childWidgets.length&&u>v.height&&(u=v.height),!(0,a.isNullOrUndefined)(r)&&r.length>0)for(var b=0;b<r.length;b++)-1===r[b].paragraph.containerWidget.indexInOwner&&r.splice(b,1);if((0,a.isNullOrUndefined)(w)&&v===n.childWidgets[n.childWidgets.length-1]&&this.isRowSpanEnd(n,this.viewer)&&this.documentHelper.splittedCellWidgets.length>0&&d&&(h=this.getSplittedWidgetForSpannedRow(e,n,t,i,r),w=void 0),!(0,a.isNullOrUndefined)(w)){if(w===v)return i.length>1&&this.combineSplittedRowWidgets(i,g),n;var C=0;if(v.ownerTable.isInsideTable)for(var x=0;x<v.childWidgets.length;x++)C+=v.childWidgets[x].height;v.ownerTable.isInsideTable?m<C&&(m=C):v.height>m&&(m=v.height),-1!==n.childWidgets.indexOf(w)&&n.childWidgets.splice(n.childWidgets.indexOf(w),1),n.height-=w.height,(0===f||n.height<m+v.margin.top+v.margin.bottom)&&(n.height=m+v.margin.top+v.margin.bottom),(0,a.isNullOrUndefined)(h)&&((h=new Ul).containerWidget=n.containerWidget,h.index=n.index,h.rowFormat=n.rowFormat,h.isRenderBookmarkEnd=n.isRenderBookmarkEnd,this.updateWidgetLocation(n,h),i.push(h));var I=1;I=(0,a.isNullOrUndefined)(w)||(0,a.isNullOrUndefined)(w.cellFormat)?I:w.cellFormat.rowSpan,c-w.rowIndex==I-1&&h.height<w.height+w.margin.top+w.margin.bottom?h.height=w.height+w.margin.top+w.margin.bottom:("Exactly"===n.rowFormat.heightType||"AtLeast"===n.rowFormat.heightType&&h.height<n.rowFormat.height)&&(h.height=n.rowFormat.height),h.childWidgets.push(w),w.containerWidget=h,this.isRelayoutneed=!0;for(var k=f;k>0&&!p;){var F=n.childWidgets[k-1];w=this.getSplittedWidget(e,!0,t,i,F,r),h.childWidgets.splice(0,0,w),w.containerWidget=h,k--}p=!0}}if(s&&u!==g){for(f=0;f<n.childWidgets.length;f++)n.childWidgets[f].height=u;n.height=u}return h},t.prototype.combineSplittedRowWidgets=function(e,t){for(var i=e[0],n=1;n<e.length;n++){for(var r=e[n],o=0;o<r.childWidgets.length;o++){var s=i.childWidgets[o],a=r.childWidgets[o];if(a.childWidgets.length>0)for(var l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l];if(d instanceof Rl){var h=s.childWidgets[l];if(h.index===d.index){var c=d;if(c.childWidgets.length>0)for(var p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p];h.childWidgets.push(u),u.paragraph=h,h.height+=u.height}}else s.childWidgets.push(d),d.containerWidget=s;s.height+=d.height}else d instanceof Al&&(s.childWidgets.push(d),d.containerWidget=s,s.height+=d.height)}}e.splice(n,1)}i.height=t},t.prototype.getSplittedWidgetForSpannedRow=function(e,t,i,n,r){for(var o=void 0,s=void 0,l=!1,d=!1,h=0;h<this.documentHelper.splittedCellWidgets.length;h++){s=this.documentHelper.splittedCellWidgets[h];for(var c=this.documentHelper.splittedCellWidgets[h+1],p=(0,a.isNullOrUndefined)(c)?0:c.columnIndex,u=this.documentHelper.splittedCellWidgets[h].columnIndex,g=this.documentHelper.splittedCellWidgets[h];g&&g.cellFormat.rowSpan===this.documentHelper.splittedCellWidgets[h].cellFormat.rowSpan&&u>0&&!l;){u=g.columnIndex,g=(f=g.containerWidget).getCell(f.rowIndex,u-1)}var m=this.documentHelper.splittedCellWidgets[h].columnIndex;for(g=this.documentHelper.splittedCellWidgets[h];g&&g.cellFormat.rowSpan===this.documentHelper.splittedCellWidgets[h].cellFormat.rowSpan&&m<g.containerWidget.childWidgets.length-1&&(!l||d);){var f;m=g.columnIndex,g=(f=g.containerWidget).getCell(f.rowIndex,m+1)}for((0,a.isNullOrUndefined)(o)&&((o=new Ul).containerWidget=t.containerWidget,o.index=t.index,o.rowFormat=t.rowFormat,o.isRenderBookmarkEnd=t.isRenderBookmarkEnd,this.updateWidgetLocation(t,o),n.push(o)),o.childWidgets.push(s),s.containerWidget=o,this.isRelayoutneed=!0;u>0&&!l;){var v=t.getCell(t.index,u-1);(0,a.isNullOrUndefined)(v)?u--:(s=this.getSplittedWidget(e,!0,i,n,v,r),o.childWidgets.splice(0,0,s),s.containerWidget=o,u--)}for(;m<t.childWidgets[t.childWidgets.length-1].columnIndex&&(!l||d);){v=t.getCell(t.index,m+1);if((0,a.isNullOrUndefined)(v))m++;else{if(c&&v.columnIndex>p){d=!0;break}s=this.getSplittedWidget(e,!0,i,n,v,r),o.childWidgets.push(s),s.containerWidget=o,m++}}l=!0}return o},t.prototype.getFootNoteHeightInLine=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];n instanceof Yl&&(t+=this.getFootNoteHeight(n.bodyWidget))}return t},t.prototype.getFootnoteFromLine=function(e,t){for(var i=0;i<e.children.length;i++)e.children[i]instanceof Yl&&t.push(e.children[i])},t.prototype.updateWidgetsToTable=function(e,t,i,n,r,o,s){var l,d=i.bodyWidget.page.index,h=this.getRowHeight(i,[i]),c=this.viewer,p=i.rowFormat.isHeader,u=void 0,g=i.rowFormat.allowBreakAcrossPages,m=i.rowFormat.heightType,f=0,v=i,y=!1,w=this.layoutedFootnoteElement,b=!1;void 0!==v.bodyWidget.page.footnoteWidget?(this.footHeight=this.getFootNoteHeight(v.bodyWidget.page.footnoteWidget.bodyWidgets),0===this.footnoteHeight&&(this.footnoteHeight=this.footHeight)):this.footHeight=0,i.ownerTable.continueHeader&&!p&&(i.ownerTable.continueHeader=!1);var C=i.ownerTable.isInsideTable,x=!1;for(l=(0,a.isNullOrUndefined)(i.ownerTable)||(0,a.isNullOrUndefined)(i.ownerTable.tableFormat)?0:Pa.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);f<t.length;){if(f=t.length,this.isRowSpanEnd(i,c)&&"Exactly"===i.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),!s&&(i.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&v.y+v.height+l+this.footHeight<=c.clientArea.bottom))!this.isVerticalMergedCellContinue(i)||v.y!==c.clientArea.y&&v.y!==this.viewer.clientArea.y+v.ownerTable.headerHeight||this.insertSplittedCellWidgets(c,e,v,v.index-1),this.addWidgetToTable(c,e,t,v,w,void 0,C,d,b),!(0,a.isNullOrUndefined)(i.bodyWidget)&&i.bodyWidget instanceof Ol&&this.documentHelper.splittedCellWidgets.length>0&&(0,a.isNullOrUndefined)(t[t.length-1].nextRow)?(f--,x=!0):!(0,a.isNullOrUndefined)(i.bodyWidget)&&i.bodyWidget instanceof Ol&&this.documentHelper.splittedCellWidgets.length>0&&!(0,a.isNullOrUndefined)(t[t.length-1].nextRow)&&!this.isRowSpanEnd(t[t.length-1].nextRow,c)&&f--,C=!1;else{if(w=[],C=!1,this.documentHelper.splittedCellWidgets.length>0&&v.y+v.height+this.footHeight<=c.clientArea.bottom)if(!this.isRowSpanEnd(i,c)){!this.isVerticalMergedCellContinue(i)||v.y!==c.clientArea.y&&v.y!==this.viewer.clientArea.y+v.ownerTable.headerHeight||(this.insertSplittedCellWidgets(c,e,v,v.index-1,!0),this.updateChildLocationForRow(v.y,v)),this.addWidgetToTable(c,e,t,v,w);continue}var I=v,k=e[e.length-1];if(s||h+v.y+this.footHeight>c.clientArea.bottom)if(!g||p&&i.ownerTable.continueHeader||"AtLeast"===m&&Pa.convertPointToPixel(i.rowFormat.height)<c.clientArea.bottom){var F=!g&&(0,a.isNullOrUndefined)(v.previousWidget)&&e.length>1;if("AtLeast"===m&&Pa.convertPointToPixel(i.rowFormat.height)<c.clientActiveArea.height&&(g||F)||"Exactly"!==m&&v.y===c.clientArea.y||"Auto"===m&&g?(I=this.splitWidgets(v,c,e,t,I,x,w,r,o,s),(0,a.isNullOrUndefined)(I)&&v.y===c.clientArea.y?this.addWidgetToTable(c,e,t,v,w):(0,a.isNullOrUndefined)(I)&&"AtLeast"===m&&v.containerWidget.lastChild!==v&&(I=v)):"AtLeast"===m&&Pa.convertPointToPixel(i.rowFormat.height)>c.clientActiveArea.height&&this.documentHelper.splittedCellWidgets.length>0&&this.isRowSpanEnd(i,c)&&this.insertSplittedCellWidgets(c,e,v,v.index-1),"Exactly"===m&&v.y===c.clientArea.y&&(this.addWidgetToTable(c,e,t,v,w),f++),p&&i.ownerTable.continueHeader){i.ownerTable.header=!1,i.ownerTable.headerHeight=0;var P=void 0;if(c instanceof kl&&(P=this.documentHelper.pages),!(0,a.isNullOrUndefined)(P))for(var S=0;S<P.length;S++)!P[S].repeatHeaderRowTableWidget||(0,a.isNullOrUndefined)(P[S].bodyWidgets[0].firstChild)||P[S].bodyWidgets[0].firstChild instanceof Al&&P[S].bodyWidgets[0].firstChild.header||(P[S].repeatHeaderRowTableWidget=!1,i.ownerTable.continueHeader=!1)}}else if("Auto"!==m&&"AtLeast"!==m||!g)"Exactly"===m&&v.y===c.clientArea.y&&(this.addWidgetToTable(c,e,t,v,w),f++);else if(Pa.convertPointToPixel(i.rowFormat.height)>c.clientArea.bottom&&v.y!==c.clientArea.y){if("AtLeast"===m&&Pa.convertPointToPixel(i.rowFormat.height)>c.clientArea.bottom&&v.ownerTable.wrapTextAround&&v.y-Pa.convertPointToPixel(v.ownerTable.positioning.verticalPosition)===c.clientArea.y&&v.bodyWidget.firstChild===v.ownerTable&&(I=this.splitWidgets(v,c,e,t,I,x,w,r,o,s),(0,a.isNullOrUndefined)(I))){this.addWidgetToTable(c,e,t,v,w),f++;continue}}else I=this.splitWidgets(v,c,e,t,I,x,w,r,o,s),(0,a.isNullOrUndefined)(I)&&v.y===c.clientArea.y&&this.addWidgetToTable(c,e,t,v,w);else{var T=!1,H=0;if((0,a.isNullOrUndefined)(v.ownerTable.headerHeight)||(H=v.ownerTable.headerHeight),this.isVerticalMergedCellContinue(i)&&(g||(T=v.y===c.clientArea.y||v.y===this.viewer.clientArea.y+H))){if(T)this.insertSplittedCellWidgets(c,e,I,v.indexInOwner-1);else if(I=this.splitWidgets(v,c,e,t,I,x,w,void 0,void 0,void 0,!0),(0,a.isNullOrUndefined)(I)){if(T=v.y===c.clientArea.y||v.y===this.viewer.clientArea.y+H){this.insertSplittedCellWidgets(c,e,v,v.indexInOwner-1),f--;continue}this.isRowSpanEnd(i,c)&&(I=v)}}else x&&!g?I=this.splitWidgets(v,c,e,t,I,x,w):this.isRowSpanEnd(i,c)&&!g&&("AtLeast"===m&&i.ownerTable.spannedRowCollection.keys.length>0&&(I=this.splitWidgets(v,c,e,t,I,x,w,r,o,s,!0)),(0,a.isNullOrUndefined)(I)&&this.addWidgetToTable(c,e,t,v,w))}if(!(0,a.isNullOrUndefined)(I)&&((0,a.isNullOrUndefined)(this.documentHelper.owner.editorModule)||this.documentHelper.owner.editorModule&&!this.documentHelper.owner.editorModule.isTableInsert)&&!(I.bodyWidget.containerWidget instanceof Dl)){if(I!==v){this.addWidgetToTable(c,e,t,v,w,v.nextRow,void 0,void 0,b),this.updateWidgetsToPage(e,t,i.ownerTable,n,v.nextRow),e.indexOf(v.containerWidget)+1>=e.length&&this.addTableWidget(c.clientActiveArea,e,!0),v=I}else{if(i.index>0)if(this.updateWidgetsToPage(e,t,i.ownerTable,n,i),i.previousRenderedWidget instanceof Ul){var E=i.previousRenderedWidget;if(Pa.round(v.y,2)===Pa.round(E.y+E.height,2))e.indexOf(E.containerWidget)+1>=e.length&&this.addTableWidget(c.clientActiveArea,e,!0);else this.addTableWidget(c.clientActiveArea,e,!0)}else this.addTableWidget(c.clientActiveArea,e,!0);else if("Exactly"===m&&h+v.y+this.footHeight<c.clientArea.bottom&&v.y>=c.clientArea.y){this.addWidgetToTable(c,e,t,v,w),f++;continue}y=!0,f--}k=e[e.length-1];var N=i,W=!1,O=(i.ownerTable.containerWidget.index,!1),B=void 0,L=void 0;L=y&&1===e.length?e[e.length-1]:e[e.length-2];var D=!0;if(y&&1===t.length){var R=this.alignBlockElement(i);if(!(0,a.isNullOrUndefined)(R.node)){var M=R.node;if(M instanceof Ul&&0===M.indexInOwner)e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),(k=e[e.length-1]).height=0);else if(R.node instanceof Rl){L=this.splitParagraph(R.node,parseInt(R.position.index,10)),e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),k=e[e.length-1]),D=!1}M instanceof Ul&&(O=0===M.indexInOwner,(N=M).ownerTable.equals(i.ownerTable)||(L=N.ownerTable,D=!1)),W=!0}}B=this.moveBlocksToNextPage(L instanceof Rl?L.previousWidget:W&&O?(0,a.isNullOrUndefined)(L.previousWidget)?L:L.previousWidget:L,W,void 0,void 0,void 0,!0);var A=e[e.length-1];if(y&&D&&0===N.index&&A.containerWidget&&-1!==A.containerWidget.childWidgets.indexOf(A)&&A.containerWidget.childWidgets.splice(A.containerWidget.childWidgets.indexOf(A),1),D&&(-1!==B.childWidgets.indexOf(A)&&B.childWidgets.splice(B.childWidgets.indexOf(A),1),B.childWidgets.unshift(A),this.shiftFloatingItemsFromTable(A,B)),A.containerWidget=B,y&&N.index>0||t.length>1){var U=y?t[t.length-1]:t[t.length-2];W&&(U=N),this.moveNextWidgetsToTable(e,U,!y),N=i}W&&this.updateClientPositionForBlock(D?A:L,i),y=!1;var V=!1,z=this.documentHelper.viewer.clientArea.bottom-v.bottomBorderWidth-l;if(N.ownerTable.header&&(I.x=I.x,I.y=this.viewer.clientArea.y+k.headerHeight,this.updateChildLocationForRow(I.y,I),V=this.isFirstLineFitForRow(z,I)),V&&N.ownerTable.header&&!W){c instanceof kl&&(B.page.repeatHeaderRowTableWidget=!0,b=!0),c.updateClientAreaForBlock(N.ownerTable,!0,e),I.x=I.x,I.y=k.y+N.ownerTable.headerHeight;var q=l/2;this.updateChildLocationForRow(k.y+N.ownerTable.headerHeight-q,I,k.containerWidget)}else{if(c.updateClientAreaForBlock(N.ownerTable,!0,e),I.bodyWidget.sectionFormat.columns.length>1){var _=new Tl(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),j=new Tl(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height);I.x=this.viewer.clientActiveArea.x,I.y=this.viewer.clientActiveArea.y;var G=this.getMaxTopCellMargin(I),K=this.getMaxBottomCellMargin(I);for(S=0;S<I.childWidgets.length;S++){var X=I.childWidgets[S];X.height=0,this.addTableCellWidget(X,this.viewer.clientActiveArea,G+I.topBorderWidth,K+I.bottomBorderWidth),this.viewer.updateClientAreaForCell(X,!0);for(var Z=0;Z<X.childWidgets.length;Z++){var J=X.childWidgets[Z];c.updateClientAreaForBlock(J,!0),J.containerWidget=X,this.layoutBlock(J,0),c.updateClientAreaForBlock(J,!1)}this.viewer.updateClientAreaForCell(X,!1)}this.viewer.clientActiveArea=j,this.viewer.clientArea=_}I.x=I.x,I.y=k.y;q=l/2;this.updateChildLocationForRow(k.y-q,I,k.containerWidget,!0)}if(D&&this.shiftedFloatingItemsFromTable.length>0){for(S=0;S<this.shiftedFloatingItemsFromTable.length;S++){var Y=this.shiftedFloatingItemsFromTable[S],Q=this.getFloatingItemPoints(Y);Y.y=Q.y,Y.x=Q.x,Y instanceof hd&&this.updateChildLocationForCellOrShape(Y.y,Y)}this.shiftedFloatingItemsFromTable=[]}}x=!1}if(p)if(i.ownerTable.continueHeader&&(i.ownerTable.header=!0,i.ownerTable.headerHeight=h+i.ownerTable.headerHeight),u=this.getHeader(i.ownerTable),!(0,a.isNullOrUndefined)(u)&&i.index===u.index)if(((H=this.getHeaderHeight(i.ownerTable,i,t))>i.ownerTable.headerHeight||H>i.ownerTable.headerHeight)&&(i.ownerTable.headerHeight=H),i.ownerTable.headerHeight>c.clientArea.height){i.ownerTable.header=!1,i.ownerTable.continueHeader=!1,i.ownerTable.headerHeight=0;for(P=this.documentHelper.pages,S=0;S<P.length;S++)P[S].repeatHeaderRowTableWidget&&(P[S].repeatHeaderRowTableWidget=!1)}s=!1,e.length>2&&i.ownerTable.header&&v.height<c.clientActiveArea.bottom&&!c.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(c.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},t.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r.rowFormat.isHeader?t=r:i=!1,!i)break}return t},t.prototype.getHeaderHeight=function(e,t,i){var n=0;if(t.ownerTable.childWidgets.length>0&&e.childWidgets[0].rowFormat.isHeader)for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(!o.rowFormat.isHeader)break;n+=o.height}return n},t.prototype.getHeaderHeightForSpannedRow=function(e){for(var t=0,i=1,n=this.getHeader(e),r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(o.rowFormat.isHeader&&(t+=o.height,o==n)){for(var s=0;s<n.childWidgets.length;s++){var l=n.childWidgets[s];i=Math.max(i,l.cellFormat.rowSpan)}if(i>1&&r+i<e.childWidgets.length)for(var d=1;d<i;d++){var h=e.childWidgets[r+d];(0,a.isNullOrUndefined)(h)||(t+=h.height)}}}return t},t.prototype.updateWidgetToRow=function(e){var t=e.ownerRow;if(e.containerWidget=t,!(0,a.isNullOrUndefined)(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&Pa.convertPointToPixel(e.ownerRow.rowFormat.height)>0&&0===e.cellIndex&&(t.height=t.height+Pa.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan){var i=void 0;i="Exactly"===t.rowFormat.heightType?e.height+e.margin.bottom:e.height+e.margin.top+e.margin.bottom,t.height-Pa.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<i&&(t.height=i+Pa.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))}},t.prototype.updateHeightForRowWidget=function(e,t,i,n,r,o,s,l){for(var d=0;d<r.childWidgets.length;d++){var h,c=0,p=void 0;if(h=(p=r.childWidgets[d]).cellFormat.rowSpan,c=Pa.convertPointToPixel(p.ownerTable.tableFormat.cellSpacing),h>1){var u=r.containerWidget.childWidgets.indexOf(r),g=u+h-1-(r.index-p.rowIndex);if(!l&&(e.clientArea.bottom<p.y+p.height+p.margin.bottom||g>=u+1)&&(1===n.length||n.length>=1&&r===n[n.length-1])){var m=this.footHeight;this.footHeight=this.existFootnoteHeight=(0,a.isNullOrUndefined)(r.bodyWidget.page.footnoteWidget)?0:r.bodyWidget.page.footnoteWidget.height,this.splitSpannedCellWidget(p,i,n,e),this.footHeight=this.existFootnoteHeight=m}var f=r;if(g>0)if(g<r.containerWidget.childWidgets.length){var v=r.containerWidget.childWidgets[g];v instanceof Ul&&(f=v)===s&&(f=r)}else f=r.containerWidget.childWidgets[r.containerWidget.childWidgets.length-1];p.y+p.height+p.margin.bottom<f.y+f.height?p.height=f.y+f.height-f.bottomBorderWidth-p.y-p.margin.bottom:o&&f&&0!==f.y&&0!==f.height&&p.y+p.height+p.margin.bottom>f.y+f.height&&("Exactly"!==f.rowFormat.heightType||"Exactly"===f.rowFormat.heightType&&f.rowFormat.height>p.y+p.height+p.margin.bottom-f.y?f.height=p.y+p.height+p.margin.bottom-f.y:p.height=f.y-p.y+f.height)}else c>0&&i.length>1&&r.y===e.clientArea.y&&e instanceof kl&&(c/=2),p.height=r.height-p.margin.top-p.margin.bottom-c;this.updateHeightForCellWidget(e,i,n,p);for(var y=r.containerWidget;y.containerWidget instanceof Nl;)y=y.containerWidget;var w=void 0;y instanceof Ol&&(w=y.page),(e instanceof kl&&-1!==e.visiblePages.indexOf(w)||t)&&this.updateCellVerticalPosition(p,!1,p.ownerTable.isInsideTable)}},t.prototype.updateHeightForCellWidget=function(e,t,i,n){for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r]instanceof Al&&this.updateHeightForTableWidget(t,i,n.childWidgets[r])},t.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var n=0;n<t.length;n++)t[n]instanceof Ul&&(i=t[n].height+i);i=Math.max(i,e.rowFormat.height)}return i},t.prototype.splitSpannedCellWidget=function(e,t,i,n){var r=this.getSplittedWidget(n.clientArea.bottom,!1,t,i,e,void 0,void 0,void 0,void 0,!0);(0,a.isNullOrUndefined)(r)||(this.documentHelper.splittedCellWidgets.push(r),r.isSplittedCell=!0)},t.prototype.insertSplittedCellWidgets=function(e,t,i,n,r){if(!(0,a.isNullOrUndefined)(i)){var o,s=i.x,l=0,d=!1;o=Pa.convertPointToPixel(i.ownerTable.tableHolder.tableWidth);for(var h=0;h<i.childWidgets.length;h++){var c=i.childWidgets[h],p="None"===c.cellFormat.borders.right.lineStyle;if(l=(0,a.isNullOrUndefined)(c.ownerTable)||(0,a.isNullOrUndefined)(c.ownerTable.tableFormat)?0:Pa.convertPointToPixel(c.ownerTable.tableFormat.cellSpacing),Math.round(s)<Math.round(c.x-c.margin.left-l)){if(this.insertRowSpannedWidget(i,e,s,h,r)){h--;continue}if(1===t.length&&0===this.documentHelper.splittedCellWidgets.length)break;var u=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,s,h,n),u<i.childWidgets.length){h--;continue}}if(s+=c.margin.left+c.width+c.margin.right,l>0||c.columnIndex===c.ownerTable.tableHolder.columns.length-1||c.index===c.containerWidget.childWidgets.length-1){if(!c.ownerTable.tableFormat.allowAutoFit){var g=Pa.convertPointToPixel(Vl.getCellLeftBorder(c).getLineWidth()),m=Pa.convertPointToPixel(Vl.getCellRightBorder(c).getLineWidth());c.rightBorderWidth=c.ownerTable.isBidiTable?g:m,s+=c.rightBorderWidth}this.isInsertTable()||(d=this.checkPreviousMargins(c.ownerTable))}if(s-=p&&!d?0:c.rightBorderWidth,h===i.childWidgets.length-1&&Math.round(s)<Math.round(i.x+o)){if(this.insertRowSpannedWidget(i,e,s,h+1))continue;this.insertEmptySplittedCellWidget(i,t,s,h+1,n)}else;}if(((0,a.isNullOrUndefined)(i.childWidgets)||0===i.childWidgets.length)&&this.documentHelper.splittedCellWidgets.length>0)for(var f=0;f<this.documentHelper.splittedCellWidgets.length;f++){var v=this.documentHelper.splittedCellWidgets[f];if(Math.round(s)<=Math.round(v.x-v.margin.left)){if(this.insertRowSpannedWidget(i,e,s,f)){f--;continue}var y=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,s,f,n),y<i.childWidgets.length){f--;continue}}if(s+=v.margin.left+v.width+v.margin.right,f===i.childWidgets.length-1&&Math.round(s)<Math.round(i.x+o)){if(this.insertRowSpannedWidget(i,e,s,f+1))continue;this.insertEmptySplittedCellWidget(i,t,s,f+1,n)}else;}this.documentHelper.splittedCellWidgets.length>0&&(this.documentHelper.splittedCellWidgets=[])}},t.prototype.insertRowSpannedWidget=function(e,t,i,n,r){var o=0;e.ownerTable.tableFormat.cellSpacing>0&&(o=Pa.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var s=0;s<this.documentHelper.splittedCellWidgets.length;s++){var a=this.documentHelper.splittedCellWidgets[s];if(Math.round(i)===Math.round(a.x-a.margin.left))return e.childWidgets.splice(n,0,a),a.containerWidget=e,!r&&a.height>e.height&&(e.height=a.height),a.y!==e.y+a.margin.top+o&&this.updateChildLocationForRow(e.y,e),this.documentHelper.splittedCellWidgets.splice(s,1),!0}return!1},t.prototype.insertEmptySplittedCellWidget=function(e,t,i,n,r){for(var o,s=t[t.length-1],l=t.length-1;l>=0;l--)for(var d=t[l],h=d.childWidgets.length-1;h>=0;h--){var c=d.childWidgets[h];if(c.index===r){o=c;break}}o&&(s=o.ownerTable,r=o.indexInOwner);for(var p=r;p>=0;p--){var u=s.childWidgets[p],g=u.x;for(l=0;l<u.childWidgets.length;l++){var m=1,f=u.childWidgets[l],v=(0,a.isNullOrUndefined)(f.ownerTable)||(0,a.isNullOrUndefined)(f.ownerTable.tableFormat)?0:Pa.convertPointToPixel(f.ownerTable.tableFormat.cellSpacing);if(Math.round(g)!==Math.round(f.x-f.margin.left-v)&&(g=f.x-f.margin.left-v),Math.round(i)===Math.round(g)&&(m=(0,a.isNullOrUndefined)(f)||(0,a.isNullOrUndefined)(f.cellFormat)?m:f.cellFormat.rowSpan)>1&&0===u.firstChild.columnIndex&&!this.isColumnExistsInCurrentRow(e,f.columnIndex)){if(this.isVerticalMergedCellContinue(e)&&"Exactly"!==e.rowFormat.heightType&&!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof Ul&&e.previousRenderedWidget.y+e.previousRenderedWidget.height<f.y+f.height){this.isRelayoutneed=!0;var y=this.getSplittedWidget(e.previousRenderedWidget.y+e.previousRenderedWidget.height,!0,t,void 0,f,void 0,void 0,void 0,void 0,!0);return this.isRelayoutneed=!1,e.childWidgets.splice(n,0,y),y.containerWidget=e,void this.updateChildLocationForRow(e.y,e)}var w=this.createCellWidget(f);return e.childWidgets.splice(n,0,w),w.containerWidget=e,void this.updateChildLocationForRow(e.y,e)}g+=f.margin.left+f.width+f.margin.right}}},t.prototype.isColumnExistsInCurrentRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++){if(e.childWidgets[i].columnIndex===t)return!0}return!1},t.prototype.getSplittedWidget=function(e,t,i,n,r,o,s,l,d,h){var c=void 0;if(l||r.y+r.height>e-this.footHeight-r.margin.bottom){var p=0;r.ownerTable.isInsideTable&&(p=d);for(var u=!1,g=0;g<r.childWidgets.length;g++)if(r.childWidgets[g]instanceof Rl){var m=r.childWidgets[g],f=m;if(u||(f=this.getSplittedWidgetForPara(e-r.margin.bottom,m,o,s,l,p)),l&&(p+=m.childWidgets.length),!(0,a.isNullOrUndefined)(f)){if(u=!0,0===g&&f===m&&!h)return r;-1!==r.childWidgets.indexOf(f)&&(r.childWidgets.splice(r.childWidgets.indexOf(f),1),g--),r.height-=f.height,(0,a.isNullOrUndefined)(c)&&(c=this.createCellWidget(r)),c.height+=f.height,c.childWidgets.push(f),f.containerWidget=c}}else{var v=r.childWidgets[g],y=[v],w=0;if(!(0,a.isNullOrUndefined)(v.footnoteElement))for(var b=0;b<v.footnoteElement.length;b++)w+=this.getFootNoteHeight(v.footnoteElement[b].bodyWidget);var C=this.existFootnoteHeight+w;if(!(0,a.isNullOrUndefined)(o))for(b=0;b<o.length;b++)C+=this.getFootNoteHeight(o[b].bodyWidget);if(l||e-r.margin.bottom<v.y+v.height+C){var x=v.height,I=void 0;if(I=u?v:this.getSplittedWidgetForTable(e-r.margin.bottom,y,v,o,s,l,p),(0,a.isNullOrUndefined)(I)&&!v.childWidgets[0].rowFormat.allowBreakAcrossPages&&(I=v),!(0,a.isNullOrUndefined)(I)){if(0===g&&I===v)return r;-1!==r.childWidgets.indexOf(I)?(r.childWidgets.splice(r.childWidgets.indexOf(I),1),g--,r.height-=I.height):r.height-=x-v.height,(0,a.isNullOrUndefined)(c)&&(c=this.createCellWidget(r)),c.height+=I.height,c.childWidgets.push(I),I.containerWidget=c}}else if(v.footnoteElement.length>0)for(b=0;b<v.footnoteElement.length;b++)o.push(v.footnoteElement[b])}}else this.updateFootHeight(r,o);return(0,a.isNullOrUndefined)(c)&&t&&this.isRelayoutneed&&(c=this.createCellWidget(r)),c},t.prototype.getNextFootNoteHeight=function(e,t){var i=0;if(!(0,a.isNullOrUndefined)(e.ownerTable.footnoteElement)&&e.ownerTable.footnoteElement.length>0){for(var n=e.indexInOwner+1;n<e.ownerRow.childWidgets.length;n++)for(var r=e.ownerRow.childWidgets[n],o=0;o<r.childWidgets.length;o++)if(r.childWidgets[o]instanceof Rl)i+=this.getFootHeightFromPara(r.childWidgets[o],t);else if(r.childWidgets[o]instanceof Al){var s=r.childWidgets[o];i+=this.getFootHeightFromTable(s,t)}e.ownerTable.isInsideTable&&(i+=this.getNextFootNoteHeight(e.ownerTable.containerWidget,t))}return i},t.prototype.getFootHeightFromTable=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)s.childWidgets[a]instanceof Rl?i+=this.getFootHeightFromPara(s.childWidgets[a],t):s.childWidgets[a]instanceof Al&&(i+=this.getFootHeightFromTable(s.childWidgets[a],t));return i},t.prototype.getFootHeightFromPara=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n],o=this.getFootNoteHeightInLine(r);t>r.height+e.y&&(i+=o)}return i},t.prototype.updateFootHeight=function(e,t){if(!(0,a.isNullOrUndefined)(t))for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i]instanceof Rl)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++)this.getFootnoteFromLine(n.childWidgets[r],t);else e.childWidgets[i]instanceof Al&&this.updateFootHeightForTable(e.childWidgets[i],t)},t.prototype.updateFootHeightForTable=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];this.updateFootHeight(o,t)}},t.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},t.prototype.createCellWidget=function(e){var t=new Vl;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=e.leftBorderWidth,t.rightBorderWidth=e.rightBorderWidth,t},t.prototype.createTableWidget=function(e){var t=new Al;if(e.header){t.header=e.header;var i=this.getHeaderHeightForSpannedRow(e);t.headerHeight=i>e.headerHeight?i:e.headerHeight}return t.index=e.index,t.tableFormat=e.tableFormat,t.tableHolder=e.tableHolder,t.footnoteElement=e.footnoteElement,t.isGridUpdated=e.isGridUpdated,t.wrapTextAround=e.wrapTextAround,t.positioning=e.positioning,t.isContainInsideTable=e.isContainInsideTable,t.isBidiTable=e.isBidiTable,t},t.prototype.getSplittedWidgetForPara=function(e,t,i,n,r,o){for(var s=t.y,l=void 0,d=!1,h=!1,c=0,p=0;p<t.childWidgets.length;p++){var u=this.getNextFootNoteHeight(t.containerWidget,t.y+c),g=t.childWidgets[p],m=this.getFootNoteHeightInLine(g);if(m+=this.existFootnoteHeight+u,!(0,a.isNullOrUndefined)(i))for(var f=0;f<i.length;f++)m+=this.getFootNoteHeight(i[f].bodyWidget);var v=0;if(c+=v=g.children[0]instanceof dd?g.children[0].height:g.height,r&&o>=n||e<s+m+v){if(t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!(0,a.isNullOrUndefined)(t.associatedCell.ownerRow.previousWidget)))d=!0,p=0,g=t.childWidgets[0];else if(t.paragraphFormat.widowControl){if(!(0,a.isNullOrUndefined)(t.associatedCell)&&1===p&&e<s+v&&!h){var y=t.associatedCell.ownerRow.containerWidget,w=t.height-t.childWidgets[0].height;if(!(y.indexInOwner<=0&&t.associatedCell.ownerRow.indexInOwner<=0&&(t.indexInOwner<=0||w>e)||"Word2013"!==this.documentHelper.compatibilityMode))return t;h=!0}1!==p||h||(d=!0,p=0,g=t.childWidgets[0])}if(0===p){if(g.paragraph.containerWidget instanceof Vl&&!d&&!r&&0===t.indexInOwner&&s+v>e&&g.paragraph.associatedCell.ownerRow.y===this.viewer.clientArea.y){s+=g.height;continue}l=t;break}-1!==t.childWidgets.indexOf(g)&&(t.childWidgets.splice(t.childWidgets.indexOf(g),1),p--),t.height-=g.height,(0,a.isNullOrUndefined)(l)?((l=new Rl).characterFormat=t.characterFormat,l.paragraphFormat=t.paragraphFormat,l.index=t.index,this.updateWidgetLocation(t,l),l.height=g.height):l.height+=g.height,l.childWidgets.push(g),g.paragraph=l}this.getFootnoteFromLine(g,i),s+=g.height,o++}return l},t.prototype.getSplittedWidgetForTable=function(e,t,i,n,r,o,s){for(var l=i.y,d=void 0,h=0;h<i.childWidgets.length;h++){var c,p=(c=i.childWidgets[h]).height,u=this.existFootnoteHeight;if(e>l+p+u&&(0,a.isNullOrUndefined)(d))for(var g=0;g<c.childWidgets.length;g++)this.updateFootHeight(c.childWidgets[g],n);if(!(0,a.isNullOrUndefined)(n))for(var m=0;m<n.length;m++)u+=this.getFootNoteHeight(n[m].bodyWidget);if(o||e<l+p+u||!(0,a.isNullOrUndefined)(d)){var f=void 0,v=!0;if((0,a.isNullOrUndefined)(c)||(0,a.isNullOrUndefined)(c.rowFormat)||(v=c.rowFormat.allowBreakAcrossPages),v?f=(0,a.isNullOrUndefined)(d)&&this.isFirstLineFitForRow(e,c)?this.getSplittedWidgetForRow(e,t,[c],c,n,r,o,s):c:(0,a.isNullOrUndefined)(i.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(e,c)||i.isInsideTable&&!i.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?f=this.getSplittedWidgetForRow(e,t,[c],c,n,r,o,s):(0,a.isNullOrUndefined)(i.containerWidget.containerWidget.previousWidget)||(f=c),!(0,a.isNullOrUndefined)(f)){if(0===h&&f===c)return i;-1!==i.childWidgets.indexOf(f)?(i.childWidgets.splice(i.childWidgets.indexOf(f),1),h--,i.height-=f.height):i.height-=p-c.height,(0,a.isNullOrUndefined)(d)?(d=this.createTableWidget(i),this.updateWidgetLocation(i,d),d.height=f.height):d.height+=f.height,d.childWidgets.push(f),f.containerWidget=d}}l+=c.height}return d},t.prototype.isFirstLineFitForPara=function(e,t){var i=t.childWidgets[0],n=i.height,r=this.getFootNoteHeightInLine(i);n+=r+=this.existFootnoteHeight;var o=i.paragraph.containerWidget;if(t.paragraphFormat.keepLinesTogether&&Math.floor(o.containerWidget.y)!==this.viewer.clientArea.y&&(n=t.height),this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+n>=e)return!0}else if(!o.ownerTable.isInsideTable&&o.containerWidget.y===this.viewer.clientArea.y&&t.y+n>=e)return!0;return t.y+n<=e},t.prototype.isFirstLineFitForTable=function(e,t){var i,n=!1;return i=t.childWidgets[0],(0,a.isNullOrUndefined)(i)||(n=this.isFirstLineFitForRow(e,i)),n},t.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(!this.isFirstLineFitForCell(e,n))return!1}return!0},t.prototype.isFirstLineFitForCell=function(e,t){if(0===t.childWidgets.length)return!0;if(t.childWidgets[0]instanceof Rl){var i=t.childWidgets[0];return this.isFirstLineFitForPara(e-t.margin.bottom,i)}var n=t.childWidgets[0];return this.isFirstLineFitForTable(e-t.margin.bottom,n)},t.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},t.prototype.updateChildLocationForTable=function(e,t,i,n){for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r];o.y=e,this.updateChildLocationForRow(e,o,i,n),e+=o.height}},t.prototype.updateChildLocationForRow=function(e,t,i,n){var r=0;t.ownerTable.tableFormat.cellSpacing>0&&(r=Pa.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];s.index=s.cellIndex,s.y=e+s.margin.top+r,this.updateChildLocationForCellOrShape(s.y,s,i,n)}},t.prototype.updateChildLocationForCellOrShape=function(e,t,i,n,r){var o=t;t instanceof hd&&(o=t.textFrame);for(var s=0;s<o.childWidgets.length;s++){var l=!1;if(o.childWidgets[s]instanceof Al&&o.childWidgets[s].wrapTextAround&&!(0,a.isNullOrUndefined)(o.childWidgets[s+1])&&o.childWidgets[s+1].y>o.childWidgets[s].y&&o.childWidgets[s+1].y<o.childWidgets[s].y+o.childWidgets[s].height&&(l=!0),!(0,a.isNullOrUndefined)(o.childWidgets[s].floatingElements)&&o.childWidgets[s].floatingElements.length>0&&n&&(this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e,this.viewer.clientActiveArea.y=e),o.childWidgets[s].x=o.childWidgets[s].x,o.childWidgets[s].y=e,t instanceof hd&&"Inline"==t.textWrappingStyle&&r&&this.updateShapeYPosition(t),!(0,a.isNullOrUndefined)(i)&&t instanceof Vl&&o.childWidgets[s]instanceof Rl){var d=o.childWidgets[s],h=t.ownerTable.bodyWidget.floatingElements,c=!1;if(t.ownerTable.bodyWidget!==i||(0,a.isNullOrUndefined)(t.ownerTable.previousSplitWidget)||(h=t.ownerTable.previousSplitWidget.bodyWidget.floatingElements,c=!0),d.floatingElements.length>0)for(var p=0;p<d.floatingElements.length;p++){var u=d.floatingElements[p],g=this.viewer.clientActiveArea.x;if(this.viewer.clientActiveArea.x=u.x,this.layoutShape(u),this.viewer.clientActiveArea.x=g,!(0,a.isNullOrUndefined)(d.firstChild))for(var m=d.childWidgets[0],f=0;f<m.children.length;f++){var v=m.children[f];v instanceof dd&&"Inline"==v.textWrappingStyle&&(this.adjustPosition(v,t.ownerTable.bodyWidget),e=d.y)}if(h.indexOf(u)>-1&&"Inline"!==u.textWrappingStyle){if(!c){i.floatingElements.push(u);var y=i.previousSplitWidget;(0,a.isNullOrUndefined)(y)||-1===y.floatingElements.indexOf(u)||y.floatingElements.splice(y.floatingElements.indexOf(u),1)}-1!==h.indexOf(u)&&h.splice(h.indexOf(u),1)}}}o.childWidgets[s]instanceof Al&&this.updateChildLocationForTable(e,o.childWidgets[s],i,n),l||(e+=o.childWidgets[s].height)}},t.prototype.updateCellVerticalPosition=function(e,t,i){var n=e.ownerTable.containerWidget;if(n instanceof Wl||n instanceof cd||i){var r=this.getDisplacement(e,t);this.updateCellContentVerticalPosition(e,r,t)}},t.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var n=e.y+t,r=0;r<e.childWidgets.length;r++){if(e.childWidgets[r]instanceof Rl){var o=e.childWidgets[r];o.y=n,this.updateShapeInsideCell(o,t)}else this.updateTableWidgetLocation(e.childWidgets[r],n,i);n+=e.childWidgets[r].height}},t.prototype.updateShapeInsideCell=function(e,t){for(var i=0;i<e.floatingElements.length;i++){var n=e.floatingElements[i];n.y+=t,n instanceof hd&&this.updateChildLocationForCellOrShape(n.y,n)}},t.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];r.y=t;for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.y=t+s.margin.top+0,this.updateCellVerticalPosition(s,i,!0)}t+=r.height}return t},t.prototype.getDisplacement=function(e,t){var i=0,n=e.containerWidget,r=e.margin.top+e.margin.bottom;i=!(0,a.isNullOrUndefined)(e.cellFormat)&&e.cellFormat.rowSpan>1?e.height:((0,a.isNullOrUndefined)(n)?0:n.height)-r;var o=this.getCellContentHeight(e,!0),s=0;return i>o&&i<=this.viewer.clientArea.height&&!e.isSplittedCell&&(s=i-o,"Center"===e.cellFormat.verticalAlignment?s/=2:("Top"===e.cellFormat.verticalAlignment||t)&&(s=0)),s},t.prototype.getCellContentHeight=function(e,t,i){if((0,a.isNullOrUndefined)(e.childWidgets))return 0;for(var n=0,r=e.y,o=0,s=0,l=!1,d=!1,h=0;h<e.childWidgets.length;h++)if(e.childWidgets[h]instanceof Rl){var c=e.childWidgets[h];if(n+=e.childWidgets[h].height,!t&&c.floatingElements.length>0&&i===c.indexInOwner)n+=this.getFloatingItemsHeight(c,e);for(var p=0;p<c.floatingElements.length;p++){l=!0;var u=c.floatingElements[p],g=u.textWrappingStyle,m=u.y+u.height,f=c.y+c.height;if(r+e.containerWidget.height>m&&m>s)o=Math.abs(r-m),s=m,d=!1;else if(m>f&&c.x+c.width>u.x&&m>s&&"InFrontOfText"!==g&&"Behind"!==g&&("Word2013"===this.documentHelper.compatibilityMode||c.floatingElements[p].layoutInCell)){n+=0===s?m-f:m-s,s=m}else d=!0}}else this.considerPositionTableHeight(e,e.childWidgets[h])&&(n+=e.childWidgets[h].height);return r+n>s&&(l=!1),t&&l?o:t&&d?e.ownerRow.height:n},t.prototype.getFloatingItemsHeight=function(e,t){for(var i=0,n=0,r=0;r<e.floatingElements.length;r++){var o=e.floatingElements[r],s=o.textWrappingStyle,a=o.y+o.height,l=e.y+e.height;if(a<this.viewer.clientArea.bottom&&o.y!==e.y&&l>a&&e.x+e.width>o.x&&a>i&&"InFrontOfText"!==s&&"Behind"!==s&&"Inline"!==s&&("Word2013"===this.documentHelper.compatibilityMode||e.floatingElements[r].layoutInCell))n+=0===i?a-t.y:a-i,i=a}return n},t.prototype.considerPositionTableHeight=function(e,t){if(t.isLayouted&&t.wrapTextAround)for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t!==n&&(n.y===t.y||n.y+n.height<t.y))return!1}return!0},t.prototype.getTableLeftBorder=function(e){if((0,a.isNullOrUndefined)(e.left)){var t=new fa(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.left},t.prototype.getTableRightBorder=function(e){if((0,a.isNullOrUndefined)(e.right)){var t=new fa(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.right},t.prototype.getTableTopBorder=function(e){if((0,a.isNullOrUndefined)(e.top)){var t=new fa(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.top},t.prototype.getTableBottomBorder=function(e){if((0,a.isNullOrUndefined)(e.bottom)){var t=new fa(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.bottom},t.prototype.getCellDiagonalUpBorder=function(e){return e.cellFormat.borders.diagonalUp},t.prototype.getCellDiagonalDownBorder=function(e){return e.cellFormat.borders.diagonalDown},t.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var n=e.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];r+=Pa.convertPointToPixel(s.cellFormat.cellWidth)}t<r&&(t=r)}return t},t.prototype.layoutNextItemsBlock=function(e,t,i,n){var r=e.bodyWidget.sectionIndex,o=e,s=o.getSplitWidgets(),l=s[s.length-1].nextRenderedWidget;((0,a.isNullOrUndefined)(l)||this.documentHelper.blockToShift===o)&&(this.documentHelper.blockToShift=void 0);for(var d=!0;l instanceof Ll&&(l.bodyWidget.sectionIndex===r||"NoBreak"===l.bodyWidget.sectionFormat.breakCode&&o.bodyWidget.sectionFormat.pageWidth===l.bodyWidget.sectionFormat.pageWidth&&o.bodyWidget.sectionFormat.pageHeight===l.bodyWidget.sectionFormat.pageHeight)&&((0,a.isNullOrUndefined)(i)||!i||l.isLayouted||!this.isInitialLoad);){var h,c=o.getSplitWidgets();h=c[c.length-1],o=l,this.documentHelper.blockToShift===o&&(this.documentHelper.blockToShift=void 0),d=!1;var p;if(p=o.getSplitWidgets()[0],0===this.documentHelper.fieldStacks.length&&!(0,a.isNullOrUndefined)(p)&&h.containerWidget===p.containerWidget&&Pa.round(p.y,2)===Pa.round(h.y+h.height,2)){if(!(0,a.isNullOrUndefined)(this.documentHelper.blockToShift)||this.documentHelper.owner.editorModule.isFootnoteElementRemoved)this.documentHelper.blockToShift=o;else if(p.bodyWidget){var u=p.bodyWidget.floatingElements.length;(u>0||0===u&&(0,a.isNullOrUndefined)(this.documentHelper.blockToShift)&&n)&&(this.documentHelper.blockToShift=o)}break}if(d=!0,t.owner.isShiftingEnabled&&(0===this.documentHelper.fieldStacks.length||this.viewer.owner.editorModule.isInsertingTOC)||this.isIFfield&&!this.checkBlockHasField(o)){this.documentHelper.blockToShift=o;break}!(0,a.isNullOrUndefined)(this.viewer.owner.editorModule)&&this.viewer.owner.editorModule.isInsertingTOC||(o=o.combineWidget(this.viewer),h.containerWidget!==o.containerWidget&&(h instanceof Rl&&(!(h instanceof Rl)||h.isEndsWithPageBreak||h.isEndsWithColumnBreak||h.containerWidget.page===o.containerWidget.page||o.bodyWidget instanceof Ol&&"NoBreak"===o.bodyWidget.sectionFormat.breakCode)||this.updateContainerWidget(o,h.containerWidget,h.indexInOwner+1,!1)),o instanceof Al&&(this.clearTableWidget(o,!0,!0),o.isGridUpdated=!1),t.updateClientAreaForBlock(o,!0),(this.viewer instanceof Fl||o.bodyWidget instanceof Bl)&&(o.containerWidget.height-=o.height),this.documentHelper.layout.layoutBlock(o,0),t.updateClientAreaForBlock(o,!1)),s=l.getSplitWidgets(),l=s[s.length-1].nextRenderedWidget}t.owner.isShiftingEnabled&&this.documentHelper.blockToShift===o||this.isPastingContent||this.viewer.owner.editorModule.updateListItemsTillEnd(o,d)},t.prototype.updateClientAreaForLine=function(e){e.marginTop=0;var t=this.documentHelper.selection.getTop(e),i=this.viewer.clientArea.x;this.viewer.cutFromTop(t),this.viewer.cutFromLeft(i)},t.prototype.isAuto=function(e){var t=!1;if("Auto"!==e.tableFormat.preferredWidthType||0!==e.tableFormat.preferredWidth||!e.tableFormat.allowAutoFit)return!1;for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if("Auto"!==o.cellFormat.preferredWidthType||0!==o.cellFormat.preferredWidth)return!1;t=!0}return t&&e.isInsideTable&&e.containerWidget instanceof Vl&&(t=this.isAuto(e.containerWidget.ownerTable)),t},t.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof Wl||t.containerWidget instanceof cd)return t;t=t.containerWidget}},t.prototype.reLayoutParagraph=function(e,t,i,n,r){if(!(this.isReplaceAll||this.viewer.owner.editorModule&&this.viewer.owner.editorModule.restrictLayout)){this.isRelayout=!0,e.containerWidget instanceof cd&&"Inline"===e.containerWidget.containerShape.textWrappingStyle&&(t=e.containerWidget.containerShape.line.indexInOwner,e=e.containerWidget.containerShape.paragraph),n=!(0,a.isNullOrUndefined)(n)&&n,this.isRelayout=!0;var o=!1;this.documentHelper.blockToShift===e?(this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.isBidiReLayout=!0,o=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1);var s=!1;if(!o)if(e.isInsideTable){this.isBidiReLayout=!0,this.documentHelper.owner.editorHistoryModule&&this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.isEmptySelection&&(s=!0);var l=this.getParentTable(e),d=l.containerWidget;if(!this.isReplacingAll&&s&&d instanceof Ol&&(0,a.isNullOrUndefined)(d.containerWidget)){var h=l.tableHolder.clone(),c=l.clone().combineWidget(this.viewer),p=!0;if(c.tableFormat.allowAutoFit)if(c.isGridUpdated=!1,c.buildTableColumns(),c.isGridUpdated=!0,h.columns.length===c.tableHolder.columns.length)for(var u=0;u<c.tableHolder.columns.length;u++){if(c.tableHolder.columns[u].preferredWidth!==h.columns[u].preferredWidth){p=!1;break}}else p=!1;if(p){e.associatedCell.ownerTable.footnoteElement&&e.associatedCell.ownerTable.footnoteElement.length>0&&this.clearFootnoteReference(e.associatedCell.ownerTable,!0),this.viewer.updateClientAreaForCell(e.associatedCell,!0),this.viewer.updateClientAreaForBlock(e,!0),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(e),this.layoutParagraph(e,0),this.viewer.updateClientAreaForBlock(e,!1);var g=this.getParentTable(e),m=0;if(g.containerWidget instanceof Ol)m=(b=g.getSplitWidgets())[b.length-1].containerWidget.page.index;var f=g.combineWidget(this.viewer),v=f.containerWidget;if(this.viewer instanceof Fl&&(v.height-=f.height),this.viewer.updateClientArea(v,v.page),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var y=this.documentHelper.getFirstParagraphInFirstCell(f);this.viewer.owner.editorModule.updateWholeListItems(y)}this.viewer.updateClientAreaForBlock(f,!0),f.x-=f.leftBorderWidth,f.y-=f.topBorderWidth;var w=this.getYPosition(f);this.viewer.cutFromTop(w),this.clearTableWidget(f,!0,!0,!1,!0,!0),this.shiftTableWidget(f,this.viewer),this.viewer.updateClientAreaForBlock(f,!1);var b,C=0;if(f.containerWidget instanceof Ol)C=(b=f.getSplitWidgets())[b.length-1].containerWidget.page.index;this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&f.nextRenderedWidget&&this.viewer.owner.editorModule.updateWholeListItems(f.nextRenderedWidget),this.layoutNextItemsBlock(f,this.viewer,void 0,m!==C)}else this.isReplacingAll||this.reLayoutTable(e)}else this.isReplacingAll||this.reLayoutTable(e);if(this.isFootnoteContentChanged&&!(0,a.isNullOrUndefined)(e.bodyWidget)&&!(0,a.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)){var x=e.bodyWidget.page.footnoteWidget;this.layoutfootNote(x)}this.isBidiReLayout=!1}else this.reLayoutLine(e,t,n,r,void 0);e.bodyWidget instanceof Bl&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer)}},t.prototype.getParentRow=function(e){return this.getParentCell(e).ownerRow},t.prototype.getParentCell=function(e){for(var t=e;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t},t.prototype.reLayoutRow=function(e){e instanceof Rl&&(e=e.associatedCell);var t=this.getParentRow(e).getSplitWidgets()[0];if((0,a.isNullOrUndefined)(t)||t.ownerTable.tableFormat.allowAutoFit)this.currentCell=e,this.reLayoutTable(e),this.currentCell=void 0;else{for(var i=t.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),n=t;this.isVerticalMergedCellContinue(n);){var r=n.previousWidget;if((0,a.isNullOrUndefined)(r))break;n=r}var o=i.containerWidget;this.viewer instanceof Fl&&(o.height-=i.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||o instanceof cd?o instanceof cd?this.viewer.updateClientAreaForTextBoxShape(o.containerShape,!0):this.viewer.updateClientArea(o,o.page):(e.bodyWidget.isEmpty=!1,o.height-=i.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),o.page));var s=new Tl(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),l=new Tl(s.x,s.y,s.width,s.height);if(this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var d=this.documentHelper.getFirstParagraphInFirstCell(i);this.viewer.owner.editorModule.updateWholeListItems(d)}this.viewer.updateClientAreaForBlock(i,!0),this.viewer.cutFromTop(n.y),this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,i.height=0;do{if(this.clearRowWidget(t,!0,!0,!0),this.layoutRow([i],t,!0),n===t)break;n=n.nextRow}while(n&&n!==t);this.updateChildLocationForTable(i.y,i),this.viewer.clientArea=l,this.viewer.clientActiveArea=new Tl(l.x,l.y,l.width,l.height),this.viewer.updateClientAreaForBlock(i,!0),i.x-=i.leftBorderWidth,i.y-=i.topBorderWidth,this.viewer.cutFromTop(i.y),this.shiftTableWidget(i,this.viewer,!0),this.layoutNextItemsBlock(i,this.viewer)}},t.prototype.reLayoutTable=function(e,t){if(!this.viewer.owner.editorModule||!this.viewer.owner.editorModule.restrictLayout){var i=this.getParentTable(e);if(i.header)for(var n=i.getSplitWidgets(),r=1;r<n.length;r++)n[r].bodyWidget.page.repeatHeaderRowTableWidget=!1;var o=0;if(i.containerWidget instanceof Ol)o=(h=i.getSplitWidgets())[h.length-1].containerWidget.page.index;var s=i.combineWidget(this.viewer),a=s.containerWidget;if(this.viewer instanceof Fl&&(a.height-=s.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||a instanceof cd?a instanceof cd?this.viewer.updateClientAreaForTextBoxShape(a.containerShape,!0):this.viewer.updateClientArea(a,a.page):(e.bodyWidget.isEmpty=!1,a.height-=s.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),a.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var l=this.documentHelper.getFirstParagraphInFirstCell(s);this.viewer.owner.editorModule.updateWholeListItems(l)}this.viewer.updateClientAreaForBlock(s,!0),s.x-=s.leftBorderWidth,s.y-=s.topBorderWidth;var d=this.getYPosition(s);this.viewer.cutFromTop(d),this.clearTableWidget(s,!0,!0,!0,!0),this.isBidiReLayout=!0,this.layoutBlock(s,0),this.viewer.updateClientAreaForBlock(s,!1);var h,c=0;if(s.containerWidget instanceof Ol)c=(h=s.getSplitWidgets())[h.length-1].containerWidget.page.index;this.layoutNextItemsBlock(s,this.viewer,t,o!==c)}},t.prototype.getYPosition=function(e){if(e.wrapTextAround){for(var t=e.previousWidget;t;){if(t instanceof Rl)return t.y+t.height;if(t instanceof Al){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return e.y},t.prototype.clearFootnoteReference=function(e,t){if(e.footnoteElement&&e.footnoteElement.length>0){for(var i=e.bodyWidget.page,n=e.footnoteElement.length-1;n>=0;n--){var r=e.footnoteElement[n];r.isLayout=!1;var o=r.bodyWidget.containerWidget;if(o&&-1!==o.bodyWidgets.indexOf(r.bodyWidget)){var s=this.getFootNoteHeight(r.bodyWidget);o.height-=s,o.bodyWidgets.splice(r.bodyWidget.indexInOwner,1),t&&o.page===i&&(this.viewer.clientActiveArea.height+=s,this.viewer.clientArea.height+=s)}o&&0===o.bodyWidgets.length&&o.page&&(o.page.footnoteWidget=void 0),r.bodyWidget.containerWidget=void 0}e.footnoteElement=[]}},t.prototype.clearTableWidget=function(e,t,i,n,r,o){e.height=0,n&&(e.isGridUpdated=!1),t&&(e.y=0,e.x=0,e.footnoteElement&&e.footnoteElement.length>0&&this.clearFootnoteReference(e,r)),e.leftBorderWidth=0,e.rightBorderWidth=0,e.topBorderWidth=0,e.bottomBorderWidth=0;for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];this.clearRowWidget(a,t,i,n,o)}},t.prototype.clearRowWidget=function(e,t,i,n,r){e.height=0,t&&(e.y=0,e.x=0),e.topBorderWidth=0,e.bottomBorderWidth=0;for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];this.clearCellWidget(s,t,i,n,r)}},t.prototype.clearCellWidget=function(e,t,i,n,r){e.height=0,t&&(e.y=0,e.x=0),e.leftBorderWidth=0,e.rightBorderWidth=0,this.clearBlockWidget(e.childWidgets,t,i,n,r)},t.prototype.clearBlockWidget=function(e,t,i,n,r){for(var o=0;o<e.length;o++){var s=e[o];s instanceof Rl?(t&&!r&&(s.y=0,s.x=0),i&&!r&&(s.height=0)):this.clearTableWidget(s,t,i,n,void 0,r)}},t.prototype.layoutBodyWidgetCollection=function(e,t,i,n,r,o){if((0,a.isNullOrUndefined)(i)||!i.isFieldCodeBlock){if(!(0,a.isNullOrUndefined)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled){if(this.viewer.owner.editorModule&&this.viewer.owner.editor.restrictLayout)return;if(t instanceof Wl||t instanceof cd){var s=this.checkAndGetBlock(t,e);if(t instanceof Ol&&(0,a.isNullOrUndefined)(s)&&!(0,a.isNullOrUndefined)(t.nextRenderedWidget)&&"NoBreak"===t.nextRenderedWidget.sectionFormat.breakCode&&(s=t.nextRenderedWidget.firstChild,t=t.nextRenderedWidget),(0,a.isNullOrUndefined)(s))return;if(this.viewer instanceof Fl&&(s.containerWidget.height-=s.height),t instanceof Bl)t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),s.containerWidget.height-=s.height;else if(t instanceof cd)this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0,!n);else if(!(0,a.isNullOrUndefined)(t.containerWidget)&&t.containerWidget instanceof Dl){if(this.viewer.updateClientArea(t,t.page,!0),"Footnote"!==t.containerWidget.footNoteType)return this.viewer.cutFromTop(t.containerWidget.y),void this.layoutfootNote(t.containerWidget);this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.y=s.containerWidget.containerWidget.y}else(0,a.isNullOrUndefined)(t.page.footnoteWidget)||t.page.footnoteWidget.footNoteType,this.viewer.updateClientArea(t,t.page,!0);var l=0,d=0;if(s.containerWidget instanceof Ol)l=(y=s.getSplitWidgets())[y.length-1].containerWidget.page.index;if(e>0||"NoBreak"===s.bodyWidget.sectionFormat.breakCode&&0!==s.bodyWidget.index&&s===t.firstChild){var h=(s=s.combineWidget(this.viewer)).getSplitWidgets()[0].previousRenderedWidget;for(!(0,a.isNullOrUndefined)(h)&&h.wrapTextAround&&!(0,a.isNullOrUndefined)(h.getSplitWidgets()[0].previousRenderedWidget)&&h.bodyWidget.index===h.getSplitWidgets()[0].previousRenderedWidget.bodyWidget.index&&h.y<h.getSplitWidgets()[0].previousRenderedWidget.y&&(h=h.getSplitWidgets()[0].previousRenderedWidget);h instanceof Ll&&h.isFieldCodeBlock;)h=h.getSplitWidgets()[0].previousRenderedWidget;if(!((0,a.isNullOrUndefined)(h)||h instanceof Rl)||h instanceof Rl&&!h.isEndsWithPageBreak&&!h.isEndsWithColumnBreak)if((0,a.isNullOrUndefined)(r)&&s.containerWidget!==h.containerWidget){var c=s.containerWidget,p=h.containerWidget,u=this.getFootNoteWidgetsOf(s);if(this.moveFootNotesToPage(u,c,p),"NoBreak"!==s.bodyWidget.sectionFormat.breakCode||s.bodyWidget.index===h.bodyWidget.index)this.viewer.cutFromTop(h.y+h.height),this.updateContainerWidget(s,p,h.indexInOwner+1,!1);else if(s.bodyWidget.sectionIndex!==h.bodyWidget.sectionIndex&&h.bodyWidget.sectionFormat.numberOfColumns>1&&s.bodyWidget.page===h.bodyWidget.page){var g=this.getBodyWidget(h.bodyWidget,!0),m=this.getNextWidgetHeight(g);this.viewer.clientActiveArea.height-=m-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=m,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height}else this.viewer.updateClientArea(s.bodyWidget,s.bodyWidget.page,!0),this.viewer.cutFromTop(h.y+h.height)}else{if(h instanceof Rl&&h.height<=0&&this.isMultiColumnDoc){var f=h;this.viewer.updateClientAreaForBlock(f,!0),this.layoutParagraph(f,0),this.viewer.updateClientArea(f.bodyWidget,f.bodyWidget.page,!0)}this.viewer.cutFromTop(h.y+h.height)}else h instanceof Rl&&(h.isEndsWithPageBreak||h.isEndsWithColumnBreak)&&h.containerWidget===s.containerWidget&&this.moveBlocksToNextPage(h,!1)}var v=void 0;(s=s.combineWidget(this.viewer))instanceof Al?(this.clearTableWidget(s,!0,!0),s.isGridUpdated=!1,v=this.documentHelper.getFirstParagraphInFirstCell(s)):v=s,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(v),this.viewer.updateClientAreaForBlock(s,!0,void 0,!1,!0),this.isRelayout=!0,this.documentHelper.layout.layoutBlock(s,0),this.isRelayout=!1,this.viewer.updateClientAreaForBlock(s,!1),!(0,a.isNullOrUndefined)(t.containerWidget)&&t.containerWidget instanceof Dl&&"Footnote"===t.containerWidget.footNoteType&&this.layoutfootNote(t.containerWidget);var y,w=t;if(null!=t.containerWidget||t instanceof cd||null==w.page||null==w.page.footnoteWidget||"Footnote"===w.page.footnoteWidget.footNoteType&&this.layoutfootNote(w.page.footnoteWidget),s.containerWidget instanceof Ol)d=(y=s.getSplitWidgets())[y.length-1].containerWidget.page.index;n?this.shiftNextWidgets(s):this.layoutNextItemsBlock(s,this.viewer,void 0,l!==d)}else t instanceof Vl&&!o&&this.reLayoutTable(t.ownerTable)}this.isRelayoutFootnote=!1}},t.prototype.checkAndGetBlock=function(e,t){if(e instanceof cd)return e.childWidgets[t];var i=e.indexInOwner;if(e.page.bodyWidgets.length<=1)for(;e&&e.indexInOwner===i;){if(e.childWidgets.length>0&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var n=0;n<e.childWidgets.length;n++){if((r=e.childWidgets[n]).index===t)return r}if(!(e instanceof Ol))break;e=e.nextRenderedWidget}else for(;e;){if(e.childWidgets.length>0)for(n=0;n<e.childWidgets.length;n++){var r;if((r=e.childWidgets[n]).index===t)return r}if(!(e instanceof Ol))break;e=e.nextRenderedWidget}},t.prototype.layoutTable=function(e,t){if(this.isFieldCode&&!this.checkTableHasField(e)&&!this.isRelayout)return e.isFieldCodeBlock=!0,e;!(0,a.isNullOrUndefined)(e.previousWidget)&&this.viewer.clientActiveArea.height<0&&!e.wrapTextAround&&this.moveBlocksToNextPage(e.previousWidget,!1),e.isBidiTable=e.bidi,e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(0,a.isNullOrUndefined)(e.firstChild.firstChild.leftMargin)||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-Pa.convertPointToPixel(e.firstChild.firstChild.leftMargin));var i,n,r=[e];this.addTableWidget(this.viewer.clientActiveArea,r),this.viewer.updateClientAreaTopOrLeft(e,!0);var o=0;if(e.wrapTextAround?(i=this.viewer.clientActiveArea.clone(),n=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(r,e,!0,i,n)):e.containerWidget instanceof cd||(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(o=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x)),e.childWidgets.length>0){var s=e.childWidgets[0].rowFormat.isHeader;e.header=s,e.continueHeader=s,e.headerHeight=0}var l=e.childWidgets[t];r.length;for(this.updateFootnoteHeight(e,!0);l;)l=(l=this.layoutRow(r,l)).nextRow;return this.updateFootnoteHeight(e,!1),this.documentHelper.viewer instanceof kl&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e)),this.updateWidgetsToPage(r,[],e,!0),o>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-o),e.wrapTextAround&&this.updateClientAreaForWrapTable(r,e,!1,i,n),r[r.length-1].isLayouted=!0,r[r.length-1].isFieldCodeBlock=!1,"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||e.wrapTextAround||(0,a.isNullOrUndefined)(e.firstChild.firstChild.leftMargin)||(this.viewer.clientArea.x=this.viewer.clientArea.x+Pa.convertPointToPixel(e.firstChild.firstChild.leftMargin)),r[r.length-1]},t.prototype.updateFootnoteHeight=function(e,t,i){if((!this.isInitialLoad||i)&&!e.isInsideTable&&!(0,a.isNullOrUndefined)(e.bodyWidget)&&!(0,a.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)&&"Footnote"===e.bodyWidget.page.footnoteWidget.footNoteType){var n=e.bodyWidget.page,r=n.bodyWidgets[0],o=Pa.convertPointToPixel(r.sectionFormat.pageHeight),s=Pa.convertPointToPixel(r.sectionFormat.topMargin),l=Pa.convertPointToPixel(r.sectionFormat.bottomMargin),d=.667+l,h=!1,c=48,p=48;if((0,a.isNullOrUndefined)(r.sectionFormat)||(s=Pa.convertPointToPixel(r.sectionFormat.topMargin),c=Pa.convertPointToPixel(r.sectionFormat.headerDistance),p=Pa.convertPointToPixel(r.sectionFormat.footerDistance)),(0,a.isNullOrUndefined)(n.headerWidget)||(h=n.headerWidget.isEmpty,s>=0?(!h||h&&this.documentHelper.owner.enableHeaderAndFooter)&&(s=Math.min(Math.max(c+n.headerWidget.height,s),o/100*40)):s=Math.abs(s)),!(0,a.isNullOrUndefined)(n.footerWidget)){h=n.footerWidget.isEmpty;var u=(0,a.isNullOrUndefined)(n.footnoteWidget)?0:n.footnoteWidget.height;u=Math.min(u,(o-s-d)/100*90),d>=0?(!h||h&&this.documentHelper.owner.enableHeaderAndFooter)&&(d=.667+Math.min(o/100*40,Math.max(p+n.footerWidget.height,l))):d=Math.abs(d),i||(d+=u)}if(!(0,a.isNullOrUndefined)(n.footnoteWidget)){u=(0,a.isNullOrUndefined)(n.footnoteWidget)?0:n.footnoteWidget.height;var g=o-s-d;if(i)return g+this.viewer.clientArea.y;t&&g===this.viewer.clientArea.height?this.viewer.clientArea.height+=u:g+u===this.viewer.clientArea.height&&(this.viewer.clientArea.height-=u)}}return 0},t.prototype.updateClientAreaForWrapTable=function(e,t,i,n,r){if(i){if(t.wrapTextAround){this.updateTableFloatPoints(t);var o=this.viewer.clientActiveArea.clone(),s=this.adjustClientAreaBasedOnTextWrapForTable(t,this.viewer.clientActiveArea);o.x!==s.x&&(t.x=this.viewer.clientActiveArea.x),o.y!==s.y&&(t.y=this.viewer.clientActiveArea.y)}}else if(t.wrapTextAround&&t.bodyWidget)if(1==e.length){if(!(0,a.isNullOrUndefined)(t.previousWidget)||t.isInHeaderFooter||t.isInsideTable){var l=n.clone(),d=r.clone();t.bodyWidget.lastChild!==e[e.length-1]&&(this.viewer.clientActiveArea=l,this.viewer.clientArea=d),!t.isLayouted&&l.height<t.height&&t.width>=l.width&&this.moveBlocksToNextPage(t.previousWidget,!1)}else this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);-1===t.bodyWidget.floatingElements.indexOf(t)&&t.bodyWidget.floatingElements.push(t)}else{if(!(0,a.isNullOrUndefined)(t.previousWidget)&&!t.isLayouted&&n.height<t.height&&t.width>=n.width){var h=t;do{this.moveBlocksToNextPage(h.previousWidget,!1),h=h.nextSplitWidget}while(h)}this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);for(var c=0;c<e.length;c++){var p=e[c].bodyWidget;(0,a.isNullOrUndefined)(p)||-1!==p.floatingElements.indexOf(e[c])||p.floatingElements.push(e[c])}var u=e[e.length-1];this.viewer.cutFromTop(this.viewer.clientActiveArea.y+u.height+u.tableFormat.borders.bottom.lineWidth)}},t.prototype.addTableWidget=function(e,t,i){var n=t[t.length-1];return i&&(n=this.createTableWidget(n),t.push(n)),n.width=e.width,n.x=e.x,n.y=e.y,n.tableFormat.cellSpacing>0&&(n.height=n.height+Pa.convertPointToPixel(n.tableFormat.cellSpacing),n.isBidiTable?(n.leftBorderWidth=Pa.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=Pa.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth())):(n.leftBorderWidth=Pa.convertPointToPixel(this.getTableLeftBorder(n.tableFormat.borders).getLineWidth()),n.rightBorderWidth=Pa.convertPointToPixel(this.getTableRightBorder(n.tableFormat.borders).getLineWidth())),n.topBorderWidth=Pa.convertPointToPixel(this.getTableTopBorder(n.tableFormat.borders).getLineWidth()),n.bottomBorderWidth=Pa.convertPointToPixel(this.getTableBottomBorder(n.tableFormat.borders).getLineWidth()),n.x+=n.leftBorderWidth,n.y+=n.topBorderWidth,n.width-=n.leftBorderWidth,n.width-=n.rightBorderWidth,n.height+=n.bottomBorderWidth),n},t.prototype.updateWidgetsToPage=function(e,t,i,n,r){var o=this.viewer,s=e[e.length-1];if(!i.isInsideTable){for(var a=0;a<e.length;a++)this.updateHeightForTableWidget(e,t,e[a],r);s.childWidgets.length>0&&s.y!==s.childWidgets[0].y&&(s.y=s.childWidgets[0].y)}if(i.isBidiTable&&n)for(a=0;a<e.length;a++)for(var l=e[a],d=0;d<l.childWidgets.length;d++){l.childWidgets[d].shiftWidgetForRtlTable()}i.tableFormat.cellSpacing>0&&(s.y+s.height+Pa.convertPointToPixel(i.tableFormat.cellSpacing)>o.clientArea.bottom&&o instanceof Fl&&(s.height=s.height-Pa.convertPointToPixel(i.tableFormat.cellSpacing)/2),o.cutFromTop(s.y+s.height)),this.viewer instanceof Fl&&(i.containerWidget.height+=i.height),i.bodyWidget instanceof Bl&&!i.wrapTextAround&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},t.prototype.updateHeightForTableWidget=function(e,t,i,n){for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];if(o===n)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!1,n)}},t.prototype.layoutRow=function(e,t,i){var n=t.ownerTable.isInsideTable;n||this.updateExistingFootnoteHeight(t);var r=this.viewer,o=[t];this.addTableRowWidget(r.clientActiveArea,o),r.updateClientAreaForRow(t,!0);for(var s=this.getMaxTopCellMargin(t),a=this.getMaxBottomCellMargin(t),l=0;l<t.childWidgets.length;l++){var d=t.childWidgets[l];this.layoutCell(d,s+t.topBorderWidth,a+t.bottomBorderWidth)}r.updateClientAreaForRow(t,!1);var h=[t];return i||this.updateWidgetsToTable(e,h,t,!1),n||(this.layoutedFootnoteElement=[]),h[h.length-1]},t.prototype.updateExistingFootnoteHeight=function(e){this.layoutedFootnoteElement=[],(0,a.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)||0===e.bodyWidget.page.footnoteWidget.bodyWidgets.length?this.existFootnoteHeight=0:this.existFootnoteHeight=e.bodyWidget.page.footnoteWidget.height},t.prototype.isIntersecting=function(e,t,i,n){return(Pa.round(i,2)<=Pa.round(e,2)||Pa.round(i,2)<Pa.round(t,2))&&Pa.round(n,2)>Pa.round(e,2)},t.prototype.getAdjacentRowCell=function(e,t,i,n){var r=[],o=e.ownerTable.tableHolder.columns.length,s=e.ownerTable.childWidgets[n];if((0,a.isNullOrUndefined)(s))return r;var l=0,d=0,h=e.cellFormat.columnSpan,c=e.columnIndex;if(s.rowFormat.gridBefore>0){if(s.rowFormat.gridBefore>c+h)return r;l=s.rowFormat.beforeWidth,d=s.rowFormat.gridBefore}for(var p=0;p<s.childWidgets.length;p++){var u=s.childWidgets[p],g=u.x-u.margin.left,m=u.x+u.width+u.margin.right,f=u.columnIndex+u.cellFormat.columnSpan;if(p==s.childWidgets.length-1||Pa.round(g,2)>Pa.round(l,2)&&Pa.round(g,2)>Pa.round(t,2)){if(p==s.childWidgets.length-1&&s.rowFormat.gridAfter>0&&f+s.rowFormat.gridAfter===o)return r;if(this.isIntersecting(t,i,l,g))for(;h>0;){var v=s.getVerticalMergeStartCell(c,h),y=0;if((0,a.isNullOrUndefined)(v))break;var w=v.cellFormat.columnSpan;if(r.push(v),t=y=v.x+v.width+v.margin.right,h-=(d=v.columnIndex+w)-c,c=d,Pa.round(y,2)>=Pa.round(i,2))break}}if(this.isIntersecting(t,i,g,m)&&(r.push(u),t=m,h-=f-c,c=f),Pa.round(m,2)>=Pa.round(i,2))break;l=m,d=f}return r},t.prototype.addTableRowWidget=function(e,t){var i=t[t.length-1];0===i.rowFormat.beforeWidth&&0===i.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==i.ownerTable.tableFormat.tableAlignment?i.x=e.x:i.x+=0!==i.rowFormat.beforeWidth?i.rowFormat.beforeWidth:i.rowFormat.gridBeforeWidth,i.y=e.y,i.width=e.width;var n=0;if(!(0,a.isNullOrUndefined)(i.ownerTable)&&!(0,a.isNullOrUndefined)(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing>0){i.height=i.height+Pa.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);for(var r=0;r<i.childWidgets.length;r++)if(!(0,a.isNullOrUndefined)(i.childWidgets[r].cellFormat)&&!(0,a.isNullOrUndefined)(i.childWidgets[r].cellFormat.borders)){var o=Vl.getCellBottomBorder(i.childWidgets[r]).getLineWidth();o>n&&(n=o)}if(i.bottomBorderWidth=Pa.convertPointToPixel(n),i.index>0&&!(0,a.isNullOrUndefined)(i.previousWidget)){var s=i.previousWidget;n=0;for(var l=0;l<s.childWidgets.length;l++)if(!(0,a.isNullOrUndefined)(s.childWidgets[l].cellFormat)&&!(0,a.isNullOrUndefined)(s.childWidgets[l].cellFormat.borders)){var d=Vl.getCellBottomBorder(s.childWidgets[l]).getLineWidth();d>n&&(n=d)}i.topBorderWidth=Pa.convertPointToPixel(n)}}if(!(0,a.isNullOrUndefined)(i.childWidgets))for(l=0;l<i.childWidgets.length;l++)if(!(0,a.isNullOrUndefined)(i.childWidgets[l].cellFormat)&&!(0,a.isNullOrUndefined)(i.childWidgets[l].cellFormat.borders)){var h=Vl.getCellTopBorder(i.childWidgets[l]).getLineWidth();h>n&&(n=h)}if(i.topBorderWidth=Pa.convertPointToPixel(n),!(0,a.isNullOrUndefined)(i.ownerTable)&&!(0,a.isNullOrUndefined)(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing<=0&&i.rowIndex===i.ownerTable.childWidgets.length-1){for(l=0;l<i.childWidgets.length;l++)if(!(0,a.isNullOrUndefined)(i.childWidgets[l].cellFormat)&&!(0,a.isNullOrUndefined)(i.childWidgets[l].cellFormat.borders)){var c=Vl.getCellBottomBorder(i.childWidgets[l]).getLineWidth();c>n&&(n=c)}i.bottomBorderWidth=Pa.convertPointToPixel(n)}return i},t.prototype.getMaxTopCellMargin=function(e){if((0,a.isNullOrUndefined)(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=0;(r=n.cellFormat.hasValue("topMargin")?Pa.convertPointToPixel(n.cellFormat.topMargin):e.rowFormat.hasValue("topMargin")?Pa.convertPointToPixel(e.rowFormat.topMargin):Pa.convertPointToPixel(e.ownerTable.tableFormat.topMargin))>t&&(t=r)}return t},t.prototype.getMaxBottomCellMargin=function(e){if((0,a.isNullOrUndefined)(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=0;(r=n.cellFormat.hasValue("bottomMargin")?Pa.convertPointToPixel(n.cellFormat.bottomMargin):e.rowFormat.hasValue("bottomMargin")?Pa.convertPointToPixel(e.rowFormat.bottomMargin):Pa.convertPointToPixel(e.ownerTable.tableFormat.bottomMargin))>t&&(t=r)}return t},t.prototype.layoutCell=function(e,t,i){var n=this.viewer;if(this.addTableCellWidget(e,n.clientActiveArea,t,i),this.updateTopBorders(e),n.updateClientAreaForCell(e,!0),0===e.childWidgets.length){var r=new Rl;r.characterFormat=new ka,r.paragraphFormat=new ba,r.index=0;var o=new zl(r);r.childWidgets.push(o),e.childWidgets.push(r),r.paragraphFormat.borders=new va}for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];n.updateClientAreaForBlock(a,!0),a.containerWidget=e,this.layoutBlock(a,0),n.updateClientAreaForBlock(a,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1)},t.prototype.isInsertTable=function(){return!(!this.documentHelper.owner.editorHistoryModule||!this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo||"InsertTable"!==this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action)},t.prototype.updateTopBorders=function(e){if(e.updatedTopBorders=[],0===e.ownerTable.tableFormat.cellSpacing){var t=e.cellFormat.borders.top;(!t.isBorderDefined||t.isBorderDefined&&"None"===t.lineStyle&&0===t.lineWidth&&t.hasValue("color"))&&(t=e.ownerRow.rowFormat.borders.horizontal),t.isBorderDefined||(t=e.ownerRow.ownerTable.tableFormat.borders.horizontal);for(var i=e.x-e.margin.left,n=e.x+e.width+e.margin.right,r=this.getAdjacentRowCell(e,i,n,e.ownerRow.indexInOwner-1),o=0;o<r.length;o++){var s=r[o],a=s.cellFormat.borders.bottom;(!a.isBorderDefined||a.isBorderDefined&&"None"===a.lineStyle&&0===a.lineWidth&&a.hasValue("color"))&&(a=s.ownerRow.rowFormat.borders.horizontal),a.isBorderDefined||(a=s.ownerRow.ownerTable.tableFormat.borders.horizontal);var l=void 0;l="None"===t.lineStyle||"Cleared"===t.lineStyle?a:"Cleared"===a.lineStyle||"None"===a.lineStyle?t:e.getBorderBasedOnPriority(t,a);var d=s.x-s.margin.left,h=s.x+s.width+s.margin.right;if(0===o&&i<d&&e.updatedTopBorders.push({border:t,width:d-i}),l){var c=0;(c=Pa.round(h,2)===Pa.round(n,2)&&Pa.round(d,2)===Pa.round(i,2)?n-i:Pa.round(d,2)>=Pa.round(i,2)&&Pa.round(h,2)>=Pa.round(n,2)?n-d:Pa.round(d,2)>=Pa.round(i,2)&&Pa.round(h,2)<=Pa.round(n,2)?h-d:Pa.round(d,2)<=Pa.round(i,2)&&Pa.round(h,2)<=Pa.round(n,2)?h-i:(Pa.round(d,2)<=Pa.round(i,2)&&(Pa.round(h,2),Pa.round(n,2)),n-i))<0&&(c=0),e.updatedTopBorders.push({border:l,width:c})}o===r.length-1&&n>h&&e.updatedTopBorders.push({border:t,width:n-h})}}},t.prototype.shiftLayoutedItems=function(e,t){if((0,a.isNullOrUndefined)(this.documentHelper.blockToShift)||(0,a.isNullOrUndefined)(this.documentHelper.blockToShift.containerWidget)||this.viewer.owner.editorModule&&this.viewer.owner.editorModule.restrictLayout)return this.documentHelper.blockToShift=void 0,this.checkAndShiftEndnote(),void(e||this.documentHelper.removeEmptyPages());var i=this.documentHelper.blockToShift,n=this.getColumnBreak(i.bodyWidget);if(!n&&this.viewer instanceof kl&&!this.isMultiColumnSplit&&i===i.bodyWidget.firstChild&&!(0,a.isNullOrUndefined)(i.bodyWidget.previousRenderedWidget)&&i.bodyWidget.sectionIndex!==i.bodyWidget.previousRenderedWidget.sectionIndex&&i.bodyWidget.previousRenderedWidget.sectionFormat.columns.length>1){var r=i.bodyWidget.previousRenderedWidget,o=this.getBodyWidget(r,!1);(0,a.isNullOrUndefined)(o.nextRenderedWidget)||o.page!==o.nextRenderedWidget.page||this.splitBodyWidgetBasedOnColumn(r)}var s=!1,l=this.documentHelper.pages[this.documentHelper.pages.length-1];l.bodyWidgets[l.bodyWidgets.length-1];if((!n||e&&this.isSectionEndsWithColumnBreak(i.bodyWidget))&&this.viewer instanceof kl&&!this.isMultiColumnSplit&&i.bodyWidget.sectionFormat.columns.length>1){if(0!==i.bodyWidget.columnIndex||i!==i.bodyWidget.firstChild||(0,a.isNullOrUndefined)(i.previousRenderedWidget)||i.bodyWidget.page!==i.previousRenderedWidget.bodyWidget.page||(i.bodyWidget.y=this.viewer.clientActiveArea.y),s=i===i.bodyWidget.firstChild,this.reLayoutMultiColumn(i.bodyWidget,s,i.index),(0,a.isNullOrUndefined)(this.documentHelper.blockToShift))return;i=this.documentHelper.blockToShift}var d=i.bodyWidget.index;this.reLayoutOrShiftWidgets(i,this.viewer,t);for(var h=!0,c=i.getSplitWidgets(),p=c[c.length-1].nextRenderedWidget,u=[];p instanceof Ll&&(p.bodyWidget.index===d||"NoBreak"===p.bodyWidget.sectionFormat.breakCode&&i.bodyWidget.sectionFormat.pageWidth===p.bodyWidget.sectionFormat.pageWidth&&i.bodyWidget.sectionFormat.pageHeight===p.bodyWidget.sectionFormat.pageHeight);){if(t&&0===p.bodyWidget.sectionFormat.columns.length)return;if((!(n=this.getColumnBreak(p.bodyWidget))||e&&this.isSectionEndsWithColumnBreak(p.bodyWidget))&&this.viewer instanceof kl&&!this.isMultiColumnSplit&&p.bodyWidget.sectionFormat.columns.length>1){if(0!==p.bodyWidget.columnIndex||p!==p.bodyWidget.firstChild||(0,a.isNullOrUndefined)(p.previousRenderedWidget)||p.bodyWidget.page!==p.previousRenderedWidget.bodyWidget.page||(p.bodyWidget.y=this.viewer.clientActiveArea.y),s=p===p.bodyWidget.firstChild,this.reLayoutMultiColumn(p.bodyWidget,s,p.index),(0,a.isNullOrUndefined)(this.documentHelper.blockToShift))return;p=this.documentHelper.blockToShift}var g,m=i.getSplitWidgets();g=m[m.length-1],h=!1;var f=void 0;if(m=(i=p).getSplitWidgets(),(i instanceof Rl||i instanceof Al)&&(f=m[0]),!this.documentHelper.owner.editorModule.isFootnoteElementRemoved&&g.containerWidget===f.containerWidget&&Pa.round(f.y,2)===Pa.round(this.viewer.clientActiveArea.y,2)&&(0,a.isNullOrUndefined)(f.nextWidget))break;if((0,a.isNullOrUndefined)(g.floatingElements),h=!0,i.isFieldCodeBlock||this.reLayoutOrShiftWidgets(i,this.viewer,t,u),this.keepWithNext&&(i=this.documentHelper.blockToShift,this.keepWithNext=!1),!this.isMultiColumnSplit&&n&&i.bodyWidget.sectionFormat.numberOfColumns>1&&i.bodyWidget.nextWidget&&i.nextRenderedWidget&&i.bodyWidget.index!==i.nextRenderedWidget.bodyWidget.index){var v=this.viewer.clientActiveArea.y,y=this.viewer.clientActiveArea.height;this.viewer.updateClientArea(i.bodyWidget.nextWidget,i.bodyWidget.nextWidget.page),this.viewer.clientActiveArea.height=y,this.viewer.clientActiveArea.y=v}if(this.isMultiColumnSplit&&i.bodyWidget.sectionFormat.numberOfColumns>1&&i===i.bodyWidget.lastChild&&!(0,a.isNullOrUndefined)(i.bodyWidget.nextRenderedWidget)&&i.bodyWidget.sectionIndex!==i.bodyWidget.nextRenderedWidget.sectionIndex&&i.bodyWidget.page===i.bodyWidget.nextRenderedWidget.page)return;p=(c=i.getSplitWidgets())[c.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(i,h),this.documentHelper.blockToShift=void 0;var w=this.viewer;if(w.owner.editorModule.isFootnoteElementRemoved){var b=this.documentHelper.pages[this.documentHelper.pages.length-1],C=b.bodyWidgets[b.bodyWidgets.length-1],x=b.endnoteWidget;if(!(0,a.isNullOrUndefined)(x)){var I=this.viewer.clientArea.clone(),k=this.viewer.clientActiveArea.clone(),F=C.y;if(C.childWidgets.length>0){var P=C.childWidgets[C.childWidgets.length-1];F=P.y+P.height}this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-F,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=F,this.layoutfootNote(x),this.viewer.clientArea=I,this.viewer.clientActiveArea=k}}this.documentHelper.removeEmptyPages(),this.updateFieldElements(e);var S=this.documentHelper.pages[0];if(S.bodyWidgets[0].sectionIndex>0){var T=S;do{this.documentHelper.layout.layoutHeaderFooter(T.bodyWidgets[0],this.viewer,T),T=T.nextPage}while(T);for(;S.bodyWidgets[0].sectionIndex>0;)this.documentHelper.owner.editorModule.updateSectionIndex(void 0,S.bodyWidgets[0],!1)}i.bodyWidget instanceof Dl||this.isRelayoutFootnote||!i.bodyWidget.page.endnoteWidget||this.checkAndShiftEndnote(!0),(this.documentHelper.owner.enableLockAndEdit||this.documentHelper.owner.enableHeaderAndFooter)&&e||this.isMultiColumnSplit||w.updateScrollBars()},t.prototype.isSectionEndsWithColumnBreak=function(e){return!(0,a.isNullOrUndefined)(e)&&e.childWidgets.length>0&&e.lastChild instanceof Rl&&e.lastChild.isEndsWithColumnBreak},t.prototype.checkAndShiftEndnote=function(e){if(this.documentHelper.owner.selectionModule){var t=this.documentHelper.owner.selectionModule.end.paragraph;if(t.isInsideTable&&(t=this.getParentTable(t)),!t||t.isInHeaderFooter||t.bodyWidget.containerWidget instanceof Dl||!(0,a.isNullOrUndefined)(t.nextRenderedWidget)&&!e)this.isEndnoteContentChanged&&e&&!this.isRelayoutFootnote&&this.reLayoutEndnote();else if(!(t.bodyWidget instanceof Dl)&&!this.isRelayoutFootnote&&t.bodyWidget.page.endnoteWidget){var i=t.bodyWidget.page,n=this.viewer.clientActiveArea.clone(),r=this.getBodyWidget(i.bodyWidgets[i.bodyWidgets.length-1],!0);this.viewer.updateClientArea(r,r.page);var o=this.getNextWidgetHeight(r);o>0&&(this.viewer.clientActiveArea.height-=o-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=o),this.layoutfootNote(i.endnoteWidget),this.viewer.clientActiveArea=n}}},t.prototype.updateFieldElements=function(e){for(var t=0;t<this.documentHelper.fields.length;t++){var i=this.documentHelper.fields[t];if((this.viewer instanceof kl||this.viewer instanceof Fl&&!(i.line.paragraph.containerWidget instanceof cd||i.line.paragraph.bodyWidget instanceof Bl))&&!(0,a.isNullOrUndefined)(this.documentHelper.selection)){var n=this.documentHelper.selection.getFieldCode(i),r=/^(?!.*\bhyperlink\b)(?!.*\bnumpages\b).*\bpage\b.*$/;if(!(0,a.isNullOrUndefined)(n)&&(n.toLowerCase().match("numpages")||n.toLowerCase().match("sectionpages")||r.test(n.toLowerCase())&&e)&&!(0,a.isNullOrUndefined)(i.fieldSeparator)){var o=i.fieldSeparator.nextNode;if(!(0,a.isNullOrUndefined)(o)){var s=o.text,l=i.line.paragraph;if(!(0,a.isNullOrUndefined)(l.containerWidget)&&l.containerWidget instanceof Ol&&-1===l.containerWidget.indexInOwner)continue;if(!(0,a.isNullOrUndefined)(l.bodyWidget)&&!(0,a.isNullOrUndefined)(l.bodyWidget.page)&&-1!==l.bodyWidget.page.index){if(r.test(n.toLowerCase())){var d=l.bodyWidget.page.index+1;o.text=d.toString()}else o.text=this.documentHelper.pages.length.toString();if(s!==o.text){o.isWidthUpdated=!1;var h=l.childWidgets.indexOf(i.line),c=i.line.children.indexOf(o);l.isInsideTable?this.reLayoutParagraph(l,h,c):this.reLayoutLine(l,h,!1,!1,!0)}}}}}}},t.prototype.reLayoutOrShiftWidgets=function(e,t,i,n){var r=e,o=!1;if(this.isNeedToRelayout(e.bodyWidget)||this.isPageBreakInsideContentControl(e)?(this.isMultiColumnSplit||this.updateContainerForTable(r,t),r instanceof Al&&(r=r.combineWidget(this.viewer),this.clearTableWidget(r,!0,!0,!0)),t.updateClientAreaForBlock(r,!0),r.wrapTextAround&&(r.isLayouted=!1),this.isRelayout=!0,this.layoutBlock(r,0),this.isRelayout=!1,t.updateClientAreaForBlock(r,!1),o=!0):this.shiftWidgetsBlock(r,t,n),this.documentHelper.pages.indexOf(r.bodyWidget.page)>0&&r===r.bodyWidget.childWidgets[0]&&r instanceof Rl)for(var s=r.bodyWidget.childWidgets[0].childWidgets[0].children,a=0;a<s.length;a++){var l=s[a];l.margin.top>0&&l.margin.top===this.getBeforeSpacing(l.paragraph)&&(l.margin.top-=this.getBeforeSpacing(l.paragraph))}!this.viewer.owner.editorModule||o||i||this.viewer.owner.editorModule.updateRenderedListItems(r),!this.isRelayoutFootnote&&r.bodyWidget.page.footnoteWidget&&(this.islayoutFootnote=!0,this.layoutfootNote(r.bodyWidget.page.footnoteWidget))},t.prototype.isNeedToRelayout=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t];if(i instanceof Al||i instanceof dd&&("Square"===i.textWrappingStyle||"TopAndBottom"===i.textWrappingStyle))return!0}return!1},t.prototype.shiftWidgetsBlock=function(e,t,i){e instanceof Rl?this.shiftWidgetsForPara(e,t,i):e instanceof Al&&(!(0,a.isNullOrUndefined)(i)&&i.length>0&&e.previousRenderedWidget&&e.previousRenderedWidget.y+e.previousRenderedWidget.height+e.height>this.viewer.clientArea.bottom&&(i.length=0),this.shiftWidgetsForTable(e,t))},t.prototype.shiftWidgetsForPara=function(e,t,i){if(!(e.height>t.clientArea.height+t.clientArea.y)||this.documentHelper.owner.enableHeaderAndFooter){if(e.isEmpty()){var n=e.previousRenderedWidget;if(e.isSectionBreak&&e.index>0){if(n instanceof Rl)return this.layoutSectionBreakParagraph(e,n),void(!n.isEndsWithPageBreak&&this.viewer.clientActiveArea.y<=e.y&&this.viewer.cutFromTop(e.y+e.height));if(n instanceof Al&&"Word2013"!==this.documentHelper.compatibilityMode)return}}e.bodyWidget;for(var r=this.getBodyWidgetOfPreviousBlock(e,0),o=r.bodyWidget,s=r.index,l=void 0,d=!1,h=!0,c=0;c<e.getSplitWidgets().length;c++){var p=e.getSplitWidgets()[c],u=this.getBodyWidget(p.bodyWidget,!0);if(!this.isMultiColumnSplit||p===e){if(h&&!(0,a.isNullOrUndefined)(l)){var g=!!l.lastChild&&l.lastChild.isEndsWithPageBreak,m=!!l.lastChild&&l.lastChild.isEndsWithColumnBreak;if(this.shiftToPreviousWidget(p,t,l,g,m),this.updateFloatingElementPosition(l),((0,a.isNullOrUndefined)(p.childWidgets)||0===p.childWidgets.length)&&!g&&!m){c--;continue}o!==p.containerWidget&&(o=p.containerWidget,g&&l!==p.previousSplitWidget&&t.updateClientAreaByWidget(p)),l=void 0}var f=[];d||(f=this.getFootNoteWidgetsOf(p));var v=0,y=!1;if(!this.isMultiColumnSplit&&!p.isInsideTable&&!(0,a.isNullOrUndefined)(i)&&i.length>0&&this.isFitInClientArea(p,t,f)&&p.previousRenderedWidget&&p.bodyWidget.page===p.previousRenderedWidget.bodyWidget.page){v=this.getFootNoteHeight(i);var w=this.updateFootnoteHeight(p,!1,!0);p.previousRenderedWidget.y+p.previousRenderedWidget.height+v+p.firstChild.height>w&&this.viewer.clientArea.bottom<=w&&(y=!0)}if(d=!1,this.isFitInClientArea(p,t,f)&&!y||t.clientActiveArea.height<p.firstChild.height&&this.viewer.clientActiveArea.y===this.viewer.clientArea.y||this.isMultiColumnSplit&&p.bodyWidget.sectionFormat.numberOfColumns-1!==p.bodyWidget.columnIndex){if(!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(f)&&f.length>0)for(var b=0;b<f.length;b++)i.push(f[b]);if(this.keepWithNext&&(this.updateClientPositionForBlock(p.containerWidget.firstChild,p),this.keepWithNext=!1),l=p,t.updateClientAreaForBlock(p,!0,void 0,!1,!0),p.isEmpty()&&!(0,a.isNullOrUndefined)(p.paragraphFormat)&&("Center"===p.paragraphFormat.textAlignment||"Right"===p.paragraphFormat.textAlignment||"Justify"===p.paragraphFormat.textAlignment&&p.paragraphFormat.bidi)&&-1===p.paragraphFormat.listFormat.listId?this.updateXPositionForEmptyParagraph(t.clientActiveArea,p):p.x=t.clientActiveArea.x,t.updateClientAreaForBlock(p,!1),p.y=t.clientActiveArea.y,this.updateFloatingElementPosition(p),t.cutFromTop(t.clientActiveArea.y+p.height),(0,a.isNullOrUndefined)(o)||o===p.containerWidget||this.isMultiColumnSplit){if(p.containerWidget instanceof Ol&&p.containerWidget.firstChild===p&&p.previousRenderedWidget&&p.previousRenderedWidget instanceof Rl&&"NoBreak"==p.previousRenderedWidget.containerWidget.sectionFormat.breakCode&&p.containerWidget.page.index!==p.previousRenderedWidget.containerWidget.page.index&&p.containerWidget.index!==p.previousRenderedWidget.containerWidget.index){var C=p.previousRenderedWidget.bodyWidget,x=C.sectionFormat.breakCode;C.sectionFormat.columns.length>1&&(C=this.getBodyWidget(C,!0)),(0,a.isNullOrUndefined)(C.previousRenderedWidget)||"NoBreak"!==C.sectionFormat.breakCode||"NewPage"!=C.previousRenderedWidget.sectionFormat.breakCode||C.page.index!==C.previousRenderedWidget.page.index||(x=C.previousRenderedWidget.sectionFormat.breakCode);w=Pa.round(this.getNextWidgetHeight(C)+p.height,2);if(!p.previousRenderedWidget.containerWidget.lastChild.isEndsWithPageBreak&&!p.previousRenderedWidget.containerWidget.lastChild.isEndsWithColumnBreak&&w<=Pa.round(this.viewer.clientActiveArea.bottom,2)&&"NoBreak"===x){for(var I=p.previousRenderedWidget.bodyWidget.page,k=p.containerWidget.page,F=0;F<k.bodyWidgets.length;F++){var P=k.bodyWidgets[F];k.bodyWidgets.splice(k.bodyWidgets.indexOf(P),1),I.bodyWidgets.splice(I.bodyWidgets.length,0,P),P.page=I,F--}p.containerWidget.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}else if(s++,o.lastChild.isEndsWithPageBreak||o.lastChild.isEndsWithColumnBreak||this.isPageBreakInsideContentControl(o.lastChild)||this.updateContainerWidget(p,o,s,!0,f),f.length>0&&o.page.footnoteWidget)for(b=0;b<f.length;b++)-1===o.page.footnoteWidget.bodyWidgets.indexOf(f[b])&&p.bodyWidget.page.index!=f[b].page.index&&(o.page.footnoteWidget.bodyWidgets.push(f[b]),o.page.footnoteWidget.height+=f[b].height);if(!this.isInitialLoad&&h&&p.bodyWidget.sectionFormat.columns.length>1&&p===p.bodyWidget.firstChild&&!(0,a.isNullOrUndefined)(u.previousWidget)&&u.page===u.previousWidget.page){this.viewer.updateClientArea(p.bodyWidget,p.bodyWidget.page),u=this.getBodyWidget(u.previousWidget,!0);var S=this.getNextWidgetHeight(u);p.bodyWidget.y=S,this.viewer.clientActiveArea.height-=S-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=S,h=!1,c--}if((p.isEndsWithPageBreak&&!this.isPageBreakInsideField(p)||p.isEndsWithColumnBreak||this.isPageBreakInsideContentControl(p))&&this.viewer instanceof kl){P=this.createOrGetNextBodyWidget(o,this.viewer);P=this.moveBlocksToNextPage(p,!0),t.updateClientArea(P,P.page)}}else{(0,a.isNullOrUndefined)(i)||(i.length=0);var T=p.previousRenderedWidget;g=!1,m=!1;T instanceof Rl&&T.isEndsWithPageBreak&&this.viewer instanceof kl&&(g=!0),T instanceof Rl&&T.isEndsWithColumnBreak&&this.viewer instanceof kl&&(m=!0);var H=this.splitWidget(p,t,o,s+1,g,f,m,y?v:0);this.updateFloatingElementPosition(p),l=void 0,o!==p.containerWidget&&(o=p.containerWidget,c--,f.length>0&&(d=!0)),s=o.childWidgets.indexOf(p),H&&(o=e.getSplitWidgets()[c+1].containerWidget)}}}this.skipUpdateContainerWidget=!1}},t.prototype.updateFloatingElementPosition=function(e){if(e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=0;if(i instanceof hd&&"Inline"===i.textWrappingStyle){var r=i.line.indexInOwner,o=0;n=Pa.convertPointToPixel(i.textFrame.marginTop);for(var s=0;s<r;s++)(0,a.isNullOrUndefined)(e.childWidgets[s])||(o+=e.childWidgets[s].height);i.y=e.y+o}else{var l=this.getFloatingItemPoints(i);i.y=l.y,i.x=l.x}i instanceof hd&&this.updateChildLocationForCellOrShape(i.y+n,i,void 0,!1,!0)}},t.prototype.isPageBreakInsideField=function(e){for(var t=!1,i=!1,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];n+=o.height;for(var s=0;s<o.children.length;s++){var a=o.children[s];a instanceof _l&&(0===a.fieldType?i=!0:2!==a.fieldType&&1!==a.fieldType||(i=!1)),t=!(!i&&"\f"===a.text)}}return t&&0===e.height&&this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n),t},t.prototype.isPageBreakInsideContentControl=function(e){var t=!1;if(e instanceof Rl&&e.childWidgets.length>0){var i=e.childWidgets[e.childWidgets.length-1];if(i.children.length>0){var n=i.children[i.children.length-1];n instanceof id&&"Block"===n.contentControlWidgetType&&!(0,a.isNullOrUndefined)(n.previousElement)&&n.previousElement instanceof Zl&&"\f"===n.previousElement.text&&(t=!0)}}return t},t.prototype.getFootNotesOfBlock=function(e,t){if((0,a.isNullOrUndefined)(t)&&(t=[]),e.childWidgets.length>0)for(var i=0;i<this.documentHelper.footnoteCollection.length;i++)this.documentHelper.footnoteCollection[i].line.paragraph===e&&t.push(this.documentHelper.footnoteCollection[i]);return t},t.prototype.getFootNotesWidgetsInLine=function(e){for(var t=[],i=0;i<e.children.length;i++){var n=e.children[i];n instanceof Yl&&t.push(n)}return this.getFootNoteWidgetsBy(e.paragraph,t)},t.prototype.getFootNoteWidgetsBy=function(e,t){var i=[];if(e.bodyWidget.page.footnoteWidget)for(var n=0;n<e.bodyWidget.page.footnoteWidget.bodyWidgets.length;n++)for(var r=0;r<t.length;r++)e.bodyWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.page.footnoteWidget.bodyWidgets[n]);if(0===i.length&&!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(n=0;n<e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[n]);else if(!(0,a.isNullOrUndefined)(e.bodyWidget.previousRenderedWidget)&&e.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(n=0;n<e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[n]);else if(!(0,a.isNullOrUndefined)(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.nextRenderedWidget.page.footnoteWidget)for(n=0;n<e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets.length;n++)for(r=0;r<t.length;r++)e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[n].footNoteReference===t[r]&&i.push(e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[n]);return i},t.prototype.getFootNoteWidgetsOf=function(e,t){var i=[],n=[];if(e instanceof Al)for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)for(var a=o.childWidgets[s],l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l];if(d instanceof Al)for(var h=this.getFootNoteWidgetsOf(d,t),c=0;c<h.length;c++)-1===i.indexOf(h[c])&&i.push(h[c]);else n=this.getFootNotesOfBlock(d,n);var p=this.getFootNoteWidgetsBy(d,n);if(t&&0===p.length)for(var u=0;u<n.length;u++)-1===i.indexOf(n[u].bodyWidget)&&i.push(n[u].bodyWidget);else for(c=0;c<p.length;c++)-1===i.indexOf(p[c])&&i.push(p[c])}else if((n=this.getFootNotesOfBlock(e)).length>0&&(i=this.getFootNoteWidgetsBy(e,n)),t&&0===i.length)for(var g=0;g<n.length;g++)i.push(n[g].bodyWidget);return i},t.prototype.getFootNodeWidgetsToShiftToPage=function(e){for(var t,i=e.getSplitWidgets(),n=[],r=e.containerWidget,o=0;o<i.length;o++)for(var s=this.getFootNoteWidgetsOf(i[o]),a=0;a<s.length;a++)r!==(t=s[a].containerWidget)&&n.push(s[a]);return{footNoteWidgets:n,fromBodyWidget:t,toBodyWidget:r}},t.prototype.shiftTableWidget=function(e,t,i){void 0===i&&(i=!1),e.isBidiTable=e.bidi,"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(0,a.isNullOrUndefined)(e.firstChild.firstChild.leftMargin)||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-Pa.convertPointToPixel(e.firstChild.firstChild.leftMargin));var n,r,o=[e];this.addTableWidget(this.viewer.clientActiveArea,o),this.viewer.updateClientAreaTopOrLeft(e,!0);var s=0;if(e.wrapTextAround?(n=this.viewer.clientActiveArea.clone(),r=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(o,e,!0,n,r)):e.containerWidget instanceof cd||(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(s=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x)),e.childWidgets.length>0){var l=e.childWidgets[0].rowFormat.isHeader;e.header=l,e.continueHeader=l,e.headerHeight=0}var d=e.childWidgets[0];for(this.updateFootnoteHeight(e,!0),this.documentHelper.viewer instanceof kl&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e));d;)d=(d=this.shiftRowWidget(o,d,i)).nextRow;return this.updateFootnoteHeight(e,!1),this.updateWidgetsToPage(o,[],e,!0),s>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-s),e.wrapTextAround&&this.updateClientAreaForWrapTable(o,e,!1,n,r),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||e.wrapTextAround||(0,a.isNullOrUndefined)(e.firstChild.firstChild.leftMargin)||(this.viewer.clientArea.x=this.viewer.clientArea.x+Pa.convertPointToPixel(e.firstChild.firstChild.leftMargin)),o[o.length-1]},t.prototype.shiftRowWidget=function(e,t,i){void 0===i&&(i=!1);var n=this.viewer;i&&(t.height=0);var r=t.ownerTable.isInsideTable;r||this.updateExistingFootnoteHeight(t);var o=[t];this.addTableRowWidget(n.clientActiveArea,o),n.updateClientAreaForRow(t,!0);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s];i&&(a.height=0),this.shiftCellWidget(a,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i)}if(n.updateClientAreaForRow(t,!1),!r){var l=this.footnoteHeight;this.updateFootnoteToBody(t,this.layoutedFootnoteElement),this.footnoteHeight=l}return this.updateWidgetsToTable(e,o,t,!1),r||(this.layoutedFootnoteElement=[]),o[o.length-1]},t.prototype.updateFootnoteToBody=function(e,t){this.layoutFootnoteInSplittedRow(e,this.getFootnoteBody(t)),(0,a.isNullOrUndefined)(e.ownerTable.footnoteElement)&&(e.ownerTable.footnoteElement=[]);for(var i=0;i<t.length;i++)e.ownerTable.footnoteElement.push(t[i])},t.prototype.getFootnoteBody=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].bodyWidget);return t},t.prototype.shiftCellWidget=function(e,t,i,n){(0,a.isNullOrUndefined)(n)&&(n=!1);var r=this.viewer;this.addTableCellWidget(e,r.clientActiveArea,t,i);var o=this.viewer.clientActiveArea.height;r.updateClientAreaForCell(e,!0);for(var s=0;s<e.childWidgets.length;s++){var l=e.childWidgets[s],d=s!==e.childWidgets.length-1;r.updateClientAreaForBlock(l,!0),l instanceof Rl?this.shiftParagraphWidget(l,d):this.shiftTableWidget(l,r,n),r.updateClientAreaForBlock(l,!1)}this.updateWidgetToRow(e),r.updateClientAreaForCell(e,!1),e.ownerTable.isInsideTable||(this.viewer.clientActiveArea.height=o)},t.prototype.shiftParagraphWidget=function(e,t){if(this.addParagraphWidget(this.viewer.clientActiveArea,e),e.floatingElements.length>0)for(var i=0;i<e.floatingElements.length;i++){var n=e.floatingElements[i],r=0;if(n instanceof hd&&"Inline"===n.textWrappingStyle){var o=n.line.indexInOwner,s=0;r=Pa.convertPointToPixel(n.textFrame.marginTop);for(var a=0;a<o;a++)s+=e.childWidgets[a].height;n.y=e.y+s}else{var l=this.getFloatingItemPoints(n);n.y=l.y,n.x=l.x}n instanceof hd&&this.updateChildLocationForCellOrShape(n.y+r,n)}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height);for(var d=this.getFootNoteWidgetsOf(e,!0),h=0;h<d.length;h++)this.layoutedFootnoteElement.push(d[h].footNoteReference);this.footnoteHeight+=this.getFootNoteHeight(d),this.updateWidgetToPage(this.viewer,e,t)},t.prototype.updateContainerForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),n=i.bodyWidget,r=i.index,o=!(0,a.isNullOrUndefined)(n.lastChild)&&!(0,a.isNullOrUndefined)(n.lastChild.lastChild)&&n.lastChild.lastChild.isEndsWithPageBreak,s=!(0,a.isNullOrUndefined)(n.lastChild)&&!(0,a.isNullOrUndefined)(n.lastChild.lastChild)&&n.lastChild.lastChild.isEndsWithColumnBreak;n!==e.containerWidget&&(o||s?t.updateClientArea(e.bodyWidget,e.bodyWidget.page):this.updateContainerWidget(e,n,r+1,!0)),(e.isInHeaderFooter||this.viewer instanceof Fl)&&(e.containerWidget.height-=e.height)},t.prototype.shiftWidgetsForTable=function(e,t){this.updateContainerForTable(e,t),this.viewer.updateClientAreaForBlock(e,!0,void 0,!1,!0),this.updateVerticalPositionToTop(e,!0);var i=e.combineWidget(this.viewer);this.documentHelper.layout.updateChildLocationForTable(i.y,i),this.clearTableWidget(i,!0,!1,!1,!0),this.shiftTableWidget(i,this.viewer),this.updateVerticalPositionToTop(e,!1),this.viewer.updateClientAreaForBlock(e,!1)},t.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var n=e.getSplitWidgets()[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.documentHelper.layout.updateCellVerticalPosition(a,t,!1)}},t.prototype.splitWidget=function(e,t,i,n,r,o,s,l){var d=e.childWidgets[0],h=e.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?e.height:this.getMaxElementHeight(d),c=e.getSplitWidgets(),p=e.containerWidget;h=this.getMaximumLineHeightToSplit(e,h,t);var u=this.getFootNotesWidgetsInLine(d);if((0,a.isNullOrUndefined)(e.previousWidget)&&u.length>0)for(var g=0;g<u.length;g++)for(var m=0;m<u[g].childWidgets.length;m++)h+=u[g].childWidgets[m].height;var f=0;if(!(0,a.isNullOrUndefined)(l)&&l>0&&(f=l),t.clientActiveArea.height>=h+f&&!r&&!s){var v=void 0,y=c.indexOf(e);y<c.length-1?p=(v=c[y+1]).containerWidget:((v=new Rl).index=e.index,v.characterFormat=e.characterFormat,v.paragraphFormat=e.paragraphFormat,v.width=e.width,v.x=e.x,v.y=e.y,c.push(v)),i===e.containerWidget||this.skipUpdateContainerWidget||this.updateContainerWidget(e,i,n,!0);for(g=e.childWidgets.length-1;g>0;g--){var w=e.childWidgets[g];if(this.isFitInClientArea(e,t,void 0)){1===v.childWidgets.length&&(this.updateParagraphWidgetInternal(w,v,0),this.skipUpdateContainerWidget=!0);break}var b=e.childWidgets[g];this.updateParagraphWidgetInternal(b,v,0)}if((0,a.isNullOrUndefined)(v.containerWidget)&&v.childWidgets.length>0){var C=t.clientActiveArea.y,x=new Tl(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),I=new Tl(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height),k=e.bodyWidget.page;if(p=this.moveBlocksToNextPage(e,!1,-1),v.containerWidget=p,p.childWidgets.splice(0,0,v),k===p.page)return e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=C,t.updateClientArea(p,p.page),v=this.addParagraphWidget(this.viewer.clientActiveArea,v),!0;if(p.height+=v.height,p!=i&&this.moveFootNotesToPage(o,i,p),1===p.childWidgets.length&&p.firstChild instanceof Rl&&p.firstChild.equals(e))return e.y=C,!0;t.clientArea=x,t.clientActiveArea=I}}else{var F=void 0,P=!1,S=0;t.columnLayoutArea.setColumns(i.sectionFormat),p=this.createOrGetNextBodyWidget(i,this.viewer);var T=this.alignBlockElement(e);if(this.isInitialLoad||(0,a.isNullOrUndefined)(T.node)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||!(0,a.isNullOrUndefined)(e.previousSplitWidget)||(F=T.node instanceof Ul?this.splitRow(T.node):T.node).containerWidget instanceof Ol&&F.containerWidget.firstChild!==F&&(S=F instanceof Al?0:parseInt(T.position.index,10),e=F,P=!0,!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&e.nextRenderedWidget instanceof Rl&&(this.keepWithNext=!0,this.documentHelper.blockToShift=e.nextRenderedWidget)),e.containerWidget!==p||P){k=e.bodyWidget.page;if(i!==(p=this.moveBlocksToNextPage(e,!0))){if(t.updateClientArea(p,p.page),S>0&&this.keepWithNext){this.viewer.updateClientAreaForBlock(e,!0);var H=void 0;e instanceof Al?this.addTableWidget(this.viewer.clientActiveArea,[e]):H=p.firstChild instanceof Rl&&p.firstChild.equals(e)?p.firstChild:new Rl,(H=this.moveChildsToParagraph(e,S,H)).containerWidget=p;for(var E=0;E<H.floatingElements.length;E++){var N=H.floatingElements[E];N.line.paragraph.bodyWidget!==e.bodyWidget&&"Inline"!==N.textWrappingStyle&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(N),1)}e=H,-1===p.childWidgets.indexOf(e)&&p.childWidgets.splice(0,0,e),this.viewer.updateClientAreaLocation(e,this.viewer.clientActiveArea),this.layoutBlock(e,0,!0),this.viewer.updateClientAreaForBlock(e,!1)}else this.updateContainerWidget(e,p,0,!0),e instanceof Al?this.addTableWidget(this.viewer.clientActiveArea,[e]):this.addParagraphWidget(this.viewer.clientActiveArea,e);this.moveFootNotesToPage(o,i,p)}if(i.page===p.page)return i!==p||(t.updateClientArea(p,p.page),!1)}}return i===e.containerWidget?(e.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+e.height)):t.updateClientArea(p,p.page),!1},t.prototype.getMaximumLineHeightToSplit=function(e,t,i){if(i.clientActiveArea.height>=t&&!e.paragraphFormat.keepLinesTogether&&e.paragraphFormat.widowControl&&!(0,a.isNullOrUndefined)(e.previousWidget)&&(0,a.isNullOrUndefined)(e.previousSplitWidget))for(var n=e.height,r=e.childWidgets.length-1;r>=0;r--){var o=e.childWidgets[r],s=this.getMaxElementHeight(o);if(o.height>s&&(n-=o.height-s),i.clientActiveArea.height>=n){0===r&&(t=e.height);break}n-=o.height}return t},t.prototype.moveFootNotesToPage=function(e,t,i){if(e.length>0&&t.page.footnoteWidget&&t.page!==i.page){for(var n=-1,r=void 0,o=0,s=!1,a=0;a<e.length;a++)if(r=e[a],(n=t.page.footnoteWidget.bodyWidgets.indexOf(r))>=0){void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i);for(var l=0;l<i.page.footnoteWidget.bodyWidgets.length;l++){i.page.footnoteWidget.bodyWidgets[l].footNoteReference===r.footNoteReference&&(s=!0)}if(t.page.footnoteWidget.bodyWidgets.splice(n,1),i.page.footnoteWidget.bodyWidgets.indexOf(r)<0&&!s){i.page.footnoteWidget.bodyWidgets.length;var d=this.documentHelper.pages.indexOf(t.page),h=this.documentHelper.pages.indexOf(i.page);r.containerWidget=i.page.footnoteWidget,r.page=i.page,d>h?(i.page.footnoteWidget.bodyWidgets.push(r),o++):i.page.footnoteWidget.bodyWidgets.splice(o++,0,r),i.page.footnoteWidget.height+=r.height}t.page.footnoteWidget.height-=r.height}t.page.footnoteWidget&&0===t.page.footnoteWidget.bodyWidgets.length&&(t.page.footnoteWidget=void 0),void 0!==t.page.footnoteWidget&&this.layoutfootNote(t.page.footnoteWidget),void 0!==i.page.footnoteWidget&&this.layoutfootNote(i.page.footnoteWidget)}},t.prototype.addEmptyFootNoteToBody=function(e){var t=new Dl;t.footNoteType="Footnote",t.page=e.page;var i=new Rl;i.characterFormat=new ka,i.paragraphFormat=new ba,i.index=0;var n=new zl(i);i.childWidgets.push(n),t.height=this.documentHelper.textHelper.getParagraphMarkSize(i.characterFormat).Height,t.margin=new El(0,t.height,0,0),e.page.footnoteWidget=t},t.prototype.getMaxElementHeight=function(e){var t=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof md||2===e.children.length&&e.children[0]instanceof md&&e.children[1]instanceof md){if(t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0).height,t+=0,e.children.length>0)t<(n=e.children[0]).margin.top+n.height&&(t=n.margin.top+n.height)}else for(var i=0;i<e.children.length;i++){var n;t<(n=e.children[i]).margin.top+n.height&&(t=n.margin.top+n.height)}return t},t.prototype.createOrGetNextBodyWidget=function(e,t){t.columnLayoutArea.setColumns(e.sectionFormat);var i=t.columnLayoutArea.getNextColumnByBodyWidget(e);if(!(0,a.isNullOrUndefined)(i))return this.createOrGetNextColumnBody(e);var n,r=void 0;n=this.documentHelper.pages.indexOf(e.page);var o,s=void 0;if(o=e.index,n===this.documentHelper.pages.length-1||this.documentHelper.pages[n+1].sectionIndex!==o){var l=new Ol;l.sectionFormat=e.sectionFormat,l.index=e.index,s=t.createNewPage(l),this.documentHelper.pages[n+1].sectionIndex!==o&&this.documentHelper.insertPage(n+1,s),r=s.bodyWidgets[0]}else r=(s=this.documentHelper.pages[n+1]).bodyWidgets[0];return r},t.prototype.isFitInClientArea=function(e,t,i){var n=e.childWidgets[e.childWidgets.length-1],r=e.height,o=this.getMaxElementHeight(n);n.height>o&&(r-=n.height-o);var s=0;if(!(0,a.isNullOrUndefined)(i)&&i.length>0){i[0].containerWidget instanceof Dl&&(s=i[0].containerWidget.margin.top);for(var l=0;l<i.length;l++)for(var d=0;d<i[l].childWidgets.length;d++)s+=i[l].childWidgets[d].height}return t.clientActiveArea.height>=r+s},t.prototype.isLineInFootNote=function(e,t){for(var i=0;i<t.length;i++)if(t[i].line===e)return!0;return!1},t.prototype.shiftToPreviousWidget=function(e,t,i,n,r){var o=e.containerWidget,s=i.containerWidget,l=[],d=[];s!==o&&(l=this.getFootNotesOfBlock(e));for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h],p=this.getMaxElementHeight(c);if(this.isLineInFootNote(c,l)){for(var u=this.getFootNoteWidgetsBy(c.paragraph,l),g=0,m=0;m<u.length;m++)for(var f=u[m],v=0;v<f.childWidgets.length;v++)g+=f.childWidgets[v].height;u.length>0&&u[0].containerWidget&&(g+=u[0].containerWidget.margin.top),p+=g}if(!(t.clientActiveArea.height>=p)||n||r){var y=i.containerWidget;t.updateClientArea(y,y.page);var w=this.createOrGetNextBodyWidget(y,t);e.containerWidget!==w&&(w=this.moveBlocksToNextPage(e,!0)),y!==w&&((l=this.getFootNotesOfBlock(e)).length>0&&(d=d.concat(this.getFootNoteWidgetsBy(e,l)),s=w),this.updateContainerWidget(e,w,0,!0)),t.updateClientArea(w,w.page);break}if(l.length>0&&this.isLineInFootNote(c,l)&&(d=d.concat(this.getFootNoteWidgetsBy(c.paragraph,l))),this.updateParagraphWidgetInternal(c,i,i.childWidgets.length),h--,t.cutFromTop(t.clientActiveArea.y+c.height),(0,a.isNullOrUndefined)(e.childWidgets))break}!(0,a.isNullOrUndefined)(d)&&d.length>0&&o.page.footnoteWidget&&o!=s&&this.moveFootNotesToPage(d,o,s)},t.prototype.updateParagraphWidgetInternal=function(e,t,i){(0,a.isNullOrUndefined)(e.paragraph)||(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,(0,a.isNullOrUndefined)(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),((0,a.isNullOrUndefined)(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer)),!(0,a.isNullOrUndefined)(e.paragraph)&&e.paragraph.floatingElements.length>0&&this.shiftFloatingElements(e,t),t.childWidgets.splice(i,0,e),e.paragraph=t,t.height+=e.height,(0,a.isNullOrUndefined)(t.containerWidget)||(t.containerWidget.height+=e.height)},t.prototype.shiftFloatingElements=function(e,t){for(var i=0;i<e.children.length;i++)if(e.children[i]instanceof hd&&"Inline"===e.children[i].textWrappingStyle){var n=e.paragraph.floatingElements.indexOf(e.children[i]);n>=0&&(e.paragraph.floatingElements.splice(n,1),t.floatingElements.splice(n,0,e.children[i]))}},t.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof Ll;){if(t=t.nextWidget,this.viewer instanceof kl&&!this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.columns.length>1){var i=this.getBodyWidget(t.bodyWidget,!1);if(!(0,a.isNullOrUndefined)(i.nextRenderedWidget)&&i.page===i.nextRenderedWidget.page){this.splitBodyWidgetBasedOnColumn(t.bodyWidget);break}}this.reLayoutOrShiftWidgets(t,this.viewer)}},t.prototype.updateContainerWidget=function(e,t,i,n,r){if(!(e.containerWidget&&e.containerWidget.containerWidget instanceof Dl)){var o=e.containerWidget;if(!(0,a.isNullOrUndefined)(e.containerWidget)&&(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=t.height,((0,a.isNullOrUndefined)(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof Ol&&e.containerWidget!==t&&n)){var s=e.containerWidget.page;if(this.documentHelper.pages[this.documentHelper.pages.length-1]===s&&-1!==this.viewer.visiblePages.indexOf(s)&&this.documentHelper.scrollToBottom(),(0,a.isNullOrUndefined)(s.endnoteWidget)&&((0,a.isNullOrUndefined)(s.nextPage)||s.nextPage.bodyWidgets[0].index!==e.containerWidget.index)){var l=e.containerWidget;!(0,a.isNullOrUndefined)(l.nextRenderedWidget)&&l.nextRenderedWidget.sectionFormat.columns.length>1&&(l.nextRenderedWidget.columnIndex=l.columnIndex),e.containerWidget.destroyInternal(this.viewer)}}if(t.childWidgets.splice(i,0,e),e instanceof Rl&&!(0,a.isNullOrUndefined)(e.floatingElements))for(var d=0;d<e.floatingElements.length;d++){var h=e.floatingElements[d];"Inline"!==h.textWrappingStyle&&(t.floatingElements.push(h),e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(h),1),t.floatingElements.sort((function(e,t){return e.y-t.y})))}e instanceof Al&&e.wrapTextAround&&-1!==e.bodyWidget.floatingElements.indexOf(e)&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(e),1),t.height+=t.height,e.containerWidget=t,o&&o.page&&o.page.footnoteWidget&&r&&r.length>0&&this.moveFootNotesToPage(r,o,t)}},t.prototype.getBodyWidgetOfPreviousBlock=function(e,t){var i=void 0,n=e.previousRenderedWidget;return i=n&&n.containerWidget.equals(e.containerWidget)?n.containerWidget:e instanceof Al&&!(0,a.isNullOrUndefined)(e.containerWidget.previousRenderedWidget)&&e.containerWidget.index===e.containerWidget.previousRenderedWidget.index?e.containerWidget.previousRenderedWidget:e.containerWidget,t=n&&n.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(n):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},t.prototype.moveBlocksToNextPage=function(e,t,i,n,r,o){var s=e.bodyWidget;this.viewer.columnLayoutArea.setColumns(s.sectionFormat);var l=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(e.bodyWidget),d=void 0,h=void 0;if(!((0,a.isNullOrUndefined)(l)||e instanceof Rl&&e.isEndsWithPageBreak)&&((h=this.moveToNextColumnByBodyWidget(e,i)).columnIndex=l.index,h.y=e.bodyWidget.y,this.viewer.updateClientArea(h,h.page),this.viewer.clientActiveArea.height-=h.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=h.y,e.bodyWidget.sectionFormat.columns.length>1))for(var c=e.bodyWidget.columnIndex,p=e.bodyWidget.x+e.bodyWidget.sectionFormat.columns[c].width+e.bodyWidget.sectionFormat.columns[c].space,u=0;u<e.bodyWidget.floatingElements.length;u++)e.bodyWidget.floatingElements[u]instanceof hd&&p<e.bodyWidget.floatingElements[u].x+e.bodyWidget.floatingElements[u].width&&h.floatingElements.push(e.bodyWidget.floatingElements[u]);if((0,a.isNullOrUndefined)(h)){var g=!1,m=s.page,f=m.index+1;if(this.documentHelper.pages.length>f&&!this.isMultiColumnLayout)if(d=this.documentHelper.pages[f],!r||(0,a.isNullOrUndefined)(d)||(0,a.isNullOrUndefined)(d.endnoteWidget))(0,a.isNullOrUndefined)(d)||0===d.bodyWidgets.length||s.sectionFormat.pageHeight!==d.bodyWidgets[0].sectionFormat.pageHeight||s.sectionFormat.pageWidth!==d.bodyWidgets[0].sectionFormat.pageWidth||"NoBreak"!==s.sectionFormat.breakCode?0===d.bodyWidgets.length||!s.equals(d.bodyWidgets[0])||s.sectionIndex!==d.bodyWidgets[0].sectionIndex&&("NewPage"===s.sectionFormat.breakCode||!s.isWord2010NextColumn&&"NoBreak"!==s.sectionFormat.breakCode)?(d=void 0,g=!0):(h=d.bodyWidgets[0],this.viewer.updateClientArea(h,h.page)):d.bodyWidgets[0].index===s.index?(h=d.bodyWidgets[0],this.viewer.updateClientArea(h,h.page)):(h=this.createSplitBody(s),d.bodyWidgets.splice(0,0,h),h.page=d,this.viewer.updateClientArea(h,h.page),h.y=this.viewer.clientActiveArea.y);else if(d.endnoteWidget.bodyWidgets[0].index===s.index)h=d.endnoteWidget.bodyWidgets[0],this.viewer.updateClientArea(h,h.page);else{h=this.createSplitBody(s);var v=new Dl;v.footNoteType="Endnote",v.page=d,v.bodyWidgets.push(h),h.containerWidget=v,h.page=d,this.viewer.updateClientArea(h,h.page),h.y=this.viewer.clientActiveArea.y}if(this.isMultiColumnLayout&&(g=!0),(0,a.isNullOrUndefined)(d)){if(h=this.createSplitBody(s),this.documentHelper.owner.editorHistoryModule&&this.documentHelper.owner.editorHistoryModule.isRedoing&&this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&"SectionBreakContinuous"===this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action&&"NoBreak"===e.bodyWidget.sectionFormat.breakCode||n);else if(r){var y=m.bodyWidgets[s.page.bodyWidgets.length-1],w=this.createSplitBody(y);d=this.viewer.createNewPage(w,f),this.viewer.updateClientArea(w,w.page),w.y=h.y=this.viewer.clientActiveArea.y,h.page=d}else d=this.viewer.createNewPage(h,f),this.viewer.updateClientArea(h,h.page),h.y=this.viewer.clientActiveArea.y;g&&!(0,a.isNullOrUndefined)(d)&&this.documentHelper.insertPage(f,d),this.clearLineMeasures()}if(d)for(;;){var b=s.page.bodyWidgets[s.page.bodyWidgets.length-1];if(this.isSectionBreakCont||s===b||s.containerWidget instanceof Dl)break;s.page.bodyWidgets.splice(s.page.bodyWidgets.indexOf(b),1),d.bodyWidgets.splice(1,0,b),b.page=d}}if(this.isTextFormat){var C=s.childWidgets.indexOf(e),x=s.childWidgets.slice(C);s.childWidgets.splice(C);for(var I=0,k=x;I<k.length;I++){var F=k[I];h.childWidgets.push(F),F.containerWidget=h}}else for(;;){var P=void 0;if(P=s.lastChild instanceof Dl?s.lastChild.previousWidget:s.lastChild,t||o&&e!==P&&!(P instanceof Al)&&P.isLayouted){var S=this.getFootNoteWidgetsOf(P);this.moveFootNotesToPage(S,s,h)}if(e===P)break;if(s.childWidgets.splice(s.childWidgets.indexOf(P),1),h.childWidgets.splice(0,0,P),P instanceof Al&&-1!==s.floatingElements.indexOf(P)&&s.floatingElements.splice(s.floatingElements.indexOf(P),1),P instanceof Rl&&P.floatingElements.length>0)for(var T=0;T<P.floatingElements.length;T++)-1!==s.floatingElements.indexOf(P.floatingElements[T])&&"Inline"!==P.floatingElements[T].textWrappingStyle&&(s.floatingElements.splice(s.floatingElements.indexOf(P.floatingElements[T]),1),h.floatingElements.push(P.floatingElements[T]));P.containerWidget=h,h.height+=P.height}return h},t.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=e.sectionFormat,t.index=e.index,t},t.prototype.createOrGetNextColumnBody=function(e){var t;return e.nextRenderedWidget&&e.columnIndex+1===e.nextRenderedWidget.columnIndex&&(t=e.nextRenderedWidget),(0,a.isNullOrUndefined)(t)&&((t=new Ol).sectionFormat=e.sectionFormat,t.index=e.index,t.page=e.page,t.y=e.y,e.containerWidget instanceof Dl?(e.containerWidget.bodyWidgets.splice(e.containerWidget.bodyWidgets.indexOf(e)+1,0,t),t.containerWidget=e.containerWidget):e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,t)),t},t.prototype.moveToNextColumnByBodyWidget=function(e,t){var i=e.containerWidget;return this.createOrGetNextColumnBody(i)},t.prototype.reLayoutLine=function(e,t,i,n,r){var o,s;this.documentHelper.owner.editorModule.isFootnoteElementRemoved||(this.isFootnoteContentChanged=!1),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!r&&this.viewer.owner.editorModule.updateWholeListItems(e),o=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[t],e.containerWidget instanceof Ol&&e.containerWidget.sectionFormat.numberOfColumns>1&&e.containerWidget.sectionFormat.equalWidth&&(s=o.previousLine),(0,a.isNullOrUndefined)(s)&&(s=o),this.allowLayout&&(s.paragraph.splitTextRangeByScriptType(s.indexInOwner),s.paragraph.splitLtrAndRtlText(s.indexInOwner),s.paragraph.combineconsecutiveRTL(s.indexInOwner));var l=e.containerWidget;l.height-=e.height,!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||l instanceof cd?l instanceof cd?this.viewer.updateClientAreaForTextBoxShape(l.containerShape,!0):this.viewer.updateClientArea(l,l.page,!0):(e.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(e.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(e),l.page)),this.viewer.updateClientAreaForBlock(e,!0);var d=0;e.containerWidget instanceof Ol&&(d=(p=e.getSplitWidgets())[p.length-1].containerWidget.page.index);if(!(0,a.isNullOrUndefined)(e.containerWidget)&&!(0,a.isNullOrUndefined)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof Dl){var h=e.bodyWidget.containerWidget.y;return this.viewer.cutFromTop(h),this.documentHelper.owner.editorModule.isFootNoteInsert=!0,this.layoutfootNote(e.containerWidget.containerWidget),void(this.documentHelper.owner.editorModule.isFootNoteInsert=!1)}if(s.paragraph.isEmptyInternal(!0)&&(0,a.isNullOrUndefined)(s.paragraph.nextSplitWidget))this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{if(this.updateClientAreaForLine(s),this.layoutListItems(s.paragraph),s.isFirstLine()&&!(0,a.isNullOrUndefined)(e.paragraphFormat)){var c=-Pa.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(c)}do{e=(s=this.layoutLine(s,0)).paragraph,s=s.nextLine}while(s);this.updateWidgetToPage(this.viewer,e)}this.viewer.updateClientAreaForBlock(e,!1);var p,u=0;e.containerWidget instanceof Ol&&(u=(p=e.getSplitWidgets())[p.length-1].containerWidget.page.index);this.layoutNextItemsBlock(e,this.viewer,void 0,d!==u);var g=e.getSplitWidgets()[0].previousRenderedWidget;if(!((0,a.isNullOrUndefined)(g)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||g instanceof Rl&&(!(g instanceof Rl)||g.isEndsWithPageBreak||g.isEndsWithColumnBreak)||(this.viewer.cutFromTop(e.y+e.height),e.containerWidget===g.containerWidget||(0,a.isNullOrUndefined)(g.containerWidget)))){var m=e.containerWidget,f=g.containerWidget,v=this.getFootNoteWidgetsOf(e);(0,a.isNullOrUndefined)(f.page.footnoteWidget)||this.moveFootNotesToPage(v,f,m)}var y,w=this.documentHelper.pages.length,b=this.documentHelper.pages[w-1],C=b.bodyWidgets[b.bodyWidgets.length-1];if(!this.documentHelper.owner.editorModule.isFootnoteElementRemoved&&!this.isFootnoteContentChanged||(0,a.isNullOrUndefined)(e.bodyWidget.page.footnoteWidget)||(y=e.bodyWidget.page.footnoteWidget,this.layoutfootNote(y)),(0,a.isNullOrUndefined)(this.viewer.owner.editorHistoryModule)||!this.viewer.owner.editorHistoryModule.isRedoing||(0,a.isNullOrUndefined)(C.page.endnoteWidget)||(this.isEndnoteContentChanged=!0),(this.documentHelper.owner.editorModule.isEndnoteElementRemoved||this.isEndnoteContentChanged)&&!(0,a.isNullOrUndefined)(C.page.endnoteWidget)){y=C.page.endnoteWidget;var x=this.viewer.clientArea.clone(),I=this.viewer.clientActiveArea.clone();h=C.y;if(C.childWidgets.length>0){var k=C.childWidgets[C.childWidgets.length-1];h=k.y+k.height}this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-h,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=h,this.layoutfootNote(y),this.viewer.clientArea=x,this.viewer.clientActiveArea=I}!(0,a.isNullOrUndefined)(this.viewer.owner.editorHistoryModule)&&this.viewer.owner.editorHistoryModule.isRedoing&&(this.isEndnoteContentChanged=!1)},t.prototype.isContainsRtl=function(e){if(this.viewer.documentHelper.isSelectionChangedOnMouseMoved&&!this.isDocumentContainsRtl)return!1;for(var t=!1,i=0;i<e.children.length;i++)if(e.children[i]instanceof Zl&&(t=e.children[i].characterFormat.bidi||"RTL"===e.children[i].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(e.children[i].text))){this.isDocumentContainsRtl||(this.isDocumentContainsRtl=t);break}return t},t.prototype.shiftElementsForRTLLayouting=function(t,i){var n=this.hasTextRangeBidi(t);if(this.isContainsRTLText(t)||i||n){for(var r=[],o=[],s=0;s<t.children.length;s++){var l=t.children[s];if(l instanceof Zl&&l.height>0&&!l.isPageBreak&&"\v"!==l.text){var d=l;o.push(d.characterFormat.bidi),"\t"==d.text?r.push(e.Tab):r.push(d.characterRange),l.isRightToLeft=r[r.length-1]==e.RightToLeft}else if(l instanceof Bd||l instanceof td||l instanceof vd||l instanceof fd||l instanceof id||l instanceof _l){var h=this.isStartMarker(l),c=this.isEndMarker(l);if(h&&s<t.children.length-1){var p=this.getNextValidWidget(s+1,t);if(!(0,a.isNullOrUndefined)(p)&&p instanceof Zl&&p.height>0){d=p;o.push(d.characterFormat.bidi),"\t"===p.text?r.push(e.Tab):r.push(d.characterRange)}else o.push(!1),r.push(e.LeftToRight)}else!c&&s>0?(o.push(o[o.length-1]),r.push(r[r.length-1])):(o.push(!1),r.push(e.LeftToRight))}else l instanceof md&&i?(o.push(i),r.push(e.RightToLeft)):(o.push(!1),r.push(e.LeftToRight))}var u=-1,g=void 0;for(s=0;s<r.length;s++)if(s+1<o.length&&o[s]!=o[s+1])-1!=u&&(this.updateCharacterRange(t,s,u,o,r),u=-1),g=null;else{if(s>0&&s!=r.length-1&&r[s]==e.WordSplit&&o[s]&&r[s-1]==e.Number&&o[s-1]&&r[s+1]==e.Number&&o[s+1]&&this.isNumberNonReversingCharacter(t.children[s]))r[s]=e.Number;else if(r[s]==e.RightToLeft||r[s]==e.LeftToRight||r[s]==e.Number&&-1!=u||((0,a.isNullOrUndefined)(g)||!g)&&o[s])if(-1==u&&r[s]!=e.LeftToRight)u=s;else{if(-1==u){r[s]==e.LeftToRight?g=!0:r[s]==e.RightToLeft&&(g=!1);continue}r[s]==e.LeftToRight&&(this.updateCharacterRange(t,s,u,o,r),u=r[s]==e.RightToLeft||r[s]==e.Number&&-1!=u?s:-1)}r[s]==e.LeftToRight?g=!0:r[s]==e.RightToLeft&&(g=!1)}if(-1!=u&&u<r.length-1&&(this.updateCharacterRange(t,r.length-1,u,o,r),u=-1),r.length!=t.children.length)throw new Error("Splitted Widget count mismatch while reordering layouted child widgets of a line");var m=this.reorderElements(t,r,o,i);o.length=0,r.length=0,t.children.length>0&&(t.layoutedElements=m)}return i},t.prototype.isNumberNonReversingCharacter=function(e){if(e instanceof Zl){var t=e;if(!t.characterFormat.hasValueWithParent("localeIdBidi"))return za.isNumberNonReversingCharacter(t.text,t.characterFormat.bidi);var i=t.text.charCodeAt(0);if(47==i&&!this.isNumberReverseLangForSlash(t.characterFormat.localeIdBidi)||(35==i||36==i||37==i||43==i||45==i)&&!this.isNumberReverseLangForOthers(t.characterFormat.localeIdBidi)||44==i||46==i||58==i||1548==i)return!0}return!1},t.prototype.isNumberReverseLangForSlash=function(e){return this.isNumberReverseLangForOthers(e)||6145==e||1164==e||1125==e||1120==e||1123==e||1065==e||2137==e||1114==e||1119==e||1152==e||1056==e},t.prototype.isNumberReverseLangForOthers=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e},t.prototype.isStartMarker=function(e){return e instanceof Bd?0===e.commentType:e instanceof td?0===e.bookmarkType:e instanceof vd||(e instanceof id?0===e.type:e instanceof _l&&0===e.fieldType)},t.prototype.isEndMarker=function(e){return e instanceof Bd?1===e.commentType:e instanceof td?1===e.bookmarkType:e instanceof vd||(e instanceof id?1===e.type:e instanceof _l&&1===e.fieldType)},t.prototype.getNextValidWidget=function(e,t){for(var i=e;i<t.children.length;i++){var n=t.children[i];if(!(n instanceof Bd||n instanceof td||n instanceof vd||n instanceof fd||n instanceof id||n instanceof _l))return n[i]}return null},t.prototype.hasTextRangeBidi=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(i instanceof Zl)if(i.characterFormat.bidi)return!0}return!1},t.prototype.isContainsRTLText=function(e){for(var t=e.paragraph.bodyWidget.page.documentHelper.textHelper,i=!1,n=0;n<e.children.length&&!(e.children[n]instanceof Zl&&(i=e.children[n].characterFormat.bidi||1==e.children[n].characterFormat.bidi||t.isRTLText(e.children[n].text)));n++);return i},t.prototype.updateCharacterRange=function(t,i,n,r,o){var s=i;if(!r[i]){o[i]===e.LeftToRight&&s--;for(var a=s;a>=n;a--)if(o[a]!=e.WordSplit){s=a;break}}for(a=n;a<=s;a++)if(o[a]==e.WordSplit){o[a]=e.RightToLeft|e.WordSplit;var l=a-1,d=a+1;if(l>=0&&d<o.length&&o[l]==e.RightToLeft&&(o[d]==e.RightToLeft||o[d]==e.Number)&&t.children[a]instanceof Zl){var h=t.children[a];if("Times New Roman"==h.characterFormat.fontFamilyBidi){var c=h.text.split("").reverse().join("");h.text=c}}}},t.prototype.reorderElements=function(t,i,n,r){for(var o=0,s=-1,a=0,l=0,d=[],h=e.LeftToRight,c=!1,p=0;p<t.children.length;p++){var u=t.children[p],g=u;g.characterRange=i[p];var m=(g.characterRange&e.RightToLeft)==e.RightToLeft||g.characterRange==e.Number,f=n[p];if(i[p]==e.Tab){if(r){o=0,s=-1,a=0,h=e.LeftToRight,c=!1,d.splice(o,0,u);continue}f&&(f=!1)}p>0&&c!=f&&(r?(o=0,s=-1,a=0):s=d.length-1,l=0),f||m?m||f&&g.characterRange==e.WordSplit&&(h==e.RightToLeft||this.isInsertWordSplitToLeft(i,n,p))?(a++,o=s+1,g.characterRange==e.Number&&(h==e.Number&&(o+=l),l++),d.splice(o,0,u)):(d.splice(o,0,u),o++,a=0):(r?(a>0&&c==f&&(o+=a),d.splice(o,0,u),o++):(d.push(u),o=p+1),a=0,s=r?o-1:d.length-1),g.characterRange!=e.Number&&(l=0),g.characterRange!=e.WordSplit&&(h=g.characterRange),c=f}return d},t.prototype.isInsertWordSplitToLeft=function(t,i,n){for(var r=n+1;r<t.length;r++){if((t[r]&e.RightToLeft)==e.RightToLeft)return!0;if(t[r]==e.LeftToRight)return!i[r]}return!0},t.prototype.shiftLayoutFloatingItems=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],n=this.getFloatingItemPoints(i),r=n.y-i.y;if(i.x=n.x,i.y=n.y,i instanceof hd)for(var o=0;o<i.textFrame.childWidgets.length;o++){var s=i.textFrame.childWidgets[o];s instanceof Rl?s.y=s.y+r:s instanceof Al&&this.shiftChildLocationForTableWidget(s,r)}}},t.prototype.getFloatingItemPoints=function(e){var t=e.line.paragraph,i=t.bodyWidget.sectionFormat,n=0,r=0;if(t){var o=Pa.convertPointToPixel(i.leftMargin),s=Pa.convertPointToPixel(i.rightMargin),a=Pa.convertPointToPixel(i.topMargin),l=i.bottomMargin>0?Pa.convertPointToPixel(i.bottomMargin):48,d=Pa.convertPointToPixel(i.headerDistance),h=Pa.convertPointToPixel(i.footerDistance),c=Pa.convertPointToPixel(i.pageWidth),p=Pa.convertPointToPixel(i.pageHeight),u=c-(o+s),g=p-a-l;a=t.isInHeaderFooter&&i.topMargin<=0?Math.abs(a)>0?Math.abs(a):Pa.convertPointToPixel(i.headerDistance)+t.height:a>0?a:48,!t.isInHeaderFooter&&a<this.viewer.clientArea.y&&(a=this.viewer.clientArea.y);var m="InFrontOfText",f=!1,v=e.verticalOrigin,y=e.horizontalOrigin,w=e.horizontalAlignment,b=e.verticalAlignment,C=e.verticalRelativePercent,x=(e.horizontalRelativePercent,e.height),I=e.width,k=e.verticalPosition,F=e.horizontalPosition,P=e.layoutInCell,S=e.heightRelativePercent,T=e.widthRelativePercent,H=void 0;if(e instanceof hd&&(H=e.autoShapeType),t.isInsideTable&&P)f=!0,r=this.getVerticalPosition(e,k,v,m),n=this.getHorizontalPosition(e.width,e,w,y,F,m,t.associatedCell.cellFormat.cellWidth);else if(this.documentHelper.viewer instanceof Fl){if("Line"===v)r=this.documentHelper.selection.getTop(e.line);else r=this.viewer.clientActiveArea.y;if("Character"===y)n=this.viewer.clientActiveArea.x;else if("Center"===w)n=this.viewer.clientArea.width/2-e.width/2;else n=this.viewer.clientArea.x}else{switch(v){case"Page":case"TopMargin":switch(r=k,b){case"Top":r=k;break;case"Center":"TopMargin"===v?r=(a-x)/2:S>0&&T>0?(r=(p-p*(S/100))/2,e.height=p*(S/100)):r=(p-x)/2;break;case"Outside":case"Bottom":r="Page"===v&&"Bottom"===b?p-x:"TopMargin"===v?a-x:(t.bodyWidget.page.index+1)%2!=0?p-x-h/2:d/2;break;case"Inside":"Page"===v?r=(t.bodyWidget.page.index+1)%2==0?p-x-h/2:d/2:(t.bodyWidget.page.index+1)%2==0&&(r=(a-x)/2-d);break;case"None":r=Math.abs(C)<=1e3?p*(C/100):k}break;case"Line":switch(r=k,b){case"Inside":case"Top":r=this.viewer.clientActiveArea.y;break;case"Center":r=this.viewer.clientActiveArea.y-x/2;break;case"Outside":case"Bottom":r=this.viewer.clientActiveArea.y-x;break;case"None":r=Math.round(t.y)+k}break;case"BottomMargin":switch(r=k,b){case"Inside":case"Top":r=p-l;break;case"Center":r=p-l+(l-x)/2;break;case"Outside":case"Bottom":r=t.bodyWidget.page.index+1!==0&&"Outside"===b?p-l:p-x;break;case"None":r=p-l+k}break;case"InsideMargin":case"OutsideMargin":switch(r=k,b){case"Inside":r="InsideMargin"===v?"InsideMargin"===v&&t.bodyWidget.page.index+1===0?p-x:0:(t.bodyWidget.page.index+1)%2!=0?p-l:a-x;break;case"Top":r="InsideMargin"===v?(t.bodyWidget.page.index+1)%2==0?p-l:0:(t.bodyWidget.page.index+1)%2!=0?p-l:0;break;case"Center":r="OutsideMargin"===v?(t.bodyWidget.page.index+1)%2!=0?p-l+(l-x)/2:(a-x)/2:(t.bodyWidget.page.index+1)%2==0?p-l+(l-x)/2:(a-x)/2;break;case"Outside":r="InsideMargin"===v?(t.bodyWidget.page.index+1)%2==0?p-l:a-x:(t.bodyWidget.page.index+1)%2!=0?a-x:p-l;break;case"Bottom":r="OutsideMargin"===v?t.bodyWidget.page.index+1!==0?p-x:a-x:(t.bodyWidget.page.index+1)%2==0?p-x:a-x}break;case"Paragraph":r=Math.round(t.y)+0+k;break;case"Margin":switch(r=t.isInHeaderFooter&&d>a?d+t.height+k:a+k,b){case"Top":r=a;break;case"Center":r=a+(g-x)/2;break;case"Outside":case"Bottom":r=(t.bodyWidget.page.index+1)%2!=0?a+g-x:a;break;case"Inside":r=(t.bodyWidget.page.index+1)%2==0?a+g-x:a}break;default:r=this.viewer.clientArea.y-k}switch(y){case"Page":switch(n=F,w){case"Center":f?n=(t.associatedCell.cellFormat.cellWidth-I)/2:S>0&&T>0?(n=(c-c*(T/100))/2,e.width=c*(T/100)):n=(c-I)/2;break;case"Left":n=0;break;case"Outside":case"Right":n=f?t.associatedCell.cellFormat.cellWidth-I:c-I;break;case"None":n=f?t.associatedCell.x+F:F}n<0&&f&&(n=t.associatedCell.x);break;case"Column":var E=!1;if(this.viewer.clientActiveArea.x<t.x?n=t.x+F:!e.paragraph.isInsideTable&&("StraightConnector"===H||"Rectangle"===H||e instanceof gd)?(E=!0,n=F+t.bodyWidget.x):n=t.x+F,t.paragraphFormat.leftIndent&&!E)n-=Pa.convertPointToPixel(t.leftIndent);switch(w){case"Center":n=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-I)/2;break;case"Left":n=this.viewer.clientActiveArea.x;break;case"Right":n=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-I}break;case"Margin":if(t.bodyWidget)switch(n=o+F,w){case"Center":n=o+(u-I)/2;break;case"Left":n=o;break;case"Outside":(t.bodyWidget.page.index+1)%2!=0&&(n=o+u-I);break;case"Right":n=o+u-I;break;case"Inside":(t.bodyWidget.page.index+1)%2==0&&(n=o+u-I)}else n=this.viewer.clientArea.x+F;break;case"Character":n="Right"===w||"Center"===w?this.getLeftMarginHorizPosition(o,w,F,I,m):this.viewer.clientArea.x+F;break;case"LeftMargin":n=this.getLeftMarginHorizPosition(o,w,F,I,m);break;case"RightMargin":n=this.getRightMarginHorizPosition(c,s,w,F,I,m);break;case"InsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(c,s,w,F,I,m):this.getLeftMarginHorizPosition(o,w,F,I,m);break;case"OutsideMargin":n=(t.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(o,w,F,I,m):this.getRightMarginHorizPosition(c,s,w,F,I,m);break;default:n=this.viewer.clientArea.x+F}0}!t||"Paragraph"!==v&&"Line"!==v||"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Word2013"===this.documentHelper.compatibilityMode&&(t.isInHeaderFooter||(r+e.height>this.viewer.clientArea.bottom&&(r=this.viewer.clientArea.bottom-e.height),r<i.topMargin&&(r=i.topMargin)))}return new Sa(n,r)},t.prototype.getLeftMarginHorizPosition=function(e,t,i,n,r){var o=i;switch(t){case"Center":o=(e-n)/2;break;case"Left":o=0;break;case"Right":o=e-n}return o<0&&"InFrontOfText"!==r&&"Behind"!==r&&(o=0),o},t.prototype.getRightMarginHorizPosition=function(e,t,i,n,r,o){var s=e-t,a=s+n;switch(i){case"Center":a=s+(t-r)/2;break;case"Left":a=s;break;case"Right":a=e-r}return(a<0||a+r>e)&&"InFrontOfText"!==o&&"Behind"!==o&&(a=e-r),a},t.prototype.getVerticalPosition=function(e,t,i,n){var r=e.line.paragraph,o=e,s=0,a=r.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":s=a+t;break;case"Line":case"Paragraph":s=r.y+t+0,"Square"==o.textWrappingStyle&&(s=s<=r.associatedCell.y?r.associatedCell.y:s);break;default:s=this.viewer.clientActiveArea.y+t}return s},t.prototype.getHorizontalPosition=function(e,t,i,n,r,o,s){var a=0,l=t.line.paragraph.associatedCell,d=s-l.leftMargin-l.rightMargin,h=l.cellFormat.cellWidth,c=l.x,p=c-l.leftMargin;switch(n){case"Page":switch(a=r,i){case"Center":a=p+(d-e)/2;break;case"Left":a=p;break;case"Right":a=p+(d-e);break;case"None":a=p+r}break;case"Column":case"Margin":switch(i){case"Center":a=c+(h-e)/2;break;case"Left":a=c;break;case"Right":a=c+(h-e);break;case"None":a=c+r}break;default:a=c+r}return a},t.prototype.updateTableFloatPoints=function(e){if(e.wrapTextAround){var t=e.getTableCellWidth(),i=e.positioning,n=e.bodyWidget.sectionFormat;if(this.documentHelper.viewer instanceof Fl)"Margin"!==i.horizontalOrigin&&"Page"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=this.viewer.clientArea.width-t:this.viewer.clientActiveArea.x=this.viewer.clientArea.x);else if(e.containerWidget instanceof cd||e.isInsideTable){if(e.isInsideTable){var r=e.containerWidget,o=r.cellFormat;"Page"===i.verticalOrigin?(this.viewer.clientActiveArea.y=r.y,this.viewer.clientActiveArea.y+=Pa.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?(this.viewer.clientActiveArea.y+=Pa.convertPointToPixel(i.verticalPosition),(this.viewer.clientActiveArea.y<r.y||"Top"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=r.y)):this.viewer.clientActiveArea.y+Pa.convertPointToPixel(i.verticalPosition)<r.y?this.viewer.clientActiveArea.y=r.y:this.viewer.clientActiveArea.y+=Pa.convertPointToPixel(i.verticalPosition),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=r.x+o.preferredWidth-t):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=r.x+r.leftMargin:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=r.x+o.preferredWidth-(t+r.rightMargin))),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x=r.x,"Margin"===i.horizontalOrigin&&(this.viewer.clientActiveArea.x+=r.leftMargin),this.viewer.clientActiveArea.x+=Pa.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=o.preferredWidth/2-t/2)}}else"Page"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=0:((0,a.isNullOrUndefined)(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=Pa.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=Pa.convertPointToPixel(n.topMargin):0==Math.round(i.verticalPosition)||(0,a.isNullOrUndefined)(n.topMargin)?this.viewer.clientActiveArea.y=Pa.convertPointToPixel(i.verticalPosition):this.viewer.clientActiveArea.y=Pa.convertPointToPixel(n.topMargin+i.verticalPosition):"Paragraph"===i.verticalOrigin&&((0,a.isNullOrUndefined)(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y+=Pa.convertPointToPixel(i.verticalPosition)),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=Pa.convertPointToPixel(n.pageWidth)-t:"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=(Pa.convertPointToPixel(n.pageWidth)-t)/2):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment?(this.viewer.clientActiveArea.x=Pa.convertPointToPixel(n.leftMargin),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-Pa.convertPointToPixel(e.firstChild.firstChild.leftMargin))):"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=Pa.convertPointToPixel(n.leftMargin):"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=Pa.convertPointToPixel(n.pageWidth)-(Pa.convertPointToPixel(n.rightMargin)+t):"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=Pa.convertPointToPixel(n.leftMargin)+(Pa.convertPointToPixel(n.pageWidth-n.rightMargin-n.leftMargin)-t)/2)),(Math.round(i.horizontalPosition)>0||"Margin"===i.horizontalOrigin&&"Left"===i.horizontalAlignment)&&(this.viewer.clientActiveArea.x+=Pa.convertPointToPixel(i.horizontalPosition))}e.x=this.viewer.clientActiveArea.x,e.y=this.viewer.clientActiveArea.y},t.prototype.isTocField=function(e){if(e instanceof _l){var t=e.nextNode;if(e instanceof _l&&0===e.fieldType&&t instanceof Zl&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},t.prototype.getTotalColumnSpan=function(e){for(var t=e,i=0,n=0;n<t.childWidgets.length;n++)i+=t.childWidgets[n].cellFormat.columnSpan;return i},t.prototype.getMaximumRightCellBorderWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i],r=n.childWidgets[n.childWidgets.length-1].cellFormat.borders.right.lineWidth;t<r&&(t=r)}return t},t.prototype.getDefaultBorderSpacingValue=function(e,t,i){return 0==e?(e="Word2013"!=this.documentHelper.compatibilityMode&&"Center"==i?1.5:.75,!0):t},t.prototype.getMinimumWidthRequiredForTable=function(e,t,i){var n=0;return n="Word2013"==this.documentHelper.compatibilityMode?"Center"==t?e?18.5+Math.round(.375):18.5+Math.round(i/2):e?19.25:18.5+i:"Center"==t?e?19.25:18.5+i/2:.25==i?18.5:19.3,Pa.convertPointToPixel(n)},t.prototype.shiftFloatingItemsFromTable=function(e,t){if(e.containerWidget instanceof Ol)for(var i=0;i<e.containerWidget.floatingElements.length;i++){var n=e.containerWidget.floatingElements[i];!(n instanceof Al)&&n.paragraph.containerWidget instanceof Vl&&n.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==e&&(t.floatingElements.push(e.containerWidget.floatingElements[i]),e.containerWidget.floatingElements.splice(e.containerWidget.floatingElements.indexOf(e.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(n),i--)}},t}(),ja=function(){function e(){this.style={},this.context=new Ga}return e.prototype.getContext=function(e,t){return this.context},e.prototype.toDataURL=function(e,t){return this.context.renderedPath},e}(),Ga=function(){function e(){this.renderedPath=""}return Object.defineProperty(e.prototype,"globalAlpha",{set:function(e){this.renderedPath+="GA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCompositeOperation",{set:function(e){this.renderedPath+="GCP:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillStyle",{set:function(e){this.renderedPath+="FS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeStyle",{set:function(e){this.renderedPath+="SS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{set:function(e){this.renderedPath+="Dir:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{set:function(e){this.renderedPath+="Fn:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{set:function(e){this.renderedPath+="TA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBaseline",{set:function(e){this.renderedPath+="TBL:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{set:function(e){this.renderedPath+="LW:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineCap",{set:function(e){this.renderedPath+="LC:"+e+";"},enumerable:!0,configurable:!0}),e.prototype.drawImage=function(e,t,i,n,r,o,s,a,l){this.renderedPath+="LC:"+e.src+";",this.renderedPath+="sx:"+t+";",this.renderedPath+="sy:"+i+";",this.renderedPath+="sw:"+n+";",this.renderedPath+="sh:"+r+";",o&&(this.renderedPath+="dx:"+o+";"),s&&(this.renderedPath+="dy:"+s+";"),a&&(this.renderedPath+="dw:"+a+";"),l&&(this.renderedPath+="dh:"+l+";")},e.prototype.beginPath=function(){this.renderedPath+="BP;"},e.prototype.clip=function(e){this.renderedPath+="Cl;"},e.prototype.fill=function(e){this.renderedPath+="Fl;"},e.prototype.stroke=function(){this.renderedPath+="Stk;"},e.prototype.closePath=function(){this.renderedPath+="CP;"},e.prototype.lineTo=function(e,t){this.renderedPath+="LT:x:"+e+";y:"+t+";"},e.prototype.moveTo=function(e,t){this.renderedPath+="MT:x:"+e+";y:"+t+";"},e.prototype.rect=function(e,t,i,n){this.renderedPath+="Rt:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.setLineDash=function(e){this.renderedPath+="Sgm:"+e.toString()+";"},e.prototype.clearRect=function(e,t,i,n){this.renderedPath+="CR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.fillRect=function(e,t,i,n){this.renderedPath+="FR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.strokeRect=function(e,t,i,n){this.renderedPath+="SR:x:"+e+";y:"+t+";w:"+i+";h:"+n+";"},e.prototype.restore=function(){this.renderedPath+="RES;"},e.prototype.save=function(){this.renderedPath+="S;"},e.prototype.fillText=function(e,t,i,n){this.renderedPath+="FT:"+e+";x:"+t+";y:"+i+";",n&&(this.renderedPath+="MW:"+n+";")},e.prototype.measureText=function(e){return{width:30}},e.prototype.strokeText=function(e,t,i,n){this.renderedPath+="ST:"+e+";x:"+t+";y:"+i+";",n&&(this.renderedPath+="MW:"+n+";")},e.prototype.scale=function(e,t){this.renderedPath+="SC:x:"+e+";y:"+t+";"},e}();function Ka(e){var t,i=[],n=function(e){var t=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi,i=[],n=[],r={};t.lastIndex=0;var o=!1;r=t.exec(e);for(;r;)"e"===r[1]?o=!0:r[1]?("zm"===r[1].toLowerCase()?(i.length&&n.push(i),n.push(["Z"]),i=[r[1].substring(1,2)]):(i.length&&n.push(i),i=[r[1]]),o=!1):(i.length||(i=[]),o||i.push(Number(r[2])),o=!1),r=t.exec(e);i.length&&n.push(i);return n}(e);if(n.length>0)for(var r=0;r<n.length;r++){var o=n[parseInt(r.toString(),10)],s="";switch((s=o[0]).toLowerCase()){case"m":for(t=1;t<o.length;t++)i.push({command:s,x:o[parseInt(t.toString(),10)],y:o[t+1]}),t+=1,"m"===s?s="l":"M"===s&&(s="L");break;case"l":case"t":for(t=1;t<o.length;t++)i.push({command:s,x:o[parseInt(t.toString(),10)],y:o[t+1]}),t+=1;break;case"h":for(t=1;t<o.length;t++)i.push({command:s,x:o[parseInt(t.toString(),10)]});break;case"v":for(t=1;t<o.length;t++)i.push({command:s,y:o[parseInt(t.toString(),10)]});break;case"z":i.push({command:s});break;case"c":for(t=1;t<o.length;t++)i.push({command:s,x1:o[parseInt(t.toString(),10)],y1:o[t+1],x2:o[t+2],y2:o[t+3],x:o[t+4],y:o[t+5]}),t+=5;break;case"s":for(t=1;t<o.length;t++)i.push({command:s,x2:o[parseInt(t.toString(),10)],y2:o[t+1],x:o[t+2],y:o[t+3]}),t+=3;break;case"q":for(t=1;t<o.length;t++)i.push({command:s,x1:o[parseInt(t.toString(),10)],y1:o[t+1],x:o[t+2],y:o[t+3]}),t+=3;break;case"a":for(t=1;t<o.length;t++)i.push({command:s,r1:o[parseInt(t.toString(),10)],r2:o[t+1],angle:o[t+2],largeArc:o[t+3],sweep:o[t+4],x:o[t+5],y:o[t+6]}),t+=6}}return i}function Xa(e){var t,i="";for(t=0;t<e.length;t++)i+=0===t?Za(e[parseInt(t.toString(),10)]):" "+Za(e[parseInt(t.toString(),10)]);return i}function Za(e){var t="";switch(e.command){case"Z":case"z":t=e.command;break;case"M":case"m":case"L":case"l":case"T":case"t":t=e.command+" "+e.x+" "+e.y;break;case"C":case"c":t=e.command+" "+e.x1+" "+e.y1+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"Q":case"q":t=e.command+" "+e.x1+" "+e.y1+" "+e.x+" "+e.y;break;case"A":case"a":var i=e.command,n=e.angle,r=e.largeArc?"1":"0",o=e.sweep?"1":"0";t=i+" "+e.r1+" "+e.r2+" "+n+" "+r+" "+o+" "+e.x+" "+e.y;break;case"H":case"h":t=e.command+" "+e.x;break;case"V":case"v":t=e.command+" "+e.y;break;case"S":case"s":t=e.command+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y}return t}function Ja(e,t,i,n,r,o){switch(t){case"M":case"L":case"T":e.x=i.x,e.y=i.y;break;case"H":e.x=i.x;break;case"V":e.y=i.y;break;case"C":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1,e.x2=i.x2,e.y2=i.y2;break;case"S":e.x=i.x,e.y=i.y,e.x2=i.x2,e.y2=i.y2;break;case"Q":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1;break;case"A":var s=i.r1,a=i.r2;n&&(i.r1=s*=r,i.r2=a*=o),e.x=i.x,e.y=i.y,e.r1=i.r1,e.r2=i.r2;break;case"z":case"Z":e={command:"Z"}}return e}function Ya(e,t,i,n){return e!==i?e=n!==i?e*t-(Number(i)*t-Number(i))+(n-Number(i)):Number(e)*t-(Number(i)*t-Number(i)):n!==i&&(e=n),Number(e.toFixed(2))}var Qa=function(){function i(e){this.commentMarkDictionary=new l,this.isPrinting=!1,this.isExporting=!1,this.pageLeft=0,this.pageTop=0,this.pageIndex=-1,this.isFieldCode=!1,this.isRenderHeader=!1,this.leftPosition=0,this.topPosition=0,this.height=0,this.fieldStacks=[],this.shapes={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Oval:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",IsoscelesTriangle:"M45,0 L90,45 L0,45 L45,0 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Trapezoid:"M 1873 358 l -506 1332 h -686 l -506 -1332 z",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z",RegularPentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",Dodecagon:"M-69.20000457763672,-17.685555555555553L-50.656966313962585,-48.31444444444445L-18.543038263674127,-66L18.543038263674134,-66L50.656966313962585,-48.31444444444445L69.20000457763672,-17.685555555555553L69.20000457763672,17.685555555555553L50.656966313962585,48.31444444444445L18.543038263674134,66L-18.543038263674127,66L-50.656966313962585,48.31444444444445L-69.20000457763672,17.685555555555553Z",Pie:"M 1024 1894 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -109 26 -212 q 26 -102 75 -194 q 48 -92 117 -170 q 68 -78 153 -138 q 84 -59 183 -98 q 99 -39 207 -52 l 58 -7 v 922 h 922 l -7 58 q -13 109 -52 207 q -39 99 -98 183 q -60 85 -138 153 q -78 69 -170 117 q -92 49 -194 75 q -103 26 -212 26 z",Chord:"M 1024 1894 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -116 29 -224 q 29 -108 82 -203 q 53 -94 128 -173 q 75 -79 167 -137 q 92 -57 198 -92 q 106 -34 222 -40 l 23 -1 l 891 891 l -1 23 q -6 116 -40 222 q -35 106 -92 198 q -58 92 -137 167 q -79 75 -173 128 q -95 53 -203 82 q -108 29 -224 29 z",Teardrop:"M 1024 1894 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -120 31 -231 q 31 -111 88 -208 q 57 -97 136 -176 q 79 -79 176 -136 q 97 -57 208 -88 q 111 -31 231 -31 h 870 v 870 q 0 120 -31 231 q -31 111 -88 208 q -57 97 -136 176 q -79 79 -176 136 q -97 57 -208 88 q -111 31 -231 31 z",Frame:"M 1894 154 v 1740 h -1740 v -1740 m 1433 307 h -1126 v 1126 h 1126 z",HalfFrame:"M 154 154 h 1668 l -307 307 h -1054 v 1054 l -307 307 z",L_Shape:"M 870 154 v 1024 h 1024 v 716 h -1740 v -1740 z",DiagonalStripe:"M 154 943 l 789 -789 h 879 l -1668 1668 z",Cross:"M 666 1894 v -512 h -512 v -716 h 512 v -512 h 716 v 512 h 512 v 716 h -512 v 512 z",Plaque:"M 563 1894 v -51 q 0 -66 -31 -131 q -31 -64 -81 -115 q -51 -50 -115 -81 q -65 -31 -131 -31 h -51 v -922 h 51 q 66 0 131 -31 q 64 -31 115 -82 q 50 -50 81 -115 q 31 -64 31 -130 v -51 h 922 v 51 q 0 66 31 130 q 31 65 82 115 q 50 51 115 82 q 64 31 130 31 h 51 v 922 h -51 q -66 0 -130 31 q -65 31 -115 81 q -51 51 -82 115 q -31 65 -31 131 v 51 z",Cube:"M 1946 102 v 1280 l -564 564 h -1280 v -1280 l 564 -564 m 665 615 h -1126 v 1126 h 1126 m 51 -1229 l 410 -409 h -1075 l -410 409 m 1536 -307 l -409 410 v 1024 l 409 -410 z",Bevel:"M 1946 102 v 1844 h -1844 v -1844 m 175 103 l 205 205 h 1084 l 205 -205 m -235 1331 v -1024 h -1024 v 1024 m -307 235 l 205 -205 v -1084 l -205 -205 m 1566 1566 l -205 -205 h -1084 l -205 205 m 1566 -1566 l -205 205 v 1084 l 205 205 z",Donut:"M 1024 154 q 120 0 231 31 q 111 31 208 88 q 97 57 176 136 q 79 79 136 176 q 57 97 88 208 q 31 111 31 231 q 0 120 -31 231 q -31 111 -88 208 q -57 97 -136 176 q -79 79 -176 136 q -97 57 -208 88 q -111 31 -231 31 q -120 0 -231 -31 q -111 -31 -208 -88 q -97 -57 -176 -136 q -79 -79 -136 -176 q -57 -97 -88 -208 q -31 -111 -31 -231 q 0 -120 31 -231 q 31 -111 88 -208 q 57 -97 136 -176 q 79 -79 176 -136 q 97 -57 208 -88 q 111 -31 231 -31 m 0 1331 q 95 0 179 -37 q 84 -36 147 -99 q 62 -62 99 -146 q 36 -84 36 -179 q 0 -95 -36 -179 q -37 -84 -99 -147 q -63 -62 -147 -99 q -84 -36 -179 -36 q -95 0 -179 36 q -84 37 -146 99 q -63 63 -99 147 q -37 84 -37 179 q 0 95 37 179 q 36 84 99 146 q 62 63 146 99 q 84 37 179 37 z",NoSymbol:"M 1024 154 q 124 0 237 30 q 112 30 209 85 q 96 56 175 134 q 78 79 134 175 q 55 97 85 209 q 30 113 30 237 q 0 124 -30 236 q -30 113 -85 209 q -56 97 -134 175 q -79 79 -175 134 q -97 56 -209 86 q -113 30 -237 30 q -124 0 -236 -30 q -113 -30 -209 -86 q -97 -55 -175 -134 q -79 -78 -134 -175 q -56 -96 -86 -209 q -30 -112 -30 -236 q 0 -124 30 -237 q 30 -112 86 -209 q 55 -96 134 -175 q 78 -78 175 -134 q 96 -55 209 -85 q 112 -30 236 -30 m 273 1369 l -772 -772 l -28 74 q -36 96 -36 199 q 0 116 45 218 q 44 103 121 179 q 76 77 179 121 q 102 45 218 45 q 103 0 199 -36 m 328 -328 q 36 -96 36 -199 q 0 -116 -44 -219 q -45 -102 -121 -179 q -77 -76 -179 -121 q -103 -44 -219 -44 q -103 0 -199 36 l -74 28 l 772 772 z",BlockArc:"M 1485 1485 v -51 q 0 -96 -36 -180 q -37 -84 -99 -147 q -63 -62 -147 -98 q -84 -36 -179 -36 q -95 0 -179 36 q -84 36 -146 98 q -63 63 -99 147 q -37 84 -37 180 v 51 h -409 v -51 q 0 -120 31 -231 q 31 -111 88 -208 q 57 -97 136 -177 q 79 -79 176 -136 q 97 -57 208 -88 q 111 -31 231 -31 q 120 0 231 31 q 111 31 208 88 q 97 57 176 136 q 79 80 136 177 q 57 97 88 208 q 31 111 31 231 v 51 z",FoldedCorner:"M 1946 102 v 1229 l -615 615 h -1229 v -1844 m 1229 1699 l 470 -470 h -470 m 512 -1126 h -1638 v 1638 h 1024 v -614 h 614 zM 154 1894 v -1740 h 1740 v 1156 l -584 584 z",SmileyFace:"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 186 q 60 103 93 221 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 220 q -60 103 -144 187 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -187 q -60 -102 -93 -220 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -221 q 60 -102 144 -186 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1741 q 113 0 218 -30 q 104 -29 195 -82 q 91 -53 166 -128 q 75 -75 128 -166 q 53 -91 83 -196 q 29 -104 29 -217 q 0 -113 -29 -218 q -30 -104 -83 -195 q -53 -91 -128 -166 q -75 -75 -166 -128 q -91 -53 -195 -83 q -105 -29 -218 -29 q -113 0 -217 29 q -105 30 -196 83 q -91 53 -166 128 q -75 75 -128 166 q -53 91 -82 195 q -30 105 -30 218 q 0 113 30 217 q 29 105 82 196 q 53 91 128 166 q 75 75 166 128 q 91 53 196 82 q 104 30 217 30 m 358 -1331 q 32 0 60 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 60 q 0 32 -12 59 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -60 12 q -32 0 -59 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -27 -12 -59 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -21 49 -33 q 27 -12 59 -12 m 52 102 h -103 v 103 h 103 m -768 -205 q 31 0 59 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 60 q 0 32 -12 59 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -59 12 q -32 0 -60 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -27 -12 -59 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -21 49 -33 q 28 -12 60 -12 m 51 102 h -103 v 103 h 103 m 823 512 q -18 87 -66 162 q -48 75 -117 130 q -69 55 -154 86 q -86 31 -179 31 q -93 0 -178 -31 q -86 -31 -155 -86 q -69 -55 -117 -130 q -48 -75 -66 -162 h 106 q 17 66 57 122 q 39 56 94 97 q 55 42 122 65 q 66 23 137 23 q 71 0 138 -23 q 66 -23 121 -65 q 55 -41 95 -97 q 39 -56 56 -122 z",Heart:"M 997 1758 q -401 -286 -612 -551 q -212 -265 -231 -504 v -101 q 9 -106 45 -187 q 35 -80 87 -135 q 52 -55 114 -85 q 62 -30 122 -36 q 21 -2 41 -3 q 19 -1 38 -1 q 67 0 119 12 q 51 13 96 38 q 44 26 85 65 q 40 39 84 91 l 39 46 l 39 -46 q 44 -52 85 -91 q 40 -39 85 -65 q 44 -25 96 -38 q 51 -12 118 -12 q 19 0 39 1 q 19 1 40 3 q 60 6 122 36 q 62 31 114 86 q 51 56 87 137 q 36 82 45 189 v 100 q -19 240 -229 503 q -211 264 -609 548 l -30 21 z",LightningBolt:"M-8,-55L7,-24L1,-20L19,6L13,11L36,55L-3,21L5,16L-19,-6L-11,-12L-36,-35Z",Sun:"M69.60002899169922,0L41.51352437242167,8.416795119701419L41.51352437242167,-8.416795119701426ZM49.209798275982905,-41.47314036934465L36.41601824906962,-18.783766017986338L22.290725499983694,-30.686752034954836ZM0,-58.64998245239259L9.988224375410937,-34.982276749768076L-9.988224375410944,-34.982276749768076ZM-49.216242723111755,-41.47314036934465L-22.290725499983694,-30.686752034954836L-36.416018249069616,-18.783766017986338ZM-69.60002899169922,0L-41.51352437242167,-8.416795119701426L-41.51352437242167,8.416795119701419ZM-49.216242723111755,41.46770981541388L-36.416018249069616,18.783766017986338L-22.290725499983694,30.68675203495485ZM0,58.64998245239259L-9.988224375410944,34.98227674976806L9.988224375410937,34.98227674976806ZM49.209798275982905,41.46770981541388L22.290725499983694,30.68675203495485L36.41601824906962,18.783766017986338ZM-34.80001449584961,0Q-34.800014495849624,-12.14680908236253,-24.607326235405417,-20.735900154279413Q-14.414637974961238,-29.32499122619629,-1.4210854715202004e-14,-29.324991226196296Q14.414637974961224,-29.324991226196293,24.60732623540541,-20.735900154279413Q34.80001449584961,-12.146809082362545,34.80001449584961,-7.105427357601002e-15Q34.80001449584961,12.146809082362523,24.60732623540541,20.735900154279406Q14.414637974961224,29.32499122619629,0,29.32499122619629Q-14.414637974961217,29.32499122619629,-24.607326235405388,20.73590015427945Q-34.8000144958496,12.146809082362552,-34.80001449584961,7.105427357601002e-15Z",Moon:"M36.80000305175781,60.90000915527344Q6.313882332939066,60.90000915527344,-15.243060359409363,43.06280944801668Q-36.80000305175781,25.22560974075992,-36.80000305175781,7.105427357601002e-15Q-36.800003051757834,-25.225609740759907,-15.243060359409384,-43.062809448016665Q6.3138823329390235,-60.90000915527342,36.8000030517578,-60.90000915527344Q6.313882332939052,-41.98080184970351,0.9246466598519447,-10.765702362004177Q-4.464589013235177,20.449397125695157,18.400001525878878,45.67500686645508Q26.28571646554125,54.375008174351294,36.800003051757784,60.90000915527344Z",Cloud:"M 1024 1792 q -60 0 -115 -20 q -55 -19 -100 -54 q -46 -34 -79 -83 q -34 -48 -50 -106 l -24 -86 l -62 65 q -37 38 -83 58 q -47 21 -101 21 q -54 0 -101 -21 q -47 -20 -81 -55 q -35 -35 -54 -83 q -20 -47 -20 -100 q 0 -48 18 -91 q 18 -42 50 -78 l 25 -28 l -19 -32 q -38 -64 -56 -135 q -18 -71 -18 -145 q 0 -116 44 -219 q 44 -102 121 -179 q 76 -76 179 -121 q 102 -44 219 -44 q 106 0 206 38 q 99 39 177 113 l 39 37 l 35 -41 q 61 -72 140 -110 q 79 -37 171 -37 q 85 0 160 32 q 74 33 130 88 q 55 56 87 130 q 32 75 32 160 q 0 70 -23 135 q -23 66 -71 123 l -28 34 l 30 32 q 45 51 69 112 q 23 61 23 127 q 0 74 -28 139 q -28 65 -76 114 q -49 49 -114 77 q -66 28 -140 28 q -63 0 -126 -24 l -44 -17 l -20 43 q -23 47 -56 84 q -34 38 -76 64 q -42 27 -90 41 q -48 14 -100 14 z",Arc:"M-1.4210854715202004e-14,-45.200008392333984Q15.408730615404892,-45.200008392334,26.304348523034477,-31.96123244390823Q37.19996643066406,-18.722456495482472,37.19996643066406,-2.1316282072803006e-14Q37.19996643066406,-1.4210854715202004e-14,37.19996643066406,-1.4210854715202004e-14",DoubleBracket:"M 717 1843 v 103 h -307 q -63 0 -119 -25 q -56 -24 -98 -66 q -42 -42 -66 -98 q -25 -56 -25 -119 v -1228 q 0 -63 25 -119 q 24 -56 66 -98 q 42 -42 98 -67 q 56 -24 119 -24 h 307 v 103 h -307 q -42 0 -79 16 q -38 16 -66 44 q -28 28 -44 65 q -16 38 -16 80 v 1228 q 0 42 16 79 q 16 38 44 66 q 28 28 66 44 q 37 16 79 16 m 1228 -1741 q 63 0 119 24 q 56 25 98 67 q 42 42 67 98 q 24 56 24 119 v 1228 q 0 63 -24 119 q -25 56 -67 98 q -42 42 -98 66 q -56 25 -119 25 h -307 v -103 h 307 q 42 0 80 -16 q 37 -16 65 -44 q 28 -28 44 -66 q 16 -37 16 -79 v -1228 q 0 -42 -16 -80 q -16 -37 -44 -65 q -28 -28 -65 -44 q -38 -16 -80 -16 h -307 v -103 z",DoubleBrace:"M 1843 1126 q -38 0 -75 8 q -37 9 -66 32 q -29 23 -46 62 q -18 40 -18 103 v 410 q 0 77 -22 118 q -23 42 -55 61 q -33 20 -68 23 q -35 3 -59 3 h -103 v -103 q 14 -1 25 -1 q 10 0 18 0 q 15 0 27 0 q 11 1 33 1 q 38 0 59 -16 q 20 -15 30 -35 q 11 -22 13 -51 v -410 q 0 -62 18 -113 q 17 -51 46 -90 q 29 -39 66 -66 q 36 -26 75 -38 q -39 -12 -75 -40 q -37 -27 -66 -67 q -29 -40 -46 -91 q -18 -50 -18 -109 v -410 q 0 -38 -16 -59 q -16 -20 -35 -30 q -23 -11 -51 -13 h -103 v -103 h 103 q 57 3 102 26 q 19 10 38 24 q 18 15 32 37 q 14 22 23 51 q 9 29 9 67 v 410 q 0 59 18 98 q 17 39 46 63 q 29 24 66 34 q 37 10 75 10 m -1638 0 q 38 0 75 -10 q 37 -10 66 -34 q 29 -24 47 -63 q 17 -39 17 -98 v -410 q 0 -38 9 -67 q 9 -29 23 -51 q 14 -22 33 -37 q 18 -14 37 -24 q 45 -23 102 -26 h 103 v 103 h -103 q -29 2 -51 13 q -20 10 -35 30 q -16 21 -16 59 v 410 q 0 59 -17 109 q -18 51 -47 91 q -29 40 -65 67 q -37 28 -76 40 q 39 12 76 38 q 36 27 65 66 q 29 39 47 90 q 17 51 17 113 v 410 q 2 29 13 51 q 10 20 31 35 q 20 16 58 16 q 22 0 33 -1 q 11 0 27 0 q 8 0 19 0 q 10 0 24 1 v 103 h -103 q -24 0 -59 -3 q -35 -3 -67 -23 q -33 -19 -55 -61 q -23 -41 -23 -118 v -410 q 0 -63 -17 -103 q -18 -39 -47 -62 q -29 -23 -66 -32 q -37 -8 -75 -8 z",LeftBracket:"M 1331 1843 v 103 h -307 q -63 0 -119 -25 q -56 -24 -98 -66 q -42 -42 -66 -98 q -24 -56 -24 -119 v -1228 q 0 -63 24 -119 q 24 -56 66 -98 q 42 -42 98 -67 q 56 -24 119 -24 h 307 v 103 h -307 q -42 0 -79 16 q -38 16 -66 44 q -28 28 -44 65 q -16 38 -16 80 v 1228 q 0 42 16 79 q 16 38 44 66 q 28 28 66 44 q 37 16 79 16 z",RightBracket:"M 1024 102 q 63 0 119 24 q 56 25 98 67 q 42 42 66 98 q 24 56 24 119 v 1228 q 0 63 -24 119 q -24 56 -66 98 q -42 42 -98 66 q -56 25 -119 25 h -307 v -103 h 307 q 42 0 80 -16 q 37 -16 65 -44 q 28 -28 44 -66 q 16 -37 16 -79 v -1228 q 0 -42 -16 -80 q -16 -37 -44 -65 q -28 -28 -65 -44 q -38 -16 -80 -16 h -307 v -103 z",LeftBrace:"M 717 922 q 38 0 75 -10 q 37 -10 66 -34 q 29 -24 47 -63 q 17 -39 17 -98 v -410 q 0 -38 9 -67 q 9 -29 23 -51 q 14 -22 33 -37 q 18 -14 37 -24 q 45 -23 102 -26 h 103 v 103 h -103 q -29 2 -51 13 q -20 10 -35 30 q -16 21 -16 59 v 410 q 0 59 -17 109 q -18 51 -47 91 q -29 40 -65 67 q -37 28 -76 40 q 39 12 76 38 q 36 27 65 66 q 29 39 47 90 q 17 51 17 113 v 410 q 2 29 13 51 q 10 20 31 35 q 20 16 58 16 q 22 0 33 -1 q 11 0 27 0 q 8 0 19 0 q 10 0 24 1 v 103 h -103 q -24 0 -59 -3 q -35 -3 -67 -23 q -33 -19 -55 -61 q -23 -41 -23 -118 v -410 q 0 -63 -17 -103 q -18 -39 -47 -62 q -29 -23 -66 -32 q -37 -8 -75 -8 z",RightBrace:"M 1229 1126 q -39 0 -75 8 q -37 9 -66 32 q -29 23 -46 62 q -18 40 -18 103 v 410 q 0 51 -10 86 q -11 35 -28 58 q -18 23 -40 35 q -22 13 -44 18 q -23 6 -45 7 q -22 1 -38 1 h -102 v -103 q 14 -1 25 -1 q 10 0 18 0 q 15 0 26 0 q 11 1 33 1 q 38 0 59 -16 q 21 -15 31 -35 q 11 -22 13 -51 v -410 q 0 -62 18 -113 q 17 -51 46 -90 q 28 -39 65 -66 q 36 -26 75 -38 q -39 -12 -75 -40 q -37 -27 -65 -67 q -29 -40 -46 -91 q -18 -50 -18 -109 v -410 q 0 -38 -16 -59 q -16 -20 -36 -30 q -23 -11 -51 -13 h -102 v -103 h 102 q 57 3 102 26 q 19 10 38 24 q 18 15 33 37 q 14 22 23 51 q 9 29 9 67 v 410 q 0 59 18 98 q 17 39 46 63 q 29 24 66 34 q 36 10 75 10 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Can:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",FlowChartProcess:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",FlowChartAlternateProcess:"M 456 1690 q -62 0 -117 -24 q -55 -24 -96 -65 q -41 -41 -65 -96 q -24 -55 -24 -118 v -726 q 0 -63 24 -118 q 24 -55 65 -96 q 41 -41 96 -65 q 55 -24 117 -24 h 1136 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 726 q 0 63 -24 118 q -24 55 -65 96 q -41 41 -96 65 q -55 24 -117 24 z",FlowChartPunchedTape:"M 563 1894 q -94 0 -169 -15 q -76 -15 -129 -38 q -54 -23 -82 -50 q -29 -27 -29 -50 v -1276 q 69 45 175 71 q 105 27 234 27 q 109 0 203 -20 q 94 -19 163 -54 q 68 -34 107 -81 q 39 -46 39 -101 q 0 -23 29 -50 q 29 -27 83 -50 q 53 -23 129 -38 q 75 -15 169 -15 q 94 0 170 15 q 75 15 128 38 q 53 23 82 50 q 29 27 29 50 v 1276 q -69 -45 -174 -72 q -106 -26 -235 -26 q -110 0 -203 19 q -94 20 -162 54 q -69 35 -108 81 q -39 47 -39 102 q 0 23 -29 50 q -29 27 -82 50 q -54 23 -129 38 q -76 15 -170 15 Z",FlowChartDecision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",FlowChartDocument:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",FlowChartPredefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",FlowChartTerminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",FlowChartSort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",FlowChartMultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",FlowChartCollate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",FlowChartSummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",FlowChartOr:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",FlowChartInternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",FlowChartExtract:"M0,35 L30,0 L60,35 Z",FlowChartManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",FlowChartMagneticDisk:"M 1024 1690 q -128 0 -242 -13 q -115 -12 -211 -34 q -97 -22 -174 -52 q -78 -30 -131 -64 q -54 -34 -83 -71 q -29 -37 -29 -74 v -716 q 0 -36 29 -74 q 29 -37 83 -71 q 53 -34 131 -64 q 77 -30 174 -52 q 96 -22 211 -35 q 114 -12 242 -12 q 128 0 243 12 q 114 13 211 35 q 96 22 174 52 q 77 30 131 64 q 53 34 82 71 q 29 38 29 74 v 716 q 0 37 -29 74 q -29 37 -82 71 q -54 34 -131 64 q -78 30 -174 52 q -97 22 -211 34 q -115 13 -243 13 Z",FlowChartConnector:"M 973 1792 q -113 0 -217 -30 q -105 -29 -196 -82 q -91 -53 -166 -128 q -75 -75 -128 -166 q -53 -91 -82 -196 q -30 -104 -30 -217 q 0 -113 30 -218 q 29 -104 82 -195 q 53 -91 128 -166 q 75 -75 166 -128 q 91 -53 196 -83 q 104 -29 217 -29 q 113 0 218 29 q 104 30 195 83 q 91 53 166 128 q 75 75 128 166 q 53 91 83 195 q 29 105 29 218 q 0 113 -29 217 q -30 105 -83 196 q -53 91 -128 166 q -75 75 -166 128 q -91 53 -195 82 q -105 30 -218 30 Z",FlowChartOffPageConnector:"M 358 1407 v -1253 h 1332 v 1253 l -666 476 Z",FlowChartDirectAccessStorage:"M 358 1024 q 0 -128 13 -243 q 12 -114 34 -211 q 22 -96 52 -174 q 30 -77 64 -131 q 34 -53 71 -82 q 37 -29 74 -29 h 716 q 36 0 74 29 q 37 29 71 82 q 34 54 64 131 q 30 78 52 174 q 22 97 35 211 q 12 115 12 243 q 0 128 -12 242 q -13 115 -35 211 q -22 97 -52 174 q -30 78 -64 131 q -34 54 -71 83 q -38 29 -74 29 h -716 q -37 0 -74 -29 q -37 -29 -71 -83 q -34 -53 -64 -131 q -30 -77 -52 -174 q -22 -96 -34 -211 q -13 -114 -13 -242 Z",FlowChartMerge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",FlowChartSequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",FlowChartData:"M 10 0 L 40 0 L 30 40 L 0 40 Z",FlowChartCard:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",FlowChartDelay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",FlowChartPreparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",FlowChartDisplay:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",FlowChartManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",FlowChartStoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z",RightArrow:"M 1178 1382 h -1024 v -716 h 1024 v -338 l 695 696 l -695 696 z",LeftArrow:"M 870 666 h 1024 v 716 h -1024 v 338 l -695 -696 l 695 -696 z",UpArrow:"M 1382 870 v 1024 h -716 v -1024 h -338 l 696 -695 l 696 695 z",DownArrow:"M 666 1178 v -1024 h 716 v 1024 h 338 l -696 695 l -696 -695 z",LeftRightArrow:"M 1382 1280 h -716 v 235 l -491 -491 l 491 -491 v 235 h 716 v -235 l 491 491 l -491 491 z",UpDownArrow:"M 768 1382 v -716 h -235 l 491 -491 l 491 491 h -235 v 716 h 235 l -491 491 l -491 -491 z",QuadArrow:"M 738 1587 h 132 v -409 h -409 v 132 l -286 -286 l 286 -286 v 132 h 409 v -409 h -132 l 286 -286 l 286 286 h -132 v 409 h 409 v -132 l 286 286 l -286 286 v -132 h -409 v 409 h 132 l -286 286 z",LeftRightUpArrow:"M 461 1485 v 132 l -286 -286 l 286 -286 v 133 h 409 v -615 h -132 l 286 -286 l 286 286 h -132 v 615 h 409 v -133 l 286 286 l -286 286 v -132 z",BentArrow:"M 154 1894 v -1126 q 0 -63 24 -119 q 24 -56 66 -98 q 41 -42 97 -66 q 56 -24 120 -24 h 1024 v -235 l 388 388 l -388 389 v -235 h -768 q -53 0 -99 20 q -47 20 -82 55 q -35 35 -55 81 q -20 47 -20 100 v 870 z",UTurnArrow:"M 154 1894 v -1075 q 0 -92 24 -177 q 24 -85 67 -159 q 43 -73 104 -134 q 61 -61 135 -104 q 73 -43 158 -67 q 85 -24 177 -24 h 103 q 92 0 177 24 q 85 24 159 67 q 73 43 134 104 q 61 61 104 134 q 43 74 67 159 q 24 85 24 177 v 359 h 235 l -388 388 l -389 -388 h 235 v -359 q 0 -74 -28 -139 q -28 -65 -77 -114 q -49 -49 -114 -77 q -65 -28 -139 -28 h -103 q -74 0 -139 28 q -65 28 -114 77 q -49 49 -77 114 q -28 65 -28 139 v 1075 z",LeftUpArrow:"M 175 1434 l 388 -389 v 235 h 717 v -717 h -235 l 389 -388 l 388 388 h -235 v 1024 h -1024 v 235 z",BentUpArrow:"M 154 1894 v -307 h 1126 v -1024 h -235 l 389 -388 l 388 388 h -235 v 1331 z",CurvedRightArrow:"M 1280 1587 h -205 q -99 0 -190 -26 q -92 -25 -171 -72 q -80 -47 -145 -112 q -66 -65 -113 -145 q -47 -80 -72 -172 q -26 -91 -26 -190 q 0 -99 26 -191 q 25 -91 72 -171 q 47 -79 113 -145 q 65 -65 145 -112 q 79 -46 171 -72 q 91 -25 190 -25 h 205 v 307 h -205 q -108 0 -208 31 q -101 31 -187 88 q -87 57 -155 137 q -68 81 -110 180 l -10 25 l 14 23 q 50 79 116 141 q 66 62 144 105 q 78 43 166 66 q 87 23 179 23 h 256 v -235 l 388 389 l -388 388 z",CurvedLeftArrow:"M 768 1822 l -388 -388 l 388 -389 v 235 h 256 q 92 0 180 -23 q 87 -23 165 -66 q 78 -43 144 -105 q 66 -62 116 -141 l 14 -23 l -10 -25 q -42 -99 -110 -180 q -68 -80 -154 -137 q -87 -57 -187 -88 q -101 -31 -209 -31 h -205 v -307 h 205 q 99 0 191 25 q 91 26 171 72 q 79 47 145 112 q 65 66 112 145 q 47 80 73 171 q 25 92 25 191 q 0 99 -25 190 q -26 92 -73 172 q -47 80 -112 145 q -66 65 -145 112 q -80 47 -171 72 q -92 26 -191 26 h -205 z",CurvedUpArrow:"M 1587 768 v 205 q 0 99 -25 190 q -26 92 -73 171 q -47 80 -112 145 q -65 66 -145 113 q -80 47 -171 72 q -92 26 -191 26 q -99 0 -190 -26 q -92 -25 -171 -72 q -80 -47 -145 -113 q -66 -65 -112 -145 q -47 -79 -72 -171 q -26 -91 -26 -190 v -205 h 307 v 205 q 0 108 31 208 q 31 101 88 187 q 57 87 138 155 q 80 68 179 110 l 25 10 l 23 -14 q 79 -50 141 -116 q 62 -66 105 -144 q 43 -78 66 -166 q 23 -87 23 -179 v -256 h -235 l 389 -388 l 388 388 z",CurvedDownArrow:"M 1822 1280 l -388 388 l -389 -388 h 235 v -256 q 0 -92 -23 -180 q -23 -87 -66 -165 q -43 -78 -105 -144 q -62 -66 -141 -116 l -23 -14 l -25 10 q -99 42 -179 110 q -81 68 -138 154 q -57 87 -88 187 q -31 101 -31 209 v 205 h -307 v -205 q 0 -99 26 -191 q 25 -91 72 -171 q 46 -79 112 -145 q 65 -65 145 -112 q 79 -47 171 -73 q 91 -25 190 -25 q 99 0 191 25 q 91 26 171 73 q 80 47 145 112 q 65 66 112 145 q 47 80 73 171 q 25 92 25 191 v 205 z",StripedRightArrow:"M 102 614 h 103 v 820 h -103 m 205 -820 h 103 v 820 h -103 m 819 409 v -409 h -614 v -820 h 614 v -409 l 820 819 m -717 307 v 265 l 572 -572 l -572 -572 v 265 h -615 v 614 z",NotchedRightArrow:"M 1126 1843 v -409 h -1024 l 512 -410 l -512 -410 h 1024 v -409 l 820 819 m -717 307 v 265 l 572 -572 l -572 -572 v 265 h -835 l 384 307 l -384 307 z",Pentagon:"M 154 1690 v -1434 h 1002 l 717 717 l -717 717 z",Chevron:"M 226 1690 l 717 -717 l -717 -717 h 930 l 717 717 l -717 717 z",RightArrowCallout:"M 154 154 h 1024 v 716 h 307 v -234 l 388 388 l -388 388 v -234 h -307 v 716 h -1024 z",DownArrowCallout:"M 154 154 h 1740 v 1024 h -716 v 307 h 234 l -388 388 l -388 -388 h 234 v -307 h -716 z",LeftArrowCallout:"M 1894 154 v 1740 h -1024 v -716 h -307 v 234 l -388 -388 l 388 -388 v 234 h 307 v -716 z",UpArrowCallout:"M 1894 1894 h -1740 v -1024 h 716 v -307 h -234 l 388 -388 l 388 388 h -234 v 307 h 716 z",LeftRightArrowCallout:"M 666 1894 v -716 h -205 v 132 l -286 -286 l 286 -286 v 132 h 205 v -716 h 716 v 716 h 205 v -132 l 286 286 l -286 286 v -132 h -205 v 716 z",QuadArrowCallout:"M 738 1587 h 132 v -205 h -204 v -204 h -205 v 132 l -286 -286 l 286 -286 v 132 h 205 v -204 h 204 v -205 h -132 l 286 -286 l 286 286 h -132 v 205 h 204 v 204 h 205 v -132 l 286 286 l -286 286 v -132 h -205 v 204 h -204 v 205 h 132 l -286 286 z",CircularArrow:"M 1045 1382 h 235 v -460 q 0 -74 -28 -140 q -28 -65 -77 -114 q -49 -48 -114 -77 q -65 -28 -139 -28 h -103 q -74 0 -139 28 q -65 29 -114 77 q -49 49 -77 114 q -28 66 -28 140 v 665 h -307 v -665 q 0 -92 24 -177 q 24 -85 67 -159 q 43 -74 104 -135 q 61 -60 135 -104 q 73 -43 158 -67 q 85 -24 177 -24 h 103 q 92 0 177 24 q 85 24 159 67 q 73 44 134 104 q 61 61 104 135 q 43 74 67 159 q 24 85 24 177 v 460 h 235 l -388 389 z",Explosion1:"M 833 1509 l -270 225 v -352 h -282 l 309 -193 l -374 -421 h 450 v -337 l 260 260 l 354 -443 v 418 h 361 l -226 317 l 381 297 h -394 l 228 457 l -479 -218 l -134 312 z",Explosion2:"M 591 1480 l -324 -1 l 208 -249 l -270 -360 h 492 l -135 -270 l 247 82 l 39 -239 l 187 281 l 168 -418 l 35 281 l 417 -186 l -135 408 l 253 42 l -215 172 l 246 206 h -300 l 174 346 l -347 -173 v 353 l -305 -175 l -416 270 z",Star4Point:"M 848 1200 l -572 -176 l 572 -176 l 176 -572 l 176 572 l 572 176 l -572 176 l -176 572 z",Star5Point:"M 1219 768 h 603 l -446 446 l 175 612 l -527 -352 l -527 352 l 175 -612 l -446 -446 h 598 l 202 -521 z",Star6Point:"M 786 1485 h -580 l 350 -461 l -350 -461 h 580 l 238 -367 l 238 367 h 580 l -350 461 l 350 461 h -580 l -238 367 z",Star7Point:"M 1024 1541 l -395 307 l -42 -422 l -396 -176 l 314 -314 l -207 -373 h 461 l 265 -372 l 265 372 h 461 l -207 373 l 314 314 l -396 176 l -42 422 z",Star8Point:"M 738 1587 h -277 v -277 l -286 -286 l 286 -286 v -277 h 282 l 281 -286 l 286 286 h 277 v 277 l 286 286 l -286 286 v 277 h -277 l -286 286 z",Star10Point:"M 828 1635 l -367 48 v -286 l -277 -93 l 198 -280 l -198 -280 l 277 -93 v -286 l 367 48 l 196 -231 l 196 231 l 370 -48 v 286 l 274 92 l -198 281 l 198 280 l -277 93 v 286 l -367 -48 l -196 231 z",Star12Point:"M 868 1611 l -305 231 v -357 h -357 l 231 -305 l -241 -156 l 241 -156 l -231 -305 h 357 v -357 l 305 231 l 156 -241 l 156 241 l 305 -231 v 357 h 357 l -231 305 l 241 156 l -241 156 l 231 305 h -357 v 357 l -305 -231 l -156 241 z",Star16Point:"M-51.20001220703125,0L-37.66234497940063,-6.9061855534744225L-47.302667277832036,-18.06249483215332L-31.9284556123352,-19.667176728401184L-36.204040631713866,-33.375589842071534L-21.333893086395264,-29.434036096916195L-19.593220671386717,-43.60713318054199L-7.491457786102288,-34.71996375514984L0,-47.19999694824219L7.491457786102288,-34.71996375514984L19.593220671386717,-43.60713318054199L21.33389308639528,-29.434036096916195L36.20404063171388,-33.375589842071534L31.928455612335213,-19.667176728401184L47.30266727783204,-18.06249483215332L37.66234497940066,-6.9061855534744225L51.20001220703125,0L37.66234497940066,6.9061855534744225L47.30266727783204,18.06249483215332L31.928455612335213,19.667176728401188L36.20404063171388,33.37558984207155L21.33389308639528,29.434036096916202L19.593220671386717,43.60713318054199L7.491457786102288,34.71996375514985L0,47.19999694824219L-7.491457786102288,34.71996375514985L-19.593220671386717,43.60713318054199L-21.333893086395264,29.434036096916202L-36.204040631713866,33.37558984207155L-31.9284556123352,19.667176728401188L-47.302667277832036,18.06249483215332L-37.66234497940063,6.9061855534744225Z",Star24Point:"M-51.20001220703125,0L-38.071305076904295,-4.620761701240539L-49.45541409708704,-12.216258138985935L-35.47700045837402,-13.546871124114986L-44.34051124536243,-23.599998474121094L-30.464647263336182,-21.55010260665893L-36.20387582842581,-33.3754379140864L-23.37638957336425,-28.084588184165955L-25.600006103515625,-40.87639641572571L-14.694915503540031,-32.70534988540649L-13.251538268661228,-45.59169605307234L-5.012353195037839,-35.096973730773925L0,-47.19999694824219L5.012353195037846,-35.096973730773925L13.251538268661236,-45.59169605307234L14.694915503540045,-32.70534988540649L25.600006103515625,-40.87639641572571L23.37638957336425,-28.084588184165955L36.20387582842582,-33.3754379140864L30.464647263336204,-21.55010260665893L44.340511245362435,-23.599998474121094L35.47700045837402,-13.546871124114986L49.45541409708704,-12.216258138985935L38.07130507690431,-4.620761701240539L51.20001220703125,0L38.07130507690431,4.620761701240539L49.45541409708704,12.216258138985935L35.47700045837402,13.546871124114993L44.340511245362435,23.599998474121094L30.464647263336204,21.550102606658925L36.20387582842582,33.375437914086405L23.37638957336425,28.084588184165966L25.600006103515625,40.87639641572571L14.694915503540045,32.70534988540649L13.251538268661236,45.59169605307234L5.012353195037846,35.096973730773925L0,47.19999694824219L-5.012353195037839,35.096973730773925L-13.251538268661228,45.59169605307234L-14.694915503540031,32.70534988540649L-25.600006103515625,40.87639641572571L-23.37638957336425,28.084588184165966L-36.20387582842581,33.375437914086405L-30.464647263336182,21.550102606658925L-44.34051124536243,23.599998474121094L-35.47700045837402,13.546871124114993L-49.45541409708704,12.216258138985935L-38.071305076904295,4.620761701240539Z",Star32Point:"M-54,0L-40.30479,-3.52872L-52.96266,-9.36432L-38.75607,-10.45008L-49.889520000000005,-18.368640000000003L-35.71776,-16.9704L-44.89938,-26.667360000000002L-31.306905,-22.838040000000007L-38.18376618407357,-33.94112549695428L-25.692795000000004,-27.828360000000004L-30.00078,-39.910560000000004L-19.091700000000003,-31.749120000000005L-20.664719999999996,-44.34624L-11.756339999999994,-34.44984L-10.534859999999995,-47.077920000000006L-3.9698099999999954,-35.82648L0,-48L3.9698100000000025,-35.82648L10.534860000000009,-47.077920000000006L11.756340000000009,-34.44984L20.664720000000003,-44.34624L19.091700000000003,-31.749120000000005L30.000780000000006,-39.910560000000004L25.692795000000004,-27.828360000000004L38.183766184073576,-33.94112549695428L31.306905000000015,-22.838040000000007L44.89938000000001,-26.667360000000002L35.71776000000001,-16.9704L49.889520000000005,-18.368640000000003L38.75607000000001,-10.45008L52.962660000000014,-9.36432L40.30479000000001,-3.52872L54,0L40.30479000000001,3.52872L52.962660000000014,9.36432L38.75607000000001,10.45008L49.889520000000005,18.36864L35.71776000000001,16.970399999999998L44.89938000000001,26.667359999999988L31.306905000000015,22.838039999999992L38.183766184073576,33.941125496954285L25.692795000000004,27.828360000000004L30.000780000000006,39.91055999999999L19.091700000000003,31.749120000000005L20.664720000000003,44.346239999999995L11.756340000000009,34.449839999999995L10.534860000000009,47.077920000000006L3.9698100000000025,35.826480000000004L0,48L-3.9698099999999954,35.826480000000004L-10.534859999999995,47.077920000000006L-11.756339999999994,34.449839999999995L-20.664719999999996,44.346239999999995L-19.091700000000003,31.749120000000005L-30.00078,39.91055999999999L-25.692795000000004,27.828360000000004L-38.18376618407357,33.941125496954285L-31.306905,22.838039999999992L-44.89938,26.667359999999988L-35.71776,16.970399999999998L-49.889520000000005,18.36864L-38.75607,10.45008L-52.96266,9.36432L-40.30479,3.52872Z",UpRibbon:"M 1741 1075 l 205 461 h -717 v -205 h -410 v 205 h -717 l 205 -461 l -205 -461 h 410 v -204 h 1024 v 204 h 410 m -512 615 v -717 h -820 v 717 m -102 -512 h -252 l 159 358 l -159 359 h 252 m 1117 -359 l 159 -358 h -252 v 717 h 252 m -1071 -103 h -103 v 103 h 103 m 717 0 v -103 h -103 v 103 z",DownRibbon:"M 1946 410 l -205 460 l 205 461 h -410 v 205 h -1024 v -205 h -410 l 205 -461 l -205 -460 h 717 v 204 h 410 v -204 m -615 307 v 717 h 820 v -717 m 102 512 h 252 l -159 -359 l 159 -358 h -252 m -1117 358 l -159 359 h 252 v -717 h -252 m 1174 0 h -103 v 102 h 103 m -820 -102 v 102 h 103 v -102 z",CurvedUpRibbon:"M 1741 1075 l 205 666 q -62 -57 -130 -102 q -29 -19 -62 -38 q -34 -18 -70 -33 q -36 -14 -73 -23 q -38 -9 -75 -9 h -307 v -256 q 0 -10 -16 -20 q -16 -9 -44 -16 q -28 -7 -65 -11 q -38 -4 -80 -4 q -42 0 -79 4 q -38 4 -66 11 q -28 7 -44 16 q -16 10 -16 20 v 256 h -307 q -38 0 -75 9 q -38 9 -74 23 q -36 15 -69 33 q -33 19 -62 38 q -69 45 -130 102 l 205 -666 l -205 -461 q 60 -75 122 -117 q 62 -41 119 -62 q 56 -20 104 -25 q 47 -4 78 -4 q 19 -43 65 -80 q 45 -37 111 -64 q 66 -27 149 -42 q 82 -15 174 -15 q 92 0 175 15 q 82 15 148 42 q 66 27 112 64 q 45 37 64 80 q 31 0 79 4 q 47 5 104 25 q 56 21 118 62 q 62 42 122 117 m -1659 876 q 116 -56 225 -56 v -926 l -8 -1 q -21 0 -51 4 q -30 4 -65 16 q -35 12 -73 34 q -39 22 -78 58 l 184 456 m 296 256 h -103 v 103 h 103 m 307 -308 q 72 0 124 8 q 52 9 87 23 q 35 15 55 33 q 20 19 30 39 h 114 v -773 l -4 -9 q -9 -21 -41 -46 q -32 -24 -83 -45 q -52 -21 -123 -35 q -71 -14 -159 -14 q -88 0 -159 14 q -71 14 -123 35 q -52 21 -83 45 q -32 25 -41 46 l -4 9 v 773 h 114 q 10 -20 30 -39 q 20 -18 55 -33 q 35 -14 87 -23 q 52 -8 124 -8 m 410 308 v -103 h -103 v 103 m 296 -380 l 184 -435 q -39 -36 -77 -58 q -39 -22 -74 -34 q -35 -12 -64 -16 q -30 -4 -51 -4 h -9 v 927 q 109 0 225 56 z",CurvedDownRibbon:"M 307 870 l -205 -665 q 61 58 130 103 q 29 19 62 37 q 33 19 69 33 q 36 14 74 23 q 37 9 75 9 h 307 v 256 q 0 11 16 20 q 16 9 44 16 q 28 7 66 11 q 37 4 79 4 q 42 0 80 -4 q 37 -4 65 -11 q 28 -7 44 -16 q 16 -9 16 -20 v -256 h 307 q 37 0 75 -9 q 37 -9 73 -23 q 36 -14 70 -33 q 33 -18 62 -37 q 68 -45 130 -103 l -205 665 l 205 461 q -55 69 -112 110 q -57 41 -110 63 q -54 23 -100 30 q -47 7 -80 7 q -6 0 -11 -1 q -5 0 -10 0 q -19 43 -64 80 q -46 37 -112 64 q -66 27 -148 42 q -83 15 -175 15 q -92 0 -174 -15 q -83 -15 -149 -42 q -66 -27 -111 -64 q -46 -37 -65 -80 q -5 0 -10 0 q -6 1 -11 1 q -33 0 -79 -7 q -47 -7 -100 -30 q -54 -22 -111 -63 q -57 -41 -112 -110 m 1659 -875 q -120 56 -225 56 v 926 h 8 q 21 0 51 -4 q 30 -4 65 -16 q 35 -12 74 -34 q 38 -22 77 -58 l -184 -456 m -296 -256 h 103 v -102 h -103 m -307 307 q -72 0 -124 -9 q -52 -8 -87 -22 q -35 -14 -55 -33 q -20 -18 -30 -38 h -114 v 773 l 4 9 q 9 21 41 45 q 31 25 83 45 q 52 21 123 35 q 71 14 159 14 q 88 0 159 -14 q 71 -14 123 -35 q 51 -20 83 -45 q 32 -24 41 -45 l 4 -9 v -773 h -114 q -10 20 -30 38 q -20 19 -55 33 q -35 14 -87 22 q -52 9 -124 9 m -410 -307 v 102 h 103 v -102 m -296 380 l -184 434 q 39 36 78 58 q 38 22 73 34 q 35 12 65 16 q 29 4 50 4 h 9 v -926 q -105 0 -225 -56 z",VerticalScroll:"M 1690 102 q 53 0 100 20 q 46 20 81 55 q 35 35 55 81 q 20 47 20 100 q 0 53 -20 100 q -20 47 -55 81 q -35 35 -81 55 q -47 20 -100 20 h -52 v 1178 q 0 32 -12 60 q -12 28 -32 49 q -21 21 -49 33 q -28 12 -60 12 h -1178 q -42 0 -79 -17 q -38 -16 -65 -44 q -28 -27 -44 -65 q -17 -37 -17 -79 q 0 -42 17 -80 q 16 -37 44 -65 q 27 -28 65 -44 q 37 -16 79 -16 h 103 v -1280 q 0 -32 12 -60 q 12 -28 33 -49 q 20 -21 48 -33 q 28 -12 60 -12 m 51 308 q 0 -41 16 -78 q 15 -36 42 -64 q 26 -28 62 -45 q 35 -16 76 -18 h -247 q -21 0 -36 15 q -15 15 -15 36 v 1587 h 973 q 21 0 36 -15 q 15 -15 15 -36 v -1178 h -717 q -42 0 -79 -16 q -38 -16 -66 -44 q -28 -27 -44 -65 q -16 -37 -16 -79 m 1076 102 q 31 0 59 -12 q 28 -12 49 -33 q 21 -21 33 -49 q 12 -28 12 -60 q 0 -31 -12 -59 q -12 -28 -33 -49 q -21 -21 -49 -33 q -28 -12 -59 -12 h -863 q 41 2 77 18 q 36 17 63 45 q 26 28 42 64 q 15 37 15 78 q 0 28 -7 53 q -7 26 -20 49 m -587 1126 h -103 q -21 0 -39 8 q -19 8 -33 22 q -14 14 -22 33 q -8 19 -8 40 q 0 21 8 39 q 8 19 22 33 q 14 14 33 22 q 18 8 39 8 h 103 m 409 -1331 q 21 0 40 -8 q 19 -8 33 -22 q 14 -14 22 -33 q 8 -18 8 -39 q 0 -21 -8 -40 q -8 -19 -22 -33 q -14 -14 -33 -22 q -19 -8 -40 -8 q -21 0 -39 8 q -19 8 -33 22 q -14 14 -22 33 q -8 19 -8 40 q 0 21 8 39 q 8 19 22 33 q 14 14 33 22 q 18 8 39 8 z",HorizontalScroll:"M 1741 102 q 42 0 80 16 q 37 17 65 44 q 27 28 44 65 q 16 38 16 80 v 1178 q 0 32 -12 60 q -12 28 -33 48 q -21 21 -49 33 q -28 12 -60 12 h -1178 v 52 q 0 53 -20 99 q -20 47 -54 82 q -35 35 -82 55 q -47 20 -100 20 q -53 0 -99 -20 q -47 -20 -82 -55 q -35 -35 -55 -82 q -20 -46 -20 -99 v -1127 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -20 49 -32 q 28 -12 60 -12 h 1280 v -103 q 0 -42 16 -80 q 16 -37 44 -65 q 28 -27 66 -44 q 37 -16 79 -16 m 102 410 h -1587 q -21 0 -36 15 q -15 15 -15 36 v 248 q 1 -41 18 -77 q 17 -36 45 -63 q 27 -26 64 -42 q 37 -15 78 -15 q 42 0 80 16 q 37 16 65 44 q 27 28 43 65 q 16 38 16 80 v 717 h 1178 q 21 0 36 -15 q 15 -15 15 -36 m -1433 -461 q -41 0 -78 -16 q -37 -15 -64 -42 q -28 -26 -45 -62 q -17 -35 -18 -76 v 862 q 0 32 12 59 q 12 28 33 49 q 21 21 49 33 q 27 12 59 12 q 32 0 60 -12 q 28 -12 49 -33 q 21 -21 33 -49 q 12 -27 12 -59 v -693 q -23 13 -48 20 q -26 7 -54 7 m 1433 -717 q 0 -21 -8 -40 q -8 -18 -22 -32 q -14 -14 -32 -22 q -19 -8 -40 -8 q -21 0 -40 8 q -19 8 -33 22 q -14 14 -22 32 q -8 19 -8 40 v 103 h 205 m -1331 409 q 0 -21 -8 -40 q -8 -18 -22 -32 q -14 -14 -32 -22 q -19 -8 -40 -8 q -21 0 -40 8 q -19 8 -33 22 q -14 14 -22 32 q -8 19 -8 40 q 0 21 8 40 q 8 19 22 33 q 14 14 33 22 q 19 8 40 8 q 21 0 40 -8 q 18 -8 32 -22 q 14 -14 22 -33 q 8 -19 8 -40 z",Wave:"M 1383 1894 q -42 0 -84 -8 q -43 -7 -77 -16 q -34 -9 -55 -17 q -22 -7 -23 -7 q -8 -5 -26 -17 q -18 -11 -39 -25 q -21 -13 -41 -27 q -20 -13 -32 -24 l -38 -33 q -40 -35 -89 -76 q -49 -41 -106 -77 q -58 -35 -123 -59 q -66 -23 -138 -23 q -68 0 -122 10 q -55 10 -99 27 q -44 17 -78 39 q -34 23 -59 47 v -1275 q 24 -16 77 -47 q 52 -30 126 -59 q 73 -29 165 -51 q 91 -22 195 -22 q 72 0 130 17 q 57 18 104 47 q 46 29 85 65 q 38 37 74 75 q 35 39 70 75 q 34 37 72 66 q 38 29 83 46 q 44 18 99 18 q 78 0 147 -24 q 69 -23 127 -59 q 57 -36 104 -80 q 47 -44 82 -85 v 1356 q -16 18 -57 55 q -41 38 -105 75 q -64 37 -149 65 q -86 28 -191 28 z",DoubleWave:"M 1690 1894 q -58 0 -100 -19 q -42 -19 -75 -48 q -33 -28 -62 -61 q -29 -33 -61 -62 q -32 -28 -71 -47 q -39 -19 -92 -19 q -51 0 -92 19 q -42 19 -77 47 q -35 29 -65 62 q -30 33 -59 61 q -29 29 -57 48 q -29 19 -60 19 q -35 0 -73 -19 q -39 -19 -79 -48 q -40 -28 -80 -61 q -40 -33 -79 -62 q -40 -28 -78 -47 q -38 -19 -72 -19 q -26 0 -52 10 q -27 11 -53 27 q -27 17 -52 38 q -25 22 -47 44 v -1480 q 19 -20 45 -42 q 26 -21 54 -39 q 27 -18 55 -30 q 27 -12 50 -12 q 24 0 55 19 q 31 19 67 47 q 36 29 77 62 q 41 33 84 61 q 43 29 88 48 q 45 19 90 19 q 48 0 87 -19 q 38 -19 71 -48 q 33 -28 63 -61 q 29 -33 59 -62 q 30 -28 62 -47 q 31 -19 68 -19 q 36 0 68 19 q 31 19 63 47 q 31 29 64 62 q 33 33 72 61 q 39 29 87 48 q 47 19 107 19 q 70 0 120 -17 q 50 -16 84 -40 v 1477 q -5 6 -17 17 q -12 11 -35 21 q -24 11 -61 18 q -37 8 -91 8 z",MathPlus:"M 1894 1280 h -614 v 614 h -512 v -614 h -614 v -512 h 614 v -614 h 512 v 614 h 614 z",MathMinus:"M 154 768 h 1740 v 512 h -1740 z",MathMultiply:"M 1409 1771 l -435 -435 l -434 435 l -362 -362 l 434 -435 l -434 -434 l 362 -362 l 434 434 l 435 -434 l 362 362 l -435 434 l 435 435 z",MathDivision:"M 1024 1792 q -32 0 -60 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -28 -12 -60 q 0 -31 12 -59 q 12 -28 33 -49 q 21 -21 49 -33 q 28 -12 60 -12 q 32 0 60 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 59 q 0 32 -12 60 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -60 12 m 0 -1229 q -32 0 -60 -12 q -28 -12 -49 -33 q -21 -21 -33 -49 q -12 -27 -12 -59 q 0 -32 12 -60 q 12 -28 33 -49 q 21 -21 49 -33 q 28 -12 60 -12 q 32 0 60 12 q 28 12 49 33 q 21 21 33 49 q 12 28 12 60 q 0 32 -12 59 q -12 28 -33 49 q -21 21 -49 33 q -28 12 -60 12 m -870 205 h 1740 v 512 h -1740 z",MathEqual:"M 154 358 h 1740 v 512 h -1740 m 0 205 h 1740 v 512 h -1740 z",MathNotEqual:"M 1372 870 l -136 205 h 658 v 512 h -1000 l -205 307 h -389 l 205 -307 h -351 v -512 h 693 l 136 -205 h -829 v -512 h 1170 l 137 -204 h 389 l -137 204 h 181 v 512 z",RoundedRectangle:"M 20,0 h 160 a 20,20 0 0 1 20,20 v 60 a 20,20 0 0 1 -20,20 h -160 a 20,20 0 0 1 -20,-20 v -60 a 20,20 0 0 1 20,-20 z",SnipSingleCornerRectangle:"M 154 1690 v -1332 h 1258 l 482 482 v 850 z",SnipSameSideCornerRectangle:"M 154 1690 v -850 l 482 -482 h 776 l 482 482 v 850 z",SnipDiagonalCornerRectangle:"M 636 1690 l -482 -482 v -850 h 1258 l 482 482 v 850 z",SnipAndRoundSingleCornerRectangle:"M 154 1690 v -1029 q 0 -63 24 -118 q 24 -55 65 -96 q 41 -41 96 -65 q 55 -24 117 -24 h 956 l 482 482 v 850 z",RoundSingleCornerRectangle:"M 154 1690 v -1332 h 1438 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 1029 z",RoundSameSideCornerRectangle:"M 154 1690 v -1029 q 0 -63 24 -118 q 24 -55 65 -96 q 41 -41 96 -65 q 55 -24 117 -24 h 1136 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 1029 z",RoundDiagonalCornerRectangle:"M 456 1690 q -62 0 -117 -24 q -55 -24 -96 -65 q -41 -41 -65 -96 q -24 -55 -24 -118 v -1029 h 1438 q 62 0 117 24 q 55 24 96 65 q 41 41 65 96 q 24 55 24 118 v 1029 z"},this.documentHelper=e}return Object.defineProperty(i.prototype,"pageCanvas",{get:function(){return this.isPrinting?((0,a.isNullOrUndefined)(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):this.isExporting?((0,a.isNullOrUndefined)(this.exportPageCanvas)&&(this.exportPageCanvas=new ja),this.exportPageCanvas):(0,a.isNullOrUndefined)(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spellChecker",{get:function(){try{return this.documentHelper.owner.spellCheckerModule}catch(e){return}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionCanvas",{get:function(){return(0,a.isNullOrUndefined)(this.viewer)?void 0:this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),i.prototype.renderWidgets=function(e,t,i,n,r){if(!((0,a.isNullOrUndefined)(this.pageCanvas)||(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.bodyWidgets))){if(this.pageContext.fillStyle=Pa.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),this.viewer instanceof Fl){r=r>this.documentHelper.visibleBounds.height?r:this.documentHelper.visibleBounds.height;var o=i;0===e.index&&(o=i-this.viewer.padding.top),this.pageContext.fillRect(t-this.viewer.padding.left,o,n+this.viewer.padding.left,r+this.viewer.padding.top)}else this.pageContext.fillRect(t,i,n,r);this.pageContext.closePath(),this.viewer instanceof kl&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(t,i,n,r)),this.pageLeft=t,this.pageTop=i,this.pageIndex=e.index,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(t,i,n,r),this.pageContext.clip()),this.height=r,e.headerWidget&&this.renderHFWidgets(e,e.headerWidgetIn,n,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidgetIn,n,!1);for(var s=0;s<e.bodyWidgets.length;s++)this.render(e,e.bodyWidgets[parseInt(s.toString(),10)]),e.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.footnoteWidget,n);e.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.endnoteWidget,n),this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidgetIn),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},i.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,i=e.boundingRectangle.height,n=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);this.pageCanvas.width===t*n&&this.pageCanvas.height===i*n||(this.pageCanvas.height=i*n,this.pageCanvas.width=t*n,this.pageCanvas.style.height=i+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(n,n)),this.pageContext.fillStyle="#FFFFFF",this.pageContext.fillRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.pageContext.fillStyle="#000000"},i.prototype.renderHFWidgets=function(e,t,i,n){this.isFieldCode&&(this.isFieldCode=!1),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var r=!1,o=e.boundingRectangle.height/100*40;if(n){var s=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin);Math.max(t.y+t.height,s)>o&&(r=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,i,this.getScaledValue(o)),this.pageContext.clip())}else{var l=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),d=void 0;d=((0,a.isNullOrUndefined)(e.footerWidgetIn.sectionFormat),e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+l,Pa.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))),Math.max(e.boundingRectangle.height-o,d),e.boundingRectangle.height-l}this.renderFloatingItems(e,t.floatingElements,"Behind");for(var h=0;h<t.childWidgets.length;h++){var c=t.childWidgets[parseInt(h.toString(),10)];n||c.height,this.renderWidget(e,c)}this.renderFloatingItems(e,t.floatingElements,"InFrontOfText"),r&&this.pageContext.restore(),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.5:1)},i.prototype.renderHeaderSeparator=function(e,t,i,n){var r=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),o=this.getScaledValue(Math.max(n.y+n.height,Math.abs(r))),s=this.getScaledValue(e.boundingRectangle.width),l=this.pageContext;l.save(),l.globalAlpha=.85;var d=this.getScaledValue(e.boundingRectangle.height)/100*40;o=Math.min(o,d),this.renderDashLine(l,t,i+o,s,"#000000",!1);var h=this.getHeaderFooterType(e,!0),c=this.viewer.getHeaderFooter(n.headerFooterType),p=e.sectionIndex,u=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(u.setLocale(this.documentHelper.owner.locale),this.documentHelper.headersFooters.length>1){var g=p+1;h=h+" -"+u.getConstant("Section")+" "+g+"-"}l.font="9pt Arial";var m,f=l.measureText(h).width;if(this.renderHeaderFooterMark(l,t+5,i+o,f+10,20),this.renderHeaderFooterMarkText(l,h,t+10,o+i+15),this.documentHelper.headersFooters[parseInt(p.toString(),10)]&&(m=this.documentHelper.headersFooters[parseInt(p.toString(),10)][parseInt(c.toString(),10)]),0!==p&&!m){var v=u.getConstant("Same as Previous"),y=l.measureText(v).width,w=this.viewer.containerWidth-y-75+t;this.renderHeaderFooterMark(l,w,i+o,y+10,20),this.renderHeaderFooterMarkText(l,v,w+5,o+i+15)}if(e.footerWidget){var b=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),C=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+b,Math.abs(Pa.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))));C=Math.max(this.getScaledValue(e.boundingRectangle.height)-d,C),this.renderDashLine(l,t,i+C,s,"#000000",!1);var x=this.getHeaderFooterType(e,!1),I=e.sectionIndex;if(this.documentHelper.headersFooters.length>1){g=I+1;x=x+" -"+u.getConstant("Section")+" "+g+"-"}f=l.measureText(x).width,this.renderHeaderFooterMark(l,t+5,i+C-20,f+10,20),this.renderHeaderFooterMarkText(l,x,t+10,i+C-5);var k,F=this.viewer.getHeaderFooter(e.footerWidget.headerFooterType);if(this.documentHelper.headersFooters[parseInt(I.toString(),10)]&&(k=this.documentHelper.headersFooters[parseInt(I.toString(),10)][parseInt(F.toString(),10)]),0!==I&&!k){v=u.getConstant("Same as Previous");var P=l.measureText(v).width;w=this.viewer.containerWidth-P-75+t;this.renderHeaderFooterMark(l,w,i+C-20,P+10,20),this.renderHeaderFooterMarkText(l,v,w+5,i+C-5)}l.restore()}},i.prototype.getFooterHeight=function(e){var t=e.boundingRectangle.height/100*40,i=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),n=e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+i,Pa.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin));return Math.max(e.boundingRectangle.height-t,n)},i.prototype.getHeaderFooterType=function(e,t){var i,n=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);return n.setLocale(this.documentHelper.owner.locale),i=t?n.getConstant("Header"):n.getConstant("Footer"),e.bodyWidgets[0].sectionFormat.differentFirstPage&&((0,a.isNullOrUndefined)(e.previousPage)||e.sectionIndex!==e.previousPage.sectionIndex)?i=t?n.getConstant("First Page Header"):n.getConstant("First Page Footer"):e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.documentHelper.pages.indexOf(e)+1)%2==0?t?n.getConstant("Even Page Header"):n.getConstant("Even Page Footer"):t?n.getConstant("Odd Page Header"):n.getConstant("Odd Page Footer")),i},i.prototype.renderDashLine=function(e,t,i,n,r,o){e.beginPath(),e.strokeStyle=r,e.lineWidth=1,o?e.setLineDash([3,2]):e.setLineDash([6,4]),e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.setLineDash([]),e.closePath()},i.prototype.renderSolidLine=function(e,t,i,n,r){e.beginPath(),e.strokeStyle=r,e.lineWidth=.5,e.moveTo(t,i),e.lineTo(t+n,i),e.stroke(),e.closePath()},i.prototype.renderHeaderFooterMark=function(e,t,i,n,r){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,n,r),e.strokeStyle="black",e.strokeRect(t,i,n,r),e.closePath()},i.prototype.renderHeaderFooterMarkText=function(e,t,i,n){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,n),e.closePath()},i.prototype.render=function(e,t){this.isFieldCode&&(this.isFieldCode=!1);for(var i=0;i<e.bodyWidgets.length;i++)(0,a.isNullOrUndefined)(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"Behind");var n,r=!1;if((0,a.isNullOrUndefined)(t.nextRenderedWidget)||t.columnIndex+1!==t.nextRenderedWidget.columnIndex||(n=t.nextRenderedWidget),!(this.viewer instanceof Fl)&&t.sectionFormat.columns.length>1&&!(0,a.isNullOrUndefined)(n)){var o=e.bodyWidgets.indexOf(t),s=void 0,l=void 0;0===t.columnIndex?(s=e.bodyWidgets[o].x-Pa.convertPointToPixel(e.bodyWidgets[o].sectionFormat.leftMargin),l=Pa.convertPointToPixel(e.bodyWidgets[o].sectionFormat.leftMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space/2):o===t.sectionFormat.columns.length-1?(s=e.bodyWidgets[o].x-t.sectionFormat.columns[t.columnIndex-1].space/2,l=Pa.convertPointToPixel(e.bodyWidgets[o].sectionFormat.rightMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex-1].space/2):(s=e.bodyWidgets[o].x-t.sectionFormat.columns[t.columnIndex].space/2,l=t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space),this.clipRect(s,e.bodyWidgets[o].y,this.getScaledValue(l),this.getScaledValue(e.boundingRectangle.height)),r=!0}for(i=0;i<t.childWidgets.length;i++){var d=t.childWidgets[parseInt(i.toString(),10)];0===i&&t.childWidgets[0]instanceof Al&&t.childWidgets[0].childWidgets.length>0&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,d,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,d)}r&&this.pageContext.restore();for(i=0;i<e.bodyWidgets.length;i++)(0,a.isNullOrUndefined)(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"InFrontOfText");for(i=0;i<e.bodyWidgets.length;i++)if(!0===e.bodyWidgets[parseInt(i.toString(),10)].sectionFormat.lineBetweenColumns&&0!==e.bodyWidgets[parseInt(i.toString(),10)].columnIndex&&e.bodyWidgets.length>1){var h=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),c=this.getScaledValue(Math.max(e.headerWidgetIn.y+e.headerWidgetIn.height,h)),p=this.getScaledValue(e.boundingRectangle.height)/100*40,u=Pa.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),g=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+u,Pa.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)));g=Math.max(this.getScaledValue(e.boundingRectangle.height)-p,g);var m=(e.bodyWidgets[parseInt(i.toString(),10)].x-(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width))/2+(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width),f=this.documentHelper.zoomFactor,v=m,y=void 0;y=e.footnoteWidget?(g-e.footerWidgetIn.height/2-e.footnoteWidget.height*this.documentHelper.zoomFactor)/this.documentHelper.zoomFactor:(g-e.footerWidgetIn.height/2)/this.documentHelper.zoomFactor;var w=this.documentHelper.layout.getBodyWidget(e.bodyWidgets[parseInt(i.toString(),10)],!0),b=this.documentHelper.layout.getNextWidgetHeight(w);f=e.bodyWidgets[parseInt(i.toString(),10)].y,y=b;this.renderSingleBorder("#000000",m,f,v,y,.5,"Single")}},i.prototype.renderFloatingItems=function(e,t,i){if(!(0,a.isNullOrUndefined)(t)&&t.length>0){var n=new l;t.sort((function(e,t){return e instanceof Al||t instanceof Al?0:e.zOrderPosition-t.zOrderPosition}));for(var r=0;r<t.length;r++)if(!(t[r]instanceof Al)){var o=t[r];if(!("Behind"===i&&"Behind"!==o.textWrappingStyle||"Behind"!==i&&"Behind"===o.textWrappingStyle))if(!this.isOverLappedShapeWidget(o)||n.containsKey(o.zOrderPosition)){if(o instanceof gd)this.renderImageElementBox(o,o.x,o.y,0);else if(o instanceof hd){var s=this.getScaledValue(o.x,1),d=this.getScaledValue(o.y,2);this.renderShapeElementBox(o,s,d,e)}}else n.containsKey(o.zOrderPosition)||n.add(o.zOrderPosition,o)}if(n.length>0)for(var h=n.keys.sort(),c=0;c<h.length;c++){if((o=n.get(h[c]))instanceof gd)this.renderImageElementBox(o,o.x,o.y,0);else if(o instanceof hd){s=this.getScaledValue(o.x,1),d=this.getScaledValue(o.y,2);this.renderShapeElementBox(o,s,d,e)}}}},i.prototype.isOverLappedShapeWidget=function(e){return e instanceof gd&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)||e instanceof hd&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)},i.prototype.renderShapeElementBox=function(e,t,i,n){if(!e.isHorizontalRule){var r=0===e.height,o=e.autoShapeType,s=e.textFrame.childWidgets;this.pageContext.beginPath(),e.fillFormat&&e.fillFormat.color&&e.fillFormat.fill&&"StraightConnector"!==o?(this.pageContext.fillStyle=e.fillFormat.color,"Rectangle"===o?this.pageContext.fillRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height)):this.renderPathElement(e,t,i)):e.fillFormat&&e.fillFormat.color&&"Oval"===o&&(this.pageContext.fillStyle=e.fillFormat.color,this.renderPathElement(e,t,i)),(0,a.isNullOrUndefined)(o)||e.lineFormat.line&&"None"!==e.lineFormat.lineFormatType&&(this.pageContext.lineWidth=e.lineFormat.weight,this.pageContext.strokeStyle=Pa.getColor(e.lineFormat.color),"Rectangle"===o?this.pageContext.strokeRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height)):"StraightConnector"===o&&(this.pageContext.moveTo(t,i),this.pageContext.lineTo(t+this.getScaledValue(e.width),i+this.getScaledValue(e.height)),this.pageContext.stroke())),this.pageContext.closePath();var l=!1;0!=e.width&&0!=e.height&&(l=!0,this.clipRect(e.x,e.y,this.getScaledValue(e.width),this.getScaledValue(e.height)));for(var d=0;d<s.length;d++)this.renderWidget(n,s[d]),r&&"StraightConnector"!==o&&(e.height=Pa.round(e.height+s[d].height,5));r&&(r=!1),l&&this.pageContext.restore()}},i.prototype.renderPathElement=function(e,t,i){var n;if(e.autoShapeType&&"Unknown"!=e.autoShapeType)switch(e.autoShapeType){case"ElbowConnector":n=this.getConnectorPathData(e);break;case"CurvedConnector":n=this.getCurvedPathData(e);break;default:n=this.getShape(e.autoShapeType)}else e.autoShapeType&&(n=this.constructPath(e));if(n){var r=this.calculatePathBounds(n),o=this.updatePath(n,r,e);this.drawPath(o,e,t,i)}},i.prototype.renderWidget=function(e,t){this.documentHelper.owner.enableLockAndEdit&&this.renderLockRegionBorder(e,t),t instanceof Rl?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},i.prototype.getConnectorPathData=function(e){var t=e.distanceTop,i=e.distanceLeft,n=e.distanceTop+this.getScaledValue(e.width),r=e.distanceLeft+this.getScaledValue(e.height),o=t+(n-t)/2,s="M "+t+","+i+" ";return s+="L "+o+","+i+" ",s+="L "+o+","+r+" ",s+="L "+n+","+r},i.prototype.getCurvedPathData=function(e){var t=e.distanceTop,i=e.distanceLeft,n=e.distanceTop+this.getScaledValue(e.width),r=e.distanceLeft+this.getScaledValue(e.height);return"M "+t+","+i+" C "+(t+this.getScaledValue(e.width)/1.5)+","+i+" "+(n-this.getScaledValue(e.width)/1.5)+","+r+" "+n+","+r},i.prototype.constructPath=function(e){var t=e.editingPoints,i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=this.calculateCoord(t[n],400,400));return"\n      M "+i.connsiteX0+","+i.connsiteY0+"\n      L "+i.connsiteX1+","+i.connsiteY1+"\n      L "+i.connsiteX2+","+i.connsiteY2+"\n      L "+i.connsiteX3+","+i.connsiteY3+"\n      L "+i.connsiteX4+","+i.connsiteY4+"\n      Z\n    "},i.prototype.calculateCoord=function(e,t,i){var n=e.split(" "),r=n[0],o=parseFloat(n[1]),s="w"===n[2]?t:i,a=parseFloat(n[3]);return"*/"===r?o/a*s:0},i.prototype.drawPath=function(e,t,i,n){var r=[];r=function(e){var t,i,n,r,o,s,a,l,d,h,c=[];for(a=0,l=0,h=0,d=e.length;h<d;++h){var p,u=e[h];p=u.command,"y1"in u&&(r=u.y1),"y2"in u&&(s=u.y2),"x1"in u&&(n=u.x1),"x2"in u&&(o=u.x2),"x"in u&&(a=u.x),"y"in u&&(l=u.y);var g=c[c.length-1];switch(p){case"M":c.push({command:"M",x:a,y:l});break;case"L":c.push({command:"L",x0:t,y0:i,x:a,y:l});break;case"H":c.push({command:"L",x0:t,y0:i,x:a,y:i});break;case"V":c.push({command:"L",x0:t,y0:i,x:t,y:l});break;case"C":c.push({command:"C",x0:t,y0:i,x1:n,y1:r,x2:o,y2:s,x:a,y:l});break;case"S":if(g){var m=void 0,f={x:2*t-(m="C"===g.command||"S"===g.command?{x:g.x2,y:g.y2}:{x:t,y:i}).x,y:2*i-m.y};c.push({command:"C",x0:t,y0:i,x1:f.x,y1:f.y,x2:o,y2:s,x:a,y:l})}break;case"Q":c.push({command:"Q",x0:t,y0:i,x1:n,y1:r,x:a,y:l});break;case"T":g&&(m=void 0,f={x:2*t-(m="Q"===g.command?{x:g.x1,y:g.y1}:{x:t,y:i}).x,y:2*i-m.y},c.push({command:"Q",x0:t,y0:i,x1:f.x,y1:f.y,x:a,y:l}));break;case"A":var v=u;v.command="A",c.push(v);break;case"Z":case"z":c.push({command:"Z"}),a=t,l=i}t=a,i=l}return c}(r=Ka(e)),this.setStyle(t);var o=this.pageContext;o.translate&&(o.save(),o.beginPath(),o.translate(i,n),this.renderPath(o,r),o.fill(),o.translate(-i,-n),o.stroke(),o.restore())},i.prototype.renderPath=function(e,t){var i,n,r,o,s,a,l,d,h,c,p=e,u=t;for(l=0,d=0,c=0,h=u.length;c<h;++c){var g=u[parseInt(c.toString(),10)],m=g.command;switch("x1"in g&&(r=g.x1),"x2"in g&&(s=g.x2),"y1"in g&&(o=g.y1),"y2"in g&&(a=g.y2),"x"in g&&(l=g.x),"y"in g&&(d=g.y),m){case"M":p.moveTo(l,d),g.x=l,g.y=d;break;case"L":p.lineTo(l,d),g.x=l,g.y=d;break;case"C":p.bezierCurveTo(r,o,s,a,l,d),g.x=l,g.y=d,g.x1=r,g.y1=o,g.x2=s,g.y2=a;break;case"Q":p.quadraticCurveTo(r,o,l,d),g.x=l,g.y=d,g.x1=r,g.y1=o;break;case"A":var f={x:i,y:n},v=g.r1,y=g.r2,w=g.angle*(Math.PI/180),b=g.largeArc,C=g.sweep,x={x:l,y:d},I={x:Math.cos(w)*(f.x-x.x)/2+Math.sin(w)*(f.y-x.y)/2,y:-Math.sin(w)*(f.x-x.x)/2+Math.cos(w)*(f.y-x.y)/2},k=Math.pow(I.x,2)/Math.pow(v,2)+Math.pow(I.y,2)/Math.pow(y,2);k>1&&(v*=Math.sqrt(k),y*=Math.sqrt(k));var F=Math.pow(y,2)*Math.pow(I.x,2),P=(b===C?-1:1)*Math.sqrt((Math.pow(v,2)*Math.pow(y,2)-Math.pow(v,2)*Math.pow(I.y,2)-F)/(Math.pow(v,2)*Math.pow(I.y,2)+Math.pow(y,2)*Math.pow(I.x,2)));isNaN(P)&&(P=0);var S={x:P*v*I.y/y,y:P*-y*I.x/v},T={x:(f.x+x.x)/2+Math.cos(w)*S.x-Math.sin(w)*S.y,y:(f.y+x.y)/2+Math.sin(w)*S.x+Math.cos(w)*S.y},H=this.a([1,0],[(I.x-S.x)/v,(I.y-S.y)/y]),E=[(I.x-S.x)/v,(I.y-S.y)/y],N=[(-I.x-S.x)/v,(-I.y-S.y)/y],W=this.a(E,N);this.r(E,N)<=-1&&(W=Math.PI),this.r(E,N)>=1&&(W=0);var O=H+(C?1:-1)*(W/2);Math.cos(O),Math.sin(O);if(g.centp=T,g.xAxisRotation=w,g.rx=v,g.ry=y,g.a1=H,g.ad=W,g.sweep=C,null!=p){var B=v>y?v:y,L=v>y?1:v/y,D=v>y?y/v:1;p.save(),p.translate(T.x,T.y),p.rotate(w),p.scale(L,D),p.arc(0,0,B,H,H+W,!C),p.scale(1/L,1/D),p.rotate(-w),p.translate(-T.x,-T.y),p.restore()}break;case"Z":case"z":p.closePath(),l=i,d=n}i=l,n=d}},i.prototype.m=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},i.prototype.r=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(this.m(e)*this.m(t))},i.prototype.a=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(this.r(e,t))},i.prototype.updatePath=function(e,t,i){var n=!1,r="",o=-t.x,s=-t.y,a=[];return this.getScaledValue(i.width)===t.width&&this.getScaledValue(i.height)===t.height||(o=this.getScaledValue(i.width)/Number(t.width?t.width:1),s=this.getScaledValue(i.height)/Number(t.height?t.height:1),n=!0),a=function(e){var t,i,n,r,o,s,a,l,d,h;for(a=0,l=0,h=0,d=e.length;h<d;++h){var c=e[parseInt(h.toString(),10)],p=c.command;if(/[MLHVCSQTA]/.test(p))"x"in c&&(c.x=a=c.x),"y"in c&&(c.y=l=c.y);else{"x1"in c&&(c.x1=n=a+c.x1),"x2"in c&&(c.x2=o=a+c.x2),"y1"in c&&(c.y1=r=l+c.y1),"y2"in c&&(c.y2=s=l+c.y2),"x"in c&&(c.x=a+=c.x),"y"in c&&(c.y=l+=c.y);var u=void 0;switch(p){case"m":case"M":u={command:"M",x:a,y:l};break;case"l":case"L":u={command:"L",x:a,y:l};break;case"h":case"H":u={command:"H",x:a};break;case"v":case"V":u={command:"V",y:l};break;case"c":case"C":u={command:"C",x:a,y:l,x1:n,y1:r,x2:o,y2:s};break;case"s":case"S":u={command:"S",x:a,y:l,x2:o,y2:s};break;case"q":case"Q":u={command:"Q",x:a,y:l,x1:n,y1:r};break;case"t":case"T":u={command:"T",x:a,y:l};break;case"a":case"A":(u={command:"A",x:a,y:l}).r1=c.r1,u.r2=c.r2,u.angle=c.angle,u.largeArc=c.largeArc,u.sweep=c.sweep;break;case"z":case"Z":u={command:"Z"},a=t,l=i,u=e[parseInt(h.toString(),10)]}u&&(e[parseInt(h.toString(),10)]=u)}"M"!==p&&"m"!==p||(t=a,i=l)}return e}(a=Ka(e)),r=n?function(e,t,i,n,r,o,s,a){var l,d,h,c,p,u,g,m,f;for(p=0,u=0,m=0,g=e.length;m<g;++m){var v=e[m],y=v.command;"x"in v&&(p=v.x),"y"in v&&(u=v.y),"y1"in v&&(d=v.y1),"y2"in v&&(c=v.y2),"x1"in v&&(l=v.x1),"x2"in v&&(h=v.x2),n?(void 0!==p&&(p=Ya(p,t,r,s)),void 0!==u&&(u=Ya(u,i,o,a)),void 0!==l&&(l=Ya(l,t,r,s)),void 0!==d&&(d=Ya(d,i,o,a)),void 0!==h&&(h=Ya(h,t,r,s)),void 0!==c&&(c=Ya(c,i,o,a))):(void 0!==p&&(p=Number((p+t).toFixed(2))),void 0!==u&&(u=Number((u+i).toFixed(2))),void 0!==l&&(l=Number((l+t).toFixed(2))),void 0!==d&&(d=Number((d+i).toFixed(2))),void 0!==h&&(h=Number((h+t).toFixed(2))),void 0!==c&&(c=Number((c+i).toFixed(2)))),(f=Ja(v,y,{x:p,y:u,x1:l,y1:d,x2:h,y2:c,r1:v.r1,r2:v.r2},n,t,i))&&(e[m]=f)}return Xa(e)}(a,o,s,n,t.x,t.y,0,0):Xa(a),n=!1,r},i.prototype.calculatePathBounds=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(t);var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d",e),t.appendChild(i);var n=i.getBBox();return t.remove(),new Tl(n.x,n.y,n.width,n.height)},i.prototype.setStyle=function(e){var t=this.pageContext;"none"===e.lineFormat.color&&(e.lineFormat.color="transparent"),t.strokeStyle=Pa.getColor(e.lineFormat.color),t.lineWidth=e.lineFormat.weight,0===e.lineFormat.weight&&(t.strokeStyle="transparent")},i.prototype.renderLockRegionBorder=function(e,t){if(!t.isInsideTable&&t instanceof Ll&&t.locked){var i=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings,n=e.bodyWidgets[0].sectionFormat,r=Pa.convertPointToPixel(n.leftMargin)-5,o=n.pageWidth-n.leftMargin-n.rightMargin;o=Pa.convertPointToPixel(o)+10,this.viewer instanceof Fl&&(r=t.x-5,o=(this.documentHelper.visibleBounds.width-5*this.viewer.padding.right)/this.documentHelper.zoomFactor);var s=t.previousRenderedWidget,l=t.nextRenderedWidget,d=t.lockedBy===this.documentHelper.owner.currentUser?i.editableRegionColor:i.lockedRegionColor,h=t.y,c=t.y+t.height;this.renderSingleBorder(d,r,h,r,c,1,"Single"),!(0,a.isNullOrUndefined)(s)&&s.locked&&t.lockedBy===s.lockedBy||this.renderSingleBorder(d,r,h,r+o,h,1,"Single"),this.renderSingleBorder(d,r+o,h,r+o,c,1,"Single"),!(0,a.isNullOrUndefined)(l)&&l.locked&&t.lockedBy===l.lockedBy||this.renderSingleBorder(d,r,c,r+o,c,1,"Single")}},i.prototype.renderHeader=function(e,t,i){if(!(0,a.isNullOrUndefined)(i)){e.viewer.updateClientArea(e.bodyWidgets[0],e);var n=e.viewer.clientArea.y,r=i.ownerTable.getSplitWidgets()[0];if(0!==r.childWidgets.length&&-1===t.childWidgets.indexOf(i)){var o=r.clone();o.childWidgets=[],e.viewer.updateClientAreaLocation(o,new Tl(e.viewer.clientArea.x,n,o.width,o.height)),this.updateTableHeaderRows(i,o,e,n),this.isRenderHeader=!0;for(var s=0;s<o.childWidgets.length;s++){for(var l=o.childWidgets[s],d=void 0,h=0;h<l.childWidgets.length;h++)d=l.childWidgets[h],this.renderTableCellWidget(e,d);n+=l.height}this.isRenderHeader=!1,t.y!==n&&e.documentHelper.layout.updateChildLocationForTable(n,t)}}},i.prototype.updateTableHeaderRows=function(e,t,i,n){for(var r=e.ownerTable,o=1,s=0;s<r.childWidgets.length;s++){var l=r.childWidgets[s];if(l.rowFormat.isHeader){var d=l.clone();if(t.childWidgets.push(d),d.containerWidget=t,i.viewer.updateClientAreaLocation(d,new Tl(i.viewer.clientArea.x,n,d.width,d.height)),i.documentHelper.layout.updateChildLocationForRow(n,d),n+=d.height,l==e){for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h];o=Math.max(o,c.cellFormat.rowSpan)}if(o>1&&s+o<r.childWidgets.length)for(var p=1;p<o;p++){var u=r.childWidgets[s+p];if(!(0,a.isNullOrUndefined)(u)){var g=u.clone();t.childWidgets.push(g),g.containerWidget=t,i.viewer.updateClientAreaLocation(g,new Tl(i.viewer.clientArea.x,n,g.width,g.height)),i.documentHelper.layout.updateChildLocationForRow(n,g),n+=g.height}}}}}},i.prototype.renderParagraphWidget=function(e,t){if(!this.isFieldCode||!t.isFieldCodeBlock){var i=t.y,n=t.x,r=!1,o=t.firstChild,s=0;if(!(0,a.isNullOrUndefined)(o))for(var l=0;l<o.children.length;l++){var d=o.children[l];if(d instanceof Zl){s=d.padding.left;break}}s>0&&(this.clipRect(t.x+s,this.getScaledValue(e.boundingRectangle.y),this.getScaledValue(e.boundingRectangle.width),this.getScaledValue(e.boundingRectangle.height)),r=!0),t.containerWidget instanceof Bl&&t.containerWidget.isEmpty&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.selectionModule)&&!(0,a.isNullOrUndefined)(this.documentHelper.selection.start.paragraph)&&!this.documentHelper.selection.start.paragraph.isInHeaderFooter||this.renderParagraphBorder(e,t),r&&this.pageContext.restore();for(l=0;l<t.childWidgets.length;l++){var h=t.childWidgets[l];i+=h.marginTop,this.renderLine(h,e,n,i),i+=h.height}}},i.prototype.renderParagraphBorder=function(e,t){var i=t.paragraphFormat.borders.left,n=t.paragraphFormat.borders.top,r=t.paragraphFormat.borders.right,o=t.paragraphFormat.borders.bottom,s=0,l=0,d=0,h=0,c=0,p=t.firstChild,u=t.lastChild,g=this.documentHelper.canRenderBorder(t);(0,a.isNullOrUndefined)(i)||"None"===i.lineStyle||(d=s=this.documentHelper.getParagraphLeftPosition(t)-Pa.convertPointToPixel(i.space),h=l+t.height,h="None"!==n.lineStyle&&p.isFirstLine()&&!g.skipTopBorder?(l=t.y+this.getTopMargin(t)-Pa.convertPointToPixel(n.lineWidth+n.space))+t.height-(this.getTopMargin(t)-Pa.convertPointToPixel(n.lineWidth+n.space)):(l=t.y)+t.height,"None"!==o.lineStyle&&u.isLastLine()&&!g.skipBottomBorder&&(h=h+Pa.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),c=Pa.convertPointToPixel(i.lineWidth),this.renderSingleBorder(i.color,s,l,d,h,c,i.lineStyle)),(0,a.isNullOrUndefined)(n)||"None"===n.lineStyle||!p.isFirstLine()||g.skipTopBorder||(d=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),h=l=t.y+this.getTopMargin(t)-Pa.convertPointToPixel(n.lineWidth+n.space),"None"!==i.lineStyle&&(s-=Pa.convertPointToPixel(i.space)),"None"!==r.lineStyle&&(d+=Pa.convertPointToPixel(r.space)),c=Pa.convertPointToPixel(n.lineWidth),this.renderSingleBorder(n.color,s,l,d,h,c,n.lineStyle)),(0,a.isNullOrUndefined)(r)||"None"===r.lineStyle||(d=s=this.documentHelper.getParagraphLeftPosition(t)+this.getContainerWidth(t,e)+Pa.convertPointToPixel(r.space),h=(l=h)+t.height,h="None"!==n.lineStyle&&p.isFirstLine()&&!g.skipTopBorder?(l=t.y+this.getTopMargin(t)-Pa.convertPointToPixel(n.lineWidth+n.space))+t.height-(this.getTopMargin(t)-Pa.convertPointToPixel(n.lineWidth+n.space)):(l=t.y)+t.height,"None"!==o.lineStyle&&u.isLastLine()&&!g.skipBottomBorder&&(h=h+Pa.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),c=Pa.convertPointToPixel(r.lineWidth),this.renderSingleBorder(r.color,s,l,d,h,c,r.lineStyle)),(0,a.isNullOrUndefined)(o)||"None"===o.lineStyle||!u.isLastLine()||g.skipBottomBorder||(d=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),h=l=t.y+t.height+Pa.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t),"None"!==i.lineStyle&&(s-=Pa.convertPointToPixel(i.space)),"None"!==r.lineStyle&&(d+=Pa.convertPointToPixel(r.space)),c=Pa.convertPointToPixel(o.lineWidth),this.renderSingleBorder(o.color,s,l,d,h,c,o.lineStyle))},i.prototype.renderImgBorder=function(e,t,i,n,r,o,s,a){var l=e.width/this.documentHelper.zoomFactor,d=Pa.convertPointToPixel(o),h=this.documentHelper.selection.getNextTextElement(e),c=this.documentHelper.selection.getPreviousTextElement(e),p="Subscript"===s?e.margin.top+(e.height-e.height/1.5):e.margin.top;i+=p>0?p:0;var u=e.height/("Normal"===s?1:1.5)+15,g=0,m=0,f=0,v=0;g=t,m=i,f=t+l,v=i,this.renderSingleBorder(n,g,m,f,v,d,r),v=m=i+u,this.renderSingleBorder(n,g,m,f,v,d,r),m=i,f=t,c instanceof Zl&&(r=c.line!==e.line||null==c.contentControlProperties?"Solid":"None"),this.renderSingleBorder(n,g,m,f,v,d,r),f=g=t+l,r=h instanceof Zl?h.line!==e.line||null==h.contentControlProperties?"Solid":"None":"Solid",this.renderSingleBorder(n,g,m,f,v,d,r)},i.prototype.getContainerWidth=function(e,t){var i=0;if(e.paragraphFormat.firstLineIndent<0&&(i=Math.abs(e.paragraphFormat.firstLineIndent)),e.isInsideTable){var n=e.associatedCell;return n.width+n.margin.left+n.margin.right-n.leftBorderWidth}if(this.viewer instanceof Fl){var r=Pa.convertPointToPixel(e.leftIndent+e.rightIndent);return(this.documentHelper.visibleBounds.width-r-4*this.viewer.padding.right-2*this.viewer.padding.left)/this.documentHelper.zoomFactor}var o=e.bodyWidget;if(o instanceof Ol&&o.sectionFormat.columns.length>1){var s=o.columnIndex;return o.sectionFormat.columns[s].width+Pa.convertPointToPixel(i-(e.rightIndent+e.leftIndent))}var a=o.sectionFormat.pageWidth-o.sectionFormat.leftMargin-o.sectionFormat.rightMargin;return Pa.convertPointToPixel(a+i-(e.rightIndent+e.leftIndent))},i.prototype.getTopMargin=function(e){if(e.isEmpty())return e.childWidgets[0].margin.top;var t=e.childWidgets[0],i=0;return(0,a.isNullOrUndefined)(t.margin)||(i=t.margin.top),i},i.prototype.getBottomMargin=function(e){if(e.isEmpty())return e.childWidgets[e.childWidgets.length-1].margin.bottom;var t=e.childWidgets[e.childWidgets.length-1],i=0;return(0,a.isNullOrUndefined)(t.margin)||(i=t.margin.bottom),i},i.prototype.renderfootNoteWidget=function(e,t,i){1===t.page.bodyWidgets.length&&(1===t.page.bodyWidgets[0].childWidgets.length&&null!=t.page.bodyWidgets[0].childWidgets[0].isEmpty&&t.page.bodyWidgets[0].childWidgets[0].isEmpty()||t.page.bodyWidgets[0].childWidgets.length);var n=this.getFooterHeight(e),r=t.y+t.height;r>n&&(r=n-t.y),this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.getScaledValue(t.y,2),this.getScaledValue(i),this.getScaledValue(r)),this.pageContext.clip();for(var o=0;o<t.bodyWidgets.length;o++)for(var s=t.bodyWidgets[o],l=s.footNoteReference,d=0;d<s.childWidgets.length;d++){var h=s.childWidgets[d];if(0===o&&0===d){var c=this.pageContext,p=e.bodyWidgets[0].x;if(e.bodyWidgets.length>1&&!(0,a.isNullOrUndefined)(s.nextWidget)&&"NoBreak"!==s.nextWidget.sectionFormat.breakCode){var u=e.bodyWidgets[0].width;this.renderSolidLine(c,this.getScaledValue(p,1),this.getScaledValue(t.y+t.margin.top/2+1,2),u*this.documentHelper.zoomFactor,"#000000")}else this.renderSolidLine(c,this.getScaledValue(p,1),this.getScaledValue(t.y+t.margin.top/2+1,2),210*this.documentHelper.zoomFactor,"#000000")}if(!(0,a.isNullOrUndefined)(l)&&!this.documentHelper.owner.editorModule.isFootNoteInsert){var g=this.documentHelper.getFirstParagraphBlock(h);if(g.firstChild.children[0]instanceof Zl){var m=g.firstChild.children[0];""===m.text&&(m.text=m.text.replace(m.text,l.text),m.width=l.width)}}this.renderWidget(e,h)}this.pageContext.restore()},i.prototype.renderTableWidget=function(e,t){if(!this.isFieldCode)for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(this.renderTableRowWidget(e,n),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t),n.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks){var r=n.lastChild,o=r.ownerTable.isBidiTable?Vl.getCellLeftBorder(r):Vl.getCellRightBorder(r),s=Pa.convertPointToPixel(o.getLineWidth()),a=this.documentHelper.selection.getLastParagraph(n.lastChild),l=a.lastChild.height-a.lastChild.margin.bottom;this.renderBookmark(this.getScaledValue(r.x+r.width+r.margin.right-s/2+this.documentHelper.textHelper.getParagraphMarkWidth(a.characterFormat),1),this.getScaledValue(r.y-r.margin.top,2),this.getScaledValue(l),1)}}},i.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(this.renderTableCellWidget(e,n),n.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks){var r=this.documentHelper.selection.getLastParagraph(n),o=r.lastChild,s=this.documentHelper.selection.getEndPosition(r);this.renderBookmark(this.getScaledValue(s.x,1),this.getScaledValue(s.y,2),this.getScaledValue(o.height-o.margin.bottom),1)}}},i.prototype.renderTableCellWidget=function(e,t){if(!this.isPrinting&&!this.isExporting){var i,n;if(i=t.margin.top-t.containerWidget.topBorderWidth,n=t.margin.bottom-t.containerWidget.bottomBorderWidth,this.getScaledValue(t.y,2)+t.height+n*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)-i>this.documentHelper.visibleBounds.height)return}this.renderSelectionHighlightOnTable(e,t),this.renderTableCellOutline(e.documentHelper,t);for(var r=0;r<t.childWidgets.length;r++){var o=t.childWidgets[r],s=t.width+t.margin.left+t.margin.right-t.leftBorderWidth;this.isPrinting||o instanceof Al&&s===o.width&&"Word2007"===this.documentHelper.compatibilityMode||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(s),this.getScaledValue(this.height)),this.renderWidget(e,o),this.pageContext.restore()}if(t.isRenderEditRangeStart){var l=this.documentHelper.selection.getFirstParagraph(t).firstChild,d=l.paragraph.x;l.children.length>0&&!(0,a.isNullOrUndefined)(l.children[0].margin)&&l.children[0].margin.left>0&&(d+=l.children[0].margin.left);var h=l.paragraph.y;if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){var c=this.documentHelper.selection.editRegionHighlighters,p=(0,a.isNullOrUndefined)(c)?[]:c.get(l),u=(0,a.isNullOrUndefined)(p)||(0,a.isNullOrUndefined)(p[0])?"ffff00":p[0].color;this.renderBookmark(this.getScaledValue(d,1),this.getScaledValue(h,2),this.getScaledValue(l.height-l.margin.bottom),0,u)}}},i.prototype.checkHeaderFooterLineWidget=function(e,t){var i;if(e instanceof zl?i=e.paragraph.bodyWidget:e instanceof Vl&&(i=e.bodyWidget),!(0,a.isNullOrUndefined)(i.parentHeaderFooter)){i=i.parentHeaderFooter;for(var n=0;n<t.length;n++){var r=t[n];if(r instanceof zl&&e instanceof zl){var o=r.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(r.paragraph.isInHeaderFooter&&i===r.paragraph.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return r}else if(r instanceof Vl&&e instanceof Vl){o=r.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(r.ownerTable.isInHeaderFooter&&i===r.ownerTable.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return r}}}},i.prototype.renderEditregionContentHighlight=function(e,t,i){if(!(0,a.isNullOrUndefined)(this.documentHelper.owner.editorModule)&&e.documentHelper.selection&&!(0,a.isNullOrUndefined)(e.documentHelper.selection.contentControleditRegionHighlighters)){var n=e.documentHelper.selection.contentControls;if(!(0,a.isNullOrUndefined)(n))for(var r=0;r<n.length;r++){var o=n[r],s=this.documentHelper.selection.contentControleditRegionHighlighters.get(o);if(!(0,a.isNullOrUndefined)(s)){var l=s.keys.indexOf(t);if(-1!==l){var d=o.contentControlProperties.color;"#00000000"===d&&(d="#939393");for(var h=s.get(t),c=0;c<h.length;c++){var p=t.paragraph,u=0,g=Pa.convertPointToPixel(p.paragraphFormat.firstLineIndent),m=Pa.convertPointToPixel(p.leftIndent);u=-1!==p.paragraphFormat.listFormat.listId?h[c].left-m-2:h[c].left-m-g-2;var f=h[c].left+h[c].width+2;s.length-1>l&&(f=this.documentHelper.getParagraphLeftPosition(p)+this.getContainerWidth(p,e)+Pa.convertPointToPixel(p.paragraphFormat.borders.right.space));var v=i,y=i+t.height;if(this.renderSingleBorder(d,u,v,u,y,1,"single"),0===l||t===o.line)this.renderSingleBorder(d,u,v,f,v,1,"single"),(1===s.length||(0,a.isNullOrUndefined)(p.nextWidget)&&t===p.lastChild)&&this.renderSingleBorder(d,u,y,f,y,1,"single");else if(t!==o.line&&t!==o.reference.line){if((0,a.isNullOrUndefined)(p.previousWidget)&&t===p.firstChild)this.renderSingleBorder(d,u,v,f,v,1,"single");else if("Block"!==o.contentControlWidgetType){var w=s.get(s.keys[l-1]);this.renderSingleBorder(d,u,v,w[c].left-2,v,1,"single")}(0,a.isNullOrUndefined)(p.nextWidget)&&t===p.lastChild&&(f=this.documentHelper.getParagraphLeftPosition(p)+this.getContainerWidth(p,e)+Pa.convertPointToPixel(p.paragraphFormat.borders.right.space),this.renderSingleBorder(d,u,y,f,y,1,"single"))}else if(l===s.length-1&&t===o.reference.line){w=s.get(s.keys[l-1]);(0,a.isNullOrUndefined)(p.previousWidget)&&t===p.firstChild?(f=this.documentHelper.getParagraphLeftPosition(p)+this.getContainerWidth(p,e)+Pa.convertPointToPixel(p.paragraphFormat.borders.right.space),this.renderSingleBorder(d,u,v,f,v,1,"single")):u>w[c].left&&this.renderSingleBorder(d,w[c].left-2,v,u,v,1,"single");var b=p.lastChild;if((0,a.isNullOrUndefined)(b)||(0,a.isNullOrUndefined)(e.nextPage)&&(0,a.isNullOrUndefined)(p.nextWidget)||t!==b||!(b.children[b.children.length-1]instanceof id)||b.children[b.children.length-1]!==o.reference||"Block"!==o.contentControlWidgetType){if(this.renderSingleBorder(d,u,y,f,y,1,"single"),s.length>1){var C=s.get(s.keys[l-1]),x=this.documentHelper.getParagraphLeftPosition(p)+this.getContainerWidth(p,e)+Pa.convertPointToPixel(p.paragraphFormat.borders.right.space);this.renderSingleBorder(d,f,v,x,v,1,"single"),u<C[c].left-2&&"Block"!==o.contentControlWidgetType&&this.renderSingleBorder(d,C[c].left-2,v,u,v,1,"single")}}else f=this.documentHelper.getParagraphLeftPosition(p)+this.getContainerWidth(p,e)+Pa.convertPointToPixel(p.paragraphFormat.borders.right.space),this.renderSingleBorder(d,u,y,f,y,1,"single")}if(this.renderSingleBorder(d,f,v,f,y,1,"single"),t===o.reference.line&&!(0,a.isNullOrUndefined)(o)&&("ComboBox"===o.contentControlProperties.type||"DropDownList"===o.contentControlProperties.type||"Date"===o.contentControlProperties.type)){var I=document.getElementById("contenticon");if(I)I.style.display="block",u=this.getScaledValue(f,1),v=this.getScaledValue(v,2),I.style.left=u+"px",I.style.top=v+"px",I.style.border="0.5px solid #7F7F7F",I.style.backgroundColor="#D3D3D3",I.style.height=t.height+"px",I.addEventListener("click",this.documentHelper.owner.editor.contentControlDropDownChange.bind(this));else{var k=document.createElement("div");k.id="contenticon",k.style.display="block",k.style.position="sticky",u=this.getScaledValue(f,1),v=this.getScaledValue(v,2),k.style.left=u+"px",k.style.top=v+"px",k.style.border="0.5px solid #7F7F7F",k.style.backgroundColor="#D3D3D3",k.style.height=t.height+"px",k.classList.add("e-de-cmt-mark");var F=document.createElement("span");F.classList.add("e-icons"),F.classList.add("e-chevron-down-fill"),k.appendChild(F),this.documentHelper.pageContainer.appendChild(k),k.addEventListener("click",this.documentHelper.owner.editor.contentControlDropDownChange.bind(this))}}}}}}}},i.prototype.renderEditRegionHighlight=function(e,t,i){if(e.documentHelper.selection&&!(0,a.isNullOrUndefined)(e.documentHelper.selection.editRegionHighlighters)){var n=this.documentHelper.selection.editRegionHighlighters.containsKey(t);if(!n&&t.paragraph.isInHeaderFooter){var r=this.documentHelper.selection.editRegionHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,r),(0,a.isNullOrUndefined)(t)||(n=!0)}if(n)for(var o=this.documentHelper.selection.editRegionHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=""!==o[s].color?o[s].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.renderSearchHighlight=function(e,t,i){if(this.documentHelper.owner.searchModule&&!(0,a.isNullOrUndefined)(e.documentHelper.owner.searchModule.searchHighlighters)){var n=e.documentHelper.owner.searchModule.searchHighlighters.containsKey(t);if(this.validateRemoveSearchHighlighters(e),!n&&t.paragraph.isInHeaderFooter){var r=e.documentHelper.owner.searchModule.searchHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,r),(0,a.isNullOrUndefined)(t)||(n=!0)}if(n)for(var o=e.documentHelper.owner.searchModule.searchHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.validateRemoveSearchHighlighters=function(e){for(var t=e.documentHelper.owner.searchModule.searchHighlighters.keys,i=0;i<t.length;i++){var n=t[i];n instanceof zl&&!(0,a.isNullOrUndefined)(n.paragraph)&&!(0,a.isNullOrUndefined)(n.paragraph.containerWidget)||e.documentHelper.owner.searchModule.searchHighlighters.keys.splice(i,1)}},i.prototype.renderSelectionHighlight=function(e,t,i){if(!this.isPrinting&&e.documentHelper.owner.selectionModule&&!this.documentHelper.isScrollToSpellCheck&&e.documentHelper.owner.selectionModule.selectedWidgets.length>0){var n=e.documentHelper.owner.selectionModule.selectedWidgets.containsKey(t);if(!n&&t.paragraph.isInHeaderFooter){var r=e.documentHelper.owner.selectionModule.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,r),(0,a.isNullOrUndefined)(t)||(n=!0)}n&&e.documentHelper.owner.selectionModule.addSelectionHighlight(this.selectionContext,t,i,e)}},i.prototype.renderSelectionHighlightOnTable=function(e,t){if(!this.isPrinting&&e.documentHelper.owner.selectionModule&&e.documentHelper.owner.selectionModule.selectedWidgets.length>0){var i=e.documentHelper.owner.selectionModule.selectedWidgets.containsKey(t);if(!i&&t.ownerTable.isInHeaderFooter){var n=e.documentHelper.owner.selectionModule.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,n),(0,a.isNullOrUndefined)(t)||(i=!0)}i&&e.documentHelper.owner.selectionModule.addSelectionHighlightTable(this.selectionContext,t,e)}},i.prototype.renderLine=function(e,i,n,r){this.renderSelectionHighlight(i,e,r);var o=e.paragraph.paragraphFormat,s=n;if(e.isFirstLine()&&!o.bidi&&(n+=Pa.convertPointToPixel(o.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!(0,a.isNullOrUndefined)(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(e)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(var l=i.documentHelper.selection.formFieldHighlighters.get(e),d=0;d<l.length;d++){this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor;var h=e.height,c=!1;if(e.isLastLine()&&(h-=Pa.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)),e.paragraph.paragraphFormat.lineSpacing>1)){var p=this.getFormfieldInLine(e);if(!(0,a.isNullOrUndefined)(p)){var u=this.documentHelper.textHelper.getHeight(p.characterFormat),g=u.Height;"Multiple"===e.paragraph.paragraphFormat.lineSpacingType?h-=Pa.convertPointToPixel(this.documentHelper.layout.getLineSpacing(e.paragraph,g,!0)):(r+=Pa.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing),h=u.Height,c=!0)}}this.pageContext.fillRect(this.getScaledValue(l[d].left,1),this.getScaledValue(r,2),this.getScaledValue(l[d].width),this.getScaledValue(h)),c&&(c=!1,r-=Pa.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing))}this.renderSearchHighlight(i,e,r),this.renderEditRegionHighlight(i,e,r);var m=[],f=e.renderedElements,v=this.getUnderlineYPosition(e),y=[];!(0,a.isNullOrUndefined)(e.paragraph.associatedCell)&&e.paragraph.associatedCell.isRenderBookmarkStart&&(e.paragraph.associatedCell.firstChild.firstChild==e&&y.push({x:n,y:r,height:e.height-e.margin.bottom,type:0}));for(d=0;d<f.length;d++){var w=f[d];if(!(w instanceof dd&&"Inline"!==w.textWrappingStyle)){if(w instanceof Bd||w instanceof vd){var b=0;this.viewer instanceof kl&&(b=this.viewer.pageGap);var C="display:block;position:absolute;",x=this.getScaledValue(r+(i.boundingRectangle.y-b*(i.index+1)))+b*(i.index+1)+"px;";if(w instanceof vd&&(this.documentHelper.owner.currentUser===w.user||"Everyone"===w.group&&""===w.user)){if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges&&-1==w.columnFirst){var I=w.line.height-w.line.margin.bottom,k=n;!(0,a.isNullOrUndefined)(w.margin)&&w.margin.left>0&&(k+=w.margin.left);var F=r,P=this.documentHelper.selection.editRegionHighlighters,S=(l=(0,a.isNullOrUndefined)(P)?[]:P.get(e),(0,a.isNullOrUndefined)(l)||(0,a.isNullOrUndefined)(l[0])?"ffff00":l[0].color);this.renderBookmark(this.getScaledValue(k,1),this.getScaledValue(F,2),this.getScaledValue(e.height-e.margin.bottom),0,S)}if(this.documentHelper.owner.enableLockAndEdit){(j=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),w.renderLockMark(this.documentHelper.owner.currentUser,j);var T=this.documentHelper.owner.documentEditorSettings.collaborativeEditingSettings;C+="color:"+(S=w.user===this.documentHelper.owner.currentUser?T.editableRegionColor:T.lockedRegionColor)+";";var H=Pa.convertPointToPixel(i.bodyWidgets[0].sectionFormat.leftMargin),E=i.boundingRectangle.x+this.getScaledValue(H-20)+"px;";this.viewer instanceof Fl&&(E=e.paragraph.x-5+"px;"),C=C+"left:"+E+"top:"+x,w.editRangeMark.setAttribute("style",C)}else w.editRangeMark&&w.editRangeMark.setAttribute("style","display:none")}else if(w instanceof Bd&&0===w.commentType&&this.documentHelper.owner.selectionModule)if(this.documentHelper.owner.enableComment){var N=Pa.convertPointToPixel(i.bodyWidgets[0].sectionFormat.rightMargin),W=Pa.convertPointToPixel(i.bodyWidgets[0].sectionFormat.pageWidth);E=i.boundingRectangle.x+this.getScaledValue(W-N+N/4)+"px;";this.viewer instanceof Fl&&(E=i.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;"),C=C+"left:"+E+"top:"+x,-1!==m.indexOf(w.commentId)||(0,a.isNullOrUndefined)(w.comment)||w.comment.isReply||(m.push(w.commentId),w.renderCommentMark(x,E),w.commentMark.setAttribute("style",C))}else w.commentMark&&w.commentMark.setAttribute("style","display:none")}if(w instanceof fd&&(this.documentHelper.owner.currentUser===w.editRangeStart.user||"Everyone"===w.editRangeStart.group&&""===w.editRangeStart.user)&&-1==w.editRangeStart.columnFirst&&this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){I=w.line.height-w.line.margin.bottom,k=n,F=r,P=this.documentHelper.selection.editRegionHighlighters,l=(0,a.isNullOrUndefined)(P)?[]:P.get(e),S=(0,a.isNullOrUndefined)(l)||(0,a.isNullOrUndefined)(l[0])?"ffff00":l[0].color;this.renderBookmark(this.getScaledValue(k,1),this.getScaledValue(F,2),this.getScaledValue(e.height-e.margin.bottom),1,S)}if(w instanceof td&&this.documentHelper.owner.documentEditorSettings.showBookmarks&&-1!==this.documentHelper.getBookmarks().indexOf(w.name)){I=w.line.height-w.line.margin.bottom,k=n;!(0,a.isNullOrUndefined)(w.margin)&&w.margin.left>0&&(k+=w.margin.left);F=r;if(1==w.bookmarkType){if(this.isBookmarkEndAtStart(w)&&(0,a.isNullOrUndefined)(w.properties)){for(var O=w.paragraph,B=void 0,L=!1;!L&&!(0,a.isNullOrUndefined)(O);){for(var D=O.childWidgets.indexOf(w.line)>=0?O.childWidgets.indexOf(w.line):O.childWidgets.length-1;D>=0;D--){for(var R=O.childWidgets[D],M=R.children.indexOf(w)>=0?R.children.indexOf(w):R.children.length-1;M>=0;M--)if(this.isRenderable(R.children[M])){B=R.children[M],L=!0;break}if(L)break}L||(O=this.documentHelper.selection.getPreviousParagraphBlock(O))}(0,a.isNullOrUndefined)(B)||(O.containerWidget instanceof Vl?k+=O.x+this.documentHelper.selection.getWidth(B.line,!1)+this.documentHelper.textHelper.getParagraphMarkWidth(w.line.paragraph.characterFormat):k+=this.documentHelper.selection.getWidth(B.line,!1)+this.documentHelper.textHelper.getParagraphMarkWidth(w.line.paragraph.characterFormat),F=this.documentHelper.selection.getTop(B.line))}(0,a.isNullOrUndefined)(w.properties)||(w.properties.isAfterParagraphMark&&(k+=this.documentHelper.textHelper.getParagraphMarkWidth(w.line.paragraph.characterFormat)),w.properties.isAfterCellMark&&(k+=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),e.paragraph.characterFormat)))}if(1==w.bookmarkType){if(!(0,a.isNullOrUndefined)(w.reference))if((0,a.isNullOrUndefined)(w.reference.properties))this.documentHelper.selection.isRenderBookmarkAtEnd(w)||y.push({x:k,y:F,height:I,type:w.bookmarkType});else{var A=w.paragraph.associatedCell;(0,a.isNullOrUndefined)(A)&&y.push({x:k,y:F,height:I,type:w.bookmarkType})}}else(0,a.isNullOrUndefined)(w.properties)&&y.push({x:k,y:F,height:I,type:w.bookmarkType})}if(w instanceof _l||this.isFieldCode||0===w.width&&0===w.height)this.isFieldCode&&(w.width=0),n+=w.width+w.margin.left,this.toSkipFieldCode(w);else if(this.isPrinting||!(this.getScaledValue(r+w.margin.top,2)+w.height*this.documentHelper.zoomFactor<0||this.getScaledValue(r+w.margin.top,2)>this.documentHelper.visibleBounds.height)||(n+=w.width+w.margin.left,w instanceof Zl&&(this.documentHelper.owner.isSpellCheck&&(w.canTrigger=!0),w.isVisible=!1,(!w.isSpellChecked&&!w.isSpellCheckTriggered||w.line.paragraph.isChangeDetected)&&(w.ischangeDetected=!0)),this.isExporting)){if(w instanceof md)n+=w.padding.left,this.renderListTextElementBox(w,n,r,v);else if(w instanceof gd)n+=w.padding.left,this.renderImageElementBox(w,n,r,v);else if(w instanceof hd){var U=w.margin.left,V=w.margin.top,z=this.getScaledValue(n+U,1),q=this.getScaledValue(r+V,2);this.renderShapeElementBox(w,z,q,i)}else w.isVisible=!0,n+=w.padding.left,this.renderTextElementBox(w,n,r,v);n+=w.width+w.margin.left,e.paragraph.bidi?s+=w.margin.left:s=n}}}if(this.renderEditregionContentHighlight(i,e,r),this.documentHelper.owner.documentEditorSettings.showBookmarks&&y.length>0)for(d=0;d<y.length;d++){var _=y[d];this.renderBookmark(this.getScaledValue(_.x,1),this.getScaledValue(_.y,2),this.getScaledValue(_.height),_.type)}if(this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting){var j,G="",K=e.paragraph.characterFormat,X=0,Z=this.retriveCharacterformat(K);(j=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale)).setLocale(this.documentHelper.owner.locale),this.pageContext.fillStyle=Pa.getColor(K.fontColor);var J=0;if(!e.paragraph.bodyWidget||e.paragraph.bodyWidget instanceof Bl||(J=this.documentHelper.pages.indexOf(e.paragraph.bodyWidget.page)),0==f.length&&!e.isEndsWithLineBreak&&!(0,a.isNullOrUndefined)(e.paragraph)||1===e.paragraph.childWidgets.length?(X=e.paragraph.y+this.documentHelper.textHelper.getHeight(K).BaselineOffset+this.documentHelper.layout.getBeforeSpacing(e.paragraph,J),!e.isEndsWithLineBreak&&e.indexInOwner>0&&0==f.length&&(X=r+e.previousLine.maxBaseLine)):X=r+e.maxBaseLine,K.revisions.length>0){S=this.documentHelper.authors.get(K.revisions[0].author);this.pageContext.fillStyle=Pa.getColor(S)}if(e.isEndsWithColumnBreak)Z=this.retriveCharacterformat(K,.7),G="....."+j.getConstant("Column Break")+".....";else if(e.isEndsWithPageBreak){Z=this.retriveCharacterformat(K,.7),G=this.getPageBreakText(e.paragraph,j);var Y=this.documentHelper.textHelper.getWidth(G,K,t.English);this.viewer instanceof kl?e.paragraph.bidi?s<Y+this.viewer.clientActiveArea.x&&(G="....."):s>this.viewer.clientActiveArea.width&&(G="....."):e.paragraph.bidi?s-Y<this.viewer.clientActiveArea.x&&(G="....."):s+Y>this.viewer.clientActiveArea.width+this.viewer.clientActiveArea.x&&(G=".....")}else e.isEndsWithLineBreak?G=e.paragraph.bidi?String.fromCharCode(8627):String.fromCharCode(8629):e.paragraph.isInsideTable&&(0,a.isNullOrUndefined)(e.nextLine)&&(0,a.isNullOrUndefined)(e.paragraph.nextWidget)?0!=e.height&&(G=String.fromCharCode(164)):(0,a.isNullOrUndefined)(e.nextLine)&&(G=String.fromCharCode(182));if(e.paragraph.containerWidget instanceof Ol&&!(0,a.isNullOrUndefined)(e.paragraph.nextRenderedWidget)&&e.paragraph.containerWidget.sectionIndex!==e.paragraph.nextRenderedWidget.containerWidget.sectionIndex&&e.isLastLine()){G="NoBreak"===e.paragraph.nextRenderedWidget.containerWidget.sectionFormat.breakCode&&e.paragraph.containerWidget.index!==e.paragraph.nextRenderedWidget.containerWidget.index?":::::"+j.getConstant("Section Break Continuous")+":::::":":::::"+j.getConstant("Section Break Next Page")+":::::",Z=this.retriveCharacterformat(K,.7);var Q=e.paragraph.previousRenderedWidget;if(Q instanceof Rl&&Q.isEndsWithPageBreak&&e.paragraph.isSectionBreak){var $=this.getPageBreakText(Q,j);s+=.7*this.documentHelper.textHelper.getWidth($,Q.characterFormat,t.English),s-=this.documentHelper.textHelper.getParagraphMarkSize(Q.characterFormat).Width}else e.isEndsWithPageBreak&&(G=e.paragraph.bidi?G+String.fromCharCode(182)+"....."+j.getConstant("Page Break")+".....":"....."+j.getConstant("Page Break")+"....."+String.fromCharCode(182)+G);Y=this.documentHelper.textHelper.getWidth(G,K,t.English);this.viewer instanceof kl?e.paragraph.bidi?s<Y+this.viewer.clientActiveArea.x&&(G=":::::",e.isEndsWithPageBreak&&(G=":::::.....")):s+Y-this.viewer.clientActiveArea.x>this.viewer.clientActiveArea.width&&(G=":::::",e.isEndsWithPageBreak&&(G=".....:::::")):e.paragraph.bidi?s-Y<this.viewer.clientActiveArea.x&&(G=":::::",e.isEndsWithPageBreak&&(G=":::::.....")):s+Y-this.documentHelper.pages[0].boundingRectangle.x>this.viewer.clientActiveArea.width&&(G=":::::",e.isEndsWithPageBreak&&(G=".....:::::"))}if(G.length>0){e.paragraph.bidi&&!e.paragraph.isEmpty()&&(s-=this.documentHelper.textHelper.getWidth(G,K,t.English)),this.pageContext.font=Z;var ee=K.scaling<100?1:K.scaling/100;this.pageContext.letterSpacing=K.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(ee,1),this.pageContext.fillText(G,this.getScaledValue(s,1)/ee,this.getScaledValue(X,2)),this.pageContext.restore()}}},i.prototype.getPageBreakText=function(e,t){return e.bidi?String.fromCharCode(182)+"....."+t.getConstant("Page Break")+".....":"....."+t.getConstant("Page Break")+"....."+String.fromCharCode(182)},i.prototype.isBookmarkEndAtStart=function(e){for(var t=e.paragraph,i=0,n=t.childWidgets[i],r=!0;-1==n.children.indexOf(e)&&(n=t.childWidgets[++i],i!=t.childWidgets.length););if(e.line!=n)return!1;for(var o=n.children.indexOf(e)>=0?n.children.indexOf(e):-1;o>=0;o--){var s=n.children[o];this.isRenderable(s)&&(r=!1)}return!!r},i.prototype.isRenderable=function(e){return!(e instanceof td||e instanceof vd||e instanceof fd)},i.prototype.combineHexColors=function(e,t){var i=e.replace("#",""),n=t.replace("#",""),r=parseInt(i.substring(0,2),16),o=parseInt(i.substring(2,4),16),s=parseInt(i.substring(4,6),16),a=parseInt(n.substring(0,2),16),l=parseInt(n.substring(2,4),16),d=parseInt(n.substring(4,6),16),h=Math.round(.35*r+.65*a),c=Math.round(.35*o+.65*l),p=Math.round(.35*s+.65*d);return"#"+h.toString(16)+c.toString(16)+p.toString(16)},i.prototype.renderBookmark=function(e,t,i,n,r){if(!this.isPrinting){this.pageContext.beginPath(),this.pageContext.lineWidth=1.5;if(0==n&&(this.pageContext.moveTo(e+3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+i),this.pageContext.lineTo(e+3,t+i)),1==n&&(this.pageContext.moveTo(e-3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+i),this.pageContext.lineTo(e-3,t+i)),this.pageContext.strokeStyle="#7F7F7F",this.pageContext.stroke(),this.pageContext.closePath(),!(0,a.isNullOrUndefined)(r)){var o=this.combineHexColors(r,"#7F7F7F");this.pageContext.fillStyle=o,this.pageContext.fillRect(e,t,1.5,i)}}},i.prototype.retriveCharacterformat=function(e,t){(0,a.isNullOrUndefined)(t)&&(t=1);this.pageContext.textBaseline="alphabetic";return(e.bold?"bold":"")+" "+(e.italic?"italic":"")+" "+(0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5))*this.documentHelper.zoomFactor*t+'pt "'+e.fontFamily+'"'},i.prototype.toSkipFieldCode=function(e){e instanceof _l&&(0===e.fieldType?this.isFieldCode||(0,a.isNullOrUndefined)(e.fieldEnd)&&!e.hasFieldEnd||(this.fieldStacks.push(e),this.isFieldCode=!0):2!==e.fieldType&&1!==e.fieldType||this.fieldStacks.length>0&&e.fieldBegin===this.fieldStacks[this.fieldStacks.length-1]&&(this.fieldStacks.pop(),this.isFieldCode=!1))},i.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,n=0;n<e.children.length;n++){var r=e.children[n];r instanceof _l||0===r.width&&0===r.height||(r instanceof hd||r instanceof gd&&"Inline"!==r.textWrappingStyle||t<r.height+r.margin.top&&(t=r.margin.top+r.height,i=r instanceof gd?.9:r.height/20))}return t-2*i},i.prototype.renderListTextElementBox=function(e,t,i,n){var r=e.margin.top,o=e.margin.left,s=e.listLevel.characterFormat,l=e.line.paragraph.characterFormat,d=s.hasValue("fontColor")?s.fontColor:l.fontColor;this.pageContext.textBaseline="alphabetic";var h,c,p=s.hasValue("fontFamily")?s.fontFamily:l.fontFamily;!this.documentHelper.isIosDevice&&!this.documentHelper.isLinuxOS||e.text!==String.fromCharCode(9679)&&e.text!==String.fromCharCode(9675)||(p="");var u=s.hasValue("fontSize")?s.fontSize:l.fontSize,g=s.hasValue("baselineAlignment")?s.baselineAlignment:l.baselineAlignment;h=s.hasValue("bold")?s.bold?"bold":"":l.bold?"bold":"",c=s.hasValue("italic")?s.italic?"italic":"":l.italic?"italic":"",u=0===u?.5:u/("Normal"===g?1:1.5),u=this.isPrinting?u:u*this.documentHelper.zoomFactor;var m=s.hasValue("strikethrough")?s.strikethrough:l.strikethrough,f=s.hasValue("highlightColor")?s.highlightColor:l.highlightColor;"NoColor"!==f&&("#"!==f.substring(0,1)?this.pageContext.fillStyle=Pa.getHighlightColorCode(f):this.pageContext.fillStyle=Pa.getColor(f),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+o,1)),Math.floor(this.getScaledValue(i+r,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.pageContext.font=h+" "+c+" "+u+'pt "'+p+'"',"Subscript"===g&&(r+=e.height-e.height/1.5);var v=e.baselineOffset;r="Normal"===s.baselineAlignment?r+v:r+v/1.5;var y=e.text,w=e.paragraph.paragraphFormat.bidi;if(w&&(this.pageContext.direction="rtl",t+=e.width),"empty"===d||"#00000000"===d){var b=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(b)}else this.pageContext.fillStyle=Pa.getColor(d);var C=s.scaling<100?1:s.scaling/100;this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?(e instanceof md&&"\t"===e.text&&this.tabMark(e,s,t,i,o,r),this.pageContext.letterSpacing=s.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(C,1),this.pageContext.fillText(this.replaceSpace(y),this.getScaledValue(t+o,1)/C,this.getScaledValue(i+r,2),this.getScaledValue(e.width)),this.pageContext.restore()):(this.pageContext.letterSpacing=s.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(C,1),this.pageContext.fillText(y,this.getScaledValue(t+o,1)/C,this.getScaledValue(i+r,2),this.getScaledValue(e.width)),this.pageContext.restore()),w&&(this.pageContext.direction="ltr",t-=e.width),"None"===s.underline||(0,a.isNullOrUndefined)(s.underline)||this.renderUnderline(e,t,i,n,d,s.underline,g),"None"!==m&&this.renderStrikeThrough(e,t,i,s.strikethrough,d,g)},i.prototype.getDefaultFontColor=function(e){return Pa.isVeryDark(e)?"#FFFFFF":"#000000"},i.prototype.renderTextElementBox=function(t,i,n,r){var o=!1,s=t.line.paragraph.containerWidget;s instanceof Vl&&(o="Exactly"===s.ownerRow.rowFormat.heightType);var l=t.margin.top,d=t.margin.left;if(o&&s instanceof Vl){var h=s.width+s.margin.left+s.margin.right-s.leftBorderWidth;this.clipRect(s.x-s.margin.left,s.y,this.getScaledValue(h),this.getScaledValue(s.height))}var c=t.characterFormat,p=!0;if("NoColor"!=c.highlightColor&&""==t.text.trim()){var u=t.line.paragraph.firstChild,g=t.line.paragraph.lastChild;!(0,a.isNullOrUndefined)(u)&&u instanceof zl&&u.children.length>0&&t===u.children[0]&&(p=!1),!(0,a.isNullOrUndefined)(g)&&g instanceof zl&&g.children.length>0&&t===g.children[g.children.length-1]&&(p=!1)}"NoColor"!==c.highlightColor&&p&&("#"!==c.highlightColor.substring(0,1)?this.pageContext.fillStyle=Pa.getHighlightColorCode(c.highlightColor):this.pageContext.fillStyle=Pa.getColor(c.highlightColor),this.pageContext.fillRect(Math.floor(this.getScaledValue(i+d,1)),Math.floor(this.getScaledValue(n+l,2)-1),Math.ceil(this.getScaledValue(t.width)+1),Math.ceil(this.getScaledValue(t.height)+1)));var m=this.checkRevisionType(t),f=m.length>0?this.getRevisionColor(m):c.fontColor;this.pageContext.textBaseline="alphabetic";var v,y,w=c.bidi||this.documentHelper.textHelper.isRTLText(t.text),b=w||c.complexScript,C=11;v=b?c.boldBidi?"bold":"":c.bold?"bold":"",y=b?c.italicBidi?"italic":"":c.italic?"italic":"",C=0===c.fontSize?.5:(b?c.fontSizeBidi:c.fontSize)/("Normal"===c.baselineAlignment?1:1.5),C=this.isPrinting?C:C*this.documentHelper.zoomFactor;var x=this.documentHelper.textHelper.getFontNameToRender(t.scriptType,c);this.pageContext.font=v+" "+y+" "+C+'pt "'+x+'"',"Subscript"===c.baselineAlignment&&(l+=t.height-t.height/1.5);var I=t.baselineOffset;if(l="Normal"===c.baselineAlignment?l+I:l+I/1.5,"empty"===f||"#00000000"===f){var k=this.getBackgroundColorHeirachy(t);this.pageContext.fillStyle=this.getDefaultFontColor(k)}else this.pageContext.fillStyle=Pa.getColor(f);var F=this.getScaledValue(t.width),P=t.text;if(t instanceof ed){var S=t;""!==S.tabText||(0,a.isNullOrUndefined)(S.tabLeader)||"None"===S.tabLeader?""!==S.tabText&&(P=S.tabText):(P=this.getTabLeader(t),S.tabText=P)}P=this.documentHelper.textHelper.setText(P,w,c.bdo,!0),c.allCaps&&(P=P.toUpperCase());var T=t.characterRange;(T==e.WordSplit||(T&e.WordSplit)==e.WordSplit&&(T&e.RightToLeft)==e.RightToLeft)&&c.bidi&&(P=this.inverseCharacter(P));var H=c.scaling<100?1:c.scaling/100;if(T!==e.RightToLeft||Pa.startsWith(P," ")||(this.pageContext.direction="rtl",i+=t.width),this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting)(t instanceof ed||t instanceof Zl)&&"\t"===t.text&&this.tabMark(t,c,i,n,d,l),"\r"===P&&(P=String.fromCharCode(182)),this.pageContext.letterSpacing=c.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(H,1),this.pageContext.fillText(this.replaceSpace(P),this.getScaledValue(i+d,1)/H,this.getScaledValue(n+l,2),F),this.pageContext.restore();else{if(this.pageContext.letterSpacing=c.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(H,1),t.paragraph.containerWidget.containerShape&&"Center"==t.paragraph.containerWidget.textVerticalAlignment){var E=t.paragraph.containerWidget.containerShape.height,N=this.getScaledValue(n+l,2)+this.getScaledValue(E)/4.5,W=0;if(t.paragraph.containerWidget.childWidgets&&t.paragraph.containerWidget.childWidgets.length>0)for(var O=0;O<t.paragraph.containerWidget.childWidgets.length;O++)W+=t.paragraph.containerWidget.childWidgets[O].height;W+this.getScaledValue(E)/2<this.getScaledValue(E)?this.pageContext.fillText(P,this.getScaledValue(i+d,1)/H,N,F):this.pageContext.fillText(P,this.getScaledValue(i+d,1)/H,this.getScaledValue(n+l,2),F)}else if(t.paragraph.containerWidget.containerShape&&"Bottom"==t.paragraph.containerWidget.textVerticalAlignment){E=t.paragraph.containerWidget.containerShape.height,N=this.getScaledValue(n+l,2)+this.getScaledValue(E)/2,W=0;if(t.paragraph.containerWidget.childWidgets&&t.paragraph.containerWidget.childWidgets.length>0)for(O=0;O<t.paragraph.containerWidget.childWidgets.length;O++)W+=t.paragraph.containerWidget.childWidgets[O].height;W+this.getScaledValue(E)/2<this.getScaledValue(E)?this.pageContext.fillText(P,this.getScaledValue(i+d,1)/H,N,F):this.pageContext.fillText(P,this.getScaledValue(i+d,1)/H,this.getScaledValue(n+l,2),F)}else this.pageContext.fillText(P,this.getScaledValue(i+d,1)/H,this.getScaledValue(n+l,2),F);this.pageContext.restore()}if(T!==e.RightToLeft||Pa.startsWith(P," ")||(this.pageContext.direction="ltr",i-=t.width),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||t.canTrigger)&&" "!==t.text&&""!==t.text.trim()&&!this.documentHelper.textHelper.containsSpecialCharAlone(t.text)&&!this.documentHelper.isScrollHandler&&((0,a.isNullOrUndefined)(t.previousNode)||!(t.previousNode instanceof _l&&2===t.previousNode.fieldType))){t.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop;var B=!1;if(!(0,a.isNullOrUndefined)(t.revisions)&&t.revisions.length>0&&(B="Deletion"===t.revisions[0].revisionType),!B){var L=this.spellChecker.checktextElementHasErrors(t.text,t,i);if(L.errorFound&&!this.isPrinting){f="#FF0000";var D=s instanceof Vl?s.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,R=this.spellChecker.errorWordCollection;for(O=0;O<L.elements.length;O++){var M=L.elements[O],A=this.spellChecker.manageSpecialCharacters(M.text,void 0,!0);if(-1===t.ignoreOnceItems.indexOf(A)&&(w?this.renderWavyLine(M,(0,a.isNullOrUndefined)(M.end)?i:M.end.location.x,n,r,f,"Single",c.baselineAlignment,D):this.renderWavyLine(M,(0,a.isNullOrUndefined)(M.start)?i:M.start.location.x,n,r,f,"Single",c.baselineAlignment,D),R.containsKey(A))){var U=R.get(A);-1===U.indexOf(M)&&U.push(M)}}}else(t.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(this.handleChangeDetectedElements(t,r,i,n,c.baselineAlignment),t.isSpellCheckTriggered=!0)}}var V=this.getRevisionType(m,!0);("None"===c.underline||(0,a.isNullOrUndefined)(c.underline))&&((0,a.isNullOrUndefined)(V)||"Insertion"!==V.type&&"MoveTo"!==V.type)||this.renderUnderline(t,i,n,r,f,c.underline,c.baselineAlignment,V),V=this.getRevisionType(m,!1),("None"===c.strikethrough||(0,a.isNullOrUndefined)(c.strikethrough))&&((0,a.isNullOrUndefined)(V)||"Deletion"!==V.type&&"MoveFrom"!==V.type)||this.renderStrikeThrough(t,i,n,c.strikethrough,f,c.baselineAlignment,V),o&&this.pageContext.restore()},i.prototype.tabMark=function(e,t,i,n,r,o){var s=e.paragraph.bidi?String.fromCharCode(8592):String.fromCharCode(8594),a=this.documentHelper.textHelper.getWidth(s,t,e.scriptType),l=e.width/2,d=a/2;this.pageContext.font=this.retriveCharacterformat(e.characterFormat),this.pageContext.letterSpacing=t.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save();var h=t.scaling<100?1:t.scaling/100;this.pageContext.scale(h,1),l>a?this.pageContext.fillText(s,this.getScaledValue(i+r+l-d,1)/h,this.getScaledValue(n+o,2)):this.pageContext.fillText(s,this.getScaledValue(i+r,1)/h,this.getScaledValue(n+o,2),this.getScaledValue(e.width)),this.pageContext.restore()},i.prototype.replaceSpace=function(e){return e=(e=e.replace(new RegExp(String.fromCharCode(32),"g"),String.fromCharCode(183))).replace(new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(176))},i.prototype.inverseCharacter=function(e){switch(e){case String.fromCharCode(40):return String.fromCharCode(41);case String.fromCharCode(41):return String.fromCharCode(40);case String.fromCharCode(60):return String.fromCharCode(62);case String.fromCharCode(62):return String.fromCharCode(60);case String.fromCharCode(123):return String.fromCharCode(125);case String.fromCharCode(125):return String.fromCharCode(123);case String.fromCharCode(91):return String.fromCharCode(93);case String.fromCharCode(93):return String.fromCharCode(91);default:return e}},i.prototype.getBackgroundColorHeirachy=function(e){var t;if(e.paragraph.isInsideTable){var i=e.paragraph.containerWidget;t=i.cellFormat.shading.backgroundColor;var n=i.cellFormat.shading.foregroundColor;if(i.cellFormat.shading.hasValue("textureStyle")&&"empty"===n&&("empty"===t||"#00000000"===t))return this.drawTextureStyle(i.cellFormat.shading.textureStyle,Pa.getColor(n),Pa.getColor(t),!0,!0);if("empty"!==t&&"#00000000"!==t)return t;if("empty"!==(t=i.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)return t}else if(e.paragraph.containerWidget instanceof cd&&!(0,a.isNullOrUndefined)(e.paragraph.containerWidget.containerShape)&&!(0,a.isNullOrUndefined)(e.paragraph.containerWidget.containerShape.fillFormat)&&"#000000FF"===e.paragraph.containerWidget.containerShape.fillFormat.color)return e.paragraph.containerWidget.containerShape.fillFormat.color;return this.documentHelper.backgroundColor},i.prototype.handleChangeDetectedElements=function(e,t,i,n,r){var o=this,s=e.text.trim(),l=this.pageIndex;if("\v"!==e.text&&!this.spellChecker.checkElementCanBeCombined(e,t,l,!0)){var d=s.split(/[\s]+/),h=e.line.getOffset(e,0);if(d.length>1){if(e.previousElement instanceof _l)for(var c=0;c<e.line.children.length;c++)e.line.children[c]instanceof _l&&h--;for(c=0;c<d.length;c++){var p=d[c],u=this.spellChecker.manageSpecialCharacters(p,void 0,!0);-1===this.spellChecker.ignoreAllItems.indexOf(u)&&-1===e.ignoreOnceItems.indexOf(u)&&(this.handleUnorderedElements(u,e,t,c,h,c===d.length-1,l),h+=p.length+1)}}else{u=this.spellChecker.manageSpecialCharacters(s,void 0,!0);if(s.length>0){if(-1===this.spellChecker.ignoreAllItems.indexOf(u)&&-1===e.ignoreOnceItems.indexOf(u)){var g=e.indexInOwner,m=e.line.paragraph.indexInOwner,f=this.spellChecker.checkSpellingInPageInfo(u);if(f.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var v=JSON.parse('{"HasSpellingError":'+f.hasSpellError+"}");this.spellChecker.handleWordByWordSpellCheck(v,e,i,n,t,r,!0)}else if(this.spellChecker.isInUniqueWords(u)){var y=!!this.spellChecker.isErrorWord(u);v=JSON.parse('{"HasSpellingError":'+y+"}");this.spellChecker.handleWordByWordSpellCheck(v,e,i,n,t,r,!0)}else this.documentHelper.owner.editorModule.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||!this.documentHelper.triggerSpellCheck||this.spellChecker.callSpellChecker(this.spellChecker.languageID,s,!0,this.spellChecker.allowSpellCheckAndSuggestion).then((function(d){var h=JSON.parse(d);if(!(0,a.isNullOrUndefined)(o.spellChecker)){var c=(l===o.pageIndex||e.isVisible)&&g===e.indexInOwner&&m===e.line.paragraph.indexInOwner;o.spellChecker.handleWordByWordSpellCheck(h,e,i,n,t,r,c,s)}}))}e.ischangeDetected=!1}}}},i.prototype.handleUnorderedElements=function(e,t,i,n,r,o,s){var l=this,d=t.indexInOwner,h=t.line.paragraph.indexInOwner;if(e.length>0){var c=this.spellChecker.checkSpellingInPageInfo(e);if(c.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var p=JSON.parse('{"HasSpellingError":'+c.hasSpellError+"}");this.spellChecker.handleSplitWordSpellCheck(p,e,t,!0,i,n,r,o)}else{var u=t.isVisible&&d===t.indexInOwner&&h===t.line.paragraph.indexInOwner;if(this.spellChecker.isInUniqueWords(e)){var g=!!this.spellChecker.isErrorWord(e);p=JSON.parse('{"HasSpellingError":'+g+"}");this.spellChecker.handleSplitWordSpellCheck(p,e,t,u,i,n,r,o)}else this.documentHelper.owner.editorModule.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||!this.documentHelper.triggerSpellCheck||(this.spellChecker.callSpellChecker(this.spellChecker.languageID,e,!0,this.spellChecker.allowSpellCheckAndSuggestion).then((function(s){var d=JSON.parse(s);(0,a.isNullOrUndefined)(l.spellChecker)||l.spellChecker.handleSplitWordSpellCheck(d,e,t,u,i,n,r,o)})),t.ischangeDetected=!1)}}},i.prototype.renderWavyLine=function(e,t,i,n,r,o,s,a){if(!this.isPrinting&&e.text.length>1){var l=e.height/("Normal"===s?1:1.5),d=e.margin.top,h=0;"Subscript"===s||e instanceof md?(h=l-2*(l/20)+i,h+=(d+=e.height-l)>0?d:0):h=n+i;var c=this.spellChecker.getSpecialCharactersInfo(e),p=this.spellChecker.getWhiteSpaceCharacterInfo(e),u=(t+c.beginningWidth+(p.isBeginning?p.width:0)+e.margin.left)*this.documentHelper.zoomFactor+this.leftPosition,g=h*this.documentHelper.zoomFactor+this.topPosition,m=u+this.getScaledValue(e.width-(c.beginningWidth+c.endWidth)-p.width),f=new Sa(u,g),v=new Sa(m,g);this.drawWavy(f,v,.5*(m-u),1,.7,r,e.height,a)}},i.prototype.drawWavy=function(e,t,i,n,r,o,s,l,d){this.pageContext.save(),this.pageContext.fillStyle=(0,a.isNullOrUndefined)(l)?this.documentHelper.backgroundColor:l,this.pageContext.fillRect(e.x,e.y-n,t.x-e.x,3*n),this.pageContext.restore(),this.pageContext.lineWidth=1,this.pageContext.lineCap="round",this.pageContext.strokeStyle=o,this.pageContext.beginPath();for(var h=0,c=0,p=e.x,u=e.y,g=t.x,m=t.y,f=0,v=0,y=Math.atan2(m-u,g-p),w=Math.sqrt((p-g)*(p-g)+(u-m)*(u-m)),b=1*n,C=Math.PI*i;f<=w;f+=r)v=Math.sin(f/w*C)*b,h=e.x+Math.cos(y)*f+Math.cos(y-Math.PI/2)*v,c=e.y+Math.sin(y)*f+Math.sin(y-Math.PI/2)*v,f>0?this.pageContext.lineTo(h,c):this.pageContext.moveTo(h,c);this.pageContext.stroke(),this.pageContext.restore()},i.prototype.getTabLeader=function(e){var t,i=this.getTabLeaderString(e.tabLeader),n=i;t=this.documentHelper.textHelper.getWidth(n,e.characterFormat,e.scriptType);var r=Math.floor(e.width/t);0==t&&(r=0);for(var o=0;o<=r;o++)n+=i;return n.slice(0,-1)},i.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":case"Single":t="_"}return t},i.prototype.clipRect=function(e,t,i,n){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,n),this.pageContext.clip()},i.prototype.getTrimmedWidth=function(e){var t=e.width;return e instanceof Zl&&!(e instanceof ed)&&(0,a.isNullOrUndefined)(e.nextNode)&&(t=this.documentHelper.textHelper.getWidth(Pa.trimEnd(e.text),e.characterFormat,e.scriptType)),t},i.prototype.renderUnderline=function(e,t,i,n,r,o,s,l){var d=e.height/("Normal"===s?1:1.5),h=e.margin.top,c=d/20,p=0,u=d/20;"Subscript"===s||e instanceof md?(p=d-2*c+i,p+=(h+=e.height-d)>0?h:0):p=n+i;var g=0;for((0,a.isNullOrUndefined)(l)||(o="MoveTo"===l.type?"Double":"Single"),"Double"===o&&(p-=u),e instanceof gd&&(c=.9);g<("Double"===o?2:1);){g++;var m=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(p,2),this.getScaledValue(m),this.getScaledValue(c)),p+=2*u}},i.prototype.renderStrikeThrough=function(e,t,i,n,r,o,s){var l=e.height/("Normal"===o?1:1.5),d=e.margin.top;"Subscript"===o&&(d+=e.height-l),i+=d>0?d:0;var h=l/20,c=l/2+.5*h,p=0;for((0,a.isNullOrUndefined)(s)||(n="Deletion"===s.type?"SingleStrike":"DoubleStrike"),e instanceof gd&&(h=.9),"DoubleStrike"===n&&(c-=h);p<("DoubleStrike"===n?2:1);){p++;var u=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(c+i,2),this.getScaledValue(u),this.getScaledValue(h)),c+=2*h}},i.prototype.renderImageElementBox=function(e,t,i,n){var r=this,o=e.margin.top,s=e.margin.left,l=this.checkRevisionType(e),d=l.length>0?this.getRevisionColor(l):"black";this.pageContext.textBaseline="top";var h=0,c=!1,p=e.line.paragraph.containerWidget,u=!1,g=this.getScaledValue(t+s,1),m=this.getScaledValue(i+o,2),f=this.getScaledValue(e.width),v=this.getScaledValue(e.height);if(p instanceof Vl&&(u="Exactly"===p.ownerRow.rowFormat.heightType),"Inline"===e.textWrappingStyle)if(o<0||e.line.paragraph.width<e.width){if(p instanceof Vl){var y=0;if(p.childWidgets[0]instanceof Rl)y=p.childWidgets[0].paragraphFormat.leftIndent;h=p.width+p.margin.left-p.leftBorderWidth-y,c=!0,this.clipRect(t+s,i+o,this.getScaledValue(h),this.getScaledValue(p.height))}}else if(u){var w=p.width+p.margin.left-p.leftBorderWidth;c=!0,this.clipRect(p.x,p.y,this.getScaledValue(w),this.getScaledValue(p.height))}if(e.isMetaFile&&!(0,a.isNullOrUndefined)(e.metaFileImageString))e.isCrop?this.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,g,m,f,v):this.pageContext.drawImage(e.element,g,m,f,v);else{var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC";try{var C=this;e.element.onload=function(){var t=e.element.getAttribute("lastLoaded");(0,a.isNullOrUndefined)(C.documentHelper)||t===e.element.src||(e.isCrop?C.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,g,m,f,v):C.pageContext.drawImage(e.element,g,m,f,v))},e.element.onerror=function(){var t=b,i=r.documentHelper.getImageString(e);if(i&&(Pa.startsWith(i,"http://")||Pa.startsWith(i,"https://"))){var n=r.viewer.documentHelper.images.get(parseInt(e.imageString));n&&n.length>1&&(t=n[1])}e.element.src=t},e.isCrop?this.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,g,m,f,v):this.pageContext.drawImage(e.element,g,m,f,v)}catch(n){var x=this.documentHelper.getImageString(e);if(x&&(Pa.startsWith(x,"http://")||Pa.startsWith(x,"https://"))){var I=this.viewer.documentHelper.images.get(parseInt(e.imageString));I&&I.length>1?e.element.src=I[1]:e.element.src=b}else e.imageString=b,this.documentHelper.addBase64StringInCollection(e),e.element.src=this.documentHelper.getImageString(e);this.pageContext.drawImage(e.element,this.getScaledValue(t+s,1),this.getScaledValue(i+o,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}}this.pageContext.fillStyle=Pa.getColor(d);var k=this.getRevisionType(l,!1);if((0,a.isNullOrUndefined)(k)||"Deletion"!==k.type&&"MoveFrom"!==k.type||this.renderStrikeThrough(e,t,i,"SingleStrike",d,"Normal",k),k=this.getRevisionType(l,!0),!(0,a.isNullOrUndefined)(k)&&("Insertion"===k.type||"MoveTo"===k.type)){var F=this.getUnderlineYPosition(e.line);this.renderUnderline(e,t,i,F,d,"Single","Normal")}if(this.documentHelper.owner.picturePositionY=this.getScaledValue(i+o,2),!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()&&this.documentHelper.selection.start.currentWidget===e.line){var P=this.documentHelper.owner.getImageContentControl();if(!(0,a.isNullOrUndefined)(P)&&"Picture"==P.contentControlProperties.type){var S=e.characterFormat,T=P.contentControlProperties.color;"#00000000"===T&&(T="#939393"),this.renderImgBorder(e,t,i,"black","Solid",.5,S.baselineAlignment)}}c&&this.pageContext.restore()},i.prototype.renderTableOutline=function(e){var t=new _a(this.documentHelper),i=e;e.width=this.documentHelper.layout.getTableWidth(i);var n=i.isBidiTable?t.getTableRightBorder(i.tableFormat.borders):t.getTableLeftBorder(i.tableFormat.borders),r=0;r=Pa.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r/2,e.y,e.x-e.margin.left-r/2,e.y+e.height,r,n.lineStyle),n=t.getTableTopBorder(i.tableFormat.borders),r=0,r=Pa.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y-r/2,e.x+e.width+r+e.margin.right,e.y-r/2,r,n.lineStyle),n=i.isBidiTable?t.getTableLeftBorder(i.tableFormat.borders):t.getTableRightBorder(i.tableFormat.borders),r=0,r=Pa.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x+e.width+e.margin.right+r/2,e.y,e.x+e.width+e.margin.right+r/2,e.y+e.height,r,n.lineStyle),n=t.getTableBottomBorder(i.tableFormat.borders),r=0,r=Pa.convertPointToPixel(n.getLineWidth()),this.renderSingleBorder(n.color,e.x-e.margin.left-r,e.y+e.height-r/2,e.x+e.width+r+e.margin.right,e.y+e.height-r/2,r,n.lineStyle)},i.prototype.renderTableCellOutline=function(e,t){var i,n=e.layout,r=t,o=0,s=0,l=0,d=0,h=t.ownerTable.isBidiTable;r.cellFormat.borders,t.containerWidget instanceof Ul&&(s=t.margin.bottom-t.containerWidget.bottomBorderWidth,o=t.margin.top-t.containerWidget.topBorderWidth),l=t.margin.left-t.leftBorderWidth,i=t.margin.right-t.rightBorderWidth,d=(0,a.isNullOrUndefined)(r.ownerRow)||"Exactly"!==r.ownerRow.rowFormat.heightType?!(0,a.isNullOrUndefined)(r.ownerRow)&&[r.ownerRow].length<=1?Math.max(Pa.convertPointToPixel(r.ownerRow.rowFormat.height),t.height)+o+s:t.height+o+s:Pa.convertPointToPixel(r.ownerRow.rowFormat.height)+o+s;var c=h?Vl.getCellRightBorder(r):Vl.getCellLeftBorder(r),p=0;p=Pa.convertPointToPixel(c.getLineWidth()),this.renderCellBackground(d,t,l,i,p);var u=p;if(0===r.index||1===r.cellFormat.rowSpan||r.cellFormat.rowSpan>1&&0===r.columnIndex)this.renderSingleBorder(c.color,t.x-l-p,t.y-t.margin.top,t.x-l-p,t.y+t.height+s,p,c.lineStyle);else for(var g=0;g<r.ownerTable.childWidgets.length;g++){for(var m=r.ownerTable.childWidgets[g],f=void 0,v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v];if(h?y.columnIndex===r.columnIndex+r.cellFormat.columnSpan:y.columnIndex+y.cellFormat.columnSpan-1==r.columnIndex-1){f=y;break}if(!h&&y.columnIndex>=r.columnIndex&&y.previousWidget){f=y.previousWidget;break}}if(f&&(h?f.columnIndex===r.columnIndex+r.cellFormat.columnSpan:f.columnIndex+f.cellFormat.columnSpan-1==r.columnIndex-1)){var w=h?Vl.getCellLeftBorder(f):Vl.getCellRightBorder(f),b=Pa.convertPointToPixel(w.getLineWidth());if(l=r.margin.left-b,f.y+f.height<r.y)continue;if(f.y<r.y&&f.y+f.height>r.y)this.renderSingleBorder(w.color,r.x-l-b,r.y-o,r.x-l-b,f.y+f.height+f.margin.bottom,b,w.lineStyle);else if(f.y===r.y||f.y>r.y&&f.y+f.height<r.y+r.height)this.renderSingleBorder(w.color,r.x-l-b,f.y-f.margin.top,r.x-l-b,f.y+f.height+f.margin.bottom,b,w.lineStyle);else if(f.y<r.y+r.height&&f.y+f.height>=r.y+r.height)this.renderSingleBorder(w.color,r.x-l-b,f.y-f.margin.top,r.x-l-b,f.y+f.height+s,b,w.lineStyle);else if(f.y>r.y+r.height)break}}if(r.updatedTopBorders&&r.updatedTopBorders.length>1)for(var C=h?t.x+t.width+t.margin.right-u/2:t.x-t.margin.left-u/2,x=t.y-t.margin.top,I=0;I<r.updatedTopBorders.length;I++){var k=r.updatedTopBorders[I];"None"!==(c=k.border).lineStyle&&c.lineWidth<Vl.getCellTopBorder(r).lineWidth&&(c.lineWidth=Vl.getCellTopBorder(r).lineWidth),(0,a.isNullOrUndefined)(c)||(p=Pa.convertPointToPixel(c.getLineWidth()),this.renderSingleBorder(c.color,C,x+p/2,C+(h?-k.width:k.width),x+p/2,p,c.lineStyle),C+=h?-k.width:k.width)}else{c=Vl.getCellTopBorder(r),p=Pa.convertPointToPixel(c.getLineWidth());this.renderSingleBorder(c.color,t.x-t.margin.left-u/2,t.y-t.margin.top+p/2,t.x+t.width+t.margin.right+0,t.y-t.margin.top+p/2,p,c.lineStyle)}var F=!1;F=h?0===r.columnIndex:r.cellIndex===r.ownerRow.childWidgets.length-1;for(var P=r.containerWidget.getPreviousRowSpannedCells(),S=!1,T=0;T<P.length;T++){var H=P[T];if(r.rowIndex<H.rowIndex+H.cellFormat.rowSpan&&r.columnIndex<H.columnIndex){S=!0;break}}!(r.ownerTable.tableFormat.cellSpacing>0||F)||!h&&r.columnIndex+r.cellFormat.columnSpan!==r.ownerTable.tableHolder.columns.length&&S||(c=h?Vl.getCellLeftBorder(r):Vl.getCellRightBorder(r),p=Pa.convertPointToPixel(c.getLineWidth()),this.renderSingleBorder(c.color,t.x+t.width+t.margin.right-p/2,t.y-t.margin.top,t.x+t.width+t.margin.right-p/2,t.y+t.height+s,p,c.lineStyle));var E=r.ownerRow.nextWidget,N=!1,W=void 0;if(!(0,a.isNullOrUndefined)(E)){if(E.lastChild){var O=E.lastChild;W=O.columnIndex+O.cellFormat.columnSpan}var B;(B=E)instanceof Ul&&t.containerWidget instanceof Ul&&t.containerWidget.containerWidget instanceof Al&&(N=-1!==t.containerWidget.containerWidget.childWidgets.indexOf(B))}var L=!(0,a.isNullOrUndefined)(E)&&F&&!(E.rowFormat.gridAfter>0||E.rowFormat.gridBefore>0)&&E.lastChild.columnIndex+E.lastChild.cellFormat.columnSpan>r.ownerRow.lastChild.columnIndex&&E.lastChild.columnIndex+E.lastChild.cellFormat.columnSpan<r.ownerRow.lastChild.columnIndex+r.ownerRow.lastChild.cellFormat.columnSpan&&!(0,a.isNullOrUndefined)(E.childWidgets)&&E.childWidgets.length<r.ownerRow.childWidgets.length+r.cellFormat.columnSpan-1&&t.x+t.width>E.lastChild.x+E.lastChild.width+E.lastChild.margin.right&&"Cleared"!==r.cellFormat.borders.bottom.lineStyle;if(r.ownerTable.tableFormat.cellSpacing>0||r.ownerRow.rowIndex===r.ownerTable.childWidgets.length-1||r.cellFormat.rowSpan>1&&r.ownerRow.rowIndex+r.cellFormat.rowSpan>=r.ownerTable.childWidgets.length||!N||this.isRenderHeader||W&&E.childWidgets.length<r.ownerRow.childWidgets.length&&W<r.columnIndex+r.cellFormat.columnSpan||!(0,a.isNullOrUndefined)(r.cellFormat.borders.bottom)&&"Cleared"!==r.cellFormat.borders.bottom.lineStyle&&1===r.cellFormat.rowSpan&&!h&&(!(0,a.isNullOrUndefined)(E)&&t.x<E.firstChild.x-E.firstChild.margin.left&&E.rowFormat.gridBefore>0&&(0!==E.rowFormat.beforeWidth||0!==E.rowFormat.gridBeforeWidth)||!(0,a.isNullOrUndefined)(E)&&t.x+t.width>E.lastChild.x+E.lastChild.width+E.lastChild.margin.right&&E.rowFormat.gridAfter>0&&(0!==E.rowFormat.afterWidth||0!==E.rowFormat.gridAfterWidth))||L){var D=r.cellFormat.borders.bottom;c=((0,a.isNullOrUndefined)(D)||"Cleared"!==D.lineStyle)&&r.cellFormat.rowSpan>1&&r.ownerRow.rowIndex+r.cellFormat.rowSpan===r.ownerTable.childWidgets.length?r.getBorderBasedOnPriority(r.getBorderBasedOnPriority(r.cellFormat.borders.bottom,r.ownerRow.rowFormat.borders.bottom),r.ownerTable.tableFormat.borders.bottom):Vl.getCellBottomBorder(r);var R=t.x-t.margin.left-u/2,M=t.x+t.width+t.margin.right;(W&&E.childWidgets.length<r.ownerRow.childWidgets.length&&W<r.columnIndex+r.cellFormat.columnSpan||(0,a.isNullOrUndefined)(E)||h||!(E.rowFormat.gridAfter>0)||0===E.rowFormat.afterWidth&&0===E.rowFormat.gridAfterWidth||(0,a.isNullOrUndefined)(E.lastChild)||(0,a.isNullOrUndefined)(Vl.getCellTopBorder(E.lastChild))||"None"===Vl.getCellTopBorder(E.lastChild).lineStyle||!(t.x<E.lastChild.x+E.lastChild.width+E.lastChild.margin.right))&&!L||(R=E.lastChild.x+E.lastChild.width+E.lastChild.margin.right),W&&E.childWidgets.length<r.ownerRow.childWidgets.length&&W<r.columnIndex+r.cellFormat.columnSpan||(0,a.isNullOrUndefined)(E)||h||!(E.rowFormat.gridBefore>0)||0===E.rowFormat.beforeWidth&&0===E.rowFormat.gridBeforeWidth||(0,a.isNullOrUndefined)(E.firstChild)||(0,a.isNullOrUndefined)(Vl.getCellTopBorder(E.firstChild))||"None"===Vl.getCellTopBorder(E.firstChild).lineStyle||!(t.x+t.width>E.firstChild.x-E.firstChild.margin.left)||(M=E.firstChild.x-E.firstChild.margin.left),p=Pa.convertPointToPixel(c.getLineWidth()),this.renderSingleBorder(c.color,R,t.y+t.height+s+p/2,M,t.y+t.height+s+p/2,p,c.lineStyle)}c=n.getCellDiagonalUpBorder(r),(p=Pa.convertPointToPixel(c.getLineWidth()))>0&&this.renderSingleBorder(c.color,t.x-l,t.y+t.height+s,t.x+t.width+i,t.y-o,p,c.lineStyle),c=n.getCellDiagonalDownBorder(r),(p=Pa.convertPointToPixel(c.getLineWidth()))>0&&this.renderSingleBorder(c.color,t.x-l,t.y-o,t.x+t.width+i,t.y+t.height+s,p,c.lineStyle)},i.prototype.renderCellBackground=function(e,t,i,n,r){var o=t.cellFormat,s=t.x-i-r,a=t.margin.top-t.containerWidget.topBorderWidth,l=t.y-a,d=t.width+i+n+r/2,h=t.ownerTable.tableFormat.shading.backgroundColor,c=o.shading.backgroundColor;t.ownerRow.rowFormat.revisions.length>0&&(c="Insertion"===t.ownerRow.rowFormat.revisions[t.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4");if("empty"!==c){var p=Vl.getCellLeftBorder(t),u=Vl.getCellTopBorder(t);t===t.ownerRow.lastChild||"None"!==p.lineStyle&&"Cleared"!==p.lineStyle||(d+=.5),t.ownerRow.ownerTable.lastChild===t.ownerRow||"None"!==u.lineStyle&&"Cleared"!==u.lineStyle||(e+=.5)}t.ownerTable.tableFormat.cellSpacing>0&&this.renderBackgroundColor(h,s,l,d,e),this.renderBackgroundColor(c,s,l,d,e),o.shading.hasValue("foregroundColor")&&"TextureNone"!==o.shading.textureStyle&&(this.pageContext.beginPath(),this.pageContext.fillStyle=this.drawTextureStyle(o.shading.textureStyle,Pa.getColor(o.shading.foregroundColor),Pa.getColor(o.shading.backgroundColor),"empty"===o.shading.foregroundColor,"empty"===o.shading.backgroundColor),this.pageContext.fillRect(this.getScaledValue(s,1),this.getScaledValue(l,2),this.getScaledValue(d),this.getScaledValue(e)),this.pageContext.closePath())},i.prototype.renderBackgroundColor=function(e,t,i,n,r){this.pageContext.beginPath(),"empty"!==e&&(this.pageContext.fillStyle=Pa.getColor(e),this.pageContext.fillRect(this.getScaledValue(t,1),this.getScaledValue(i,2),this.getScaledValue(n),this.getScaledValue(r)),this.pageContext.closePath())},i.prototype.drawTextureStyle=function(e,t,i,n,r){if(r&&(i="#ffffff"),n&&(t="#000000"),e.indexOf("Percent")>-1){var o=e.replace("Texture","").replace("Percent","").replace("Pt","."),s=parseInt(o);return this.getForeColor(t,i,s,n,r)}return"TextureSolid"===e?t:"#FFFFFF"},i.prototype.getForeColor=function(e,t,i,n,r){var o,s,a,l=Pa.convertHexToRgb(e),d=Pa.convertHexToRgb(t);return o=this.getColorValue(l.r,d.r,i,n,r),s=this.getColorValue(l.g,d.g,i,n,r),a=this.getColorValue(l.b,d.b,i,n,r),"#"+Pa.convertRgbToHex(o)+Pa.convertRgbToHex(s)+Pa.convertRgbToHex(a)},i.prototype.getColorValue=function(e,t,i,n,r){return 100==i?e:n?r?Math.round(255*(1-i/100)):Math.round(t*(1-i/100)):r?Math.round(e*(i/100)):t+Math.round(e*(i/100))-Math.round(t*(i/100))},i.prototype.renderSingleBorder=function(e,t,i,n,r,o,s){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(n,1),this.getScaledValue(r,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=Pa.getColor(e),"None"!==s&&"Cleared"!==s&&this.pageContext.stroke(),this.pageContext.closePath()},i.prototype.getScaledValue=function(e,t){return this.isPrinting?e:((0,a.isNullOrUndefined)(t)&&(t=0),e*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},i.prototype.checkRevisionType=function(e){for(var t=[],i=e.revisions.length,n=0;n<i;n++){var r=e.revisions[n],o=this.documentHelper.authors.get(r.author);t.push({type:r.revisionType,color:o})}return t},i.prototype.getRevisionColor=function(e){if(1===e.length)return e[0].color;for(var t=0;t<e.length;t++)if("Deletion"===e[t].type||"MoveFrom"===e[t].type)return e[t].color;return e.length>0?e[0].color:void 0},i.prototype.getRevisionType=function(e,t){if(0!==e.length)for(var i=0;i<e.length;i++){var n=void 0;if(t&&("Insertion"===e[i].type||"MoveTo"===e[i].type))return n=e[i],this.pageContext.fillStyle=Pa.getColor(n.color),e.splice(i,1),n;if(!t&&("Deletion"===e[i].type||"MoveFrom"===e[i].type))return n=e[i],this.pageContext.fillStyle=Pa.getColor(n.color),e.splice(i,1),n}},i.prototype.getFormfieldInLine=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]instanceof _l&&!(0,a.isNullOrUndefined)(e.children[t].formFieldData))return e.children[t]},i.prototype.getShape=function(e){return this.shapes[e.toString()]},i.prototype.destroy=function(){this.documentHelper=void 0,this.shapes=null,(0,a.isNullOrUndefined)(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},i}(),$a=function(){function e(e){var t=this;this.onMouseWheelInternal=function(e){if(!0===e.ctrlKey&&(e.preventDefault(),e.pageX-t.documentHelper.viewerContainer.offsetLeft<t.documentHelper.pageContainer.offsetWidth)){var i=void 0;void 0!==navigator&&(i=navigator.userAgent.match("Firefox"));var n=i?e.detail<0:a.Browser.isIE?e.wheelDelta>0:e.deltaY<0,r=t.documentHelper.zoomFactor;n?r<=4.9?r+=.1:r=5:r>=.2?r-=.1:r=.1,t.documentHelper.zoomFactor=r}},this.documentHelper=e}return e.prototype.setZoomFactor=function(){this.onZoomFactorChanged(),(0,a.isNullOrUndefined)(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition(),this.documentHelper.updateTouchMarkPosition(),(0,a.isNullOrUndefined)(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition(),this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.onZoomFactorChanged=function(){this.documentHelper.zoomFactor>5?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1),this.zoom()},e.prototype.zoom=function(){var e=this.viewer;this.documentHelper.clearContent(),e.handleZoom(),this.documentHelper.updateFocus()},e.prototype.destroy=function(){this.documentHelper=void 0},e}(),el=m(197),tl=m(741),il=m(90),nl=function(){function e(e){var t=this;this.show=function(){var e=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),t.target||t.initUserDialog(e,t.documentHelper.owner.enableRtl),t.documentHelper.dialog.header=e.getConstant("Add Users"),t.documentHelper.dialog.height="auto",t.documentHelper.dialog.width="auto",t.documentHelper.dialog.content=t.target,t.documentHelper.dialog.beforeOpen=t.loadUserDetails,t.documentHelper.dialog.close=t.documentHelper.updateFocus,t.documentHelper.dialog.buttons=[{click:t.okButtonClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:t.hideDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat"}},{click:t.deleteButtonClick,buttonModel:{content:e.getConstant("Delete"),cssClass:"e-flat e-user-delete"}}],t.documentHelper.dialog.dataBind(),t.documentHelper.dialog.show()},this.loadUserDetails=function(){t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind(),t.documentHelper.restrictEditingPane.addedUser.dataSource=t.documentHelper.userCollection.slice(),t.documentHelper.restrictEditingPane.addedUser.dataBind()},this.okButtonClick=function(){t.documentHelper.restrictEditingPane.isAddUser=!0,t.documentHelper.restrictEditingPane.showStopProtectionPane(!1),t.documentHelper.restrictEditingPane.addUserCollection(),t.documentHelper.restrictEditingPane.isAddUser=!1,t.documentHelper.dialog.hide()},this.hideDialog=function(){t.textBoxInput.value="",t.documentHelper.dialog.hide()},this.onKeyUpOnDisplayBox=function(){t.addButton.disabled=""===t.textBoxInput.value},this.addButtonClick=function(){t.validateUserName(t.textBoxInput.value)?(t.bindListData(t.textBoxInput.value),t.textBoxInput.value=""):el.DialogUtility.alert("Invalid user name")},this.deleteButtonClick=function(){var e=t.documentHelper.userCollection.indexOf(t.userList.getSelectedItems().text);e>-1&&(t.documentHelper.userCollection.splice(e,1),t.userList.dataSource=t.documentHelper.userCollection.slice(),t.userList.dataBind())},this.documentHelper=e}return e.prototype.initUserDialog=function(e,t){this.target=(0,a.createElement)("div",{className:"e-de-user-dlg"});var i=e.getConstant("Enter User"),n=(0,a.createElement)("div",{innerHTML:i,className:"e-bookmark-dlgfields"});this.target.appendChild(n);var r=(0,a.createElement)("div",{className:"e-de-user-dlg-common"});this.target.appendChild(r);var o=(0,a.createElement)("div",{className:"e-de-user-dlg-list"});r.appendChild(o),t&&o.classList.add("e-de-rtl"),this.textBoxInput=(0,a.createElement)("input",{className:"e-input e-de-user-dlg-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),o.appendChild(this.textBoxInput),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnDisplayBox);var s=(0,a.createElement)("button",{innerHTML:e.getConstant("Add"),attrs:{type:"button"}});o.appendChild(s),s.addEventListener("click",this.addButtonClick),this.addButton=new tl.Button({cssClass:"e-de-user-add-btn"}),this.addButton.disabled=!0,this.addButton.appendTo(s),this.addButton.addEventListener("click",this.addButtonClick);var l=(0,a.createElement)("div");r.appendChild(l);var d=(0,a.createElement)("div",{innerHTML:e.getConstant("Users"),className:"e-de-user-dlg-user"});l.appendChild(d);var h=(0,a.createElement)("div");l.appendChild(h),this.userList=new il.ListView({cssClass:"e-de-user-listview"}),this.userList.appendTo(h)},e.prototype.bindListData=function(e){-1===this.documentHelper.userCollection.indexOf(e)&&this.documentHelper.userCollection.push(e),this.userList&&(this.userList.dataSource=this.documentHelper.userCollection.slice(),this.userList.dataBind())},e.prototype.validateUserName=function(e){if(-1===e.indexOf("@"))return!1;var t=e.split("@")[1];if(-1===t.indexOf("."))return!1;var i=t.split("."),n=i[1];return!(i.length>2)&&!(n.length>4||n.length<2)},e.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.userList&&(this.userList.destroy(),this.userList=void 0),this.documentHelper=void 0},e}(),rl=m(323),ol=function(){function e(e,t){var i=this;this.show=function(){i.localeValue=new a.L10n("documenteditor",i.viewer.owner.defaultLocale),i.localeValue.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localeValue),i.documentHelper.dialog.header=i.localeValue.getConstant("Start Enforcing Protection"),i.documentHelper.dialog.height="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.width="auto",i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localeValue.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localeValue.getConstant("Cancel"),cssClass:"e-flat"}}],i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.show()},this.hideDialog=function(){i.passwordTextBox.value="",i.confirmPasswordTextBox.value="",i.documentHelper.dialog.hide()},this.okButtonClick=function(){i.passwordTextBox.value!==i.confirmPasswordTextBox.value?el.DialogUtility.alert(i.localeValue.getConstant("Password Mismatch")):(i.password=a.SanitizeHtmlHelper.sanitize(i.passwordTextBox.value),i.viewer.owner.editorModule.addProtection(i.password,i.owner.protectionType))},this.documentHelper=e,this.owner=t}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.initDialog=function(e){this.target=(0,a.createElement)("div",{className:"e-de-enforce"});var t=(0,a.createElement)("div",{className:"e-de-container-row"});this.passwordTextBox=(0,a.createElement)("input",{attrs:{type:"password",autofocus:"true"},className:"e-input"}),t.appendChild(this.passwordTextBox);var i=(0,a.createElement)("div");this.confirmPasswordTextBox=(0,a.createElement)("input",{attrs:{type:"password"},className:"e-input"}),i.appendChild(this.confirmPasswordTextBox),this.target.appendChild(t),this.target.appendChild(i),new rl.TextBox({placeholder:e.getConstant("Enter new password"),floatLabelType:"Always",cssClass:"e-de-enforce-dlg-input"},this.passwordTextBox),new rl.TextBox({placeholder:e.getConstant("Reenter new password to confirm"),floatLabelType:"Always"},this.confirmPasswordTextBox)},e.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},e}(),sl=function(){function e(e,t){var i=this;this.show=function(){i.localObj=new a.L10n("documenteditor",i.viewer.owner.defaultLocale),i.localObj.setLocale(i.viewer.owner.locale),i.target||i.initDialog(i.localObj),i.documentHelper.dialog.header="Unprotect Document",i.documentHelper.dialog.height="auto",i.documentHelper.dialog.width="auto",i.documentHelper.dialog.content=i.target,i.documentHelper.dialog.buttons=[{click:i.okButtonClick,buttonModel:{content:i.localObj.getConstant("Ok"),cssClass:"e-flat",isPrimary:!0}},{click:i.hideDialog,buttonModel:{content:i.localObj.getConstant("Cancel"),cssClass:"e-flat"}}],i.documentHelper.dialog.dataBind(),i.passwordTextBox.value="",i.documentHelper.dialog.show()},this.okButtonClick=function(){var e=i.passwordTextBox.value;0!==e.length||""!==e?i.viewer.owner.editorModule.stopProtection(e):el.DialogUtility.alert(i.localObj.getConstant("The password is incorrect"))},this.hideDialog=function(){i.passwordTextBox.value="",i.documentHelper.dialog.hide()},this.documentHelper=e,this.owner=t}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.initDialog=function(e){var t=this.viewer.owner.containerId+"_enforce_protection";this.target=(0,a.createElement)("div",{id:t,className:"e-de-enforce"});var i=(0,a.createElement)("div"),n=(0,a.createElement)("div",{className:"e-de-unprotect-dlg-title",innerHTML:e.getConstant("Password")});this.passwordTextBox=(0,a.createElement)("input",{attrs:{type:"password"},id:this.viewer.owner.containerId+"_display_text",className:"e-input e-de-enforce-dlg-input"}),i.appendChild(n),i.appendChild(this.passwordTextBox),this.target.appendChild(i)},e.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},e}(),al=m(778),ll=function(){function e(e){var t=this;this.addRemove=!0,this.protectionType="ReadOnly",this.previousProtectionType="Read only",this.isShowRestrictPane=!1,this.isAddUser=!1,this.usersCollection=["Everyone"],this.closePane=function(){t.isShowRestrictPane=!1,t.restrictPane.style.display="none",t.documentHelper.owner.showHideRulers(),t.documentHelper.owner.triggerResize()},this.onYesButtonClick=function(){t.viewer.owner.editorModule.removeAllEditRestrictions(),t.documentHelper.dialog.hide()},this.onCancelButtonClick=function(e){t.protectionTypeDrop.value=t.previousProtectionType,t.documentHelper.dialog.hide()},this.onNoButtonClick=function(){t.documentHelper.dialog.hide()},this.showAllRegion=function(){t.documentHelper.selection.showAllEditingRegion()},this.documentHelper=e,this.addUserDialog=new nl(e),this.enforceProtectionDialog=new ol(e,this),this.unProtectDialog=new sl(e,this),this.base64=new Ta}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.showHideRestrictPane=function(e){this.restrictPane||(this.localObj=new a.L10n("documenteditor",this.viewer.owner.defaultLocale),this.localObj.setLocale(this.viewer.owner.locale),this.initPane(this.localObj,this.documentHelper.owner.enableRtl)),e?(this.restrictPane.style.display="block",this.isShowRestrictPane=!0,this.documentHelper.selection.isHighlightEditRegion=!0,this.wireEvents(),this.documentHelper.updateViewerSize(),this.loadPaneValue(),this.addUserCollection()):(this.closePane(),this.documentHelper.owner.enableAutoFocus&&this.documentHelper.updateFocus()),this.documentHelper.owner.triggerResize()},e.prototype.initPane=function(e,t){this.restrictPane=(0,a.createElement)("div",{className:"e-de-restrict-pane"}),t&&this.restrictPane.classList.add("e-rtl");var i=(0,a.createElement)("div",{className:"e-de-rp-whole-header"}),n=(0,a.createElement)("div",{innerHTML:e.getConstant("Restrict Editing"),className:"e-de-rp-header"});this.closeButton=(0,a.createElement)("button",{className:"e-de-rp-close-icon e-de-close-icon e-btn e-flat e-icon-btn",attrs:{type:"button"}}),this.closeButton.setAttribute("aria-label",this.localObj.getConstant("Close")),i.appendChild(this.closeButton),i.appendChild(n);var r=(0,a.createElement)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(r),this.restrictPane.appendChild(i),this.initRestrictEditingPane(e),this.documentHelper.optionsPaneContainer.setAttribute("style","display:inline-flex;"),this.documentHelper.optionsPaneContainer.insertBefore(this.restrictPane,this.documentHelper.viewerContainer)},e.prototype.initRestrictEditingPane=function(e){this.restrictPaneWholeDiv=(0,a.createElement)("div");var t=(0,a.createElement)("div",{className:"e-de-rp-sub-div"}),i=(0,a.createElement)("div",{innerHTML:e.getConstant("Formatting restrictions"),className:"e-de-rp-format"});t.appendChild(i);var n=(0,a.createElement)("input",{attrs:{type:"checkbox"}});t.appendChild(n),this.allowFormat=this.createCheckBox(e.getConstant("Allow formatting"),n),this.restrictPaneWholeDiv.appendChild(t);var r=(0,a.createElement)("div",{className:"e-de-rp-sub-div"}),o=((0,a.createElement)("input",{attrs:{type:"checkbox"}}),(0,a.createElement)("input",{className:"e-prop-font-style"}));r.appendChild(o);var s=[{Value:"Read only",Name:e.getConstant("Read only")},{Value:"Filling in forms",Name:e.getConstant("Filling in forms")},{Value:"Comments",Name:e.getConstant("Comments")},{Value:"Tracked changes",Name:e.getConstant("Tracked changes")}];this.protectionTypeDrop=new al.DropDownList({dataSource:s,cssClass:"e-de-prop-dropdown",floatLabelType:"Always",placeholder:e.getConstant("Editing restrictions"),fields:{text:"Name",value:"Value"},enableRtl:this.documentHelper.owner.enableRtl}),this.protectionTypeDrop.value="Read only",this.protectionTypeDrop.appendTo(o),this.restrictPaneWholeDiv.appendChild(r),this.userWholeDiv=(0,a.createElement)("div",{className:"e-de-rp-sub-div"});var l=(0,a.createElement)("div",{innerHTML:e.getConstant("Exceptions Optional"),className:"e-de-rp-format"});this.userWholeDiv.appendChild(l);var d=(0,a.createElement)("div",{innerHTML:e.getConstant("Select Part Of Document And User"),className:"e-de-rp-sub-content-div"});this.userWholeDiv.appendChild(d);var h=(0,a.createElement)("div",{className:"e-de-rp-user"});this.userWholeDiv.appendChild(h),this.addedUser=new il.ListView({cssClass:"e-de-user-listView",dataSource:[{text:"Everyone"}],showCheckBox:!0,select:this.selectHandler.bind(this),enableRtl:this.documentHelper.owner.enableRtl}),this.addedUser.appendTo(h),this.addUser=(0,a.createElement)("button",{className:"e-btn e-primary e-flat e-de-rp-mu-btn",innerHTML:e.getConstant("More users")+"...",attrs:{type:"button"}}),this.addUser.setAttribute("aria-label",e.getConstant("More users")),this.userWholeDiv.appendChild(this.addUser),this.restrictPaneWholeDiv.appendChild(this.userWholeDiv);var c=(0,a.createElement)("div",{className:"e-de-rp-enforce"});this.restrictPaneWholeDiv.appendChild(c),this.enforceProtection=(0,a.createElement)("button",{innerHTML:e.getConstant("Enforcing Protection"),className:"e-btn e-de-rp-btn-enforce",attrs:{type:"button"}}),this.enforceProtection.setAttribute("aria-label",e.getConstant("Enforcing Protection")),c.appendChild(this.enforceProtection),this.restrictPane.appendChild(this.restrictPaneWholeDiv),this.stopProtectionDiv=(0,a.createElement)("div",{styles:"display:none"});var p=(0,a.createElement)("div",{innerHTML:e.getConstant("Your permissions"),className:"e-de-rp-stop-div1"});this.stopProtectionDiv.appendChild(p);var u=(0,a.createElement)("div",{className:"e-de-rp-stop-div2"});this.stopProtectionDiv.appendChild(u);var g=e.getConstant("Protected Document");this.contentDiv1=(0,a.createElement)("div",{innerHTML:g}),u.appendChild(this.contentDiv1);var m=e.getConstant("ReadOnlyProtection");this.contentDiv2=(0,a.createElement)("div",{innerHTML:m}),u.appendChild(this.contentDiv2),this.stopReadOnlyOptions=(0,a.createElement)("div"),this.stopProtectionDiv.appendChild(this.stopReadOnlyOptions);var f=(0,a.createElement)("div",{className:"e-de-rp-enforce-nav"}),v=(0,a.createElement)("button",{innerHTML:e.getConstant("Find Next Region I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}});f.appendChild(v),v.addEventListener("click",this.navigateNextRegion.bind(this)),this.stopReadOnlyOptions.appendChild(f);var y=(0,a.createElement)("div",{className:"e-de-rp-enforce-nav"}),w=(0,a.createElement)("button",{innerHTML:e.getConstant("Show All Regions I Can Edit"),className:"e-btn e-de-rp-nav-btn",attrs:{type:"button"}});y.appendChild(w),w.addEventListener("click",this.showAllRegion),this.stopReadOnlyOptions.appendChild(y);var b=(0,a.createElement)("div",{className:"e-de-rp-nav-lbl e-de-rp-more-less"}),C=(0,a.createElement)("input",{attrs:{type:"checkbox"},className:"e-btn e-de-rp-nav-btn"});b.appendChild(C),this.stopReadOnlyOptions.appendChild(b),this.highlightCheckBox=new tl.CheckBox({label:e.getConstant("Highlight the regions I can edit"),change:this.changeHighlightOptions.bind(this),enableRtl:this.documentHelper.owner.enableRtl},C);var x=(0,a.createElement)("div",{className:"e-de-rp-enforce"});this.stopProtection=(0,a.createElement)("button",{innerHTML:e.getConstant("Stop Protection"),className:"e-btn e-de-rp-btn-stop-enforce",attrs:{type:"button"}}),x.appendChild(this.stopProtection),this.stopProtectionDiv.appendChild(x),this.restrictPane.appendChild(this.stopProtectionDiv)},e.prototype.showStopProtectionPane=function(e){switch(e?(this.stopProtectionDiv.style.display="block",this.restrictPaneWholeDiv.style.display="none"):(this.stopProtectionDiv.style.display="none",this.restrictPaneWholeDiv.style.display="block"),this.documentHelper.protectionType){case"ReadOnly":case"CommentsOnly":this.stopReadOnlyOptions.style.display="block";break;default:this.stopReadOnlyOptions.style.display="none"}this.documentHelper.owner.showHideRulers(),this.documentHelper.owner.triggerResize()},e.prototype.wireEvents=function(){this.addUser.addEventListener("click",this.addUserDialog.show),this.enforceProtection.addEventListener("click",this.protectDocument.bind(this)),this.stopProtection.addEventListener("click",this.stopProtectionTriggered.bind(this)),this.closeButton.addEventListener("click",this.closePane),this.allowFormat.addEventListener("change",this.enableFormatting.bind(this)),this.protectionTypeDrop.addEventListener("change",this.protectionTypeDropChanges.bind(this)),this.highlightCheckBox.addEventListener("change",this.highlightClicked.bind(this))},e.prototype.changeHighlightOptions=function(){var e=this;this.documentHelper.owner.documentEditorSettings.highlightEditableRanges=this.highlightCheckBox.checked,setTimeout((function(){e.documentHelper&&e.documentHelper.owner.focusIn()}),10)},e.prototype.enableFormatting=function(e){this.documentHelper.restrictFormatting=!e.checked},e.prototype.stopProtectionTriggered=function(e){!(0,a.isNullOrUndefined)(this.documentHelper.saltValue)&&""!==this.documentHelper.saltValue||!(0,a.isNullOrUndefined)(this.documentHelper.hashValue)&&""!==this.documentHelper.hashValue?this.unProtectDialog.show():this.documentHelper.owner.editorModule.unProtectDocument()},e.prototype.protectionTypeDropChanges=function(e){switch(e.value){case"Read only":this.protectionType="ReadOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("ReadOnlyProtection"),this.previousProtectionType=e.previousItemData.Value;break;case"Filling in forms":this.protectionType="FormFieldsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("FormFieldsOnly"),this.previousProtectionType=e.previousItemData.Value,this.showRemovedIgnoreDialog();break;case"Comments":this.protectionType="CommentsOnly",this.userWholeDiv.style.display="block",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("CommentsOnly"),this.previousProtectionType=e.previousItemData.Value;break;case"Tracked changes":this.protectionType="RevisionsOnly",this.userWholeDiv.style.display="none",this.contentDiv1.innerHTML=this.localObj.getConstant("Protected Document"),this.contentDiv2.innerHTML=this.localObj.getConstant("TrackChangesOnly"),this.previousProtectionType=e.previousItemData.Value,this.showRemovedIgnoreDialog();break;default:this.protectionType="NoProtection",this.addedUser.uncheckAllItems(),this.viewer.owner.editorModule.removeAllEditRestrictions()}},e.prototype.showRemovedIgnoreDialog=function(){this.documentHelper.selection&&this.documentHelper.editRanges.length>0&&(this.documentHelper.dialog.height=" Auto",this.documentHelper.dialog.width=" 600px",this.documentHelper.dialog.header=this.localObj.getConstant("Information"),this.documentHelper.dialog.content=this.localObj.getConstant("RemovedIgnoreExceptions")+"<br><br>"+this.localObj.getConstant("RemovedIgnore"),this.documentHelper.dialog.buttons=[{click:this.onYesButtonClick,buttonModel:{content:this.localObj.getConstant("Yes")}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel")}},{click:this.onNoButtonClick,buttonModel:{content:this.localObj.getConstant("No")}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show())},e.prototype.selectHandler=function(e){e.isChecked?(this.viewer.owner.editorModule.insertEditRangeElement(e.text),e.event.target.classList.add("e-check")):this.viewer.owner.editorModule.removeUserRestrictions(e.text)},e.prototype.highlightClicked=function(e){this.documentHelper.selection.isHighlightEditRegion=e.checked},e.prototype.protectDocument=function(){this.enforceProtectionDialog.show()},e.prototype.createCheckBox=function(e,t){var i=new tl.CheckBox({label:e,enableRtl:this.documentHelper.owner.enableRtl});return i.appendTo(t),i},e.prototype.loadPaneValue=function(){switch(this.allowFormat.checked=!this.documentHelper.restrictFormatting,this.documentHelper.protectionType){case"ReadOnly":this.protectionTypeDrop.value="Read only";break;case"FormFieldsOnly":this.protectionTypeDrop.value="Filling in forms";break;case"CommentsOnly":this.protectionTypeDrop.value="Comments";break;case"RevisionsOnly":this.protectionTypeDrop.value="Tracked changes"}this.highlightCheckBox.checked=this.documentHelper.owner.documentEditorSettings.highlightEditableRanges,this.documentHelper.selection.isHighlightEditRegion=this.documentHelper.owner.documentEditorSettings.highlightEditableRanges,this.addedUser.enablePersistence=!0,this.addedUser.dataSource=this.usersCollection.slice(),this.addedUser.dataBind(),this.showStopProtectionPane(this.documentHelper.isDocumentProtected)},e.prototype.navigateNextRegion=function(){this.documentHelper.selection.navigateToNextEditingRegion()},e.prototype.addUserCollection=function(){if(this.documentHelper.selection&&this.documentHelper.selection.editRangeCollection.length>0)for(var e=0;e<this.documentHelper.selection.editRangeCollection.length;e++){var t=this.documentHelper.selection.editRangeCollection[e];""!==t.user&&-1===this.usersCollection.indexOf(t.user)&&this.usersCollection.push(t.user),""!==t.group&&-1===this.usersCollection.indexOf(t.group)&&this.usersCollection.push(t.group)}this.addedUser.dataSource=this.documentHelper.userCollection.slice(),this.addedUser.dataBind()},e.prototype.updateUserInformation=function(){if(this.addedUser.uncheckAllItems(),this.documentHelper.selection.checkSelectionIsAtEditRegion){var e=this.documentHelper.selection.getEditRangeStartElement();if(e){var t=this.addedUser.dataSource.indexOf(e.user);if(t>-1)this.addedUser.element.querySelectorAll("li")[t].querySelector(".e-icons").classList.add("e-check");if((t=this.addedUser.dataSource.indexOf(e.group))>-1)this.addedUser.element.querySelectorAll("li")[t].querySelector(".e-icons").classList.add("e-check")}}},e.prototype.destroy=function(){this.addUserDialog&&this.addUserDialog.destroy(),this.addUserDialog=void 0,this.enforceProtectionDialog&&this.enforceProtectionDialog.destroy(),this.enforceProtectionDialog=void 0,this.unProtectDialog&&this.unProtectDialog.destroy(),this.unProtectDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.addedUser&&(this.addedUser.destroy(),this.addedUser=void 0),this.allowFormat&&(this.allowFormat.destroy(),this.allowFormat=void 0),this.protectionTypeDrop&&(this.protectionTypeDrop.destroy(),this.protectionTypeDrop=void 0),this.highlightCheckBox&&(this.highlightCheckBox.destroy(),this.highlightCheckBox=void 0),this.addUser&&(this.addUser.innerHTML="",this.addUser.remove(),this.addUser=void 0),this.restrictPane&&(this.restrictPane.innerHTML="",this.restrictPane.remove(),this.restrictPane=void 0),this.enforceProtection&&(this.enforceProtection.innerHTML="",this.enforceProtection.remove(),this.enforceProtection=void 0),this.stopProtection&&(this.stopProtection.innerHTML="",this.stopProtection.remove(),this.stopProtection=void 0),this.stopProtectionDiv&&(this.stopProtectionDiv.innerHTML="",this.stopProtectionDiv.remove(),this.stopProtectionDiv=void 0),this.stopReadOnlyOptions&&(this.stopReadOnlyOptions.innerHTML="",this.stopReadOnlyOptions.remove(),this.stopReadOnlyOptions=void 0),this.contentDiv1&&(this.contentDiv1.innerHTML="",this.contentDiv1.remove(),this.contentDiv1=void 0),this.contentDiv2&&(this.contentDiv2.innerHTML="",this.contentDiv2.remove(),this.contentDiv2=void 0),this.closeButton&&(this.closeButton.innerHTML="",this.closeButton.remove(),this.closeButton=void 0),this.userWholeDiv&&(this.userWholeDiv.innerHTML="",this.userWholeDiv.remove(),this.userWholeDiv=void 0),this.restrictPaneWholeDiv&&(this.restrictPaneWholeDiv.innerHTML="",this.restrictPaneWholeDiv.remove(),this.restrictPaneWholeDiv=void 0),this.usersCollection=[],this.usersCollection=void 0,this.previousProtectionType=void 0,this.currentHashValue=void 0,this.currentSaltValue=void 0,this.documentHelper=void 0},e}(),dl=m(570),hl=function(){function e(e){var t=this;this.applyTextFormFieldValueClickHandler=this.onApplyTextFormFieldValueClick.bind(this),this.applyDropDownFormFieldValueClickHandler=this.onApplyDropDownFormFieldValueClick.bind(this),this.closeButtonClickHandler=this.onCloseButtonClick.bind(this),this.applyDateFormFieldValueClickHandler=this.onApplyDateFormFieldValueClick.bind(this),this.applyNumberFormFieldValueClickHandler=this.onApplyNumberFormFieldValueClick.bind(this),this.applyTextFormFieldValue=function(){t.owner.editorModule.updateFormField(t.formField,t.textBoxInstance.value),t.owner.trigger(C,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup()},this.applyNumberFormFieldValue=function(){t.owner.editorModule.updateFormField(t.formField,t.numberInput.value.toString()),t.owner.trigger(C,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup()},this.applyDateFormFieldValue=function(){(0,a.isNullOrUndefined)(t.datePickerInstance.value)||(t.owner.editorModule.updateFormField(t.formField,t.dateInput.value),t.owner.trigger(C,{fieldName:t.formField.formFieldData.name,value:t.formField.resultText,isCanceled:!1}),t.hidePopup())},this.applyDropDownFormFieldValue=function(){t.owner.editorModule.updateFormField(t.formField,t.ddlInstance.index),t.owner.trigger(C,{fieldName:t.formField.formFieldData.name,value:t.formField.formFieldData.selectedIndex,isCanceled:!1}),t.hidePopup()},this.enableDisableDatePickerOkButton=function(e){e.isInteracted&&(t.dataPickerOkButton.disabled=!1)},this.closeButton=function(){var e=t.formField;t.hidePopup();var i={fieldName:e.formFieldData.name};e.formFieldData instanceof Gl?i.value=e.resultText:e.formFieldData instanceof Kl?i.value=e.formFieldData.checked:i.value=e.formFieldData.selectedIndex,i.isCanceled=!0,t.owner.trigger(C,i)},this.hidePopup=function(){t.owner.documentHelper.isFormFilling=!1,t.formField=void 0,t.target&&(t.target.style.display="none"),t.popupObject&&(t.popupObject.hide(),t.popupObject.destroy(),t.popupObject=void 0)},this.owner=e}return e.prototype.initPopup=function(){this.popupElement=(0,a.createElement)("div",{className:"e-de-form-popup"}),this.textBoxContainer=this.initTextBoxInput(),this.popupElement.appendChild(this.textBoxContainer),this.popupElement.appendChild(this.initNumericTextBox()),this.popupElement.appendChild(this.initDatePicker()),this.popupElement.appendChild(this.initDropDownList()),this.target=this.popupElement,this.owner.documentHelper.viewerContainer.appendChild(this.popupElement)},e.prototype.initTextBoxInput=function(){this.textBoxDiv=(0,a.createElement)("div",{className:"e-de-txt-field"});var e=(0,a.createElement)("input",{className:"e-de-txt-form"}),t=new rl.TextBox;return this.textBoxInput=e,this.textBoxButtonDiv=(0,a.createElement)("div",{className:"e-de-cmt-action-button"}),this.textBoxOkButton=(0,a.createElement)("button"),this.textBoxCancelButton=(0,a.createElement)("button"),this.textBoxOkButton.addEventListener("click",this.applyTextFormFieldValueClickHandler),this.textBoxCancelButton.addEventListener("click",this.closeButtonClickHandler),this.textBoxDiv.appendChild(e),this.textBoxButtonDiv.appendChild(this.textBoxOkButton),this.textBoxButtonDiv.appendChild(this.textBoxCancelButton),this.textBoxDiv.appendChild(this.textBoxButtonDiv),t.appendTo(e),new tl.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},this.textBoxOkButton),new tl.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},this.textBoxCancelButton),this.textBoxInstance=t,this.textBoxDiv},e.prototype.initNumericTextBox=function(){this.numericDiv=(0,a.createElement)("div",{className:"e-de-num-field"});var e=(0,a.createElement)("input",{className:"e-de-txt-form"}),t=new rl.NumericTextBox;return this.numberInput=e,this.textBoxButtonNumericDiv=(0,a.createElement)("div",{className:"e-de-cmt-action-button"}),this.textBoxOkButtonNumeric=(0,a.createElement)("button"),this.textBoxCancelButtonNumeric=(0,a.createElement)("button"),this.textBoxOkButtonNumeric.addEventListener("click",this.applyNumberFormFieldValueClickHandler),this.textBoxCancelButtonNumeric.addEventListener("click",this.closeButtonClickHandler),this.numericDiv.appendChild(e),this.textBoxButtonNumericDiv.appendChild(this.textBoxOkButtonNumeric),this.textBoxButtonNumericDiv.appendChild(this.textBoxCancelButtonNumeric),this.numericDiv.appendChild(this.textBoxButtonNumericDiv),t.appendTo(e),new tl.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},this.textBoxOkButtonNumeric),new tl.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},this.textBoxCancelButtonNumeric),this.numericTextBoxInstance=t,this.numericDiv},e.prototype.initDatePicker=function(){this.dateDiv=(0,a.createElement)("div",{className:"e-de-date-field"});var e=(0,a.createElement)("input",{className:"e-de-txt-form"}),t=new dl.DateTimePicker({strictMode:!0,change:this.enableDisableDatePickerOkButton});return this.dateInput=e,this.textBoxButtonDateDiv=(0,a.createElement)("div",{className:"e-de-cmt-action-button"}),this.textBoxOkButtonDate=(0,a.createElement)("button"),this.textBoxCancelButtonDate=(0,a.createElement)("button"),this.textBoxOkButtonDate.addEventListener("click",this.applyDateFormFieldValueClickHandler),this.textBoxCancelButtonDate.addEventListener("click",this.closeButtonClickHandler),this.dateDiv.appendChild(e),this.textBoxButtonDateDiv.appendChild(this.textBoxOkButtonDate),this.textBoxButtonDateDiv.appendChild(this.textBoxCancelButtonDate),this.dateDiv.appendChild(this.textBoxButtonDateDiv),t.appendTo(e),this.dataPickerOkButton=new tl.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},this.textBoxOkButtonDate),new tl.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},this.textBoxCancelButtonDate),this.datePickerInstance=t,this.dateDiv},e.prototype.initDropDownList=function(){this.dropDownDiv=(0,a.createElement)("div",{className:"e-de-ddl-field"});var e=(0,a.createElement)("input",{className:"e-de-txt-form"}),t=new al.DropDownList;return this.dropDownInput=e,this.textBoxButtonDropDownDiv=(0,a.createElement)("div",{className:"e-de-cmt-action-button"}),this.textBoxOkButtonDropDown=(0,a.createElement)("button"),this.textBoxCancelButtonDropDown=(0,a.createElement)("button"),this.textBoxOkButtonDropDown.addEventListener("click",this.applyDropDownFormFieldValueClickHandler),this.textBoxCancelButtonDropDown.addEventListener("click",this.closeButtonClickHandler),this.dropDownDiv.appendChild(e),this.textBoxButtonDropDownDiv.appendChild(this.textBoxOkButtonDropDown),this.textBoxButtonDropDownDiv.appendChild(this.textBoxCancelButtonDropDown),this.dropDownDiv.appendChild(this.textBoxButtonDropDownDiv),t.appendTo(e),new tl.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},this.textBoxOkButtonDropDown),new tl.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},this.textBoxCancelButtonDropDown),this.ddlInstance=t,this.dropDownDiv},e.prototype.onApplyTextFormFieldValueClick=function(){this.applyTextFormFieldValue()},e.prototype.onApplyNumberFormFieldValueClick=function(){this.applyNumberFormFieldValue()},e.prototype.onApplyDateFormFieldValueClick=function(){this.applyDateFormFieldValue()},e.prototype.onApplyDropDownFormFieldValueClick=function(){this.applyDropDownFormFieldValue()},e.prototype.showPopUp=function(e){var t=this;if(e){this.formField=e,this.owner.selectionModule.selectField(),(0,a.isNullOrUndefined)(this.target)&&this.initPopup(),(0,a.classList)(this.target,[],["e-de-txt-form","e-de-num-form","e-de-date-form","e-de-ddl-form"]);var i=e.formFieldData;if(i){if(i instanceof Gl){var n=e.resultText,r=RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===n.replace(r,"")&&(n="");var o,s=i.maxLength,l=i.type;if(n=n||"","Text"===l||"Calculation"===l)(0,a.classList)(this.target,["e-de-txt-form"],[]),o=this.textBoxInput,this.textBoxInstance.value=n;else if("Number"===i.type)(0,a.classList)(this.target,["e-de-num-form"],[]),o=this.numberInput,this.numericTextBoxInstance.format=i.format,this.numericTextBoxInstance.value=parseFloat(n.replace(/,/gi,""));else if("Date"===l){(0,a.classList)(this.target,["e-de-date-form"],[]),o=this.dateInput;var d=i.format;-1!==d.indexOf("am/pm")&&(d=d.replace(/am\/pm/gi,"a")),this.datePickerInstance.format=d,this.datePickerInstance.value=new Date(n),this.dataPickerOkButton.disabled=!0}o&&(s>0?o.maxLength=s:o.removeAttribute("maxlength"),setTimeout((function(){o.focus()})))}else i instanceof Xl&&((0,a.classList)(this.target,["e-de-ddl-form"],[]),this.ddlInstance.refresh(),this.ddlInstance.dataSource=i.dropdownItems,this.ddlInstance.index=i.selectedIndex,setTimeout((function(){t.ddlInstance.showPopup()}),50));var h=this.owner.selectionModule.getLeftInternal(e.line,e,0),c=e.line.height*this.owner.documentHelper.zoomFactor,p=this.owner.selectionModule.getTooltipPosition(e.line,h,this.target,!0);this.popupObject||(this.popupObject=new el.Popup(this.target,{height:"auto",width:"auto",relateTo:this.owner.documentHelper.viewerContainer.parentElement,position:{X:p.x,Y:p.y+c}})),this.target.style.display="block",this.popupObject.show()}this.owner.documentHelper.isFormFilling=!0}},e.prototype.onCloseButtonClick=function(){this.closeButton()},e.prototype.destroy=function(){this.formField&&this.formField.destroy(),this.formField=void 0,this.owner=void 0,this.removeEvents(),this.removeElements()},e.prototype.removeEvents=function(){this.textBoxOkButton&&this.textBoxOkButton.removeEventListener("click",this.applyTextFormFieldValueClickHandler),this.textBoxCancelButton&&this.textBoxCancelButton.removeEventListener("click",this.closeButtonClickHandler),this.textBoxOkButtonNumeric&&this.textBoxOkButtonNumeric.removeEventListener("click",this.applyNumberFormFieldValueClickHandler),this.textBoxCancelButtonNumeric&&this.textBoxCancelButtonNumeric.removeEventListener("click",this.closeButtonClickHandler),this.textBoxOkButtonDate&&this.textBoxOkButtonDate.removeEventListener("click",this.applyDateFormFieldValueClickHandler),this.textBoxCancelButtonDate&&this.textBoxCancelButtonDate.removeEventListener("click",this.closeButtonClickHandler),this.textBoxOkButtonDropDown&&this.textBoxOkButtonDropDown.removeEventListener("click",this.applyDropDownFormFieldValueClickHandler),this.textBoxCancelButtonDropDown&&this.textBoxCancelButtonDropDown.removeEventListener("click",this.closeButtonClickHandler)},e.prototype.removeElements=function(){this.popupElement&&(this.popupElement.remove(),this.popupElement=void 0),this.textBoxDiv&&(this.textBoxDiv.remove(),this.textBoxDiv=void 0),this.textBoxButtonDiv&&(this.textBoxButtonDiv.remove(),this.textBoxButtonDiv=void 0),this.textBoxOkButton&&(this.textBoxOkButton.remove(),this.textBoxOkButton=void 0),this.textBoxCancelButton&&(this.textBoxCancelButton.remove(),this.textBoxCancelButton=void 0),this.numericDiv&&(this.numericDiv.remove(),this.numericDiv=void 0),this.textBoxButtonNumericDiv&&(this.textBoxButtonNumericDiv.remove(),this.textBoxButtonNumericDiv=void 0),this.textBoxOkButtonNumeric&&(this.textBoxOkButtonNumeric.remove(),this.textBoxOkButtonNumeric=void 0),this.textBoxCancelButtonNumeric&&(this.textBoxCancelButtonNumeric.remove(),this.textBoxCancelButtonNumeric=void 0),this.dateDiv&&(this.dateDiv.remove(),this.dateDiv=void 0),this.textBoxButtonDateDiv&&(this.textBoxButtonDateDiv.remove(),this.textBoxButtonDateDiv=void 0),this.textBoxOkButtonDate&&(this.textBoxOkButtonDate.remove(),this.textBoxOkButtonDate=void 0),this.textBoxCancelButtonDate&&(this.textBoxCancelButtonDate.remove(),this.textBoxCancelButtonDate=void 0),this.dropDownDiv&&(this.dropDownDiv.remove(),this.dropDownDiv=void 0),this.textBoxButtonDropDownDiv&&(this.textBoxButtonDropDownDiv.remove(),this.textBoxButtonDropDownDiv=void 0),this.textBoxOkButtonDropDown&&(this.textBoxOkButtonDropDown.remove(),this.textBoxOkButtonDropDown=void 0),this.textBoxCancelButtonDropDown&&(this.textBoxCancelButtonDropDown.remove(),this.textBoxCancelButtonDropDown=void 0),this.target&&(this.target.remove(),this.target=void 0),this.textBoxContainer&&(this.textBoxContainer.remove(),this.textBoxContainer=void 0),this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.numberInput&&(this.numberInput.remove(),this.numberInput=void 0),this.dateInput&&(this.dateInput.remove(),this.dateInput=void 0),this.dropDownInput&&(this.dropDownInput.remove(),this.dropDownInput=void 0),this.numbericInput&&(this.numbericInput.remove(),this.numbericInput=void 0),this.popupObject&&(this.popupObject.destroy(),this.popupObject=void 0),this.textBoxInstance&&(this.textBoxInstance.destroy(),this.textBoxInstance=void 0),this.numericTextBoxInstance&&(this.numericTextBoxInstance.destroy(),this.numericTextBoxInstance=void 0),this.datePickerInstance&&(this.datePickerInstance.destroy(),this.datePickerInstance=void 0),this.ddlInstance&&(this.ddlInstance.destroy(),this.ddlInstance=void 0),this.dataPickerOkButton&&(this.dataPickerOkButton.destroy(),this.dataPickerOkButton=void 0)},e}(),cl=function(){function e(e){var t=this;this.applyDropDownFormFieldValueHandler=this.onapplyDropDownFormFieldValue.bind(this),this.closeButtonClickedHandler=this.onCloseButtonClicked.bind(this),this.applyDropDownFormFieldValue=function(){t.owner.editorModule.dropDownChange(t.contenControl,t.ddlInstance.text),t.hidePopup()},this.enableDisableDatePickerOkButton=function(e){e.isInteracted&&(t.dataPickerOkButton.disabled=!1)},this.closeButton=function(){t.hidePopup()},this.hidePopup=function(){t.contenControl=void 0,t.target&&(t.target.style.display="none"),t.popupObject&&(t.popupObject.hide(),t.popupObject.destroy(),t.popupObject=void 0)},this.owner=e}return e.prototype.initPopup=function(){this.popupElement=(0,a.createElement)("div",{className:"e-de-form-popup"}),this.popupElement.appendChild(this.initDropDownList()),this.target=this.popupElement,this.owner.documentHelper.viewerContainer.appendChild(this.popupElement)},e.prototype.initDropDownList=function(){this.dropDownDiv=(0,a.createElement)("div",{className:"e-de-ddl-field"});var e=(0,a.createElement)("input",{className:"e-de-txt-form"}),t=new al.DropDownList({fields:{text:"displayText"}});return this.dropDownInput=e,this.textBoxButtonDiv=(0,a.createElement)("div",{className:"e-de-cmt-action-button"}),this.textBoxOkButton=(0,a.createElement)("button"),this.textBoxCancelButton=(0,a.createElement)("button"),this.textBoxOkButton.addEventListener("click",this.applyDropDownFormFieldValueHandler),this.textBoxCancelButton.addEventListener("click",this.closeButtonClickedHandler),this.dropDownDiv.appendChild(e),this.textBoxButtonDiv.appendChild(this.textBoxOkButton),this.textBoxButtonDiv.appendChild(this.textBoxCancelButton),this.dropDownDiv.appendChild(this.textBoxButtonDiv),t.appendTo(e),new tl.Button({cssClass:"e-de-save e-primary",iconCss:"e-de-save-icon"},this.textBoxOkButton),new tl.Button({cssClass:"e-de-cancel",iconCss:"e-de-cancel-icon"},this.textBoxCancelButton),this.ddlInstance=t,this.dropDownDiv},e.prototype.onapplyDropDownFormFieldValue=function(){this.applyDropDownFormFieldValue()},e.prototype.showPopUp=function(e){var t=this;if(e){this.contenControl=e,(0,a.isNullOrUndefined)(this.target)&&this.initPopup(),(0,a.classList)(this.target,[],["e-de-txt-form","e-de-num-form","e-de-date-form","e-de-ddl-form"]),(0,a.classList)(this.target,["e-de-ddl-form"],[]),this.ddlInstance.refresh();var i=e.contentControlProperties.contentControlListItems.map((function(e){var t={};for(var i in e)t[""+i]=e[""+i];return t}));this.ddlInstance.dataSource=i,setTimeout((function(){t.ddlInstance.showPopup()}),50);var n=this.owner.selectionModule.getLeftInternal(e.line,e,0),r=e.line.height*this.owner.documentHelper.zoomFactor,o=this.owner.selectionModule.getTooltipPosition(e.line,n,this.target,!0);this.popupObject||(this.popupObject=new el.Popup(this.target,{height:"auto",width:"auto",relateTo:this.owner.documentHelper.viewerContainer.parentElement,position:{X:o.x,Y:o.y+r}})),this.target.style.display="block",this.popupObject.show()}},e.prototype.onCloseButtonClicked=function(){this.closeButton()},e.prototype.destroy=function(){this.contenControl&&this.contenControl.destroy(),this.removeEvents(),this.removeElements(),this.contenControl=void 0,this.owner=void 0},e.prototype.removeEvents=function(){this.textBoxOkButton&&this.textBoxOkButton.removeEventListener("click",this.applyDropDownFormFieldValueHandler),this.textBoxCancelButton&&this.textBoxCancelButton.removeEventListener("click",this.closeButtonClickedHandler)},e.prototype.removeElements=function(){this.target&&this.target.remove(),this.dataPickerOkButton&&this.dataPickerOkButton.element&&this.dataPickerOkButton.element.parentNode&&(this.dataPickerOkButton.destroy(),this.dataPickerOkButton=void 0),this.ddlInstance&&(this.ddlInstance.destroy(),this.ddlInstance=void 0),this.dataPickerOkButton&&(this.dataPickerOkButton.destroy(),this.dataPickerOkButton=void 0),this.popupElement&&(this.popupElement.remove(),this.popupElement=void 0),this.dropDownDiv&&(this.dropDownDiv.remove(),this.dropDownDiv=void 0),this.textBoxButtonDiv&&(this.textBoxButtonDiv.remove(),this.textBoxButtonDiv=void 0),this.textBoxOkButton&&(this.textBoxOkButton.remove(),this.textBoxOkButton=void 0),this.textBoxCancelButton&&(this.textBoxCancelButton.remove(),this.textBoxCancelButton=void 0),this.target=void 0,this.dropDownInput=void 0,this.ddlInstance=void 0,this.dropDownDiv=void 0,this.textBoxButtonDiv=void 0,this.textBoxOkButton=void 0,this.textBoxCancelButton=void 0},e}(),pl=m(295),ul=function(){function e(e,t){this.users=[],this.enableButtons=!0,this.viewTypeitems=[],this.sortedRevisions=[],this.noChangesVisibleInternal=!0,this.isTrackingPageBreak=!1,this.tableRevisions=new l,this.owner=e,this.commentReviewPane=t,this.locale=new a.L10n("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.selectedUser=this.locale.getConstant("All"),this.selectedType=this.locale.getConstant("All"),this.initTrackChangePane(),this.commentReviewPane.reviewTab.items[1].content=this.trackChangeDiv,a.Browser.isIE||this.commentReviewPane.reviewTab.refresh(),this.owner.enableRtl?this.closeButton=(0,a.createElement)("button",{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;left:1px"}}):this.closeButton=(0,a.createElement)("button",{className:"e-de-close-icon e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button",style:"position:absolute;top:6px;right:1px"}}),this.closeButton.title=this.locale.getConstant("Close"),this.closeButton.setAttribute("aria-label",this.locale.getConstant("Close"));var i=(0,a.createElement)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(i),this.commentReviewPane.reviewTab.element.appendChild(this.closeButton),this.closeButton.addEventListener("click",this.commentReviewPane.closePane.bind(this.commentReviewPane))}return Object.defineProperty(e.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(e){this.isChangesTabVisible=!e,this.noChangeDivElement.style.display=e?"block":"none",this.noChangesVisibleInternal=e,this.enableDisableToolbarItem(!e),this.commentReviewPane.reviewTab.hideTab(1,e),this.owner.notify("reviewPane",{changes:!e,comment:this.commentReviewPane.isCommentTabVisible})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){var t=(0,a.select)(".e-de-trckchanges-inner-select",this.changesInfoDiv);if((0,a.isNullOrUndefined)(e))(0,a.isNullOrUndefined)(t)||t.classList.remove("e-de-trckchanges-inner-select");else if(e!==this.currentSelectedRevisionInternal||(0,a.isNullOrUndefined)(t)){if(t&&t.classList.remove("e-de-trckchanges-inner-select"),this.changes.length>0&&this.changes.containsKey(e))this.changes.get(e).singleInnerDiv.classList.add("e-de-trckchanges-inner-select")}this.currentSelectedRevisionInternal=e,t=(0,a.select)(".e-de-trckchanges-inner-select",this.changesInfoDiv),(0,a.isNullOrUndefined)(t)||t.parentElement.scrollIntoView({block:"nearest"})},enumerable:!0,configurable:!0}),e.prototype.initTrackChangePane=function(){this.changes=new l,this.renderedChanges=new l,this.trackChangeDiv=(0,a.createElement)("div",{className:"e-de-tc-pane"}),this.trackChangeDiv.appendChild(this.initPaneHeader()),this.changesInfoDiv=(0,a.createElement)("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto",className:this.owner.documentEditorSettings.showHiddenMarks?"":"e-de-tc-hide-para-mark"}),this.trackChangeDiv.appendChild(this.changesInfoDiv),this.noChangeDivElement=(0,a.createElement)("div",{styles:"display:none;",className:"e-de-tc-no-chng"}),this.noChangeDivElement.textContent=this.locale.getConstant("No changes"),this.changesInfoDiv.appendChild(this.noChangeDivElement),this.updateTrackChanges()},e.prototype.showHiddenParaMark=function(){this.owner.documentEditorSettings.showHiddenMarks?this.changesInfoDiv.classList.contains("e-de-tc-hide-para-mark")&&this.changesInfoDiv.classList.remove("e-de-tc-hide-para-mark"):this.changesInfoDiv.classList.contains("e-de-tc-hide-para-mark")||this.changesInfoDiv.classList.add("e-de-tc-hide-para-mark")},e.prototype.initPaneHeader=function(){var e=this;this.toolbarElement=(0,a.createElement)("div",{className:"e-de-track-toolbar"}),this.toolbar=new ua.Toolbar({enableRtl:this.owner.enableRtl,items:[{text:this.locale.getConstant("User")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:(0,a.createElement)("div",{id:"e-de-user-list",attrs:{role:"button"}})},{type:"Separator"},{text:this.locale.getConstant("View")+":",cssClass:"e-de-track-toolbar-overlay",disabled:!0},{template:(0,a.createElement)("div",{id:"e-de-revision-list",attrs:{role:"button"}})},{prefixIcon:"e-de-nav-left-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-left",tooltipText:this.locale.getConstant("Previous Changes"),click:this.navigatePreviousChanges.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-tc-tbr",align:"Right",cssClass:"e-de-nvgte-right",tooltipText:this.locale.getConstant("Next Changes"),click:this.navigateNextChanges.bind(this)},{template:(0,a.createElement)("div",{id:"e-de-menu-option",attrs:{role:"button"}}),align:"Right",cssClass:"e-de-tc-tbr",tooltipText:this.locale.getConstant("More Options")+"..."}]}),this.toolbar.appendTo(this.toolbarElement),(0,a.select)(".e-de-nvgte-left",this.toolbarElement).firstChild.classList.add("e-tc-nvgte"),(0,a.select)(".e-de-nvgte-right",this.toolbarElement).firstChild.classList.add("e-tc-nvgte");var t=(0,a.select)("#e-de-user-list",this.toolbarElement);this.userDropDownitems=[{text:this.locale.getConstant("All")}],this.userDropDown={items:this.userDropDownitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onUserSelect.bind(this),beforeOpen:this.onUserOpen.bind(this),beforeItemRender:function(t){e.beforeDropDownItemRender(t,e.selectedUser)}},this.userDropDownButton=new pl.DropDownButton(this.userDropDown),this.userDropDownButton.appendTo(t),this.userDropDownButton.content=this.getSpanView(this.userDropDown.items[0].text,0);var i=(0,a.select)("#e-de-revision-list",this.toolbarElement);this.viewTypeitems=[{text:this.locale.getConstant("All")},{text:this.locale.getConstant("Inserted")},{text:this.locale.getConstant("Deleted")}],this.viewTypeDropDownButton=new pl.DropDownButton({items:this.viewTypeitems,cssClass:"e-de-track-pane-drop-btn e-tc-btn-bg-clr",select:this.onTypeSelect.bind(this),beforeItemRender:function(t){e.beforeDropDownItemRender(t,e.selectedType)}}),this.viewTypeDropDownButton.content=this.getSpanView(this.viewTypeitems[0].text,1),this.viewTypeDropDownButton.appendTo(i),this.menuoptionEle=(0,a.select)("#e-de-menu-option",this.toolbarElement);var n={items:[{text:this.locale.getConstant("Accept all")},{text:this.locale.getConstant("Reject all")}],select:this.onMenuSelect.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide e-tc-btn-bg-clr"};return this.menuDropDownButton=new pl.DropDownButton(n),this.menuDropDownButton.appendTo(this.menuoptionEle),this.toolbarElement},e.prototype.beforeDropDownItemRender=function(e,t){e.element.innerHTML="<span></span>"+e.item.text;var i=e.element.children[0];e.item.text===t?(i.style.marginRight="10px",i.style.alignSelf="center",i.setAttribute("class","e-de-selected-item e-icons")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))},e.prototype.onUserOpen=function(e){var t=e.element;t.style.maxHeight="200px",t.style.overflowY="auto"},e.prototype.enableDisableToolbarItem=function(e){var t=this.toolbar.element.querySelectorAll(".e-de-tc-tbr");this.owner&&this.owner.viewer&&(this.toolbar.enableItems(t[0].parentElement.parentElement,e),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2],e))},e.prototype.getSpanView=function(e,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+e+"</span>"},e.prototype.onMenuSelect=function(e){var t=this,i=e.item.text;i.match(this.locale.getConstant("Accept all"))?setTimeout((function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)}),0):i.match(this.locale.getConstant("Reject all"))&&setTimeout((function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)}),0),this.updateUsers()},e.prototype.onSelection=function(e){this.currentSelectedRevision=e},e.prototype.onUserSelect=function(e){var t=e.item.text;this.selectedUser=t,this.userDropDownButton.content=this.getSpanView(t,0),this.sortCollectionToDisplay()},e.prototype.onTypeSelect=function(e){var t=e.item.text;this.selectedType=t,this.viewTypeDropDownButton.content=this.getSpanView(t,1),this.sortCollectionToDisplay()},e.prototype.updateMenuOptions=function(){var e;this.selectedType!==this.locale.getConstant("All")&&(e=this.selectedType===this.locale.getConstant("Inserted")?this.locale.getConstant("Insertion"):this.locale.getConstant("Deletion")),this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes"),this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")):this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e):this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+this.locale.getConstant("Changes")+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser):(this.menuDropDownButton.items[0].text=this.locale.getConstant("Accept all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser,this.menuDropDownButton.items[1].text=this.locale.getConstant("Reject all")+" "+e+" "+this.locale.getConstant("By").toLowerCase()+" "+this.selectedUser),this.owner.documentHelper.isDocumentProtected||this.owner.isReadOnly?this.menuDropDownButton.disabled=!0:this.menuDropDownButton.disabled=!1},e.prototype.sortCollectionToDisplay=function(){var e=!1;this.sortedRevisions=[],this.updateMenuOptions();for(var t=0;t<this.changes.length;t++){var i=this.changes.get(this.revisions[t]),n=i.outerSingleDiv;this.selectedUser===this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?n.style.display="block":this.selectedUser===this.locale.getConstant("All")&&this.selectedType!==this.locale.getConstant("All")?this.locale.getConstant(i.revisionType)===this.selectedType?n.style.display="block":n.style.display="none":this.selectedUser!==this.locale.getConstant("All")&&this.selectedType===this.locale.getConstant("All")?i.user===this.selectedUser?n.style.display="block":n.style.display="none":i.user===this.selectedUser&&this.locale.getConstant(i.revisionType)===this.selectedType?n.style.display="block":n.style.display="none","block"===n.style.display&&this.sortedRevisions.push(this.revisions[t]),e=!0}this.setNoChangesVisibility=!e},e.prototype.enableDisableButton=function(e){this.enableButtons=e,this.updateTrackChanges()},e.prototype.isUpdateTrackChanges=function(e){var t=!1,i=!1;return(0,a.isNullOrUndefined)(this.changesInfoDiv)||(1===this.changesInfoDiv.childNodes.length&&"e-de-tc-no-chng"==this.changesInfoDiv.childNodes[0].className?i=!0:e!==this.changesInfoDiv.childNodes.length&&(t=!0)),(i||e>0)&&(t=!0),t},e.prototype.updateCurrentTrackChanges=function(e){var t;if((0,a.isNullOrUndefined)(e)||(t=this.owner.trackChangesPane.changes.get(e)),!(0,a.isNullOrUndefined)(t)&&e.range.length>0){for(var i=t.singleInnerDiv.querySelector("#textDiv");i.firstChild;)t.removeInnerChilds(i.firstChild),i.removeChild(i.firstChild);t.layoutElementText(e.range,i)}(0,a.isNullOrUndefined)(e)||0!==e.range.length||this.owner.revisions.remove(e)},e.prototype.updateTrackChanges=function(e){if(e||(0,a.isNullOrUndefined)(e)){if(this.owner.isUpdateTrackChanges){for(var t=0;t<this.tableRevisions.keys.length;t++){var i=this.tableRevisions.keys[t],n=this.revisions.indexOf(i),r=this.tableRevisions.get(i)[this.tableRevisions.get(i).length-1]===i;if(!(0,a.isNullOrUndefined)(this.changes)){this.changes.get(i);if(r&&!(0,a.isNullOrUndefined)(this.changesInfoDiv)){var o=this.changes.get(i);o.removeEvents(),o.removeInnerChilds(o.outerSingleDiv),this.changesInfoDiv.removeChild(o.outerSingleDiv)}}this.renderedChanges.containsKey(i)&&this.renderedChanges.remove(i),this.changes.containsKey(i)&&this.changes.remove(i),this.revisions.splice(n,1)}this.tableRevisions.clear()}else this.tableRevisions.clear(),this.renderedChanges.clear(),this.removeAllChanges();if(this.enableButtons||this.menuoptionEle.classList.contains("e-de-overlay")?!this.menuoptionEle.classList.contains("e-de-overlay")||this.owner.documentHelper.isDocumentProtected||this.owner.isReadOnly||this.menuoptionEle.classList.remove("e-de-overlay"):this.menuoptionEle.classList.add("e-de-overlay"),this.isChangesTabVisible=!0,this.owner.notify("reviewPane",{comment:this.commentReviewPane.isCommentTabVisible,changes:this.isChangesTabVisible}),this.owner.isUpdateTrackChanges){var s=0;for(t=0;t<this.owner.revisions.changes.length;t++){i=this.owner.revisions.changes[t],h=this.owner.revisions.changes[t].range[0];if(this.changes.containsKey(i)){var l=this.renderedChanges.get(i);if((0,a.isNullOrUndefined)(l))continue;this.enableButtons?l.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(l.acceptButtonElement.classList.remove("e-de-overlay"),l.rejectButtonElement.classList.remove("e-de-overlay")):l.acceptButtonElement.classList.contains("e-de-overlay")||(l.acceptButtonElement.classList.add("e-de-overlay"),l.rejectButtonElement.classList.add("e-de-overlay")),s++}else{if(h instanceof Ca)if((c=this.groupTableRevisions(this.owner.revisions.changes,t)).length>1){0===s&&(s=t);for(p=void 0,u=0;u<c.length;u++){g=c[u];if(0===u){l=new gl(this.owner,this);this.changesInfoDiv.insertBefore(l.createSingleChangesDiv(g),this.changesInfoDiv.children[s+1]),this.revisions.splice(t,0,g),this.changes.add(g,l),this.renderedChanges.add(g,l),p=this.changes.get(i)}else{m=g.range[0];p.appendRowToTable(m,u),this.revisions.splice(t+u,0,g),this.changes.add(g,p)}this.tableRevisions.add(g,c)}s++}else{l=new gl(this.owner,this);this.changesInfoDiv.insertBefore(l.createSingleChangesDiv(i),this.changesInfoDiv.children[t+1]),this.revisions.splice(t,0,i),this.changes.add(i,l),this.renderedChanges.add(i,l),this.tableRevisions.add(i,c)}}}var d=document.getElementsByClassName("e-de-track-chngs-count").length;for(t=0;t<d;t++){document.getElementsByClassName("e-de-track-chngs-count")[t].innerHTML=this.locale.getConstant("Changes")+" "+(t+1).toString()+" "+this.locale.getConstant("of")+" "+d.toString()}}else{for(var t=0;t<this.owner.revisions.changes.length;t++){var h,c,i=this.owner.revisions.changes[t];if(!(((h=this.owner.revisions.changes[t].range[0])instanceof Zl||h instanceof _l)&&h.paragraph.containerWidget instanceof Bl&&(0,a.isNullOrUndefined)(h.paragraph.containerWidget.sectionFormat)))if(!this.changes.containsKey(i))if(h instanceof Ca)if((c=this.groupTableRevisions(this.owner.revisions.changes,t)).length>1)for(var p=void 0,u=0;u<c.length;u++){var g=c[u];if(0===u)this.addChanges(g),p=this.changes.get(i);else{var m=g.range[0];p.appendRowToTable(m,u),this.revisions.push(g),this.changes.add(g,p)}this.tableRevisions.add(g,c)}else this.addChanges(i);else this.addChanges(i)}for(var t=0;t<this.renderedChanges.keys.length;t++){(p=this.renderedChanges.get(this.renderedChanges.keys[t])).updateRevisionIndexAndCount(t+1,this.renderedChanges.keys.length)}}this.sortCollectionToDisplay(),this.updateUsers(),e&&(this.currentSelectedRevision=this.currentSelectedRevisionInternal,this.updateHeight(),this.owner.resize())}else this.currentSelectedRevision=void 0},e.prototype.groupTableRevisions=function(e,t){for(var i=e[t],n=[i],r=i.revisionType,o=i.range[0].ownerBase,s=o.ownerTable,l=o.index,d=this.owner.documentHelper.layout.getParentTable(s),h=t+1;h<e.length;h++){var c=e[h],p=c.revisionType,u=c.range[0];if(!(u instanceof Ca)){var g=void 0;if(u instanceof ka?g=u.ownerBase:u instanceof ql&&(g=u.line.paragraph),g instanceof Rl&&g.isInsideTable){v=g.associatedCell.ownerTable;var m=this.owner.documentHelper.layout.getParentTable(v);if(s.equals(v)||!s.equals(v)&&!(0,a.isNullOrUndefined)(d)&&d.equals(m))continue}break}var f=u.ownerBase,v=f.ownerTable,y=f.index;if(s.equals(v)||(0,a.isNullOrUndefined)(d)||!d.equals(this.owner.documentHelper.layout.getParentTable(v))){if(r!==p||i.author!==c.author||!s.equals(v)||l+1!==y)break;n.push(c),l=y}}return n},e.prototype.updateUsers=function(){this.users.length>0&&(this.userDropDownButton.removeItems(this.users),this.users=[]);for(var e=0;e<this.revisions.length;e++)-1===this.users.indexOf(this.revisions[e].author)&&(this.users.push(this.revisions[e].author),this.userDropDownButton.items.push({text:this.revisions[e].author}))},e.prototype.updateHeight=function(){var e=this.commentReviewPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.changesInfoDiv.style.height=this.commentReviewPane.parentPaneElement.clientHeight-this.toolbarElement.clientHeight-e-2+"px"},e.prototype.removeAllChanges=function(){for(;this.changesInfoDiv.childNodes.length>1;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);if(this.revisions=[],this.changes&&this.changes.length>0){for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).clear()}this.changes.clear()}},e.prototype.clear=function(){this.removeAllChanges(),this.selectedUser=this.locale.getConstant("All"),this.userDropDownButton.content=this.getSpanView(this.selectedUser,0),this.selectedType=this.locale.getConstant("All"),this.viewTypeDropDownButton.content=this.getSpanView(this.selectedType,1),this.currentSelectedRevision=void 0},e.prototype.destroy=function(){if(this.changes&&this.changes.length>0){for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).destroy()}this.changes.clear()}this.changes=void 0,this.toolbar&&(this.toolbar.destroy(),this.toolbar=void 0),this.closeButton&&this.closeButton.parentElement&&this.closeButton.parentElement.removeChild(this.closeButton),this.closeButton=void 0,this.userDropDownButton&&(this.userDropDownButton.destroy(),this.userDropDownButton=void 0),this.menuDropDownButton&&(this.menuDropDownButton.destroy(),this.menuDropDownButton=void 0),this.viewTypeDropDownButton&&(this.viewTypeDropDownButton.destroy(),this.viewTypeDropDownButton=void 0),this.userDropDown&&(this.userDropDown=void 0),this.users.length>0&&(this.users=[],this.users=void 0),this.trackChangeDiv&&(this.trackChangeDiv.innerHTML="",this.trackChangeDiv.parentElement&&this.trackChangeDiv.parentElement.removeChild(this.trackChangeDiv)),this.trackChangeDiv=void 0,this.changesInfoDiv&&(this.changesInfoDiv.innerHTML="",this.changesInfoDiv.parentElement&&this.changesInfoDiv.parentElement.removeChild(this.changesInfoDiv)),this.changesInfoDiv=void 0,this.commentReviewPane&&(this.commentReviewPane=void 0),this.tableRevisions&&(this.tableRevisions.destroy(),this.tableRevisions=void 0),this.renderedChanges&&(this.renderedChanges.destroy(),this.renderedChanges=void 0),this.currentSelectedRevisionInternal=void 0,this.selectedUser=void 0,this.selectedType=void 0,this.sortedRevisions=[],this.sortedRevisions=void 0,this.viewTypeitems=[],this.viewTypeitems=void 0,this.userDropDownitems=[],this.userDropDownitems=void 0,this.revisions=[],this.revisions=void 0,this.owner=void 0},e.prototype.addChanges=function(e){var t=new gl(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(e)),this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay")),this.revisions.push(e),this.changes.add(e,t),this.renderedChanges.add(e,t)},e.prototype.navigatePreviousChanges=function(){this.revisionNavigateInternal(!1)},e.prototype.navigateNextChanges=function(){this.revisionNavigateInternal(!0)},e.prototype.revisionNavigateInternal=function(e){var t=this.renderedChanges.keys;if(!this.currentSelectedRevisionInternal){if(0===t.length)return;this.currentSelectedRevision=t[0]}if(this.currentSelectedRevision){var i=t,n=this.currentSelectedRevision,r=i.indexOf(n);if(n=e?r===i.length-1?i[0]:i[r+1]:0===r?i[i.length-1]:i[r-1],this.owner.documentHelper.currentSelectedRevision=n,n.range[0]instanceof Ca){var o=this.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(n));this.owner.selectionModule.selectTableRevision(o)}else this.owner.selectionModule.selectRevision(n)}this.currentSelectedRevision=this.owner.documentHelper.currentSelectedRevision},e}(),gl=function(){function e(e,t){this.selectRevisionHandler=this.selectRevision.bind(this),this.acceptButtonClickHandler=this.acceptButtonClick.bind(this),this.rejectButtonClickHandler=this.rejectButtonClick.bind(this),this.owner=e,this.locale=new a.L10n("documenteditor",this.owner.defaultLocale),this.locale.setLocale(this.owner.locale),this.trackChangesPane=t}return e.prototype.updateRevisionIndexAndCount=function(e,t){this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+e.toString()+" "+this.locale.getConstant("of")+" "+t.toString()},e.prototype.createSingleChangesDiv=function(e){this.revision=e,this.user=e.author,this.outerSingleDiv=(0,a.createElement)("div",{className:"e-de-tc-outer"}),this.singleInnerDiv=(0,a.createElement)("div",{className:"e-de-trckchanges-inner"}),this.singleInnerDiv.addEventListener("click",this.selectRevisionHandler),this.outerSingleDiv.appendChild(this.singleInnerDiv);var t=(0,a.createElement)("div",{className:"e-de-track-usernme-div"}),i=(0,a.createElement)("div",{className:"e-de-track-user-nme"});i.textContent=a.SanitizeHtmlHelper.sanitize(e.author),(0,a.isNullOrUndefined)(e.author)||(t.style.display="flex",this.owner.documentHelper.getAvatar(t,i,void 0,e));var n=(0,a.createElement)("div");"Insertion"===e.revisionType?(this.revisionType="Inserted",n.innerHTML=this.locale.getConstant("Inserted").toUpperCase(),n.classList.add("e-de-track-insert")):"Deletion"===e.revisionType?(this.revisionType="Deleted",n.innerHTML=this.locale.getConstant("Deleted").toUpperCase(),n.classList.add("e-de-track-delete")):"MoveFrom"===e.revisionType?(this.revisionType="MoveFrom",n.innerHTML=this.locale.getConstant("Move From").toUpperCase(),n.classList.add("e-de-track-delete"),n.style.whiteSpace="nowrap"):"MoveTo"===e.revisionType&&(this.revisionType="MoveTo",n.innerHTML=this.locale.getConstant("Move To").toUpperCase(),n.classList.add("e-de-track-insert"),n.style.whiteSpace="nowrap"),t.appendChild(n),this.singleInnerDiv.appendChild(t);var r=(0,a.createElement)("div",{className:"e-de-track-date",innerHTML:Pa.getModifiedDate(e.date)});this.singleInnerDiv.appendChild(r);var o=(0,a.createElement)("div",{id:"textDiv",className:"e-de-track-chngs-text"});this.layoutElementText(e.range,o),this.singleInnerDiv.appendChild(o);var s=(0,a.createElement)("div",{styles:"display:inline-block;width:100%"});this.singleInnerDiv.appendChild(s);var l=(0,a.createElement)("div",{styles:"float:left;"});this.acceptButtonElement=(0,a.createElement)("button",{className:"e-de-track-accept-button"}),this.acceptButton=new tl.Button({cssClass:"e-outline e-success",content:this.locale.getConstant("Accept")}),this.acceptButtonElement.setAttribute("aria-label",this.locale.getConstant("Accept")),l.appendChild(this.acceptButtonElement),s.appendChild(l),this.acceptButton.appendTo(this.acceptButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.acceptButtonElement.classList.add("e-de-overlay"),this.acceptButtonElement.addEventListener("click",this.acceptButtonClickHandler),l=(0,a.createElement)("div",{styles:"float:left;"}),this.rejectButtonElement=(0,a.createElement)("button",{className:"e-de-track-reject-button"}),this.rejectButton=new tl.Button({cssClass:"e-outline e-danger",content:this.locale.getConstant("Reject")}),this.rejectButtonElement.setAttribute("aria-label",this.locale.getConstant("Reject")),l.appendChild(this.rejectButtonElement),s.appendChild(l),this.rejectButton.appendTo(this.rejectButtonElement),this.owner.documentHelper.isTrackedOnlyMode&&this.rejectButtonElement.classList.add("e-de-overlay"),this.rejectButtonElement.addEventListener("click",this.rejectButtonClickHandler),this.changesCount=(0,a.createElement)("div",{className:"e-de-track-chngs-count",styles:"float:right;"});var d=this.owner.revisions.changes.indexOf(e)+1,h=this.owner.revisions.changes.length;return this.changesCount.innerHTML=this.locale.getConstant("Changes")+" "+d.toString()+" "+this.locale.getConstant("of")+" "+h.toString(),s.appendChild(this.changesCount),this.outerSingleDiv},e.prototype.appendRowToTable=function(e,t){this.tableElement.insertRow();for(var i=0;i<e.ownerBase.childWidgets.length;i++)this.tableElement.rows[t].insertCell(),this.tableElement.rows[t].cells[i].classList.add("e-de-tc-tble-cell")},e.prototype.selectRevision=function(){if(this.revision.range[0]instanceof Ca){var e=this.trackChangesPane.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(this.revision));this.owner.selectionModule.selectTableRevision(e)}else this.owner.selectionModule.selectRevision(this.revision),this.trackChangesPane.onSelection(this.revision)},e.prototype.layoutElementText=function(e,t){t.style.width="100%";for(var i="",n=!1,r=!1,o=0;o<e.length;o++){var s=e[o];if(s instanceof _l&&1===s.fieldType)n=!1;else{if(s instanceof _l&&0===s.fieldType)(l=this.owner.selectionModule.getFieldCode(s)).match("HYPERLINK ")&&e[e.indexOf(s.fieldEnd)-1]instanceof Zl&&(r=!0);if(r&&s instanceof _l&&(2===s.fieldType||1===s.fieldType))n=!1,r=!1;else if(!(n||s instanceof yd))if(s instanceof _l&&0===s.fieldType&&(n=!0),s instanceof Zl)i+=s.text;else if(s instanceof _l&&0===s.fieldType){var l;if((l=this.owner.selectionModule.getFieldCode(s)).match("TOC ")||l.match("Toc"))return i+="<Table of Content>",void t.appendChild(this.addSpan(i));if(l.match("HYPERLINK ")&&!r||l.match("MERGEFIELD")||l.match("FORMTEXT")||l.match("PAGE "))i+=this.owner.editorModule.retrieveFieldResultantText(s.fieldEnd);else if(s.formFieldData){var d=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5);""!==i&&(t.appendChild(this.addSpan(i)),i=""),s.formFieldData instanceof Gl?t.appendChild(this.addSpan(""===s.formFieldData.defaultValue?d:s.formFieldData.defaultValue,"e-de-tc-field")):s.formFieldData instanceof Xl?t.appendChild(this.addSpan(s.formFieldData.dropdownItems.length>0?s.formFieldData.dropdownItems[0]:d,"e-de-tc-field")):t.appendChild(this.addSpan(s.formFieldData.checked?String.fromCharCode(9745):String.fromCharCode(9744),"e-de-tc-field"))}}else if(s instanceof gd){""!==i&&(t.appendChild(this.addSpan(i)),i="");var h=(0,a.createElement)("img");h.setAttribute("src",this.owner.documentHelper.getImageString(s)),h.classList.add("e-de-tc-shrink-img"),t.appendChild(h)}else{if(s instanceof Ca){this.tableElement=(0,a.createElement)("table"),this.tableElement.classList.add("e-de-track-chng-table"),this.tableElement.insertRow();for(var c=0;c<s.ownerBase.childWidgets.length;c++)this.tableElement.rows[0].insertCell(),this.tableElement.rows[0].cells[c].classList.add("e-de-tc-tble-cell");return void t.appendChild(this.tableElement)}if(s instanceof ka){""!==i&&(t.appendChild(this.addSpan(i)),i="");var p="¶";s.ownerBase instanceof Rl&&s.ownerBase.isEndsWithPageBreak&&(p="............Page Break............"+p),t.appendChild(this.addSpan(p,"e-de-tc-pmark")),t.appendChild((0,a.createElement)("br"))}}}}t.appendChild(this.addSpan(i))},e.prototype.addSpan=function(e,t){var i=(0,a.createElement)("span");return i.textContent=e,t&&i.classList.add(t),i},e.prototype.acceptButtonClick=function(){this.revision.accept(),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget()},e.prototype.rejectButtonClick=function(){this.revision.reject(),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget()},e.prototype.removeFromParentCollec=function(){this.trackChangesPane.changes.containsKey(this.revision)&&this.trackChangesPane.changes.remove(this.revision),-1!==this.trackChangesPane.revisions.indexOf(this.revision)&&this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1),0===this.trackChangesPane.changes.length&&(this.trackChangesPane.setNoChangesVisibility=!0),this.trackChangesPane.updateUsers()},e.prototype.removeInnerChilds=function(e){if(e)for(;e.firstChild;)e.firstChild.childNodes.length>0&&this.removeInnerChilds(e.firstChild),e.removeChild(e.firstChild)},e.prototype.removeEvents=function(){this.outerSingleDiv&&this.outerSingleDiv.removeEventListener("click",this.selectRevisionHandler),this.acceptButtonElement&&this.acceptButtonElement.removeEventListener("click",this.acceptButtonClickHandler),this.rejectButtonElement&&this.rejectButtonElement.removeEventListener("click",this.rejectButtonClickHandler)},e.prototype.clear=function(){this.removeFromParentCollec(),this.removeEvents(),this.removeInnerChilds(this.outerSingleDiv),this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0)},e.prototype.destroy=function(){this.removeEvents(),this.removeInnerChilds(this.outerSingleDiv),this.acceptButton&&(this.acceptButton.destroy(),this.acceptButton=void 0),this.rejectButton&&(this.rejectButton.destroy(),this.rejectButton=void 0),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0),this.revision=void 0,this.user=void 0,this.revisionType=void 0,this.trackChangesPane=void 0,this.owner=void 0},e}(),ml=function(){function e(){this.fntTypeface=new l,this.fntSchemeList=[],this.fntTypeface=new l,this.fntSchemeList=[]}return Object.defineProperty(e.prototype,"fontTypeface",{get:function(){return this.fntTypeface},set:function(e){this.fntTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSchemeList",{get:function(){return this.fntSchemeList},set:function(e){this.fntSchemeList=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(this.fntTypeface=e.fntTypeface,this.fntSchemeList=e.fntSchemeList)},e.prototype.destroy=function(){this.fntTypeface=void 0,this.fntSchemeList=void 0},e}(),fl=function(){function e(e){this.majFontScheme=new ml,this.minFontScheme=new ml}return Object.defineProperty(e.prototype,"fontSchemeName",{get:function(){return this.schemeName},set:function(e){this.schemeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorFontScheme",{get:function(){return this.majFontScheme},set:function(e){this.majFontScheme=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorFontScheme",{get:function(){return this.minFontScheme},set:function(e){this.minFontScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(this.schemeName=e.schemeName,this.majFontScheme.copyFormat(e.majFontScheme),this.minFontScheme.copyFormat(e.minFontScheme))},e.prototype.destroy=function(){this.schemeName=void 0,this.majFontScheme=void 0,this.minFontScheme=void 0},e}(),vl=function(){function e(){}return Object.defineProperty(e.prototype,"name",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeface",{get:function(){return this.fontTypeface},set:function(e){this.fontTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panose",{get:function(){return this.pnose},set:function(e){this.pnose=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||(this.fontName=e.fontName,this.fontTypeface=e.fontTypeface,this.pnose=e.panose)},e.prototype.destroy=function(){this.fontName=void 0,this.fontTypeface=void 0,this.pnose=void 0},e}(),yl=function(){function e(e){this.fntScheme=new fl}return Object.defineProperty(e.prototype,"fontScheme",{get:function(){return this.fntScheme},set:function(e){this.fntScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){(0,a.isNullOrUndefined)(e)||this.fntScheme.copyFormat(e.fntScheme)},e.prototype.destroy=function(){this.fntScheme=void 0},e}(),wl=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),bl=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i((function(t){t(e.value)})).then(s,a)}l((n=n.apply(e,t||[])).next())}))},Cl=function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},xl=function(){function e(e){var t=this;this.isCompleted=!0,this.isCopying=!1,this.isSelectionCompleted=!0,this.scrollbarWidth=0,this.isWebPrinting=!1,this.isHeaderFooter=!1,this.isSpellCheckPending=!1,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.showRevision=!1,this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.isDragging=!1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.isMouseDown=!1,this.isMouseEntered=!1,this.scrollMoveTimer=0,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.isTouchMoved=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.defaultTabWidth=36,this.dontUseHtmlParagraphAutoSpacing=!1,this.allowSpaceOfSameStyleInTable=!1,this.alignTablesRowByRow=!1,this.compatibilityMode="Word2013",this.lists=[],this.comments=[],this.authors=new l,this.revisionsInternal=new l,this.commentUserOptionId=1,this.abstractLists=[],this.styles=new La,this.stylesMap=new l,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.endBookmarksUpdated=[],this.formFields=[],this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new Sa(0,0),this.zoomFactorInternal=1,this.moveCaretPosition=0,this.isTextInput=!1,this.isScrollHandler=!1,this.triggerElementsOnLoading=!1,this.triggerSpellCheck=!1,this.restrictFormatting=!1,this.protectionType="NoProtection",this.isDocumentProtected=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.cachedPages=[],this.skipScrollToPosition=!1,this.isIosDevice=!1,this.isMobileDevice=!1,this.isLinuxOS=!1,this.isFormFilling=!1,this.fontSubstitutionTable=void 0,this.themes=new yl,this.hasThemes=!1,this.footnotes=new Jl,this.endnotes=new Jl,this.isFootnoteWidget=!1,this.isDragStarted=!1,this.isMouseDownInSelection=!1,this.isBookmarkInserted=!0,this.isMappedContentControlUpdated=!0,this.isAutoResizeCanStart=!1,this.isRestartNumbering=!1,this.onTextInput=function(e){if(!t.isComposingIME){e.preventDefault();var i=e.data;t.owner.editorModule.handleTextInput(i)}},this.compositionStart=function(){a.Browser.isDevice||t.owner.isReadOnlyMode||(t.isComposingIME=!0,t.positionEditableTarget(),t.owner.editorHistoryModule&&t.owner.editorModule.initComplexHistory("IMEInput")),t.isCompositionStart=!0},this.compositionUpdated=function(){t.isComposingIME&&!t.owner.isReadOnlyMode&&setTimeout((function(){t.owner.editorModule.insertIMEText(t.getEditableDivTextContent(),!0)}),0),t.isCompositionUpdated=!0},this.compositionEnd=function(e){if(t.isComposingIME&&!t.owner.isReadOnlyMode){var i=t.getEditableDivTextContent();setTimeout((function(){""!==i&&t.owner.editorModule.insertIMEText(i,!1),t.isComposingIME=!1,t.lastComposedText="",t.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+t.owner.viewer.containerLeft+"px;top:"+t.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"),t.editableDiv.innerHTML="",t.owner.editorHistoryModule&&(""!==i&&(t.owner.editorModule.isSkipOperationsBuild=t.owner.enableCollaborativeEditing),t.owner.editorHistoryModule.updateComplexHistory(),""===i&&(t.owner.editorModule.isSkipOperationsBuild=t.owner.enableCollaborativeEditing,t.owner.editorHistoryModule.undo(),t.owner.editorHistoryModule.redoStack.pop()),t.owner.editorModule.isSkipOperationsBuild=!1)}),0)}e.preventDefault(),t.isCompositionUpdated=!1,t.isCompositionEnd=!0},this.onImageResizer=function(e){!(0,a.isNullOrUndefined)(t.owner)&&!(0,a.isNullOrUndefined)(t.owner.imageResizerModule)&&t.owner.imageResizerModule.isImageResizerVisible&&t.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?t.onMouseUpInternal(e):e instanceof TouchEvent&&t.onTouchUpInternal(e)),t.scrollMoveTimer&&(t.isMouseEntered=!0,clearInterval(t.scrollMoveTimer))},this.onKeyPressInternal=function(e){var i=e.which||e.keyCode;t.triggerElementsOnLoading=!1;var n=!(!e.ctrlKey&&!e.metaKey)||17===i,r=e.altKey?e.altKey:18===i;if(a.Browser.isIE&&r&&n&&(n=!1),n&&"v"===e.key||n&&"a"===e.key||(n||t.isControlPressed&&a.Browser.isIE)&&"p"===e.key)a.Browser.isIE&&(t.isControlPressed=!1);else{if(!t.owner.isReadOnlyMode&&t.owner.editorModule.canEditContentControl||"FormFieldsOnly"===t.owner.documentHelper.protectionType&&t.owner.editorModule.canEditContentControl&&!(0,a.isNullOrUndefined)(t.owner.documentHelper.selection)&&t.owner.documentHelper.selection.checkContentControlLocked()||!(0,a.isNullOrUndefined)(t.selection)&&t.selection.isInlineFormFillMode()){var o=e.keyCode||e.charCode,s="";o?s=String.fromCharCode(o):e.key&&(s=e.key)," "===s||"\r"===s||"\b"===s||s===String.fromCharCode(27)||n?" "===s&&(t.isSpellCheckPending=!1,t.triggerSpellCheck=!0,t.owner.editorModule.handleTextInput(" "),t.triggerSpellCheck=!1):(t.triggerSpellCheck=!1,t.isSpellCheckPending=!0,t.owner.editorModule.handleTextInput(s)),e.preventDefault()}t.owner.focusIn()}},this.onTextInputInternal=function(e){t.owner.isReadOnlyMode?t.editableDiv.innerText="":t.owner.editorModule.onTextInputInternal()},this.onCopy=function(e){!t.isCopying||(0,a.isNullOrUndefined)(t.selection)||t.selection.isEmpty||(t.owner.selection.onCopy(e),e.preventDefault())},this.onPaste=function(e){(!t.owner.isReadOnlyMode&&t.owner.editorModule.canEditContentControl||t.selection.isInlineFormFillMode())&&t.owner.editorModule.pasteInternal(e),t.editableDiv.innerText="",e.preventDefault()},this.onFocusOut=function(){if(!(0,a.isNullOrUndefined)(t.selection)){if(t.owner.contextMenuModule&&t.owner.contextMenuModule.contextMenuInstance&&"block"===t.owner.contextMenuModule.contextMenuInstance.element.style.display)return;t.selection.hideCaret()}},this.updateFocus=function(){if(!t.owner.enableCollaborativeEditing||!t.owner.editorModule.isRemoteAction)return(0,a.isNullOrUndefined)(t.currentSelectedComment)||t.owner.commentReviewPane.commentPane.isEditMode?void(!t.selection||t.isMobileDevice&&t.owner.isReadOnly||(void 0===navigator||a.Browser.isDevice||a.Browser.isIE||navigator.userAgent.match("Edge")||(0,a.isNullOrUndefined)(t.iframe)||t.iframe.focus(),(0,a.isNullOrUndefined)(t.editableDiv)||t.editableDiv.focus(),t.selection.showCaret())):(t.owner.commentReviewPane&&t.owner.commentReviewPane.commentPane.isEditMode&&t.owner.commentReviewPane.commentPane.selectComment(t.currentSelectedComment),void t.selection.hideCaret())},this.scrollHandler=function(){t.scrollTimer&&clearTimeout(t.scrollTimer),t.clearContent(),t.isScrollHandler=!0,a.Browser.isDevice||t.isComposingIME||(t.iframe.style.top=t.owner.viewer.containerTop+"px",t.iframe.style.left=t.owner.viewer.containerLeft+"px"),t.owner.hRuler&&(t.hRuler=document.getElementById(t.owner.element.id+"_hRulerBottom"),t.hRuler.style.top=t.viewerContainer.scrollTop+"px",t.markIndicator=document.getElementById(t.owner.element.id+"_markIndicator"),t.markIndicator&&(t.markIndicator.style.top=t.viewerContainer.scrollTop+"px")),t.owner.vRuler&&(t.vRuler=document.getElementById(t.owner.element.id+"_vRulerBottom"),t.vRuler.style.left=t.viewerContainer.scrollLeft+"px",t.markIndicator=document.getElementById(t.owner.element.id+"_markIndicator"),t.markIndicator&&(t.markIndicator.style.left=t.viewerContainer.scrollLeft+"px")),t.owner.rulerHelper&&!(0,a.isNullOrUndefined)(t.owner.rulerHelper.vRulerBottom)&&(t.owner.rulerHelper.vRulerBottom.style.height=t.pageContainer.offsetHeight+"px"),t.owner.viewer.updateScrollBars();var e=t.owner.viewer.containerTop+t.visibleBounds.height-(t.owner.viewer.padding.top+t.owner.viewer.padding.bottom);e>t.pageContainer.offsetHeight&&(t.viewerContainer.scrollTop=t.owner.viewer.containerTop-(e-t.pageContainer.offsetHeight)),t.owner.viewer instanceof kl&&!(0,a.isNullOrUndefined)(t.owner)&&t.owner.fireViewChange(),t.isScrollHandler=!1,t.scrollTimer=setTimeout((function(){t.isScrollHandler||(0,a.isNullOrUndefined)(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())}),200)},this.onWindowResize=function(){(0,a.isNullOrUndefined)(t.owner)||!t.owner.isContainerResize?(t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout((function(){(0,a.isNullOrUndefined)(t.owner)||(0,a.isNullOrUndefined)(t.owner.element)||(t.updateViewerSize(),t.owner.rulerHelper&&t.owner.documentEditorSettings&&t.owner.documentEditorSettings.showRuler&&t.owner.rulerHelper.updateRuler(t.owner,!0),t.owner.enableCollaborativeEditing&&t.owner.collaborativeEditingHandlerModule&&t.owner.collaborativeEditingHandlerModule.updateCaretPosition(),t.clearContent(),t.owner.viewer.updateScrollBars(),(0,a.isNullOrUndefined)(t.selection)||t.selection.updateCaretPosition(),t.updateTouchMarkPosition(),t.owner.contextMenuModule&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.contextMenuInstance.close(),t.resizeTimer&&clearTimeout(t.resizeTimer))}),200)):t.owner.isContainerResize=!1},this.onContextMenu=function(e){t.owner.contextMenuModule&&(t.isMouseDown&&(t.isMouseDown=!1),t.owner.contextMenuModule.onContextMenuInternal(e),t.updateFocus())},this.onMouseDownInternal=function(e){var i=e.target;if(t.owner.focusIn(),!(!(0,a.isNullOrUndefined)(i)&&i!==t.viewerContainer||t.owner.isTableMarkerDragging||t.isTouchInput||e.offsetX>t.visibleBounds.width-(t.visibleBounds.width-t.viewerContainer.clientWidth)||e.offsetY>t.visibleBounds.height-(t.visibleBounds.height-t.viewerContainer.clientHeight)||(t.isFootnoteWidget=!1,(0,a.isNullOrUndefined)(t.selection)))){if(t.updateCursor(e),t.formFillPopup&&t.formFillPopup.hidePopup(),t.contentDropDown&&t.contentDropDown.hidePopup(),t.isLeftButtonPressed(e)&&!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!(0,a.isNullOrUndefined)(t.owner.imageResizerModule.selectedResizeElement)){if(t.selection.isInShape){var n=t.owner.selectionModule.getCurrentTextFrame().containerShape;t.selection.selectShape(n)}t.owner.imageResizerModule.isImageResizing=!0}e.preventDefault(),t.isTouchInput||t.selection.hideCaret();var r=new Sa(e.offsetX,e.offsetY),o=t.owner.viewer.findFocusedPage(r,!0,!0);if(t.mouseDownOffset.x=o.x,t.mouseDownOffset.y=o.y,t.isMouseDownInFooterRegion=t.selection.isCursorInsidePageRect(r,t.currentPage)&&t.selection.isCursorInFooterRegion(r,t.currentPage),t.isSelectionChangedOnMouseMoved=!1,!t.owner.isReadOnlyMode&&(t.owner.editorModule.tableResize.isInCellResizerArea(o)||t.owner.editorModule.tableResize.isInRowResizerArea(o)))return t.selection.hideCaret(),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,void(t.isLeftButtonPressed(e)&&(t.owner.editorModule.tableResize.startingPoint.x=o.x,t.owner.editorModule.tableResize.startingPoint.y=o.y,t.owner.editorModule.tableResize.handleResize(o)));e.ctrlKey&&(t.isControlPressed=!0),t.owner.selectionModule.isEmpty&&(t.useTouchSelectionMark=!1);var s=t.getLineWidget(o);if(3===e.which&&!t.owner.selectionModule.isEmpty&&t.selection.checkCursorIsInSelection(s,o))return void e.preventDefault();t.owner&&t.owner.documentEditorSettings&&t.owner.documentEditorSettings.allowDragAndDrop&&!t.owner.selectionModule.isEmpty&&t.selection.checkCursorIsInSelection(s,o)&&(t.isMouseDownInSelection=!0),t.isTouchInput=!1,t.isMouseDown=!0,t.updateFocus(),t.timer=setTimeout((function(){t.tapCount++,t.tapCount>1&&(t.tapCount=1),t.isScrollHandler||(0,a.isNullOrUndefined)(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())}),100)}},this.onMouseMoveInternal=function(e){if(((0,a.isNullOrUndefined)(e.target)||e.target===t.viewerContainer)&&!t.owner.isTableMarkerDragging&&(e.preventDefault(),!(0,a.isNullOrUndefined)(t.selection))){if(!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return void(t.owner.imageResizerModule.isImageMoveToNextPage||t.owner.imageResizerModule.handleImageResizingOnMouse(e));var i=new Sa(e.offsetX,e.offsetY),n=t.owner.viewer.findFocusedPage(i,!t.owner.enableHeaderAndFooter),r=t.getLineWidget(n);if(t.isMouseDown){if(!(0,a.isNullOrUndefined)(t.currentPage)){var o=n.x,s=n.y;if(!t.owner.isReadOnlyMode&&t.isRowOrCellResizing){var l=t.owner.editorModule.tableResize.currentResizingTable,d=t.selection.setPositionForBlock(l,!0),h=t.selection.setPositionForBlock(l,!1);t.owner.documentHelper.isDocumentProtected&&!t.selection.checkSelectionIsAtEditRegion(d,h)||t.owner.editorModule.tableResize.handleResizing(n)}else{if((!t.isDragStarted&&t.isMouseDownInSelection&&t.isLeftButtonPressed(e)&&!t.owner.selectionModule.isEmpty&&t.selection.checkCursorIsInSelection(r,n)||!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!t.isDragStarted&&t.isLeftButtonPressed(e)&&!t.owner.selectionModule.isEmpty&&!(0,a.isNullOrUndefined)(r)&&t.owner.imageResizerModule.selectedImageWidget.containsKey(r)&&!t.owner.imageResizerModule.isImageResizing)&&(t.isDragStarted=!0,t.isMouseDownInSelection=!1,t.selection.isForward?(t.dragStartParaInfo=t.selection.getParagraphInfo(t.selection.start),t.dragEndParaInfo=t.selection.getParagraphInfo(t.selection.end)):(t.dragStartParaInfo=t.selection.getParagraphInfo(t.selection.end),t.dragEndParaInfo=t.selection.getParagraphInfo(t.selection.start)),t.selection.caret.classList.remove("e-de-cursor-animation")),t.isTouchInput||t.isSelectionChangedOnMouseMoved||t.touchDownOnSelectionMark>0||t.isDragStarted||(t.updateTextPositionForSelection(n,1),(0,a.isNullOrUndefined)(t.currentSelectedComment)||!t.owner.commentReviewPane||t.owner.commentReviewPane.commentPane.isEditMode||(t.currentSelectedComment=void 0)),t.isLeftButtonPressed(e)&&!t.isDragStarted){e.preventDefault();var c=s,p=t.owner.selectionModule.end,u=new Sa(o,c);t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!t.owner.imageResizerModule.isShapeResize||(t.isCompleted=!1,t.owner.selectionModule.moveTextPosition(u,p)),t.isSelectionChangedOnMouseMoved=!0}t.isDragStarted&&t.isLeftButtonPressed(e)&&(t.autoScrollOnSelection(i),t.selection.updateTextPosition(r,n))}}t.selection.checkForCursorVisibility()}t.isRowOrCellResizing||t.isSelectionChangedOnMouseMoved||t.updateCursor(e),t.isRowOrCellResizing&&t.selection.hideCaret()}},this.onMouseLeaveInternal=function(e){e.preventDefault();var i=new Sa(e.offsetX,e.offsetY);if(t.isMouseDown){var n=t.viewerContainer.scrollTop;clearInterval(t.scrollMoveTimer),e.offsetY+n>n?t.scrollMoveTimer=setInterval((function(){t.scrollForwardOnSelection(i)}),100):t.scrollMoveTimer=setInterval((function(){t.scrollBackwardOnSelection(i)}),100),t.isMouseEntered&&(t.isMouseEntered=!1)}t.isDragStarted&&(t.selection.hideCaret(),t.scrollMoveTimer&&(clearInterval(t.scrollMoveTimer),t.scrollMoveTimer=0))},this.onMouseEnterInternal=function(e){t.isMouseEntered||t.owner.viewer.updateScrollBars(),t.isMouseEntered=!0,t.scrollMoveTimer&&clearInterval(t.scrollMoveTimer),!t.isLeftButtonPressed(e)&&t.isDragStarted&&(t.selection.caret.classList.contains("e-de-cursor-animation")||t.selection.caret.classList.add("e-de-cursor-animation"),t.isDragStarted=!1),!t.isLeftButtonPressed(e)&&t.isMouseDown&&t.onMouseUpInternal(e)},this.onDoubleTap=function(e){if(t.owner.focusIn(),((0,a.isNullOrUndefined)(e.target)||e.target===t.viewerContainer)&&!(0,a.isNullOrUndefined)(t.selection)){t.isTouchInput=!1;var i=new Sa(e.offsetX,e.offsetY),n=t.owner.viewer.findFocusedPage(i,!0);if(t.selection.checkAndEnableHeaderFooter(i,t.owner.viewer.findFocusedPage(i,!0)))return;var r=t.getLineWidget(n);if((0,a.isNullOrUndefined)(r))return;var o=t.selection.getHyperLinkFieldInCurrentSelection(r,n,!0);if((0,a.isNullOrUndefined)(o)&&(o=t.selection.getCurrentFormField()),t.isDocumentProtected||!t.owner.enableFormField||t.owner.isReadOnlyMode)t.isDocumentProtected&&o&&o.formFieldData instanceof Gl&&"Text"===o.formFieldData.type&&t.selection.selectField();else{var s=t.selection.getFormFieldType(o);if(s)switch(""!==s.toString()&&t.selection.selectField(o),s){case"Text":t.owner.textFormFieldDialogModule.show();break;case"CheckBox":t.owner.checkBoxFormFieldDialogModule.show();break;case"DropDown":t.owner.dropDownFormFieldDialogModule.show()}}var l=t.selection.start.clone(),d=t.selection.end.clone(),h=l.currentWidget.getInline(l.offset,0).element;if("Pages"===t.owner.layoutType)if(h instanceof Yl)if("Footnote"===h.footnoteType){var c=t.currentPage.footnoteWidget,p=void 0;for(p=0;p<=c.bodyWidgets.length;p++){var u=c.bodyWidgets[p].footNoteReference;if(h.text===u.text)break}l.setPositionParagraph(c.bodyWidgets[p].childWidgets[0].childWidgets[0],0),d.setPositionParagraph(c.bodyWidgets[p].childWidgets[0].childWidgets[0],0),t.selection.selectRange(l,d)}else t.navigateToEndNote(h,l,d);else h instanceof Zl&&(t.selection.isinEndnote||t.selection.isinFootnote)&&t.selection.footnoteReferenceElement(l,d,h);!t.selection.isEmpty||(0,a.isNullOrUndefined)(t.currentPage)||(0,a.isNullOrUndefined)(t.owner.selectionModule.start)||(t.owner.selectionModule.selectCurrentWord(),t.selection.checkForCursorVisibility(),t.tapCount=2)}},this.onMouseUpInternal=function(e){if(((0,a.isNullOrUndefined)(e.target)||e.target===t.viewerContainer)&&!t.owner.isTableMarkerDragging){e.preventDefault(),t.isListTextSelected=!1;var i=new Sa(e.offsetX,e.offsetY),n=t.owner.viewer.findFocusedPage(i,!0);if(!(0,a.isNullOrUndefined)(t.selection)){var r=1;if(a.Browser.isIE?r=t.tapCount:e.detail>2&&(r=e.detail),t.isRowOrCellResizing&&t.owner.editorModule.tableResize.updateResizingHistory(n),!(0,a.isNullOrUndefined)(t.owner.editor)&&t.selection.checkContentControlLocked()&&t.owner.editorModule.insertContentControlPlaceholder(),t.isMouseDown&&!t.isSelectionChangedOnMouseMoved&&!(0,a.isNullOrUndefined)(t.currentPage)&&!(0,a.isNullOrUndefined)(t.owner.selectionModule.start)&&(!t.owner.enableImageResizerMode||!t.owner.imageResizerModule.isImageResizing)){if(0===t.touchDownOnSelectionMark&&!t.isRowOrCellResizing){if(e.shiftKey){var o=t.owner.selectionModule.end;t.owner.selectionModule.moveTextPosition(n,o)}else if(t.updateTextPositionForSelection(n,r),t.owner.selectionModule.isImageSelected){var s=t.owner.getImageContentControl();if(s instanceof id&&"Picture"==s.contentControlProperties.type){var l=t.owner.picturePositionY;t.owner.renderPictureContentControlElement(t.owner,!0,!1,l)}}else t.owner.renderPictureContentControlElement(t.owner,!1,!1);a.Browser.isIE&&2===r&&t.selection.checkAndEnableHeaderFooter(i,n)}t.selection.checkForCursorVisibility(),(0,a.isNullOrUndefined)(t.currentSelectedComment)||!t.owner.commentReviewPane||t.owner.commentReviewPane.commentPane.isEditMode||(t.currentSelectedComment=void 0)}var d=t.isIosDevice?e.metaKey:e.ctrlKey;if(!(0,a.isNullOrUndefined)(t.owner.editorModule)&&!(0,a.isNullOrUndefined)(t.owner.selectionModule)){var h=t.owner.selection.currentContentControl,c=t.owner.selectionModule.checkContentControlLocked();(!(0,a.isNullOrUndefined)(h)&&!h.contentControlProperties.lockContents&&c&&0===e.button||!(0,a.isNullOrUndefined)(h)&&!h.contentControlProperties.lockContents&&"FormFieldsOnly"==t.protectionType&&0===e.button)&&(t.owner.isReadOnly||(t.isDocumentProtected?(t.selection.checkSelectionIsAtEditRegion()||t.isFormFillProtectedMode)&&"CheckBox"===h.contentControlProperties.type&&(t.owner.editor.toggleContentControlCheckBox(h,!h.contentControlProperties.isChecked),h.contentControlProperties.isTemporary&&t.owner.editor.removeContentControl()):"CheckBox"===h.contentControlProperties.type&&(t.owner.editor.toggleContentControlCheckBox(h,!h.contentControlProperties.isChecked),h.contentControlProperties.isTemporary&&t.owner.editor.removeContentControl()))),h&&t.selection.selectPlaceHolderText(h)}if((0,a.isNullOrUndefined)(t.currentPage)||(0,a.isNullOrUndefined)(t.owner.selectionModule.start)||!t.owner.selectionModule.isEmpty&&!t.owner.selectionModule.isImageSelected||!(d&&t.owner.useCtrlClickToFollowHyperlink||!t.owner.useCtrlClickToFollowHyperlink)||!0!==t.isLeftButtonPressed(e)||t.selection.navigateHyperLinkOnEvent(n,!1),t.isMouseDown&&t.isLeftButtonPressed(e)&&t.isDocumentProtected&&"FormFieldsOnly"===t.protectionType&&t.selection){var p=t.getLineWidget(n);if((0,a.isNullOrUndefined)(p))return;var u=t.selection.getHyperLinkFieldInCurrentSelection(p,n,!0);if((0,a.isNullOrUndefined)(u)&&(u=t.selection.getCurrentFormField(!0)),u&&u.formFieldData&&u.formFieldData.enabled&&!t.selection.isInlineFormFillMode(u)){var g={fieldName:u.formFieldData.name};u.formFieldData instanceof Gl?g.value=u.resultText:u.formFieldData instanceof Kl?g.value=u.formFieldData.checked:g.value=u.formFieldData.selectedIndex,g.isCanceled=!1,"Popup"===t.owner.documentEditorSettings.formFieldSettings.formFillingMode&&(t.selection.previousSelectedFormField,t.selection.getCurrentFormField()),t.owner.trigger(x,g),g.isCanceled||("Popup"===t.owner.documentEditorSettings.formFieldSettings.formFillingMode&&!(u.formFieldData instanceof Kl)||u.formFieldData instanceof Gl&&"Text"!==u.formFieldData.type||u.formFieldData instanceof Xl?t.formFillPopup.showPopUp(u):(t.owner.editorModule.toggleCheckBoxFormField(u),g.value=u.formFieldData.checked,g.isCanceled=!1,t.owner.trigger(C,g)))}if(!u&&t.isFormFillProtectedMode){h=t.owner.selection.currentContentControl;var m=!1;!(0,a.isNullOrUndefined)(h)&&h instanceof id&&!h.contentControlProperties.lockContentControl&&(m=!0),m||t.selection.navigateToNextFormField()}}else if(t.isMouseDown){if(t.formFields.length>0)if((u=t.selection.getCurrentFormField(!0))&&u.formFieldData instanceof Gl)t.selection.selectField();else if(t.isLeftButtonPressed(e)&&u&&u.formFieldData instanceof Xl){var f=u.line.getOffset(u,0),v=t.selection.getPhysicalPositionInternal(u.line,f,!1);t.selection.selectInternal(u.line,u,0,v)}t.contentControlCollection.length>0&&t.selection.triggerContentControlFillEvent(),t.isSelectionChangedOnMouseMoved&&t.selection.fireSelectionChanged(!0)}if(!t.owner.isReadOnlyMode&&t.isSelectionInListText(n)&&t.selection.selectListText(),!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.scrollToPosition(t.owner.selectionModule.start,t.owner.selectionModule.end),t.owner.imageResizerModule.isImageResizing=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!(0,a.isNullOrUndefined)(t.selection.caret)&&(t.selection.caret.style.display="none"),t.isDragStarted){if(0!==t.selection.selectedWidgets.length||(0,a.isNullOrUndefined)(t.dragStartParaInfo)||(0,a.isNullOrUndefined)(t.dragEndParaInfo)||!t.dragEndParaInfo.paragraph.equals(t.dragStartParaInfo.paragraph)){if(t.selection.selectedWidgets.length>0)for(var y=0;y<t.selection.selectedWidgets.values.length;y++){var w=t.selection.selectedWidgets.values[y];if(!(0,a.isNullOrUndefined)(w.floatingItems)&&w.floatingItems.length>0)for(var b=0;b<w.floatingItems.length;b++)if(w.floatingItems[b]instanceof gd&&"Inline"!==w.floatingItems[b].textWrappingStyle){t.isDragStarted=!1;break}if(!t.isDragStarted)break}}else{var I=t.dragStartParaInfo.paragraph.getInline(t.dragEndParaInfo.offset,0);!(0,a.isNullOrUndefined)(I.element)&&I.element instanceof gd&&"Inline"!==I.element.textWrappingStyle&&(t.isDragStarted=!1)}t.isDragStarted||(t.dragStartParaInfo=void 0,t.dragEndParaInfo=void 0,t.selection.caret.classList.add("e-de-cursor-animation"))}if(t.isDragStarted&&(t.isDragging=!0,t.moveSelectedContent(),t.isDragging=!1),t.isMouseDown&&t.updateFocus(),t.isMouseDownInSelection=!1,t.isMouseDown=!1,t.isFootnoteWidget=!1,t.isSelectionChangedOnMouseMoved=!1,t.isTouchInput=!1,t.useTouchSelectionMark=!0,t.isControlPressed=!1,t.isListTextSelected&&t.selection.hideCaret(),t.owner.enableImageResizerMode){var k=t.owner.imageResizerModule;k.isImageResizing=!1,k.isImageMoveToNextPage=!1,k.leftValue=void 0,k.topValue=void 0}t.isMouseDownInFooterRegion=!1}t.selection&&(t.selection.isCellPrevSelected=!1),t.owner.documentHelper.contentControlCollection.length>0&&(t.clearContent(),t.owner.documentHelper.viewer.updateScrollBars())}},this.onTouchStartInternal=function(e){if(t.selection){if(t.isTouchMoved=!1,t.isCompositionStart=!1,t.isCompositionEnd=!1,t.isCompositionUpdated=!1,t.isCompositionCanceled=!0,t.isTouchInput=!0,t.isTimerStarted?1===t.tapCount?t.tapCount=2:(t.tapCount=3,t.isTimerStarted=!1):(t.isTimerStarted=!0,t.tapCount=1),1===e.touches.length){t.zoomX=e.touches[0].clientX,t.zoomY=e.touches[0].clientY,t.owner.selectionModule.isEmpty&&(t.useTouchSelectionMark=!1),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1;var i=void 0;if(t.isMouseDown&&(i=t.getTouchOffsetValue(e)),i=t.owner.viewer.findFocusedPage(i,!0,!0),t.owner.enableImageResizerMode){var n=t.owner.imageResizerModule.getImagePointOnTouch(i);t.owner.imageResizerModule.selectedResizeElement=n.selectedElement}t.owner.enableImageResizerMode&&!(0,a.isNullOrUndefined)(t.owner.imageResizerModule.selectedResizeElement)&&(t.owner.imageResizerModule.isImageResizing=!0),a.Browser.isDevice&&(t.editableDiv.contentEditable=t.owner.isReadOnlyMode?"false":"true");var r=t.owner.selectionModule.end.location.x,o=t.selection.getCaretBottom(t.owner.selectionModule.end,t.owner.selectionModule.isEmpty)+9;t.touchDownOnSelectionMark=(i.y<=o&&i.y>=o-20||i.y>=o&&i.y<=o+20)&&(i.x<=r&&i.x>=r-20||i.x>=r&&i.x<=r+20)?1:0,t.owner.selectionModule.isEmpty||0!==t.touchDownOnSelectionMark||(r=t.owner.selectionModule.start.location.x,o=t.selection.getCaretBottom(t.owner.selectionModule.start,!1)+9,t.touchDownOnSelectionMark=(i.y<=o&&i.y>=o-20||i.y>=o&&i.y<=o+20)&&(i.x<=r&&i.x>=r-20||i.x>=r&&i.x<=r+20)?2:0)}!(0,a.isNullOrUndefined)(t.owner.contextMenuModule)&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.contextMenuInstance.close(),(t.touchDownOnSelectionMark||e.touches.length>1)&&e.preventDefault(),t.longTouchTimer=setTimeout(t.onLongTouch,500,e),t.timer=setTimeout((function(){t.isTimerStarted=!1}),200),t.owner.focusIn()}},this.onLongTouch=function(e){if(!((0,a.isNullOrUndefined)(t.owner)||(0,a.isNullOrUndefined)(t.viewerContainer)||t.isTouchMoved||1!==e.touches.length)){var i=t.getTouchOffsetValue(e),n=t.owner.viewer.findFocusedPage(i,!0),r=t.selection.start,o=t.selection.end,s=!1;t.selection.isForward||(r=t.selection.end,o=t.selection.start);var l=r.location,d=o.location;s=r.currentWidget!==o.currentWidget?!(n.x>=l.x&&n.x<=d.x||n.y>=l.y&&n.y<=d.y):!(n.x>=l.x&&n.x<=d.x&&n.y>=l.y&&n.y<=d.y),1===e.changedTouches.length&&s&&(t.updateSelectionOnTouch(i,n),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.selection.isEmpty&&t.selection.selectCurrentWord(),!(0,a.isNullOrUndefined)(t.owner.contextMenuModule)&&t.owner.contextMenuModule.contextMenuInstance&&t.owner.contextMenuModule.onContextMenuInternal(e)}},this.onTouchMoveInternal=function(e){t.isTouchMoved=!0;var i,n=e.touches;if(!(0,a.isNullOrUndefined)(t.selection)){if(t.owner.editorModule&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return e.preventDefault(),void(t.owner.imageResizerModule.isImageMoveToNextPage||(t.owner.imageResizerModule.handleImageResizingOnTouch(e),t.selection.caret.style.display="none"));if(t.isMouseDown){i=t.getTouchOffsetValue(e);var r=t.owner.viewer.findFocusedPage(i,!0);if(t.touchDownOnSelectionMark>0){t.isCompleted=!1,e.preventDefault();var o=r.y,s=t.owner.selectionModule.end;r.y<=26?o-=r.y<0?0:r.y+.5:o-=36.5,s=2===t.touchDownOnSelectionMark?t.selection.start:t.selection.end,r=new Sa(r.x,o),t.owner.selectionModule.moveTextPosition(r,s),t.isSelectionChangedOnMouseMoved=!0}t.selection.checkForCursorVisibility(),t.updateTouchMarkPosition()}}if(n.length>1){e.preventDefault(),t.isMouseDown=!1,t.zoomX=(n[0].clientX+n[1].clientX)/2,t.zoomY=(n[0].clientY+n[1].clientY)/2;var l=Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2));t.preDifference>-1?l>t.preDifference?t.onPinchOutInternal(e):l<t.preDifference&&t.onPinchInInternal(e):t.zoomFactor<2?-1!==t.preDifference&&l>t.preDifference&&t.onPinchInInternal(e):-1===t.preDifference&&t.zoomFactor>2&&l>t.preDifference&&t.onPinchInInternal(e),t.preDifference=l}t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0)},this.onTouchUpInternal=function(e){if(!(0,a.isNullOrUndefined)(t.selection)){var i=t.getTouchOffsetValue(e),n=t.owner.viewer.findFocusedPage(i,!0);1===e.changedTouches.length&&((!t.isTouchMoved||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)&&(t.updateSelectionOnTouch(i,n),(0,a.isNullOrUndefined)(t.currentPage)||(0,a.isNullOrUndefined)(t.selection.start)||t.isSelectionChangedOnMouseMoved||!(t.selection.isEmpty||t.selection.isImageField()&&(!t.owner.enableImageResizerMode||t.owner.enableImageResizerMode&&!t.owner.imageResizerModule.isImageResizing))||t.selection.navigateHyperLinkOnEvent(n,!0)),t.isSelectionChangedOnMouseMoved&&t.selection.fireSelectionChanged(!0),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.owner.imageResizerModule.isImageResizing=!1,t.owner.imageResizerModule.isImageMoveToNextPage=!1,t.scrollToPosition(t.owner.selectionModule.start,t.owner.selectionModule.end)),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&t.isTouchInput&&(t.touchStart.style.display="none",t.touchEnd.style.display="none"),e.preventDefault()}t.preDifference=-1,t.isTouchInput=!1,t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0),t.isTimerStarted||(t.tapCount=1),t.isListTextSelected&&t.selection.hideCaret(),t.owner.focusIn()},this.onKeyUpInternal=function(e){a.Browser.isDevice&&e.target===t.editableDiv&&window.getSelection().anchorOffset!==t.prefix.length&&t.selection.setEditableDivCaretPosition(t.editableDiv.innerText.length),(e.ctrlKey||17===e.keyCode||17===e.which)&&(t.isControlPressed=!1)},this.onKeyDownInternal=function(e){if((0,a.isNullOrUndefined)(e.target)||e.target===t.editableDiv||"container_editor_iconsplitbtn"===e.target.id){t.owner.focusIn();var i=!1,n={event:e,isHandled:!1,source:t.owner};if(t.owner.trigger(U,n),!n.isHandled){var r=e.which||e.keyCode,o=!(!e.ctrlKey&&!e.metaKey)||17===r,s=e.shiftKey?e.shiftKey:16===r,l=e.altKey?e.altKey:18===r;if(o&&!s&&!l)switch(r){case 80:e.preventDefault(),t.owner.print(),i=!0;break;case 83:e.preventDefault(),t.owner.save(""===t.owner.documentName?"sample":t.owner.documentName,"Sfdt"),i=!0}8!==e.keyCode&&46!==e.keyCode&&!(0,a.isNullOrUndefined)(t.owner.editor)&&t.selection.checkContentControlLocked()&&t.owner.editorModule.insertContentControlPlaceholder(),i||(0,a.isNullOrUndefined)(t.selection)||t.selection.onKeyDownInternal(e,o,s,l),!(0,a.isNullOrUndefined)(t.owner.documentHelper)&&t.owner.documentHelper.contentControlCollection.length>0&&(t.clearContent(),t.owner.documentHelper.viewer.updateScrollBars()),i&&e.preventDefault(),t.timer=setTimeout((function(){t.isScrollHandler||(0,a.isNullOrUndefined)(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())}),100)}}},this.owner=e,this.pages=[],this.lists=[],this.abstractLists=[],this.render=new Qa(this),this.characterFormat=new ka(this),this.themeFontLanguage=new ka(this),this.paragraphFormat=new ba(this),this.renderedLists=new l,this.renderedLevelOverrides=[],this.headersFooters=[],this.styles=new La,this.stylesMap=new l,this.owner&&(this.L10n=new a.L10n("documenteditor",this.owner.defaultLocale),this.L10n.setLocale(this.owner.locale)),this.preDefinedStyles=new l,this.initalizeStyles(),this.bookmarks=new l,this.editRanges=new l,this.isIosDevice="undefined"!=typeof window&&/Mac|iPad|iPod/i.test(navigator.userAgent),this.isMobileDevice="undefined"!=typeof window&&/Android|Windows Phone|webOS/i.test(navigator.userAgent),this.isLinuxOS="undefined"!=typeof window&&/Linux/i.test(navigator.userAgent),this.formFillPopup=new hl(this.owner),this.contentDropDown=new cl(this.owner),this.customXmlData=new l,this.fontSubstitutionTable=new l,this.contentControlCollection=[],this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new yl,this.images=new l}return Object.defineProperty(e.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerCanvas",{get:function(){return(0,a.isNullOrUndefined)(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),(0,a.isNullOrUndefined)(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),e.prototype.openTextFile=function(e){this.layout.isTextFormat=!0;var t=[];t=(e=e.replace(/\r\n/g,"\n")).split("\n");var i=new Ol;i.sectionFormat=new ga(i),i.childWidgets=[];for(var n=new Rl,r=new zl(n),o=0;o<t.length;o++)if(o!==t.length-1||0!==t[o].length){var s=new Rl,a=new zl(s);if(t[o].length>0){var l=90;if(t[o].length>l)for(var d=0,h=l,c=void 0,p=t[o].length/l+1,u=0;u<p;){var g;p-1!=u||(h=t[o].length%l),c=t[o].substring(d,h),(g=new Zl).text=c,a.children.push(g),g.line=a,u++,h+=l,d+=l}else(g=new Zl).text=t[o],a.children.push(g),g.line=a}s.childWidgets.push(a),s.index=o,s.containerWidget=i,i.childWidgets.push(s)}else n.childWidgets.push(r),n.index=o,n.containerWidget=i,i.childWidgets.push(n);this.onDocumentChanged([i]),this.layout.isTextFormat=!1},Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return(0,a.isNullOrUndefined)(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),(0,a.isNullOrUndefined)(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog",{get:function(){return this.dialogInternal||this.initDialog(this.owner.enableRtl),this.dialogInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog2",{get:function(){return this.dialogInternal2||this.initDialog2(this.owner.enableRtl),this.dialogInternal2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog3",{get:function(){return this.dialogInternal3||this.initDialog3(this.owner.enableRtl),this.dialogInternal3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(e){this.owner&&this.owner.commentReviewPane&&(this.owner.commentReviewPane.previousSelectedComment=this.currentSelectedCommentInternal),this.currentSelectedCommentInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){this.currentSelectedRevisionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCommentOnlyMode",{get:function(){return this.isDocumentProtected&&"CommentsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrackedOnlyMode",{get:function(){return this.isDocumentProtected&&"RevisionsOnly"===this.protectionType},enumerable:!0,configurable:!0}),e.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Heading 7",'{"type":"Paragraph","name":"Heading 7","basedOn":"Normal","next":"Normal","link":"Heading 7 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level7"}}'),this.preDefinedStyles.add("Heading 8",'{"type":"Paragraph","name":"Heading 8","basedOn":"Normal","next":"Normal","link":"Heading 8 Char","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level8"}}'),this.preDefinedStyles.add("Heading 9",'{"type":"Paragraph","name":"Heading 9","basedOn":"Normal","next":"Normal","link":"Heading 9 Char","characterFormat":{"fontSize":10.5,"italic":true,"fontFamily":"Calibri Light","fontColor":"#333333"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level9"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Heading 7 Char",'{"type":"Character","name":"Heading 7 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Heading 8 Char",'{"type":"Character","name":"Heading 8 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333"}}'),this.preDefinedStyles.add("Heading 9 Char",'{"type":"Character","name":"Heading 9 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":10.5,"italic":true,"fontFamily":"Calibri Light","fontColor":"#333333"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("TOC 1",'{"type":"Paragraph","name":"TOC 1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 2",'{"type":"Paragraph","name":"TOC 2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 3",'{"type":"Paragraph","name":"TOC 3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 4",'{"type":"Paragraph","name":"TOC 4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 5",'{"type":"Paragraph","name":"TOC 5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 6",'{"type":"Paragraph","name":"TOC 6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 7",'{"type":"Paragraph","name":"TOC 7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 8",'{"type":"Paragraph","name":"TOC 8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 9",'{"type":"Paragraph","name":"TOC 9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Header",'{"type":"Paragraph","name":"Header","basedOn":"Normal","next":"Header","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}'),this.preDefinedStyles.add("Footer",'{"type":"Paragraph","name":"Footer","basedOn":"Normal","next":"Footer","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}')},e.prototype.clearDocumentItems=function(){this.owner.editorModule&&this.owner.editorModule.clear(),this.owner.searchModule&&this.owner.searchModule.clearSearchHighlight(),this.owner.selectionModule&&this.owner.selectionModule.clear(),this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0;for(var e=0;e<this.comments.length;e++){var t=this.comments[e].commentStart;t&&t.destroy()}if(this.comments=[],this.bookmarks.clear(),this.endBookmarksUpdated=[],this.styles.clear(),this.stylesMap.clear(),this.pages&&this.pages.length>0){for(e=0;e<this.pages.length;e++){this.pages[e].componentDestroy()}this.pages=[]}if(this.authors.clear(),this.revisionsInternal.clear(),this.owner.revisions.clear(),this.characterFormat.clearFormat(),this.themeFontLanguage.clearFormat(),this.paragraphFormat.clearFormat(),this.owner.trackChangesPane&&this.owner.trackChangesPane.clear(),this.owner.xmlPaneModule&&this.owner.xmlPaneModule.clear(),this.setDefaultCharacterValue(this.characterFormat),this.setDefaultParagraphValue(this.paragraphFormat),this.owner.commentReviewPane&&this.owner.commentReviewPane.clear(),this.isHeaderFooter=!1,this.defaultTabWidth=36,this.isDocumentProtected=!1,this.protectionType="NoProtection",this.restrictFormatting=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.formFillPopup&&this.formFillPopup.hidePopup(),this.contentDropDown&&this.contentDropDown.hidePopup(),this.customXmlData.clear(),this.fontSubstitutionTable.clear(),this.images.clear(),this.contentControlCollection=[],this.backgroundColor="#FFFFFF",this.endnotes.clear(),this.footnotes.clear(),this.footnoteCollection=[],this.endnoteCollection=[],this.lists&&this.lists.length>0)for(e=0;e<this.lists.length;e++){this.lists[e].clear()}this.lists=[],this.abstractLists=[],this.themes=new yl,this.hasThemes=!1,this.isRestartNumbering=!1},e.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(0,this.owner.characterFormat,this.characterFormat),this.owner.parser.parseParagraphFormat(0,this.owner.paragraphFormat,this.paragraphFormat)},e.prototype.setDefaultCharacterValue=function(e){e.bold=!1,e.italic=!1,e.fontFamily="Calibri",e.fontSize=11,e.underline="None",e.strikethrough="None",e.fontSizeBidi=11,e.fontFamilyBidi="Calibri",e.baselineAlignment="Normal",e.highlightColor="NoColor",e.allCaps=!1},e.prototype.setDefaultParagraphValue=function(e){e.leftIndent=0,e.rightIndent=0,e.firstLineIndent=0,e.textAlignment="Left",e.beforeSpacing=0,e.afterSpacing=0,e.lineSpacing=1,e.lineSpacingType="Multiple",e.bidi=!1,e.keepWithNext=!1,e.keepLinesTogether=!1,e.widowControl=!0,e.outlineLevel="BodyText"},e.prototype.getAbstractListById=function(e,t){if(!(0,a.isNullOrUndefined)(this.abstractLists))for(var i=0;i<this.abstractLists.length;i++){var n=this.abstractLists[i];if(!(0,a.isNullOrUndefined)(n)){if(t&&n.nsid===e)return n;if(n.abstractListId===e)return n}}},e.prototype.getListById=function(e,t){if(!(0,a.isNullOrUndefined)(this.lists))for(var i=0;i<this.lists.length;i++){var n=this.lists[i];if(!(0,a.isNullOrUndefined)(n)){if(t&&n.nsid===e)return n;if(n.listId===e)return n}}},e.getListLevelNumber=function(e){return e.ownerBase instanceof Ua?e.ownerBase.levelNumber:e.ownerBase instanceof Aa&&!(0,a.isNullOrUndefined)(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},e.prototype.getImageString=function(e){var t=this.images.get(parseInt(e.imageString));return e.isMetaFile&&".svg"!==Pa.formatClippedString(t[0]).extension||".tif"===Pa.formatClippedString(t[0]).extension?t[1]:t[0]},e.prototype.addBase64StringInCollection=function(e){return bl(this,void 0,void 0,(function(){var t,i,n,r,o,s;return Cl(this,(function(l){for(t=this.images.length>0?Math.max.apply(Math,this.images.keys)+1:0,i=!0,n=[],r=0;r<this.images.length;r++){if(o=this.images.keys[parseInt(r.toString(),10)],s=this.images.get(o),e.isMetaFile&&e.metaFileImageString===s[0]){t=o,i=!1;break}if(e.imageString===s[0]){t=o,i=!1;break}}return i&&(e.isMetaFile?(n.push((0,a.isNullOrUndefined)(e.metaFileImageString)?e.imageString:e.metaFileImageString),n.push(""===e.imageString?e.metaFileImageString:e.imageString)):n.push(e.imageString),this.images.add(t,n)),e.isMetaFile&&!(0,a.isNullOrUndefined)(e.metaFileImageString)&&(e.metaFileImageString=t.toString()),e.imageString=t.toString(),[2]}))}))},e.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var n=this.bookmarks.keys[i];(e||0!==n.indexOf("_"))&&t.push(n)}return t},e.prototype.selectComment=function(e){var t=this;this.owner.selectionModule&&this.owner.commentReviewPane&&(this.owner.showComments=!0,setTimeout((function(){t.owner&&t.owner.selectionModule&&t.owner.selectionModule.selectComment(e)})))},e.prototype.showComments=function(e){if(this.owner&&e&&this.owner.enableComment){this.owner.trigger(L,{type:"Comment"})}this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.reviewTab.hideTab(1,!1),this.owner.commentReviewPane.showHidePane(e&&this.owner.enableComment,"Comments")},e.prototype.showRevisions=function(e){if(this.showRevision=e,this.owner&&e){this.owner.trigger(L,{type:"comment"})}!e&&this.owner.showComments?(this.owner.commentReviewPane.reviewTab.hideTab(0,!1),this.owner.commentReviewPane.showHidePane(!0,"Comments")):(this.owner.commentReviewPane.showHidePane(e,"Changes"),this.owner.enableComment||!0,this.showRevision=!1),e&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly&&!this.isDocumentProtected)},e.prototype.initializeComponents=function(){var e,t=this.owner.element;(0,a.isNullOrUndefined)(t)||(this.optionsPaneContainer=(0,a.createElement)("div",{className:"e-documenteditor-optionspane"}),this.optionsPaneContainer.contentEditable="false",t.appendChild(this.optionsPaneContainer),this.owner.enableRtl&&(e="direction:ltr;"),this.viewerContainer=(0,a.createElement)("div",{id:this.owner.containerId+"_viewerContainer"}),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;"+e,this.optionsPaneContainer.appendChild(this.viewerContainer),this.viewerContainer.tabIndex=-1,this.viewerContainer.style.outline="none",this.pageContainer=(0,a.createElement)("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",a.Browser.isDevice?this.createEditableDiv(t):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(t),this.layout=new _a(this),this.textHelper=new za(this),this.zoomModule=new $a(this),this.initTouchEllipse(),this.wireEvent(),this.restrictEditingPane=new ll(this),this.owner.commentReviewPane=new Oh(this.owner),this.owner.trackChangesPane=new ul(this.owner,this.owner.commentReviewPane),(0,el.createSpinner)({target:this.owner.element,cssClass:"e-spin-overlay"}))},e.prototype.measureScrollbarWidth=function(e){var t=document.createElement("div");t.setAttribute("style","visibility:hidden;overflow:scroll"),e.appendChild(t);var i=document.createElement("div");t.appendChild(i),this.scrollbarWidth=t.getBoundingClientRect().width-i.getBoundingClientRect().width,t.parentNode.removeChild(t)},e.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable=this.owner.isReadOnlyMode?"false":"true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},e.prototype.createEditableIFrame=function(){this.iframe=(0,a.createElement)("iframe",{attrs:{scrolling:"no",title:"Document Editor",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden",tabindex:"0"},className:"e-de-text-target"}),this.viewerContainer.appendChild(this.iframe),this.initIframeContent()},e.prototype.initIframeContent=function(){var e="background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;",t='<!DOCTYPE html><html lang="'+this.owner.locale+'"><head></head><body spellcheck="false" style='+e+' ><div contenteditable="true" style='+e+"></div></body></html>";(0,a.isNullOrUndefined)(this.iframe.contentDocument)||(this.iframe.contentDocument.open(),this.iframe.contentDocument.write(t),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0])},e.prototype.wireEvent=function(){(0,a.isNullOrUndefined)(this.owner.selectionModule)||this.selection.initCaret(),this.wireInputEvents(),(0,a.isNullOrUndefined)(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this)),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal),this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer),window.addEventListener("touchend",this.onImageResizer),window.addEventListener("copy",this.onCopy),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal),this.editableDiv.addEventListener("focus",this.updateFocus)},e.prototype.wireInputEvents=function(){(0,a.isNullOrUndefined)(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),a.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===a.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},e.prototype.onIframeLoad=function(){(0,a.isNullOrUndefined)(this.iframe)||0!==this.iframe.contentDocument.body.children.length||(this.initIframeContent(),this.wireInputEvents())},e.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},e.prototype.updateAuthorIdentity=function(){for(var e=this.owner.revisions.changes,t=0;t<e.length;t++)this.getAuthorColor(e[t].author)},e.prototype.getAvatar=function(e,t,i,n){var r,o;if((0,a.isNullOrUndefined)(i)?r=n.author:(r=i.author,o=i.initial),!(0,a.isNullOrUndefined)(r)){var s=(0,a.createElement)("div",{className:"e-de-cmt-avatar"}),l=(0,a.createElement)("div",{className:"e-de-ff-cmt-avatar"});if(l.style.backgroundColor=this.owner.documentHelper.getAuthorColor(r),""===o||(0,a.isNullOrUndefined)(o)){var d=r.split(" "),h=d[0].charAt(0);d.length>1&&""!==d[d.length-1]&&(h+=d[d.length-1][0]),l.innerText=h.toUpperCase()}else o.length>2?l.innerText=o.substring(0,2):l.innerText=o;s.appendChild(l),s.appendChild(t),e.appendChild(s)}},e.prototype.getAuthorColor=function(e){return this.authors.containsKey(e)?this.authors.get(e):(t=0===this.authors.length?"#b5082e":this.generateRandomColor(),this.authors.add(e,t),t);var t},e.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},e.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=t.bodyWidgets[0].sectionFormat,n=t.boundingRectangle.x+Pa.convertPointToPixel(i.leftMargin)*this.zoomFactor,r=e.y,o=i.pageWidth-i.leftMargin-i.rightMargin,s="left:"+n+"px;";s+="top:"+r+"px;",s+="width:"+Pa.convertPointToPixel(o)*this.zoomFactor+"px;",s+="height:250px;outline-style:none;position:absolute",this.iframe.setAttribute("style",s);var a="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";a+="text-indent:"+(e.x-n)+"px;",a+="color:transparent;pointer-events:none;outline-style:none;",a+="font-size:"+Pa.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;",a+="font-family"+this.selection.characterFormat.fontFamily+";",a+="overflow:hidden;text-decoration:none;white-space:normal;",this.editableDiv.setAttribute("style",a)},e.prototype.initDialog=function(e){this.dialogInternal||(this.dialogTarget1=(0,a.createElement)("div",{className:"e-de-dlg-target"}),this.dialogTarget1.contentEditable="false",document.body.appendChild(this.dialogTarget1),e&&this.dialogTarget1.classList.add("e-de-rtl"),this.dialogInternal=new el.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex+20,animationSettings:{effect:"None"}}),this.dialogInternal.isStringTemplate=!0,this.dialogInternal.open=this.selection.hideCaret,this.dialogInternal.beforeClose=this.updateFocus,this.dialogInternal.appendTo(this.dialogTarget1))},e.prototype.initDialog3=function(e){this.dialogInternal3||(this.dialogTarget3=(0,a.createElement)("div",{className:"e-de-dlg-target"}),this.dialogTarget3.contentEditable="false",document.body.appendChild(this.dialogTarget3),e&&this.dialogTarget3.classList.add("e-de-rtl"),this.dialogInternal3=new el.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:this.owner.zIndex,animationSettings:{effect:"None"}}),this.dialogInternal3.isStringTemplate=!0,this.dialogInternal3.open=this.selection.hideCaret,this.dialogInternal3.beforeClose=this.updateFocus,this.dialogInternal3.appendTo(this.dialogTarget3))},e.prototype.hideDialog=function(){this.dialog.hide(),this.updateFocus()},e.prototype.initDialog2=function(e){this.dialogInternal2||(this.dialogTarget2=(0,a.createElement)("div",{className:"e-de-dlg-target"}),this.dialogTarget2.contentEditable="false",document.body.appendChild(this.dialogTarget2),e&&this.dialogTarget2.classList.add("e-de-rtl"),this.dialogInternal2=new el.Dialog({target:this.owner.documentEditorSettings.popupTarget,showCloseIcon:!0,allowDragging:!0,enableRtl:e,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"Top"},zIndex:this.owner.zIndex+10}),this.dialogInternal2.isStringTemplate=!0,this.dialogInternal2.appendTo(this.dialogTarget2))},e.prototype.getBase64=function(e,t,i){return bl(this,void 0,void 0,(function(){return Cl(this,(function(n){return[2,new Promise((function(n,r){var o=new Image;o.onload=function(){var e=Math.max(1,window.devicePixelRatio||1),r=document.createElement("canvas");r.width=t*e,r.height=i*e;var s=r.getContext("2d");s.scale(e,e),s.drawImage(o,0,0,t,i);var a=r.toDataURL("image/png",1);n(a)},o.onerror=function(){r()},e&&(Pa.startsWith(e,"http://")||Pa.startsWith(e,"https://"))&&fetch(e,{cache:"no-cache"}).then((function(e){return e.blob()})).then((function(e){return new Promise((function(t,i){var n=new FileReader;n.onloadend=function(){return t(n.result)},n.onerror=i,n.readAsDataURL(e)}))})).then((function(e){o.src=e})).catch((function(){r()}))}))]}))}))},e.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var e=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),t=0;t<e.length;t++)e[t].style.display="none";if(this.pageContainer){var i=this.pageContainer.getElementsByClassName("e-de-lock-mark");for(t=0;t<i.length;t++)i[t].style.display="none"}},e.prototype.onDocumentChanged=function(e,t){var i=this;this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1,this.viewer.columnLayoutArea.clear(),this.layout.isDocumentContainsRtl=!1,this.layout.isMultiColumnDoc=!1,this.isMappedContentControlUpdated=!0,this.isSpellCheckPending=!1,this.updateAuthorIdentity();for(var n=0;n<this.pages.length;n++)for(var r=0;r<this.pages[n].bodyWidgets.length;r++)this.pages[n].bodyWidgets[r].destroy();if(this.pages=[],(0,a.isNullOrUndefined)(this.renderedLists)||this.renderedLists.clear(),(0,a.isNullOrUndefined)(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]),(0,a.isNullOrUndefined)(this.owner.editorHistoryModule)||this.owner.editorHistoryModule.destroy(),this.owner.isDocumentLoaded=!0,this.owner.isUpdateTrackChanges=!1,this.layout.isInitialLoad=!0,this.layout.footHeight=0,this.layout.footnoteHeight=0,this.layout.layoutItems(e,!1),this.owner.selectionModule&&(this.selection.previousSelectedFormField=void 0,this.formFields.length>0&&this.owner.selectionModule.highlightFormFields(),this.owner.selectionModule.editRangeCollection=[],this.owner.selectionModule.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&"FormFieldsOnly"==this.protectionType&&this.owner.selectionModule.navigateToNextFormField(),this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!0)),!(0,a.isNullOrUndefined)(t)&&this.owner.editorModule&&this.owner.editorModule.intializeDefaultStyles(),this.owner.enableCollaborativeEditing&&this.owner.collaborativeEditingHandlerModule&&this.owner.enableEditor){if(this.owner.editorModule.isRemoteAction=!0,this.owner.editorModule.isIncrementalSave=!0,t&&!(0,a.isNullOrUndefined)(t[ha[0]])&&!(0,a.isNullOrUndefined)(t[ha[0]].length>0))for(var o=0;o<t[ha[0]].length;o++)this.owner.collaborativeEditingHandlerModule.applyRemoteAction("action",t[ha[0]][o]);this.owner.editorModule.isRemoteAction=!1,this.owner.editorModule.isIncrementalSave=!1,this.owner.selectionModule.selectRange(this.owner.documentStart,this.owner.documentStart)}this.owner.optionsPaneModule&&this.owner.optionsPaneModule.showHideOptionsPane(!1),this.restrictEditingPane.restrictPane&&!this.isDocumentProtected&&this.restrictEditingPane.showHideRestrictPane(!1),this.owner.xmlPaneModule&&(this.owner.editor.XMLFilesNameSpaceCount=1,this.owner.xmlPaneModule.showXmlProperties(!1),this.owner.xmlPaneModule.isXmlPaneShow=!1),!(0,a.isNullOrUndefined)(this.owner.selectionModule)&&this.owner.selectionModule.isViewPasteOptions&&(this.owner.selectionModule.isViewPasteOptions=!1,this.owner.selectionModule.showHidePasteOptions(void 0,void 0)),this.owner.fireDocumentChange(),this.owner.showHideRulers(),setTimeout((function(){!(0,a.isNullOrUndefined)(i.owner)&&i.owner.showRevisions&&i.showRevisions(!0),(0,a.isNullOrUndefined)(i.owner)||(i.owner.isUpdateTrackChanges=!0)}));var s=document.getElementById(this.owner.element.id+"PICTURE_CONTENT_CONTROL");(0,a.isNullOrUndefined)(s)||this.owner.renderPictureContentControlElement(this.owner,!1,!1),this.layout.isInitialLoad=!1},e.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;";this.touchStart=(0,a.createElement)("div",{className:"e-touch-ellipse",styles:e});var i=(0,a.createElement)("div",{styles:t});this.touchEnd=(0,a.createElement)("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none";var n=(0,a.createElement)("div",{styles:t});this.touchStart.appendChild(i),this.touchEnd.appendChild(n),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},e.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!(0,a.isNullOrUndefined)(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var e=this.selection.getCaretBottom(this.selection.start,!1),t=this.selection.getPage(this.selection.start.paragraph),i=t.boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(t)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(t)+1);this.touchStart.style.left=t.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=i+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),t=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=t.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=i+e*this.zoomFactor+"px"}},e.prototype.autoScrollOnSelection=function(e){var t=this;this.scrollMoveTimer&&(e.y<=0||e.y>50||e.y<this.viewerContainer.offsetHeight-50)?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=0):e.y<60?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval((function(){t.viewerContainer.scrollTop-=20,setTimeout((function(){var i=t.owner.viewer.findFocusedPage(e,!t.owner.enableHeaderAndFooter),n=t.getLineWidget(i);t.selection.updateTextPosition(n,i)}),200)}),200)):e.y>this.viewerContainer.offsetHeight-70&&(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval((function(){t.viewerContainer.scrollTop+=20,setTimeout((function(){var i=t.owner.viewer.findFocusedPage(e,!t.owner.enableHeaderAndFooter),n=t.getLineWidget(i);t.selection.updateTextPosition(n,i)}),200)}),200))},e.prototype.scrollForwardOnSelection=function(e){if(this.viewerContainer){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selectionModule.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selectionModule.moveTextPosition(t,i,!0))}},e.prototype.scrollBackwardOnSelection=function(e){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selectionModule.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selectionModule.moveTextPosition(t,i,!0))},e.prototype.navigateToEndNote=function(e,t,i){for(var n,r=this.pages.length-1;r>=0&&(n=this.pages[r].endnoteWidget,!(0,a.isNullOrUndefined)(n));){for(var o=0;o<n.bodyWidgets.length;o++)if((0,a.isNullOrUndefined)(n.bodyWidgets[o].previousSplitWidget)){var s=n.bodyWidgets[o].footNoteReference;if(e.text===s.text){t.setPositionParagraph(n.bodyWidgets[o].childWidgets[0].childWidgets[0],0),i.setPositionParagraph(n.bodyWidgets[o].childWidgets[0].childWidgets[0],0),this.selection.selectRange(t,i);break}}r--}},e.prototype.moveSelectedContent=function(){this.isDragStarted=!1;var e=this.owner.editor.getSelectionInfo(!0);this.owner.selection.start.paragraph.isInsideTable&&(e=this.owner.selection.updateSelectionInfo(e));var t=this.selection.getTextPosBasedOnLogicalIndex(e.start),i=this.selection.getTextPosBasedOnLogicalIndex(e.end);this.selection.isForward||(t=this.selection.getTextPosBasedOnLogicalIndex(e.end),i=this.selection.getTextPosBasedOnLogicalIndex(e.start));var n=this.selection.getParagraphInfo(t),r=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),a=this.selection.getTextPosBasedOnLogicalIndex(o),l=this.selection.getTextPosBasedOnLogicalIndex(s),d=this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph,this.dragStartParaInfo.offset.toString()),h=this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph,this.dragEndParaInfo.offset.toString()),c=this.selection.getTextPosBasedOnLogicalIndex(d),p=this.selection.getTextPosBasedOnLogicalIndex(h),u=!1;if(n.paragraph===c.paragraph&&(u=!0),a.isExistBefore(c)||l.isExistAfter(p)){this.owner.editorModule.initComplexHistory("DragAndDropContent"),this.selection.start=c,this.selection.end=p;var g=this.owner.enableLocalPaste;g||(this.owner.enableLocalPaste=!0);var m=this.dragEndParaInfo.paragraph.getLength(),f=!1;(m<this.dragEndParaInfo.offset||!this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph))&&(f=!0),this.owner.editorModule.cut(),this.dragEndParaInfo.paragraph.equals(n.paragraph)&&this.dragEndParaInfo.offset<n.offset&&!this.owner.enableTrackChanges&&(m-=this.dragEndParaInfo.paragraph.getLength(),n.offset-=m,r.offset-=m,o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())),f&&(this.dragEndParaInfo.paragraph.equals(r.paragraph)||u)||(o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())),a=this.selection.getTextPosBasedOnLogicalIndex(o),l=this.selection.getTextPosBasedOnLogicalIndex(s),this.selection.start=a,this.selection.end=l,this.owner.editorModule.copiedTextContent="",this.owner.editorModule.paste(),g||(this.owner.enableLocalPaste=!1),this.owner.editorHistoryModule.updateComplexHistory()}else this.owner.selectionModule.selectPosition(c,p);this.dragStartParaInfo=void 0,this.dragEndParaInfo=void 0,this.selection.caret.classList.add("e-de-cursor-animation")},e.prototype.isSelectionInListText=function(e){var t=this.getLineWidget(e);if(!(0,a.isNullOrUndefined)(t)&&t.children[0]instanceof md){var i=this.getLeftValue(t),n=t.children[0].width,r=t.children[0].height;if(this.isInsideRect(i,t.paragraph.y,n,r,e))return this.selectionLineWidget=t,!0}return!1},e.prototype.isInShapeBorder=function(e,t){if(!(0,a.isNullOrUndefined)(e)){var i=e.width,n=e.height;if(this.isInsideRect(e.x-e.margin.left,e.y-e.margin.top,i,n,t)){if(e instanceof gd)return!0;if(e instanceof hd){var r=e.lineFormat.weight;if(!this.isInsideRect(e.x+r,e.y+r+e.textFrame.marginTop,i-2*r,n-(2*r+e.textFrame.marginTop+e.textFrame.marginBottom),t))return!0}}}return!1},e.prototype.isInsideRect=function(e,t,i,n,r){return r.x>e&&r.x<=e+i&&r.y>t&&r.y<=t+n},e.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?(t-=Pa.convertPointToPixel(i.firstLineIndent),t-=Pa.convertPointToPixel(i.leftIndent)):t+=Pa.convertPointToPixel(i.firstLineIndent));var n=e.children[0];return n instanceof md&&(t+=n.margin.left),t},e.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},e.prototype.updateSelectionOnTouch=function(e,t){this.zoomX=void 0,this.zoomY=void 0,!this.isMouseDown||this.isSelectionChangedOnMouseMoved||(0,a.isNullOrUndefined)(this.currentPage)||(0,a.isNullOrUndefined)(this.owner.selectionModule.start)||((0,a.isNullOrUndefined)(this.currentSelectedComment)||!this.owner.commentReviewPane||this.owner.commentReviewPane.commentPane.isEditMode||(this.currentSelectedComment=void 0),0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new Sa(t.x,t.y),this.tapCount),2===this.tapCount&&this.selection.checkAndEnableHeaderFooter(e,t)),this.owner.selectionModule.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},e.prototype.getTouchOffsetValue=function(e){var t=this.viewerContainer.getBoundingClientRect(),i=e.touches[0];(0,a.isNullOrUndefined)(i)&&(i=e.changedTouches[0]);var n=i.clientX-t.left,r=i.clientY-t.top;return new Sa(n,r)},e.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&t>2&&(t-=.01),t<.1&&(t=.1),this.zoomFactor=t},e.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;t>2&&(t+=.01),t>5&&(t=5),this.zoomFactor=t},e.prototype.getPageWidth=function(e){return e.boundingRectangle.width},e.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0),e.headerWidgetIn&&(e.headerWidgetIn.page=void 0),e.footerWidgetIn&&(e.footerWidgetIn.page=void 0),e.headerWidget&&e.headerWidget.page===e&&(e.headerWidget.page=void 0),e.footerWidget&&e.footerWidget.page===e&&(e.footerWidget.page=void 0);var t=this.pages.indexOf(e);if(t>-1&&this.pages.splice(t,1),!(0,a.isNullOrUndefined)(this.owner.viewer.visiblePages)&&this.owner.viewer.visiblePages.indexOf(e)>-1){var i=this.owner.viewer.visiblePages.indexOf(e);this.owner.viewer.visiblePages.splice(i,1)}for(var n=0;n<this.pages.length;n++)this.pages[n].boundingRectangle.height;e.boundingRectangle.height;var r=20;if(t>0&&(r+=this.pages[t-1].boundingRectangle.bottom),-1!==t)for(n=t;n<this.pages.length;n++)(e=this.pages[n]).boundingRectangle=new Tl(e.boundingRectangle.x,r,e.boundingRectangle.width,e.boundingRectangle.height),r=e.boundingRectangle.bottom+20,!(e.bodyWidgets.length>0)||(0,a.isNullOrUndefined)(e.bodyWidgets[0].firstChild)||e.bodyWidgets[0].firstChild instanceof Al&&e.bodyWidgets[0].firstChild.header||(e.repeatHeaderRowTableWidget=!1)},e.prototype.updateViewerSize=function(){var e=this,t=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(t),this.owner.viewer.updateScrollBars(),this.owner.viewer instanceof Fl&&!(0,a.isNullOrUndefined)(this.owner)&&!(0,a.isNullOrUndefined)(t)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout((function(){if(!(0,a.isNullOrUndefined)(e.owner)){var t=void 0;t=(0,a.isNullOrUndefined)(e.visibleBounds)?0:e.visibleBounds.width,(0,a.isNullOrUndefined)(e.owner.viewer.preVisibleWidth)&&(e.owner.viewer.preVisibleWidth=0),(0,a.isNullOrUndefined)(e.visibleBounds)||t===e.owner.viewer.preVisibleWidth||(e.owner.editorModule.layoutWholeDocument(),e.owner.viewer.preVisibleWidth=t),e.resizerTimer&&clearTimeout(e.resizerTimer)}}),50)),(0,a.isNullOrUndefined)(this.selection)||this.selection.updateCaretPosition()},e.prototype.triggerAutoResizeInterval=function(){var e=this,t=0,i=this.owner.element,n={cancel:!1};this.owner.notify(J,n),(0,a.isNullOrUndefined)(n.element)||(i=n.element),i.style.visibility="hidden",(0,el.showSpinner)(i);var r=0,o=this.owner.documentEditorSettings.autoResizeSettings.interval;this.isAutoResizeCanStart?t=setInterval((function(){r++;var n=e.owner.element.getBoundingClientRect();if(0!==n.width&&0!==n.height){e.isAutoResizeCanStart=!1;var o={cancel:!1};e.owner.notify(Z,o),clearInterval(t),o.cancel||e.owner.resize(),(0,el.hideSpinner)(i),i.style.visibility="visible"}else r>e.owner.documentEditorSettings.autoResizeSettings.iterationCount&&(clearInterval(t),(0,el.hideSpinner)(i),i.style.visibility="visible")}),o):((0,el.hideSpinner)(i),i.style.visibility="visible")},e.prototype.updateViewerSizeInternal=function(e){if(!(0,a.isNullOrUndefined)(e)){var t=getComputedStyle(e),i=parseFloat(t.height.replace("px","")),n=parseFloat(t.width.replace("px",""));this.isAutoResizeCanStart=0===n&&0===i;var r=0,o=0;o=i>0?i:200;var s=this.restrictEditingPane&&this.restrictEditingPane.isShowRestrictPane?this.getComputedWidth(this.restrictEditingPane.restrictPane):void 0,l=this.owner.optionsPaneModule&&this.owner.optionsPaneModule.isOptionsPaneShow?this.getComputedWidth(this.owner.optionsPaneModule.optionsPane):void 0,d=0;this.owner.commentReviewPane&&this.owner.commentReviewPane.parentPaneElement&&(d=this.getComputedWidth(this.owner.commentReviewPane.parentPaneElement));var h=this.owner.xmlPaneModule&&this.owner.xmlPaneModule.isXmlPaneShow?this.getComputedWidth(this.owner.xmlPaneModule.element):void 0;if(s||l||d||h){var c=s||0;c+=l||0,c+=d||0,r=n-(c+=h||0)>0?n-c:200}else r=n>0?n:200;this.viewerContainer.style.height=o.toString()+"px",this.viewerContainer.style.width=Math.ceil(r)+"px",this.visibleBoundsIn=new Tl(0,0,r,o),this.containerCanvas.width=r,this.containerCanvas.height=o,this.containerCanvas.style.width=r+"px",this.containerCanvas.style.height=o+"px",this.selectionCanvas.width=r,this.selectionCanvas.height=o,this.selectionCanvas.style.width=r+"px",this.selectionCanvas.style.height=o+"px",this.measureScrollbarWidth(e)}},e.prototype.getComputedWidth=function(e){var t=getComputedStyle(e);return"block"===t.display?parseFloat(t.width.replace("px","")):0},e.prototype.insertPage=function(e,t){this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;e>0&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var n=e;n<this.pages.length;n++)(t=this.pages[n]).boundingRectangle=new Tl(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},e.prototype.updateTextPositionForSelection=function(e,t){var i=this.getLineWidget(e);if((0,a.isNullOrUndefined)(i)||this.selection.updateTextPosition(i,e),t>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;(0,a.isNullOrUndefined)(this.currentPage)||(0,a.isNullOrUndefined)(this.owner.selectionModule.start)||(t%2==0?this.owner.selectionModule.selectCurrentWord():this.isDragStarted||this.owner.selectionModule.selectParagraph())}},e.prototype.scrollToPosition=function(e,t,i,n){if(this.skipScrollToPosition||this.isWebPrinting||this.owner.editorModule&&this.owner.editorModule.isRemoteAction)this.skipScrollToPosition=!1;else if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var r=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0);if(!(0,a.isNullOrUndefined)(r)){this.selection.getTop(r);if(this.isMouseDown){var o=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),s=this.selection.getTop(o);o!==r&&t.location.y>=s&&(r=o)}r.height;var l=this.selection.getPage(r.paragraph);this.currentPage=l;var d=0,h=0;this.owner.viewer,this.owner.viewer;if(!(0,a.isNullOrUndefined)(l)){var c=l.boundingRectangle.width;(d=(this.visibleBounds.width-c*this.zoomFactor)/2)<30&&(d=30),h=l.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(l)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor);var p=this.viewerContainer.scrollTop,u=this.viewerContainer.scrollLeft,g=this.visibleBounds.height,m=this.selection.updateCaretSize(this.owner.selectionModule.end,!0),f=m.topMargin,v=m.height;d+=t.location.x*this.zoomFactor,h+=(t.location.y+f)*this.zoomFactor,n?this.viewerContainer.scrollTop=h-96:p+20>h?this.viewerContainer.scrollTop=h-10:p+g<h+v&&(this.viewerContainer.scrollTop=h+v-g+10),i||this.selection.updateCaretToPage(e,l);var y=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;if(u>d)this.viewerContainer.scrollLeft=d-this.pageContainer.offsetWidth/100*20;else if(u+this.visibleBounds.width<d+y)for(this.viewerContainer.scrollLeft=u+this.pageContainer.offsetWidth/100*15+y;d<this.owner.viewer.containerWidth&&this.viewerContainer.scrollLeft+this.visibleBounds.width<d+y&&(this.viewerContainer.scrollLeft=this.viewerContainer.scrollLeft+this.pageContainer.offsetWidth/100*15+y,0!==this.viewerContainer.scrollLeft););}}}},e.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},e.prototype.getLineWidgetInternal=function(e,t){var i=void 0;if(!(0,a.isNullOrUndefined)(this.currentPage)){var n=void 0;if(this.owner.enableHeaderAndFooter){var r=this.currentPage,o=r.boundingRectangle.height,s=Math.max(r.headerWidget.y+r.headerWidget.height,Pa.convertPointToPixel(r.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,l=Pa.convertPointToPixel(r.bodyWidgets[0].sectionFormat.footerDistance),d=r.boundingRectangle.height-Math.max(r.footerWidget.height+l,2*l);if(t?n=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=o&&e.y>=d?n=this.currentPage.footerWidget:e.y>=0&&e.y<=s&&(n=this.currentPage.headerWidget),(0,a.isNullOrUndefined)(n))return;var h=this.checkFloatingItems(n,e,t);return h.isShapeSelected?h.isInShapeBorder?h.element.line:this.selection.getLineWidgetBodyWidget(h.element.textFrame,e):this.selection.getLineWidgetBodyWidget(n,e)}for(var c=void 0,p=void 0,u=0;u<this.currentPage.bodyWidgets.length;u++){var g=this.currentPage.bodyWidgets[u];if(c=this.checkFloatingItems(g,e,t,!1),p=this.checkFloatingItems(g,e,t,!0),c.isShapeSelected||p.isShapeSelected)break}if(c.isShapeSelected&&!this.isEmptyShape(c)){if(c.isInShapeBorder)return c.element.line;c.element instanceof hd&&(i=this.selection.getLineWidgetBodyWidget(c.element.textFrame,e))}else if(t&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof Dl&&"Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e);if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof Dl&&"Endnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e)}else{if(!t&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e))&&(this.isFootnoteWidget=!0);else if(!t&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e))&&(this.isFootnoteWidget=!0);else for(var m=0;m<this.currentPage.bodyWidgets.length;m++){var f=this.currentPage.bodyWidgets[m];if(m<this.currentPage.bodyWidgets.length-1&&e.x<=f.x+f.width&&(i=this.selection.getLineWidgetBodyWidget(f,e,!0),!(0,a.isNullOrUndefined)(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x>f.x+f.width&&this.layout.getNextWidgetHeight(f)>=e.y&&f.y<=e.y&&((0,a.isNullOrUndefined)(f.nextRenderedWidget)||!(this.layout.getNextWidgetHeight(f.nextRenderedWidget)>=e.y&&f.nextRenderedWidget.y<=e.y))&&(i=this.selection.getLineWidgetBodyWidget(f,e,!0),!(0,a.isNullOrUndefined)(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(m==this.currentPage.bodyWidgets.length-1&&(i=this.selection.getLineWidgetBodyWidget(f,e,!0),!(0,a.isNullOrUndefined)(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x<f.x&&m<this.currentPage.bodyWidgets.length-1){if(i=this.selection.getLineWidgetBodyWidget(f,e,!0),!(0,a.isNullOrUndefined)(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(!(0,a.isNullOrUndefined)(i)&&m===this.currentPage.bodyWidgets.length-1){this.isFootnoteWidget=!1;break}}}var v=this.checkInlineShapeItems(i,e,t);if(v.isShapeSelected){if(v.isInShapeBorder)return v.element.line;v.element instanceof hd&&(i=this.selection.getLineWidgetBodyWidget(v.element.textFrame,e))}else if(!this.checkPointIsInLine(i,e)&&p.isShapeSelected){if(p.isInShapeBorder)return p.element.line;p.element instanceof hd&&(i=this.selection.getLineWidgetBodyWidget(p.element.textFrame,e))}}}return i},e.prototype.checkInlineShapeItems=function(e,t,i){var n,r=!1,o=!1,s=this.selection.isInShape,l=i&&s;if(!(0,a.isNullOrUndefined)(e)&&e.children.length>0)if(l){var d=this.owner.selectionModule.getCurrentTextFrame();d&&(n=d.containerShape,r=!0)}else{for(var h=0;h<e.children.length;h++)if(e.children[h]instanceof hd&&"Inline"===e.children[h].textWrappingStyle&&(n=e.children[h],t.x<n.x+n.margin.left+n.width&&t.x>n.x&&t.y<n.y+n.margin.top+n.height&&t.y>n.y)){r=!0,this.isInShapeBorder(n,t)&&(o=!0);break}i&&!s&&(r=!1)}return{element:n,caretPosition:t,isInShapeBorder:o,isShapeSelected:r}},e.prototype.checkPointIsInLine=function(e,t){if(!(0,a.isNullOrUndefined)(e)&&e.children.length>0){for(var i=void 0,n=e.paragraph.x,r=this.selection.getTop(e),o=e.children.indexOf(e.children[0]);o<e.children.length;o++)if(!((i=e.children[o])instanceof dd&&"Inline"!==i.textWrappingStyle)){if(t.x<n+i.margin.left+i.width+i.padding.left&&t.x>n&&t.y<r+e.height&&t.y>r)return!0;n+=i.margin.left+i.width+i.padding.left}}else if(!(0,a.isNullOrUndefined)(e)&&0===e.children.length){n=e.paragraph.x;var s=this.selection.getTop(e);if(t.x<n+e.width&&t.x>n&&t.y<s+e.height&&t.y>s)return!0}return!1},e.prototype.isInFootnoteWidget=function(e,t){for(var i=0;i<e.bodyWidgets.length;i++)for(var n=0;n<e.bodyWidgets[i].childWidgets.length;n++){var r=e.bodyWidgets[i].childWidgets[n];if(r instanceof Nl&&r.y<=t.y&&r.y+r.height>=t.y)return!0}return!1},e.prototype.checkFloatingItems=function(e,t,i,n){var r,o=!1,s=!1,l=this.selection.isInShape,d=i&&l;if(e.floatingElements.length>0){this.currentPage;if(e.floatingElements.sort((function(e,t){return e instanceof Al||t instanceof Al?0:e.zOrderPosition-t.zOrderPosition})),d){var h=this.owner.selectionModule.getCurrentTextFrame();h&&(r=h.containerShape,o=!0)}else{for(var c=e.floatingElements.length-1;c>=0;c--)if(!(e.floatingElements[c]instanceof Al||(!(0,a.isNullOrUndefined)(n)&&n?"Behind"!==e.floatingElements[c].textWrappingStyle:"Behind"===e.floatingElements[c].textWrappingStyle))&&(r=e.floatingElements[c],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){o=!0,this.isInShapeBorder(r,t)&&(s=!0);break}i&&!l&&(o=!1)}}return{element:r,caretPosition:t,isShapeSelected:o,isInShapeBorder:s}},e.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof Bl);){if(!e.containerWidget)return!1;(e=e.containerWidget)instanceof cd&&(e=e.containerShape.paragraph)}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},e.prototype.clearSelectionHighlight=function(){!this.isControlPressed||this.isMouseDown,this.owner.selectionModule.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},e.prototype.removeEmptyPages=function(e){for(var t=!1,i=!1,n=this.selection.startPage-1,r=0;r<this.pages.length;r++){for(var o=this.pages[r],s=0;s<o.bodyWidgets.length;s++)if((0===o.bodyWidgets.length||0===o.bodyWidgets[s].childWidgets.length)&&o.bodyWidgets.length>=1){var l=o.bodyWidgets.indexOf(o.bodyWidgets[s]);o.bodyWidgets.splice(l,1),s--}if(o.bodyWidgets.length<=0){if(r===this.pages.length-1&&this.owner.viewer instanceof kl&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[r])&&(t=!0),!(0,a.isNullOrUndefined)(o.endnoteWidget)&&o.endnoteWidget.bodyWidgets.length>0){var d=o.endnoteWidget,h=o.previousPage;if(!(0,a.isNullOrUndefined)(h)){(0,a.isNullOrUndefined)(h.endnoteWidget)&&(h.endnoteWidget=new Dl,h.endnoteWidget.footNoteType="Endnote",h.endnoteWidget.page=h);for(var c=0;c<d.bodyWidgets.length;c++){var p=d.bodyWidgets[c],u=!1;if(h.endnoteWidget.bodyWidgets.length>0){var g=h.endnoteWidget.bodyWidgets[h.endnoteWidget.bodyWidgets.length-1];p.index===g.index&&p.footNoteReference===g.footNoteReference&&(g.combineWidget(this.owner.viewer),d.bodyWidgets.splice(c,1),u=!0)}u||(d.bodyWidgets.splice(c,1),p.index=h.endnoteWidget.bodyWidgets.length,h.endnoteWidget.bodyWidgets.push(p),p.containerWidget=h.endnoteWidget,p.page=h),c--}(0,a.isNullOrUndefined)(o.endnoteWidget)||0!==o.endnoteWidget.bodyWidgets.length||(o.endnoteWidget=void 0),i=!0,t=!1}}-1===this.pages.indexOf(o)||(0,a.isNullOrUndefined)(this.pages[r])||this.removePage(this.pages[r]),r--}}(0,a.isNullOrUndefined)(this.pages[n])||((o=this.pages[n]).headerWidget&&(o.headerWidget.page=o),o.footerWidget&&(o.footerWidget.page=o));i&&!e&&this.layout.reLayoutEndnote(),t&&this.scrollToBottom()},e.prototype.scrollToBottom=function(){if(this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget){var e=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height;this.viewerContainer.scrollTop=e.boundingRectangle.bottom-t}},e.prototype.getFieldResult=function(e,t){if(!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.selection)&&!(0,a.isNullOrUndefined)(e)){var i=this.selection.getFieldCode(e).split("*"),n=i[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),r="";switch(i.length>1&&" MERGEFORMAT"!==i[1]&&(r=i[1].replace(/[^\w\s]/gi,"").trim()),""==r&&(r=t.bodyWidgets[0].sectionFormat.pageNumberStyle),-1!==n.indexOf(" ")&&(n=n.split(" ")[0]),n){case"page":if(t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex){var o=t.sectionIndex,s=t.previousPage;return this.isRestartNumbering=!0,o!==s.sectionIndex&&s.bodyWidgets[s.bodyWidgets.length-1].sectionIndex!==o?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber,this.getFieldText(r,t.currentPageNum)):(1===s.currentPageNum&&o!==s.sectionIndex&&(s.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=s.currentPageNum+1,this.getFieldText(r,t.currentPageNum))}return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index,this.getFieldText(r,t.currentPageNum)):(!(0,a.isNullOrUndefined)(t.previousPage)&&(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&t.previousPage.currentPageNum>=1||this.isRestartNumbering&&1!==t.previousPage.currentPageNum)?(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&(this.isRestartNumbering=!0),t.currentPageNum=t.previousPage.currentPageNum+1):t.currentPageNum=t.index+1,this.getFieldText(r,t.currentPageNum));case"numpages":return this.getFieldText(r,t.documentHelper.pages.length);case"sectionpages":for(var l=t.sectionIndex,d=0,h=0;h<t.documentHelper.pages.length;h++)if(t.documentHelper.pages[h].sectionIndex===l)d++;else if(0!==d)break;return this.getFieldText(r,d)}}return""},e.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":case"LetterUpper":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":case"LetterLower":return this.layout.getAsLetter(t).toLowerCase();case"roman":case"RomanLower":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":case"RomanUpper":return this.layout.getAsRoman(t).toUpperCase();default:return t.toString()}},e.prototype.isEmptyShape=function(e){var t=!0;return(e.element instanceof gd||0===e.element.textFrame.childWidgets.length)&&t},e.prototype.destroy=function(){var e=this;if((0,a.isNullOrUndefined)(this.owner)||this.unWireEvent(),this.vRuler&&(this.vRuler.childNodes.forEach((function(t){e.vRuler.removeChild(t),t=null})),this.vRuler.innerHTML="",this.vRuler.remove(),this.vRuler=null),this.hRuler&&(this.hRuler.childNodes.forEach((function(t){e.hRuler.removeChild(t),t=null})),this.hRuler.innerHTML="",this.hRuler.remove(),this.hRuler=null),this.markIndicator&&this.markIndicator.remove(),this.styles&&(this.styles.destroy(),this.styles=void 0),this.stylesMap&&(this.stylesMap.destroy(),this.stylesMap=void 0),this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.themeFontLanguage&&(this.themeFontLanguage.destroy(),this.themeFontLanguage=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.pages&&this.pages.length>0){for(var t=0;t<this.pages.length;t++){this.pages[t].componentDestroy()}this.pages=[]}if(this.pages=void 0,this.lists&&this.lists.length>0){for(t=0;t<this.lists.length;t++){this.lists[t].destroy()}this.lists=[]}if(this.lists=void 0,this.formFillPopup&&(this.formFillPopup.destroy(),this.formFillPopup=void 0),this.contentDropDown&&(this.contentDropDown.destroy(),this.contentDropDown=void 0),this.L10n=void 0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.abstractLists=[],this.abstractLists=void 0,(0,a.isNullOrUndefined)(this.owner)||this.renderedLists.destroy(),this.renderedLists=void 0,(0,a.isNullOrUndefined)(this.owner)||this.authors.destroy(),this.authors=void 0,(0,a.isNullOrUndefined)(this.owner)||this.revisionsInternal.destroy(),this.revisionsInternal=void 0,(0,a.isNullOrUndefined)(this.owner)||this.preDefinedStyles.destroy(),this.preDefinedStyles=void 0,(0,a.isNullOrUndefined)(this.owner)||this.bookmarks.destroy(),this.bookmarks=void 0,(0,a.isNullOrUndefined)(this.owner)||this.editRanges.destroy(),this.editRanges=void 0,(0,a.isNullOrUndefined)(this.owner)||this.customXmlData.destroy(),(0,a.isNullOrUndefined)(this.owner)||this.images.destroy(),(0,a.isNullOrUndefined)(this.owner)||this.fontSubstitutionTable.destroy(),this.fontSubstitutionTable=void 0,this.customXmlData=void 0,this.images=void 0,this.blockToShift=void 0,this.cachedPages=[],this.cachedPages=void 0,this.comments&&this.comments.length>0){for(t=0;t<this.comments.length;t++){this.comments[t].destroy()}this.comments=[]}this.comments=void 0,this.compositionEnd=void 0,this.compositionStart=void 0,this.compositionUpdated=void 0,this.contentControlCollection=[],this.contentControlCollection=void 0,this.renderedLevelOverrides=[],this.renderedLevelOverrides=void 0,this.headersFooters=[],this.headersFooters=void 0,this.listParagraphs=[],this.listParagraphs=void 0,this.formFields=[],this.formFields=void 0,this.fieldCollection=[],this.fieldCollection=void 0,this.userCollection=[],this.userCollection=void 0,this.footnotes&&(this.footnotes.componentDestroy(),this.footnotes=void 0),this.endnotes&&(this.endnotes.componentDestroy(),this.endnotes=void 0),this.zoomModule&&(this.zoomModule.destroy(),this.zoomModule=void 0),this.footnoteCollection=[],this.footnoteCollection=void 0,this.endnoteCollection=[],this.endnoteCollection=void 0,this.restrictEditingPane&&(this.restrictEditingPane.destroy(),this.restrictEditingPane=void 0),this.layout&&this.layout.destroy(),this.layout=void 0,(0,a.isNullOrUndefined)(this.render)||this.render.destroy(),this.render=void 0,this.dialogInternal&&this.dialogInternal.destroy(),this.dialogInternal=void 0,this.dialogInternal2&&(this.dialogInternal2.destroy(),this.dialogInternal2=void 0),this.dialogInternal3&&(this.dialogInternal3.destroy(),this.dialogInternal3=void 0),this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1),this.dialogTarget1=void 0,this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2),this.dialogTarget2=void 0,this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3),this.dialogTarget3=void 0,(0,a.isNullOrUndefined)(this.touchStart)||(this.touchStart.innerHTML="",(0,a.isNullOrUndefined)(this.touchStart.parentElement)||this.touchStart.parentElement.removeChild(this.touchStart)),this.touchStart=void 0,this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,(0,a.isNullOrUndefined)(this.touchEnd)||(this.touchEnd.innerHTML="",(0,a.isNullOrUndefined)(this.touchEnd.parentElement)||this.touchEnd.parentElement.removeChild(this.touchEnd)),this.touchEnd=void 0,(0,a.isNullOrUndefined)(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML="",(0,a.isNullOrUndefined)(this.containerCanvasIn.parentElement)||this.containerCanvasIn.parentElement.removeChild(this.containerCanvasIn)),this.containerCanvasIn=void 0,(0,a.isNullOrUndefined)(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML="",(0,a.isNullOrUndefined)(this.selectionCanvasIn.parentElement)||this.selectionCanvasIn.parentElement.removeChild(this.selectionCanvasIn)),this.selectionCanvasIn=void 0,(0,a.isNullOrUndefined)(this.editableDiv)||(this.editableDiv.innerHTML="",(0,a.isNullOrUndefined)(this.editableDiv.parentElement)||this.editableDiv.parentElement.removeChild(this.editableDiv)),this.editableDiv=void 0,(0,a.isNullOrUndefined)(this.pageContainer)||(this.pageContainer.innerHTML="",(0,a.isNullOrUndefined)(this.pageContainer.parentElement)||this.pageContainer.parentElement.removeChild(this.pageContainer)),this.pageContainer=void 0,(0,a.isNullOrUndefined)(this.viewerContainer)||(this.viewerContainer.innerHTML="",(0,a.isNullOrUndefined)(this.viewerContainer.parentElement)||this.viewerContainer.parentElement.removeChild(this.viewerContainer)),(0,a.isNullOrUndefined)(this.iframe)||(this.iframe.innerHTML="",(0,a.isNullOrUndefined)(this.iframe.parentElement)||this.iframe.parentElement.removeChild(this.iframe),this.iframe=void 0),this.optionsPaneContainer&&(this.optionsPaneContainer.innerHTML="",(0,a.isNullOrUndefined)(this.optionsPaneContainer.parentElement)||this.optionsPaneContainer.parentElement.removeChild(this.optionsPaneContainer)),this.optionsPaneContainer=void 0,this.visibleBoundsIn=void 0,this.mouseDownOffset=void 0,this.viewerContainer=void 0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.currentSelectedCommentInternal=void 0,this.currentSelectedRevisionInternal=void 0,this.owner=void 0,this.heightInfoCollection=void 0,this.isRestartNumbering=!1},e.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),a.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===a.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),(0,a.isNullOrUndefined)(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer),window.removeEventListener("touchend",this.onImageResizer),window.removeEventListener("copy",this.onCopy),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.removeEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.removeEventListener("mousewheel",this.zoomModule.onMouseWheelInternal)},e.prototype.updateCursor=function(e){var t,i,n,r=void 0,o=void 0,s=this.viewerContainer,l=new Sa(e.offsetX,e.offsetY),d=this.owner.viewer.findFocusedPage(l,!0),h=this.getLineWidget(d),c=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,p=!!c&&c.tableResize.isInRowResizerArea(d),u=!!c&&c.tableResize.isInCellResizerArea(d),g=(this.selection.checkAllFloatingElements(h,d),"");if(this.owner.enableImageResizerMode){var m=this.owner.imageResizerModule.getImagePoint(d);this.owner.imageResizerModule.selectedResizeElement=m.selectedElement,g=m.resizePosition}var f=0,v=void 0;this.checkPointIsInLine(h,d);if(!(0,a.isNullOrUndefined)(h)){if(f=this.selection.getLineStartLeft(h),r=this.selection.getHyperLinkFieldInCurrentSelection(h,d),(0,a.isNullOrUndefined)(r)&&(v=this.selection.getHyperLinkFieldInCurrentSelection(h,d,!0)),!(0,a.isNullOrUndefined)(r)){var y=this.selection.getFieldCode(r);0!==y.toLowerCase().indexOf("ref ")||y.match("\\h")||(r=void 0)}if(t=this.selection.updateTextPositionIn(h,void 0,0,d,!0),i=this.selection.getLeft(h),n=this.selection.getTop(h),(0,a.isNullOrUndefined)(r)&&!(0,a.isNullOrUndefined)(v)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(v,h,d.x,!0):this.selection.setHyperlinkContentToToolTip(r,h,d.x,!1),v){var w=v.formFieldData instanceof Gl&&"Text"===v.formFieldData.type;"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode&&w&&(v=void 0)}if(this.owner.enableLockAndEdit){var b=!1,C=h.paragraph;C.isInsideTable&&(C=this.layout.getParentTable(C)),C.locked&&C.lockedBy!==this.owner.currentUser&&(b=!0);var x=h.paragraph.bodyWidget.sectionFormat,I=x.pageWidth-x.rightMargin-x.leftMargin;I=Pa.convertPointToPixel(I)*this.zoomFactor,this.viewer instanceof Fl&&(I=(this.visibleBounds.width-5*this.viewer.padding.right)/this.zoomFactor),b&&d.x>=f&&d.x<f+I?this.selection.setLockInfoTooptip(h,d.x,C.lockedBy):this.selection.setLockInfoTooptip(void 0,d.x,"")}}(0,a.isNullOrUndefined)(h)||(0,a.isNullOrUndefined)(o)&&"Pages"==this.owner.layoutType&&(o=this.selection.getFootNoteElementInCurrentSelection(h,d))instanceof Yl&&this.selection.setFootnoteContentToToolTip(o,h,d.x);var k=this.isIosDevice?e.metaKey:e.ctrlKey;!(0,a.isNullOrUndefined)(r)&&(k&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||v?(0,a.isNullOrUndefined)(v)?s.style.cursor="pointer":this.isFormFillProtectedMode&&(s.style.cursor="default"):(d.x>=f&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?s.style.cursor="text":s.style.cursor=this.selection.checkCursorIsInSelection(h,d)?"default":"text":s.style.cursor="default",(0,a.isNullOrUndefined)(g)||""===g?!(0,a.isNullOrUndefined)(t)&&t.isImageSelected&&i<d.x&&n<d.y&&i+h.width>d.x&&n+h.height>d.y&&(s.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==g)&&(s.style.cursor=g),p?s.style.cursor="row-resize":u&&(s.style.cursor="col-resize"))},e.prototype.updateDialogTabHeight=function(e,t){var i=e.getElementsByClassName("e-dlg-header-content")[0],n=e.getElementsByClassName("e-dlg-content")[0],r=e.getElementsByClassName("e-footer-content")[0],o=getComputedStyle(n),s=getComputedStyle(e),a=parseInt(o.paddingTop,10),l=parseInt(o.paddingBottom,10),d=(isNaN(a)?0:a)+(isNaN(l)?0:l),h=parseInt(s.borderTop,10),c=parseInt(s.borderBottom,10),p=(isNaN(h)?0:h)+(isNaN(c)?0:c),u=e.offsetHeight-(i.offsetHeight+r.offsetHeight+d+p);t.style.height=u+"px";var g=parseInt(o.paddingLeft,10),m=parseInt(o.paddingRight,10),f=(isNaN(g)?0:g)+(isNaN(m)?0:m),v=parseInt(s.borderLeft,10),y=parseInt(s.borderRight,10),w=(isNaN(v)?0:v)+(isNaN(y)?0:y);return e.offsetWidth-(f+w)},e.prototype.canRenderBorder=function(e){var t,i,n,r,o=!1,s=!1,l=e.previousRenderedWidget,d=e.nextRenderedWidget,h=this.getParagraphLeftPosition(e),c=0,p=0;return!(0,a.isNullOrUndefined)(l)&&l instanceof Rl&&(c=this.getParagraphLeftPosition(l)),!(0,a.isNullOrUndefined)(d)&&d instanceof Rl&&(p=this.getParagraphLeftPosition(d)),!(0,a.isNullOrUndefined)(l)&&l instanceof Rl&&h===c&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,l.paragraphFormat.borders.top),i=this.checkEqualBorder(e.paragraphFormat.borders.bottom,l.paragraphFormat.borders.bottom),n=this.checkEqualBorder(e.paragraphFormat.borders.left,l.paragraphFormat.borders.left),r=this.checkEqualBorder(e.paragraphFormat.borders.right,l.paragraphFormat.borders.right),t&&i&&n&&r&&!(0,a.isNullOrUndefined)(l.paragraphFormat.borders.horizontal)&&"None"===l.paragraphFormat.borders.horizontal.lineStyle&&(o=!0)),!(0,a.isNullOrUndefined)(d)&&d instanceof Rl&&(h===p||this.owner.documentHelper.layout.isInitialLoad&&this.skipBottomBorder(e,d))&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,d.paragraphFormat.borders.top),i=this.checkEqualBorder(e.paragraphFormat.borders.bottom,d.paragraphFormat.borders.bottom),n=this.checkEqualBorder(e.paragraphFormat.borders.left,d.paragraphFormat.borders.left),r=this.checkEqualBorder(e.paragraphFormat.borders.right,d.paragraphFormat.borders.right),i&&t&&n&&r&&(s=!0)),{skipTopBorder:o,skipBottomBorder:s}},e.prototype.checkEqualBorder=function(e,t){return(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(t)?!(!(0,a.isNullOrUndefined)(e)||!(0,a.isNullOrUndefined)(t)):e.isEqualFormat(t)},e.prototype.getParagraphLeftPosition=function(e){var t=0;return e.paragraphFormat.firstLineIndent<0&&(t=Pa.convertPointToPixel(Math.abs(e.paragraphFormat.firstLineIndent)),t=parseFloat(t.toFixed(5))),e.isEmpty()&&("Left"!==e.paragraphFormat.textAlignment&&"Justify"!==e.paragraphFormat.textAlignment||"Justify"===e.paragraphFormat.textAlignment&&e.paragraphFormat.bidi)?e.clientX>t?e.clientX-t:e.clientX:e.x>t?e.x-t:e.x},e.prototype.skipBottomBorder=function(e,t){var i=0,n=0;return e.paragraphFormat.leftIndent===t.paragraphFormat.leftIndent||(i=e.paragraphFormat.firstLineIndent<0?Math.abs(e.paragraphFormat.firstLineIndent):0,n=t.paragraphFormat.firstLineIndent<0?Math.abs(t.paragraphFormat.firstLineIndent):0,(i=e.paragraphFormat.leftIndent>i?e.paragraphFormat.leftIndent-i:0)===(n=t.paragraphFormat.leftIndent>n?t.paragraphFormat.leftIndent-n:0))},e.prototype.isPageInVisibleBound=function(e,t){var i=this.visibleBounds.height,n=this.viewerContainer.scrollTop,r=e.boundingRectangle.height*this.zoomFactor;return t>=n&&t<=n+i||t+r>=n&&t+r<=n+i||t<=n&&t+r>=n+i},e.prototype.getFirstParagraphInCell=function(e){var t=e.childWidgets[0];return t instanceof Rl?t:this.getFirstParagraphInFirstCell(t)},e.prototype.getFirstParagraphInFirstCell=function(e){if(!(0,a.isNullOrUndefined)(e.childWidgets)&&e.childWidgets.length>0){var t=e.childWidgets[0].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.getLastParagraphInLastCell=function(e){if(!(0,a.isNullOrUndefined)(e.childWidgets)&&e.childWidgets.length>0){var t=e.lastChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getFirstParagraphBlock=function(e){return e instanceof Rl?e:e instanceof Al?this.getFirstParagraphInFirstCell(e):void 0},e.prototype.getLastParagraphBlock=function(e){return e instanceof Rl?e:e instanceof Al?this.getLastParagraphInLastCell(e):void 0},e.prototype.getLastParagraphInFirstRow=function(e){if(e.childWidgets.length>0){var t=e.firstChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getFirstParagraphInLastRow=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[e.childWidgets.length-1].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.addToStylesMap=function(e){var t={},i={};if(!(0,a.isNullOrUndefined)(e)){var n=this.owner?this.L10n.getConstant(e.name):e.name;t.StyleName=""===n?e.name:n,"Paragraph"==e.type&&(i.paragraphFormat={},Pa.writeParagraphFormat(i.paragraphFormat,!0,e.paragraphFormat)),i.characterFormat={},Pa.writeCharacterFormat(i.characterFormat,!0,e.characterFormat),t.Style=this.parseStyle(JSON.stringify(i)),(0,a.isNullOrUndefined)(e.type)||(t.type=e.type,"Paragraph"!=t.type||(0,a.isNullOrUndefined)(e.link)||(t.type="Linked")),"Paragraph"==t.type?t.IconClass="e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons":"Character"==t.type?t.IconClass="e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons":t.IconClass="e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons",this.stylesMap.get(t.type)?this.stylesMap.get(t.type).push(t):this.stylesMap.add(t.type,[t])}},e.prototype.parseStyle=function(e){var t="",i=JSON.parse(e),n="";if(!(0,a.isNullOrUndefined)(i.characterFormat.baselineAlignment)&&"Normal"!==i.characterFormat.baselineAlignment){var r="";switch(i.characterFormat.baselineAlignment){case"Superscript":r="super";break;case"Subscript":r="sub"}r.length>1&&(t+="vertical-align:"+r+";")}return(0,a.isNullOrUndefined)(i.characterFormat.underline)||"None"===i.characterFormat.underline||(n+="underline "),(0,a.isNullOrUndefined)(i.characterFormat.strikethrough)||"None"===i.characterFormat.strikethrough||(n+="line-through "),(0,a.isNullOrUndefined)(i.characterFormat.fontSize)||(t+="font-size:"+i.characterFormat.fontSize+"px;"),(0,a.isNullOrUndefined)(i.characterFormat.fontFamily)||(t+="font-family:"+i.characterFormat.fontFamily+";"),!(0,a.isNullOrUndefined)(i.characterFormat.bold)&&i.characterFormat.bold&&(t+="font-weight:bold;"),!(0,a.isNullOrUndefined)(i.characterFormat.italic)&&i.characterFormat.italic&&(t+="font-style:italic;"),n.length>1&&(t+="text-decoration:"+n+";"),t},e.prototype.getNextValidElement=function(e){var t=void 0;if(e instanceof td&&1===e.bookmarkType)return e;for(;e instanceof _l;){if(0===e.fieldType&&!(0,a.isNullOrUndefined)(e.fieldEnd))return(0,a.isNullOrUndefined)(t)?e:t;1!==e.fieldType||(0,a.isNullOrUndefined)(e.fieldBegin)||(t=e),e=e.nextNode}return(0,a.isNullOrUndefined)(t)?e:t},e.prototype.getNextValidElementForField=function(e){if(e instanceof _l&&0===e.fieldType&&Pa.isLinkedFieldCharacter(e)){var t=e;e=(0,a.isNullOrUndefined)(t.fieldSeparator)?t.fieldEnd:t.fieldSeparator}var i=void 0;return(0,a.isNullOrUndefined)(e.nextNode)||(i=this.getNextValidElement(e.nextNode)),i},e}(),Il=function(){function e(e){this.visiblePages=[],this.padding=new Hl(10,10,30,10),this.textWrap=!0,this.pageFitTypeIn="None",this.containerTop=0,this.containerWidth=0,this.containerLeft=0,this.owner=e,this.columnLayoutArea=new Pl(this)}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),e.prototype.updateClientArea=function(e,t,i){var n;(0,a.isNullOrUndefined)(e)||(n=e.sectionFormat,this.columnLayoutArea.setColumns(n));var r=0,o=0;if(this instanceof Fl){(r=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor)<0&&(r=0),o=Number.POSITIVE_INFINITY,this.clientArea=new Tl(this.padding.left/this.documentHelper.zoomFactor,0,r,o),this.clientActiveArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}else{var s=0,l=48,d=48,h=Pa.convertPointToPixel(n.pageHeight),c=Pa.convertPointToPixel(n.bottomMargin);(0,a.isNullOrUndefined)(n)||(s=Pa.convertPointToPixel(n.topMargin),l=Pa.convertPointToPixel(n.headerDistance),d=Pa.convertPointToPixel(n.footerDistance));var p=!1;(0,a.isNullOrUndefined)(t.headerWidget)||(p=t.headerWidget.isEmpty,s>=0?(!p||p&&this.owner.enableHeaderAndFooter)&&(s=Math.min(Math.max(l+t.headerWidget.height,s),h/100*40)):s=Math.abs(s));var u=.667+c;if(!(0,a.isNullOrUndefined)(t.footerWidget)){p=t.footerWidget.isEmpty;var g=(0,a.isNullOrUndefined)(t.footnoteWidget)?0:t.footnoteWidget.height;g=Math.min(g,(h-s-u)/100*90),u>=0?(!p||p&&this.owner.enableHeaderAndFooter)&&(u=.667+Math.min(h/100*40,Math.max(d+t.footerWidget.height,c))):u=Math.abs(u),u+=g}(0,a.isNullOrUndefined)(n)||(r=Pa.convertPointToPixel(n.pageWidth-n.leftMargin-n.rightMargin),o=h-s-u),r<0&&(r=0);var m=new Tl(Pa.convertPointToPixel(n.leftMargin),s,r,h-s-u);if(t.footnoteWidget&&i&&!this.documentHelper.owner.editorModule.isFootNote&&0!==t.footnoteWidget.y&&this.clientArea.y+this.clientArea.height>t.footnoteWidget.y){var f=this.clientArea.y+this.clientArea.height-t.footnoteWidget.y;this.clientArea.height-=f/2}0!==e.page.bodyWidgets[0].columnIndex&&this.owner.editorModule.updateColumnIndex(e,!1),this.setClientArea(e,m),this.clientActiveArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.setClientArea=function(e,t){this.clientArea=this.columnLayoutArea.getColumnBoundsByBodyWidget(e,t),e.x=this.clientArea.x,e.width=this.clientArea.width},e.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},e.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},e.prototype.updateClientAreaForRow=function(e,t){var i=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Tl(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},e.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,n=e;if(t)this.clientActiveArea.x=this.clientArea.x=n.x,this.clientActiveArea.y=n.y,this.clientActiveArea.width=this.clientArea.width=n.width>0?n.width:0,this instanceof kl&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Tl(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height);else{if(this.clientActiveArea.x=this.clientArea.x=n.x+n.width+n.margin.right,i.x+i.width-this.clientArea.x<0?this.clientActiveArea.width=this.clientArea.width=0:this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x,this.clientActiveArea.y=n.y-n.margin.top-Pa.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),!e.ownerTable.isInsideTable&&(this.clientActiveArea.height=this.clientArea.bottom-i.y>0?this.clientArea.bottom-i.y:0,!e.ownerTable.wrapTextAround&&this.documentHelper.layout.existFootnoteHeight>0)){var r=this.clientActiveArea.height-this.documentHelper.layout.existFootnoteHeight;this.clientActiveArea.height=r<0?0:r}this.clientArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Tl(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}},e.prototype.updateClientAreaForTextBoxShape=function(e,t,i){if("Inline"!==e.textWrappingStyle||i||(e.y=this.clientActiveArea.y,e.x=this.clientActiveArea.x),t){var n=Pa.convertPointToPixel(e.textFrame.marginLeft),r=Pa.convertPointToPixel(e.textFrame.marginRight),o=Pa.convertPointToPixel(e.textFrame.marginTop),s=Pa.convertPointToPixel(e.textFrame.marginBottom),a=e.width,l=Number.POSITIVE_INFINITY;this.clientArea=new Tl(e.x+n,e.y+o,a-n-r,l-o-s),this.clientActiveArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.updateClientAreaByWidgetFootNote=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaForTextWrap=function(e){this.clientActiveArea=new Tl(e.x,e.y,e.width,e.height)},e.prototype.updateBoundsBasedOnTextWrap=function(e){var t=e-this.clientActiveArea.y;this.clientActiveArea.y=e,this.clientActiveArea.height=this.clientActiveArea.height-t},e.prototype.updateBoundsBasedOnTextWrapTable=function(e){var t=e-this.clientArea.y;this.clientArea.y=e,this.clientArea.height=this.clientArea.height-t,this.clientActiveArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},e.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},e.prototype.updateClientAreaForBlock=function(e,t,i,n,r){var o=Pa.convertPointToPixel(e.leftIndent),s=Pa.convertPointToPixel(e.rightIndent),l=e.bidi,d=0;if(t)if(e instanceof Al&&i){var h=i[0];e.bodyWidget.sectionFormat.columns.length<=1&&(this.clientActiveArea.x=this.clientArea.x=h.x,this.clientActiveArea.width=this.clientArea.width=h.width),(h=i[i.length-1]).x=this.clientActiveArea.x,h.y=this.clientActiveArea.y}else{if(e instanceof Al&&!(0,a.isNullOrUndefined)(e.tableFormat))if(e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==(u=this.tableAlignmentForBidi(e,l))){var c=0;c=0===(c=Pa.convertPointToPixel(e.tableHolder.getTotalWidth(0)))?0===e.tableHolder.tableWidth?e.getTableClientWidth(e.getOwnerWidth(!1)):e.tableHolder.tableWidth:c,this.owner.editorModule&&this.owner.editorModule.tableResize.currentResizingTable===e&&0===this.owner.editorModule.tableResize.resizerPosition&&(c=Pa.convertPointToPixel(e.tableHolder.tableWidth)),"Center"===u?(this.documentHelper.isRowOrCellResizing||(c=e.getTableCellWidth()),o=(this.clientArea.width-c)/2):o=this.clientArea.width-c,l&&(s=o-=Pa.convertPointToPixel(e.leftIndent)),e.isInsideTable,this.documentHelper.tableLefts.push(o)}d=this.clientArea.width-(o+Pa.convertPointToPixel(e.rightIndent));var p=this.clientArea.x+(l?s:o);d=d>0?d:0,this.clientActiveArea.x=this.clientArea.x=p,this.clientActiveArea.width=this.clientArea.width=d,n&&this.updateParagraphYPositionBasedonTextWrap(e,new Tl(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)),r&&(e instanceof Rl?this.updateParagraphXPositionBasedOnTextWrap(e):this.updateTableXPositionBasedOnTextWrap(e))}else{if(e instanceof Al&&!(0,a.isNullOrUndefined)(e.tableFormat)){var u=this.tableAlignmentForBidi(e,l);e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==u&&this.documentHelper.tableLefts.length>0&&(o=this.documentHelper.tableLefts.pop(),l&&(s=o))}d=this.clientArea.width+o+Pa.convertPointToPixel(e.rightIndent);p=this.clientArea.x-(l?s:o);d=d>0?d:0,this.clientActiveArea.x=this.clientArea.x=p,this.clientActiveArea.width=this.clientArea.width=d}this.clientArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new Tl(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},e.prototype.updateParagraphYPositionBasedonTextWrap=function(e,t){var i=e.bodyWidget,n=this.clientActiveArea;if(i&&i.floatingElements.length>0&&e instanceof Rl&&!(e.containerWidget instanceof cd)&&!e.isInsideTable&&!(e.containerWidget instanceof Dl)){var r="Word2013"===this.documentHelper.compatibilityMode,o=e,s=o.isEmpty(),l=o.height;if(0===l&&(l=this.documentHelper.textHelper.getParagraphMarkSize(o.characterFormat).Height),!o.isInHeaderFooter||o.isInsideTable||r){var d=t.y,h=!1;i.floatingElements.sort((function(e,t){return e.y-t.y})),i.floatingElements.sort((function(e,t){return e.x-t.x}));var c=o.previousRenderedWidget;c&&c instanceof Al&&c.wrapTextAround&&!s&&!o.isContainsShapeAlone()&&r&&t.y<c.y&&(t.y=c.y);for(var p=0;p<i.floatingElements.length;p++){var u=i.floatingElements[p],g=!1;if(g=u instanceof dd?u.paragraph.isInHeaderFooter:u.bodyWidget instanceof Bl,!(o.isInsideTable&&u instanceof Al)||u.isInsideTable){var m=this.getTextWrappingBound(u),f=u instanceof Al?"Square":u.textWrappingStyle,v=u instanceof Al?"Both":u.textWrappingType,y=24;if(!(n.x>m.right+y||n.right<m.x-y))if((t.y+(u instanceof Al&&!s&&0===o.floatingElements.length?l:o.height)>m.y||h)&&t.y<m.bottom&&"Inline"!==f&&"TopAndBottom"!==f&&"InFrontOfText"!==f&&"Behind"!==f){var w=0,b=Pa.convertPointToPixel(o.paragraphFormat.rightIndent),C=Pa.convertPointToPixel(o.paragraphFormat.firstLineIndent);if(C=!s&&o.childWidgets[0].isFirstLine()&&C>0?C:0,t.x>=m.x&&"Left"!==v&&(w=b),w=w<0?w:0,t.x<m.x&&t.x>m.x&&"Left"!==v)t.right>m.x&&(t.width=t.width-(t.right-m.right)),t.width<y?(!r&&u instanceof Al&&c===u||(this.updateBoundsBasedOnTextWrap(m.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!g)&&(o.y=this.clientActiveArea.y)):t.x=m.right;else if(t.x>=m.x&&t.x<m.right)if(t.width=t.width-(m.right-t.x)-w,t.width<y||h){t.width=this.clientActiveArea.right-m.right-w;var x=!1;if(t.width<y||h){if(this.clientActiveArea.x+y<m.x){var I=this.getIntersectingItemBounds(i.floatingElements,u,d);!(0,a.isNullOrUndefined)(I)&&I.bottom<=m.bottom&&(this.updateBoundsBasedOnTextWrap(I.bottom),t=this.clientActiveArea,x=!0,o.x=I.x)}r&&!x&&(u instanceof Al&&c===u?this.updateBoundsBasedOnTextWrapTable(m.bottom):this.updateBoundsBasedOnTextWrap(m.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!g)&&(o.y=this.clientActiveArea.y)}else t.x=m.right}else t.x=m.right;else m.x>t.x&&t.right>m.x&&(t.width=m.x-t.x,t.width<y&&(t.width=this.clientActiveArea.right-m.right-w,t.width<y?(!r&&u instanceof Al&&c===u||(this.updateBoundsBasedOnTextWrap(m.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!g)&&(o.y=this.clientActiveArea.y)):t.x=m.right))}else i.floatingElements.length>0&&(t.y>=m.y&&t.y<m.bottom||t.y+l>=m.y&&t.y+l<m.bottom)&&"TopAndBottom"===f&&(!r&&u instanceof Al&&c===u||(this.updateBoundsBasedOnTextWrap(m.bottom),!r&&(!s&&o.childWidgets[0].isFirstLine()||s)&&(h=!0)),((!s&&o.childWidgets[0].isFirstLine()||s)&&r||!g)&&(o.y=this.clientActiveArea.y))}}}}},e.prototype.updateParagraphXPositionBasedOnTextWrap=function(e){var t="Word2013"===this.documentHelper.compatibilityMode,i=e.containerWidget,n=this.clientActiveArea;if(this instanceof kl&&!(0,a.isNullOrUndefined)(i)&&e instanceof Rl&&!(0,a.isNullOrUndefined)(i.page)&&!(0,a.isNullOrUndefined)(i.page.headerWidget)){var r=i.page.headerWidget.floatingElements;if(r.length>0&&(!e.isInHeaderFooter||e.isInsideTable||t)&&!(e.containerWidget instanceof Dl)&&!(e.bodyWidget instanceof cd))for(var o=e,s=0;s<r.length;s++){var l=r[s];if(!(o.isInsideTable&&l instanceof Al)||l.isInsideTable){var d=this.getTextWrappingBound(l),h=l instanceof Al?"Square":l.textWrappingStyle;l instanceof Al||l.textWrappingType;if(!o.isInsideTable&&!(n.x>d.right+24||n.right<d.x-24)&&r.length>0&&n.y+o.height>d.y&&n.y<d.bottom&&"Inline"!==h&&"TopAndBottom"!==h&&"InFrontOfText"!==h&&"Behind"!==h){var c=Pa.convertPointToPixel(o.paragraphFormat.rightIndent);if("Left"!=o.paragraphFormat.textAlignment&&n.x<d.x&&n.x+o.width>d.x)o.x=n.x;else if(n.x>=d.x&&n.x<d.right&&!o.paragraphFormat.bidi){if(n.width=n.width-(d.right-n.x)-c,n.width<24)n.width=this.clientActiveArea.right-d.right-c,n.width<24?(o.x=n.x,n.width=n.width,n.height=d.bottom-n.x,n.y=d.bottom):n.x=d.right;else if("Word2007"===this.documentHelper.compatibilityMode||n.y<=d.bottom){Pa.convertPointToPixel(o.paragraphFormat.leftIndent)+Pa.convertPointToPixel(o.paragraphFormat.firstLineIndent)+n.x<d.right&&(n.x=d.right)}}else(d.x-24>n.x&&n.right>d.x||n.x>d.x&&n.x>d.right)&&(o.x=n.x)}}}}},e.prototype.updateTableXPositionBasedOnTextWrap=function(e){var t=Pa.convertPointToPixel(e.childWidgets[0].getFirstRowWidth()),i=e.bodyWidget;if(this instanceof kl&&!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(i.page)&&!(0,a.isNullOrUndefined)(i.page.headerWidget)){var n=i.page.headerWidget.floatingElements;if(!(!(n.length>0)||e.isInHeaderFooter&&e.isInsideTable&&"Word2013"!==this.documentHelper.compatibilityMode||e.containerWidget instanceof cd))for(var r=this.clientActiveArea,o=0;o<n.length;o++){var s=n[o],l=this.getTextWrappingBound(s),d=s instanceof Al?"Square":s.textWrappingStyle,h=s instanceof Al?s.positioning.allowOverlap:s.allowOverlap,c=this.documentHelper.getFirstParagraphInFirstCell(e),p=this.documentHelper.textHelper.getParagraphMarkSize(c.characterFormat).Height,u=e.childWidgets[0]instanceof Ul?e.childWidgets[0].height:0;u>p&&(p=u);var g=Pa.convertPointToPixel(e.getTableClientWidth(e.getContainerWidth()));if(!(this.clientArea.x>l.right+24||this.clientArea.right<l.x-24)&&this.isFloatingItemIntersect(e,r,l,d,h,p,g)&&r.x>=l.x&&r.x<l.right)if(r.width=r.width-(l.right-r.x),r.width<24||r.width<t&&t>0)if(r.width=this.clientActiveArea.right-l.right,r.width<24||r.width<t&&t>0&&this.clientArea.right<=t+l.right){var m=l.bottom>r.y?l.bottom-r.y:0;r.y=l.bottom,r.width=this.clientArea.width,r.height=r.height-m,this.updateClientAreaForTextWrap(r)}else r.x=l.right,this.updateClientAreaForTextWrap(r);else r.x=l.right,this.updateClientAreaForTextWrap(r)}}},e.prototype.isFloatingItemIntersect=function(e,t,i,n,r,o,s){return(Math.round(t.y+o)>=Math.round(i.y)&&Math.round(t.y)<Math.round(i.bottom)||Math.round(t.y+o)<=Math.round(i.bottom)&&Math.round(t.y+o)>=Math.round(i.y))&&"Inline"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&"Behind"!==n&&!(r&&null!==e.tableFormat&&e.wrapTextAround&&e.positioning.allowOverlap)},e.prototype.getIntersectingItemBounds=function(e,t,i){var n=this.getMinBottomFloatingItem(e,this.getIntersectingFloatingItems(e,t,i));if(!(0,a.isNullOrUndefined)(n))return this.getTextWrappingBound(n)},e.prototype.getMinBottomFloatingItem=function(e,t){var i=-1,n=Number.MAX_VALUE,r=0;e.sort((function(e,t){return e.x-t.x}));for(var o=0;o<t.length;o++){var s=e[o],a=this.getTextWrappingBound(s);n>a.bottom&&(s&&t.indexOf(s)+1<t.length?r++:(n=a.bottom,i=t.indexOf(s)))}return i-r==0?t[i]:null},e.prototype.getIntersectingFloatingItems=function(e,t,i){for(var n=[],r=0;r<e.length;r++){var o=e[r],s=this.getTextWrappingBound(o),a=this.getTextWrappingBound(t);i<=s.bottom&&a.bottom>=s.bottom&&s.right>this.clientActiveArea.x&&s.x<a.x&&n.push(o)}return n},e.prototype.getTextWrappingBound=function(e){var t=0,i=0,n=0,r=0,o=0;return e instanceof dd?(t=e.distanceLeft,i=e.distanceTop,n=e.distanceRight,r=e.distanceBottom,o=e.width):(o=e.getTableCellWidth(),t=e.positioning.distanceLeft,i=e.positioning.distanceTop,n=e.positioning.distanceRight,r=e.positioning.distanceBottom),new Tl(e.x-t,e.y-i,o+t+n,e.height+i+r)},e.prototype.tableAlignmentForBidi=function(e,t){var i=e.tableFormat.tableAlignment;return t&&("Left"===i?i="Right":"Right"===i&&(i="Left")),i},e.prototype.cutFromLeft=function(e){e<this.clientActiveArea.x&&(e=this.clientActiveArea.x),e>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},e.prototype.cutFromTop=function(e){e<this.clientActiveArea.y&&(e=this.clientActiveArea.y),e>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},e.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,this.clientActiveArea.width+e>0?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},e.prototype.findFocusedPage=function(e,t,i){var n=new Sa(e.x,e.y);n.x+=this.documentHelper.viewerContainer.scrollLeft,n.y+=this.documentHelper.viewerContainer.scrollTop;for(var r=0;r<this.documentHelper.pages.length;r++){var o=this.documentHelper.pages[r],s=(o.boundingRectangle.y-this.pageGap*(r+1))*this.documentHelper.zoomFactor+this.pageGap*(r+1),l=o.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap,d=o.boundingRectangle.x,h=void 0;if(h=this instanceof kl?(o.boundingRectangle.right-d)*this.documentHelper.zoomFactor+d:o.boundingRectangle.right+d,s<=n.y&&s+l>=n.y)return t&&(this.documentHelper.currentPage=o,i&&((0,a.isNullOrUndefined)(o.headerWidget)||(o.headerWidget.page=o),(0,a.isNullOrUndefined)(o.footerWidget)||(o.footerWidget.page=o))),n.y=(n.y-s)/this.documentHelper.zoomFactor,n.x>h?n.x=o.boundingRectangle.right:n.x<d?n.x=0:n.x=(n.x-d)/this.documentHelper.zoomFactor,n}return n},e.prototype.getPageHeightAndWidth=function(e,t,i,n){e=0;for(var r=0;r<this.documentHelper.pages.length;r++)e+=this.documentHelper.pages[r].boundingRectangle.height;t=0;for(r=0;r<this.documentHelper.pages.length;r++)t<this.documentHelper.pages[r].boundingRectangle.width&&(t=this.documentHelper.pages[r].boundingRectangle.width);return{height:e,width:t,viewerWidth:this.documentHelper.visibleBounds.width,viewerHeight:this.documentHelper.visibleBounds.height}},e.prototype.renderVisiblePages=function(){if(!((0,a.isNullOrUndefined)(this.visiblePages)||this.visiblePages.length<1)){this.documentHelper.clearContent();for(var e=0;e<this.visiblePages.length;e++){var t=this.visiblePages[e],i=t.boundingRectangle.width*this.documentHelper.zoomFactor,n=t.boundingRectangle.height*this.documentHelper.zoomFactor,r=t.boundingRectangle.x,o=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1);this.owner.viewer.renderPage(t,r,o,i,n)}}},e.prototype.handleZoom=function(){var e=this.documentHelper.preZoomFactor,t=null,i=0,n=!1;if(this.documentHelper.selection&&(0,a.isNullOrUndefined)(this.documentHelper.zoomX&&(0,a.isNullOrUndefined)(this.documentHelper.zoomY))){var r=0,o=0,s=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);(r=(this.documentHelper.visibleBounds.width-s.boundingRectangle.width*e)/2)<30&&(r=30),o=s.boundingRectangle.y*e+(this.documentHelper.pages.indexOf(s)+1)*this.pageGap*(1-e);var l=this.documentHelper.selection.updateCaretSize(this.owner.selectionModule.end,!0),d=l.topMargin;l.height;r+=this.documentHelper.selection.end.location.x*e,o+=(this.documentHelper.selection.end.location.y+d)*e,r>=this.containerLeft&&r<=this.documentHelper.visibleBounds.width&&o>=this.containerTop&&o<=this.containerTop+this.documentHelper.visibleBounds.height&&(n=!0)}for(var h=0;h<this.documentHelper.pages.length;h++)i+=this.documentHelper.pages[h].boundingRectangle.height;var c=0;for(h=0;h<this.documentHelper.pages.length;h++)c<this.documentHelper.pages[h].boundingRectangle.width&&(c=this.documentHelper.pages[h].boundingRectangle.width);var p=i*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height,u=c*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width;if(this.documentHelper.visibleBounds.width-c*this.documentHelper.zoomFactor<60&&(u+=60),p>0){var g=this.containerTop;if(this.visiblePages.length>0){var m=((t=this.visiblePages[0]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap,f=this.documentHelper.zoomY;a.isNullOrUndefined&&(f=this.documentHelper.visibleBounds.height/2);for(var v=g+f;v>m+t.boundingRectangle.height*e;){var y=t.index+1;if(y===this.documentHelper.pages.length)break;m=((t=this.documentHelper.pages[y]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap}g=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(t.index+1)*this.pageGap+(v-m<0?v-m:(v-m)*(this.documentHelper.zoomFactor/e))-f,f=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=g}else this.documentHelper.viewerContainer.scrollTop=0;if(u>0){g=this.containerLeft;if(this.visiblePages.length>0){null===t&&(t=this.visiblePages[0]);var w=this.documentHelper.zoomX;(0,a.isNullOrUndefined)(w)&&(w=this.documentHelper.visibleBounds.width/2);var b=t.boundingRectangle.width*e/t.boundingRectangle.width,C=g+w;g=t.boundingRectangle.x+(C-t.boundingRectangle.x<0?C-t.boundingRectangle.x:(C-t.boundingRectangle.x)*(this.documentHelper.zoomFactor/b))-w,w=this.documentHelper.visibleBounds.width/2}this.documentHelper.viewerContainer.scrollLeft=g}else this.documentHelper.viewerContainer.scrollLeft=0;this.updateScrollBars(),n&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end),this instanceof Fl&&this.owner.editorModule.layoutWholeDocument()},e.prototype.updateCanvasWidthAndHeight=function(e,t,i,n,r,o){this instanceof kl?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?e-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:i>t&&(e-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):i>t&&(e-=this.documentHelper.scrollbarWidth,n-=this.documentHelper.scrollbarWidth),n>e&&(t-=this.documentHelper.scrollbarWidth),r=n>e?n:e,o=i>t?i:t,parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)===r&&parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)===r||(this.documentHelper.pageContainer.style.width=r.toString()+"px",this.documentHelper.pageContainer.style.height=o.toString()+"px");var s=Math.max(1,window.devicePixelRatio||1);return this.documentHelper.containerCanvas.width===Math.floor(e*s)&&this.documentHelper.containerCanvas.height===Math.floor(t*s)||(this.documentHelper.containerCanvas.width=e*s,this.documentHelper.containerCanvas.height=t*s,this.documentHelper.containerCanvas.style.width=e+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(s,s),this.documentHelper.selectionCanvas.width=e*s,this.documentHelper.selectionCanvas.height=t*s,this.documentHelper.selectionCanvas.style.width=e+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(s,s)),{height:o,width:r,viewerWidth:e,viewerHeight:t,containerHeight:i,containerWidth:n}},e.prototype.updateScrollBarPosition=function(e,t,i,n,r,o){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop,this.owner.viewer.containerWidth=e,this.documentHelper.containerCanvas.style.position="absolute",this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.documentHelper.selectionCanvas.style.position="absolute",this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft,this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px",this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},e.prototype.destroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0},e.prototype.componentDestroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0,this.owner=void 0},e}(),kl=function(e){function t(t){var i=e.call(this,t)||this;return i.pageLeft=30,i.owner=t,i}return wl(t,e),Object.defineProperty(t.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i=this.pageGap;this.documentHelper.pages.length>0&&(i=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap);var n=new Dd(this.documentHelper);return this.updatePageBoundingRectangle(e,n,i),(0,a.isNullOrUndefined)(t)?this.documentHelper.pages.push(n):this.documentHelper.pages.splice(t,0,n),n.bodyWidgets.push(e),n.bodyWidgets[n.bodyWidgets.length-1].page=n,this.updateClientArea(e,n),this.documentHelper.layout.layoutHeaderFooter(e,this,n),this.updateClientArea(e,n),this.documentHelper.layout.footnoteHeight=0,n},t.prototype.updatePageBoundingRectangle=function(e,t,i){var n=(0,a.isNullOrUndefined)(e.sectionFormat)?816:Pa.convertPointToPixel(e.sectionFormat.pageWidth),r=(0,a.isNullOrUndefined)(e.sectionFormat)?1056:Pa.convertPointToPixel(e.sectionFormat.pageHeight),o=(this.documentHelper.visibleBounds.width-n*this.documentHelper.zoomFactor)/2;o<this.pageLeft&&(o=this.pageLeft),t.boundingRectangle=new Tl(o,i,n,r)},t.prototype.onPageFitTypeChanged=function(e){var t=this.documentHelper.visibleBounds.width,i=this.documentHelper.visibleBounds.height,n=this.visiblePages[0].bodyWidgets[0],r=Pa.convertPointToPixel(n.sectionFormat.pageWidth),o=Pa.convertPointToPixel(n.sectionFormat.pageHeight);switch(e){case"FitOnePage":if(i>0&&o>0){var s=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/o;s===this.documentHelper.zoomFactor?(0,a.isNullOrUndefined)(this.owner.selectionModule)||(0,a.isNullOrUndefined)(this.owner.selectionModule.start)||(0,a.isNullOrUndefined)(this.owner.selectionModule.end)||this.documentHelper.scrollToPosition(this.owner.selectionModule.start,this.owner.selectionModule.end):this.documentHelper.zoomFactor=s}break;case"FitPageWidth":t>0&&r>0&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/r);break;default:this.documentHelper.zoomFactor=1}},t.prototype.getCurrentPageHeaderFooter=function(e,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(e,t),e.index)},t.prototype.getHeaderFooterType=function(e,t){var i;i=t?"OddHeader":"OddFooter";var n=e.page;return e.sectionFormat.differentFirstPage&&((0,a.isNullOrUndefined)(n.previousPage)||!(0,a.isNullOrUndefined)(n.previousPage)&&n.sectionIndex!==n.previousPage.sectionIndex&&n.previousPage.bodyWidgets[n.previousPage.bodyWidgets.length-1].sectionIndex!==n.bodyWidgets[0].sectionIndex)?i=t?"FirstPageHeader":"FirstPageFooter":e.sectionFormat.differentOddAndEvenPages&&(n.index+1)%2==0&&(i=t?"EvenHeader":"EvenFooter"),i},t.prototype.getCurrentHeaderFooter=function(e,t){if(this.documentHelper.headersFooters[t]){var i=this.getHeaderFooter(e),n=this.documentHelper.headersFooters[t][i];if(!n){for(var r=t>0?t-1:t;!n&&-1!==r;)n=this.documentHelper.headersFooters[r][i],r--;n||((n=this.createHeaderFooterWidget(e)).isEmpty=!0),0==t&&(this.documentHelper.headersFooters[t][i]=n)}return n}if(t>0)return this.getCurrentHeaderFooter(e,t-1)},t.prototype.createHeaderFooterWidget=function(e){var t,i=new Bl(e),n=new Rl;return n.childWidgets.push(new zl(n)),t=-1!==e.indexOf("Header")?this.documentHelper.styles.findByName("Header"):this.documentHelper.styles.findByName("Footer"),n.paragraphFormat.baseStyle=t,n.paragraphFormat.listFormat.baseStyle=t,i.childWidgets.push(n),n.containerWidget=i,i},t.prototype.getHeaderFooter=function(e){switch(e){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},t.prototype.updateHFClientArea=function(e,t){var i=Pa.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin);i<0&&(i=0),this.clientArea=new Tl(Pa.convertPointToPixel(e.leftMargin),t?Pa.convertPointToPixel(e.headerDistance):Pa.convertPointToPixel(e.pageHeight-e.footerDistance),i,Number.POSITIVE_INFINITY),this.clientActiveArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},t.prototype.updateHeaderFooterClientAreaWithTop=function(e,t,i){this.updateHFClientArea(e,t),t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},t.prototype.updateFootnoteClientArea=function(e,t,i,n){var r=Pa.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),o=Pa.convertPointToPixel(e.leftMargin),s=Pa.convertPointToPixel(e.bottomMargin),a=Pa.convertPointToPixel(e.footerDistance),l=Pa.convertPointToPixel(e.pageHeight)-Math.max(a+t.page.footerWidget.height,s);this.clientArea=new Tl(o,l,r,Number.POSITIVE_INFINITY),this.clientActiveArea=new Tl(this.clientArea.x,this.clientArea.y,this.clientArea.width,Number.POSITIVE_INFINITY)},t.prototype.scrollToPage=function(e){for(var t=0,i=0;i<this.documentHelper.pages.length&&(t=this.documentHelper.pages[i].boundingRectangle.y*(this.documentHelper.zoomFactor>1?this.documentHelper.zoomFactor:1)-this.pageGap/2,i!==e);i++);this.documentHelper.viewerContainer.scrollTop=t,this.updateScrollBars()},t.prototype.updateScrollBars=function(){var e,t,i=(e=this.getPageHeightAndWidth(0,0,0,0)).width*this.documentHelper.zoomFactor+2*this.pageLeft,n=e.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap;n=(t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,n,i,e.width,e.height)).containerHeight,i=t.containerWidth,this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4;for(var r=0;r<this.documentHelper.pages.length;r++){var o=(t.width-this.documentHelper.pages[r].boundingRectangle.width*this.documentHelper.zoomFactor)/2;o>this.pageLeft?this.documentHelper.pages[r].boundingRectangle=new Tl(o,this.documentHelper.pages[r].boundingRectangle.y,this.documentHelper.pages[r].boundingRectangle.width,this.documentHelper.pages[r].boundingRectangle.height):this.documentHelper.pages[r].boundingRectangle=new Tl(this.pageLeft,this.documentHelper.pages[r].boundingRectangle.y,this.documentHelper.pages[r].boundingRectangle.width,this.documentHelper.pages[r].boundingRectangle.height)}this.updateScrollBarPosition(i,n,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=0;e<this.documentHelper.pages.length;e++){var t=this.documentHelper.pages[e],i=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1),n=t.boundingRectangle.x;this.documentHelper.isPageInVisibleBound(t,i)&&this.addVisiblePage(t,n,i)}},t.prototype.addVisiblePage=function(e,t,i){var n=this,r=e.boundingRectangle.width*this.documentHelper.zoomFactor,o=e.boundingRectangle.height*this.documentHelper.zoomFactor;this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,r,o);var s=document.getElementById(this.owner.element.id+"PICTURE_CONTENT_CONTROL");if((0,a.isNullOrUndefined)(s)||"none"===s.style.display||this.owner.setPictureContentControlPositions(s),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(e.index)<0||this.owner.editorModule.isPasteContentCheck)){this.owner.documentHelper.cachedPages.push(e.index);var l=void 0;(l=this.owner.editorModule.isPasteContentCheck?(0,a.isNullOrUndefined)(this.owner.editorModule.copiedTextContent)?"":this.owner.editorModule.copiedTextContent:this.documentHelper.owner.spellCheckerModule.getPageContent(e)).trim().length>0?(e.allowNextPageRendering=!1,(0,a.isNullOrUndefined)(this.owner)||(0,a.isNullOrUndefined)(this.owner.spellCheckerModule)||this.owner.spellCheckerModule.updateUniqueWords(Pa.getSpellCheckData(l)),this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID,l,!0,!1,!1,!0).then((function(s){var l=JSON.parse(s);(0,a.isNullOrUndefined)(n.owner)||((0,a.isNullOrUndefined)(n.owner.spellCheckerModule)||n.owner.spellCheckerModule.updateUniqueWords(l.SpellCollection),(0,a.isNullOrUndefined)(e)||(e.allowNextPageRendering=!0),(0,a.isNullOrUndefined)(n.documentHelper)||(n.documentHelper.triggerElementsOnLoading=!0,n.documentHelper.triggerSpellCheck=!0,n.documentHelper.triggerElementsOnLoading=!0,n.renderPage(e,t,i,r,o),n.documentHelper.triggerSpellCheck=!1,n.documentHelper.triggerElementsOnLoading=!1))})).catch(),(0,a.isNullOrUndefined)(e)||(e.allowNextPageRendering=!0)):this.renderPage(e,t,i,r,o)}else this.renderPage(e,t,i,r,o)},t.prototype.renderPage=function(e,t,i,n,r){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,n,r)},t}(Il),Fl=function(e){function t(t){var i=e.call(this,t)||this;return i.visiblePages=[],i.owner=t,i}return wl(t,e),Object.defineProperty(t.prototype,"documentHelper",{get:function(){try{return this.owner.documentHelper}catch(e){return}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i,n=0;return this.documentHelper.pages.length>0&&(n=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),i=new Dd(this.documentHelper),0===this.documentHelper.pages.length?i.boundingRectangle=new Tl(10,n,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height):i.boundingRectangle=new Tl(10,n-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(i),this.updateClientArea(void 0,i),i.bodyWidgets.push(e),i.bodyWidgets[i.bodyWidgets.length-1].page=i,i},t.prototype.onPageFitTypeChanged=function(e){this.documentHelper.zoomFactor=1},t.prototype.scrollToPage=function(e){this.updateScrollBars()},t.prototype.getContentHeight=function(){for(var e=0,t=0;t<this.documentHelper.pages.length;t++){var i=this.documentHelper.pages[t];0===t?(e+=this.padding.top,i.boundingRectangle.y=this.padding.top):i.boundingRectangle.y=this.documentHelper.pages[t-1].boundingRectangle.bottom,i.boundingRectangle.height=i.bodyWidgets[0].height,e+=i.bodyWidgets[0].height,t===this.documentHelper.pages.length-1&&(e+=this.padding.bottom)}return e},t.prototype.getContentWidth=function(){for(var e=this.documentHelper.visibleBounds.width,t=e,i=0;i<this.documentHelper.pages.length;i++){for(var n=this.documentHelper.pages[i],r=0;r<n.bodyWidgets[0].childWidgets.length;r++)if(n.bodyWidgets[0].childWidgets[r]instanceof Al){var o=n.bodyWidgets[0].childWidgets[r],s=Pa.convertPointToPixel(o.getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+n.boundingRectangle.x;t<s&&(e=s,t=s)}n.boundingRectangle.width=e}return e},t.prototype.updateScrollBars=function(){var e;e=this.getPageHeightAndWidth(0,0,0,0);var t,i=this.getContentWidth()*this.documentHelper.zoomFactor,n=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,n,i,e.width,e.height),this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,this.updateScrollBarPosition(i,n,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){var e,t;this.visiblePages=[];for(var i=this.documentHelper.visibleBounds.height,n=this.documentHelper.viewerContainer.scrollTop,r=0;r<this.documentHelper.pages.length;r++){t=(e=this.documentHelper.pages[r]).boundingRectangle.y*this.documentHelper.zoomFactor;var o=e.boundingRectangle.height*this.documentHelper.zoomFactor;(t>=n&&t<=n+i||t+o>=n&&t+o<=n+i||t<=n&&t+o>=n+i)&&this.addVisiblePage(e,this.padding.left,t)}},t.prototype.addVisiblePage=function(e,t,i){var n=this,r=this.getContentWidth(),o=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,r,o);var s=document.getElementById(this.owner.element.id+"PICTURE_CONTENT_CONTROL");if((0,a.isNullOrUndefined)(s)||"none"===s.style.display||this.owner.setPictureContentControlPositions(s),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellCheckerModule.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(e.index)<0||this.owner.editorModule.isPasteContentCheck)){this.owner.documentHelper.cachedPages.push(e.index);var l=void 0;(l=this.owner.editorModule.isPasteContentCheck?(0,a.isNullOrUndefined)(this.owner.editorModule.copiedTextContent)?"":this.owner.editorModule.copiedTextContent:this.documentHelper.owner.spellCheckerModule.getPageContent(e)).trim().length>0?(e.allowNextPageRendering=!1,(0,a.isNullOrUndefined)(this.owner)||(0,a.isNullOrUndefined)(this.owner.spellCheckerModule)||this.owner.spellCheckerModule.updateUniqueWords(Pa.getSpellCheckData(l)),this.owner.spellCheckerModule.callSpellChecker(this.owner.spellCheckerModule.languageID,l,!0,!1,!1,!0).then((function(s){var l=JSON.parse(s);(0,a.isNullOrUndefined)(n.owner)||((0,a.isNullOrUndefined)(n.owner)||(0,a.isNullOrUndefined)(n.owner.spellCheckerModule)||n.owner.spellCheckerModule.updateUniqueWords(l.SpellCollection),e.allowNextPageRendering=!0,(0,a.isNullOrUndefined)(n.documentHelper)||(n.documentHelper.triggerSpellCheck=!0,n.documentHelper.triggerElementsOnLoading=!0,n.renderPage(e,t,i,r,o),n.documentHelper.triggerSpellCheck=!1,n.documentHelper.triggerElementsOnLoading=!1))})).catch(),(0,a.isNullOrUndefined)(e)||(e.allowNextPageRendering=!0)):this.renderPage(e,t,i,r,o)}else this.renderPage(e,t,i,r,o)},t.prototype.renderPage=function(e,t,i,n,r){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,n,r)},t}(Il),Pl=function(){function e(e){this.viewerIn=e,this.clear()}return Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this.currentIndexIn},set:function(e){e>=0&&(this.currentIndexIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){var e;return(0,a.isNullOrUndefined)(this.columnIn)||(e=this.numberOfColumnsIn),e=e>0?e:1},enumerable:!0,configurable:!0}),e.prototype.setColumns=function(e){if(this.pageWidth=Pa.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),this.numberOfColumnsIn=e.numberOfColumns,!(0,a.isNullOrUndefined)(e.columns)){for(var t=e.columns,i=[],n=0;n<e.numberOfColumns;n++){var r=this.defaultSpaceIn,o=0;!(0,a.isNullOrUndefined)(t)&&t.length>0&&(r=t[n].space,o=t[n].width);var s=this.getColumnObj(o,r,e.numberOfColumns,e.equalWidth);s.index=n,i.push(s)}this.columnIn=i}},e.prototype.clear=function(){this.currentIndexIn=0,this.defaultSpaceIn=36,this.columnIn=null,this.pageWidth=0},e.prototype.reset=function(){this.currentIndex=0},e.prototype.getColumnBounds=function(e,t){var i=this.currentIndexIn;return this.getColumnBoundsByIndex(i,t)},e.prototype.getColumnBoundsByBodyWidget=function(e,t){var i=e.columnIndex;return this.getColumnBoundsByIndex(i,t)},e.prototype.getNextColumnByBodyWidget=function(e){var t=e.columnIndex;return this.getColumnByIndex(t+1)},e.prototype.getColumnByIndex=function(e){if(e>=0&&e<this.columnCount&&!(0,a.isNullOrUndefined)(this.columnIn)&&this.columnIn.length>0)return this.columnIn[e]},e.prototype.getColumnObj=function(e,t,i,n){var r=(i-1)*t,o=new ma;return!n&&0!==e||(0,a.isNullOrUndefined)(this.pageWidth)||(e=(this.pageWidth-r)/i),o.width=e,o.space=t,o},e.prototype.getColumnBoundsByIndex=function(e,t){var i=new Tl(t.x,t.y,t.width,t.height);if(e>=0&&this.columnIn.length>0){var n=void 0,r=void 0;if(!(0,a.isNullOrUndefined)(this.columnIn[e])){n=this.getColumnByIndex(e),i.width=n.width;for(var o=0;o<e;o++)r=this.columnIn[o],i.x+=r.width,i.x+=r.space}}return i},e}(),Sl=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Tl=function(){function e(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),e.prototype.isIntersecting=function(e){return!(e.y>this.bottom||this.y>e.bottom||e.x>this.right||this.x>e.right)},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}(),Hl=function(e,t,i,n){this.right=10,this.left=10,this.top=10,this.bottom=10,this.right=e,this.left=t,this.top=i,this.bottom=n},El=function(){function e(e,t,i,n){this.left=e,this.top=t,this.right=i,this.bottom=n}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},e}(),Nl=function(){function e(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}return Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this instanceof Ol&&this.page?this.containerWidget instanceof Dl?this.containerWidget.bodyWidgets.indexOf(this):this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):this instanceof Dl?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childWidgets.length>0?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e=e instanceof Ol?t>0?e.page.bodyWidgets[t-1]:void 0:t>0?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e=e instanceof Ol?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof Ol)if(t>0&&!(e.containerWidget instanceof Dl))e=e.page.bodyWidgets[t-1];else if(e.containerWidget instanceof Dl&&!e.page.documentHelper.owner.editorModule.removeEditRange){if(t<=0)return;e=e.containerWidget.bodyWidgets[t-1]}else{e=(i=e.page.previousPage)&&i.bodyWidgets.length>0?i.bodyWidgets[i.bodyWidgets.length-1]:void 0}else if(e instanceof Dl)for(var i=e.page;i.previousPage&&(e=(i=i.previousPage).footnoteWidget,(0,a.isNullOrUndefined)(e)););else if(t>0)e=e.containerWidget.childWidgets[t-1];else{var n=void 0;for(e.containerWidget instanceof Vl?n=e.containerWidget.getPreviousSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof Dl&&"Endnote"===e.containerWidget.containerWidget.footNoteType?n=e.containerWidget.previousWidget?e.containerWidget.previousWidget:e.containerWidget.previousRenderedWidget:e.containerWidget instanceof Ul||e.containerWidget instanceof Bl||e.containerWidget&&e.containerWidget.containerWidget instanceof Dl||(n=e.containerWidget.previousRenderedWidget);n&&0===n.childWidgets.length&&(n=n.previousRenderedWidget,!(0,a.isNullOrUndefined)(n)););e=n&&n.constructor===e.containerWidget.constructor?n.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof Ol)if(t<e.page.bodyWidgets.length-1&&!(e.containerWidget instanceof Dl))e=e.page.bodyWidgets[t+1];else if(e.containerWidget instanceof Dl){if(t>=e.containerWidget.bodyWidgets.length-1&&!e.page.documentHelper.owner.editorModule.removeEditRange)return;e=e.containerWidget.bodyWidgets[t+1]}else if(e.page.allowNextPageRendering){e=(i=e.page.nextPage)&&i.bodyWidgets.length>0?i.bodyWidgets[0]:void 0}else e=void 0;else if(e instanceof Dl)for(var i=e.page;i.allowNextPageRendering&&i.nextPage&&(e=(i=i.nextPage).footnoteWidget,(0,a.isNullOrUndefined)(e)););else if(t<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[t+1];else{var n=void 0;for(e.containerWidget instanceof Vl?n=e.containerWidget.getNextSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof Dl&&"Endnote"===e.containerWidget.containerWidget.footNoteType?n=e.containerWidget.nextWidget?e.containerWidget.nextWidget:e.containerWidget.nextRenderedWidget:e.containerWidget instanceof Ul||e.containerWidget instanceof Bl||e.containerWidget&&e.containerWidget.containerWidget instanceof Dl||(n=e.containerWidget.nextRenderedWidget);n&&0===n.childWidgets.length&&!(n instanceof Vl)&&(n=n.nextRenderedWidget,!(0,a.isNullOrUndefined)(n)););e=n&&n.constructor===e.containerWidget.constructor?n.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousSplitWidget",{get:function(){var e=this;if(e instanceof Vl)return e.getPreviousSplitWidget();var t=e.previousRenderedWidget;if(e instanceof Ol&&t instanceof Ol&&e.equals(t)&&!(e.containerWidget instanceof Dl&&"Endnote"===e.containerWidget.footNoteType))return t;if(t instanceof Ll&&e.index===t.index&&e.equals(t))return t;if(e instanceof Ol&&e.containerWidget instanceof Dl&&"Endnote"===e.containerWidget.footNoteType&&!(0,a.isNullOrUndefined)(e.page.previousPage)&&!(0,a.isNullOrUndefined)(e.page.previousPage.endnoteWidget)){if((t=e.page.previousPage.endnoteWidget.bodyWidgets[e.page.previousPage.endnoteWidget.bodyWidgets.length-1])&&t instanceof Ol&&e.index===t.index&&e.equals(t))return t}else if(e instanceof Ll&&e.bodyWidget&&e.bodyWidget.containerWidget instanceof Dl&&"Endnote"===e.bodyWidget.containerWidget.footNoteType&&!(0,a.isNullOrUndefined)(e.bodyWidget.page.previousPage)&&!(0,a.isNullOrUndefined)(e.bodyWidget.page.previousPage.endnoteWidget)&&e.bodyWidget.page.previousPage.endnoteWidget.bodyWidgets.length>0){var i=e.bodyWidget.page.previousPage.endnoteWidget,n=i.bodyWidgets[i.bodyWidgets.length-1];if((t=n.childWidgets[n.childWidgets.length-1])&&t instanceof Ll&&e.index===t.index&&e.equals(t))return t}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSplitWidget",{get:function(){var e=this;if(e instanceof Vl)return e.getNextSplitWidget();var t=e.nextRenderedWidget;if(e instanceof Ol&&t instanceof Ol&&e.equals(t)&&!(e.containerWidget instanceof Dl&&"Endnote"===e.containerWidget.footNoteType))return t;if(t instanceof Ll&&e.index===t.index&&e.equals(t))return t;if(e instanceof Ol&&e.containerWidget instanceof Dl&&"Endnote"===e.containerWidget.footNoteType&&!(0,a.isNullOrUndefined)(e.page.nextPage)&&!(0,a.isNullOrUndefined)(e.page.nextPage.endnoteWidget)){if((t=e.page.nextPage.endnoteWidget.bodyWidgets[0])&&t instanceof Ol&&e.index===t.index&&e.equals(t))return t}else if(e instanceof Ll&&e.bodyWidget&&e.bodyWidget.containerWidget instanceof Dl&&"Endnote"===e.bodyWidget.containerWidget.footNoteType&&!(0,a.isNullOrUndefined)(e.bodyWidget.page.nextPage)&&!(0,a.isNullOrUndefined)(e.bodyWidget.page.nextPage.endnoteWidget)&&e.bodyWidget.page.nextPage.endnoteWidget.bodyWidgets.length>0&&(t=e.bodyWidget.page.nextPage.endnoteWidget.bodyWidgets[0].childWidgets[0])&&t instanceof Ll&&e.index===t.index&&e.equals(t))return t},enumerable:!0,configurable:!0}),e.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t&&(e.unshift(t),!(t=t.previousSplitWidget)||t!=t.previousSplitWidget););return e},e.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},e.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(i.length>1)for(t=i.shift();i.length>0;){var n=i.shift();t.combine(n,e)}return t instanceof Al&&t.combineRows(e),t},e.prototype.combine=function(t,i){if(t.childWidgets.length>0){var n=this.lastChild;if(n instanceof Al)n.combineWidget(i);else{var r=t.firstChild;!(t instanceof Al)&&n instanceof e&&r instanceof e&&n.index===r.index&&n.combine(t.childWidgets.shift(),i)}this.addWidgets(t.childWidgets),t.childWidgets=[]}t.destroyInternal(i)},e.prototype.addWidgets=function(t){for(;t.length>0;){var i=t.shift();if(i instanceof zl&&this instanceof Rl)i.paragraph=this,this.height+=i.height;else if(i instanceof e){var n=this.lastChild;i.containerWidget=this,i.y=n instanceof e?n.y+n.height:this.y,this.height+=i.height}if(i instanceof Ul)for(var r=this.childWidgets[this.childWidgets.length-1],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];if(s.cellFormat.rowSpan>1)for(var a=0;a<i.childWidgets.length;a++){var l=i.childWidgets[a];if(l.columnIndex===s.columnIndex&&l.isSplittedCell&&l.cellFormat.rowSpan===s.cellFormat.rowSpan){for(var d=0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];l.childWidgets.splice(h.indexInOwner,1),s.childWidgets.push(h),h.containerWidget=s,d--}l.ownerRow.childWidgets.splice(l.indexInOwner,1),l.containerWidget=void 0,a--}}}this.childWidgets.push(i)}},e.prototype.removeChild=function(e){e>-1&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},e.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof zl||t instanceof e)&&t.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},e.prototype.componentDestroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof zl||t instanceof e)&&t.componentDestroy()}this.childWidgets=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0,this.containerWidget=void 0},e}(),Wl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.floatingElements=[],t.footNoteReference=void 0,t.sectionFormatIn=void 0,t.columnIndex=0,t.isWord2010NextColumn=!1,t}return Sl(t,e),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){var e=this;return e instanceof Ol?e.sectionFormatIn:e.page&&!(0,a.isNullOrUndefined)(e.page.bodyWidgets)?e.page.bodyWidgets[0].sectionFormat:void 0},set:function(e){this instanceof Ol&&(this.sectionFormatIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionIndex",{get:function(){var e=this,t=0;return e instanceof Ol?t=e.index:e.page&&(t=e.page.bodyWidgets[0].index),t},enumerable:!0,configurable:!0}),t.prototype.getHierarchicalIndex=function(e){var t=this;return e=t instanceof Ol?t.index+";"+e:t instanceof Dl?"Footnote"===t.footNoteType?"FN;"+e:"EN;"+e:-1!==t.headerFooterType.indexOf("Header")?"H;"+e:"F;"+e,(0,a.isNullOrUndefined)(t.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},t.prototype.componentDestroy=function(){this.sectionFormatIn&&this.sectionFormatIn.destroy(),this.sectionFormatIn=void 0,this.floatingElements=[],this.removedHeaderFooters=[],this.footNoteReference=void 0,this.page=void 0,e.prototype.componentDestroy.call(this)},t}(Nl),Ol=function(e){function t(){return e.call(this)||this}return Sl(t,e),t.prototype.equals=function(e){return e instanceof t&&e.sectionFormat===this.sectionFormat},t.prototype.getHierarchicalIndex=function(e){var t=this;return t.containerWidget instanceof Dl?(e=t.containerWidget.bodyWidgets.indexOf(t)+";"+e,e="Footnote"===t.containerWidget.footNoteType?"FN;"+e:"EN;"+e):e=this.page&&-1!==this.page.bodyWidgets.indexOf(this)?this.page.bodyWidgets.indexOf(this)+";"+e:t.index+";"+e,(0,a.isNullOrUndefined)(t.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof Al){var i=this.childWidgets[t],n=0;if(i.wrapTextAround&&(n=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+n>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},t.prototype.destroyInternal=function(e){this.height;if(!(0,a.isNullOrUndefined)(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.destroyInternal(e),(0,a.isNullOrUndefined)(this.childWidgets))break;t--}this.childWidgets=void 0}if(!(0,a.isNullOrUndefined)(this.page)){var n=this.indexInOwner;this.indexInOwner>-1&&(this.page.bodyWidgets.splice(n,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof Bl&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof Bl&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0)}this.destroy()},t.prototype.destroy=function(){this.sectionFormatIn=void 0,this.page&&this.page.headerWidgetIn&&(this.page.headerWidgetIn.page=void 0),this.page&&this.page.footerWidgetIn&&(this.page.footerWidgetIn.page=void 0),this.page=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){e.prototype.componentDestroy.call(this)},t}(Wl),Bl=function(e){function t(t){var i=e.call(this)||this;return i.isEmpty=!1,i.headerFooterType=t,i}return Sl(t,e),t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof Al){var i=this.childWidgets[t],n=0;if(i.wrapTextAround&&(n=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+n>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t(this.headerFooterType),i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.index=i,n.containerWidget=e}return e.isEmpty=this.isEmpty,e.x=this.x,e.y=this.y,e.height=0,e.width=0,e},t.prototype.destroyInternal=function(t){this.page=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){e.prototype.componentDestroy.call(this),this.parentHeaderFooter=void 0},t}(Wl),Ll=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isLayouted=!1,t.isFieldCodeBlock=!1,t.locked=!1,t.lockedBy="",t}return Sl(t,e),Object.defineProperty(t.prototype,"bodyWidget",{get:function(){for(var e=this;e.containerWidget;){if(e.containerWidget instanceof cd){var t=e.containerWidget.containerShape.line.paragraph;if(t)return t.bodyWidget}else if(e.containerWidget instanceof Wl)return e.containerWidget;e=e.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftIndent",{get:function(){var e=this;return e instanceof Rl&&e.paragraphFormat instanceof ba?e.paragraphFormat.leftIndent:e instanceof Al&&e.tableFormat instanceof Ra?e.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightIndent",{get:function(){var e=this;return e instanceof Rl&&e.paragraphFormat instanceof ba?e.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof Vl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof Bl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof Vl)return this.containerWidget},enumerable:!0,configurable:!0}),t.prototype.isPageBreak=function(){var e=!1;if(this instanceof Rl){var t=this;if(null!=t&&1===t.childWidgets.length&&1===t.firstChild.children.length)e=t.firstChild.children[0].isPageBreak}return e},t.prototype.isColumnBreak=function(){var e=!1;if(this instanceof Rl){var t=this;if(null!=t&&1===t.childWidgets.length&&1===t.firstChild.children.length)e=t.firstChild.children[0].isColumnBreak}return e},t.prototype.getHierarchicalIndex=function(e){var i=this;if(e=i.containerWidget.childWidgets.indexOf(i)+";"+e,!(0,a.isNullOrUndefined)(i.containerWidget)){if(i.containerWidget instanceof cd)return i.containerWidget.getHierarchicalIndex(e);if(i.containerWidget instanceof t)return i.containerWidget.getHierarchicalIndex(e);i.containerWidget instanceof Wl&&(e=i.containerWidget.getHierarchicalIndex(e))}return e},t.prototype.getIndex=function(){return this instanceof Rl||this instanceof Al?this.containerWidget.childWidgets.indexOf(this):this instanceof Ul?this.ownerTable.childWidgets.indexOf(this):this instanceof Vl?this.ownerRow.childWidgets.indexOf(this):0},t.prototype.getContainerWidth=function(){if(this.isInsideTable){if(this instanceof Al&&"Auto"===this.tableFormat.preferredWidthType&&this.associatedCell.ownerTable.isGridUpdated){for(var e=0,t=this.associatedCell.cellFormat.columnSpan,i=this.associatedCell.columnIndex,n=0;n<t;n++)e+=this.associatedCell.ownerTable.tableHolder.columns[i].preferredWidth,i++;if(e>0)return e}return this.associatedCell.getCellWidth(this)}if(this.containerWidget instanceof cd){var r=this.containerWidget.containerShape;return Pa.convertPixelToPoint(r.width)-Pa.convertPixelToPoint(r.textFrame.marginLeft)-Pa.convertPixelToPoint(r.textFrame.marginRight)}var o=this.bodyWidget,s=o.sectionFormat,l=0;if(!(0,a.isNullOrUndefined)(o.page)&&!(0,a.isNullOrUndefined)(o.page.documentHelper)&&"Word2013"!==o.page.documentHelper.compatibilityMode&&!this.isInsideTable&&this instanceof Al){var d=this.firstChild;l=d.firstChild.leftMargin+d.lastChild.rightMargin}if(o instanceof Ol&&s.columns.length>1){var h=o.columnIndex;return Pa.convertPixelToPoint(s.columns[h].width)}return s.pageWidth-(s.leftMargin+s.rightMargin)+l},Object.defineProperty(t.prototype,"bidi",{get:function(){return this instanceof Rl&&this.paragraphFormat instanceof ba?this.paragraphFormat.bidi:this instanceof Al&&this.tableFormat instanceof Ra&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),t.prototype.componentDestroy=function(){e.prototype.componentDestroy.call(this),this.contentControlProperties=void 0},t}(Nl),Dl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyWidgets=[],t}return Sl(t,e),t.prototype.getMinimumAndMaximumWordWidth=function(e,t){throw new Error("Method not implemented.")},t.prototype.getTableCellWidget=function(e){},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t,i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.index=i,n.containerWidget=e}return e.block=this.block,e},t.prototype.destroyInternal=function(t){this.block=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){if(this.bodyWidgets&&this.bodyWidgets.length>0){for(var t=0;t<this.bodyWidgets.length;t++){this.bodyWidgets[t].componentDestroy()}this.bodyWidgets=[]}this.bodyWidgets=void 0,this.block=void 0,e.prototype.componentDestroy.call(this)},t}(Wl),Rl=function(i){function n(){var e=i.call(this)||this;return e.isSectionBreak=!1,e.isChangeDetected=!1,e.textWrapWidth=!1,e.clientX=void 0,e.floatingElements=[],e.paragraphFormat=new ba(e),e.characterFormat=new ka(e),e}return Sl(n,i),Object.defineProperty(n.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEndsWithColumnBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithColumnBreak},enumerable:!0,configurable:!0}),n.prototype.equals=function(e){return e instanceof n&&e.paragraphFormat===this.paragraphFormat},n.prototype.isContainsShapeAlone=function(){for(var e=!1,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(!(r instanceof dd)||r instanceof dd&&"Inline"===r.textWrappingStyle)return!1;e=!0}return!!e},n.prototype.isEmptyInternal=function(e){if((0,a.isNullOrUndefined)(this.childWidgets)||0===this.childWidgets.length)return!0;for(var t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];if(0!==r.length&&(r instanceof Zl||r instanceof gd||r instanceof td||r instanceof fd||r instanceof vd||r instanceof yd||r instanceof hd||r instanceof id||r instanceof Bd&&!e||r instanceof _l&&Pa.isLinkedFieldCharacter(r)))return!1}return!0},n.prototype.isEmpty=function(){return this.isEmptyInternal(!1)},n.prototype.getInline=function(e,t){for(var i=void 0,n=0,r=!1,o=this.getSplitWidgets(),s=0;s<o.length;s++)for(var l=o[s],d=0;d<l.childWidgets.length;d++)for(var h=l.childWidgets[d],c=0;c<h.children.length;c++)if(!((i=h.children[c])instanceof md)){if((!r&&(i instanceof Zl||i instanceof gd||i instanceof hd||i instanceof td||i instanceof _l&&Pa.isLinkedFieldCharacter(i))||i instanceof yd||i instanceof id||i instanceof Bd)&&(r=!0),r&&e<=n+i.length)return{element:i,index:t=e-n};n+=i.length}return e>n&&(t=(0,a.isNullOrUndefined)(i)?e:i.length),{element:i,index:t}},n.prototype.getLength=function(){var e=0;if((0,a.isNullOrUndefined)(this.childWidgets))return e;for(var t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],n=0;n<i.children.length;n++){var r=i.children[n];r instanceof md||(e+=r.length)}return e},n.prototype.getTotalLength=function(){for(var e=0,t=this.getSplitWidgets(),i=0;i<t.length;i++)e+=t[i].getLength();return e},n.prototype.getTableCellWidget=function(e){},n.prototype.getMinimumAndMaximumWordWidth=function(e,t){if(e=Pa.convertPointToPixel(e),t=Pa.convertPointToPixel(t),this.childWidgets.length>0){for(var i=this.childWidgets[0].children[0],n="",r=new l,o=[];;){if(i instanceof Zl&&""!==i.text)r.add(i,n.length),n+=i.text;else if(i instanceof _l&&0===i.fieldType){var s=i;(0,a.isNullOrUndefined)(s.fieldEnd)||(i=(0,a.isNullOrUndefined)(s.fieldSeparator)?s.fieldEnd:s.fieldSeparator)}else i instanceof gd&&o.push(i.width);if((0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(i.nextNode))break;i=i.nextNode}var d=void 0;d=this.isInsideTable&&this.containerWidget instanceof Vl&&this.containerWidget.ownerTable&&this.containerWidget.ownerTable.bodyWidget&&this.containerWidget.ownerTable.bodyWidget.page&&this.containerWidget.ownerTable.bodyWidget.page.documentHelper&&this.containerWidget.ownerTable.bodyWidget.page.documentHelper.layout&&this.bodyWidget.page.documentHelper.layout.isAllColumnHasAutoWidthType?new RegExp("[^\\s\\-\\u4E00-\\u9FFF]+","g"):new RegExp("\\b\\w+\\b","g");for(var h=[],c=void 0;!(0,a.isNullOrUndefined)(c=d.exec(n));)h.push(c);for(var p=0;p<h.length;p++){var u=h[p],g=0;n="";for(var m="",f=0,v=u.index,y=u.index,w=0;w<r.keys.length;w++){var b=r.keys[w],C=r.get(b),x=b.length;if(y<=C+x&&(f=y-C,u.index+u[0].length<=C+x?v=u.index+u[0].length-(C+f):y+=v=x-f,m+=n=b.text.substring(f,f+v)),""!==n&&(g+=this.bodyWidget.page.documentHelper.textHelper.getWidth(n,b.characterFormat,b.scriptType)),m===u[0])break}0!==g&&(0===e||g>e)&&(e=g)}var I=0;o.length>0&&(I=Math.max.apply(null,o)),(0===e||I>e)&&(e=I);var k=this.measureParagraph();(0===t||k>t)&&(t=k)}var F=0;if(!this.isEmpty()&&0==this.floatingElements.length&&!(0,a.isNullOrUndefined)(this.paragraphFormat)&&this.paragraphFormat.leftIndent>0&&!(0,a.isNullOrUndefined)(this.associatedCell)&&!(0,a.isNullOrUndefined)(this.associatedCell.cellFormat)&&"Point"===this.associatedCell.cellFormat.preferredWidthType){var P=this.paragraphFormat.leftIndent+this.paragraphFormat.firstLineIndent;P+e>this.associatedCell.cellFormat.preferredWidth&&(F=P)}return{maximumWordWidth:Pa.convertPixelToPoint(t),minimumWordWidth:Pa.convertPixelToPoint(e)+F}},n.prototype.measureParagraph=function(){for(var e=0,t=this.childWidgets[0].children[0];;){if(t instanceof Zl&&""!==t.text)t.isWidthUpdated&&" "!==t.text[t.text.length-1]?e+=t.trimEndWidth:e+=this.bodyWidget.page.documentHelper.textHelper.getWidth(t.text,t.characterFormat,t.scriptType);else if(t instanceof _l&&0===t.fieldType){var i=t;null!=i.fieldEnd&&(t=(0,a.isNullOrUndefined)(i.fieldSeparator)?i.fieldEnd:i.fieldSeparator)}else t instanceof gd&&(e+=t.width);if((0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(t.nextNode))break;t=t.nextNode}return this.leftIndent>0&&(e+=this.leftIndent),this.rightIndent>0&&(e+=this.rightIndent),e},n.prototype.isArabicChar=function(e){return e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)},n.prototype.isHebrewChar=function(e){return e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)||e>=String.fromCharCode(64285)&&e<=String.fromCharCode(64335)},n.prototype.isHindiChar=function(e){return e>=String.fromCharCode(2304)&&e<=String.fromCharCode(2431)||e>=String.fromCharCode(43232)&&e<=String.fromCharCode(43263)||e>=String.fromCharCode(7376)&&e<=String.fromCharCode(7423)},n.prototype.isKoreanChar=function(e){return e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55203)||e>=String.fromCharCode(4352)&&e<=String.fromCharCode(4607)||e>=String.fromCharCode(12592)&&e<=String.fromCharCode(12687)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(55216)&&e<=String.fromCharCode(55295)||e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55215)},n.prototype.isJapanese=function(e){return e>=String.fromCharCode(12448)&&e<=String.fromCharCode(12543)||e>=String.fromCharCode(12352)&&e<=String.fromCharCode(12447)},n.prototype.isThaiCharacter=function(e){return e>=String.fromCharCode(3584)&&e<=String.fromCharCode(3711)},n.prototype.isChineseChar=function(e){return e>=String.fromCharCode(19968)&&e<=String.fromCharCode(40959)||e>=String.fromCharCode(13312)&&e<=String.fromCharCode(19903)||e>=String.fromCharCode(55360)&&e<=String.fromCharCode(55401)||e>=String.fromCharCode(56320)&&e<=String.fromCharCode(57055)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(65280)&&e<=String.fromCharCode(65519)||e>=String.fromCharCode(12288)&&e<=String.fromCharCode(12351)||e>=String.fromCharCode(63744)&&e<=String.fromCharCode(64255)},n.prototype.isSpecialCharacters=function(e){return e>=String.fromCharCode(8192)&&e<=String.fromCharCode(10175)},n.prototype.getFontScriptType=function(e,i){return this.isHindiChar(e)?t.Hindi:this.isKoreanChar(e)?t.Korean:this.isJapanese(e)?t.Japanese:this.isChineseChar(e)?t.Chinese:this.isArabicChar(e)?t.Arabic:this.isHebrewChar(e)?t.Hebrew:this.isThaiCharacter(e)?t.Thai:this.isSpecialCharacters(e)&&i?t.SpecialCharacter:t.English},n.prototype.splitTextByFontScriptType=function(e,i,n){var r=[];if((0,a.isNullOrUndefined)(e)||!(0,a.isNullOrUndefined)(e)&&""===e)return r;for(var o="",s=t.English,l=t.English,d=/[\uD800-\uDFFF]/,h=0;h<e.length;h++)e[h]==String.fromCharCode(32)||d.test(e[h])||(l=this.getFontScriptType(e[h],n)),""!=o&&l!==s&&(r.push(o),i.push(s),o=""),o+=e[h],s=l;return""!=o&&(r.push(o),i.push(l),o=""),r},n.prototype.splitTextRangeByScriptType=function(e){var t=!1,i=1;if(this.childWidgets.length>0){for(var n=this.childWidgets[e],r=e+1;r<this.childWidgets.length;r++){for(var o=this.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];n.children.push(a),a.line=n}this.childWidgets.splice(r,1),r--}for(r=0;r<n.children.length;r+=i){var l=n.children[r];i=1;var d=void 0;if(l instanceof Zl&&(d=l),l instanceof _l&&0==l.fieldType?t=!0:l instanceof _l&&2===l.fieldType&&(t=!1),null!=d&&!t){var h="EastAsia"===d.characterFormat.fontHintType&&d.characterFormat.hasValue("fontFamilyFarEast"),c=[],p=this.splitTextByFontScriptType(d.text,c,h);if(p.length>1)for(var u=0;u<p.length;u++){var g=p[u];if(u>0){var m=d.clone();m.text=g,m.scriptType=c[u],n.children.splice(r+u,0,m),m.line=n,i++,d.revisions.length>0&&this.updateTextElementInRevisionRange(d,m)}else d.text=g,d.scriptType=c[u]}else p.length>0&&(d.scriptType=c[0]);c.length=0}}}},n.prototype.splitLtrAndRtlText=function(e){var t={value:null},i=1,n={value:null},r=[],o=!1,s=this.bodyWidget.page.documentHelper.textHelper;if(this.childWidgets.length>0){for(var a=this.childWidgets[e],l=0;l<a.children.length;l+=i){var d=a.children[l];i=1;var h=void 0;if(d instanceof Zl&&(h=d),d instanceof _l&&0==d.fieldType?o=!0:d instanceof _l&&2===d.fieldType&&(o=!1),null!=h&&!o){var c=h.text,p=h.characterFormat.bidi,u=!1,g=r.length;p&&(u=s.isRightToLeftLanguage(d.characterFormat.localeIdBidi));var m=s.splitTextByConsecutiveLtrAndRtl(c,p,u,r,t,n);if(m.length>1)for(var f=0;f<m.length;f++)if(c=m[f],f>0){var v=h.clone();v.text=c,v.characterRange=r[f+g],a.children.splice(l+f,0,v),v.line=a,i++,h.revisions.length>0&&this.updateTextElementInRevisionRange(h,v)}else h.text=c,h.characterRange=r[g];else m.length>0&&(h.characterRange=r[g])}}r.length=0}},n.prototype.updateTextElementInRevisionRange=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);n.range.splice(r+1,0,t),t.revisions.push(n),t.removedIds=[]}},n.prototype.combineconsecutiveRTL=function(i){for(var n=!1,r=this.bodyWidget.page.documentHelper.textHelper,o=i;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<=s.children.length-2;a++){var l=s.children[a];if(l instanceof _l&&0===l.fieldType?n=!0:l instanceof _l&&2===l.fieldType&&(n=!1),!n&&l instanceof Zl&&s.children[a+1]instanceof Zl){var d=l,h=s.children[a+1];((d.characterFormat.complexScript&&d.scriptType==h.scriptType||d.characterFormat.bidi&&d.scriptType!==t.Hebrew&&d.characterRange==e.RightToLeft&&h.characterRange==e.RightToLeft)&&d.text.length>0&&h.text.length>0&&!r.isWordSplitChar(d.text[d.text.length-1])&&!r.isWordSplitChar(h.text[0])&&d.characterFormat.isEqualFormat(h.characterFormat)&&this.compareRevisions(d.revisions,h.revisions)||d.characterRange==e.RightToLeft&&h.characterRange==e.RightToLeft&&d.text.length>0&&h.text.length>0&&r.isWordSplitChar(d.text[d.text.length-1])&&r.isWordSplitChar(h.text[0])&&d.characterFormat.isEqualFormat(h.characterFormat)&&this.compareRevisions(d.revisions,h.revisions))&&(d.text=d.text+h.text,s.children.splice(a+1,1),a--)}}},n.prototype.compareRevisions=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},n.prototype.clone=function(){var e=new n;e.paragraphFormat.copyFormat(this.paragraphFormat),e.characterFormat.copyFormat(this.characterFormat);for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i);for(var r=0;r<i.children.length;r++){var o=i.children[r];(o instanceof gd&&"Inline"!==o.textWrappingStyle||o instanceof hd)&&e.floatingElements.push(o)}i.paragraph=e}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.absoluteXPosition=(0,a.isNullOrUndefined)(this.absoluteXPosition)?void 0:{width:this.absoluteXPosition.width,x:this.absoluteXPosition.x},this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},n.prototype.destroyInternal=function(e){var t=this.height;if(!(0,a.isNullOrUndefined)(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroy(),1===this.childWidgets.length&&(0,a.isNullOrUndefined)(this.childWidgets[0].children)&&(this.childWidgets=void 0),(0,a.isNullOrUndefined)(this.childWidgets))break;i--}this.childWidgets=void 0}(0,a.isNullOrUndefined)(this.containerWidget)||(0,a.isNullOrUndefined)(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t,this.containerWidget=void 0),this.hasOwnProperty("absoluteXPosition")&&delete this.absoluteXPosition,this.destroy()},n.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,i.prototype.destroy.call(this)},n.prototype.componentDestroy=function(){this.paragraphFormat&&this.paragraphFormat.destroy(),this.paragraphFormat=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,i.prototype.componentDestroy.call(this)},n}(Ll),Ml=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.allowOverlap=this.allowOverlap,t.distanceTop=this.distanceTop,t.distanceRight=this.distanceRight,t.distanceLeft=this.distanceLeft,t.distanceBottom=this.distanceBottom,t.verticalAlignment=this.verticalAlignment,t.verticalOrigin=this.verticalOrigin,t.verticalPosition=this.verticalPosition,t.horizontalAlignment=this.horizontalAlignment,t.horizontalOrigin=this.horizontalOrigin,t.horizontalPosition=this.horizontalPosition,t},e}(),Al=function(e){function t(){var t=e.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.isDefaultFormatUpdated=!1,t.isContainInsideTable=!1,t.footnoteElement=[],t.margin=new El(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new Ra(t),t.tableHolder=new Rd,t.spannedRowCollection=new l,t}return Sl(t,e),Object.defineProperty(t.prototype,"isGridUpdated",{get:function(){return!!((4&this.flags)>>2)},set:function(e){this.flags=251&this.flags|(e?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"continueHeader",{get:function(){return!!((2&this.flags)>>1)},set:function(e){this.flags=253&this.flags|(e?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return!!(1&this.flags)},set:function(e){this.flags=254&this.flags|(e?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBidiTable",{get:function(){return!!((16&this.flags)>>4)},set:function(e){this.flags=239&this.flags|(e?1:0)<<4},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.tableFormat===this.tableFormat},t.prototype.combineRows=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(!(0,a.isNullOrUndefined)(i.firstChild)&&0!==i.firstChild.index&&1===i.getSplitWidgets().length)for(var n=0;n<i.childWidgets.length;n++)i.childWidgets[n].index--;0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(e)}},t.prototype.contains=function(e){if(this.equals(e.ownerTable))return!0;for(;e.ownerTable.isInsideTable;){if(this.equals(e.ownerTable))return!0;e=e.ownerTable.associatedCell}return this.equals(e.ownerTable)},t.prototype.getOwnerWidth=function(e){var t=this.getContainerWidth();return"Auto"===this.tableFormat.preferredWidthType&&(t=t-this.leftIndent-this.rightIndent),t>=0?t:0},t.prototype.getTableWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,n=this.childWidgets[t],r=0;r<n.childWidgets.length;r++)i+=n.childWidgets[r].cellFormat.cellWidth;e<i&&(e=i)}return e},t.prototype.getTableCellWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,n=this.childWidgets[t],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r],s=o.width;0===s&&((s=o.cellFormat.cellWidth)>o.cellFormat.preferredWidth&&0!==o.cellFormat.preferredWidth&&"Percent"!==o.cellFormat.preferredWidthType&&(s=o.cellFormat.preferredWidth),s=Pa.convertPointToPixel(s-(o.margin.left+o.margin.right))),i+=s+o.margin.left+o.margin.right}e<i&&(e=i)}return e},t.prototype.getTableClientWidth=function(e){var t=e;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0&&(t=t*this.tableFormat.preferredWidth/100),t},t.prototype.getCellWidth=function(e,t,i,n){var r=e;return"Percent"===t?r=e*i/100:"Point"===t?r=e:(0,a.isNullOrUndefined)(n)||(r=this.getMinimumPreferredWidth(n)),r},t.prototype.getMinimumPreferredWidth=function(e){return 0!==e.cellFormat.preferredWidth||0===e.cellFormat.cellWidth||e.ownerTable&&e.ownerTable.bodyWidget&&e.ownerTable.bodyWidget.page&&e.ownerTable.bodyWidget.page.documentHelper&&e.ownerTable.bodyWidget.page.documentHelper.layout&&this.bodyWidget.page.documentHelper.layout.isAllColumnHasAutoWidthType?e.getMinimumPreferredWidth():e.cellFormat.cellWidth},t.prototype.fitCellsToClientArea=function(e){for(var t=e/this.getTableWidth(),i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i];n.rowFormat.gridAfterWidth*=t,n.rowFormat.gridBeforeWidth*=t;for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r].cellFormat.cellWidth*=t,n.childWidgets[r].cellFormat.preferredWidth*=t}},t.prototype.getTableCellWidget=function(e){for(var t=void 0,i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=e.y&&this.childWidgets[i].y+this.childWidgets[i].height>=e.y){t=this.childWidgets[i].getTableCellWidget(e);break}return t},t.prototype.calculateGrid=function(e){var t=[],i=[],n=[],r=this.getOwnerWidth(!0),o=this.getTableClientWidth(r);this.tableCellInfo=new l;for(var s=0;s<this.childWidgets.length;s++){var a=this.childWidgets[s],d=new l,h=a.rowFormat,c=a.rowFormat.gridBefore,p=0;t.indexOf(p)<0&&(t.push(p),i.push(p)),p+=this.getCellWidth(h.gridBeforeWidth,h.gridBeforeWidthType,o,null);var u=parseFloat(p.toFixed(2));t.indexOf(u)<0&&(t.push(u),i.push(p));for(var g=0;g<a.childWidgets.length;g++){for(var m=a.childWidgets[g],f=0;f<n.length;f++)if(!(n[f].columnIndex<c)){var v=n[f].cellFormat.rowSpan,y=!0;n[f].columnIndex>c?(y=!1,g===a.childWidgets.length-1&&a.rowFormat.gridAfter>0&&(p+=this.getCellWidth(n[f].cellFormat.preferredWidth,n[f].cellFormat.preferredWidthType,o,null))):(p+=this.getCellWidth(n[f].cellFormat.preferredWidth,n[f].cellFormat.preferredWidthType,o,null),c=n[f].columnIndex+n[f].cellFormat.columnSpan),y||g!==a.childWidgets.length-1||(y=!0),y&&s-n[f].ownerRow.rowIndex==v-1&&(n.splice(f,1),f--)}if(m.cellFormat.rowSpan>1)if(0===n.length||n[n.length-1].columnIndex<=c)n.push(m);else for(var w=n.length;w>0;w--)n[w-1].columnIndex>c&&n.splice(w-1,0,m);d.containsKey(m.cellIndex)||d.add(m.cellIndex,parseFloat((p-u).toFixed(2))),c+=m.cellFormat.columnSpan,p+=this.getCellWidth(m.cellFormat.preferredWidth,m.cellFormat.preferredWidthType,o,null);var b=parseFloat(p.toFixed(2));t.indexOf(b)<0&&(t.push(b),i.push(p)),g===a.childWidgets.length-1&&h.gridAfter>0&&(p+=this.getCellWidth(h.gridAfterWidth,"Point",o,null),t.indexOf(parseFloat(p.toFixed(2)))<0&&(t.push(parseFloat(p.toFixed(2))),i.push(p)),c+=h.gridAfter),this.tableCellInfo.containsKey(a.rowIndex)||this.tableCellInfo.add(a.rowIndex,d)}}t.sort((function(e,t){return e-t})),i.sort((function(e,t){return e-t})),this.tableHolder.columns.length>0&&(t.length-1!==this.tableHolder.columns.length||e)&&this.updateColumnSpans(t,o,i),this.tableCellInfo.clear(),this.tableCellInfo=void 0},t.prototype.updateColumnSpans=function(e,t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];r.rowFormat.gridBeforeWidth>=0&&(r.rowFormat.gridBefore=r.getGridCount(e,void 0,-1,t,i));for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o],a=r.getGridCount(e,s,s.getIndex(),t,i);a>0&&s.cellFormat.columnSpan!==a&&(s.cellFormat.columnSpan=a)}r.rowFormat.gridAfterWidth>=0&&(r.rowFormat.gridAfter=r.getGridCount(e,void 0,r.childWidgets.length,t,i))}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){this.checkTableColumns();var i=this.tableHolder.isAllColumnHasPointWidthType(),n=i?this.tableHolder.getTotalWidth(0):this.tableHolder.getTotalWidth(1);return n>e&&(e=n),i||(n=this.tableHolder.getTotalWidth(2)),n>t&&(t=n),{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.checkTableColumns=function(){this.isGridUpdated||((this.isAutoFit()||0===this.tableHolder.columns.length)&&this.buildTableColumns(),this.isGridUpdated=!1)},t.prototype.isAutoFit=function(){var e=this.bodyWidget;return!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(e.page)&&e.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},t.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var e,t=0,i=[],n="Auto"===this.tableFormat.preferredWidthType||"Point"===this.tableFormat.preferredWidthType&&0===this.tableFormat.preferredWidth,r=this.tableFormat.allowAutoFit;t=!(!(0,a.isNullOrUndefined)(this.bodyWidget.page)&&this.bodyWidget.page.viewer instanceof Fl&&r)||this.isInsideTable||this.containerWidget instanceof cd?this.getOwnerWidth(!0):Pa.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right),!(0,a.isNullOrUndefined)(this.bodyWidget.page)&&this.bodyWidget.page.documentHelper&&this.bodyWidget.page.documentHelper.layout&&(this.bodyWidget.page.documentHelper.layout.isAllColumnHasAutoWidthType=this.bodyWidget.page.documentHelper.layout.isAuto(this)),t=this.tableFormat.preferredWidth>t?this.tableFormat.preferredWidth:t;var o=n&&0===this.tableFormat.preferredWidth&&!r;e=this.getTableClientWidth(t);var s=this.getContainerWidth();o&&!this.isDefaultFormatUpdated&&r&&this.splitWidthToTableCells(e,o);for(var l=!1,d=0;d<this.childWidgets.length;d++){var h=this.childWidgets[d],c=h.rowFormat,p=0,u=0,g=new Ad,m=0;!(c.gridBefore>0)||0===h.rowFormat.beforeWidth&&0===h.rowFormat.gridBeforeWidth||this.bodyWidget.page.documentHelper.alignTablesRowByRow&&!("Left"===h.ownerTable.tableFormat.tableAlignment||"Word2003"===this.bodyWidget.page.documentHelper.compatibilityMode&&h.ownerTable.firstChild.rowFormat.gridAfter>0)||(u=this.getCellWidth(c.gridBeforeWidth,h.rowFormat.gridAfterWidthType,e,null),g.minimumWidth=u,this.tableHolder.addColumns(p,p=c.gridBefore,u,g,m=u,"Point"));for(var f=0;f<h.childWidgets.length;f++){var v=h.childWidgets[f];(v.cellFormat.rowSpan>1||v.cellFormat.columnSpan>1)&&(l=!0),0===i.length&&(v.columnIndex=p);for(var y=0;y<i.length;y++){var w=i[y];if(w.columnIndex<p)v.columnIndex=p;else{var b,C=!0;b=w.cellFormat.rowSpan,w.columnIndex>p?(v.columnIndex=p,C=!1):(g=w.getCellSizeInfo(r),u=this.getCellWidth(w.cellFormat.preferredWidth,w.cellFormat.preferredWidthType,e,w),this.tableHolder.columns.length>0?(this.tableHolder.addColumns(p,p=this.tableHolder.columns.indexOf(w.ownerColumn)+w.cellFormat.columnSpan,u,g,m+=u,v.cellFormat.preferredWidthType),v.columnIndex=p):(this.tableHolder.addColumns(p,p=w.columnIndex+w.cellFormat.columnSpan,u,g,m+=u,v.cellFormat.preferredWidthType),v.columnIndex=p)),C||f!==h.childWidgets.length-1||(C=!0),C&&d-w.ownerRow.rowIndex==b-1&&(i.splice(y,1),y--)}}if(v.cellFormat.rowSpan>1)if(0===i.length||i[i.length-1].columnIndex<=p)i.push(v);else{for(var x=0,I=i.length;I>0;I--)i[I-1].columnIndex>p&&(x=I-1);i.splice(x,0,v)}g=v.getCellSizeInfo(r),u=this.getCellWidth(v.cellFormat.preferredWidth,v.cellFormat.preferredWidthType,e,v),this.tableHolder.addColumns(p,p+=v.cellFormat.columnSpan,u,g,m+=u,v.cellFormat.preferredWidthType),f===h.childWidgets.length-1&&c.gridAfterWidth>0&&(u=this.getCellWidth(c.gridAfterWidth,"Point",e,null),g.minimumWordWidth=g.maximumWordWidth=g.minimumWidth=u,this.tableHolder.addColumns(p,p+=c.gridAfter,u,g,m+=u,"Point"))}}!(0,a.isNullOrUndefined)(this.bodyWidget.page)&&this.bodyWidget.page.documentHelper&&this.bodyWidget.page.documentHelper.layout&&this.bodyWidget.page.documentHelper.layout.isAllColumnHasAutoWidthType&&(this.bodyWidget.page.documentHelper.layout.isAllColumnHasAutoWidthType=!1),o&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0),this.tableHolder.validateColumnWidths(),r?this.tableHolder.autoFitColumn(t,e,n,this.isInsideTable,r,l,this.leftIndent+this.rightIndent,s,this.tableFormat.preferredWidthType):this.tableHolder.fitColumns(t,e,n,r,this.leftIndent+this.rightIndent),this.setWidthToCells(e,n)}},t.prototype.setWidthToCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i],r=n.rowFormat;r.gridBefore>0&&(r.beforeWidth=this.tableHolder.getCellWidth(0,r.gridBefore,e));for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s.cellFormat.cellWidth=this.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,e)}r.gridAfter>0&&(r.afterWidth=this.tableHolder.getCellWidth(0,r.gridAfter,e))}},t.prototype.updateProperties=function(e,t,i){if(e&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==i),this===t)if("FixedColumnWidth"===i){this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var n=0;n<this.childWidgets.length;n++)for(var r=this.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.cellFormat.preferredWidthType="Point",s.cellFormat.preferredWidth=s.cellFormat.cellWidth}}else if("FitToWindow"===i){var a=this.tableHolder.getTotalWidth(0);this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent";for(n=0;n<this.childWidgets.length;n++)for(var l=this.childWidgets[n],d=0;d<l.childWidgets.length;d++){"Percent"!==(h=l.childWidgets[d]).cellFormat.preferredWidthType&&(h.cellFormat.preferredWidthType="Percent",h.cellFormat.preferredWidth=h.cellFormat.cellWidth/a*100)}}else{this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(n=0;n<this.childWidgets.length;n++){(l=this.childWidgets[n]).rowFormat.beforeWidth=0,l.rowFormat.gridBefore=0,l.rowFormat.gridBeforeWidth=0,l.rowFormat.gridBeforeWidthType="Auto",l.rowFormat.afterWidth=0,l.rowFormat.gridAfter=0,l.rowFormat.gridAfterWidth=0,l.rowFormat.gridAfterWidthType="Auto";for(o=0;o<l.childWidgets.length;o++){var h;(h=l.childWidgets[o]).cellFormat.preferredWidth=0,h.cellFormat.preferredWidthType="Auto"}}}else t.updateProperties(!1,t,i)},t.prototype.getMaxRowWidth=function(e){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var n=this.childWidgets[i],r=0,o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];r+=this.getCellWidth(s.cellFormat.preferredWidth,s.cellFormat.preferredWidthType,e,s)}t<r&&(t=r)}return t},t.prototype.updateWidth=function(e){var t=this.tableHolder.getTotalWidth(0),i=this.getOwnerWidth(!0),n=this.getTableClientWidth(i);if(n<=t&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType)if("Point"===this.tableFormat.preferredWidthType)this.tableFormat.preferredWidth=this.getMaxRowWidth(n);else{var r=t/i*100;this.tableFormat.preferredWidth=r}},t.prototype.convertPointToPercent=function(e,t){var i=0;return i=e/t*100,(i=Math.round(i))<100?i:100},t.prototype.updateChildWidgetLeft=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.x=e,i.updateChildWidgetLeft(e)}},t.prototype.shiftWidgetsForRtlTable=function(e,t){var i=t.x,n=e.right,r=0;t.tableFormat&&t.tableFormat.cellSpacing>0&&(r=t.tableFormat.cellSpacing);for(var o=0;o<t.childWidgets.length;o++)for(var s=t.childWidgets[o],a=n-(s.x-i),l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];a-=d.width+d.margin.left+d.margin.right-d.rightBorderWidth+r,d.updateWidgetLeft(a+d.margin.left)}},t.prototype.clone=function(){var e=new t;e.tableHolder=this.tableHolder.clone(),e.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(e.wrapTextAround=this.wrapTextAround,e.positioning=this.positioning.clone());for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.containerWidget=e,n.index=i}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.isBidiTable=this.isBidiTable,e.containerWidget=this.containerWidget,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.getTableOf=function(e){if(e instanceof va){var i=Ul.getRowOf(e);return(0,a.isNullOrUndefined)(i)?e.ownerBase instanceof Ra&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:i.ownerTable}},t.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth();Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e);for(var i=0;i<this.childWidgets.length;i++)for(var n=this.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof t&&o.childWidgets[s].fitChildToClientArea()},t.prototype.getColumnCellsForSelection=function(e,t){for(var i=[],n=e.columnIndex,r=t.columnIndex+t.cellFormat.columnSpan,o=0;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a],d=l.columnIndex,h=l.cellFormat.columnSpan;d+h>n&&d+h<r||d>n&&d<r||d>n&&d<r&&d+h<r||d<n&&d+h>r?i.indexOf(l)<0&&i.push(l):d!==n&&d+h!==r||i.indexOf(l)<0&&i.push(l)}return i},t.prototype.splitWidthToTableCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].splitWidthToRowCells(e,t)},t.prototype.insertTableRowsInternal=function(e,t,i,n){for(var r=e.length-1;r>=0;r--){var o=e.splice(r,1)[0];if(o.containerWidget=this,n)for(var s=0;s<o.childWidgets.length;s++){o.childWidgets[s].cellFormat.initializeCellBorders()}this.childWidgets.splice(t,0,o)}this.updateRowIndex(t),this.isGridUpdated=!1,i&&(this.calculateGrid(!0),this.buildTableColumns()),this.isGridUpdated=!0},t.prototype.updateRowIndex=function(e){for(var t=e;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.index=t;for(var n=0;n<i.childWidgets.length;n++)i.childWidgets[n].index=n,i.childWidgets[n].rowIndex=i.rowIndex;e++}},t.prototype.getCellStartOffset=function(e){var t=0;if(e&&this.tableCellInfo&&this.tableCellInfo.containsKey(e.ownerRow.rowIndex)){var i=this.tableCellInfo.get(e.ownerRow.rowIndex);i.containsKey(e.cellIndex)&&(t=i.get(e.cellIndex))}return t},t.prototype.destroyInternal=function(e){var t=this.height;if(!(0,a.isNullOrUndefined)(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var n=void 0;if(n=this.childWidgets[i],(0,a.isNullOrUndefined)(n)||n.destroyInternal(e),(0,a.isNullOrUndefined)(this.childWidgets))break;i--}this.childWidgets=void 0}(0,a.isNullOrUndefined)(this.containerWidget)||(this.containerWidget instanceof Ol&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),(0,a.isNullOrUndefined)(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t),this.containerWidget=void 0),this.destroy()},t.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.tableFormat&&this.tableFormat.destroy(),this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder&&this.tableHolder.destroy(),this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,e.prototype.componentDestroy.call(this)},t}(Ll),Ul=function(e){function t(){var t=e.call(this)||this;return t.isRenderBookmarkEnd=!1,t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new Ca(t),t.editRangeID=new l,t}return Sl(t,e),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof Al)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextRow",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[e+1]},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.rowFormat===this.rowFormat},t.prototype.combineCells=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.combineWidget(e),(0,a.isNullOrUndefined)(i.cellFormat)||1!==i.cellFormat.rowSpan)(0,a.isNullOrUndefined)(i.cellFormat)&&t--;else{i.height,i.margin.top,i.margin.bottom;this.height-this.ownerTable.tableFormat.cellSpacing<i.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+i.height)}}},t.getRowOf=function(e){if(e instanceof va){var i=Vl.getCellOf(e);return(0,a.isNullOrUndefined)(i)?e.ownerBase instanceof Ca&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:i.ownerRow}},t.prototype.getCell=function(e,t,i){for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];if(r.rowIndex===e&&((0,a.isNullOrUndefined)(i)?r.columnIndex===t:r.cellIndex===i))return r}},t.prototype.getCellUsingColumnIndex=function(e,t){for(var i,n=0;n<this.childWidgets.length;n++)if((i=this.childWidgets[n]).rowIndex===e&&i.columnIndex===t)return i;if(i=this.getCell(e,t),!(0,a.isNullOrUndefined)(i))return i},t.prototype.splitWidthToRowCells=function(e,t){for(var i=this.childWidgets,n=e/i.length,r=0;r<i.length;r++)if(t&&0===i[r].cellFormat.preferredWidth)i[r].cellFormat.preferredWidth=n,this.ownerTable.isDefaultFormatUpdated=!1;else{if(t){this.ownerTable.isDefaultFormatUpdated=!0;break}i[r].cellFormat.preferredWidth=n}},t.prototype.getGridCount=function(e,t,i,n,r){var o=0,s=0,l=this.ownerTable,d=this.rowFormat;-1===i?s=l.getCellWidth(d.gridBeforeWidth,d.gridBeforeWidthType,n,null):(o+=l.getCellWidth(d.gridBeforeWidth,d.gridBeforeWidthType,n,null),i>=0&&(o+=l.getCellStartOffset(t)),s=i<this.childWidgets.length?l.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,n,null):l.getCellWidth(d.gridAfterWidth,d.gridAfterWidthType,n,null));var h=r[e.indexOf(o)],c=this.getOffsetIndex(e,o),p=parseFloat((s+o).toFixed(2));return(parseFloat((s+h).toFixed(2))===p||(0,a.isNullOrUndefined)(h)?this.getOffsetIndex(e,o+s):this.getOffsetIndex(e,h+s))-c},t.prototype.getOffsetIndex=function(e,t){t=parseFloat(t.toFixed(2));var i=0;if(e.indexOf(t)>=0)i=e.indexOf(t);else{for(var n=0;n<e.length;n++)if(e[n]>t)return n;i=e.length-1}return i},t.prototype.getCellOffset=function(e,t){for(var i=0,n=this.ownerTable,r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r].cellFormat;if(r===e)break;i+=n.getCellWidth(o.preferredWidth,o.preferredWidthType,t,null)}return i},t.prototype.updateRowBySpannedCells=function(){for(var e=this.getPreviousRowSpannedCells(),t=this.rowIndex,i=0;i<e.length;i++){var n=e[i];n.ownerRow.rowIndex+n.cellFormat.rowSpan-1>=t&&(n.cellFormat.rowSpan-=1)}},t.prototype.getPreviousRowSpannedCells=function(e){for(var t=[],i=e?this:this.previousWidget;!(0,a.isNullOrUndefined)(i);){for(var n=0;n<i.childWidgets.length;n++){var r=i.childWidgets[n];r.cellFormat.rowSpan>1&&t.splice(0,0,r)}i=i.previousWidget}return t},t.prototype.isCellsHaveSameWidthUnit=function(){if(this.childWidgets.length>0)for(var e=this.childWidgets[0].cellFormat.preferredWidthType,t=1;t<this.childWidgets.length;t++){if(e!=this.childWidgets[t].cellFormat.preferredWidthType)return!1}return!0},t.prototype.updateUniformWidthUnitForCells=function(){var e=!1;this.ownerTable&&this.ownerTable.tableHolder&&this.ownerTable.tableHolder.columns&&this.childWidgets.length!==this.ownerTable.tableHolder.columns.length&&(e=!0);for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.cellFormat.preferredWidthType="Point",i.cellFormat.preferredWidth=e?i.getMinimumPreferredWidth():i.cellFormat.cellWidth}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=Math.round(this.childWidgets[t].x);if(i-this.childWidgets[t].margin.left-1<=e.x&&i+this.childWidgets[t].width>=e.x)return this.childWidgets[t];if(t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=e.x)return this.childWidgets[t]}var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].x<=e.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),n},t.prototype.getFirstRowWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)e+=this.childWidgets[t].getCellWidth(this.ownerTable);return e},t.prototype.getCellWidget=function(e,t){var i=this.ownerTable.tableHolder.getValidColumnIndex(e);i>e&&(t-=i-e,e=i);var n=0;this.rowFormat.gridBefore>0&&(n+=this.rowFormat.gridBefore);for(var r=0;r<this.childWidgets.length;r++){var o=this.childWidgets[r],s=o.cellFormat.columnSpan;if(n<o.columnIndex&&(n<=e||n<e+t)&&o.columnIndex>e)return null;if((o.columnIndex<=e||o.columnIndex<e+t)&&o.columnIndex+s>e)return o;if(o.columnIndex>e)break;n+=s}return null},t.prototype.getVerticalMergeStartCell=function(e,t){var i=this.ownerTable.tableHolder.columns;if(this.rowFormat.gridBefore>0&&this.rowFormat.gridBefore>e+t)return null;var n,r=this.getCellWidget(e,t);if(!(0,a.isNullOrUndefined)(r))return r;if(e+this.rowFormat.gridAfter===i.length)return null;var o=this.previousWidget;return(0,a.isNullOrUndefined)(o)||(n=o.getVerticalMergeStartCell(e,t)),!(0,a.isNullOrUndefined)(n)&&n.cellFormat.rowSpan>1&&this.index===n.rowIndex+n.cellFormat.rowSpan-1?n:null},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){var t=this.height;if(!(0,a.isNullOrUndefined)(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroyInternal(e),(0,a.isNullOrUndefined)(this.childWidgets))break;i--}this.childWidgets=void 0}(0,a.isNullOrUndefined)(this.containerWidget)||(0,a.isNullOrUndefined)(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),((0,a.isNullOrUndefined)(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof Al?this.containerWidget.destroyInternal(e):this.containerWidget.containerWidget instanceof Ol&&(this.containerWidget.containerWidget.height-=t),this.containerWidget.height-=t),this.destroy()},t.prototype.clone=function(){var e=new t;e.rowFormat.copyFormat(this.rowFormat),e.topBorderWidth=this.topBorderWidth,e.bottomBorderWidth=this.bottomBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd;for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.containerWidget=e,n.index=i,n.rowIndex=this.rowIndex}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.updateChildWidgetLeft=function(e,t){var i=0;this.ownerTable.tableFormat.cellSpacing>0&&(i=this.ownerTable.tableFormat.cellSpacing);for(var n=0;n<this.childWidgets.length;n++){var r=this.childWidgets[n];e+=i+r.margin.left,r.x=e,r.updateChildWidgetLeft(r.x),e+=r.width+r.margin.right}},t.prototype.shiftWidgetForRtlTable=function(){var e=this.ownerTable,t=e.x,i=0;null!=e.tableFormat&&e.tableFormat.cellSpacing>0&&(i=e.tableFormat.cellSpacing);for(var n=t+Pa.convertPointToPixel(e.getTableWidth())-(this.x-t),r=0,o=0;o<this.childWidgets.length;o++){var s=this.childWidgets[o],l=0;(0,a.isNullOrUndefined)(s.previousWidget)||(l=s.previousWidget.columnIndex+s.previousWidget.cellFormat.columnSpan),l<s.columnIndex&&(r=Pa.convertPointToPixel(s.ownerTable.tableHolder.getPreviousSpannedCellWidth(l,s.columnIndex)),0===l&&(r-=i/2)),n-=s.width+s.margin.left+s.margin.right+i,s.updateWidgetLeft(n+s.margin.left-r)}},t.prototype.destroy=function(){this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.rowFormat&&this.rowFormat.destroy(),this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,this.isRenderBookmarkEnd=void 0,e.prototype.componentDestroy.call(this)},t}(Ll),Vl=function(e){function t(){var t=e.call(this)||this;return t.rowIndex=-1,t.sizeInfoInternal=new Ad,t.updatedTopBorders=[],t.isRenderBookmarkStart=!1,t.isRenderBookmarkEnd=!1,t.isRenderEditRangeStart=!1,t.isRenderEditRangeEnd=!1,t.isSplittedCell=!1,t.margin=new El(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new Ma(t),t}return Sl(t,e),Object.defineProperty(t.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("leftMargin")?this.cellFormat.leftMargin:!(0,a.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:(0,a.isNullOrUndefined)(this.ownerTable)||(0,a.isNullOrUndefined)(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("leftMargin")?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("topMargin")?this.cellFormat.topMargin:!(0,a.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:(0,a.isNullOrUndefined)(this.ownerTable)||(0,a.isNullOrUndefined)(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("topMargin")?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("rightMargin")?this.cellFormat.rightMargin:!(0,a.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:(0,a.isNullOrUndefined)(this.ownerTable)||(0,a.isNullOrUndefined)(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("rightMargin")?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.hasValue("bottomMargin")?this.cellFormat.bottomMargin:!(0,a.isNullOrUndefined)(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:(0,a.isNullOrUndefined)(this.ownerTable)||(0,a.isNullOrUndefined)(this.ownerTable.tableFormat)||!this.ownerTable.tableFormat.hasValue("bottomMargin")?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof Ul)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.cellFormat===this.cellFormat},t.prototype.getContainerTable=function(){for(var e=this.ownerTable;e instanceof Al&&e.associatedCell instanceof t;)e=e.associatedCell.getContainerTable();return e},t.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof Ul){var e=this.containerWidget;do{if(e=e.previousRenderedWidget,(0,a.isNullOrUndefined)(e)||e.index<this.rowIndex)break;var t=e.getCell(this.rowIndex,this.columnIndex);if(t&&this.equals(t))return t}while(e)}},t.prototype.getNextSplitWidget=function(){var e=this.cellFormat.rowSpan;if(this.containerWidget instanceof Ul){var t=this.containerWidget;do{if(t=t.nextRenderedWidget,(0,a.isNullOrUndefined)(t)||t.index>this.rowIndex+e)break;var i=t.getCell(this.rowIndex,this.columnIndex);if(i&&this.equals(i))return i}while(t)}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return this.childWidgets.length>0&&(i=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),i},t.prototype.updateWidth=function(e){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=e:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(e)),this.cellFormat.cellWidth=e},t.prototype.getCellWidth=function(e){var t=this.ownerTable,i=t?t.getTableClientWidth(t.getOwnerWidth(!0)):0,n=i,r=(0,a.isNullOrUndefined)(this.leftMargin)?0:this.leftMargin,o=(0,a.isNullOrUndefined)(this.rightMargin)?0:this.rightMargin;return t&&"Auto"===t.tableFormat.preferredWidthType&&t.tableFormat.allowAutoFit?n=0===this.cellFormat.preferredWidth?i:"Percent"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth*i/100-r-o:this.cellFormat.preferredWidth-r-o:"Percent"===this.cellFormat.preferredWidthType?n=this.cellFormat.preferredWidth*i/100-r-o:"Point"===this.cellFormat.preferredWidthType&&(n=e instanceof Al&&"Percent"===e.tableFormat.preferredWidthType?this.cellFormat.cellWidth-r-o:this.cellFormat.preferredWidth-r-o),n},t.prototype.convertPointToPercent=function(e){var t=0,i=this.ownerTable.getOwnerWidth(!0);return t=e/this.ownerTable.getTableClientWidth(i)*100,(t=Math.round(t))<100?t:100},t.getCellLeftBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=(0,a.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=(0,a.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if((0,a.isNullOrUndefined)(i.left)||(t=i.left),(0,a.isNullOrUndefined)(t)&&(t=e.getLeftBorderToRenderByHierarchy(t,n,r)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getLeftBorderToRenderByHierarchy(t,n,r);else{var o=this.getPreviousCell(e);t=e.getPreviousCellLeftBorder(t,o)}return(0,a.isNullOrUndefined)(t)&&(t=new fa(e.cellFormat.borders)),t},t.getPreviousCell=function(e){var t=void 0;if(!(0,a.isNullOrUndefined)(e.previousWidget)){var i=e.previousWidget;i.columnIndex+i.cellFormat.columnSpan===e.columnIndex&&(t=i)}return t},t.prototype.getLeftBorderWidth=function(){var e=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellLeftBorder(this).getLineWidth()),e},t.prototype.getRightBorderWidth=function(){var e=0;this.ownerTable;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellRightBorder(this).getLineWidth()),e},t.prototype.getCellSpacing=function(){var e=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*e:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?e+e/2:e},t.prototype.getCellSizeInfo=function(e){var t=!0,i=void 0;if((0,a.isNullOrUndefined)(this.bodyWidget)||(0,a.isNullOrUndefined)(this.bodyWidget.page)||(0,a.isNullOrUndefined)(this.bodyWidget.page.documentHelper)||(i=this.bodyWidget.page.documentHelper.layout),(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(i.currentCell)||(t=!1,this===i.currentCell&&(t=!0)),t&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),e&&t&&!this.sizeInfo.hasMinimumWordWidth){var n=this.getMinimumAndMaximumWordWidth(0,0);this.sizeInfo.minimumWordWidth=n.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=n.maximumWordWidth+this.sizeInfo.minimumWidth}var r=new Ad;return r.minimumWidth=this.sizeInfo.minimumWidth,r.minimumWordWidth=this.sizeInfo.minimumWordWidth,r.maximumWordWidth=this.sizeInfo.maximumWordWidth,r},t.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},t.prototype.getPreviousCellLeftBorder=function(e,t){if(((0,a.isNullOrUndefined)(t)||!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&((0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra||(e=this.getLeftBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders))),(0,a.isNullOrUndefined)(t))return e;var i=void 0;return(0,a.isNullOrUndefined)(t.cellFormat.borders)||(0,a.isNullOrUndefined)(t.cellFormat.borders.right)||"None"===t.cellFormat.borders.right.lineStyle||(i=t.cellFormat.borders.right),(0,a.isNullOrUndefined)(i)||"None"===i.lineStyle?(0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra?e:this.getLeftBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(i,e)},t.prototype.getBorderBasedOnPriority=function(e,t){if((0,a.isNullOrUndefined)(e))return t;if((0,a.isNullOrUndefined)(t))return e;var i=e.getBorderWeight(),n=t.getBorderWeight();if(i===n){var r=e.getPrecedence(),o=t.getPrecedence();if(r===o){var s=Pa.convertHexToRgb(e.color),l=s.r,d=s.g,h=s.b,c=Pa.convertHexToRgb(t.color),p=c.r,u=c.g,g=c.b,m=l+h+2*d,f=p+g+2*u;return m===f&&(m=h+2*d)===(f=g+2*u)?d===u?e:d>u?t:e:m>f?t:e}return r>o?e:t}return i>n?e:t},t.prototype.getLeftBorderToRenderByHierarchy=function(e,i,n){var r=t.getCellOf(e.ownerBase);if(!(0,a.isNullOrUndefined)(r)){var o=!1;(0===r.columnIndex||0===r.cellIndex&&r.ownerRow.rowFormat.gridBefore>0)&&(o=!0);var s=!1,l=!1;o&&!(0,a.isNullOrUndefined)(i.left)?l=i.left.hasNoneStyle:o||(0,a.isNullOrUndefined)(i.vertical)||(l=i.vertical.hasNoneStyle),(0,a.isNullOrUndefined)(i.left)||"None"===i.left.lineStyle||!i.left.isBorderDefined||l||(0,a.isNullOrUndefined)(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(s=!0),(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&(!e.isBorderDefined&&!l||s)||(0,a.isNullOrUndefined)(e))&&(o?(e=i.left,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.left)):(e=i.vertical,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.vertical)))}return e},t.getCellRightBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=(0,a.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=(0,a.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if((0,a.isNullOrUndefined)(i.right)||(t=i.right),(0,a.isNullOrUndefined)(t)&&(t=e.getRightBorderToRenderByHierarchy(t,n,r)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getRightBorderToRenderByHierarchy(t,n,r);else{var o=this.getNextCell(e);t=e.getAdjacentCellRightBorder(t,o)}return(0,a.isNullOrUndefined)(t)&&(t=new fa(e.cellFormat.borders)),t},t.getNextCell=function(e){var t=void 0,i=e.cellFormat.columnSpan;if(!(0,a.isNullOrUndefined)(e.nextWidget)){var n=e.nextWidget;e.columnIndex+i===n.columnIndex&&(t=n)}return t},t.prototype.getAdjacentCellRightBorder=function(e,t){if(((0,a.isNullOrUndefined)(t)||!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&((0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra||(e=this.getRightBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders))),(0,a.isNullOrUndefined)(t))return e;var i=void 0;return(0,a.isNullOrUndefined)(t.cellFormat.borders)||(0,a.isNullOrUndefined)(t.cellFormat.borders.left)||"None"===t.cellFormat.borders.left.lineStyle||(i=t.cellFormat.borders.left),(0,a.isNullOrUndefined)(i)||"None"===i.lineStyle?(0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra?e:this.getRightBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getRightBorderToRenderByHierarchy=function(e,i,n){var r=t.getCellOf(e.ownerBase);if(!(0,a.isNullOrUndefined)(r)){var o=!1;r.columnIndex+r.cellFormat.columnSpan!==r.ownerTable.tableHolder.columns.length&&r.cellIndex!==r.ownerRow.childWidgets.length-1||(o=!0);var s=!1,l=!1;o&&!(0,a.isNullOrUndefined)(i.right)?l=i.right.hasNoneStyle:o||(0,a.isNullOrUndefined)(i.vertical)||(l=i.vertical.hasNoneStyle),(0,a.isNullOrUndefined)(i.right)||"None"===i.right.lineStyle||!i.right.isBorderDefined||l||(0,a.isNullOrUndefined)(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(s=!0),(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&(!e.isBorderDefined&&!l||s)||(0,a.isNullOrUndefined)(e))&&(o?(e=i.right,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.right)):(e=i.vertical,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.vertical)))}return e},t.getCellTopBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=(0,a.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=(0,a.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if((0,a.isNullOrUndefined)(i.top)||(t=i.top),(0,a.isNullOrUndefined)(t)&&(t=e.getTopBorderToRenderByHierarchy(t,n,r)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getTopBorderToRenderByHierarchy(t,n,r);else{var o=e.getTopAdjacentCell();t=e.getPreviousCellTopBorder(t,o)}return(0,a.isNullOrUndefined)(t)&&(t=new fa(e.cellFormat.borders)),t},t.prototype.getTopAdjacentCell=function(){var e,t=this.ownerRow.previousWidget;return(0,a.isNullOrUndefined)(t)||(e=t.getVerticalMergeStartCell(this.columnIndex,this.cellFormat.columnSpan)),e},t.prototype.getPreviousCellTopBorder=function(e,t){if(((0,a.isNullOrUndefined)(t)||!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&((0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra||(e=this.getTopBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders))),(0,a.isNullOrUndefined)(t))return e;var i=void 0;return(0,a.isNullOrUndefined)(t.cellFormat.borders)||(0,a.isNullOrUndefined)(t.cellFormat.borders.bottom)||(i=this.getBottomBorderToRenderByHierarchy(t.cellFormat.borders.bottom,t.ownerRow.rowFormat.borders,t.ownerTable.tableFormat.borders)),(0,a.isNullOrUndefined)(i)||"None"===i.lineStyle?(0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra?e:this.getTopBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getTopBorderToRenderByHierarchy=function(e,i,n){var r=t.getCellOf(e.ownerBase);if(!(0,a.isNullOrUndefined)(r)){var o=(0,a.isNullOrUndefined)(r.ownerRow.previousWidget),s=!1,l=!1;o&&!(0,a.isNullOrUndefined)(i.top)?l=i.top.hasNoneStyle:o||(0,a.isNullOrUndefined)(i.horizontal)||(l=i.horizontal.hasNoneStyle),(0,a.isNullOrUndefined)(i.top)||"None"===i.top.lineStyle||!i.top.isBorderDefined||l||(0,a.isNullOrUndefined)(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(s=!0),(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&(!e.isBorderDefined&&!l||s)||(0,a.isNullOrUndefined)(e))&&(o?(e=i.top,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.top)):(e=i.horizontal,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.horizontal)))}return e},t.getCellBottomBorder=function(e){var t=void 0,i=e.cellFormat.borders,n=(0,a.isNullOrUndefined)(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,r=(0,a.isNullOrUndefined)(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if((0,a.isNullOrUndefined)(i.bottom)||(t=i.bottom),(0,a.isNullOrUndefined)(t)&&(t=e.getBottomBorderToRenderByHierarchy(t,n,r)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getBottomBorderToRenderByHierarchy(t,n,r);else{var o=void 0,s=void 0,l=e.cellFormat.rowSpan;if(1===l)s=e.ownerRow.nextWidget;else if(l>1){var d=e.containerWidget;do{if(d=d.nextWidget,(0,a.isNullOrUndefined)(d))break;if(d.index===e.rowIndex+l){s=d;break}}while(d)}(0,a.isNullOrUndefined)(s)||(o=s.getCellWidget(e.columnIndex,e.cellFormat.columnSpan)),t=e.getAdjacentCellBottomBorder(t,o)}return(0,a.isNullOrUndefined)(t)&&(t=new fa(e.cellFormat.borders)),t},t.prototype.getAdjacentCellBottomBorder=function(e,t){if(((0,a.isNullOrUndefined)(t)||!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&((0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra||(e=this.getBottomBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders))),(0,a.isNullOrUndefined)(t))return e;var i=void 0;return(0,a.isNullOrUndefined)(t.cellFormat.borders)||(0,a.isNullOrUndefined)(t.cellFormat.borders.top)||"None"===t.cellFormat.borders.top.lineStyle||(i=t.cellFormat.borders.top),(0,a.isNullOrUndefined)(i)||"None"===i.lineStyle?(0,a.isNullOrUndefined)(e)||e.ownerBase.ownerBase instanceof Ra?e:this.getBottomBorderToRenderByHierarchy(e,Ul.getRowOf(e.ownerBase).rowFormat.borders,Al.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getBottomBorderToRenderByHierarchy=function(e,i,n){var r=t.getCellOf(e.ownerBase);if(!(0,a.isNullOrUndefined)(r)){var o=(0,a.isNullOrUndefined)(r.ownerRow.nextWidget),s=!1,l=!1;o&&!(0,a.isNullOrUndefined)(i.bottom)?l=i.bottom.hasNoneStyle:o||(0,a.isNullOrUndefined)(i.horizontal)||(l=i.horizontal.hasNoneStyle),(0,a.isNullOrUndefined)(i.bottom)||"None"===i.bottom.lineStyle||!i.bottom.isBorderDefined||l||(0,a.isNullOrUndefined)(e)||"None"!==e.lineStyle||!e.isBorderDefined||e.hasValue("color")||(s=!0),(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle&&(!e.isBorderDefined&&!l||s)||(0,a.isNullOrUndefined)(e))&&(o?(e=i.bottom,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.bottom)):(e=i.horizontal,(!(0,a.isNullOrUndefined)(e)&&"None"===e.lineStyle||(0,a.isNullOrUndefined)(e))&&(e=n.horizontal)))}return e},t.getCellOf=function(e){if(e instanceof va)return e.ownerBase instanceof Ma&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0},t.prototype.updateWidgetLeft=function(e){this.x=e,this.updateChildWidgetLeft(e)},t.prototype.updateChildWidgetLeft=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.x=e,i instanceof Rl){var n=Pa.convertPointToPixel(i.leftIndent),r=Pa.convertPointToPixel(i.rightIndent);i.x=e+(i.bidi?r:n)}if(i instanceof Al){var o=i;if(o.updateChildWidgetLeft(e),o.isBidiTable){var s=new Tl(o.x,o.y,o.width,o.height);o.shiftWidgetsForRtlTable(s,o)}}}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].getMinimumAndMaximumWordWidth(e,t);e=n.minimumWordWidth,t=n.maximumWordWidth}return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){if(!(0,a.isNullOrUndefined)(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.destroyInternal(e),t--}this.childWidgets=void 0,(0,a.isNullOrUndefined)(e.documentHelper.selection)||e.documentHelper.selection.selectedWidgets.containsKey(this)&&e.documentHelper.selection.selectedWidgets.remove(this)}this.destroy()},t.prototype.clone=function(){var e=new t;e.cellFormat.copyFormat(this.cellFormat);for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.containerWidget=e,n.index=i}return e.leftBorderWidth=this.leftBorderWidth,e.rightBorderWidth=this.rightBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd,e.isRenderBookmarkStart=this.isRenderBookmarkStart,this.margin&&(e.margin=this.margin.clone()),e.columnIndex=this.columnIndex,e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isSplittedCell=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.cellFormat&&this.cellFormat.destroy(),this.cellFormat=void 0,this.contentControlProperties=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isRenderBookmarkStart=void 0,this.isRenderBookmarkEnd=void 0,e.prototype.componentDestroy.call(this)},t}(Ll),zl=function(){function e(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.marginTop=0,this.maxBaseLine=0,this.skipClipImage=!1,this.paragraph=e}return Object.defineProperty(e.prototype,"renderedElements",{get:function(){return(0,a.isNullOrUndefined)(this.layoutedElements)?this.children:this.layoutedElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLine",{get:function(){var t=this.paragraph,i=this.indexInOwner;if(i<=t.childWidgets.length-2)return t.childWidgets[i+1];if(t.nextSplitWidget){var n=t.nextSplitWidget.firstChild;if(n instanceof e&&n.paragraph.equals(this.paragraph))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousLine",{get:function(){var t=this.paragraph,i=this.indexInOwner,n=t.previousSplitWidget;if(i>0)return t.childWidgets[i-1];if(n instanceof Rl){var r=n.lastChild;if(r instanceof e&&r.paragraph.equals(this.paragraph))return r}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Zl)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithColumnBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Zl)return e.isColumnBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithLineBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Zl)return"\v"===e.text}return!1},enumerable:!0,configurable:!0}),e.prototype.isFirstLine=function(){var e=this.indexInOwner;return!!(e>-1&&(void 0===this.paragraph.previousSplitWidget||this.paragraph.previousSplitWidget instanceof Rl&&(this.paragraph.previousSplitWidget.isEndsWithColumnBreak||this.paragraph.previousSplitWidget.isEndsWithPageBreak)))&&0===e},e.prototype.isLastLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},e.prototype.getOffset=function(e,t){if((0,a.isNullOrUndefined)(e))return t;for(var i=t,n=e.line,r=0;r<n.children.length;r++){var o=n.children[r];if(e===o)break;o instanceof md||(i+=o.length)}return i},e.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var n=this.children[i];0!==n.length&&(n instanceof md||((n instanceof Zl||n instanceof Bd||n instanceof vd||n instanceof gd||n instanceof fd||n instanceof td||n instanceof id||n instanceof _l&&Pa.isLinkedFieldCharacter(n))&&(e=t+n.length),t+=n.length))}return e},e.prototype.getInline=function(e,t,i,n,r){i=(0,a.isNullOrUndefined)(i)?this.paragraph.bidi:i;var o=void 0,s=0,l=!1;if(0===this.children.length&&this.previousLine){var d=this.previousLine.children[this.previousLine.children.length-1];if(d instanceof Zl&&"\v"===d.text)return{element:o=this.previousLine.children[this.previousLine.children.length-1],index:t=1}}for(var h=0;h<this.children.length;h++)if(!((o=this.children[h])instanceof md)){if(!l&&(o instanceof Zl||o instanceof gd||o instanceof hd||o instanceof id||o instanceof td||o instanceof fd||o instanceof vd||o instanceof Bd||o instanceof _l&&Pa.isLinkedFieldCharacter(o))&&(l=!0),l&&e<=s+o.length){if(o instanceof Zl&&" "===o.text&&0===o.revisions.length&&n&&!r){var c=this.getNextTextElement(this,h+1);return{element:o=(0,a.isNullOrUndefined)(c)?o:c,index:t=(0,a.isNullOrUndefined)(c)?e-s:0}}return e===s+o.length&&this.children[h+1]instanceof Yl?{element:this.children[h+1],index:t}:{element:o,index:t=e-s}}s+=o.length}return e>s&&(t=(0,a.isNullOrUndefined)(o)?e:o.length),{element:o,index:t}},e.prototype.isEndnoteLineWidget=function(){return!(0,a.isNullOrUndefined)(this.paragraph.containerWidget)&&this.paragraph.containerWidget.containerWidget instanceof Dl&&"Endnote"===this.paragraph.containerWidget.containerWidget.footNoteType},e.prototype.getNextTextElement=function(e,t){return t<e.children.length-1&&e.children[t]?e.children[t]:null},e.prototype.getHierarchicalIndex=function(e){var t=this;return e=t.paragraph.childWidgets.indexOf(t)+";"+e,t.paragraph instanceof Ll?t.paragraph.getHierarchicalIndex(e):e},e.prototype.clone=function(){for(var t=new e(void 0),i=0;i<this.children.length;i++){var n=this.children[i].clone();t.children.push(n),n.line=t}return t.width=this.width,t.height=this.height,(0,a.isNullOrUndefined)(this.margin)||(t.margin=this.margin.clone()),t},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0},e.prototype.componentDestroy=function(){if(!(0,a.isNullOrUndefined)(this.children)){for(var e=0;e<this.children.length;e++){this.children[e].componentDestroy()}this.children=[]}this.children=void 0,this.paragraph=void 0,this.layoutedElements=[],this.layoutedElements=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e}(),ql=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0,this.isWidthUpdated=!1,this.margin=new El(0,0,0,0),this.padding=new El(0,0,0,0),this.characterFormat=void 0,this.isRightToLeft=!1,this.canTrigger=!1,this.ischangeDetected=!1,this.isVisible=!1,this.isSpellChecked=!1,this.isSpellCheckTriggered=!1,this.revisions=[],this.canTrack=!1,this.removedIds=[],this.isMarkedForRevision=!1,this.skipformFieldLength=!1,this.characterRange=void 0,this.characterFormat=new ka(this),this.margin=new El(0,0,0,0)}return Object.defineProperty(e.prototype,"isPageBreak",{get:function(){return this instanceof Zl&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isColumnBreak",{get:function(){return this instanceof Zl&&this.text===String.fromCharCode(14)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValidNodeForTracking",{get:function(){return!(this instanceof td||this instanceof Bd||this instanceof vd||this instanceof fd||this instanceof id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCheckBoxElement",{get:function(){var e=this;return e instanceof Zl&&!(0,a.isNullOrUndefined)(e.text)&&(e.text===String.fromCharCode(9745)||e.text===String.fromCharCode(9744))},enumerable:!0,configurable:!0}),e.prototype.linkFieldCharacter=function(e){if(this instanceof _l)if(0===this.fieldType){var t=this;(0,a.isNullOrUndefined)(t.fieldEnd)&&(this.linkFieldTraversingForward(this.line,t,t),-1===e.fields.indexOf(t)&&e.fields.push(t),(0,a.isNullOrUndefined)(t.formFieldData)||-1!==e.formFields.indexOf(t)||e.layout.isInsertFormField||e.formFields.push(t))}else if(2===this.fieldType){var i=this;if((0,a.isNullOrUndefined)(i.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,i,i),!(0,a.isNullOrUndefined)(i.fieldBegin)){if(i.fieldBegin.fieldSeparator=i,(0,a.isNullOrUndefined)(i.fieldEnd))this.linkFieldTraversingForward(this.line,i.fieldBegin,i)&&(i.fieldEnd=i.fieldBegin.fieldEnd);i.fieldEnd&&(i.fieldEnd.fieldSeparator=i)}}else{var n=this;(0,a.isNullOrUndefined)(n.fieldBegin)&&this.linkFieldTraversingBackward(this.line,n,n)}},e.prototype.linkFieldTraversingBackward=function(e,t,i){var n=e.children.length-1;e.children.indexOf(i)>-1&&(n=e.children.indexOf(i)-1);for(var r=n;r>=0;r--){var o=e.children[r];if(o instanceof _l)if(0===o.fieldType){if((0,a.isNullOrUndefined)(o.fieldEnd))return t.fieldBegin=o,(0,a.isNullOrUndefined)(o.fieldEnd)&&(o.fieldEnd=t),t.fieldSeparator&&(0,a.isNullOrUndefined)(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=o,(0,a.isNullOrUndefined)(o.fieldSeparator)&&(o.fieldSeparator=t.fieldSeparator)),!(0,a.isNullOrUndefined)(t.fieldBegin)}else 2===o.fieldType&&(0,a.isNullOrUndefined)(o.fieldEnd)&&(t.fieldSeparator=o,o.fieldEnd=t,(0,a.isNullOrUndefined)(o.fieldBegin)||(t.fieldBegin=o.fieldBegin))}if(e.previousLine)this.linkFieldTraversingBackward(e.previousLine,t,this);else if(e.paragraph.previousRenderedWidget instanceof Rl&&e.paragraph.previousRenderedWidget.childWidgets.length>0){var s=e.paragraph.previousRenderedWidget;this.linkFieldTraversingBackward(s.childWidgets[s.childWidgets.length-1],t,this)}return!0},e.prototype.linkFieldTraversingForward=function(e,t,i,n){var r=0;(0,a.isNullOrUndefined)(n)&&(n=0),e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)+1);for(var o=r;o<e.children.length;o++){var s=e.children[o];if(s instanceof _l){if(0===s.fieldType&&n++,1===s.fieldType){if(0!==n){n--;continue}return(0,a.isNullOrUndefined)(s.fieldBegin)&&(t.fieldEnd=s),t.fieldEnd&&(0,a.isNullOrUndefined)(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0}if((0,a.isNullOrUndefined)(t.fieldSeparator)){if(2!==s.fieldType||!(0,a.isNullOrUndefined)(s.fieldBegin))return!1;if(t.fieldSeparator=s,t.fieldSeparator&&(0,a.isNullOrUndefined)(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!(0,a.isNullOrUndefined)(s.fieldEnd))return t.fieldEnd=s.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}}if(e.nextLine)this.linkFieldTraversingForward(e.nextLine,t,this,n);else if(e.paragraph.nextRenderedWidget instanceof Rl&&e.paragraph.nextRenderedWidget.childWidgets.length>0)this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],t,this,n);else if(e.paragraph.nextRenderedWidget instanceof Al){var l=e.paragraph.nextRenderedWidget;l=l.getSplitWidgets().pop(),!(0,a.isNullOrUndefined)(l.nextRenderedWidget)&&l.nextRenderedWidget instanceof Rl&&l.nextRenderedWidget.childWidgets.length>0&&this.linkFieldTraversingForward(l.nextRenderedWidget.childWidgets[0],t,this,n)}return!0},e.prototype.linkFieldTraversingBackwardSeparator=function(e,t,i){var n=e.children.length-1;e.children.indexOf(i)>-1&&(n=e.children.indexOf(i)-1);for(var r=n;r>=0;r--){var o=e.children[r];if(o instanceof _l&&o instanceof _l&&0===o.fieldType)return(0,a.isNullOrUndefined)(o.fieldSeparator)&&(t.fieldBegin=o),!(0,a.isNullOrUndefined)(t.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,t,this);else{if(!(e.paragraph.previousRenderedWidget instanceof Rl&&e.paragraph.previousRenderedWidget.childWidgets.length>0))return!0;e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],this.linkFieldTraversingBackwardSeparator(e,t,this)}return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.line instanceof zl&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(e>0&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextValidNodeForTracking",{get:function(){for(var e=this;!(0,a.isNullOrUndefined)(e)&&(e instanceof td||e instanceof Bd||e instanceof vd||e instanceof fd||e instanceof id);)e=e.nextNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousValidNodeForTracking",{get:function(){for(var e=this;!(0,a.isNullOrUndefined)(e)&&(e instanceof td||e instanceof Bd||e instanceof vd||e instanceof fd||e instanceof id);)e=e.previousNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);if(e>0)return this.line.children[e-1];if(t>0){var i=this.line.paragraph.childWidgets[t-1];return i.children[i.children.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var e=this.line.children.indexOf(this);this.line.children.splice(e,1)}this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.prototype.componentDestroy=function(){this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.padding&&this.padding.destroy(),this.padding=void 0,this.contentControlProperties=void 0,this.line=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.objectCharacter=String.fromCharCode(65532),e}(),_l=function(e){function t(t){var i=e.call(this)||this;return i.fieldType=0,i.fieldCodeType="",i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return Sl(t,e),Object.defineProperty(t.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(e){this.fieldBeginInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(e){this.fieldSeparatorInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(e){this.fieldEndInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resultText",{get:function(){if(!(0,a.isNullOrUndefined)(this.formFieldData)&&0===this.fieldType&&!(0,a.isNullOrUndefined)(this.fieldSeparator)&&!(0,a.isNullOrUndefined)(this.fieldEnd)){var e=this.fieldSeparator.nextElement,t="";do{if(e instanceof Zl&&(t+=e.text),(e=e.nextNode)===this.fieldEnd)break}while(e);return t}},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.fieldType);if(0!==this.fieldType||(0,a.isNullOrUndefined)(this.formFieldData)||(e.formFieldData=this.formFieldData.clone()),e.characterFormat.copyFormat(this.characterFormat),this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?(e.removedIds=xa.cloneRevisions(this.revisions),this.fieldEnd&&(e.hasFieldEnd=this.hasFieldEnd)):(e.removedIds=this.removedIds.slice(),(0,a.isNullOrUndefined)(this.fieldEnd)||(0,a.isNullOrUndefined)(this.fieldEnd.paragraph)||this.fieldEnd.paragraph.containerWidget instanceof Vl||(e.hasFieldEnd=this.hasFieldEnd));return e.fieldCodeType=this.fieldCodeType,e},t.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.formFieldData&&this.formFieldData.destroy(),this.formFieldData=void 0,this.fieldCodeType=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.componentDestroy.call(this)},t}(ql),jl=function(){function e(){this.name="",this.enabled=!0,this.helpText="",this.statusText=""}return e.prototype.destroy=function(){this.name=void 0,this.helpText=void 0,this.statusText=void 0},e}(),Gl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="Text",t.maxLength=0,t.defaultValue="",t.format="",t}return Sl(t,e),t.prototype.clone=function(){var e=new t;return e.type=this.type,e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.maxLength=this.maxLength,e.defaultValue=this.defaultValue,e.format=this.format,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type,name:this.name}},t.prototype.copyFieldInfo=function(e){(0,a.isNullOrUndefined)(e.defaultValue)||(this.defaultValue=e.defaultValue),(0,a.isNullOrUndefined)(e.enabled)||(this.enabled=e.enabled),(0,a.isNullOrUndefined)(e.format)||(this.format=e.format),(0,a.isNullOrUndefined)(e.helpText)||(this.helpText=e.helpText),(0,a.isNullOrUndefined)(e.maxLength)||(this.maxLength=e.maxLength),(0,a.isNullOrUndefined)(e.type)||(this.type=e.type)},t.prototype.destroy=function(){this.format=void 0,this.defaultValue=void 0,e.prototype.destroy.call(this)},t}(jl),Kl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sizeType="Auto",t.size=11,t.defaultValue=!1,t.checked=!1,t}return Sl(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.sizeType=this.sizeType,e.size=this.size,e.defaultValue=this.defaultValue,e.checked=this.checked,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType,name:this.name}},t.prototype.copyFieldInfo=function(e){(0,a.isNullOrUndefined)(e.defaultValue)||(this.defaultValue=e.defaultValue,this.checked=e.defaultValue),(0,a.isNullOrUndefined)(e.enabled)||(this.enabled=e.enabled),(0,a.isNullOrUndefined)(e.size)||(this.size=e.size),(0,a.isNullOrUndefined)(e.helpText)||(this.helpText=e.helpText),(0,a.isNullOrUndefined)(e.sizeType)||(this.sizeType=e.sizeType)},t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(jl),Xl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropdownItems=[],t.selectedIndex=0,t}return Sl(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.dropdownItems=this.dropdownItems.slice(),e.selectedIndex=this.selectedIndex,e},t.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText,name:this.name}},t.prototype.copyFieldInfo=function(e){(0,a.isNullOrUndefined)(e.dropdownItems)||(this.dropdownItems=e.dropdownItems),(0,a.isNullOrUndefined)(e.enabled)||(this.enabled=e.enabled),(0,a.isNullOrUndefined)(e.helpText)||(this.helpText=e.helpText)},t.prototype.destroy=function(){this.dropdownItems=[],this.dropdownItems=void 0,e.prototype.destroy.call(this)},t}(jl),Zl=function(e){function i(){var i=e.call(this)||this;return i.baselineOffset=0,i.text="",i.trimEndWidth=0,i.ignoreOnceItems=[],i.istextCombined=!1,i.scriptType=t.English,i.renderedFontFamily=void 0,i.errorCollection=[],i}return Sl(i,e),i.prototype.getLength=function(){return this.text?this.text.length:0},i.prototype.clone=function(){var e=new i;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var t=0;t<this.revisions.length;t++){var n=this.revisions[t];e.revisions.push(n.clone())}}else this.paragraph&&this.paragraph.isInsideTable&&this.paragraph.containerWidget instanceof Vl&&this.paragraph.containerWidget.ownerRow.rowFormat.isHeader?e.revisions=this.revisions:this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},i.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},i.prototype.componentDestroy=function(){this.text=void 0,e.prototype.componentDestroy.call(this)},i}(ql),Jl=function(){function e(){this.separator=[],this.continuationNotice=[],this.continuationSeparator=[]}return e.prototype.clear=function(){if(this.separator){for(var e=0;e<this.separator.length;e++){this.separator[e].destroy()}this.separator=[]}if(this.continuationSeparator){for(e=0;e<this.continuationSeparator.length;e++){this.continuationSeparator[e].destroy()}this.continuationSeparator=[]}if(this.continuationNotice){for(e=0;e<this.continuationNotice.length;e++){this.continuationNotice[e].destroy()}this.continuationNotice=[]}},e.prototype.destroy=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},e.prototype.componentDestroy=function(){if(this.separator){for(var e=0;e<this.separator.length;e++){this.separator[e].componentDestroy()}this.separator=[]}if(this.separator=void 0,this.continuationSeparator){for(e=0;e<this.continuationSeparator.length;e++){this.continuationSeparator[e].componentDestroy()}this.continuationSeparator=[]}if(this.continuationSeparator=void 0,this.continuationNotice){for(e=0;e<this.continuationNotice.length;e++){this.continuationNotice[e].componentDestroy()}this.continuationNotice=[]}this.continuationNotice=void 0},e}(),Yl=function(e){function t(){var t=e.call(this)||this;return t.isLayout=!1,t.bodyWidget=new Ol,t.bodyWidget.footNoteReference=t,t}return Sl(t,e),t.prototype.clone=function(){var e=new t;e.text=this.text,e.characterFormat.copyFormat(this.characterFormat),e.height=this.height,e.footnoteType=this.footnoteType,e.width=this.width,e.symbolCode=this.symbolCode;for(var i=0;i<this.bodyWidget.childWidgets.length;i++){var n=this.bodyWidget.childWidgets[i];(n instanceof Rl||n instanceof Al)&&(n=this.bodyWidget.childWidgets[i].clone()),e.bodyWidget.childWidgets.push(n)}if(e.bodyWidget.page=this.bodyWidget.page,!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return this.margin&&(e.margin=this.margin.clone()),e},t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.symbolCode="",this.symbolFontName="",this.customMarker=""},t.prototype.componentDestroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.symbolCode="",this.symbolFontName="",this.customMarker="",this.bodyWidget&&this.bodyWidget.componentDestroy(),this.bodyWidget=void 0,e.prototype.componentDestroy.call(this)},t}(Zl),Ql=function(e){function t(){var t=e.call(this)||this;return t.startIn=void 0,t.endIn=void 0,t}return Sl(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.start=void 0,this.end=void 0},t.prototype.componentDestroy=function(){this.startIn&&this.startIn.destroy(),this.startIn=void 0,this.endIn&&this.endIn.destroy(),this.endIn=void 0,e.prototype.componentDestroy.call(this)},t}(Zl),$l=function(e){function t(){var t=e.call(this)||this;return t.fieldText="",t}return Sl(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.fieldText},set:function(e){this.fieldText=e},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.fieldBegin=this.fieldBegin,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,e},t.prototype.componentDestroy=function(){this.fieldText=void 0,this.fieldBegin=void 0,e.prototype.componentDestroy.call(this)},t}(Zl),ed=function(e){function t(){var t=e.call(this)||this;return t.tabText="",t.tabLeader="None",t}return Sl(t,e),t.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},t.prototype.componentDestroy=function(){this.tabText=void 0,this.tabLeader=void 0,e.prototype.componentDestroy.call(this)},t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.tabText=this.tabText,e.tabLeader=this.tabLeader,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(Zl),td=function(e){function t(t){var i=e.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return Sl(t,e),Object.defineProperty(t.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.propertiesIn},set:function(e){this.propertiesIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.nameIn},set:function(e){this.nameIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.refereneceIn},set:function(e){this.refereneceIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},t.prototype.componentDestroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0,e.prototype.componentDestroy.call(this)},t.prototype.clone=function(){var e=new t(this.bookmarkType);return e.name=this.name,e.reference=this.reference,e.properties=this.properties,this.margin&&(e.margin=this.margin.clone()),this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t}(ql),id=function(e){function t(t){var i=e.call(this)||this;return i.contentControlWidgetType=t,i.contentControlProperties=new nd(t),i}return Sl(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.contentControlWidgetType);if(e.characterFormat.copyFormat(this.characterFormat),e.contentControlProperties=this.contentControlProperties,e.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(e.margin=this.margin.clone()),!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.type=this.type,e.width=this.width,e.height=this.height,e.reference=this.reference,e},t.prototype.destroy=function(){this.contentControlProperties=void 0,this.contentControlWidgetType=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.contentControlProperties&&(this.contentControlProperties.destroy(),this.contentControlProperties=void 0),this.contentControlWidgetType=void 0,e.prototype.componentDestroy.call(this)},t}(ql),nd=function(){function e(e){this.contentControlListItems=[],this.contentControlWidgetType=e,this.characterFormat=new ka}return e.prototype.destroy=function(){this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.xmlMapping&&(this.xmlMapping.destroy(),this.xmlMapping=void 0),this.lockContentControl=void 0,this.lockContents=void 0,this.tag=void 0,this.color=void 0,this.title=void 0,this.appearance=void 0,this.type=void 0,this.hasPlaceHolderText=void 0,this.multiline=void 0,this.isTemporary=void 0,this.isChecked=void 0,this.dateCalendarType=void 0,this.dateStorageFormat=void 0,this.dateDisplayLocale=void 0,this.dateDisplayFormat=void 0},e.prototype.clone=function(){var t=new e(this.contentControlWidgetType);if(t.lockContentControl=this.lockContentControl,t.lockContents=this.lockContents,t.tag=this.tag,t.color=this.color,t.title=this.title,t.appearance=this.appearance,t.type=this.type,t.hasPlaceHolderText=this.hasPlaceHolderText,t.multiline=this.multiline,t.isTemporary=this.isTemporary,t.isChecked=this.isChecked,t.dateCalendarType=this.dateCalendarType,t.dateStorageFormat=this.dateStorageFormat,t.dateDisplayLocale=this.dateDisplayLocale,t.dateDisplayFormat=this.dateDisplayFormat,this.contentControlListItems.length>0)for(var i=0;i<this.contentControlListItems.length;i++)t.contentControlListItems.push(this.contentControlListItems[i].clone());return this.checkedState&&(t.checkedState=this.checkedState.clone()),this.uncheckedState&&(t.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(t.xmlMapping=this.xmlMapping.clone()),t},e}(),rd=function(){function e(){}return e.prototype.destroy=function(){this.displayText=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.displayText=this.displayText,t.value=this.value,t},e}(),od=function(){function e(){}return e.prototype.destroy=function(){this.font=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.font=this.font,t.value=this.value,t},e}(),sd=function(){function e(){}return e.prototype.destroy=function(){this.isMapped=void 0,this.isWordMl=void 0,this.prefixMapping=void 0,this.xPath=void 0,this.storeItemId=void 0,this.customXmlPart=void 0},e.prototype.clone=function(){var t=new e;return t.isMapped=this.isMapped,t.isWordMl=this.isWordMl,t.prefixMapping=this.prefixMapping,t.xPath=this.xPath,t.storeItemId=this.storeItemId,this.customXmlPart&&(t.customXmlPart=this.customXmlPart.clone()),t},e}(),ad=function(){function e(){}return e.prototype.destroy=function(){this.id=void 0,this.xml=void 0},e.prototype.clone=function(){var t=new e;return t.id=this.id,t.xml=this.xml,t},e}(),ld=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t.alternateText="",t.title="",t}return Sl(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){return new hd},t}(ql),dd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.verticalPosition=0,t.horizontalPosition=0,t.textWrappingStyle="Inline",t.distanceBottom=0,t.distanceLeft=0,t.distanceRight=0,t.distanceTop=0,t}return Sl(t,e),t}(ld),hd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sl(t,e),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.shapeId=this.shapeId,e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.visible=this.visible,e.verticalPosition=this.verticalPosition,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalRelativePercent=this.verticalRelativePercent,e.horizontalPosition=this.horizontalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalOrigin=this.horizontalOrigin,e.horizontalRelativePercent=this.horizontalRelativePercent,e.heightRelativePercent=this.heightRelativePercent,e.widthRelativePercent=this.widthRelativePercent,e.zOrderPosition=this.zOrderPosition,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.distanceBottom=this.distanceBottom,e.distanceLeft=this.distanceLeft,e.distanceRight=this.distanceRight,e.distanceTop=this.distanceTop,e.editingPoints=this.editingPoints,e.layoutInCell=this.layoutInCell,e.lockAnchor=this.lockAnchor,e.autoShapeType=this.autoShapeType,this.lineFormat&&(e.lineFormat=this.lineFormat.clone()),this.fillFormat&&(e.fillFormat=this.fillFormat.clone()),this.textFrame&&(e.textFrame=this.textFrame.clone(),e.textFrame.containerShape=e),this.margin&&(e.margin=this.margin.clone()),!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(dd),cd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.marginLeft=0,t.marginRight=0,t.marginTop=0,t.marginBottom=0,t}return Sl(t,e),t.prototype.equals=function(){return!1},t.prototype.destroyInternal=function(){},t.prototype.getHierarchicalIndex=function(e){var t=this.containerShape.line,i=t.getOffset(this.containerShape,0).toString();return t.getHierarchicalIndex(i)},t.prototype.getTableCellWidget=function(){},t.prototype.clone=function(){var e=new t;e.textVerticalAlignment=this.textVerticalAlignment,e.marginBottom=this.marginBottom,e.marginLeft=this.marginLeft,e.marginRight=this.marginRight,e.marginTop=this.marginTop;for(var i=0;i<this.childWidgets.length;i++){var n=this.childWidgets[i].clone();e.childWidgets.push(n),n.index=i,n.containerWidget=e}return e},t}(Nl),pd=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.lineFormatType=this.lineFormatType,t.color=this.color,t.weight=this.weight,t.dashStyle=this.dashStyle,t.line=this.line,t},e}(),ud=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.fill=this.fill,t},e}(),gd=function(e){function t(t){var i=e.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.crop=!1,i.left=0,i.top=0,i.right=0,i.bottom=0,i.isMetaFile=!1,i.isCompressed=!1,i.isInlineImageIn=t,i}return Sl(t,e),Object.defineProperty(t.prototype,"isCrop",{get:function(){return this.crop},set:function(e){if(this.crop=e,e){var t=0,i=0;0!==this.left?this.cropX=this.left*this.cropWidthScale/100:this.cropX=0,0!==this.top?this.cropY=this.top*this.cropHeightScale/100:this.cropY=0,0!==this.right&&(t=this.right*this.cropWidthScale/100),0!==this.bottom&&(i=this.bottom*this.cropHeightScale/100),this.cropWidth=this.cropWidthScale-(this.cropX+t),this.cropHeight=this.cropHeightScale-(this.cropY+i)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return(0,a.isNullOrUndefined)(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageString",{get:function(){return this.imageStr},set:function(e){this.imageStr=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.isInlineImage);if(e.characterFormat.copyFormat(this.characterFormat),e.imageString=this.imageString,e.element.src=this.element.src,e.isMetaFile=this.isMetaFile,e.isCompressed=this.isCompressed,e.metaFileImageString=this.metaFileImageString,e.width=this.width,e.height=this.height,e.top=this.top,e.left=this.left,e.bottom=this.bottom,e.right=this.right,e.cropHeightScale=this.cropHeightScale,e.cropWidthScale=this.cropWidthScale,e.cropX=this.cropX,e.cropY=this.cropY,e.isCrop=this.isCrop,e.x=this.x,e.y=this.y,this.margin&&(e.margin=this.margin.clone()),!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.visible=this.visible,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.verticalPosition=this.verticalPosition,e.verticalOrigin=this.verticalOrigin,e.verticalAlignment=this.verticalAlignment,e.horizontalPosition=this.horizontalPosition,e.horizontalOrigin=this.horizontalOrigin,e.horizontalAlignment=this.horizontalAlignment,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.layoutInCell=this.layoutInCell,e.zOrderPosition=this.zOrderPosition,e},t.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,e.prototype.destroy.call(this)},t}(dd),md=function(e){function t(t,i){var n=e.call(this)||this;return n.baselineOffset=0,n.trimEndWidth=0,n.isFollowCharacter=!1,n.listLevel=t,n.isFollowCharacter=i,n}return Sl(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t(this.listLevel,this.isFollowCharacter);return e.text=this.text,e.baselineOffset=this.baselineOffset,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t}(ql),fd=function(e){function t(){var t=e.call(this)||this;return t.editRangeStart=void 0,t.editRangeId=-1,t}return Sl(t,e),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.editRangeStart=void 0},t.prototype.clone=function(){var e=new t;return this.editRangeStart&&(this.editRangeStart.editRangeEnd=e),e.editRangeStart=this.editRangeStart,e.editRangeId=this.editRangeId,e},t}(ql),vd=function(e){function t(){var t=e.call(this)||this;return t.columnFirst=-1,t.columnLast=-1,t.user="",t.group="",t.editRangeId=-1,t}return Sl(t,e),t.prototype.getLength=function(){return 1},t.prototype.renderLockMark=function(e,t){if((0,a.isNullOrUndefined)(this.editRangeMark)){var i=e===this.user?"you":this.user;this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark");var n=document.createElement("span");n.className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(n),this.editRangeMark.title=t.getConstant("This region is locked by")+" "+i}this.line&&(0,a.isNullOrUndefined)(this.editRangeMark.parentElement)&&this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)},t.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},t.prototype.destroy=function(){this.user=void 0,this.columnFirst=void 0,this.columnLast=void 0},t.prototype.clone=function(){var e=new t;return e.columnFirst=this.columnFirst,e.columnLast=this.columnLast,e.user=this.user,e.group=this.group,this.editRangeEnd&&(this.editRangeEnd.editRangeStart=e),e.editRangeEnd=this.editRangeEnd,e.editRangeId=this.editRangeId,e},t}(ql),yd=function(e){function t(){var t=e.call(this)||this;return t.chartTitle="",t.chartType="",t.chartElement=void 0,t.chartCategory=[],t.chartSeries=[],t.chartArea=new wd,t.chartPlotArea=new wd,t.chartTitleArea=new Td,t.chartLegend=new xd,t.chartPrimaryCategoryAxis=new Wd,t.chartPrimaryValueAxis=new Wd,t.chartDataTable=new Od,t}return Sl(t,e),t.prototype.getLength=function(){return 1},Object.defineProperty(t.prototype,"title",{get:function(){return this.chartTitle},set:function(e){this.chartTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.chartType},set:function(e){this.chartType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(e){this.gapWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(e){this.overlap=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetElement",{get:function(){return(0,a.isNullOrUndefined)(this.div)&&(this.div=(0,a.createElement)("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(e){e&&(this.officeChartInternal=e,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),t.prototype.onChartLoaded=function(){var e=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then((function(t){e.imageString=t,e.element.src=t}))},t.prototype.clone=function(){var e=new t;e.chartTitle=this.chartTitle,e.chartType=this.chartType,e.height=this.height,e.width=this.width,e.gapWidth=this.gapWidth,e.overlap=this.overlap;for(var i=0;i<this.chartCategory.length;i++){var n=this.chartCategory[i].clone();e.chartCategory.push(n)}for(i=0;i<this.chartSeries.length;i++){var r=this.chartSeries[i].clone();e.chartSeries.push(r)}return e.chartArea=this.chartArea.clone(),e.chartPlotArea=this.chartPlotArea.clone(),e.chartLegend=this.chartLegend.clone(),e.chartTitleArea=this.chartTitleArea.clone(),e.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),e.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),e.chartDataTable=this.chartDataTable.clone(),e},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0),this.div&&(this.div=void 0),this.chartTitle=void 0,this.chartType=void 0,this.chartArea=void 0,this.chartPlotArea=void 0,this.chartCategory=[],this.chartSeries=[],this.chartTitleArea=void 0,this.chartLegend=void 0,this.chartPrimaryCategoryAxis=void 0,this.chartPrimaryValueAxis=void 0,this.chartDataTable=void 0,this.chartElement=void 0},t}(gd),wd=function(){function e(){}return Object.defineProperty(e.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(e){this.foreColor=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.foreColor=this.foreColor,t},e.prototype.destroy=function(){this.foreColor=void 0},e}(),bd=function(){function e(){this.categoryXName="",this.chartData=[]}return Object.defineProperty(e.prototype,"xName",{get:function(){return this.categoryXName},set:function(e){this.categoryXName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.categoryXName=this.categoryXName;for(var i=0;i<this.chartData.length;i++){var n=this.chartData[i].clone();t.chartData.push(n)}return t},e.prototype.destroy=function(){this.categoryXName=void 0,this.chartData=[]},e}(),Cd=function(){function e(){}return Object.defineProperty(e.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(e){this.yValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(e){this.xValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbleSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.yValue=this.yValue,t.xValue=this.xValue,t.size=this.size,t},e.prototype.destroy=function(){this.xValue=void 0,this.yValue=void 0,this.size=void 0},e}(),xd=function(){function e(){this.chartTitleArea=new Td}return Object.defineProperty(e.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(e){this.legendPostion=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.legendPostion=this.legendPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.legendPostion=void 0,this.chartTitleArea=void 0},e}(),Id=function(){function e(){this.chartDataFormat=[],this.trendLines=[],this.errorBar=new kd,this.dataLabels=new Pd,this.seriesFormat=new Fd}return Object.defineProperty(e.prototype,"seriesName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(e){this.sliceAngle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(e){this.holeSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.name=this.name,t.sliceAngle=this.sliceAngle,t.holeSize=this.holeSize,t.errorBar=this.errorBar.clone(),t.dataLabels=this.dataLabels.clone(),t.seriesFormat=this.seriesFormat.clone();for(var i=0;i<this.chartDataFormat.length;i++){var n=this.chartDataFormat[i].clone();t.chartDataFormat.push(n)}for(i=0;i<this.trendLines.length;i++){var r=this.trendLines[i].clone();t.trendLines.push(r)}return t},e.prototype.destroy=function(){this.name=void 0,this.errorBar=void 0,this.trendLines=void 0,this.chartDataFormat=[]},e}(),kd=function(){function e(){}return Object.defineProperty(e.prototype,"errorType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(e){this.endStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.errorValue},set:function(e){this.errorValue=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.errorDirection=this.errorDirection,t.endStyle=this.endStyle,t.errorValue=this.errorValue,t},e.prototype.destroy=function(){this.type=void 0,this.errorDirection=void 0,this.endStyle=void 0},e}(),Fd=function(){function e(){}return Object.defineProperty(e.prototype,"markerStyle",{get:function(){return this.style},set:function(e){this.style=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markerColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.style=this.style,t.color=this.color,t.size=this.size,t},e.prototype.destroy=function(){this.style=void 0,this.color=void 0,this.size=void 0},e}(),Pd=function(){function e(){}return Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this.position},set:function(e){this.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(e){this.isLegend=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(e){this.isBubble=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(e){this.isCategory=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(e){this.isSeries=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(e){this.isValueEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(e){this.isPercentageEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(e){this.showLeaderLines=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.position=this.position,t.name=this.name,t.color=this.color,t.size=this.size,t.isBubble=this.isBubble,t.isLegend=this.isLegend,t.isCategory=this.isCategory,t.isSeries=this.isSeries,t.isValueEnabled=this.isValueEnabled,t.isPercentageEnabled=this.isPercentageEnabled,t.showLeaderLines=this.showLeaderLines,t},e.prototype.destroy=function(){this.position=void 0},e}(),Sd=function(){function e(){}return Object.defineProperty(e.prototype,"trendLineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trendLineName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interceptValue",{get:function(){return this.intercept},set:function(e){this.intercept=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forwardValue",{get:function(){return this.forward},set:function(e){this.forward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backwardValue",{get:function(){return this.backward},set:function(e){this.backward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(e){this.displayRSquared=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(e){this.displayEquation=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.name=this.name,t.forward=this.forward,t.backward=this.backward,t.intercept=this.intercept,t.displayEquation=this.displayEquation,t.displayRSquared=this.displayRSquared,t},e.prototype.destroy=function(){this.type=void 0,this.name=void 0,this.forward=void 0,this.backward=void 0},e}(),Td=function(){function e(){this.dataFormat=new Hd,this.layout=new Nd}return Object.defineProperty(e.prototype,"chartfontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fontName=this.fontName,t.fontSize=this.fontSize,t.dataFormat=this.dataFormat.clone(),t.layout=this.layout.clone(),t},e.prototype.destroy=function(){this.fontName=void 0,this.fontSize=void 0,this.dataFormat=void 0,this.layout=void 0},e}(),Hd=function(){function e(){this.fill=new Ed,this.line=new Ed}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill.clone(),t.line=this.line.clone(),t},e.prototype.destroy=function(){this.fill=void 0,this.line=void 0},e}(),Ed=function(){function e(){}return Object.defineProperty(e.prototype,"color",{get:function(){return this.fillColor},set:function(e){this.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this.fillRGB},set:function(e){this.fillRGB=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fillColor=this.fillColor,t.fillRGB=this.fillRGB,t},e.prototype.destroy=function(){this.fillColor=void 0,this.fillRGB=void 0},e}(),Nd=function(){function e(){}return Object.defineProperty(e.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(e){this.layoutX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(e){this.layoutY=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.layoutX=this.layoutX,t.layoutY=this.layoutY,t},e.prototype.destroy=function(){this.layoutX=void 0,this.layoutY=void 0},e}(),Wd=function(){function e(){this.chartTitleArea=new Td}return Object.defineProperty(e.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(e){this.majorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(e){this.minorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(e){this.tickLabelPostion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(e){this.hasMinorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(e){this.hasMajorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interval",{get:function(){return this.majorUnit},set:function(e){this.majorUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAutoInternal",{get:function(){return this.isAutoMajor},set:function(e){this.isAutoMajor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.maximumValue},set:function(e){this.maximumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.minimumValue},set:function(e){this.minimumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(e){this.categoryType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(e){this.numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.title=this.title,t.categoryType=this.categoryType,t.numberFormat=this.numberFormat,t.fontSize=this.fontSize,t.fontName=this.fontName,t.hasMajorGridLines=this.hasMajorGridLines,t.hasMinorGridLines=this.hasMinorGridLines,t.minimumValue=this.minimumValue,t.maximumValue=this.maximumValue,t.majorUnit=this.majorUnit,t.isAutoMajor=this.isAutoMajor,t.majorTickMark=this.majorTickMark,t.minorTickMark=this.minorTickMark,t.tickLabelPostion=this.tickLabelPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.title=void 0,this.categoryType=void 0,this.numberFormat=void 0,this.chartTitleArea=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.fontSize=void 0,this.fontName=void 0,this.majorUnit=void 0,this.majorTickMark=void 0,this.minorTickMark=void 0,this.tickLabelPostion=void 0},e}(),Od=function(){function e(){}return Object.defineProperty(e.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(e){this.isSeriesKeys=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(e){this.isHorzBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(e){this.isVertBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(e){this.isBorders=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.isSeriesKeys=this.isSeriesKeys,t.isHorzBorder=this.isHorzBorder,t.isVertBorder=this.isVertBorder,t.isBorders=this.isBorders,t},e.prototype.destroy=function(){this.isSeriesKeys=void 0,this.isHorzBorder=void 0,this.isVertBorder=void 0,this.isBorders=void 0},e}(),Bd=function(e){function t(t){var i=e.call(this)||this;return i.commentType=0,i.commentId="",i.commentType=t,i}return Sl(t,e),Object.defineProperty(t.prototype,"comment",{get:function(){return this.commentInternal},set:function(e){this.commentInternal=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.commentType);return e.commentId=this.commentId,e.commentType=this.commentType,(0,a.isNullOrUndefined)(this.commentInternal)||(e.commentInternal=this.commentInternal.clone()),e},t.prototype.renderCommentMark=function(e,t){var i=this.line.paragraph.bodyWidget.page.documentHelper,n=i.render.commentMarkDictionary;if(0===this.commentType&&(0,a.isNullOrUndefined)(this.commentMark)){this.commentMark=document.createElement("div"),this.commentMark.style.display="none",this.commentMark.classList.add("e-de-cmt-mark");var r=document.createElement("span");r.classList.add("e-icons"),r.classList.add("e-de-cmt-mark-icon"),this.commentMark.appendChild(r)}this.line&&(0,a.isNullOrUndefined)(this.commentMark.parentElement)&&(i.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this)));for(var o,s=!1,l=0;l<n.length;l++)if(this.elementsOverlap(n.keys[l],e,t)){s=!0,o=n.keys[l];break}if(s){var d=!0;for(l=0;l<n.get(o).length;l++)if(n.get(o)[l]===this){d=!1;break}d&&n.get(o).push(this)}else n.add(this.commentMark,[this]);for(l=0;l<n.length;l++){var h=n.keys[l];if(1==n.get(h).length&&n.get(h)[0].commentMark&&(n.get(h)[0].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-mark")?(0,a.classList)(n.get(h)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-multi-cmt-mark"]):n.get(h)[0].commentInternal.isResolved&&n.get(h)[0].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")?(0,a.classList)(n.get(h)[0].commentMark.firstElementChild,["e-de-cmt-resolve-icon"],["e-de-cmt-mark-icon"]):!n.get(h)[0].commentInternal.isResolved&&n.get(h)[0].commentMark.firstElementChild.classList.contains("e-de-cmt-resolve-icon")&&(0,a.classList)(n.get(h)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-cmt-resolve-icon"])),n.get(h).length>1)for(var c=0;c<n.get(h).length;c++){for(var p=!0,u=0;u<n.get(h).length;u++)if(n.get(h)[u].commentInternal&&!n.get(h)[u].commentInternal.isResolved){p=!1;break}n.get(h)[c].commentMark&&(n.get(h)[c].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")?(0,a.classList)(n.get(h)[c].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-cmt-mark-icon"]):!p&&n.get(h)[c].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-resolve")?(0,a.classList)(n.get(h)[c].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-multi-cmt-resolve"]):p&&(0,a.classList)(n.get(h)[c].commentMark.firstElementChild,["e-de-multi-cmt-resolve"],["e-de-multi-cmt-mark"]))}}},t.prototype.elementsOverlap=function(e,t,i){var n=e.offsetWidth,r=e.offsetHeight,o=parseFloat(e.style.top),s=parseFloat(e.style.left),a=o+r,l=s+n,d=parseFloat(t),h=parseFloat(i);return!(o>d+r||l<h||a<d||s>h+n)},t.prototype.selectComment=function(){for(var e=this.line.paragraph.bodyWidget.page.documentHelper,t=e.render.commentMarkDictionary,i=this.commentMark.style.top,n=this.commentMark.style.left,r=0,o=[],s=0;s<t.keys.length;s++)if(this.elementsOverlap(t.keys[s],i,n)){o=t.get(t.keys[s]);break}if(e.owner.documentHelper.currentSelectedComment){for(s=0;s<o.length;s++)if(o[s].comment===e.owner.documentHelper.currentSelectedComment){r=s;break}r<o.length-1?r+=1:r=0}else r=0;e.owner&&(e.owner.commentReviewPane.commentPane.isEditMode?e.owner.showComments=!0:e.selectComment(o[r].comment))},t.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},t.prototype.destroy=function(){this.commentMark&&this.removeCommentMark(),this.commentMark=void 0,this.commentInternal=void 0,this.commentId=void 0,e.prototype.componentDestroy.call(this)},t}(ql),Ld=function(e){function t(t){var i=e.call(this,0)||this;return i.authorIn="",i.initialIn="",i.done=!1,i.posted=!1,i.textIn="",i.isReply=!1,i.ownerComment=void 0,i.mentionsIn=[],i.createdDate=t,i.replyComments=[],i}return Sl(t,e),Object.defineProperty(t.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(e){this.commentStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(e){this.commentEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"author",{get:function(){return this.authorIn},set:function(e){this.authorIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){return this.initialIn},set:function(e){this.initialIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResolved",{get:function(){return this.done},set:function(e){this.done=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.textIn},set:function(e){this.textIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mentions",{get:function(){return this.mentionsIn},set:function(e){this.mentionsIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPosted",{get:function(){return this.posted},set:function(e){this.posted=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.date);return e.author=this.author,e.initial=this.initial,e.commentId=this.commentId,e.replyComments=this.replyComments,e.isResolved=this.isResolved,e.text=this.text,e},t.prototype.destroy=function(){if(this.replyComments&&this.replyComments.length>0){for(var t=0;t<this.replyComments.length;t++){this.replyComments[t].destroy()}this.replyComments=[]}this.replyComments=void 0,this.commentStartIn&&(this.commentStartIn.destroy(),this.commentStartIn=void 0),this.commentEndIn&&(this.commentEndIn.destroy(),this.commentEndIn=void 0),this.commentId=void 0,this.createdDate=void 0,this.initialIn=void 0,this.textIn=void 0,this.authorIn=void 0,this.ownerComment=void 0,e.prototype.destroy.call(this)},t}(Bd),Dd=function(){function e(e){this.boundingRectangle=new Tl(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidgetIn=void 0,this.footerWidgetIn=void 0,this.footnoteWidget=void 0,this.endnoteWidget=void 0,this.currentPageNum=1,this.allowNextPageRendering=!0,this.documentHelper=e}return Object.defineProperty(e.prototype,"headerWidget",{get:function(){return!(0,a.isNullOrUndefined)(this.headerWidgetIn)&&this.headerWidgetIn.parentHeaderFooter?this.headerWidgetIn.parentHeaderFooter:this.headerWidgetIn},set:function(e){this.headerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerWidget",{get:function(){return!(0,a.isNullOrUndefined)(this.footerWidgetIn)&&this.footerWidgetIn.parentHeaderFooter?this.footerWidgetIn.parentHeaderFooter:this.footerWidgetIn},set:function(e){this.footerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousPage",{get:function(){var e=this.index;if(e>0)return this.documentHelper.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.documentHelper.pages.length-1)return this.documentHelper.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.headerWidget&&this.headerWidget.page===this&&(this.headerWidget.page=void 0),this.footerWidget&&this.footerWidget.page===this&&(this.footerWidget.page=void 0),this.headerWidgetIn&&!(0,a.isNullOrUndefined)(this.headerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editorModule&&(this.documentHelper.owner.editorModule.removeFieldInWidget(this.headerWidgetIn),this.documentHelper.owner.editorModule.removeFieldInWidget(this.headerWidgetIn,!1,!0)),this.headerWidgetIn.destroy(),this.headerWidget=void 0),this.footerWidgetIn&&!(0,a.isNullOrUndefined)(this.footerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editorModule&&(this.documentHelper.owner.editorModule.removeFieldInWidget(this.footerWidgetIn),this.documentHelper.owner.editorModule.removeFieldInWidget(this.footerWidgetIn,!1,!0)),this.footerWidgetIn.destroy(),this.footerWidgetIn=void 0),this.bodyWidgets=[],this.bodyWidgets=void 0,(0,a.isNullOrUndefined)(this.documentHelper)||(0,a.isNullOrUndefined)(this.documentHelper.pages)||this.documentHelper.removePage(this),this.documentHelper=void 0},e.prototype.componentDestroy=function(){if(this.headerWidgetIn&&(this.headerWidgetIn.componentDestroy(),this.headerWidgetIn=void 0),this.footerWidgetIn&&(this.footerWidgetIn.componentDestroy(),this.footerWidgetIn=void 0),this.bodyWidgets){for(var e=0;e<this.bodyWidgets.length;e++){this.bodyWidgets[e].componentDestroy()}this.bodyWidgets=[],this.bodyWidgets=void 0}this.documentHelper=void 0},e}(),Rd=function(){function e(){this.tableColumns=[],this.tableWidth=0}return Object.defineProperty(e.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),e.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},e.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,n=e;n<t;n++)i+=this.tableColumns[n].preferredWidth;return i},e.prototype.addColumns=function(e,t,i,n,r,o){for(var s=this.columns.length;s<t;s++)this.columns.push(new Md);for(var a=0,l=e;l<t;l++)a+=this.columns[l].preferredWidth;!(t-e>1)&&a<i&&(this.columns[t-1].preferredWidth+=i-a),n.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=n.minimumWordWidth),n.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=n.maximumWordWidth),n.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=n.minimumWidth),r>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=r),this.columns[t-1].widthType=o},e.prototype.getTotalWidth=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];t+=0===e?n.preferredWidth:1===e?n.minimumWordWidth:2===e?n.maximumWordWidth:n.minimumWidth}return t},e.prototype.isFitColumns=function(e,t,i){var n=this.getTotalWidth(0);if(this.tableWidth=i&&t>n?n:t,n!==this.tableWidth){var r=this.tableWidth/n;r=isNaN(r)||r===1/0?1:r;for(var o=0;o<this.columns.length;o++){var s=this.columns[o];if(r*s.preferredWidth<s.minWidth)return!1}return!0}return!0},e.prototype.isAllColumnHasPointWidthType=function(){for(var e=!0,t=0;t<this.columns.length;t++)"Point"!=this.columns[t].widthType&&(e=!1);return e},e.prototype.autoFitColumn=function(e,t,i,n,r,o,s,l,d){for(var h=0,c=0,p=0,u=this.columns.every((function(e){return"Point"===e.widthType})),g=0,m=[],f=this.getTotalWidth(0),v=!i&&"Point"===d&&u&&!o&&Pa.round(t,2)<Pa.round(f,2),y=0;y<this.columns.length;y++){0===(I=this.columns[y]).minimumWordWidth&&0===I.maximumWordWidth&&0===I.minWidth&&(I.minimumWordWidth=I.preferredWidth,I.maximumWordWidth=I.preferredWidth,I.minWidth=I.preferredWidth),v&&(this.columns[y].preferredWidth=this.columns[y].preferredWidth/f*t);var w=0;h+=I.preferredWidth>I.maximumWordWidth?I.preferredWidth:I.maximumWordWidth,c+=I.preferredWidth>I.minimumWordWidth?I.preferredWidth:I.minimumWordWidth;var b=0===I.preferredWidth?I.minimumWordWidth:I.preferredWidth>I.minimumWordWidth?I.preferredWidth:I.minimumWordWidth;p+=(w=I.maximumWordWidth-b)>0?w:0,I.preferredWidth<I.minimumWordWidth?g+=I.minimumWordWidth-I.preferredWidth:m.push(y)}if(h<=t){for(y=0;y<this.columns.length;y++){"Point"!==(I=this.columns[y]).widthType?I.preferredWidth<I.maximumWordWidth&&(I.preferredWidth=I.maximumWordWidth):I.preferredWidth<I.minimumWordWidth&&(I.preferredWidth=I.minimumWordWidth)}i||this.fitColumns(e,t,i,r)}else{var C=this.getTotalWidth(0);if(u&&!o&&c>e&&(e>C&&(g-=e-C),m.length>0&&g>0)){var x=g/this.columns.length;for(y=0;y<this.columns.length;y++){var I=this.columns[y];-1===m.indexOf(y)?C>I.minimumWordWidth&&(I.preferredWidth=I.minimumWordWidth):(I.preferredWidth=I.preferredWidth-x,I.preferredWidth<I.minimumWordWidth&&(I.preferredWidth=I.minimumWordWidth))}C=this.getTotalWidth(0)}if(!i){var k=t<c&&c+((0,a.isNullOrUndefined)(s)?0:s)<e;if(v&&k){if(c>t&&g>0){t>C&&(g-=t-C);for(x=g/m.length,y=0;y<this.columns.length;y++){I=this.columns[y];-1===m.indexOf(y)?I.preferredWidth=I.minimumWordWidth:I.preferredWidth=I.preferredWidth-x}C=this.getTotalWidth(0)}return}return void this.fitColumns(e,k?c:t,i,r)}if(c<=t||c<=e){var F=e>t?e:t;F-=c;for(y=0;y<this.columns.length;y++){if("Point"!==(I=this.columns[y]).widthType){(0===I.preferredWidth||I.preferredWidth<I.minimumWordWidth)&&(I.preferredWidth=I.minimumWordWidth);var P=F*((w=(w=I.maximumWordWidth-I.preferredWidth)>0?w:0)/p);I.preferredWidth+=isNaN(P)?0:P}}}else{var S=this.getTotalWidth(1),T=this.getTotalWidth(3);if(T>2112){var H=2112/this.columns.length;for(y=0;y<this.columns.length;y++)this.columns[y].preferredWidth=H}else{F=0;if(T<e&&e-T>=1&&!u||u&&!o&&S>e){F=e-T;for(y=0;y<this.columns.length;y++){P=F*(I=this.columns[y]).minimumWordWidth/S;P=isNaN(P)?0:P,I.preferredWidth=(0==I.minimumWidth?1:I.minimumWidth)+P}}else if(C>e)for(P=e/C,y=0;y<this.columns.length;y++){(I=this.columns[y]).preferredWidth=I.preferredWidth*P}}}}this.tableWidth=this.getTotalWidth(0)},e.prototype.getValidColumnIndex=function(e){for(var t=0,i=0;i<this.columns.length;i++){var n=this.columns[i];if(i<e)t=n.endOffset;else{if(t!==n.endOffset)break;e++}}return e},e.prototype.fitColumns=function(e,t,i,n,r){(0,a.isNullOrUndefined)(r)&&(r=0);var o=this.getTotalWidth(0);if(i&&(o-=r),this.tableWidth=i?o:t,o!==this.tableWidth){var s=this.tableWidth/o;s=isNaN(s)||s===1/0?1:s;for(var l=0;l<this.columns.length;l++){var d=this.columns[l];if("Percent"===d.widthType&&!i&&!n&&o>this.tableWidth){if(0!==l&&d.endOffset>this.tableWidth){var h=this.getCellWidth(0,l+1,t);h>this.tableWidth&&(d.preferredWidth-=h-this.tableWidth,(0===d.preferredWidth||d.preferredWidth<d.minimumWidth)&&(d.preferredWidth=d.minimumWidth>0?d.minimumWidth:1,this.columns[0].preferredWidth-=d.preferredWidth))}}else d.preferredWidth=s*d.preferredWidth}}},e.prototype.getCellWidth=function(e,t,i){for(var n=0,r=0;r<t;r++)n+=this.tableColumns[r+e].preferredWidth;return n},e.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(0===this.columns[e-1].endOffset?this.columns[e].preferredWidth=this.columns[e].endOffset-this.getPreviousValidOffset(e-2):this.columns[e].preferredWidth=this.columns[e].endOffset-this.columns[e-1].endOffset)},e.prototype.getPreviousValidOffset=function(e){for(var t=e;t>=0;t--)if(0!==this.columns[t].endOffset)return this.columns[t].endOffset;return 0},e.prototype.clone=function(){var t=new e;t.tableWidth=this.tableWidth;for(var i=0;i<this.columns.length;i++)t.columns.push(this.columns[i].clone());return t},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++){this.tableColumns[e].destroy()}this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0},e}(),Md=function(){function e(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0,this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0}return e.prototype.clone=function(){var t=new e;return t.preferredWidth=this.preferredWidth,t.minWidth=this.minWidth,t.maxWidth=this.maxWidth,t},e.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0},e}(),Ad=function(){this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0,this.hasMinimumWidth=!1,this.hasMinimumWordWidth=!1,this.hasMaximumWordWidth=!1},Ud=function(){},Vd=function(){},zd=function(e){function t(){return e.call(this)||this}return Sl(t,e),t.prototype.clone=function(){var t=e.prototype.clone.call(this);return t.breakClearType=this.breakClearType,t},t.prototype.destroy=function(){this.breakClearType=void 0,e.prototype.destroy.call(this)},t.prototype.componentDestroy=function(){this.breakClearType=void 0,e.prototype.componentDestroy.call(this)},t}(Zl),qd=function(){},_d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sl(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!(0,a.isNullOrUndefined)(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var n=this.revisions[i];e.revisions.push(n.clone())}}else this.revisions.length>0?e.removedIds=xa.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t}(Zl),jd="_contextmenu_lock",Gd="_contextmenu_unlock",Kd="_contextmenu_copy",Xd="_contextmenu_cut",Zd="_contextmenu_paste",Jd="_add_comment",Yd="_contextmenu_update_field",Qd="_contextmenu_edit_field",$d="_contextmenu_hyperlink",eh="_contextmenu_open_hyperlink",th="_contextmenu_copy_hyperlink",ih="_contextmenu_remove_hyperlink",nh="_properties",rh="_contextmenu_edit_hyperlink",oh="_contextmenu_font_dialog",sh="_contextmenu_paragraph_dialog",ah="_contextmenu_table_dialog",lh="_contextmenu_insert_table",dh="_contextmenu_delete_table",hh="_contextmenu_insert_above",ch="_contextmenu_insert_below",ph="_contextmenu_insert_right",uh="_contextmenu_insert_left",gh="_contextmenu_complete_table_delete",mh="_contextmenu_delete_row",fh="_contextmenu_delete_column",vh="_contextmenu_merge_cell",yh="_contextmenu_auto_fit",wh="_contextmenu_auto_fit_contents",bh="_contextmenu_auto_fit_window",Ch="_contextmenu_fixed_column_width",xh="_contextmenu_continue_numbering",Ih="_contextmenu_restart_at",kh="_contextmenu_spelling_dialog",Fh="_contextmenu_otherSuggestions_spellcheck_",Ph="_contextmenu_no_suggestion",Sh="_contextmenu_accept_changes",Th="_contextmenu_reject_changes",Hh="_contextmenu_note_options",Eh="_remove_content_control",Nh="_content_control_properties",Wh=function(){function e(e){var t=this;this.contextMenuInstance=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[],this.spellContextItems=[],this.customItems=[],this.onContextMenuInternal=function(e){MouseEvent;if(t.documentHelper.owner.isSpellCheck&&t.spellChecker.allowSpellCheckAndSuggestion){var i,n;e.preventDefault(),t.currentContextInfo=t.spellChecker.findCurretText();var r=t.spellChecker.manageSpecialCharacters(t.currentContextInfo.text,void 0,!0);!(0,a.isNullOrUndefined)(r)&&t.spellChecker.errorWordCollection.containsKey(r)?(t.spellChecker.currentContextInfo=t.currentContextInfo,t.spellChecker.errorSuggestions.containsKey(r)?(n=t.spellChecker.errorSuggestions.get(r).slice(),i=t.spellChecker.handleSuggestions(n),t.processSuggestions(n,i,e)):t.spellChecker.enableOptimizedSpellCheck?t.spellChecker.callSpellChecker(t.spellChecker.languageID,r,!1,!0,!1,!1).then((function(o){var s=JSON.parse(o);n=s.Suggestions,(0,a.isNullOrUndefined)(t.documentHelper)||((0,a.isNullOrUndefined)(n)||(t.spellChecker.errorSuggestions.add(r,n.slice()),i=t.spellChecker.handleSuggestions(n)),t.processSuggestions(n,i,e))})):t.processSuggestions(n,i,e)):(t.hideSpellContextItems(),t.showContextMenuOnSel(e))}else t.hideSpellContextItems(),t.showContextMenuOnSel(e)},(0,a.isNullOrUndefined)(e)||(this.documentHelper=e,this.locale=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.locale.setLocale(this.documentHelper.owner.locale),this.initContextMenu(this.locale,this.documentHelper.owner.enableRtl))}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellChecker",{get:function(){try{return this.documentHelper.owner.spellCheckerModule}catch(e){return}},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ContextMenu"},e.prototype.initContextMenu=function(e,t){var i=this,n=this.documentHelper.owner.element.id;this.contextMenu=document.createElement("div"),this.contextMenu.id=this.documentHelper.owner.containerId+"e-de-contextmenu",document.body.appendChild(this.contextMenu);var r=document.createElement("ul");r.contentEditable="false",r.style.width="auto",r.id=this.documentHelper.owner.containerId+"e-de-contextmenu-list",r.style.listStyle="none",r.style.margin="0px",r.style.maxHeight="auto",r.oncontextmenu=this.disableBrowserContextmenu,this.contextMenu.appendChild(r),this.menuItems=[{text:e.getConstant("Lock"),iconCss:"e-icons e-de-ctnr-lock",id:n+jd},{text:e.getConstant("Unlock"),iconCss:"e-icons",id:n+Gd},{text:e.getConstant("Cut"),iconCss:"e-icons e-de-cut",id:n+Xd},{text:e.getConstant("Copy"),iconCss:"e-icons e-de-copy",id:n+Kd},{text:e.getConstant("Paste"),iconCss:"e-icons e-de-paste",id:n+Zd},{separator:!0},{text:e.getConstant("Remove Content Control"),iconCss:"e-icons",id:n+Eh},{text:e.getConstant("Content Control Properties"),iconCss:"e-icons e-de-formproperties",id:n+Nh},{separator:!0},{text:e.getConstant("New Comment"),iconCss:"e-icons e-de-cmt-add",id:n+Jd},{separator:!0},{text:e.getConstant("Accept Changes"),iconCss:"e-icons e-de-acceptchange",id:n+Sh},{text:e.getConstant("Reject Changes"),iconCss:"e-icons e-de-rejectchange",id:n+Th},{text:e.getConstant("Update Field"),iconCss:"e-icons e-de-update-field",id:n+Yd},{text:e.getConstant("Edit Field")+"...",iconCss:"e-icons e-de-edit_field",id:n+Qd},{text:e.getConstant("Continue Numbering"),iconCss:"e-icons e-de-continue-numbering",id:n+xh},{text:e.getConstant("Restart At")+" 1",iconCss:"e-icons e-de-restart-at",id:n+Ih},{separator:!0},{text:e.getConstant("Hyperlink")+"...",iconCss:"e-icons e-de-insertlink",id:n+$d},{text:e.getConstant("Edit Hyperlink")+"...",iconCss:"e-icons e-de-edit-hyperlink",id:n+rh},{text:e.getConstant("Open Hyperlink"),iconCss:"e-icons e-de-open-hyperlink",id:n+eh},{text:e.getConstant("Copy Hyperlink"),iconCss:"e-icons e-de-copy-hyperlink",id:n+th},{text:e.getConstant("Remove Hyperlink"),iconCss:"e-icons e-de-remove-hyperlink",id:n+ih},{text:e.getConstant("Properties"),iconCss:"e-icons e-de-formproperties",id:n+nh},{separator:!0},{text:e.getConstant("Font")+"...",iconCss:"e-icons e-de-fonts",id:n+oh},{text:e.getConstant("Paragraph")+"...",iconCss:"e-icons e-de-paragraph",id:n+sh},{text:e.getConstant("Notes Options")+"...",id:n+Hh},{separator:!0},{text:e.getConstant("Table Properties")+"...",id:n+ah,iconCss:"e-icons e-de-table"},{text:e.getConstant("Merge Cells"),id:n+vh,iconCss:"e-icons e-de-ctnr-mergecell"},{text:e.getConstant("AutoFit"),id:n+yh,iconCss:"e-icons",items:[{text:e.getConstant("AutoFit to Contents"),id:n+wh,iconCss:"e-icons e-de-icon-autofit e-de-autofit-contents"},{text:e.getConstant("AutoFit to Window"),id:n+bh,iconCss:"e-icons e-de-icon-auto-fitwindow e-de-autofit-window"},{text:e.getConstant("Fixed Column Width"),id:n+Ch,iconCss:"e-icons e-de-icon-fixed-columnwidth e-de-fixed-column"}]},{text:e.getConstant("Insert"),id:n+lh,iconCss:"e-icons",items:[{text:e.getConstant("Insert Above"),id:n+hh,iconCss:"e-icons e-de-insertabove"},{text:e.getConstant("Insert Below"),id:n+ch,iconCss:"e-icons e-de-insertbelow"},{text:e.getConstant("Insert Left"),id:n+uh,iconCss:"e-icons e-de-insertleft"},{text:e.getConstant("Insert Right"),id:n+ph,iconCss:"e-icons e-de-insertright"}]},{text:e.getConstant("Delete"),id:n+dh,iconCss:"e-icons",items:[{text:e.getConstant("Delete Table"),id:n+gh,iconCss:"e-icons e-de-delete-table"},{text:e.getConstant("Delete Row"),id:n+mh,iconCss:"e-icons e-de-deleterow"},{text:e.getConstant("Delete Column"),id:n+fh,iconCss:"e-icons e-de-deletecolumn"}]}];var o={target:"#"+this.documentHelper.owner.containerId+"e-de-contextmenu",enableRtl:t,items:this.addMenuItems(this.menuItems),cssClass:"e-de-contextmenu-wrapper",select:function(e){var t=e.element.id;i.handleContextMenuItem(t)}};this.contextMenuInstance=new ua.ContextMenu(o,"#"+this.documentHelper.owner.containerId+"e-de-contextmenu-list"),this.contextMenuInstance.beforeOpen=function(){for(var e=0;e<i.customMenuItems.length;e++)void 0!==i.customMenuItems[e].id?i.ids[e]=i.customMenuItems[e].id:i.ids[e]=i.customMenuItems[e+1].id;if(i.documentHelper.owner.fireCustomContextMenuBeforeOpen(i.ids),i.enableCustomContextMenu)for(e=0;e<i.menuItems.length;e++)void 0!==i.menuItems[e].id?document.getElementById(i.menuItems[e].id).style.display="none":document.getElementById(i.menuItems[e-1].id).nextSibling.style.display="none";i.viewer&&i.documentHelper.selection&&((0,a.classList)(i.documentHelper.selection.caret,[],["e-de-cursor-animation"]),i.documentHelper.selection.showCaret())},(0,a.isNullOrUndefined)(this.documentHelper.owner.documentEditorSettings.popupTarget)||this.documentHelper.owner.documentEditorSettings.popupTarget.append(document.getElementsByClassName("e-de-contextmenu-wrapper")[0]),this.contextMenuInstance.onClose=function(){i.viewer&&i.documentHelper.selection&&((0,a.classList)(i.documentHelper.selection.caret,["e-de-cursor-animation"],[]),n+oh!==i.itemsmenu&&n+$d!==i.itemsmenu&&n+ah!==i.itemsmenu&&n+sh!==i.itemsmenu&&i.documentHelper.updateFocus())}},e.prototype.disableBrowserContextmenu=function(){return!1},e.prototype.openPasteDialog=function(){var e=this,t=(0,a.createElement)("div"),i=(0,a.createElement)("div"),n=(0,a.createElement)("p"),r=this.locale.getConstant("Paste Content Dialog");this.documentHelper.isIosDevice?n.textContent=r+" Command + V.":n.textContent=r+" Ctrl + V.",i.appendChild(n),t.appendChild(i);var o=(0,a.createElement)("div");if(this.pasteCheckBoxDialog=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),o.appendChild(this.pasteCheckBoxDialog),new tl.CheckBox({label:this.locale.getConstant("Paste Content CheckBox")}).appendTo(this.pasteCheckBoxDialog),t.appendChild(o),!JSON.parse(localStorage.getItem("ej_de_hidePasteAlert")))el.DialogUtility.alert({title:this.locale.getConstant("Information"),content:t,okButton:{text:this.locale.getConstant("Ok")},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},close:function(){e.pasteCheckBoxDialog.checked&&localStorage.setItem("ej_de_hidePasteAlert","true")}})},e.prototype.handleContextMenuItem=function(e){var t=this.documentHelper.owner.element.id;switch(this.itemsmenu=e,e){case t+jd:this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.lockContent(this.documentHelper.owner.currentUser);break;case t+Gd:this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.unlockContent(this.documentHelper.owner.currentUser);break;case t+Kd:this.documentHelper.selection.copy();break;case t+Xd:this.documentHelper.owner.editorModule.cut();break;case t+Zd:this.documentHelper.owner.isReadOnlyMode||(this.documentHelper.owner.enableLocalPaste?this.documentHelper.owner.editorModule.pasteInternal(void 0):this.openPasteDialog());break;case t+Jd:this.documentHelper.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(this.documentHelper.owner.editorModule.isUserInsert=!0,this.documentHelper.owner.editorModule.insertComment(),this.documentHelper.owner.editorModule.isUserInsert=!1);break;case t+Yd:var i=this.documentHelper.owner.isReadOnlyMode;this.documentHelper.selection.isReferenceField()&&(!i||i&&"FormFieldsOnly"===this.documentHelper.protectionType)?this.documentHelper.selection.updateRefField():this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.editorModule.updateToc();break;case t+Qd:this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.tableOfContentsDialogModule.show();break;case t+oh:this.documentHelper.owner.fontDialogModule&&this.documentHelper.owner.fontDialogModule.showFontDialog();break;case t+Eh:!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked&&this.documentHelper.owner.editor.removeContentControl();break;case t+Nh:!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked&&this.documentHelper.owner.contentControlPropertiesDialogModule&&this.documentHelper.owner.contentControlPropertiesDialogModule.show();break;case t+eh:this.documentHelper.selection.navigateHyperlink();break;case t+th:this.documentHelper.selection.copyHyperlink();break;case t+rh:case t+$d:this.documentHelper.owner.hyperlinkDialogModule&&this.documentHelper.owner.hyperlinkDialogModule.show();break;case t+ih:this.documentHelper.owner.editorModule.removeHyperlink();break;case t+sh:this.documentHelper.owner.paragraphDialogModule&&this.documentHelper.owner.paragraphDialogModule.show();break;case t+ah:this.documentHelper.owner.tablePropertiesDialogModule.show();break;case t+vh:this.documentHelper.owner.editorModule.mergeCells();break;case t+hh:this.documentHelper.owner.editorModule.insertRow(!0);break;case t+ch:this.documentHelper.owner.editorModule.insertRow(!1);break;case t+uh:this.documentHelper.owner.editorModule.insertColumn(!0);break;case t+ph:this.documentHelper.owner.editorModule.insertColumn(!1);break;case t+gh:this.documentHelper.owner.editorModule.deleteTable();break;case t+mh:this.documentHelper.owner.editorModule.deleteRow();break;case t+fh:this.documentHelper.owner.editorModule.deleteColumn();break;case t+xh:this.documentHelper.owner.editorModule.applyContinueNumbering();break;case t+Ih:this.documentHelper.owner.editorModule.applyRestartNumbering(this.documentHelper.selection);break;case t+wh:this.documentHelper.owner.editorModule.autoFitTable("FitToContents");break;case t+bh:this.documentHelper.owner.editorModule.autoFitTable("FitToWindow");break;case t+Ch:this.documentHelper.owner.editorModule.autoFitTable("FixedColumnWidth");break;case t+kh:var n=this.spellChecker.retriveText();this.currentContextInfo=null,this.documentHelper.owner.spellCheckDialogModule.show(n.text,n.element);break;case t+Sh:this.documentHelper.selection.handleAcceptReject(!0);break;case t+Th:this.documentHelper.selection.handleAcceptReject(!1);break;case t+nh:var r=this.documentHelper.selection.getCurrentFormField();r instanceof _l&&(r.formFieldData instanceof Gl?this.documentHelper.owner.textFormFieldDialogModule.show():r.formFieldData instanceof Kl?this.documentHelper.owner.checkBoxFormFieldDialogModule.show():r.formFieldData instanceof Xl&&this.documentHelper.owner.dropDownFormFieldDialogModule.show());break;case t+Hh:this.documentHelper.owner.showFootNotesDialog();break;default:var o=this.documentHelper.owner.element.id+Fh;if(e.substring(0,o.length)===o){var s=e.substring(e.lastIndexOf("_")+1);this.callSelectedOption(s);break}this.documentHelper.owner.fireCustomContextMenuSelect(e)}},e.prototype.callSelectedOption=function(e){"Add to Dictionary"===e?this.spellChecker.handleAddToDictionary():"Ignore All"===e?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(e)},e.prototype.addCustomMenu=function(e,t,i){var n=JSON.parse(Pa.sanitizeString(JSON.stringify(e)));this.destroy(),0===this.spellContextItems.length&&(this.customItems=e);for(var r=0;r<n.length;r++)this.customMenuItems.push(n[r]),this.customMenuItems[r].id=this.documentHelper.owner.element.id+this.customMenuItems[r].id;this.enableCustomContextMenu=t,this.enableCustomContextMenuBottom=i,this.initContextMenu(this.locale)},e.prototype.addMenuItems=function(e){return this.enableCustomContextMenuBottom?e.concat(this.customMenuItems):this.customMenuItems.concat(e)},e.prototype.showContextMenuOnSel=function(e){var t=!(e instanceof MouseEvent),i=0,n=0;if(t){var r=this.documentHelper.getTouchOffsetValue(e);i=r.x,n=r.y}else n=(a.Browser.isIE?e.clientY:e.y)+document.body.scrollTop+document.documentElement.scrollTop,i=(a.Browser.isIE?e.clientX:e.x)+document.body.scrollLeft+document.documentElement.scrollLeft;this.showHideElements(this.documentHelper.selection)&&(t&&(this.documentHelper.isMouseDown=!1),this.contextMenuInstance.open(n,i),e.preventDefault())},e.prototype.hideSpellContextItems=function(){if(this.spellContextItems.length>0)for(var e=0;e<this.spellContextItems.length;e++)if(-1===this.customItems.indexOf(this.spellContextItems[e])){var t=document.getElementById(this.documentHelper.owner.element.id+this.spellContextItems[e].id);(0,a.isNullOrUndefined)(t)||(t.style.display="none")}},e.prototype.processSuggestions=function(e,t,i){this.spellContextItems=this.constructContextmenu(e,t),this.addCustomMenu(this.spellContextItems),this.noSuggestion=document.getElementById(this.documentHelper.owner.element.id+Ph),(0,a.isNullOrUndefined)(this.noSuggestion)||(this.noSuggestion.style.display="block",(0,a.classList)(this.noSuggestion,["e-disabled"],["e-focused"])),this.showContextMenuOnSel(i)},e.prototype.constructContextmenu=function(e,t){var i=this.customItems.length>0?this.customItems.slice():[];if((0,a.isNullOrUndefined)(e)||0===e.length)i.push({text:this.locale.getConstant("no suggestions"),id:Ph,classList:["e-focused"],iconCss:""});else for(var n=0;n<e.length;n++)i.push({text:e[n],id:Fh+e[n],iconCss:""});return i.push({separator:!0,id:"_contextmenu_suggestion_separator"}),!(0,a.isNullOrUndefined)(t)&&t.length>1?(i.push({text:this.locale.getConstant("More Suggestion"),items:t}),i.push({separator:!0,id:"_contextmenu_moreSuggestion_separator"})):i.push({text:this.locale.getConstant("Add to Dictionary"),id:"_contextmenu_otherSuggestions_spellcheck_Add to Dictionary",iconCss:""}),i.push({text:this.locale.getConstant("Ignore Once"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore Once",iconCss:""}),i.push({text:this.locale.getConstant("Ignore All"),id:"_contextmenu_otherSuggestions_spellcheck_Ignore All",iconCss:""}),i.push({separator:!0,id:"_contextmenu_change_separator"}),i.push({text:this.locale.getConstant("Spelling"),id:kh,iconCss:"e-icons e-de-spellcheck",items:[]}),i.push({separator:!0,id:"_contextmenu_spelling_separator"}),i},e.prototype.showHideElements=function(e){if((0,a.isNullOrUndefined)(e))return!1;e.hideToolTip();var t=this.documentHelper.owner,i=t.element.id,n=document.getElementById(i+jd),r=document.getElementById(i+Gd),o=document.getElementById(i+Kd),s=document.getElementById(i+Xd),l=document.getElementById(i+Zd),d=document.getElementById(i+Yd),h=document.getElementById(i+Qd),c=document.getElementById(i+oh),p=document.getElementById(i+sh),u=document.getElementById(i+ah),g=document.getElementById(i+lh),m=document.getElementById(i+dh),f=document.getElementById(i+vh),v=document.getElementById(i+$d),y=document.getElementById(i+eh),w=document.getElementById(i+rh),b=document.getElementById(i+th),C=document.getElementById(i+ih),x=document.getElementById(i+nh),I=document.getElementById(i+xh),k=document.getElementById(i+Ih),F=document.getElementById(i+yh),P=document.getElementById(i+Jd),S=document.getElementById(i+Hh),T=document.getElementById(i+Eh),H=document.getElementById(i+Nh);this.documentHelper.owner.enableLockAndEdit?this.documentHelper.editRanges.containsKey(this.documentHelper.owner.currentUser)?(n.style.display="none",r.style.display="block",this.documentHelper.selection.isSelectionInEditRegion()?(0,a.classList)(r,["e-blankicon"],["e-disabled"]):(0,a.classList)(r,["e-disabled","e-blankicon"],[])):(n.style.display="block",this.documentHelper.owner.collaborativeEditingModule&&this.documentHelper.owner.collaborativeEditingModule.canLock()?(0,a.classList)(r,["e-disabled"],[]):(0,a.classList)(r,[],["e-disabled"]),r.style.display="none"):(n.style.display="none",r.style.display="none");var E=!1;s.style.display="none",l.style.display="none",l.nextSibling.style.display="none";var N=document.getElementById(i+Sh),W=document.getElementById(i+Th);v.style.display="none",S.style.display="none",S.nextSibling.style.display="none",c.previousSibling.style.display="none",y.style.display="none",b.style.display="none",w.style.display="none",C.style.display="none",C.nextSibling.style.display="none",x.style.display="none",f.style.display="none",F.style.display="none",c.style.display="none",p.style.display="none",T.style.display="none",H.style.display="none",g.style.display="none",m.style.display="none",u.style.display="none",d.style.display="none";var O=e.getHyperlinkField(),B=!1;N.style.display="none",W.style.display="none";var L=this.documentHelper.owner.selection.currentContentControl,D=this.documentHelper.owner.getImageContentControl();!(0,a.isNullOrUndefined)(L)&&L instanceof id&&!L.contentControlProperties.lockContentControl&&!this.documentHelper.owner.isReadOnlyMode||D instanceof id&&!D.contentControlProperties.lockContentControl&&"Picture"==D.contentControlProperties.type&&!this.documentHelper.owner.isReadOnlyMode?T.style.display="block":T.style.display="none",!this.documentHelper.owner.isReadOnlyMode&&!(0,a.isNullOrUndefined)(L)&&L instanceof id||D instanceof id&&"Picture"==D.contentControlProperties.type&&!this.documentHelper.owner.isReadOnlyMode?(H.style.display="block",H.nextSibling.style.display="block"):(H.style.display="none",H.nextSibling.style.display="none"),O instanceof _l&&e.isReferenceField(O)&&(B=!0),O instanceof _l&&B&&("FormFieldsOnly"===this.documentHelper.protectionType||!this.documentHelper.owner.isReadOnlyMode)&&(d.style.display="block"),h.style.display="none",I.style.display="none",k.style.display="none",k.nextSibling.style.display="none";var R=e.isEmpty;(0,a.classList)(s,R?["e-disabled"]:[],R?[]:["e-disabled"]),(0,a.classList)(o,R?["e-disabled"]:[],R?[]:["e-disabled"]);var M=this.documentHelper.owner.isReadOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment;if(P.style.display=M?"none":"block",this.documentHelper.isCommentOnlyMode&&(P.style.display="block"),P.nextSibling.style.display=M?"none":"block",t.isReadOnlyMode)return!(0,a.isNullOrUndefined)(O)&&O instanceof _l&&(y.style.display="block",b.style.display="block"),!0;if((this.viewer&&this.documentHelper.owner&&this.documentHelper.owner.commentReviewPane&&this.documentHelper.owner.commentReviewPane.commentPane.isEditMode||this.documentHelper.owner.selection.isinFootnote||this.documentHelper.owner.selection.isinEndnote?(0,a.classList)(P,["e-disabled"],[]):(0,a.classList)(P,[],["e-disabled"]),N.previousSibling.style.display="none",s.style.display="block",l.style.display="block",l.nextSibling.style.display="block",(0,a.classList)(g,["e-blankicon"],[]),(0,a.classList)(m,["e-blankicon"],[]),(0,a.classList)(h,["e-blankicon"],[]),(0,a.classList)(F,["e-blankicon"],[]),!a.Browser.isIE)&&JSON.parse(localStorage.getItem("ej_de_hidePasteAlert"))){var A=t.enableLocalPaste&&!(0,a.isNullOrUndefined)(t.editorModule.copiedData);(0,a.classList)(l,A?[]:["e-disabled"],A?["e-disabled"]:[])}if("TableOfContents"===e.contextType)d.style.display="block",h.style.display="block";else{var U=e.start,V=e.end;"List"===e.contextType&&"Bullet"!==t.selectionModule.getListLevel(U.paragraph).listLevelPattern&&(I.style.display="block",k.style.display="block",k.nextSibling.style.display="block"),U.paragraph.isInsideTable&&(!V.paragraph.isInsideTable||U.paragraph.associatedCell!==V.paragraph.associatedCell||e.isCellSelected(U.paragraph.associatedCell,U,V))?v.classList.add("e-disabled"):v.classList.contains("e-disabled")&&v.classList.remove("e-disabled"),O instanceof _l&&!B?(y.style.display="block",e.isImageField()||(b.style.display="block"),t.hyperlinkDialogModule&&(w.style.display="block"),C.style.display="block",C.nextSibling.style.display="block",E=!0,x.style.display="none"):t.hyperlinkDialogModule&&(v.style.display="block",c.previousSibling.style.display="block",E=!0),e.isFormField()&&this.documentHelper.owner.enableFormField&&(v.style.display="none",x.style.display="block"),O instanceof _l&&B&&(v.style.display="none",d.style.display="block")}return this.documentHelper.owner.selectionModule.start.paragraph.isInsideTable&&this.documentHelper.owner.selectionModule.end.paragraph.isInsideTable&&(t.tablePropertiesDialogModule&&(u.style.display="block"),g.style.display="block",m.style.display="block",this.documentHelper.owner.editorModule.canMergeCells()&&(f.style.display="block"),F.style.display=this.documentHelper.selection.isTableSelected()?"block":"none"),this.documentHelper.owner.fontDialogModule&&(c.style.display="block"),this.documentHelper.owner.paragraphDialogModule?p.style.display="block":E||this.documentHelper.owner.fontDialogModule||M||(P.nextSibling.style.display="none"),"Image"===e.contextType&&(c.style.display="none",p.style.display="none",c.previousSibling.style.display="none",C.nextSibling.style.display="none"),this.documentHelper.selection.hasRevisions()&&(N.previousSibling.style.display=this.documentHelper.owner.enableHeaderAndFooter?"none":"block",this.documentHelper.isTrackedOnlyMode?(N.style.display="none",W.style.display="none"):(N.style.display="block",W.style.display="block")),(this.documentHelper.selection.isinFootnote||this.documentHelper.selection.isinEndnote)&&(S.style.display="block"),!0},e.prototype.destroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0,this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.menuItems=[],this.customMenuItems=[],this.ids=[]},e.prototype.componentDestroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0,this.contextMenu&&this.contextMenu.parentElement&&(this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.menuItems=[],this.menuItems=void 0,this.customMenuItems=[],this.customMenuItems=void 0,this.ids=[],this.ids=void 0,this.customItems=[],this.customItems=void 0,this.spellContextItems=[],this.spellContextItems=void 0,this.documentHelper=void 0},e}(),Oh=function(){function e(e){var t=this;this.isNewComment=!1,this.isUserClosed=!1,this.postReply=!1,this.selectedTab=0,this.onTabSelection=function(e){e.preventFocus=!0,t.selectedTab=e.selectedIndex,1===t.selectedTab?t.owner.trackChangesPane.updateHeight():t.commentPane.updateHeight(),setTimeout((function(){t.owner&&t.owner.resize()}),10)},this.owner=e;var i=new a.L10n("documenteditor",this.owner.defaultLocale);i.setLocale(this.owner.locale),this.initReviewPane(i),this.parentPaneElement.style.display="none"}return Object.defineProperty(e.prototype,"previousSelectedComment",{get:function(){return this.previousSelectedCommentInt},set:function(e){if(!(0,a.isNullOrUndefined)(e)&&e!==this.previousSelectedCommentInt&&this.commentPane.comments.containsKey(e)){var t=this.commentPane.getCommentStart(e).commentMark;t&&((0,a.classList)(t,[],["e-de-cmt-mark-selected"]),this.commentPane.removeSelectionMark("e-de-cmt-selection"),this.commentPane.removeSelectionMark("e-de-cmt-mark-selected"));var i=this.commentPane.comments.get(e);i.hideDrawer();for(var n=0;n<e.replyComments.length;n++)(i=this.commentPane.comments.get(e.replyComments[n]))&&(i.hideDrawer(),i.hideMenuItems())}this.previousSelectedCommentInt=e},enumerable:!0,configurable:!0}),e.prototype.selectReviewTab=function(e){"Changes"===e?this.reviewTab.select(1):this.reviewTab.select(0)},e.prototype.showHidePane=function(e,t){this.parentPaneElement&&(this.updateTabHeaderWidth(),e?(this.parentPaneElement.style.display="block","Changes"===t&&this.owner.showRevisions?(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:!0}),this.reviewTab.select(1)):(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible,isUserClosed:!1}),this.reviewTab.select(0)),this.owner.trackChangesPane.updateTrackChanges(this.owner.showRevisions),this.commentPane.updateCommentStatus()):this.parentPaneElement.style.display="none",this.owner.showRevisions||(this.owner.trackChangesPane.isChangesTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.reviewTab.hideTab(1,!0)),this.owner.showComments||(this.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:this.isCommentTabVisible,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.reviewTab.hideTab(0,!0))),e&&(this.enableDisableItems(),this.commentPane.updateHeight()),this.owner&&(this.owner.resize(),this.owner.enableAutoFocus&&this.owner.documentHelper.updateFocus())},e.prototype.reviewPaneHelper=function(e){var t=this;if((0,a.isNullOrUndefined)(e.isUserClosed)){if(this.isUserClosed)return}else{if(e.isUserClosed===this.isUserClosed)return;this.isUserClosed=e.isUserClosed,this.owner&&setTimeout((function(){t.owner&&t.owner.resize()}),10)}(0,a.isNullOrUndefined)(e.comment)&&(0,a.isNullOrUndefined)(e.changes)||(e.comment||e.changes?("none"===this.parentPaneElement.style.display&&(this.parentPaneElement.style.display="block"),this.owner&&setTimeout((function(){t.owner&&t.owner.resize()}),10)):(this.parentPaneElement.style.display="none",this.owner&&setTimeout((function(){t.owner&&t.owner.resize()}),10)))},e.prototype.updateTabHeaderWidth=function(){var e=this.reviewTab.getRootElement().getElementsByClassName("e-tab-wrap");e[0].style.padding="0 8px",e[1].style.padding="0 8px"},e.prototype.initReviewPane=function(e){var t=this.owner.documentHelper.optionsPaneContainer;t.style.display="flex",this.initPaneHeader(e),t.appendChild(this.addReviewTab(e)),this.initCommentPane(),this.owner.on("reviewPane",this.reviewPaneHelper,this)},e.prototype.addReviewTab=function(e){var t=(0,a.createElement)("div",{innerHTML:e.getConstant("Comments")}),i=(0,a.createElement)("div",{innerHTML:e.getConstant("Changes")});this.parentPaneElement=(0,a.createElement)("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-review-pane"}),this.element=(0,a.createElement)("div",{className:"e-de-property-tab",id:this.owner.element.id+"Review_Tab"});var n=[{header:{text:t},content:this.reviewPane},{header:{text:i}}];return this.reviewTab=new ua.Tab({items:n,selected:this.onTabSelection,animation:{previous:{effect:"None"},next:{effect:"None"}}}),this.reviewTab.appendTo(this.element),this.owner.enableRtl&&(this.reviewTab.enableRtl=!0),this.reviewTab.enablePersistence=!0,this.parentPaneElement.appendChild(this.element),this.parentPaneElement},e.prototype.initPaneHeader=function(e){return this.headerContainer=(0,a.createElement)("div"),this.reviewPane=(0,a.createElement)("div",{className:"e-de-cmt-pane"}),this.owner.enableRtl&&(0,a.classList)(this.reviewPane,["e-rtl"],[]),this.headerContainer.appendChild(this.initToolbar(e)),this.reviewPane.appendChild(this.headerContainer),this.reviewPane.style.display="block",this.reviewPane},e.prototype.closePane=function(){if(this.commentPane&&this.commentPane.isEditMode)if(!(0,a.isNullOrUndefined)(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""===this.commentPane.currentEditingComment.replyViewTextBox.innerText)this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelReply(),this.owner.showComments=!1;else if(this.isNewComment||!(0,a.isNullOrUndefined)(this.commentPane.currentEditingComment)&&this.commentPane.isInsertingReply&&""!==this.commentPane.currentEditingComment.replyViewTextBox.innerText||!(0,a.isNullOrUndefined)(this.commentPane.currentEditingComment)&&!this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment.textArea.innerText!==this.commentPane.currentEditingComment.comment.text){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.confirmDialog=el.DialogUtility.confirm({title:e.getConstant("Un-posted comments"),content:e.getConstant("Discard Comment"),okButton:{text:e.getConstant("Discard"),click:this.discardButtonClick.bind(this)},cancelButton:{text:e.getConstant("Cancel"),click:this.closeDialogUtils.bind(this)},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"center",Y:"center"}})}else this.owner.documentHelper.currentSelectedComment=void 0,this.commentPane.currentEditingComment.cancelEditing(),this.owner.showComments=!1;else this.owner.showComments=!1,this.owner.documentHelper.currentSelectedComment=void 0,this.owner.documentHelper.currentSelectedRevision=void 0,this.owner.notify("reviewPane",{changes:!1,comment:!1,isUserClosed:!0})},e.prototype.discardButtonClick=function(){if(this.commentPane.currentEditingComment){this.isNewComment;this.commentPane.currentEditingComment&&this.commentPane.isInsertingReply?this.commentPane.currentEditingComment.cancelReply():this.commentPane.currentEditingComment.cancelEditing(),this.owner.documentHelper.currentSelectedComment=void 0,this.closeDialogUtils(),this.owner.showComments=!1}},e.prototype.closeDialogUtils=function(){this.confirmDialog.close(),this.confirmDialog=void 0},e.prototype.initToolbar=function(e){return this.toolbarElement=(0,a.createElement)("div"),this.toolbar=new ua.Toolbar({items:[{prefixIcon:"e-de-new-cmt e-de-cmt-tbr",tooltipText:e.getConstant("New Comment"),text:e.getConstant("New Comment"),click:this.insertComment.bind(this)},{prefixIcon:"e-de-nav-left-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Previous Comment"),click:this.navigatePreviousComment.bind(this)},{prefixIcon:"e-de-nav-right-arrow e-de-cmt-tbr",align:"Right",tooltipText:e.getConstant("Next Comment"),click:this.navigateNextComment.bind(this)}],enableRtl:this.owner.enableRtl}),this.toolbar.appendTo(this.toolbarElement),this.toolbarElement},e.prototype.insertComment=function(){this.owner&&this.owner.editorModule&&(this.owner.editorModule.isUserInsert=!0,this.owner.editorModule.insertComment(""),this.owner.editorModule.isUserInsert=!1)},e.prototype.addComment=function(e,t,i){(this.isNewComment=t,this.owner.documentHelper.currentSelectedComment=e,this.commentPane.insertComment(e),this.selectReviewTab("Comments"),t)||(this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem());i&&this.selectComment(e)},e.prototype.deleteComment=function(e){this.commentPane&&this.commentPane.deleteComment(e)},e.prototype.selectComment=function(e){this.commentPane.isEditMode||(e.isReply&&(e=e.ownerComment),this.owner&&this.owner.viewer&&this.owner.documentHelper.currentSelectedComment!==e&&(this.owner.documentHelper.currentSelectedComment=e),this.commentPane.selectComment(e))},e.prototype.resolveComment=function(e){this.commentPane.resolveComment(e)},e.prototype.reopenComment=function(e){this.commentPane.reopenComment(e)},e.prototype.addReply=function(e,t,i){(this.isNewComment=t,this.postReply=!0,this.commentPane.insertReply(e),this.postReply=!1,t)||(this.commentPane.comments.get(e).cancelEditing(),this.enableDisableToolbarItem());i&&this.selectComment(e.ownerComment)},e.prototype.navigatePreviousComment=function(){this.owner&&this.owner.editorModule&&this.owner.selectionModule.navigatePreviousComment()},e.prototype.navigateNextComment=function(){this.owner&&this.owner.editorModule&&this.owner.selectionModule.navigateNextComment()},e.prototype.enableDisableItems=function(){this.enableDisableToolbarItem();for(var e=this.commentPane.comments.keys,t=0;t<e.length;t++){var i=this.commentPane.comments.get(e[t]);this.owner.isReadOnly?((0,a.isNullOrUndefined)(i.replyViewTextBox)||(i.replyViewTextBox.style.display="none"),i.menuBar.style.display="none",i.resolveView&&(i.resolveView.style.display="none")):((0,a.isNullOrUndefined)(i.replyViewTextBox)||(i.replyViewTextBox.style.display="block"),i.menuBar.style.display="block",i.resolveView&&(i.resolveView.style.display=""))}},e.prototype.enableDisableToolbarItem=function(){if(this.toolbar){var e=!0;this.commentPane.isEditMode&&(e=!this.commentPane.isEditMode),this.owner.isReadOnly&&(e=!this.owner.isReadOnly);var t=this.toolbar.element.querySelectorAll(".e-de-cmt-tbr");this.toolbar.enableItems(t[0].parentElement.parentElement,e),e&&this.owner&&this.owner.viewer&&(e=!(0===this.owner.documentHelper.comments.length)),this.toolbar.enableItems(t[1].parentElement.parentElement,e),this.toolbar.enableItems(t[2].parentElement.parentElement,e)}},e.prototype.initCommentPane=function(){this.commentPane=new Bh(this.owner,this),this.commentPane.initCommentPane()},e.prototype.layoutComments=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(this.isUnreferredComment(i))e.splice(t,1),t--;else{for(var n=0;n<i.replyComments.length;n++)this.isUnreferredComment(i.replyComments[n])&&(i.replyComments.splice(n,1),n--);this.commentPane.addComment(i)}}},e.prototype.isUnreferredComment=function(e){return!(!(0,a.isNullOrUndefined)(e.commentStart)&&!(0,a.isNullOrUndefined)(e.commentEnd))},e.prototype.clear=function(){this.previousSelectedCommentInt=void 0,this.isNewComment=!1,this.isUserClosed=!1,this.isNewComment=!1,this.commentPane.clear()},e.prototype.discardComment=function(e){e&&(this.owner.editorHistoryModule?(this.owner.editorHistoryModule.undoStack.length>0&&"InsertComment"===this.owner.editorHistoryModule.undoStack[this.owner.editorHistoryModule.undoStack.length-1].action&&(this.owner.editorHistoryModule.undo(),this.owner.editorHistoryModule.redoStack.pop()),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.deleteCommentInternal(e),this.owner.editorModule.isSkipOperationsBuild=!1):this.owner.editorModule&&this.owner.editorModule.deleteCommentInternal(e))},e.prototype.destroy=function(){this.commentPane&&this.commentPane.destroy(),this.commentPane=void 0,this.toolbar&&this.toolbar.destroy(),this.toolbar=void 0,this.toolbarElement&&this.toolbarElement.parentElement&&this.toolbarElement.parentElement.removeChild(this.toolbarElement),this.toolbarElement=void 0,this.headerContainer&&this.headerContainer.parentElement&&this.headerContainer.parentElement.removeChild(this.headerContainer),this.headerContainer=void 0,this.previousSelectedCommentInt=void 0,this.reviewPane&&this.reviewPane.parentElement&&this.reviewPane.parentElement.removeChild(this.reviewPane),this.owner.isDestroyed||this.owner.off("reviewPane",this.reviewPaneHelper),(0,a.isNullOrUndefined)(this.reviewTab)||this.reviewTab.destroy(),this.reviewTab=void 0,(0,a.isNullOrUndefined)(this.confirmDialog)||this.confirmDialog.destroy(),this.confirmDialog=void 0,(0,a.isNullOrUndefined)(this.previousSelectedCommentInt)||this.previousSelectedCommentInt.destroy(),this.previousSelectedCommentInt=void 0,this.reviewPane&&(this.reviewPane.innerHTML="",this.reviewPane.parentElement&&this.reviewPane.parentElement.removeChild(this.reviewPane)),this.reviewPane=void 0,this.parentPaneElement&&(this.parentPaneElement.innerHTML="",this.parentPaneElement.parentElement&&this.parentPaneElement.parentElement.removeChild(this.parentPaneElement)),this.parentPaneElement=void 0,this.owner=void 0},e}(),Bh=function(){function e(e,t){this.isEditModeInternal=!1,this.isInsertingReply=!1,this.owner=e,this.parentPane=t,this.parent=t.reviewPane,this.comments=new l}return Object.defineProperty(e.prototype,"isEditMode",{get:function(){return this.isEditModeInternal},set:function(e){this.isEditModeInternal=e;for(var t=this.comments.keys,i=0;i<t.length;i++){var n=this.comments.get(t[i]);e?n.menuBar.style.display="none":n.comment.isReply||(n.menuBar.style.display="block")}this.parentPane&&this.parentPane.enableDisableToolbarItem(),this.owner&&(this.isEditModeInternal?this.owner.trigger(E):this.owner.trigger(N))},enumerable:!0,configurable:!0}),e.prototype.initCommentPane=function(){this.commentPane=(0,a.createElement)("div",{className:"e-de-cmt-container e-de-scrollbar-hide"});var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.noCommentIndicator=(0,a.createElement)("div",{className:"e-de-cmt-no-cmt",innerHTML:e.getConstant("No comments in this document")}),this.commentPane.appendChild(this.noCommentIndicator),this.parent.appendChild(this.commentPane)},e.prototype.addComment=function(e){var t=new Lh(this.owner,this,e),i=t.layoutComment(!1);this.comments.add(e,t),this.commentPane.appendChild(i);for(var n=0;n<e.replyComments.length;n++){var r=new Lh(this.owner,this,e.replyComments[n]);this.comments.add(e.replyComments[n],r),i.insertBefore(r.layoutComment(!0),t.replyViewContainer)}this.updateCommentStatus(),t.hideDrawer()},e.prototype.updateHeight=function(){var e=this.parentPane.reviewTab.getRootElement().getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height;this.commentPane.style.height=this.parentPane.parentPaneElement.clientHeight-this.parentPane.headerContainer.clientHeight-e+"px"},e.prototype.insertReply=function(e){var t=e.ownerComment,i=this.comments.get(t),n=new Lh(this.owner,this,e);this.comments.add(e,n);var r=n.layoutComment(!0),o=t.replyComments.indexOf(e);if(o===t.replyComments.length-1)i.parentElement.insertBefore(r,i.replyViewContainer);else{var s=t.replyComments[o+1];i.parentElement.insertBefore(r,this.comments.get(s).parentElement)}n.editComment()},e.prototype.insertComment=function(e){var t=new Lh(this.owner,this,e),i=t.layoutComment(!1);if(this.comments.add(e,t),this.owner.documentHelper.comments.indexOf(e)===this.owner.documentHelper.comments.length-1)this.commentPane.appendChild(i);else{var n=this.owner.documentHelper.comments.indexOf(e),r=this.comments.get(this.owner.documentHelper.comments[n+1]).parentElement;this.commentPane.insertBefore(i,r),i.focus()}this.updateCommentStatus(),t.editComment()},e.prototype.removeSelectionMark=function(e){if(this.parent)for(var t=this.parent.getElementsByClassName(e),i=0;i<t.length;i++)(0,a.classList)(t[i],[],[e])},e.prototype.selectComment=function(e){if(this.removeSelectionMark("e-de-cmt-selection"),e.isReply&&(e=e.ownerComment),e){this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible});var t=this.comments.get(e),i=t.parentElement;i&&((0,a.classList)(i,["e-de-cmt-selection"],[]),i.focus());var n=this.getCommentStart(e);n.commentMark||n.renderCommentMark(),(0,a.classList)(n.commentMark,["e-de-cmt-mark-selected"],[]),t.showDrawer()}},e.prototype.getCommentStart=function(e){var t=new a.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.owner.locale);var i=void 0;return e&&e.commentStart&&(i=e.commentStart),void 0!==i.commentMark&&(i.commentMark.title=t.getConstant("Click to see this comment")),this.getFirstCommentInLine(i)},e.prototype.getFirstCommentInLine=function(e){for(var t=0;t<e.line.children.length;t++){var i=e.line.children[t];if(i instanceof Bd&&0===i.commentType)return i}return e},e.prototype.deleteComment=function(e){var t=this.comments.get(e);if(!(0,a.isNullOrUndefined)(t)){(0,a.isNullOrUndefined)(this.currentEditingComment)||t.comment.commentId!=this.currentEditingComment.comment.commentId||(this.isEditMode=!1,this.currentEditingComment=void 0),t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.removeChild(t.parentElement);for(var i=0;i<e.replyComments.length;i++){var n=e.replyComments[i];this.comments.containsKey(n)&&this.comments.remove(n)}this.comments.remove(e),t.destroy()}this.updateCommentStatus()},e.prototype.resolveComment=function(e){var t=this.comments.get(e);t&&t.resolveComment()},e.prototype.reopenComment=function(e){var t=this.comments.get(e);t&&t.reopenComment()},e.prototype.updateCommentStatus=function(){0===this.owner.documentHelper.comments.length?(this.noCommentIndicator.parentElement||this.commentPane.appendChild(this.noCommentIndicator),this.noCommentIndicator.style.display="block",this.parentPane.isCommentTabVisible=!1,this.owner.notify("reviewPane",{comment:!1,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0)):this.owner.showComments&&(this.parentPane.isCommentTabVisible=!0,this.noCommentIndicator.style.display="none",this.owner.notify("reviewPane",{comment:!0,changes:this.owner.trackChangesPane.isChangesTabVisible}),this.parentPane.reviewTab.hideTab(0,!1)),this.parentPane&&this.parentPane.enableDisableToolbarItem()},e.prototype.clear=function(){this.isEditMode=!1,this.currentEditingComment=void 0,this.isInsertingReply=!1,this.removeChildElements(),this.commentPane.innerHTML="",this.updateCommentStatus()},e.prototype.removeChildElements=function(){for(var e=this.comments.keys,t=0;t<e.length;t++)this.comments.get(e[t]).destroy();this.comments.clear()},e.prototype.destroy=function(){this.removeChildElements(),this.noCommentIndicator&&this.noCommentIndicator&&this.noCommentIndicator.parentElement.removeChild(this.noCommentIndicator),this.noCommentIndicator=void 0,this.commentPane&&(this.commentPane.innerHTML="",this.commentPane.parentElement&&this.commentPane.parentElement.removeChild(this.commentPane)),this.commentPane=void 0,this.parent&&(this.parent.innerHTML="",this.parent.parentElement&&this.parent.parentElement.removeChild(this.parent)),this.parent=void 0,this.parentPane=void 0,this.currentEditingComment=void 0,this.owner=void 0},e}(),Lh=function(){function e(e,t,i){this.isReply=!1,this.isDrawerExpand=!1,this.itemData=[],this.owner=e,this.comment=i,this.commentPane=t}return e.prototype.layoutComment=function(e){this.isReply=e;var t="e-de-cmt-sub-container";e&&(t+=" e-de-cmt-reply");var i=new a.L10n("documenteditor",this.owner.defaultLocale);return i.setLocale(this.owner.locale),this.parentElement=(0,a.createElement)("div",{className:t}),this.initCommentHeader(i),this.initCommentView(i),this.initDateView(),this.comment.isReply?this.menuBar.style.display="none":(this.parentElement.tabIndex=0,this.initReplyView(i),this.initResolveOption(i),this.initDrawer(),this.comment.isResolved&&this.resolveComment()),this.commentView.addEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.addEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)),this.parentElement},e.prototype.initCommentHeader=function(e){var t=(0,a.createElement)("div",{className:"e-de-cmt-view"});this.resolveDiv=(0,a.createElement)("div",{className:"e-de-cmt-view"});var i=(0,a.createElement)("div",{className:"e-de-cmt-view"}),n=(0,a.createElement)("div",{className:"e-de-resolve-mark"}),r=(0,a.createElement)("span",{className:"e-de e-icons e-check"}),o=(0,a.createElement)("span",{className:""});o.innerHTML="Resolved",r.style.display="inline-block",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.width="20px",n.style.height="20px",n.style.borderRadius="100%",n.style.marginRight="6px",n.appendChild(r),i.appendChild(n),i.appendChild(o),this.resolveDiv.appendChild(i),i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",this.resolveDiv.style.display="none";var s=(0,a.createElement)("div",{className:"e-de-cmt-author"});s.style.marginTop="8px";var l=(0,a.createElement)("div",{className:"e-de-cmt-author-name"});l.textContent=this.comment.author,(0,a.isNullOrUndefined)(this.comment.author)||(s.style.display="flex",this.owner.documentHelper.getAvatar(s,l,this.comment,void 0)),this.menuBar=(0,a.createElement)("button",{className:"e-de-cp-option",attrs:{type:"button"}});var d=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],h=new pl.DropDownButton({items:this.isReply?d.splice(0,2):d,select:this.userOptionSelectEvent.bind(this),iconCss:"e-de-menu-icon",cssClass:"e-caret-hide",enableRtl:this.owner.enableRtl});this.menuBar.title=e.getConstant("More Options")+"...",h.appendTo(this.menuBar),s.appendChild(this.menuBar),this.dropDownButton=h,t.appendChild(s),this.commentView=t,this.parentElement.appendChild(t),t.addEventListener("click",this.selectComment.bind(this))},e.prototype.selectComment=function(){if(this.commentPane)if(this.commentPane.isEditMode){if(this.commentPane.isEditMode&&this.commentPane.isInsertingReply&&this.commentPane.currentEditingComment&&""===this.commentPane.currentEditingComment.replyViewTextBox.innerText){var e=this.comment;if(e&&e.isReply&&(e=this.comment.ownerComment),e&&this.owner.documentHelper.currentSelectedComment===e)return;this.commentPane.currentEditingComment.cancelReply(),this.owner.selectionModule.selectComment(this.comment)}}else this.owner.selectionModule.selectComment(this.comment)},e.prototype.initCommentView=function(e){this.commentText=(0,a.createElement)("div",{className:"e-de-cmt-readonly e-mention"}),this.commentText.innerHTML=this.comment.text,this.commentView.appendChild(this.commentText),this.initEditView(e)},e.prototype.initEditView=function(e){var t=this;this.textAreaContainer=(0,a.createElement)("div",{styles:"display:none"}),this.textArea=(0,a.createElement)("div",{className:"e-de-cmt-textarea e-input"}),this.textArea.addEventListener("paste",(function(e){t.updatePastedText(e,t.textArea)})),this.textArea.style.borderWidth="0 0 2px 0",this.textArea.setAttribute("placeholder",e.getConstant("Type your comment here")),this.editMention=new al.Mention({dataSource:this.owner.documentEditorSettings.mentionSettings.dataSource,fields:this.owner.documentEditorSettings.mentionSettings.fields,select:this.onSelect.bind(this)}),this.textArea.innerHTML=this.comment.text,this.textArea.addEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.addEventListener("keyup",this.enableDisablePostButton.bind(this));var i=(0,a.createElement)("div",{className:"e-de-cmt-action-button"}),n=(0,a.createElement)("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}});this.postButton=new tl.Button({cssClass:"e-btn e-flat e-primary e-de-overlay",iconCss:"e-de-cmt-post",disabled:!0},n),n.addEventListener("click",this.postComment.bind(this)),n.title=e.getConstant("Post"),n.setAttribute("aria-label",e.getConstant("Post"));var r=(0,a.createElement)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});this.cancelButton=new tl.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},r),r.title=e.getConstant("Cancel"),r.setAttribute("aria-label",e.getConstant("Cancel")),r.addEventListener("click",this.cancelEditing.bind(this)),i.appendChild(n),i.appendChild(r),i.style.marginTop="8px",this.textAreaContainer.appendChild(this.textArea),this.textAreaContainer.appendChild(i),this.commentView.appendChild(this.textAreaContainer),this.editMention.appendTo(this.textArea)},e.prototype.updatePastedText=function(e,t){e.preventDefault();var i=e.clipboardData.getData("text/plain");if(i){var n=this.convertToHtml(i);t.innerHTML=t.innerHTML+n}this.enableDisableReplyPostButton()},e.prototype.convertToHtml=function(e){return e.split(/(?:\r?\n|\r)/).map((function(e){return e?"<div>"+e+"</div>":"<div><br></div>"})).join("")},e.prototype.onSelect=function(e){this.owner.documentEditorSettings.mentionSettings.fields;var t={},i=e.itemData;t.text=i[this.owner.documentEditorSettings.mentionSettings.fields.text],t.value=i[this.owner.documentEditorSettings.mentionSettings.fields.value],this.itemData.push(t)},e.prototype.initDateView=function(){this.commentDate=(0,a.createElement)("div",{className:"e-de-cmt-date"}),this.commentDate.innerText=Pa.getModifiedDate(this.comment.date),this.commentView.appendChild(this.commentDate)},e.prototype.initDrawer=function(){this.drawerElement=(0,a.createElement)("div",{styles:"display:none;",className:"e-de-cmt-drawer-cnt"});var e=(0,a.createElement)("div",{className:"e-de-cmt-drawer"}),t=(0,a.createElement)("span");e.appendChild(t),this.drawerElement.appendChild(e),this.drawerSpanElement=t,this.drawerAction=e,this.drawerAction.addEventListener("click",this.showOrHideDrawer.bind(this)),this.parentElement.appendChild(this.drawerElement)},e.prototype.initReplyView=function(e){var t=this;this.replyViewContainer=(0,a.createElement)("div",{className:"e-de-cmt-rply-view"}),this.commentPane.parentPane.isNewComment&&(this.replyViewContainer.style.display="none"),this.replyViewTextBox=(0,a.createElement)("div",{className:"e-de-cmt-textarea e-input"}),this.replyViewTextBox.addEventListener("paste",(function(e){t.updatePastedText(e,t.replyViewTextBox)})),this.replyViewTextBox.style.borderWidth="0 0 1px 0",this.replyViewTextBox.setAttribute("placeholder",e.getConstant("Reply")),this.replyViewTextBox.addEventListener("click",this.enableReplyView.bind(this)),this.replyViewTextBox.addEventListener("keydown",this.updateReplyTextAreaHeight.bind(this)),this.replyViewTextBox.addEventListener("keyup",this.enableDisableReplyPostButton.bind(this));var i=(0,a.createElement)("div",{styles:"display:none",className:"e-de-cmt-action-button"}),n=(0,a.createElement)("button",{className:"e-de-cmt-post-btn e-de-overlay e-btn e-flat",attrs:{type:"button"}});this.replyPostButton=new tl.Button({cssClass:"e-btn e-flat e-primary",iconCss:"e-de-cmt-post",disabled:!0},n),this.replyMention=new al.Mention({dataSource:this.owner.documentEditorSettings.mentionSettings.dataSource,fields:this.owner.documentEditorSettings.mentionSettings.fields,select:this.onSelect.bind(this)}),n.addEventListener("click",this.postReply.bind(this)),n.title=e.getConstant("Post");var r=(0,a.createElement)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});r.setAttribute("aria-label",e.getConstant("Cancel")),this.replyCancelButton=new tl.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-cancel"},r),r.addEventListener("click",this.cancelReply.bind(this)),r.title=e.getConstant("Cancel"),i.appendChild(n),i.appendChild(r),i.style.marginTop="8px",this.replyFooter=i,this.replyViewContainer.appendChild(this.replyViewTextBox),this.replyViewContainer.appendChild(i),this.parentElement.appendChild(this.replyViewContainer),this.replyMention.appendTo(this.replyViewTextBox)},e.prototype.initResolveOption=function(e){var t=(0,a.createElement)("div",{className:"e-de-cmt-resolve-btn"}),i=(0,a.createElement)("div",{className:"e-de-cmt-resolve-btn"}),n=(0,a.createElement)("div",{className:"e-de-cmt-resolve-btn"}),r=(0,a.createElement)("button",{className:"e-de-cmt-post-btn e-btn e-flat",attrs:{type:"button"}});this.reopenButton=new tl.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-reopen"},r),r.title=e.getConstant("Reopen"),r.setAttribute("aria-label",e.getConstant("Reopen")),r.addEventListener("click",this.reopenButtonClick.bind(this));var o=(0,a.createElement)("button",{className:"e-de-cmt-cancel-btn e-btn e-flat",attrs:{type:"button"}});o.title=e.getConstant("Delete"),o.setAttribute("aria-label",e.getConstant("Delete")),this.deleteButton=new tl.Button({cssClass:"e-btn e-flat",iconCss:"e-de-cmt-delete"},o),o.addEventListener("click",this.deleteComment.bind(this)),t.appendChild(r),t.appendChild(o),i.appendChild(this.resolveDiv),n.appendChild(r),n.appendChild(o),t.appendChild(i),i.appendChild(n),i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="center",n.style.display="flex",n.style.justifyContent="center",n.style.alignItems="center",n.style.marginTop="0px",this.resolveView=t,this.parentElement.appendChild(t)},e.prototype.reopenButtonClick=function(){this.owner.editorModule.reopenComment(this.comment)},e.prototype.deleteComment=function(){var e={author:this.comment.author,cancel:!1};this.owner.trigger(O,e);var t={author:this.comment.author,cancel:e.cancel,type:"Delete",mentions:this.comment.mentions};this.owner.trigger(W,t),t.cancel||this.owner.editorModule.deleteCommentInternal(this.comment)},e.prototype.updateReplyTextAreaHeight=function(e){var t=this;e&&this.preventKeyboardShortcuts(e),setTimeout((function(){if(!(0,a.isNullOrUndefined)(t.replyViewTextBox)){t.replyViewTextBox.style.height="auto";var e=t.replyViewTextBox.scrollHeight;t.replyViewTextBox.style.height=e+"px"}}))},e.prototype.preventKeyboardShortcuts=function(e){var t=e.which||e.keyCode,i=!(!e.ctrlKey&&!e.metaKey)||17===t,n=e.shiftKey?e.shiftKey:16===t,r=e.altKey?e.altKey:18===t,o=!1;(i&&66===t||i&&73===t||i&&85===t||r&&n&&53===t||i&&190===t||i&&188===t||i&&n&&76===t||i&&n&&55===t||i&&220===t||i&&n&&76===t||i&&n&&69===t||i&&n&&82===t||i&&n&&74===t||n&&9===t||i&&r&&t>=49&&t<=54||i&&n&&81===t)&&(o=!0),o&&(e.preventDefault(),e.stopPropagation())},e.prototype.enableDisableReplyPostButton=function(){this.replyPostButton.disabled=""===this.replyViewTextBox.innerText,this.replyPostButton.disabled?(0,a.classList)(this.replyPostButton.element,["e-de-overlay"],[]):this.replyPostButton.element.classList.contains("e-de-overlay")&&(0,a.classList)(this.replyPostButton.element,[],["e-de-overlay"])},e.prototype.enableReplyView=function(){var e=this;if(!this.commentPane.isEditMode){var t={author:this.comment.author,cancel:!1,type:"Reply",mentions:this.comment.mentions};this.owner.trigger(W,t),t.cancel&&"Reply"===t.type||(this.commentPane.currentEditingComment=this,this.commentPane.isInsertingReply=!0,this.owner.documentHelper.currentSelectedComment!==this.comment&&this.owner.selectionModule.selectComment(this.comment),this.commentPane.isEditMode=!0,this.replyFooter.style.display="block",setTimeout((function(){e.replyViewTextBox.focus()})))}},e.prototype.postReply=function(){var e=this.replyViewTextBox.innerText;this.cancelReply(),this.updateReplyTextAreaHeight(),this.owner.editorModule.replyComment(this.comment,e,this.itemData),this.itemData&&(this.itemData=[]),this.owner.editorModule.isSkipOperationsBuild||this.owner.editorModule.isRemoteAction||this.owner.fireContentChange(),this.owner.editorModule.isSkipOperationsBuild=!1},e.prototype.cancelReply=function(){this.commentPane.currentEditingComment=void 0,this.commentPane.isInsertingReply=!0,this.commentPane.isEditMode=!1,this.replyPostButton.disabled=!0,this.replyViewTextBox.innerText="",this.replyFooter.style.display="none"},e.prototype.updateTextAreaHeight=function(e){var t=this;e&&this.preventKeyboardShortcuts(e),setTimeout((function(){if(!(0,a.isNullOrUndefined)(t.textArea)){t.textArea.style.height="auto";var e=t.textArea.scrollHeight;t.textArea.style.height=e+"px"}}))},e.prototype.showMenuItems=function(){this.comment.isReply&&!this.owner.isReadOnly&&(this.commentPane.isEditMode||(0,a.isNullOrUndefined)(this.comment)||this.comment.isResolved||(this.menuBar.style.display="block"));var e=this.commentPane.getCommentStart(this.comment);(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.commentMark)||e.commentMark.classList.add("e-de-cmt-mark-hover")},e.prototype.hideMenuItemOnMouseLeave=function(){if(this.comment.isReply&&this.owner.documentHelper.currentSelectedComment!==this.comment.ownerComment&&this.hideMenuItems(),this.commentPane){var e=this.commentPane.getCommentStart(this.comment);(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.commentMark)||e.commentMark.classList.remove("e-de-cmt-mark-hover")}},e.prototype.hideMenuItems=function(){this.menuBar.style.display="none"},e.prototype.enableDisablePostButton=function(){this.postButton.disabled=""===this.textArea.innerText,this.postButton.disabled?(0,a.classList)(this.postButton.element,["e-de-overlay"],[]):this.postButton.element.classList.contains("e-de-overlay")&&(0,a.classList)(this.postButton.element,[],["e-de-overlay"])},e.prototype.editComment=function(){var e=this;if(!(0,a.isNullOrUndefined)(this.commentPane.parentPane)&&!this.commentPane.parentPane.postReply){var t={author:this.comment.author,cancel:!1,type:"Edit",mentions:this.comment.mentions};if(this.owner.trigger(W,t),t.cancel&&"Edit"===t.type)return}this.commentPane.currentEditingComment=this,this.commentPane.isInsertingReply=!1,this.commentPane.isEditMode=!0,this.commentText.style.display="none",this.textAreaContainer.style.display="block",this.commentDate.style.display="none",this.menuBar.style.display="none",this.updateTextAreaHeight(),setTimeout((function(){e.textArea&&e.textArea.focus()}))},e.prototype.resolveComment=function(){(0,a.classList)(this.parentElement,["e-de-cmt-resolved"],[]),this.resolveDiv.style.display="inline";var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Reopen")},{text:e.getConstant("Delete")}]},e.prototype.reopenComment=function(){(0,a.classList)(this.parentElement,[],["e-de-cmt-resolved"]),this.resolveDiv.style.display="none";var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.dropDownButton.items=[{text:e.getConstant("Edit")},{text:e.getConstant("Delete")},{text:e.getConstant("Reply")},{text:e.getConstant("Resolve")}],this.showDrawer()},e.prototype.postComment=function(){this.comment.isPosted=!0,this.itemData&&(this.comment.mentions=this.itemData,this.itemData=[]);var e={author:this.comment.author,cancel:!1,type:"Post",text:this.textArea.innerText,mentions:this.comment.mentions};if(this.owner.trigger(W,e),!e.cancel||"Post"!==e.type){var t=this.textArea.innerHTML;if(this.owner.editorModule&&""!=this.comment.text&&this.comment.text!=t){this.owner.editorModule.initHistory("EditComment");var i={commentId:this.comment.commentId,text:this.comment.text};this.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(i),this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(this.comment),this.owner.editorHistoryModule.updateHistory()}this.commentText.innerHTML=t,this.comment.text=t,this.showCommentView(),this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1),(0,a.isNullOrUndefined)(this.replyViewContainer)||(this.replyViewContainer.style.display=""),this.owner.editorModule.isSkipOperationsBuild||this.owner.editorModule.isRemoteAction||this.owner.fireContentChange()}},e.prototype.showCommentView=function(){this.commentPane.isEditMode=!1,this.textAreaContainer.style.display="none",this.commentText.style.display="block",this.commentDate.style.display="block",this.menuBar.style.display="block"},e.prototype.cancelEditing=function(){if(this.showCommentView(),this.textArea.innerHTML=this.comment.text.trim(),this.commentPane.parentPane.isNewComment){this.commentPane&&this.commentPane.parentPane&&(this.commentPane.parentPane.isNewComment=!1);var e=this.owner;e.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.commentPane.parentPane.discardComment(this.comment),e.editorModule.isSkipOperationsBuild=!1}},e.prototype.showOrHideDrawer=function(){this.isDrawerExpand?this.hideDrawer():this.showDrawer()},e.prototype.hideDrawer=function(){if(this.parentElement){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale);var t=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(t.length>1){for(var i=1;i<t.length;i++)t[i].style.display="none";this.drawerElement.style.display="block",(0,a.classList)(this.drawerSpanElement,[],["e-de-nav-up"]),this.drawerSpanElement.innerText="+"+(t.length-1)+" "+e.getConstant("more")+"..."}this.isDrawerExpand=!1}},e.prototype.showDrawer=function(){if(this.parentElement){var e=this.parentElement.getElementsByClassName("e-de-cmt-sub-container");if(e.length>1){for(var t=0;t<e.length;t++)e[t].style.display="block";this.drawerElement.style.display="block",this.drawerSpanElement.innerText="",(0,a.classList)(this.drawerSpanElement,["e-de-nav-up"],[])}this.isDrawerExpand=!0}},e.prototype.userOptionSelectEvent=function(e){var t=e.item.text,i=new a.L10n("documenteditor",this.owner.defaultLocale);switch(i.setLocale(this.owner.locale),t){case i.getConstant("Edit"):this.editComment();break;case i.getConstant("Reply"):this.enableReplyView();break;case i.getConstant("Delete"):this.deleteComment();break;case i.getConstant("Resolve"):this.owner.editorModule.resolveComment(this.comment);break;case i.getConstant("Reopen"):this.owner.editorModule.reopenComment(this.comment)}},e.prototype.unwireEvent=function(){this.drawerAction&&this.drawerAction.removeEventListener("click",this.showOrHideDrawer.bind(this)),this.textArea&&(this.textArea.removeEventListener("keydown",this.updateTextAreaHeight.bind(this)),this.textArea.removeEventListener("keyup",this.enableDisablePostButton.bind(this))),this.postButton&&this.postButton.removeEventListener("click",this.postComment.bind(this)),this.cancelButton&&this.cancelButton.removeEventListener("click",this.cancelEditing.bind(this)),this.commentView&&(this.commentView.removeEventListener("click",this.selectComment.bind(this)),this.commentView.removeEventListener("mouseenter",this.showMenuItems.bind(this)),this.commentView.removeEventListener("mouseleave",this.hideMenuItemOnMouseLeave.bind(this)))},e.prototype.destroy=function(){this.unwireEvent(),this.comment&&(this.comment=void 0),this.dropDownButton&&this.dropDownButton.destroy(),this.dropDownButton=void 0,this.postButton&&this.postButton.destroy(),this.postButton=void 0,this.cancelButton&&this.cancelButton.destroy(),this.cancelButton=void 0,this.replyPostButton&&(this.replyPostButton.destroy(),this.replyPostButton=void 0),this.replyCancelButton&&(this.replyCancelButton.destroy(),this.replyCancelButton=void 0),this.reopenButton&&(this.reopenButton.destroy(),this.reopenButton=void 0),this.deleteButton&&(this.deleteButton.destroy(),this.deleteButton=void 0),this.parentElement&&(this.parentElement.innerHTML="",this.parentElement.parentElement&&this.parentElement.parentElement.removeChild(this.parentElement)),this.parentElement=void 0,this.commentView&&(this.commentView.innerHTML="",this.commentView.parentElement&&this.commentView.parentElement.removeChild(this.commentView)),this.commentView=void 0,this.replyViewContainer&&(this.replyViewContainer.innerHTML="",this.replyViewContainer.remove(),this.replyViewContainer=null),this.replyViewTextBox=void 0,this.replyFooter=void 0,this.resolveView&&(this.resolveView.innerHTML="",this.resolveView.remove(),this.resolveView=null),this.menuBar=void 0,this.drawerAction=void 0,this.commentText=void 0,this.commentDate=void 0,this.textAreaContainer&&(this.textAreaContainer.innerHTML="",this.textAreaContainer.remove(),this.textAreaContainer=null),this.drawerElement=void 0,this.drawerSpanElement=void 0,this.commentPane=void 0,this.owner=void 0},e}(),Dh=function(){function e(e){var t=this;this.displayText="",this.navigationUrl=void 0,this.screenTipText="",this.bookmarkDropdown=void 0,this.bookmarkCheckbox=void 0,this.keyUpOnDisplayBoxClickHandler=this.onKeyUpOnDisplayBoxClick.bind(this),this.onKeyUpOnUrlBoxClickHandler=this.onKeyUpOnUrlBoxClick.bind(this),this.onScreenTipTextBoxClickHandler=this.onScreenTipTextBoxClick.bind(this),this.bookmarks=[],this.onKeyUpOnUrlBox=function(e){if(13!==e.keyCode){var i=t.urlTextBox.value;"www."===i.substring(0,4).toLowerCase()&&(t.urlTextBox.value="http://"+i),""===t.displayText&&(t.displayTextBox.value=i),t.enableOrDisableInsertButton()}else""!==t.displayTextBox.value&&""!==t.urlTextBox.value&&t.onInsertHyperlink()},this.onKeyUpOnDisplayBox=function(){t.displayText=t.displayTextBox.value,t.enableOrDisableInsertButton()},this.onScreenTipTextBox=function(){t.screenTipText=t.screenTipTextBox.value},this.onInsertButtonClick=function(){t.onInsertHyperlink()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.clearValue(),t.documentHelper.updateFocus()},this.loadHyperlinkDialog=function(){t.documentHelper.updateFocus(),t.bookmarks=[];for(var e=0;e<t.documentHelper.bookmarks.keys.length;e++){var i=t.documentHelper.bookmarks.keys[parseInt(e.toString(),10)];0!==i.indexOf("_")&&t.bookmarks.push(i)}var n=t.documentHelper.selection.getHyperlinkField();if((0,a.isNullOrUndefined)(n))t.displayText=t.documentHelper.selection.getText(!0),""!==t.displayText&&(-1!==t.displayText.indexOf(String.fromCharCode(65532))||-1!==t.displayText.indexOf("\r")&&-1!==t.displayText.lastIndexOf("\r")&&-1!==t.displayText.slice(0,-1).indexOf("\r")?(t.displayTextBox.value="<<Selection in document>>",t.displayTextBox.disabled=!0):t.displayTextBox.value=t.displayText);else{if(!(0,a.isNullOrUndefined)(n.fieldSeparator)){var r=t.documentHelper.selection.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,!1,undefined);t.displayText=r.displayText,t.displayTextBox.disabled=r.isNestedField}t.displayTextBox.value=t.displayText,t.screenTipTextBox.value=t.documentHelper.selection.getLinkText(n,!1);var o=t.documentHelper.selection.getLinkText(n,!0);t.urlTextBox.value=t.navigationUrl=o,t.documentHelper.dialog.header=t.localObj.getConstant("Edit Hyperlink")}t.bookmarkDiv.style.display="none",t.addressText.style.display="block",t.urlTextBox.style.display="block",t.bookmarkCheckbox.checked=!1,t.bookmarkDropdown.dataSource=t.documentHelper.bookmarks.keys,t.insertButton=document.getElementsByClassName("e-hyper-insert")[0],t.enableOrDisableInsertButton(),t.urlTextBox.focus(),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none")},this.closeHyperlinkDialog=function(){t.clearValue(),t.documentHelper.updateFocus()},this.onUseBookmarkChange=function(e){e.checked?(t.bookmarkDiv.style.display="block",t.bookmarkDropdown.dataSource=t.bookmarks,t.addressText.style.display="none",t.urlTextBox.style.display="none"):(t.bookmarkDiv.style.display="none",t.addressText.style.display="block",t.urlTextBox.style.display="block"),t.enableOrDisableInsertButton()},this.onBookmarkchange=function(){""!==t.bookmarkDropdown.value&&(t.insertButton.disabled=!1)},this.documentHelper=e}return e.prototype.getModuleName=function(){return"HyperlinkDialog"},e.prototype.initHyperlinkDialog=function(e,t){this.target=(0,a.createElement)("div",{className:"e-de-hyperlink"}),this.container=(0,a.createElement)("div"),this.displayText1=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.displayTextBox=(0,a.createElement)("input",{className:"e-input"}),this.displayTextBox.addEventListener("keyup",this.keyUpOnDisplayBoxClickHandler),this.displayText1.appendChild(this.displayTextBox),this.container.appendChild(this.displayText1),this.addressText=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.urlTextBox=(0,a.createElement)("input",{className:"e-input",attrs:{autofocus:"true"}}),this.urlTextBox.addEventListener("input",this.onKeyUpOnUrlBoxClickHandler),this.urlTextBox.addEventListener("keyup",this.onKeyUpOnUrlBoxClickHandler),this.addressText.appendChild(this.urlTextBox),this.container.appendChild(this.addressText),this.screenTipText1=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.screenTipTextBox=(0,a.createElement)("input",{className:"e-input"}),this.screenTipTextBox.addEventListener("keyup",this.onScreenTipTextBoxClickHandler),this.screenTipText1.appendChild(this.screenTipTextBox),this.container.appendChild(this.screenTipText1),this.bookmarkDiv=(0,a.createElement)("div",{styles:"display:none;"}),this.bookmarkText=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.bookmarkValue=(0,a.createElement)("input"),this.bookmarkText.appendChild(this.bookmarkValue),this.bookmarkDropdown=new al.DropDownList({dataSource:[],change:this.onBookmarkchange,noRecordsTemplate:e.getConstant("No bookmarks found"),placeholder:e.getConstant("Bookmark"),floatLabelType:"Always"}),this.bookmarkDropdown.appendTo(this.bookmarkValue),this.bookmarkDiv.appendChild(this.bookmarkText),this.container.appendChild(this.bookmarkDiv),this.bookmarkCheckDiv=(0,a.createElement)("div"),this.bookmarkCheck=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.bookmarkCheckDiv.appendChild(this.bookmarkCheck),this.bookmarkCheckbox=new tl.CheckBox({label:e.getConstant("Use bookmarks"),enableRtl:t,change:this.onUseBookmarkChange}),this.bookmarkCheckbox.appendTo(this.bookmarkCheck),this.container.appendChild(this.bookmarkCheckDiv),this.target.appendChild(this.container),new rl.TextBox({placeholder:e.getConstant("Text to display"),floatLabelType:"Always"},this.displayTextBox),new rl.TextBox({placeholder:e.getConstant("Address"),floatLabelType:"Always"},this.urlTextBox),new rl.TextBox({placeholder:e.getConstant("ScreenTip text"),floatLabelType:"Always"},this.screenTipTextBox)},e.prototype.show=function(){this.localObj=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),this.target||this.initHyperlinkDialog(this.localObj,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=this.localObj.getConstant("Insert Hyperlink"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.onInsertButtonClick,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-hyper-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.beforeOpen=this.loadHyperlinkDialog,this.documentHelper.dialog.close=this.closeHyperlinkDialog,this.documentHelper.dialog.show()},e.prototype.hide=function(){this.closeHyperlinkDialog()},e.prototype.onKeyUpOnUrlBoxClick=function(e){this.onKeyUpOnUrlBox(e)},e.prototype.onKeyUpOnDisplayBoxClick=function(){this.onKeyUpOnDisplayBox()},e.prototype.onScreenTipTextBoxClick=function(){this.onScreenTipTextBox()},e.prototype.enableOrDisableInsertButton=function(){(0,a.isNullOrUndefined)(this.insertButton)||(this.bookmarkCheckbox.checked?this.insertButton.disabled=""===this.bookmarkDropdown.value||null==this.bookmarkDropdown.value:this.insertButton.disabled=""===this.urlTextBox.value||""===this.displayTextBox.value)},e.prototype.onInsertHyperlink=function(){var e=a.SanitizeHtmlHelper.sanitize(this.displayTextBox.value.trim()),t=this.urlTextBox.value.trim();(Pa.startsWith(t,"http://")||Pa.startsWith(t,"https://"))&&(t=a.SanitizeHtmlHelper.sanitize(t.replace(/\s/g,"")));var i=a.SanitizeHtmlHelper.sanitize(this.screenTipTextBox.value.trim()),n=!1;if((0,a.isNullOrUndefined)(this.bookmarkDropdown.value)||""===this.bookmarkDropdown.value||!0!==this.bookmarkCheckbox.checked||(t=this.bookmarkDropdown.value,n=!0),""!==t){if(""!==i&&(t=t+'"\\o "'+i),e=""===e&&""!==t?t:this.displayTextBox.value,(0,a.isNullOrUndefined)(this.navigationUrl)){var r=(this.documentHelper.selection.text!==e||-1===this.documentHelper.selection.text.indexOf("\r"))&&!this.displayTextBox.disabled;this.documentHelper.owner.editorModule.insertHyperlinkInternal(t,e,r,n)}else this.documentHelper.owner.editorModule.editHyperlink(this.documentHelper.selection,t,e,n);this.documentHelper.hideDialog(),this.navigationUrl=void 0}else this.documentHelper.hideDialog()},e.prototype.clearValue=function(){this.displayTextBox.value="",this.urlTextBox.value="",this.screenTipText="",this.screenTipTextBox.value="",this.displayText="",this.displayTextBox.disabled=!1,this.bookmarks=[]},e.prototype.destroy=function(){this.displayTextBox&&(this.displayTextBox.innerHTML="",this.displayTextBox=void 0),this.urlTextBox&&(this.urlTextBox.parentElement.removeChild(this.urlTextBox),this.urlTextBox=void 0),this.screenTipTextBox&&(this.screenTipTextBox.parentElement.removeChild(this.screenTipTextBox),this.screenTipTextBox=void 0),this.documentHelper=void 0,(0,a.isNullOrUndefined)(this.target)||(this.target.parentElement&&this.target.parentElement.removeChild(this.target),this.target.innerHTML="",this.target=void 0),this.removeEvents(),this.removeElements()},e.prototype.removeEvents=function(){this.displayTextBox&&this.displayTextBox.removeEventListener("keyup",this.keyUpOnDisplayBoxClickHandler),this.urlTextBox&&(this.urlTextBox.removeEventListener("input",this.onKeyUpOnUrlBoxClickHandler),this.urlTextBox.removeEventListener("keyup",this.onKeyUpOnUrlBoxClickHandler)),this.screenTipTextBox&&this.screenTipTextBox.removeEventListener("keyup",this.onScreenTipTextBoxClickHandler)},e.prototype.removeElements=function(){this.container&&(this.container.remove(),this.container=void 0),this.displayText1&&(this.displayText1.remove(),this.displayText1=void 0),this.addressText&&(this.addressText.remove(),this.addressText=void 0),this.screenTipText1&&(this.screenTipText1.remove(),this.screenTipText1=void 0),this.bookmarkDiv&&(this.bookmarkDiv.remove(),this.bookmarkDiv=void 0),this.bookmarkText&&(this.bookmarkText.remove(),this.bookmarkText=void 0),this.bookmarkValue&&(this.bookmarkValue.remove(),this.bookmarkValue=void 0),this.bookmarkCheckDiv&&(this.bookmarkCheckDiv.remove(),this.bookmarkCheckDiv=void 0),this.bookmarkCheck&&(this.bookmarkCheck.remove(),this.bookmarkCheck=void 0)},e}(),Rh=function(){function e(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus()},this.onInsertTableClick=function(){if(t.columnValueTexBox.value<1||t.columnValueTexBox.value>t.documentHelper.owner.documentEditorSettings.maximumColumns){var e=t.localeValue.getConstant("Number of columns must be between")+" 1 "+t.localeValue.getConstant("and")+" "+t.documentHelper.owner.documentEditorSettings.maximumColumns.toString();el.DialogUtility.alert(e).enableRtl=t.documentHelper.owner.enableRtl}else if(t.rowValueTextBox.value<1||t.rowValueTextBox.value>t.documentHelper.owner.documentEditorSettings.maximumRows){var i=t.localeValue.getConstant("Number of rows must be between")+" 1 "+t.localeValue.getConstant("and")+" "+t.documentHelper.owner.documentEditorSettings.maximumColumns.toString();el.DialogUtility.alert(i).enableRtl=t.documentHelper.owner.enableRtl}else if(t.rowValueTextBox.value<=t.documentHelper.owner.documentEditorSettings.maximumRows&&t.columnValueTexBox.value<=t.documentHelper.owner.documentEditorSettings.maximumColumns){var n=t.rowValueTextBox.value,r=t.columnValueTexBox.value;(0,a.isNullOrUndefined)(n)&&(0,a.isNullOrUndefined)(r)||t.documentHelper.owner.editorModule.insertTable(n,r),t.documentHelper.hideDialog()}},this.documentHelper=e}return e.prototype.getModuleName=function(){return"TableDialog"},e.prototype.initTableDialog=function(e){this.target=(0,a.createElement)("div",{className:"e-de-insert-table"}),this.parentDiv=(0,a.createElement)("div"),this.columnValue=(0,a.createElement)("div",{className:"e-de-container-row"}),this.columnsCountBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.columnValue.appendChild(this.columnsCountBox),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Insert Table")),this.rowValue=(0,a.createElement)("div"),this.rowsCountBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.rowValue.appendChild(this.rowsCountBox),this.parentDiv.appendChild(this.columnValue),this.parentDiv.appendChild(this.rowValue),this.target.appendChild(this.parentDiv),this.rowValueTextBox=new rl.NumericTextBox({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of rows"),floatLabelType:"Always"}),this.rowValueTextBox.appendTo(this.rowsCountBox),this.rowsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of rows")),this.columnValueTexBox=new rl.NumericTextBox({format:"#",value:2,min:1,strictMode:!0,enablePersistence:!1,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always"}),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of columns")),this.parentDiv.setAttribute("aria-labelledby",e.getConstant("Insert Table")),this.parentDiv.setAttribute("aria-describedby",e.getConstant("Insert Table")),this.columnValueTexBox.appendTo(this.columnsCountBox)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initTableDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Insert Table"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onInsertTableClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.rowValueTextBox.value=2,this.columnValueTexBox.value=2,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.columnValueTexBox.focusIn(),this.documentHelper.dialog.show()},e.prototype.destroy=function(){if(this.columnsCountBox&&(this.columnsCountBox.parentElement&&this.columnsCountBox.parentElement.removeChild(this.columnsCountBox),this.columnsCountBox=void 0),this.rowsCountBox&&(this.rowsCountBox.parentElement&&this.rowsCountBox.parentElement.removeChild(this.rowsCountBox),this.rowsCountBox=void 0),this.columnValueTexBox&&(this.columnValueTexBox.destroy(),this.columnValueTexBox=void 0),this.rowValueTextBox&&(this.rowValueTextBox.destroy(),this.rowValueTextBox=void 0),this.columnsCountBox=void 0,this.rowsCountBox=void 0,this.documentHelper=void 0,this.removeElements(),!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}},e.prototype.removeElements=function(){this.parentDiv&&(this.parentDiv.remove(),this.parentDiv=void 0),this.columnValue&&(this.columnValue.remove(),this.columnValue=void 0),this.rowValue&&(this.rowValue.remove(),this.rowValue=void 0)},e}(),Mh=function(){function e(e){var t=this;this.listViewInstanceClickHandler=this.onListInstanceClicked.bind(this),this.onKeyUpOnTextBoxClickHandler=this.onKeyUpOnTextBoxClicked.bind(this),this.addBookmarkClickHandler=this.onAddBookmarkClicked.bind(this),this.deleteBookmarkClickHandler=this.onDeleteBookmarkClicked.bind(this),this.gotoBookmarkClickHandler=this.onGotoBookmarkClicked.bind(this),this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.addBookmark=function(){t.documentHelper.owner.editorModule.insertBookmark(a.SanitizeHtmlHelper.sanitize(t.textBoxInput.value)),t.documentHelper.hideDialog()},this.selectHandler=function(e){t.focusTextBox(e.text)},this.gotoBookmark=function(){t.documentHelper.selection.selectBookmark(t.textBoxInput.value)},this.deleteBookmark=function(){t.documentHelper.owner.editorModule.deleteBookmark(t.textBoxInput.value),t.show()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"BookmarkDialog"},e.prototype.initBookmarkDialog=function(e,t,i){var n=this.documentHelper.owner.containerId+"_insert_bookmark";this.target=(0,a.createElement)("div",{id:n,className:"e-de-bookmark"});var r=e.getConstant("Bookmark name")+":";this.dlgFields=(0,a.createElement)("div",{innerHTML:r,className:"e-bookmark-dlgfields"}),this.target.appendChild(this.dlgFields),this.commonDiv=(0,a.createElement)("div",{className:"e-bookmark-common"}),this.target.appendChild(this.commonDiv),this.searchDiv=(0,a.createElement)("div",{className:"e-bookmark-list"}),this.commonDiv.appendChild(this.searchDiv),i&&this.searchDiv.classList.add("e-de-rtl"),this.textBoxDiv=(0,a.createElement)("div",{className:"e-bookmark-textboxdiv"}),this.searchDiv.appendChild(this.textBoxDiv),this.textBoxInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.setAttribute("aria-label",e.getConstant("Bookmark name")),this.textBoxDiv.appendChild(this.textBoxInput),this.listviewDiv=(0,a.createElement)("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview",attrs:{tabindex:"-1",role:"listbox"}}),this.listviewDiv.setAttribute("aria-label",e.getConstant("BookMarkList")),this.searchDiv.appendChild(this.listviewDiv),this.listviewInstance=new il.ListView({dataSource:t,cssClass:"e-bookmark-listview"});var o=void 0===t||0===t.length;this.listviewInstance.appendTo(this.listviewDiv),this.listviewInstance.addEventListener("select",this.listViewInstanceClickHandler),this.buttonDiv=(0,a.createElement)("div",{className:"e-bookmark-button"}),this.commonDiv.appendChild(this.buttonDiv),this.addbuttonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.buttonDiv.appendChild(this.addbuttonDiv),this.addButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Add"),id:"add",attrs:{type:"button"}}),this.addButtonElement.setAttribute("aria-label",e.getConstant("Add")),this.addbuttonDiv.appendChild(this.addButtonElement),this.addButton=new tl.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButton.appendTo(this.addButtonElement),this.textBoxInput.addEventListener("input",this.onKeyUpOnTextBoxClickHandler),this.textBoxInput.addEventListener("keyup",this.onKeyUpOnTextBoxClickHandler),this.addButtonElement.addEventListener("click",this.addBookmarkClickHandler),this.deleteButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-deletebutton"}),this.buttonDiv.appendChild(this.deleteButtonDiv),this.deleteButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Delete"),id:"delete",attrs:{type:"button"}}),this.deleteButtonElement.setAttribute("aria-label",e.getConstant("Delete")),this.deleteButtonDiv.appendChild(this.deleteButtonElement),this.deleteButton=new tl.Button({cssClass:"e-button-custom"}),this.deleteButton.disabled=o,this.deleteButton.appendTo(this.deleteButtonElement),this.deleteButtonElement.addEventListener("click",this.deleteBookmarkClickHandler),this.gotoButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-gotobutton"}),this.buttonDiv.appendChild(this.gotoButtonDiv),this.gotoButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Go To"),id:"goto",attrs:{type:"button"}}),this.gotoButtonElement.setAttribute("aria-label",e.getConstant("Go To")),this.gotoButtonDiv.appendChild(this.gotoButtonElement),this.gotoButton=new tl.Button({cssClass:"e-button-custom"}),this.gotoButton.disabled=o,this.gotoButton.appendTo(this.gotoButtonElement),this.gotoButtonElement.addEventListener("click",this.gotoBookmarkClickHandler)},e.prototype.onListInstanceClicked=function(e){this.selectHandler(e)},e.prototype.onKeyUpOnTextBoxClicked=function(){this.onKeyUpOnTextBox()},e.prototype.onAddBookmarkClicked=function(){this.addBookmark()},e.prototype.onDeleteBookmarkClicked=function(){this.deleteBookmark()},e.prototype.onGotoBookmarkClicked=function(){this.gotoBookmark()},e.prototype.show=function(){var e=this.documentHelper.getBookmarks(),t=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(t.setLocale(this.documentHelper.owner.locale),this.initBookmarkDialog(t,e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=t.getConstant("Bookmark"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.removeObjects.bind(this),buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),!(void 0===e||0===e.length)){var i=e[0];this.listviewInstance.selectItem(i)}this.documentHelper.dialog.show()},e.prototype.enableOrDisableButton=function(){var e=this.textBoxInput.value.trim();(0,a.isNullOrUndefined)(this.addButton)||(this.addButton.disabled=!/^[_a-zA-Z0-9]+$/.test(e))},e.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=document.getElementById("bookmark_text_box");t.setSelectionRange(0,e.length),t.focus(),this.enableOrDisableButton()},e.prototype.removeObjects=function(){this.documentHelper.hideDialog()},e.prototype.destroy=function(){this.removeEvents(),this.removeElements(),this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.documentHelper=void 0},e.prototype.removeElements=function(){this.dlgFields&&(this.dlgFields.remove(),this.dlgFields=void 0),this.commonDiv&&(this.commonDiv.remove(),this.commonDiv=void 0),this.target&&(this.target.remove(),this.target=void 0),this.textBoxDiv&&(this.textBoxDiv.remove(),this.textBoxDiv=void 0),this.searchDiv&&(this.searchDiv.remove(),this.searchDiv=void 0),this.listviewDiv&&(this.listviewDiv.remove(),this.listviewDiv=void 0),this.buttonDiv&&(this.buttonDiv.remove(),this.buttonDiv=void 0),this.addbuttonDiv&&(this.addbuttonDiv.remove(),this.addbuttonDiv=void 0),this.deleteButtonDiv&&(this.deleteButtonDiv.remove(),this.deleteButtonDiv=void 0),this.gotoButtonDiv&&(this.gotoButtonDiv.remove(),this.gotoButtonDiv=void 0),this.addButtonElement&&(this.addButtonElement.remove(),this.addButtonElement=void 0),this.deleteButtonElement&&(this.deleteButtonElement.remove(),this.deleteButtonElement=void 0),this.gotoButtonElement&&(this.gotoButtonElement.remove(),this.gotoButtonElement=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.deleteButton&&(this.deleteButton.destroy(),this.deleteButton=void 0),this.gotoButton&&(this.gotoButton.destroy(),this.gotoButton=void 0)},e.prototype.removeEvents=function(){this.listviewInstance&&this.listviewInstance.removeEventListener("select",this.listViewInstanceClickHandler),this.textBoxInput&&(this.textBoxInput.removeEventListener("input",this.onKeyUpOnTextBoxClickHandler),this.textBoxInput.removeEventListener("keyup",this.onKeyUpOnTextBoxClickHandler)),this.addButtonElement&&this.addButtonElement.removeEventListener("click",this.addBookmarkClickHandler),this.deleteButtonElement&&this.deleteButtonElement.removeEventListener("click",this.deleteBookmarkClickHandler),this.gotoButtonElement&&this.gotoButtonElement.removeEventListener("click",this.gotoBookmarkClickHandler)},e}(),Ah=function(){function e(e){var t=this;this.changeStyleClickHandler=this.onChangeStyleClick.bind(this),this.changingStyleClickHandler=this.onChangingStyleClick.bind(this),this.resetClickHandler=this.onResetClick.bind(this),this.selectHandlerClickHandler=this.onSelectHandlerClick.bind(this),this.showDialogHandler=this.onShowDialog.bind(this),this.loadTableofContentDialog=function(){t.documentHelper.updateFocus(),t.pageNumber.checked=!0,t.rightAlign.disabled=!1,t.rightAlign.checked=!0,t.tabLeader.enabled=!0,t.hyperlink.checked=!0,t.style.checked=!0,t.outline.checked=!0,t.outline.disabled=!1,t.showLevel.enabled=!0},this.closeTableOfContentDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog3.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.selectHandler=function(e){t.textBoxInput.value=e.text;var i=t.textBoxInput;i.setSelectionRange(0,e.text.length),i.focus()},this.showStyleDialog=function(){(0,a.isNullOrUndefined)(t.documentHelper.owner.styleDialogModule)||t.documentHelper.owner.styleDialogModule.show(t.textBoxInput.value)},this.reset=function(){t.showLevel.enabled=!0,t.showLevel.value=3,t.outline.disabled=!1,t.outline.checked=!0;t.changeByValue(["1","2","3",null,null,null,null,null,null]),t.normal.value=null},this.changeStyle=function(e){var i=0;if(!(0,a.isNullOrUndefined)(e.srcElement.value)){var n=e.srcElement.value;if(i=parseInt(n),!n.match(/^[0-9]+$/)&&""!==n)return void t.initAlertDialog(!1);if(i<1||i>9)return void t.initAlertDialog(!0);n!==t.getElementValue(e.srcElement)&&""!==n?t.showLevel.enabled=!1:(t.showLevel.enabled=!0,t.checkLevel())}},this.changeHeadingStyle=function(e){var i=0;if(!(0,a.isNullOrUndefined)(e.srcElement.value)){var n=e.srcElement.value;if(i=parseInt(n),!n.match(/^[0-9]+$/)&&""!==n)return void t.initAlertDialog(!1);if(i<1||i>9)return void t.initAlertDialog(!0);t.showLevel.enabled=""===n,t.normal===e.srcElement&&(t.outline.checked=!1,t.outline.disabled=!0)}},this.changePageNumberValue=function(e){e.checked?(t.rightAlign.checked=!0,t.rightAlign.disabled=!1,t.tabLeader.enabled=!0):(t.rightAlign.disabled=!0,t.tabLeader.enabled=!1)},this.changeRightAlignValue=function(e){e.checked?t.tabLeader.enabled=!0:t.tabLeader.enabled=!1},this.changeStyleValue=function(e){e.checked?(t.heading1.disabled=!1,t.heading2.disabled=!1,t.heading3.disabled=!1,t.heading4.disabled=!1,t.heading5.disabled=!1,t.heading6.disabled=!1,t.heading7.disabled=!1,t.heading8.disabled=!1,t.heading9.disabled=!1,t.normal.disabled=!1):(t.heading1.disabled=!0,t.heading2.disabled=!0,t.heading3.disabled=!0,t.heading4.disabled=!0,t.heading5.disabled=!0,t.heading6.disabled=!0,t.heading7.disabled=!0,t.heading8.disabled=!0,t.heading9.disabled=!0,t.normal.disabled=!0)},this.applyTableOfContentProperties=function(){var e={startLevel:1,endLevel:t.showLevel.value,includeHyperlink:t.hyperlink.checked,includePageNumber:t.pageNumber.checked,rightAlign:t.rightAlign.checked,tabLeader:t.tabLeader.value,includeOutlineLevels:t.outline.checked};t.applyLevelSetting(e)&&(t.documentHelper.owner.editorModule.insertTableOfContents(e),t.documentHelper.dialog3.hide(),t.documentHelper.updateFocus())},this.unWireEventsAndBindings=function(){t.pageNumber.checked=!1,t.rightAlign.checked=!1,t.tabLeader&&(t.tabLeader.value=""),t.hyperlink.checked=!1,t.style.checked=!1,t.outline.checked=!1,t.normal&&(t.normal.value="")},this.documentHelper=e}return e.prototype.getModuleName=function(){return"TableOfContentsDialog"},e.prototype.initTableOfContentDialog=function(e,t){var i=this.documentHelper.owner.containerId,n=i+"_toc_dialog";this.target=(0,a.createElement)("div",{id:n,className:"e-de-toc-dlg-container"}),this.generalDiv=(0,a.createElement)("div",{id:"general_div",className:"e-de-toc-dlg-sub-container"}),this.target.appendChild(this.generalDiv),this.genLabel=(0,a.createElement)("div",{id:i+"_genLabel",className:"e-de-toc-dlg-main-heading",styles:"margin-bottom: 13px;",innerHTML:e.getConstant("General")}),this.generalDiv.appendChild(this.genLabel),this.topContainer=(0,a.createElement)("div",{className:"e-de-container-row"}),this.leftGeneralDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.topContainer.appendChild(this.leftGeneralDiv),this.rightGeneralDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.topContainer.appendChild(this.rightGeneralDiv),this.generalDiv.appendChild(this.topContainer),this.bottomContainer=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.leftBottomGeneralDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.bottomContainer.appendChild(this.leftBottomGeneralDiv),this.rightBottomGeneralDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.bottomContainer.appendChild(this.rightBottomGeneralDiv),this.pageNumberDiv=(0,a.createElement)("div",{className:"e-de-toc-dlg-sub-container"}),this.pageNumber1=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_pageNumber"}),this.pageNumberDiv.appendChild(this.pageNumber1),this.rightAlignDiv=(0,a.createElement)("div",{className:"e-de-toc-dlg-sub-container"}),this.rightAlign1=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_rightAlign"}),this.rightAlignDiv.appendChild(this.rightAlign1),this.pageNumber=new tl.CheckBox({label:e.getConstant("Show page numbers"),enableRtl:t,checked:!0,change:this.changePageNumberValue}),this.rightAlign=new tl.CheckBox({label:e.getConstant("Right align page numbers"),enableRtl:t,checked:!0,change:this.changeRightAlignValue}),this.pageNumber.appendTo(this.pageNumber1),this.rightAlign.appendTo(this.rightAlign1),this.tabDivContainer=(0,a.createElement)("div",{className:"e-de-container-row"}),this.tabDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.tabLeaderLabelDiv=(0,a.createElement)("div"),this.tabLeaderLabel=(0,a.createElement)("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Tab leader")+":"}),this.tabLeaderLabelDiv.appendChild(this.tabLeaderLabel),this.tabLeaderDiv=(0,a.createElement)("div",{id:"tabLeader_div"}),this.tabLeader1=(0,a.createElement)("select",{id:i+"_tabLeader",innerHTML:'<option value="None">('+e.getConstant("None").toLocaleLowerCase()+')</option><option value="Dot" selected>....................</option><option value="Hyphen">-------------------</option><option value="Underscore">____________</option>'}),this.tabLeaderDiv.appendChild(this.tabLeader1),this.tabDiv.appendChild(this.tabLeaderLabelDiv),this.tabDiv.appendChild(this.tabLeaderDiv),this.leftGeneralDiv.appendChild(this.pageNumberDiv),this.leftGeneralDiv.appendChild(this.rightAlignDiv),this.tabDivContainer.appendChild(this.tabDiv),this.tabLeader=new al.DropDownList({enableRtl:t}),this.tabLeader.appendTo(this.tabLeader1),this.hyperlink1=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_hyperlink"}),this.rightGeneralDiv.appendChild(this.hyperlink1),this.hyperlink=new tl.CheckBox({label:e.getConstant("Use hyperlinks instead of page numbers"),cssClass:"e-de-toc-label",enableRtl:t,checked:!0}),this.hyperlink.appendTo(this.hyperlink1),this.showDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.showLevelLabelDiv=(0,a.createElement)("div",{className:"e-de-toc-dlg-show-level-div"}),this.showLevelLabel=(0,a.createElement)("label",{className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Show levels")+":"}),this.showLevelLabelDiv.appendChild(this.showLevelLabel),this.showLevelDiv=(0,a.createElement)("div",{className:"e-de-toc-dlg-showlevel-div"}),this.showLevel1=(0,a.createElement)("input",{id:i+"_showLevel",attrs:{type:"text","aria-label":"showLevel"}}),this.showLevelDiv.appendChild(this.showLevel1),this.showDiv.appendChild(this.showLevelLabelDiv),this.showDiv.appendChild(this.showLevelDiv),this.tabDivContainer.appendChild(this.showDiv),this.generalDiv.appendChild(this.tabDivContainer),this.showLevel=new rl.NumericTextBox({format:"#",value:3,min:1,max:9,change:this.changeShowLevelValue.bind(this)}),this.showLevel.appendTo(this.showLevel1),t&&(this.hyperlink.cssClass="e-de-toc-label-rtl",this.showLevelLabelDiv.classList.add("e-de-rtl"),this.showLevelDiv.classList.add("e-de-rtl"),this.rightBottomGeneralDiv.classList.add("e-de-rtl")),this.buildTableLabel=(0,a.createElement)("div",{className:"e-de-toc-dlg-main-heading e-de-toc-dlg-build-table",innerHTML:e.getConstant("Build table of contents from")+":"}),this.generalDiv.appendChild(this.bottomContainer);var r=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_style"});this.leftBottomGeneralDiv.appendChild(this.buildTableLabel),this.leftBottomGeneralDiv.appendChild(r),this.style=new tl.CheckBox({label:e.getConstant("Styles"),enableRtl:t,checked:!0,change:this.changeStyleValue}),this.style.appendTo(r),this.table=(0,a.createElement)("TABLE",{styles:"margin-top:3px;"}),this.tr1=(0,a.createElement)("tr"),this.td1=(0,a.createElement)("td",{styles:"width:120px;padding-left:10px;"}),this.availableLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Available styles"),className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_availableLabel"}),this.td1.appendChild(this.availableLabel),this.td2=(0,a.createElement)("td"),this.tocLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("TOC level")+":",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_tocLabel"}),this.td2.appendChild(this.tocLabel),this.tr1.appendChild(this.td1),this.tr1.appendChild(this.td2),this.table.appendChild(this.tr1),this.tableDiv=(0,a.createElement)("div",{id:"table_div",className:"e-de-toc-table-div"}),this.table1=(0,a.createElement)("TABLE"),this.tr2=(0,a.createElement)("tr"),this.td3=(0,a.createElement)("td"),this.heading1Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 1",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading1Label"}),this.td3.appendChild(this.heading1Label),this.td4=(0,a.createElement)("td"),this.heading1=(0,a.createElement)("input",{id:"_heading1",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 1"}}),this.heading1.value="1",this.heading1.addEventListener("keyup",this.changeStyleClickHandler),this.td4.appendChild(this.heading1),this.tr2.appendChild(this.td3),this.tr2.appendChild(this.td4),this.tr3=(0,a.createElement)("tr"),this.td5=(0,a.createElement)("td"),this.heading2Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 2",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading2Label"}),this.td5.appendChild(this.heading2Label),this.td6=(0,a.createElement)("td"),this.heading2=(0,a.createElement)("input",{id:"_heading2",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 2"}}),this.heading2.value="2",this.heading2.addEventListener("keyup",this.changeStyleClickHandler),this.td6.appendChild(this.heading2),this.tr3.appendChild(this.td5),this.tr3.appendChild(this.td6),this.tr4=(0,a.createElement)("tr"),this.td7=(0,a.createElement)("td"),this.heading3Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 3",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading3Label"}),this.td7.appendChild(this.heading3Label),this.td8=(0,a.createElement)("td"),this.heading3=(0,a.createElement)("input",{id:"_heading3",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 3"}}),this.heading3.value="3",this.heading3.addEventListener("keyup",this.changeStyleClickHandler),this.td8.appendChild(this.heading3),this.tr4.appendChild(this.td7),this.tr4.appendChild(this.td8),this.tr5=(0,a.createElement)("tr"),this.td9=(0,a.createElement)("td"),this.heading4Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 4",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading4Label"}),this.td9.appendChild(this.heading4Label),this.td10=(0,a.createElement)("td"),this.heading4=(0,a.createElement)("input",{id:"_heading4",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 4"}}),this.heading4.addEventListener("keyup",this.changeStyleClickHandler),this.td10.appendChild(this.heading4),this.tr5.appendChild(this.td9),this.tr5.appendChild(this.td10),this.tr6=(0,a.createElement)("tr"),this.td11=(0,a.createElement)("td"),this.heading5Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 5",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading5Label"}),this.td11.appendChild(this.heading5Label),this.td12=(0,a.createElement)("td"),this.heading5=(0,a.createElement)("input",{id:"_heading5",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 5"}}),this.heading5.addEventListener("keyup",this.changeStyleClickHandler),this.td12.appendChild(this.heading5),this.tr6.appendChild(this.td11),this.tr6.appendChild(this.td12),this.tr7=(0,a.createElement)("tr"),this.td13=(0,a.createElement)("td"),this.heading6Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 6",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading6Label"}),this.td13.appendChild(this.heading6Label),this.td14=(0,a.createElement)("td"),this.heading6=(0,a.createElement)("input",{id:"_heading6",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 6"}}),this.heading6.addEventListener("keyup",this.changeStyleClickHandler),this.td14.appendChild(this.heading6),this.tr7.appendChild(this.td13),this.tr7.appendChild(this.td14),this.tr8=(0,a.createElement)("tr"),this.td15=(0,a.createElement)("td"),this.heading7Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 7",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading7Label"}),this.td15.appendChild(this.heading7Label),this.td16=(0,a.createElement)("td"),this.heading7=(0,a.createElement)("input",{id:"_heading7",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 7"}}),this.heading7.addEventListener("keyup",this.changeStyleClickHandler),this.td16.appendChild(this.heading7),this.tr8.appendChild(this.td15),this.tr8.appendChild(this.td16),this.tr9=(0,a.createElement)("tr"),this.td17=(0,a.createElement)("td"),this.heading8Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 8",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading8Label"}),this.td17.appendChild(this.heading8Label),this.td18=(0,a.createElement)("td"),this.heading8=(0,a.createElement)("input",{id:"_heading8",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 8"}}),this.heading8.addEventListener("keyup",this.changeStyleClickHandler),this.td18.appendChild(this.heading8),this.tr9.appendChild(this.td17),this.tr9.appendChild(this.td18),this.tr10=(0,a.createElement)("tr"),this.td19=(0,a.createElement)("td"),this.heading9Label=(0,a.createElement)("label",{innerHTML:e.getConstant("Heading")+" 9",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading9Label"}),this.td19.appendChild(this.heading9Label),this.td20=(0,a.createElement)("td"),this.heading9=(0,a.createElement)("input",{id:"_heading9",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Heading")+" 9"}}),this.heading9.addEventListener("keyup",this.changeStyleClickHandler),this.td20.appendChild(this.heading9),this.tr10.appendChild(this.td19),this.tr10.appendChild(this.td20),this.tr12=(0,a.createElement)("tr"),this.td23=(0,a.createElement)("td"),this.normalLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Normal"),className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_normalLabel"}),this.td23.appendChild(this.normalLabel),this.td24=(0,a.createElement)("td"),this.normal=(0,a.createElement)("input",{id:"_normal",className:"e-input e-de-toc-dlg-toc-level",attrs:{"aria-label":e.getConstant("Normal")}}),this.normal.addEventListener("keyup",this.changingStyleClickHandler),this.td24.appendChild(this.normal),this.tr12.appendChild(this.td23),this.tr12.appendChild(this.td24),t&&(this.normal.classList.add("e-de-rtl"),this.heading1.classList.add("e-de-rtl"),this.heading2.classList.add("e-de-rtl"),this.heading3.classList.add("e-de-rtl"),this.heading4.classList.add("e-de-rtl"),this.heading5.classList.add("e-de-rtl"),this.heading6.classList.add("e-de-rtl"),this.heading7.classList.add("e-de-rtl"),this.heading8.classList.add("e-de-rtl"),this.heading9.classList.add("e-de-rtl")),this.table1.appendChild(this.tr2),this.table1.appendChild(this.tr3),this.table1.appendChild(this.tr4),this.table1.appendChild(this.tr5),this.table1.appendChild(this.tr6),this.table1.appendChild(this.tr7),this.table1.appendChild(this.tr8),this.table1.appendChild(this.tr9),this.table1.appendChild(this.tr10),this.table1.appendChild(this.tr12),this.tableDiv.appendChild(this.table1),this.stylesLevelDiv=(0,a.createElement)("div",{className:"e-de-toc-styles-table-div"}),this.stylesLevelDiv.appendChild(this.table),this.stylesLevelDiv.appendChild(this.tableDiv),this.leftBottomGeneralDiv.appendChild(this.stylesLevelDiv),this.fieldsDiv=(0,a.createElement)("div",{id:"fields_div",styles:"display: flex;"}),this.leftBottomGeneralDiv.appendChild(this.fieldsDiv),this.outDiv=(0,a.createElement)("div",{id:"out_div"}),this.outlineDiv=(0,a.createElement)("div",{id:"outline_div",className:"e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels"}),this.outline1=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:"_outline"}),this.outlineDiv.appendChild(this.outline1),this.outDiv.appendChild(this.outlineDiv),this.fieldsDiv.appendChild(this.outDiv),this.outline=new tl.CheckBox({label:e.getConstant("Outline levels"),enableRtl:t,checked:!0,cssClass:"e-de-outline-rtl"}),this.outline.appendTo(this.outline1),this.resetButtonDiv=(0,a.createElement)("div",{className:"e-de-toc-reset-button"}),this.fieldsDiv.appendChild(this.resetButtonDiv),this.resetElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Reset"),id:"reset",attrs:{type:"button"}}),this.resetButtonDiv.appendChild(this.resetElement),this.resetButton=new tl.Button({cssClass:"e-btn e-flat"}),this.resetButton.appendTo(this.resetElement),this.resetElement.addEventListener("click",this.resetClickHandler),this.tocStylesLabel=(0,a.createElement)("div",{id:i+"_tocStylesLabel",className:"e-de-toc-dlg-main-heading",innerHTML:e.getConstant("Styles")+":"}),this.rightBottomGeneralDiv.appendChild(this.tocStylesLabel),this.textBoxDiv=(0,a.createElement)("div"),this.rightBottomGeneralDiv.appendChild(this.textBoxDiv),this.textBoxInput=(0,a.createElement)("input",{className:"e-input",attrs:{"aria-label":"Type of TOC"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxDiv.appendChild(this.textBoxInput),this.listViewDiv=(0,a.createElement)("div",{className:"e-de-toc-list-view"});var o=this.styleLocaleValue(["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"],e);this.listViewInstance=new il.ListView({dataSource:o,cssClass:"e-toc-list-view"}),this.listViewInstance.appendTo(this.listViewDiv),this.listViewInstance.addEventListener("select",this.selectHandlerClickHandler),this.rightBottomGeneralDiv.appendChild(this.listViewDiv),this.modifyButtonDiv=(0,a.createElement)("div",{className:"e-de-toc-modify-button"}),this.rightBottomGeneralDiv.appendChild(this.modifyButtonDiv),this.modifyElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}}),this.modifyButtonDiv.appendChild(this.modifyElement),this.modifyButton=new tl.Button({cssClass:"e-btn e-flat"}),this.modifyButton.appendTo(this.modifyElement),this.modifyElement.addEventListener("click",this.showDialogHandler),t&&(this.resetButtonDiv.classList.add("e-de-rtl"),this.tocStylesLabel.classList.add("e-de-rtl"),this.textBoxDiv.classList.add("e-de-rtl"),this.listViewDiv.classList.add("e-de-rtl"),this.modifyButtonDiv.classList.add("e-de-rtl"))},e.prototype.styleLocaleValue=function(e,t){for(var i=[],n=0;n<e.length;n++)i.push(t.getConstant(e[n]));return i},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOfContentDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog3.header=e.getConstant("Table of Contents"),this.documentHelper.dialog3.position={X:"center",Y:"center"},this.documentHelper.dialog3.width="auto",this.documentHelper.dialog3.height="auto",this.documentHelper.dialog3.content=this.target,this.documentHelper.dialog3.beforeOpen=this.loadTableofContentDialog,this.documentHelper.dialog3.close=this.closeTableOfContentDialog,this.documentHelper.dialog3.buttons=[{click:this.applyTableOfContentProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-toc-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-toc-cancel"}}],this.documentHelper.dialog3.dataBind(),this.documentHelper.dialog3.show()},e.prototype.onSelectHandlerClick=function(e){this.selectHandler(e)},e.prototype.onShowDialog=function(){this.showStyleDialog()},e.prototype.changeShowLevelValue=function(e){var t=[];switch(e.value){case 1:t=["1",null,null,null,null,null,null,null,null],this.changeByValue(t);break;case 2:t=["1","2",null,null,null,null,null,null,null],this.changeByValue(t);break;case 3:t=["1","2","3",null,null,null,null,null,null],this.changeByValue(t);break;case 4:t=["1","2","3","4",null,null,null,null,null],this.changeByValue(t);break;case 5:t=["1","2","3","4","5",null,null,null,null],this.changeByValue(t);break;case 6:t=["1","2","3","4","5","6",null,null,null],this.changeByValue(t);break;case 7:t=["1","2","3","4","5","6","7",null,null],this.changeByValue(t);break;case 8:t=["1","2","3","4","5","6","7","8",null],this.changeByValue(t);break;case 9:t=["1","2","3","4","5","6","7","8","9"],this.changeByValue(t)}},e.prototype.changeByValue=function(e){this.heading1.value=e[0],this.heading2.value=e[1],this.heading3.value=e[2],this.heading4.value=e[3],this.heading5.value=e[4],this.heading6.value=e[5],this.heading7.value=e[6],this.heading8.value=e[7],this.heading9.value=e[8]},e.prototype.onResetClick=function(){this.reset()},e.prototype.onChangeStyleClick=function(e){this.changeStyle(e)},e.prototype.initAlertDialog=function(e){var t=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale);var i=e?t.getConstant("The number must be between"):t.getConstant("The Invalid number");el.DialogUtility.alert({title:t.getConstant("Information"),content:i,closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.documentHelper.owner.enableRtl},e.prototype.checkLevel=function(){""!==this.heading1.value&&(this.showLevel.value=1),""!==this.heading2.value&&(this.showLevel.value=2),""!==this.heading3.value&&(this.showLevel.value=3),""!==this.heading4.value&&(this.showLevel.value=4),""!==this.heading5.value&&(this.showLevel.value=5),""!==this.heading6.value&&(this.showLevel.value=6),""!==this.heading7.value&&(this.showLevel.value=7),""!==this.heading8.value&&(this.showLevel.value=8),""!==this.heading9.value&&(this.showLevel.value=9)},e.prototype.getElementValue=function(e){switch(e){case this.heading1:return"1";case this.heading2:return"2";case this.heading3:return"3";case this.heading4:return"4";case this.heading5:return"5";case this.heading6:return"6";case this.heading7:return"7";case this.heading8:return"8";case this.heading9:return"9";default:return"1"}},e.prototype.onChangingStyleClick=function(e){this.changeHeadingStyle(e)},e.prototype.getHeadingLevel=function(e){switch(e){case 1:return parseInt(this.heading1.value);case 2:return parseInt(this.heading2.value);case 3:return parseInt(this.heading3.value);case 4:return parseInt(this.heading4.value);case 5:return parseInt(this.heading5.value);case 6:return parseInt(this.heading6.value);case 7:return parseInt(this.heading7.value);case 8:return parseInt(this.heading8.value);case 9:return parseInt(this.heading9.value);default:return 0}},e.prototype.applyLevelSetting=function(e){e.levelSettings={};for(var t=0,i=0,n=!1,r=1;r<=e.endLevel;r++){var o=this.getTOCInputValue(r);if(r===(d=this.getHeadingLevel(r))&&o.match(/^[0-9]+$/))0===t&&(t=r,n=!1),n||(i=r);else{if(n=!0,!o.match(/^[0-9]+$/))return this.initAlertDialog(!1),!1;if(d<1||d>9)return this.initAlertDialog(!0),!1;var s="Heading "+r.toString();e.levelSettings[s]=d}}if(e.startLevel=t,e.endLevel=i,i)for(var a=i+1;a<=9;a++){var l=this.getTOCInputValue(a),d=this.getHeadingLevel(a);if(!l.match(/^[0-9]+$/)&&""!==l)return this.initAlertDialog(!1),!1;if(d<1||d>9)return this.initAlertDialog(!0),!1}if(""!==this.normal.value){var h=parseInt(this.normal.value);if(!this.normal.value.match(/^[0-9]+$/))return this.initAlertDialog(!1),!1;if(h<1||h>9)return this.initAlertDialog(!0),!1;e.levelSettings.Normal=h}return!0},e.prototype.getTOCInputValue=function(e){switch(e){case 1:return this.heading1.value;case 2:return this.heading2.value;case 3:return this.heading3.value;case 4:return this.heading4.value;case 5:return this.heading5.value;case 6:return this.heading6.value;case 7:return this.heading7.value;case 8:return this.heading8.value;case 9:return this.heading9.value;default:return""}},e.prototype.destroy=function(){if(this.pageNumber&&(this.pageNumber.destroy(),this.pageNumber=void 0),this.rightAlign&&(this.rightAlign.destroy(),this.rightAlign=void 0),this.tabLeader&&(this.tabLeader.destroy(),this.tabLeader=void 0),this.showLevel&&(this.showLevel.destroy(),this.showLevel=void 0),this.hyperlink&&(this.hyperlink.destroy(),this.hyperlink=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.outline&&(this.outline.destroy(),this.outline=void 0),this.listViewInstance&&(this.listViewInstance.destroy(),this.listViewInstance=void 0),this.removeEvents(),this.removeElements(),this.heading1=void 0,this.heading2=void 0,this.heading3=void 0,this.heading4=void 0,this.heading5=void 0,this.heading6=void 0,this.heading7=void 0,this.heading8=void 0,this.heading9=void 0,this.normal=void 0,this.textBoxInput=void 0,this.documentHelper=void 0,!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e.prototype.removeEvents=function(){this.heading1&&this.heading1.removeEventListener("keyup",this.changeStyleClickHandler),this.heading2&&this.heading2.removeEventListener("keyup",this.changeStyleClickHandler),this.heading3&&this.heading3.removeEventListener("keyup",this.changeStyleClickHandler),this.heading4&&this.heading4.removeEventListener("keyup",this.changeStyleClickHandler),this.heading5&&this.heading5.removeEventListener("keyup",this.changeStyleClickHandler),this.heading6&&this.heading6.removeEventListener("keyup",this.changeStyleClickHandler),this.heading7&&this.heading7.removeEventListener("keyup",this.changeStyleClickHandler),this.heading8&&this.heading8.removeEventListener("keyup",this.changeStyleClickHandler),this.heading9&&this.heading9.removeEventListener("keyup",this.changeStyleClickHandler),this.normal&&this.normal.removeEventListener("keyup",this.changingStyleClickHandler),this.resetElement&&this.resetElement.removeEventListener("click",this.resetClickHandler),this.listViewInstance&&this.listViewInstance.removeEventListener("select",this.selectHandlerClickHandler),this.modifyElement&&this.modifyElement.removeEventListener("click",this.showDialogHandler)},e.prototype.removeElements=function(){this.generalDiv&&(this.generalDiv.remove(),this.generalDiv=void 0),this.genLabel&&(this.genLabel.remove(),this.genLabel=void 0),this.topContainer&&(this.topContainer.remove(),this.topContainer=void 0),this.leftGeneralDiv&&(this.leftGeneralDiv.remove(),this.leftGeneralDiv=void 0),this.rightGeneralDiv&&(this.rightGeneralDiv.remove(),this.rightGeneralDiv=void 0),this.bottomContainer&&(this.bottomContainer.remove(),this.bottomContainer=void 0),this.leftBottomGeneralDiv&&(this.leftBottomGeneralDiv.remove(),this.leftBottomGeneralDiv=void 0),this.rightBottomGeneralDiv&&(this.rightBottomGeneralDiv.remove(),this.rightBottomGeneralDiv=void 0),this.pageNumberDiv&&(this.pageNumberDiv.remove(),this.pageNumberDiv=void 0),this.pageNumber1&&(this.pageNumber1.remove(),this.pageNumber1=void 0),this.rightAlignDiv&&(this.rightAlignDiv.remove(),this.rightAlignDiv=void 0),this.rightAlign1&&(this.rightAlign1.remove(),this.rightAlign1=void 0),this.tabDivContainer&&(this.tabDivContainer.remove(),this.tabDivContainer=void 0),this.tabDiv&&(this.tabDiv.remove(),this.tabDiv=void 0),this.tabLeaderLabelDiv&&(this.tabLeaderLabelDiv.remove(),this.tabLeaderLabelDiv=void 0),this.tabLeaderLabel&&(this.tabLeaderLabel.remove(),this.tabLeaderLabel=void 0),this.tabLeaderDiv&&(this.tabLeaderDiv.remove(),this.tabLeaderDiv=void 0),this.tabLeader1&&(this.tabLeader1.remove(),this.tabLeader1=void 0),this.hyperlink1&&(this.hyperlink1.remove(),this.hyperlink1=void 0),this.hyperlink1&&(this.hyperlink1.remove(),this.hyperlink1=void 0),this.showDiv&&(this.showDiv.remove(),this.showDiv=void 0),this.showLevelLabelDiv&&(this.showLevelLabelDiv.remove(),this.showLevelLabelDiv=void 0),this.showLevelLabel&&(this.showLevelLabel.remove(),this.showLevelLabel=void 0),this.showLevelDiv&&(this.showLevelDiv.remove(),this.showLevelDiv=void 0),this.showLevel1&&(this.showLevel1.remove(),this.showLevel1=void 0),this.buildTableLabel&&(this.buildTableLabel.remove(),this.buildTableLabel=void 0),this.table&&(this.table.remove(),this.table=void 0),this.tr1&&(this.tr1.remove(),this.tr1=void 0),this.td1&&(this.td1.remove(),this.td1=void 0),this.availableLabel&&(this.availableLabel.remove(),this.availableLabel=void 0),this.td2&&(this.td2.remove(),this.td2=void 0),this.tocLabel&&(this.tocLabel.remove(),this.tocLabel=void 0),this.tableDiv&&(this.tableDiv.remove(),this.tableDiv=void 0),this.table1&&(this.table1.remove(),this.table1=void 0),this.tr2&&(this.tr2.remove(),this.tr2=void 0),this.td3&&(this.td3.remove(),this.td3=void 0),this.heading1Label&&(this.heading1Label.remove(),this.heading1Label=void 0),this.td4&&(this.td4.remove(),this.td4=void 0),this.tr3&&(this.tr3.remove(),this.tr3=void 0),this.td5&&(this.td5.remove(),this.td5=void 0),this.heading2Label&&(this.heading2Label.remove(),this.heading2Label=void 0),this.td6&&(this.td6.remove(),this.td6=void 0),this.tr4&&(this.tr4.remove(),this.tr4=void 0),this.td7&&(this.td7.remove(),this.td7=void 0),this.heading3Label&&(this.heading3Label.remove(),this.heading3Label=void 0),this.td8&&(this.td8.remove(),this.td8=void 0),this.tr5&&(this.tr5.remove(),this.tr5=void 0),this.td9&&(this.td9.remove(),this.td9=void 0),this.heading4Label&&(this.heading4Label.remove(),this.heading4Label=void 0),this.td10&&(this.td10.remove(),this.td10=void 0),this.tr6&&(this.tr6.remove(),this.tr6=void 0),this.td11&&(this.td11.remove(),this.td11=void 0),this.heading5Label&&(this.heading5Label.remove(),this.heading5Label=void 0),this.td12&&(this.td12.remove(),this.td12=void 0),this.tr7&&(this.tr7.remove(),this.tr7=void 0),this.td13&&(this.td13.remove(),this.td13=void 0),this.heading6Label&&(this.heading6Label.remove(),this.heading6Label=void 0),this.td14&&(this.td14.remove(),this.td14=void 0),this.tr8&&(this.tr8.remove(),this.tr8=void 0),this.td15&&(this.td15.remove(),this.td15=void 0),this.heading7Label&&(this.heading7Label.remove(),this.heading7Label=void 0),this.td16&&(this.td16.remove(),this.td16=void 0),this.tr9&&(this.tr9.remove(),this.tr9=void 0),this.td17&&(this.td17.remove(),this.td17=void 0),this.heading8Label&&(this.heading8Label.remove(),this.heading8Label=void 0),this.td18&&(this.td18.remove(),this.td18=void 0),this.tr10&&(this.tr10.remove(),this.tr10=void 0),this.td19&&(this.td19.remove(),this.td19=void 0),this.heading9Label&&(this.heading9Label.remove(),this.heading9Label=void 0),this.td20&&(this.td20.remove(),this.td20=void 0),this.tr12&&(this.tr12.remove(),this.tr12=void 0),this.td23&&(this.td23.remove(),this.td23=void 0),this.normalLabel&&(this.normalLabel.remove(),this.normalLabel=void 0),this.td24&&(this.td24.remove(),this.td24=void 0),this.stylesLevelDiv&&(this.stylesLevelDiv.remove(),this.stylesLevelDiv=void 0),this.fieldsDiv&&(this.fieldsDiv.remove(),this.fieldsDiv=void 0),this.outDiv&&(this.outDiv.remove(),this.outDiv=void 0),this.outlineDiv&&(this.outlineDiv.remove(),this.outlineDiv=void 0),this.outline1&&(this.outline1.remove(),this.outline1=void 0),this.resetButtonDiv&&(this.resetButtonDiv.remove(),this.resetButtonDiv=void 0),this.resetElement&&(this.resetElement.remove(),this.resetElement=void 0),this.resetButton&&(this.resetButton.destroy(),this.resetButton=void 0),this.tocStylesLabel&&(this.tocStylesLabel.remove(),this.tocStylesLabel=void 0),this.textBoxDiv&&(this.textBoxDiv.remove(),this.textBoxDiv=void 0),this.listViewDiv&&(this.listViewDiv.remove(),this.listViewDiv=void 0),this.modifyButtonDiv&&(this.modifyButtonDiv.remove(),this.modifyButtonDiv=void 0),this.modifyElement&&(this.modifyElement.remove(),this.modifyElement=void 0),this.modifyButton&&(this.modifyButton.destroy(),this.modifyButton=void 0)},e}(),Uh=function(){function e(e){var t=this;this.isPortrait=!0,this.keyUpInsertPageSettingsClickHandler=this.onKeyUpInsertPageSettingsClick.bind(this),this.loadPageSetupDialog=function(){t.documentHelper.updateFocus();var e=t.documentHelper.selection.sectionFormat;t.topMarginBox.value=e.topMargin,t.leftMarginBox.value=e.leftMargin,t.bottomMarginBox.value=e.bottomMargin,t.rightMarginBox.value=e.rightMargin,t.widthBox.value=e.pageWidth,t.heightBox.value=e.pageHeight,t.checkBox1.checked=e.differentOddAndEvenPages,t.checkBox2.checked=e.differentFirstPage,t.headerBox.value=e.headerDistance,t.footerBox.value=e.footerDistance,t.widthBox.value>t.heightBox.value?t.landscape.checked=!0:t.portrait.checked=!0,t.setPageSize(t.portrait.checked,parseFloat(e.pageWidth.toFixed(1)),parseFloat(e.pageHeight.toFixed(1)))},this.closePageSetupDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.keyUpInsertPageSettings=function(e){13===e.keyCode&&t.applyPageSetupProperties()},this.applyPageSetupProperties=function(){var e=new ga,i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale);var n=t.documentHelper.selection.sectionFormat;if(e.bottomMargin=t.bottomMarginBox.value,e.topMargin=t.topMarginBox.value,e.leftMargin=t.leftMarginBox.value,e.rightMargin=t.rightMarginBox.value,e.pageWidth=t.widthBox.value,e.pageHeight=t.heightBox.value,e.differentOddAndEvenPages=t.checkBox1.checked,e.differentFirstPage=t.checkBox2.checked,e.headerDistance=t.headerBox.value,e.footerDistance=t.footerBox.value,t.widthBox.value<t.leftMarginBox.value+t.rightMarginBox.value)el.DialogUtility.alert(i.getConstant("Left and right margins."));else if(t.widthBox.value<t.leftMarginBox.value+t.rightMarginBox.value+36)el.DialogUtility.alert(i.getConstant("Column width cannot be less than 36 pt."));else if(Math.abs(t.topMarginBox.value+t.bottomMarginBox.value)>t.heightBox.value)el.DialogUtility.alert(i.getConstant("The top/bottom margins are too large for the page height in some sections."));else{e.numberOfColumns=n.numberOfColumns,e.equalWidth=n.equalWidth,e.lineBetweenColumns=n.lineBetweenColumns;for(var r=[],o=Pa.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),s=0;s<n.columns.length;s++){var l=new ma,d=Pa.convertPointToPixel(n.columns[parseInt(s.toString(),10)].width),h=Pa.convertPointToPixel(n.columns[parseInt(s.toString(),10)].space),c=(n.numberOfColumns-1)*h;!n.equalWidth&&0!==d||(0,a.isNullOrUndefined)(o)||(d=(o-c)/n.numberOfColumns),l.width=d,l.space=h,l.index=s,r.push(l)}e.columns=r,n.pageHeight===e.pageHeight&&n.pageWidth===e.pageWidth&&(e.breakCode=n.breakCode),t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e),t.documentHelper.hideDialog()}},this.changeByPaperSize=function(e){var i=e.value;t.documentHelper.selection.sectionFormat.pageWidth>t.documentHelper.selection.sectionFormat.pageHeight||t.landscape.checked?(t.isPortrait=!1,t.portrait.checked=!1):t.isPortrait=!0,"letter"===i?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=792):(t.widthBox.value=792,t.heightBox.value=612):"tabloid"===i?t.isPortrait?(t.widthBox.value=792,t.heightBox.value=1224):(t.widthBox.value=1224,t.heightBox.value=792):"legal"===i?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=1008):(t.widthBox.value=1008,t.heightBox.value=612):"statement"===i?t.isPortrait?(t.widthBox.value=392,t.heightBox.value=612):(t.widthBox.value=612,t.heightBox.value=392):"executive"===i?t.isPortrait?(t.widthBox.value=522,t.heightBox.value=756):(t.widthBox.value=756,t.heightBox.value=522):"a3"===i?t.isPortrait?(t.widthBox.value=841.9,t.heightBox.value=1190.55):(t.widthBox.value=1190.55,t.heightBox.value=841.9):"a4"===i?t.isPortrait?(t.widthBox.value=595.3,t.heightBox.value=841.9):(t.widthBox.value=841.9,t.heightBox.value=595.3):"a5"===i?t.isPortrait?(t.widthBox.value=419.55,t.heightBox.value=595.3):(t.widthBox.value=595.3,t.heightBox.value=419.55):"b4"===i?t.isPortrait?(t.widthBox.value=728.5,t.heightBox.value=1031.8):(t.widthBox.value=1031.8,t.heightBox.value=728.5):"b5"===i?t.isPortrait?(t.widthBox.value=515.9,t.heightBox.value=728.5):(t.widthBox.value=728.5,t.heightBox.value=515.9):"customsize"===i&&(t.isPortrait,t.widthBox.value=t.documentHelper.selection.sectionFormat.pageWidth,t.heightBox.value=t.documentHelper.selection.sectionFormat.pageHeight)},this.onPortrait=function(){t.landscape.checked=!1;var e=t.widthBox.value,i=t.heightBox.value;e>i&&(t.widthBox.value=i,t.heightBox.value=e)},this.onLandscape=function(){t.portrait.checked=!1;var e=t.widthBox.value,i=t.heightBox.value;e<i&&(t.widthBox.value=i,t.heightBox.value=e)},this.unWireEventsAndBindings=function(){t.paperSize.value=void 0,t.topMarginBox.value=void 0,t.bottomMarginBox.value=void 0,t.leftMarginBox.value=void 0,t.rightMarginBox.value=void 0,t.headerBox.value=void 0,t.footerBox.value=void 0,t.widthBox.value=void 0,t.heightBox.value=void 0,t.checkBox1.checked=!1,t.checkBox2.checked=!1,t.portrait.checked=!1,t.landscape.checked=!1},this.documentHelper=e}return e.prototype.getModuleName=function(){return"PageSetupDialog"},e.prototype.initPageSetupDialog=function(e,t){this.target=(0,a.createElement)("div"),this.ejtabContainer=(0,a.createElement)("div"),this.target.appendChild(this.ejtabContainer),this.marginTab=(0,a.createElement)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.paperTab=(0,a.createElement)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.layoutTab=(0,a.createElement)("div",{styles:"position: relative;",className:"e-de-dlg-tab-first-child"}),this.ejtab=(0,a.createElement)("div",{className:"e-de-page-setup-ppty-tab"}),this.headerContainer=(0,a.createElement)("div",{className:"e-tab-header"}),this.marginHeader=(0,a.createElement)("div",{innerHTML:e.getConstant("Margin")}),this.paperHeader=(0,a.createElement)("div",{innerHTML:e.getConstant("Paper")}),this.layoutHeader=(0,a.createElement)("div",{innerHTML:e.getConstant("Layout")}),this.headerContainer.appendChild(this.marginHeader),this.headerContainer.appendChild(this.paperHeader),this.headerContainer.appendChild(this.layoutHeader),this.marginContent=(0,a.createElement)("div"),this.paperContent=(0,a.createElement)("div"),this.layoutContent=(0,a.createElement)("div"),this.marginContent.appendChild(this.marginTab),this.paperContent.appendChild(this.paperTab),this.layoutContent.appendChild(this.layoutTab),this.ejtabContainer.appendChild(this.ejtab),this.initMarginProperties(this.marginTab,e,t),this.initPaperSizeProperties(this.paperTab,e,t),this.initLayoutProperties(this.layoutTab,e,t);var i=[{header:{text:this.marginHeader},content:this.marginContent},{header:{text:this.paperHeader},content:this.paperContent},{header:{text:this.layoutHeader},content:this.layoutContent}];new ua.Tab({items:i,enableRtl:t},this.ejtab).isStringTemplate=!0,this.target.addEventListener("keyup",this.keyUpInsertPageSettingsClickHandler)},e.prototype.initMarginProperties=function(e,t,i){var n;this.marginDiv=(0,a.createElement)("div"),this.leftMarginDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.marginDiv.appendChild(this.leftMarginDiv),this.rightMarginDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.marginDiv.appendChild(this.rightMarginDiv),i&&(this.leftMarginDiv.classList.add("e-de-rtl"),this.rightMarginDiv.classList.add("e-de-rtl")),this.topTextBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.bottomTextBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.topContainer=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.topContainer.appendChild(this.topTextBox),this.leftMarginDiv.appendChild(this.topContainer),this.bottomContainer=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.bottomContainer.appendChild(this.bottomTextBox),this.leftMarginDiv.appendChild(this.bottomContainer),this.leftTextBox=(0,a.createElement)("input",{attrs:{type:"text"},id:this.target.id+"_left"}),this.rightTextBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.leftContainer=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.leftContainer.appendChild(this.leftTextBox),this.rightMarginDiv.appendChild(this.leftContainer),this.rightContainer=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.rightContainer.appendChild(this.rightTextBox),this.rightMarginDiv.appendChild(this.rightContainer),e.appendChild(this.marginDiv),this.topMarginBox=new rl.NumericTextBox({value:71,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Top")}),this.topMarginBox.appendTo(this.topTextBox),this.leftMarginBox=new rl.NumericTextBox({value:73,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Left")}),this.leftMarginBox.appendTo(this.leftTextBox),this.bottomMarginBox=new rl.NumericTextBox({value:72,max:1584,min:-1584,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Bottom")}),this.bottomMarginBox.appendTo(this.bottomTextBox),this.rightMarginBox=new rl.NumericTextBox({value:74,max:1584,min:0,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Right")}),this.rightMarginBox.appendTo(this.rightTextBox),this.orientationDiv=(0,a.createElement)("div"),this.orientationLabeldiv=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("Orientation")}),this.orientationPropDiv=(0,a.createElement)("div",{styles:"display: flex;"}),this.topTextBox.setAttribute("aria-labelledby",t.getConstant("Top")),this.bottomTextBox.setAttribute("aria-labelledby",t.getConstant("Bottom")),this.leftTextBox.setAttribute("aria-labelledby",t.getConstant("Left")),this.rightTextBox.setAttribute("aria-labelledby",t.getConstant("Right")),n=i?"padding-left: 30px;":"padding-right: 30px;",this.portraitDiv=(0,a.createElement)("div",{id:"_portraitDiv",styles:n});var r=(0,a.createElement)("input",{attrs:{type:"radiobutton"}});this.landscapeDiv=(0,a.createElement)("div",{id:"_landscapeDiv"});var o=(0,a.createElement)("input",{attrs:{type:"radiobutton"}});this.portraitDiv.appendChild(r),this.landscapeDiv.appendChild(o),this.orientationPropDiv.appendChild(this.portraitDiv),this.orientationPropDiv.appendChild(this.landscapeDiv),this.orientationDiv.appendChild(this.orientationLabeldiv),this.orientationDiv.appendChild(this.orientationPropDiv),this.portrait=new tl.RadioButton({label:t.getConstant("Portrait"),checked:!0,enableRtl:i,change:this.onPortrait}),this.landscape=new tl.RadioButton({label:t.getConstant("Landscape"),enableRtl:i,change:this.onLandscape}),this.portrait.appendTo(r),this.landscape.appendTo(o),e.appendChild(this.orientationDiv),r.setAttribute("aria-label",t.getConstant("Portrait")),o.setAttribute("aria-label",t.getConstant("Landscape"))},e.prototype.initPaperSizeProperties=function(e,t,i){this.sizeDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.leftSizeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.sizeDiv.appendChild(this.leftSizeDiv),this.rightSizeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.sizeDiv.appendChild(this.rightSizeDiv),i&&(this.leftSizeDiv.classList.add("e-de-rtl"),this.rightSizeDiv.classList.add("e-de-rtl")),this.widthTextBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.leftSizeDiv.appendChild(this.widthTextBox),this.heightTextBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.rightSizeDiv.appendChild(this.heightTextBox),e.appendChild(this.sizeDiv),this.widthBox=new rl.NumericTextBox({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Width")}),this.widthBox.appendTo(this.widthTextBox),this.heightBox=new rl.NumericTextBox({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Height")}),this.heightBox.appendTo(this.heightTextBox),this.widthTextBox.setAttribute("arial-label",t.getConstant("Width")),this.heightTextBox.setAttribute("arial-label",t.getConstant("Height")),this.paperSizeDiv=(0,a.createElement)("div");var n=(0,a.createElement)("select",{styles:"width:170px;padding-bottom: 20px;",innerHTML:'<option value="letter">'+t.getConstant("Letter")+'</option><option value="tabloid">'+t.getConstant("Tabloid")+'</option><option value="legal">'+t.getConstant("Legal")+'</option><option value="statement">'+t.getConstant("Statement")+'</option><option value="executive">'+t.getConstant("Executive")+'</option><option value="a3">'+t.getConstant("A3")+'</option><option value="a4">'+t.getConstant("A4")+'</option><option value="a5">'+t.getConstant("A5")+'</option><option value="b4">'+t.getConstant("B4")+'</option><option value="b5">'+t.getConstant("B5")+'</option><option value="customsize">'+t.getConstant("Custom Size")+"</option>"});this.paperSizeDiv.appendChild(n),this.paperSize=new al.DropDownList({change:this.changeByPaperSize,width:"170px",enableRtl:i}),this.paperSize.appendTo(n),this.paperSize.htmlAttributes={"aria-labelledby":"PaperSize","aria-describedby":"PaperSize"},e.appendChild(this.paperSizeDiv)},e.prototype.initLayoutProperties=function(e,t,i){this.layoutDiv=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.firstPageDiv=(0,a.createElement)("div",{styles:"height: 27px;"});var n=(0,a.createElement)("input",{attrs:{type:"checkbox"}});this.firstPageDiv.appendChild(n),this.oddOrEvenDiv=(0,a.createElement)("div",{styles:"height: 27px;"});var r=(0,a.createElement)("input",{attrs:{type:"checkbox"}});this.firstPageDiv.setAttribute("aria-label",t.getConstant("Different first page")),this.oddOrEvenDiv.setAttribute("aria-label",t.getConstant("Different odd and even")),this.oddOrEvenDiv.appendChild(r),this.layoutDiv.appendChild(this.firstPageDiv),this.layoutDiv.appendChild(this.oddOrEvenDiv),this.checkBox1=new tl.CheckBox({label:t.getConstant("Different odd and even"),enableRtl:i}),this.checkBox2=new tl.CheckBox({label:t.getConstant("Different first page"),enableRtl:i}),this.checkBox1.appendTo(n),this.checkBox2.appendTo(r),e.appendChild(this.layoutDiv),this.textLabelDiv=(0,a.createElement)("div"),this.textLabel=(0,a.createElement)("label",{className:"e-de-para-dlg-heading",innerHTML:t.getConstant("From edge")}),this.textLabelDiv.appendChild(this.textLabel),e.appendChild(this.textLabelDiv),this.propertyDiv=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.leftLayoutDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.propertyDiv.appendChild(this.leftLayoutDiv),this.rightLayoutDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.propertyDiv.appendChild(this.rightLayoutDiv),i&&(this.rightLayoutDiv.classList.add("e-de-rtl"),this.leftLayoutDiv.classList.add("e-de-rtl"));var o=(0,a.createElement)("input",{attrs:{type:"text"}});this.leftLayoutDiv.appendChild(o);var s=(0,a.createElement)("input",{attrs:{type:"text"}});this.rightLayoutDiv.appendChild(s),e.appendChild(this.propertyDiv),this.headerBox=new rl.NumericTextBox({value:612,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Header")}),this.headerBox.appendTo(o),this.footerBox=new rl.NumericTextBox({value:792,width:170,decimals:2,floatLabelType:"Always",placeholder:t.getConstant("Footer")}),this.footerBox.appendTo(s),o.setAttribute("aria-labelledby",t.getConstant("Header")),s.setAttribute("aria-labelledby",t.getConstant("Footer"))},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initPageSetupDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Page Setup"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadPageSetupDialog,this.documentHelper.dialog.close=this.closePageSetupDialog,this.documentHelper.dialog.buttons=[{click:this.applyPageSetupProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-layout-ppty-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-layout-ppty-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.dialogElement=this.documentHelper.dialog.element,this.dialogElement&&this.documentHelper.updateDialogTabHeight(this.dialogElement,this.target)},e.prototype.setPageSize=function(e,t,i){this.paperSize.value=e&&612===t&&792===i||!e&&792===t&&612===i?"letter":e&&792===t&&1224===i||!e&&1224===t&&792===i?"tabloid":e&&612===t&&1008===i||!e&&1008===t&&612===i?"legal":e&&392===t&&612===i||!e&&392===t&&612===i?"statement":e&&522===t&&756===i||!e&&756===t&&522===i?"executive":e&&841.9===t&&1190.5===i||!e&&1190.5===t&&841.9===i?"a3":e&&595.3===t&&841.9===i||!e&&841.9===t&&595.3===i?"a4":e&&419.6===t&&595.3===i||!e&&595.3===t&&419.6===i?"a5":e&&728.5===t&&1031.8===i||!e&&1031.8===t&&728.5===i?"b4":e&&515.9===t&&728.5===i||!e&&728.5===t&&515.9===i?"b5":"customsize"},e.prototype.onKeyUpInsertPageSettingsClick=function(e){this.keyUpInsertPageSettings(e)},e.prototype.destroy=function(){if(this.topMarginBox&&(this.topMarginBox.destroy(),this.topMarginBox=void 0),this.leftMarginBox&&(this.leftMarginBox.destroy(),this.leftMarginBox=void 0),this.bottomMarginBox&&(this.bottomMarginBox.destroy(),this.bottomMarginBox=void 0),this.rightMarginBox&&(this.rightMarginBox.destroy(),this.rightMarginBox=void 0),this.headerBox&&(this.headerBox.destroy(),this.headerBox=void 0),this.footerBox&&(this.footerBox.destroy(),this.footerBox=void 0),this.widthBox&&(this.widthBox.destroy(),this.widthBox=void 0),this.heightBox&&(this.heightBox.destroy(),this.heightBox=void 0),this.paperSize&&(this.paperSize.destroy(),this.paperSize=void 0),this.checkBox1&&(this.checkBox1.destroy(),this.checkBox1=void 0),this.checkBox2&&(this.checkBox2.destroy(),this.checkBox2=void 0),this.portrait&&(this.portrait.destroy(),this.portrait=void 0),this.landscape&&(this.landscape.destroy(),this.landscape=void 0),this.documentHelper=void 0,this.removeEvents(),this.removeElements(),!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}},e.prototype.removeEvents=function(){this.target&&this.target.removeEventListener("keyup",this.keyUpInsertPageSettingsClickHandler)},e.prototype.removeElements=function(){this.ejtabContainer&&(this.ejtabContainer.remove(),this.ejtabContainer=void 0),this.marginTab&&(this.marginTab.remove(),this.marginTab=void 0),this.paperTab&&(this.paperTab.remove(),this.paperTab=void 0),this.layoutTab&&(this.layoutTab.remove(),this.layoutTab=void 0),this.ejtab&&(this.ejtab.remove(),this.ejtab=void 0),this.headerContainer&&(this.headerContainer.remove(),this.headerContainer=void 0),this.marginHeader&&(this.marginHeader.remove(),this.marginHeader=void 0),this.paperHeader&&(this.paperHeader.remove(),this.paperHeader=void 0),this.layoutHeader&&(this.layoutHeader.remove(),this.layoutHeader=void 0),this.marginContent&&(this.marginContent.remove(),this.marginContent=void 0),this.paperContent&&(this.paperContent.remove(),this.paperContent=void 0),this.layoutContent&&(this.layoutContent.remove(),this.layoutContent=void 0),this.marginDiv&&(this.marginDiv.remove(),this.marginDiv=void 0),this.leftMarginDiv&&(this.leftMarginDiv.remove(),this.leftMarginDiv=void 0),this.rightMarginDiv&&(this.rightMarginDiv.remove(),this.rightMarginDiv=void 0),this.topTextBox&&(this.topTextBox.remove(),this.topTextBox=void 0),this.bottomTextBox&&(this.bottomTextBox.remove(),this.bottomTextBox=void 0),this.topContainer&&(this.topContainer.remove(),this.topContainer=void 0),this.bottomContainer&&(this.bottomContainer.remove(),this.bottomContainer=void 0),this.leftTextBox&&(this.leftTextBox.remove(),this.leftTextBox=void 0),this.rightTextBox&&(this.rightTextBox.remove(),this.rightTextBox=void 0),this.leftContainer&&(this.leftContainer.remove(),this.leftContainer=void 0),this.rightContainer&&(this.rightContainer.remove(),this.rightContainer=void 0),this.orientationDiv&&(this.orientationDiv.remove(),this.orientationDiv=void 0),this.orientationLabeldiv&&(this.orientationLabeldiv.remove(),this.orientationLabeldiv=void 0),this.orientationPropDiv&&(this.orientationPropDiv.remove(),this.orientationPropDiv=void 0),this.portraitDiv&&(this.portraitDiv.remove(),this.portraitDiv=void 0),this.landscapeDiv&&(this.landscapeDiv.remove(),this.landscapeDiv=void 0),this.portrait&&(this.portrait.destroy(),this.portrait=void 0),this.landscape&&(this.landscape.destroy(),this.landscape=void 0),this.sizeDiv&&(this.sizeDiv.remove(),this.sizeDiv=void 0),this.leftSizeDiv&&(this.leftSizeDiv.remove(),this.leftSizeDiv=void 0),this.rightSizeDiv&&(this.rightSizeDiv.remove(),this.rightSizeDiv=void 0),this.widthTextBox&&(this.widthTextBox.remove(),this.widthTextBox=void 0),this.heightTextBox&&(this.heightTextBox.remove(),this.heightTextBox=void 0),this.sizeDiv&&(this.sizeDiv.remove(),this.sizeDiv=void 0),this.paperSizeDiv&&(this.paperSizeDiv.remove(),this.paperSizeDiv=void 0),this.layoutDiv&&(this.layoutDiv.remove(),this.layoutDiv=void 0),this.firstPageDiv&&(this.firstPageDiv.remove(),this.firstPageDiv=void 0),this.oddOrEvenDiv&&(this.oddOrEvenDiv.remove(),this.oddOrEvenDiv=void 0),this.textLabelDiv&&(this.textLabelDiv.remove(),this.textLabelDiv=void 0),this.propertyDiv&&(this.propertyDiv.remove(),this.propertyDiv=void 0),this.leftLayoutDiv&&(this.leftLayoutDiv.remove(),this.leftLayoutDiv=void 0),this.rightLayoutDiv&&(this.rightLayoutDiv.remove(),this.rightLayoutDiv=void 0),this.dialogElement&&(this.dialogElement.remove(),this.dialogElement=void 0)},e}(),Vh=function(){function e(e){var t=this;this.leftIndent=void 0,this.rightIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.spaceBeforeAuto=!1,this.spaceAfterAuto=!1,this.textAlignment=void 0,this.paraOutlineLevel=void 0,this.firstLineIndent=void 0,this.lineSpacingIn=void 0,this.lineSpacingType=void 0,this.paragraphFormat=void 0,this.bidi=void 0,this.contextualSpacing=void 0,this.isStyleDialog=!1,this.directionDiv=void 0,this.keepWithNextValue=void 0,this.keepLineTogetherValue=void 0,this.widowControlValue=void 0,this.tabObj=void 0,this.clickBeforeSpacingClickHandler=this.onClickBeforeSpacingClick.bind(this),this.clickAfterSpacingClickHandler=this.onClickAfterSpacingClick.bind(this),this.keyUpParagraphSettingsClickHandler=this.onKeyUpParagraphSettingsClick.bind(this),this.keyUpParagraphSettings=function(e){13===e.keyCode&&t.applyParagraphFormat()},this.changeBeforeSpacing=function(e){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value?(t.beforeSpacingIn.element.value=i.getConstant("Auto"),t.beforeSpacingIn.step=1,t.spaceBeforeAuto=!0,t.beforeSpacing=5):(t.beforeSpacing=e.value,t.beforeSpacingIn.step=6,t.spaceBeforeAuto=!1)},this.focusBeforeSpacing=function(e){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value&&(t.beforeSpacingIn.element.value=i.getConstant("Auto"))},this.blurBeforeSpacing=function(e){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);if(i.setLocale(t.documentHelper.owner.locale),-1===e.value){var n=t.beforeSpacingIn;setTimeout((function(){n.element.value=i.getConstant("Auto")}),0)}},this.clickBeforeSpacing=function(){var e=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),"-1.0"===t.beforeSpacingIn.element.value&&(t.beforeSpacingIn.element.value=e.getConstant("Auto"))},this.changeAfterSpacing=function(e){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value?(t.afterSpacingIn.element.value=i.getConstant("Auto"),t.afterSpacingIn.step=1,t.spaceAfterAuto=!0,t.afterSpacing=5):(t.afterSpacing=e.value,t.afterSpacingIn.step=6,t.spaceAfterAuto=!1)},this.focusAfterSpacing=function(e){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale),-1===e.value&&(t.afterSpacingIn.element.value=i.getConstant("Auto"))},this.blurAfterSpacing=function(e){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);if(i.setLocale(t.documentHelper.owner.locale),-1===e.value){var n=t.afterSpacingIn;setTimeout((function(){n.element.value=i.getConstant("Auto")}),0)}},this.clickAfterSpacing=function(){var e=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);e.setLocale(t.documentHelper.owner.locale),"-1.0"===t.afterSpacingIn.element.value&&(t.afterSpacingIn.element.value=e.getConstant("Auto"))},this.changeLeftIndent=function(e){t.leftIndent=e.value},this.changeRightIndent=function(e){t.rightIndent=e.value},this.changeLineSpacingValue=function(e){t.lineSpacingIn=e.value},this.changeFirstLineIndent=function(e){t.firstLineIndent=e.value,2===t.special.index&&(t.firstLineIndent=-t.firstLineIndent,t.leftIndent=t.leftIndentIn.value+e.value)},this.changeByTextAlignment=function(e){t.textAlignment=e.value},this.changeByOutlineLevel=function(e){t.paraOutlineLevel=e.value},this.changeBidirectional=function(e){"ltr"===e.value?(t.rtlButton.checked=!t.ltrButton.checked,t.bidi=!1):(t.ltrButton.checked=!t.rtlButton.checked,t.bidi=!0),t.changeAlignmentByBidi()},this.changeContextualSpacing=function(e){t.contextualSpacing=e.checked},this.changeKeepWithNext=function(e){t.keepWithNextValue=e.checked},this.changeKeepLinesTogether=function(e){t.keepLineTogetherValue=e.checked},this.changeWidowControl=function(e){t.widowControlValue=e.checked},this.changeByValue=function(){var e=t.documentHelper.selection.paragraphFormat;switch(t.special.index){case 0:0!==e.firstLineIndent&&(t.byIn.value=0,t.leftIndent=t.leftIndentIn.value);break;case 1:0===e.firstLineIndent||(0,a.isNullOrUndefined)(e.firstLineIndent)?t.byIn.value=.1:e.firstLineIndent<0&&(t.byIn.value=-e.firstLineIndent,Math.abs(e.firstLineIndent)<=t.leftIndent&&(t.leftIndent=e.firstLineIndent+t.leftIndent));break;case 2:0===e.firstLineIndent||(0,a.isNullOrUndefined)(e.firstLineIndent)?e.firstLineIndent=-.1:e.firstLineIndent>0&&(t.byIn.value=e.firstLineIndent,(0,a.isNullOrUndefined)(t.leftIndent)?t.leftIndent=e.firstLineIndent:t.leftIndent=t.leftIndent+e.firstLineIndent)}},this.changeBySpacing=function(){if(!(0,a.isNullOrUndefined)(t.lineSpacing))switch(t.lineSpacing.index){case 0:t.lineSpacingType="AtLeast",t.atIn.value=12;break;case 1:t.lineSpacingType="Exactly",t.atIn.value=12;break;case 2:t.lineSpacingType="Multiple",t.atIn.value=1}},this.loadParagraphDialog=function(){var e;t.isStyleDialog?t.directionDiv.classList.add("e-de-disabledbutton"):t.directionDiv.classList.remove("e-de-disabledbutton"),e=t.paragraphFormat?t.paragraphFormat:t.documentHelper.selection.paragraphFormat;var i=t.getAlignmentValue(e.textAlignment);t.alignment.index=i;var n=t.getOutlineValue(e.outlineLevel);t.outlineLevel.index=n,t.isHeadingStyle()?t.outlineLevel.readonly=!0:t.outlineLevel.readonly=!1,e.spaceBeforeAuto?t.beforeSpacingIn.value=-1:-1===e.beforeSpacing?t.beforeSpacingIn.value=void 0:t.beforeSpacingIn.value=e.beforeSpacing,e.spaceAfterAuto?t.afterSpacingIn.value=-1:-1===e.afterSpacing?t.afterSpacingIn.value=void 0:t.afterSpacingIn.value=e.afterSpacing,t.leftIndentIn.value=e.leftIndent,t.rightIndentIn.value=e.rightIndent,t.byIn.value=Math.abs(e.firstLineIndent);var r=t.lineSpacing.index;t.keepWithNextValue=void 0,t.keepLineTogetherValue=void 0,t.widowControlValue=void 0,e.firstLineIndent>0?t.special.index=1:e.firstLineIndent<0&&(t.special.index=2,t.leftIndentIn.value=e.leftIndent-t.byIn.value),r="AtLeast"===e.lineSpacingType?0:"Exactly"===e.lineSpacingType?1:2,t.lineSpacing.index=r,t.atIn.value=e.lineSpacing,"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none"),e.bidi?(t.rtlButton.checked=!0,t.ltrButton.checked=!1):(t.ltrButton.checked=!0,t.rtlButton.checked=!1),(0,a.isNullOrUndefined)(e.keepWithNext)?t.keepWithNext.indeterminate=!0:t.keepWithNext.checked=e.keepWithNext,(0,a.isNullOrUndefined)(e.keepLinesTogether)?t.keepLinesTogether.indeterminate=!0:t.keepLinesTogether.checked=e.keepLinesTogether,(0,a.isNullOrUndefined)(e.widowControl)?t.widowControlIn.indeterminate=!0:t.widowControlIn.checked=e.widowControl,t.contextSpacing.checked=e.contextualSpacing},this.applyParagraphFormat=function(){var e,i;if(t.paragraphFormat?(e=t.paragraphFormat,i=!1):((e=new ba).borders=void 0,i=!0),(0,a.isNullOrUndefined)(t.beforeSpacing)||(e.beforeSpacing=t.beforeSpacing),(0,a.isNullOrUndefined)(t.afterSpacing)||(e.afterSpacing=t.afterSpacing),(0,a.isNullOrUndefined)(t.spaceBeforeAuto)||(e.spaceBeforeAuto=t.spaceBeforeAuto),(0,a.isNullOrUndefined)(t.spaceAfterAuto)||(e.spaceAfterAuto=t.spaceAfterAuto),(0,a.isNullOrUndefined)(t.lineSpacingType)||(e.lineSpacingType=t.lineSpacingType),(0,a.isNullOrUndefined)(t.leftIndent)||(e.leftIndent=t.leftIndent),(0,a.isNullOrUndefined)(t.rightIndent)||(e.rightIndent=t.rightIndent),(0,a.isNullOrUndefined)(t.lineSpacingIn)||(e.lineSpacing=t.lineSpacingIn),(0,a.isNullOrUndefined)(t.firstLineIndent)||(e.firstLineIndent=Math.abs(t.firstLineIndent),2===t.special.index&&(e.firstLineIndent=-e.firstLineIndent,e.leftIndent=t.leftIndentIn.value+t.byIn.value)),(0,a.isNullOrUndefined)(t.paraOutlineLevel)||(e.outlineLevel=t.paraOutlineLevel),(0,a.isNullOrUndefined)(t.bidi)||(e.bidi=t.bidi),!(0,a.isNullOrUndefined)(t.textAlignment)){var n=t.textAlignment;e.bidi&&("Right"===n?n="Left":"Left"===n&&(n="Right")),e.textAlignment=n}(0,a.isNullOrUndefined)(t.contextualSpacing)||(e.contextualSpacing=t.contextualSpacing),(0,a.isNullOrUndefined)(t.keepWithNextValue)?t.documentHelper.selection.paragraphFormat.keepWithNext&&(e.keepWithNext=t.documentHelper.selection.paragraphFormat.keepWithNext):e.keepWithNext=t.keepWithNextValue,(0,a.isNullOrUndefined)(t.keepLineTogetherValue)?t.documentHelper.selection.paragraphFormat.keepLinesTogether&&(e.keepLinesTogether=t.documentHelper.selection.paragraphFormat.keepLinesTogether):e.keepLinesTogether=t.keepLineTogetherValue,(0,a.isNullOrUndefined)(t.widowControlValue)?t.documentHelper.selection.paragraphFormat.widowControl&&(e.widowControl=t.documentHelper.selection.paragraphFormat.widowControl):e.widowControl=t.widowControlValue,i?t.onParagraphFormat(e):t.documentHelper.owner.styleDialogModule.updateParagraphFormat(e),t.documentHelper.hideDialog()},this.openTabDialog=function(){t.documentHelper.hideDialog(),t.documentHelper.owner.tabDialogModule.show()},this.closeParagraphDialog=function(){t.leftIndent=void 0,t.afterSpacing=void 0,t.beforeSpacing=void 0,t.firstLineIndent=void 0,t.textAlignment=void 0,t.paraOutlineLevel=void 0,t.rightIndent=void 0,t.lineSpacingIn=void 0,t.lineSpacingType=void 0,t.paragraphFormat=void 0,t.documentHelper.hideDialog()},this.documentHelper=e}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ParagraphDialog"},e.prototype.initParagraphDialog=function(e){var t=(0,a.createElement)("div");this.ejtab=(0,a.createElement)("div"),this.instance=this;var i=this.documentHelper.owner.containerId;this.indentContainer=(0,a.createElement)("div",{className:"e-de-dlg-tab-first-child e-de-para-dlg-container"}),this.target=t,t.appendChild(this.ejtab),this.div=(0,a.createElement)("div",{styles:"width:400px;"}),this.generalDiv=(0,a.createElement)("div"),this.genLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")}),this.generalDiv.appendChild(this.genLabel),this.alignmentWholeDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.generalDiv.appendChild(this.alignmentWholeDiv),this.alignmentDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.alignmentWholeDiv.appendChild(this.alignmentDiv);var n=(0,a.createElement)("select",{id:i+"_Alignment",innerHTML:'<option value="Center">'+e.getConstant("Center")+'</option><option value="Left">'+e.getConstant("Left")+'</option><option value="Right">'+e.getConstant("Right")+'</option><option value="Justify">'+e.getConstant("Justify")+"</option>"}),r=(0,a.createElement)("select",{id:i+"_Outline",innerHTML:'<option value="BodyText">'+e.getConstant("BodyText")+'</option><option value="Level1">'+e.getConstant("Level1")+'</option><option value="Level2">'+e.getConstant("Level2")+'</option><option value="Level3">'+e.getConstant("Level3")+'</option><option value="Level4">'+e.getConstant("Level4")+'</option><option value="Level5">'+e.getConstant("Level5")+'</option><option value="Level6">'+e.getConstant("Level6")+'</option><option value="Level7">'+e.getConstant("Level7")+'</option><option value="Level8">'+e.getConstant("Level8")+'</option><option value="Level9">'+e.getConstant("Level9")+"</option>"});this.alignmentDiv.appendChild(n),this.alignmentDiv.setAttribute("aria-labelledby",n.innerText),this.alignmentDiv.appendChild(r),this.alignmentDiv.setAttribute("aria-labelledby",r.innerText),this.dirLabel=(0,a.createElement)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Direction")}),this.directionDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.rtlDiv=(0,a.createElement)("div",{className:"e-de-rtl-btn-div"}),this.rtlInputELe=(0,a.createElement)("input",{id:i+"_rtlEle"}),this.rtlDiv.appendChild(this.rtlInputELe),this.directionDiv.appendChild(this.rtlDiv);var o=this.documentHelper.owner.enableRtl;o&&this.rtlDiv.classList.add("e-de-rtl"),this.ltrDiv=(0,a.createElement)("div",{className:"e-de-ltr-btn-div"}),this.ltrInputELe=(0,a.createElement)("input",{id:i+"_ltrEle"}),this.ltrDiv.appendChild(this.ltrInputELe),this.directionDiv.appendChild(this.ltrDiv),this.generalDiv.appendChild(this.dirLabel),this.generalDiv.appendChild(this.directionDiv),this.rtlButton=new tl.RadioButton({label:e.getConstant("Right-to-left"),enableRtl:o,value:"rtl",cssClass:"e-small",change:this.changeBidirectional}),this.rtlButton.appendTo(this.rtlInputELe),this.rtlInputELe.setAttribute("aria-label",e.getConstant("Right-to-left")),this.ltrButton=new tl.RadioButton({label:e.getConstant("Left-to-right"),enableRtl:o,value:"ltr",cssClass:"e-small",change:this.changeBidirectional}),this.ltrButton.appendTo(this.ltrInputELe),this.ltrInputELe.setAttribute("aria-label",e.getConstant("Left-to-right")),this.indentionWholeDiv=(0,a.createElement)("div"),this.indentLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Indentation")}),this.indentionWholeDiv.appendChild(this.indentLabel),this.indentionSubDiv1=(0,a.createElement)("div",{className:"e-de-container-row"}),this.indentionWholeDiv.appendChild(this.indentionSubDiv1),this.indentionSubDiv2=(0,a.createElement)("div",{className:"e-de-container-row"}),this.indentionWholeDiv.appendChild(this.indentionSubDiv2),this.beforeTextDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.indentionSubDiv1.appendChild(this.beforeTextDiv),this.afterTextDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.indentionSubDiv1.appendChild(this.afterTextDiv),this.specialDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.indentionSubDiv2.appendChild(this.specialDiv),this.byDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.indentionSubDiv2.appendChild(this.byDiv),this.spacingDiv=(0,a.createElement)("div"),this.leftSpacingDiv=(0,a.createElement)("div"),this.spacingDiv.appendChild(this.leftSpacingDiv),this.contextSpacingDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.spacingDiv.appendChild(this.contextSpacingDiv),this.rightSpacingDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.spacingDiv.appendChild(this.rightSpacingDiv),this.contextInputEle=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:i+"_contextSpacing"}),this.contextSpacingDiv.appendChild(this.contextInputEle);var s=(0,a.createElement)("input",{id:i+"_leftIndent",attrs:{type:"text"}}),l=(0,a.createElement)("input",{id:i+"_rightIndent",attrs:{type:"text"}});this.beforeTextDiv.appendChild(s),this.beforeTextDiv.setAttribute("aria-labelledby",e.getConstant("Indent from left")),this.afterTextDiv.appendChild(l),this.afterTextDiv.setAttribute("aria-labelledby",e.getConstant("Indent from right"));var d=(0,a.createElement)("select",{id:i+"_special",innerHTML:'<option value="None">'+e.getConstant("None")+'</option><option value="First Line">'+e.getConstant("First line")+'</option><option value="Hanging">'+e.getConstant("Hanging")+"</option> "});this.by=(0,a.createElement)("input",{id:i+"_By",attrs:{type:"text"}}),this.specialDiv.setAttribute("aria-labelledby","Special"),this.specialDiv.appendChild(d),this.byDiv.appendChild(this.by),this.byDiv.setAttribute("aria-labelledby","By"),this.spaceLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Spacing")}),this.spacingWholeDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.beforeSpacingWholeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"});var h=(0,a.createElement)("input",{id:i+"_beforeSpacing",attrs:{type:"text"}});this.afterSpacingWholeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"});var c=(0,a.createElement)("input",{id:i+"_afterSpacing",attrs:{type:"text"}});this.leftSpacingDiv.appendChild(this.spaceLabel),this.leftSpacingDiv.appendChild(this.spacingWholeDiv),this.beforeSpacingWholeDiv.appendChild(h),this.spacingWholeDiv.appendChild(this.beforeSpacingWholeDiv),this.afterSpacingWholeDiv.appendChild(c),this.spacingWholeDiv.appendChild(this.afterSpacingWholeDiv),this.lineSpacingDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"});var p=(0,a.createElement)("select",{id:i+"_lineSpacing",innerHTML:'<option value="At least">'+e.getConstant("At least")+'</option><option value="Exactly">'+e.getConstant("Exactly")+'</option><option value="Multiple">'+e.getConstant("Multiple")+"</option>"});this.lineTypeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.lineSpacingAt=(0,a.createElement)("input",{id:i+"_lineSpacingAt",attrs:{type:"text"}}),this.lineSpacingDiv.appendChild(p),this.rightSpacingDiv.appendChild(this.lineSpacingDiv),this.lineTypeDiv.appendChild(this.lineSpacingAt),this.rightSpacingDiv.appendChild(this.lineTypeDiv),this.div.appendChild(this.generalDiv),this.div.appendChild(this.indentionWholeDiv),this.div.appendChild(this.spacingDiv),this.indentContainer.appendChild(this.div),this.leftIndentIn=new rl.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before text"),change:this.changeLeftIndent}),this.leftIndentIn.appendTo(s),this.rightIndentIn=new rl.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After text"),change:this.changeRightIndent}),this.rightIndentIn.appendTo(l),this.byIn=new rl.NumericTextBox({format:"n1",value:0,min:0,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("By"),change:this.changeFirstLineIndent}),this.byIn.appendTo(this.by),this.beforeSpacingIn=new rl.NumericTextBox({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("Before"),change:this.changeBeforeSpacing,focus:this.focusBeforeSpacing,blur:this.blurBeforeSpacing}),this.beforeSpacingIn.appendTo(h),this.beforeSpacingSpinDown=this.beforeSpacingWholeDiv.getElementsByClassName("e-input-group-icon e-spin-down")[0],this.beforeSpacingSpinDown.addEventListener("click",this.clickBeforeSpacingClickHandler),this.afterSpacingIn=new rl.NumericTextBox({format:"n1",value:0,min:-1,max:1584,step:6,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("After"),change:this.changeAfterSpacing,focus:this.focusAfterSpacing,blur:this.blurAfterSpacing}),this.afterSpacingIn.appendTo(c),this.afterSpacingSpinDown=this.afterSpacingWholeDiv.getElementsByClassName("e-input-group-icon e-spin-down")[0],this.afterSpacingSpinDown.addEventListener("click",this.clickAfterSpacingClickHandler),this.atIn=new rl.NumericTextBox({format:"n1",value:0,min:1,max:1584,step:.5,enablePersistence:!1,floatLabelType:"Always",placeholder:e.getConstant("At"),change:this.changeLineSpacingValue}),this.special=new al.DropDownList({change:this.changeByValue,enableRtl:o,floatLabelType:"Always",placeholder:e.getConstant("Special")}),this.special.appendTo(d),this.lineSpacing=new al.DropDownList({change:this.changeBySpacing,enableRtl:o,floatLabelType:"Always",placeholder:e.getConstant("Line Spacing"),htmlAttributes:{"aria-labelledby":e.getConstant("Line Spacing")}}),this.lineSpacing.appendTo(p),this.alignment=new al.DropDownList({change:this.changeByTextAlignment,enableRtl:o,floatLabelType:"Always",placeholder:e.getConstant("Alignment"),htmlAttributes:{"aria-labelledby":e.getConstant("Alignment")}}),this.alignment.appendTo(n),this.outlineLevel=new al.DropDownList({change:this.changeByOutlineLevel,enableRtl:o,floatLabelType:"Always",placeholder:e.getConstant("OutlineLevel"),htmlAttributes:{"aria-labelledby":e.getConstant("OutlineLevel")}}),this.outlineLevel.appendTo(r),this.atIn.appendTo(this.lineSpacingAt),this.contextSpacing=new tl.CheckBox({change:this.changeContextualSpacing,label:e.getConstant("Contextual Spacing"),enableRtl:o}),this.contextSpacing.appendTo(this.contextInputEle),this.contextInputEle.setAttribute("aria-labelledby",e.getConstant("Contextual Spacing")),this.indentContainer.addEventListener("keyup",this.instance.keyUpParagraphSettingsClickHandler),o&&(this.afterSpacingWholeDiv.classList.add("e-de-rtl"),this.lineTypeDiv.classList.add("e-de-rtl")),this.lineBreakContainer=(0,a.createElement)("div",{className:"e-de-dlg-tab-first-child"});var u=(0,a.createElement)("div",{className:"e-de-para-dlg-sub-container"});this.paginationDiv=u,this.paginationLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Pagination")}),u.appendChild(this.paginationLabel),this.widowContorlContainer=(0,a.createElement)("div",{styles:"display:block"}),u.appendChild(this.widowContorlContainer),this.keepNextContainer=(0,a.createElement)("div",{styles:"display:block"}),u.appendChild(this.keepNextContainer),this.keepLines=(0,a.createElement)("div",{styles:"display:block"}),u.appendChild(this.keepLines),this.keepWithNext1=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.keepNextContainer.appendChild(this.keepWithNext1),this.keepWithNext=new tl.CheckBox({change:this.changeKeepWithNext,label:e.getConstant("Keep With Next"),enableRtl:o,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepWithNext.appendTo(this.keepWithNext1),this.keepWithNext1.setAttribute("aria-label",e.getConstant("Keep With Next")),this.keepLinesTogether1=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.keepLines.appendChild(this.keepLinesTogether1),this.keepLinesTogether=new tl.CheckBox({change:this.changeKeepLinesTogether,label:e.getConstant("Keep Lines Together"),enableRtl:o,cssClass:"e-de-para-dlg-cs-check-box"}),this.keepLinesTogether.appendTo(this.keepLinesTogether1),this.keepLinesTogether1.setAttribute("aria-label",e.getConstant("Keep Lines Together")),this.widowControl=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.widowContorlContainer.appendChild(this.widowControl),this.widowControlIn=new tl.CheckBox({change:this.changeWidowControl,label:e.getConstant("WidowControl"),enableRtl:o,cssClass:"e-de-para-dlg-cs-check-box"}),this.widowControlIn.appendTo(this.widowControl),this.widowControl.setAttribute("aria-label",e.getConstant("WidowControl")),this.lineBreakContainer.appendChild(u);var g=[{header:{text:e.getConstant("Indents and Spacing")},content:this.indentContainer},{header:{text:e.getConstant("Line and Page Breaks")},content:this.lineBreakContainer}];this.tabObj=new ua.Tab({items:g,enableRtl:o,animation:{previous:{effect:"None"},next:{effect:"None"}}},this.ejtab),this.tabObj.isStringTemplate=!0},e.prototype.onKeyUpParagraphSettingsClick=function(e){this.keyUpParagraphSettings(e)},e.prototype.onClickBeforeSpacingClick=function(){this.clickBeforeSpacing()},e.prototype.onClickAfterSpacingClick=function(){this.clickAfterSpacing()},e.prototype.changeAlignmentByBidi=function(){"Left"===this.textAlignment?this.textAlignment="Right":"Right"===this.textAlignment&&(this.textAlignment="Left"),(0,a.isNullOrUndefined)(this.textAlignment)?0===this.alignment.index?this.textAlignment="Center":this.textAlignment="Justify":this.alignment.index=this.getAlignmentValue(this.textAlignment)},e.prototype.getAlignmentValue=function(e){return"Center"===e?0:"Left"===e?1:"Right"===e?2:3},e.prototype.isHeadingStyle=function(){var e=this.documentHelper.selection.paragraphFormat.styleName;return"Heading 1"===e||"Heading 2"===e||"Heading 3"===e||"Heading 4"===e||"Heading 5"===e||"Heading 6"===e||"Heading 7"===e||"Heading 8"===e||"Heading 9"===e},e.prototype.getOutlineValue=function(e){return"BodyText"===e?0:"Level1"===e?1:"Level2"===e?2:"Level3"===e?3:"Level4"===e?4:"Level5"===e?5:"Level6"===e?6:"Level7"===e?7:"Level8"===e?8:9},e.prototype.onParagraphFormat=function(e){var t=this.documentHelper.selection;if((0,a.isNullOrUndefined)(t)||!t.checkContentControlLocked(!0)){var i=e.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0),this.documentHelper.owner.editorModule.setPreviousBlockToLayout(),this.documentHelper.owner.editorModule.initHistory("ParagraphFormat"),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection.isEmpty?(this.documentHelper.owner.editorModule.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.documentHelper.owner.editorModule.isMeasureParaWidth=!0,this.documentHelper.owner.editorModule.layoutItemBlock(t.start.paragraph,!1),this.documentHelper.owner.editorModule.isMeasureParaWidth=!0):this.documentHelper.owner.editorModule.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.documentHelper.owner.editorModule.reLayout(t),i||(this.documentHelper.layout.isBidiReLayout=!1)}},e.prototype.show=function(e){e?(this.isStyleDialog=!0,this.paragraphFormat=e):this.isStyleDialog=!1;var t=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),this.target||this.initParagraphDialog(t),this.loadParagraphDialog(),this.documentHelper.dialog.header=t.getConstant("Paragraph"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.openTabDialog,buttonModel:{content:t.getConstant("Tabs")+"....",cssClass:"e-flat e-de-para-tab",enableRtl:this.documentHelper.owner.enableRtl}},{click:this.applyParagraphFormat,buttonModel:{content:t.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeParagraphDialog,buttonModel:{content:t.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.alignment.focusIn(),this.documentHelper.dialog.show();var i=this.documentHelper.dialog.element;if(i){var n=this.documentHelper.updateDialogTabHeight(i,this.target);this.paginationDiv.style.width=n.toString()+"px"}},e.prototype.destroy=function(){if(this.afterSpacingIn&&(this.afterSpacingIn.destroy(),this.afterSpacingIn=void 0),this.beforeSpacingIn&&(this.beforeSpacingIn.destroy(),this.beforeSpacingIn=void 0),this.leftIndentIn&&(this.leftIndentIn.destroy(),this.leftIndentIn=void 0),this.rightIndentIn&&(this.rightIndentIn.destroy(),this.rightIndentIn=void 0),this.byIn&&(this.byIn.destroy(),this.byIn=void 0),this.special&&(this.special.destroy(),this.special=void 0),this.atIn&&(this.atIn.destroy(),this.atIn=void 0),this.alignment&&(this.alignment.change=void 0,this.alignment.destroy()),this.alignment=void 0,this.outlineLevel&&(this.outlineLevel.change=void 0,this.outlineLevel.destroy()),this.outlineLevel=void 0,this.lineSpacing&&(this.lineSpacing.change=void 0,this.lineSpacing.destroy()),this.lineSpacing=void 0,this.special&&(this.special.change=void 0,this.special.destroy()),this.removeEvents(),this.removeElements(),this.special=void 0,!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0,this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.documentHelper=void 0}},e.prototype.removeEvents=function(){this.beforeSpacingSpinDown&&this.beforeSpacingSpinDown.removeEventListener("click",this.clickBeforeSpacingClickHandler),this.afterSpacingSpinDown&&this.afterSpacingSpinDown.removeEventListener("click",this.clickAfterSpacingClickHandler),this.indentContainer&&this.indentContainer.removeEventListener("keyup",this.instance.keyUpParagraphSettingsClickHandler)},e.prototype.removeElements=function(){this.ejtab&&(this.ejtab.remove(),this.ejtab=void 0),this.div&&(this.div.remove(),this.div=void 0),this.generalDiv&&(this.generalDiv.remove(),this.generalDiv=void 0),this.genLabel&&(this.genLabel.remove(),this.genLabel=void 0),this.alignmentWholeDiv&&(this.alignmentWholeDiv.remove(),this.alignmentWholeDiv=void 0),this.alignmentDiv&&(this.alignmentDiv.remove(),this.alignmentDiv=void 0),this.dirLabel&&(this.dirLabel.remove(),this.dirLabel=void 0),this.rtlDiv&&(this.rtlDiv.remove(),this.rtlDiv=void 0),this.rtlInputELe&&(this.rtlInputELe.remove(),this.rtlInputELe=void 0),this.ltrDiv&&(this.ltrDiv.remove(),this.ltrDiv=void 0),this.ltrInputELe&&(this.ltrInputELe.remove(),this.ltrInputELe=void 0),this.indentionWholeDiv&&(this.indentionWholeDiv.remove(),this.indentionWholeDiv=void 0),this.indentLabel&&(this.indentLabel.remove(),this.indentLabel=void 0),this.indentionSubDiv1&&(this.indentionSubDiv1.remove(),this.indentionSubDiv1=void 0),this.indentionSubDiv2&&(this.indentionSubDiv2.remove(),this.indentionSubDiv2=void 0),this.beforeTextDiv&&(this.beforeTextDiv.remove(),this.beforeTextDiv=void 0),this.afterTextDiv&&(this.afterTextDiv.remove(),this.afterTextDiv=void 0),this.specialDiv&&(this.specialDiv.remove(),this.specialDiv=void 0),this.byDiv&&(this.byDiv.remove(),this.byDiv=void 0),this.by&&(this.by.remove(),this.by=void 0),this.spacingDiv&&(this.spacingDiv.remove(),this.spacingDiv=void 0),this.leftSpacingDiv&&(this.leftSpacingDiv.remove(),this.leftSpacingDiv=void 0),this.contextSpacingDiv&&(this.contextSpacingDiv.remove(),this.contextSpacingDiv=void 0),this.rightSpacingDiv&&(this.rightSpacingDiv.remove(),this.rightSpacingDiv=void 0),this.contextInputEle&&(this.contextInputEle.remove(),this.contextInputEle=void 0),this.spaceLabel&&(this.spaceLabel.remove(),this.spaceLabel=void 0),this.spacingWholeDiv&&(this.spacingWholeDiv.remove(),this.spacingWholeDiv=void 0),this.beforeSpacingWholeDiv&&(this.beforeSpacingWholeDiv.remove(),this.beforeSpacingWholeDiv=void 0),this.afterSpacingWholeDiv&&(this.afterSpacingWholeDiv.remove(),this.afterSpacingWholeDiv=void 0),this.lineSpacingDiv&&(this.lineSpacingDiv.remove(),this.lineSpacingDiv=void 0),this.lineTypeDiv&&(this.lineTypeDiv.remove(),this.lineTypeDiv=void 0),this.lineSpacingAt&&(this.lineSpacingAt.remove(),this.lineSpacingAt=void 0),this.lineBreakContainer&&(this.lineBreakContainer.remove(),this.lineBreakContainer=void 0),this.paginationLabel&&(this.paginationLabel.remove(),this.paginationLabel=void 0),this.widowContorlContainer&&(this.widowContorlContainer.remove(),this.widowContorlContainer=void 0),this.keepNextContainer&&(this.keepNextContainer.remove(),this.keepNextContainer=void 0),this.keepLines&&(this.keepLines.remove(),this.keepLines=void 0),this.widowControl&&(this.widowControl.remove(),this.widowControl=void 0),this.keepWithNext1&&(this.keepWithNext1.remove(),this.keepWithNext1=void 0),this.keepLinesTogether1&&(this.keepLinesTogether1.remove(),this.keepLinesTogether1=void 0),this.beforeSpacingSpinDown&&(this.beforeSpacingSpinDown.remove(),this.beforeSpacingSpinDown=void 0),this.afterSpacingSpinDown&&(this.afterSpacingSpinDown.remove(),this.afterSpacingSpinDown=void 0),this.indentContainer&&(this.indentContainer.remove(),this.indentContainer=void 0)},e}(),zh=function(){function e(){this.nsid=-1,this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}return e.prototype.getListLevel=function(e){var t=this.getLevelOverride(e);return(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(t.overrideListLevel)?this.abstractList.levels[parseInt(e.toString(),10)]:t.overrideListLevel},e.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[parseInt(t.toString(),10)]instanceof Ua){var i=this.levelOverrides[parseInt(t.toString(),10)];if(i.levelNumber===e)return i}},e.prototype.clear=function(){if(!(0,a.isNullOrUndefined)(this.levelOverrides)){for(var e=0;e<this.levelOverrides.length;e++){this.levelOverrides[parseInt(e.toString(),10)].clear()}this.levelOverrides=[]}this.abstractList&&this.abstractList.clear(),this.abstractList=void 0},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.levelOverrides)){for(var e=0;e<this.levelOverrides.length;e++){this.levelOverrides[parseInt(e.toString(),10)].destroy()}this.levelOverrides=[]}this.levelOverrides=void 0,this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0},e.prototype.mergeList=function(e){(0,a.isNullOrUndefined)(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=e.abstractListId),(0,a.isNullOrUndefined)(this.listId)||-1===this.listId||(this.listId=e.listId),(0,a.isNullOrUndefined)(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=e.sourceListId),(0,a.isNullOrUndefined)(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=e.levelOverrides)},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levelOverrides.length;i++)t.levelOverrides.push(this.levelOverrides[parseInt(i.toString(),10)].clone());return t},e}(),qh=function(){function e(){this.listIn=void 0,this.levelNumberIn=void 0,this.dialog=void 0,this.levelNumber=0}return Object.defineProperty(e.prototype,"levelNumber",{get:function(){return this.levelNumberIn},set:function(e){this.levelNumberIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this.listIn},set:function(e){(0,a.isNullOrUndefined)(e)?this.createList():this.listIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){if(!(0,a.isNullOrUndefined)(this.list)&&this.levelNumber>=0&&this.levelNumber<9){if((0,a.isNullOrUndefined)(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId))){this.dialog.documentHelper.lists.push(this.list);var e=this.list.abstractList;return this.list.abstractList||((e=new Aa).abstractListId=this.list.abstractListId),this.dialog.documentHelper.abstractLists.push(e),(e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId)).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),e.levels[this.levelNumber]}return this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length<=this.levelNumber&&this.dialog.documentHelper.layout.addListLevels(this.list.abstractList),this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels[this.levelNumber]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return(0,a.isNullOrUndefined)(this.listLevel)?"Arabic":this.listLevel.listLevelPattern},set:function(e){(0,a.isNullOrUndefined)(this.listLevel)||(this.listLevel.listLevelPattern=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return(0,a.isNullOrUndefined)(this.listLevel)?"None":this.listLevel.followCharacter},set:function(e){(0,a.isNullOrUndefined)(this.listLevel)||(this.listLevel.followCharacter=e)},enumerable:!0,configurable:!0}),e.prototype.createList=function(){this.list=new zh,this.list.listId=this.dialog.documentHelper.lists.length+1;var e=new Aa;e.abstractListId=this.dialog.documentHelper.abstractLists.length+1,this.list.abstractListId=e.abstractListId,this.list.abstractList=e,this.dialog.documentHelper.lists.push(this.list);var t=new Va(e);t.paragraphFormat=new ba(t),t.paragraphFormat.leftIndent=48,t.paragraphFormat.firstLineIndent=-24,t.characterFormat=new ka(t),t.numberFormat="%1.",t.startAt=1,e.levels.push(t),this.dialog.documentHelper.abstractLists.push(e)},e.prototype.addListLevels=function(){if(!(0,a.isNullOrUndefined)(this.list)&&!(0,a.isNullOrUndefined)(this.list.abstractListId))for(var e=this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.length;e<9;e++){var t=new Va(this.dialog.documentHelper.getAbstractListById(this.list.abstractListId));t.characterFormat=new ka(t),t.paragraphFormat=new ba(t),t.paragraphFormat.leftIndent=48*(e+1),t.paragraphFormat.firstLineIndent=-24,t.numberFormat="%"+(e+1).toString()+".",t.listLevelPattern="Arabic",t.followCharacter="Tab",t.startAt=1,t.restartLevel=e,this.dialog.documentHelper.getAbstractListById(this.list.abstractListId).levels.push(t)}},e.prototype.destroy=function(){this.dialog&&this.listIn&&this.dialog.documentHelper.layout.clearInvalidList(this.listIn),this.listIn=void 0,this.levelNumberIn=void 0,this.listLevelPattern=void 0},e}(),_h=function(){function e(e){var t=this;this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.viewModel=void 0,this.startAt=void 0,this.textIndent=void 0,this.alignedAt=void 0,this.listLevelElement=void 0,this.followNumberWith=void 0,this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy=void 0,this.startedValueChangedClickHandler=this.onStartedValueChangedClick.bind(this),this.textIndentChangedClickHandler=this.onTextIndentChangedClick.bind(this),this.alignedAtValueChangedClickHandler=this.onAlignedAtValueChangedClick.bind(this),this.numberFormatChangedClickHandler=this.onNumberFormatChangedClick.bind(this),this.isListCharacterFormat=!1,this.onTextIndentChanged=function(e){e.isInteracted&&(t.viewModel.listLevel.paragraphFormat.leftIndent=e.value)},this.onStartValueChanged=function(e){e.isInteracted&&((0,a.isNullOrUndefined)(t.viewModel)||(0,a.isNullOrUndefined)(t.viewModel.listLevel)||(t.viewModel.listLevel.startAt=e.value))},this.onListLevelValueChanged=function(e){t.viewModel.levelNumber=parseInt(e.value.slice(e.value.length-1),10)-1,(0,a.isNullOrUndefined)(t.listLevel)||(t.updateDialogValues(),t.updateRestartLevelBox())},this.onNumberFormatChanged=function(e){t.viewModel.listLevel.numberFormat=e.target.value},this.onAlignedAtValueChanged=function(e){e.isInteracted&&(t.viewModel.listLevel.paragraphFormat.firstLineIndent=t.alignedAt.value-t.viewModel.listLevel.paragraphFormat.leftIndent)},this.onFollowCharacterValueChanged=function(e){e.isInteracted&&(t.viewModel.followCharacter=e.value)},this.onLevelPatternValueChanged=function(e){if(e.isInteracted){t.viewModel.listLevelPattern=e.value;var i="%"+(t.levelNumber+1).toString(),n=document.getElementById(t.documentHelper.owner.containerId+"_numberFormat");"Bullet"===t.listLevel.listLevelPattern?(t.listLevel.numberFormat=String.fromCharCode(61623),n.value=t.listLevel.numberFormat):("None"===t.listLevel.listLevelPattern&&(t.listLevel.numberFormat=""),t.listLevel.numberFormat.match(i)||"None"===t.listLevel.listLevelPattern||(t.listLevel.numberFormat=i+"."),n.value=t.listLevel.numberFormat)}},this.loadListDialog=function(){t.documentHelper.updateFocus(),(0,a.isNullOrUndefined)(t.documentHelper.owner)||(t.viewModel=new qh,t.viewModel.dialog=t,t.documentHelper.selection.paragraphFormat.listLevelNumber>0&&(t.viewModel.levelNumber=t.documentHelper.selection.paragraphFormat.listLevelNumber),t.viewModel.list=t.documentHelper.selection.paragraphFormat.getList(),(0,a.isNullOrUndefined)(t.listLevel)||(t.updateDialogValues(),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none")))},this.showFontDialog=function(){t.documentHelper.owner.fontDialogModule.showFontDialog(t.listLevel.characterFormat,!0)},this.onApplyList=function(){(0,a.isNullOrUndefined)(t.owner)||t.documentHelper.selection.paragraphFormat.setList(t.list,!0),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.disposeBindingForListUI(),t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus(),t.isListCharacterFormat=!1},this.closeListDialog=function(){t.disposeBindingForListUI(),t.documentHelper.updateFocus(),t.isListCharacterFormat=!1},this.documentHelper=e,this.viewModel=new qh}return Object.defineProperty(e.prototype,"listLevel",{get:function(){if(!(0,a.isNullOrUndefined)(this.viewModel))return this.viewModel.listLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){if(!(0,a.isNullOrUndefined)(this.viewModel))return this.viewModel.list},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelNumber",{get:function(){return this.listLevel.ownerBase instanceof Ua?this.listLevel.ownerBase.levelNumber:this.listLevel.ownerBase instanceof Aa&&!(0,a.isNullOrUndefined)(this.listLevel.ownerBase.levels)?this.listLevel.ownerBase.levels.indexOf(this.listLevel):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ListDialog"},e.prototype.showListDialog=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale);var t,i=!1;this.target||(this.initListDialog(e,this.documentHelper.owner.enableRtl),i=!0),this.isListCharacterFormat=!0,this.documentHelper.dialog2.header=e.getConstant("Define new Multilevel list"),this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target;var n=this.documentHelper.owner.enableRtl;t=n?"e-flat e-list-dlg-font e-de-dlg-target.e-de-rtl e-font-rtl":"e-flat e-list-dlg-font e-font",this.documentHelper.dialog2.buttons=[{click:this.showFontDialog,buttonModel:{content:e.getConstant("Font"),cssClass:t}},{click:this.onApplyList,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-list-dlg",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-list-dlg"}}];this.documentHelper.dialog2.element;this.documentHelper.dialog2.dataBind(),i&&this.wireAndBindEvent(e,n),this.documentHelper.dialog2.beforeOpen=this.loadListDialog,this.documentHelper.dialog2.close=this.closeListDialog,this.documentHelper.dialog2.position={X:"center",Y:"top"},this.documentHelper.dialog2.show()},e.prototype.initListDialog=function(e,t){var i,n,r=this.documentHelper.owner.containerId,o=r+"_insert_list";this.target=(0,a.createElement)("div",{id:o,className:"e-de-list-dlg"}),this.listLevelDiv=(0,a.createElement)("div",{innerHTML:'<label id="'+r+'_listLevellabel" style="display:block;" class=e-de-list-ddl-header-list-level>'+e.getConstant("List level")+'</label><label id="'+r+'_modifyLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Choose level to modify")+'</label><select style="height:20px;width:43%" id="'+r+'_listLevel"><option>'+e.getConstant("Level")+" 1</option><option>"+e.getConstant("Level")+" 2</option><option>"+e.getConstant("Level")+" 3</option><option>"+e.getConstant("Level")+" 4</option><option>"+e.getConstant("Level")+" 5</option><option>"+e.getConstant("Level")+" 6</option><option>"+e.getConstant("Level")+" 7</option><option>"+e.getConstant("Level")+" 8</option><option>"+e.getConstant("Level")+" 9</option></select>"}),this.target.appendChild(this.listLevelDiv),this.div=(0,a.createElement)("div"),i=t?'<div style="float:right;display:block;width:241px;">':'<div style="float:left;display:block;">',this.numberStyleDiv=(0,a.createElement)("div",{innerHTML:i+'<label id="'+r+'_numberFormatLabel" style="display:block;" class=e-de-list-ddl-header>'+e.getConstant("Number format")+'</label><label id="'+r+'_numberStyleLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Number style for this level")+'</label><select style="height:20px;width:100%" id="'+r+'_numberStyle"><option>'+e.getConstant("Arabic")+"</option><option>"+e.getConstant("UpRoman")+"</option><option>"+e.getConstant("LowRoman")+"</option><option>"+e.getConstant("UpLetter")+"</option><option>"+e.getConstant("LowLetter")+"</option><option>"+e.getConstant("Number")+"</option><option>"+e.getConstant("Leading zero")+"</option><option>"+e.getConstant("Bullet")+"</option><option>"+e.getConstant("Ordinal")+"</option><option>"+e.getConstant("Ordinal Text")+"</option><option>"+e.getConstant("Special")+"</option><option>"+e.getConstant("For East")+'</option></select><label id="'+r+'_startAtLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Start at")+'</label><input type="text" id="'+r+'_startAt">'}),this.div.appendChild(this.numberStyleDiv),this.numberFormatDiv=(0,a.createElement)("div",{className:"e-de-list-dlg-subdiv",innerHTML:'<div><div><label id="'+r+'_formatLabel" style="display:inline-block;width:86%" class=e-de-list-ddl-subheader>'+e.getConstant("Enter formatting for number")+'</label><button type="button" id="'+r+'_list_info" class="e-control e-btn e-primary e-de-list-format-info">i</button></div><input style=width:180px; type="text" id="'+r+'_numberFormat" aria-label="numberFormat" class=e-input></div><label id="'+r+'_restartLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Restart list after")+'</label><select style="height:20px;width:100%" id="'+r+'_restartBy"><option>'+e.getConstant("No Restart")+"</option></select></div>"}),this.div.appendChild(this.numberFormatDiv),this.target.appendChild(this.div),n=t?"display:block;position:relative; ":"display:block; ",this.indentsDiv=(0,a.createElement)("div",{innerHTML:i+'<label id="'+r+'_IndentsLabel" style='+n+"class=e-de-list-ddl-header>"+e.getConstant("Position")+'</label><label id="'+r+'_textIndentLabel" style='+n+"class=e-de-list-ddl-subheader>"+e.getConstant("Text indent at")+'</label><input type="text" id="'+r+'_textIndent"><label id="'+r+'_followCharacterLabel" style='+n+"class=e-de-list-ddl-subheaderbottom>"+e.getConstant("Follow number with")+'</label><select style="height:20px;width:100%" id="'+r+'_followCharacter"><option>'+e.getConstant("Tab character")+"</option><option>"+e.getConstant("Space")+"</option><option>"+e.getConstant("Nothing")+'</option></select></div><div id="e-de-list-dlg-div" class="e-de-list-dlg-div"><label id="'+r+'_alignedAtLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Aligned at")+'</label><input type="text" id="'+r+'_alignedAt"></div>'}),this.target.appendChild(this.indentsDiv)},e.prototype.wireAndBindEvent=function(e,t){var i=this.documentHelper.owner.containerId;t&&(document.getElementById("e-de-list-dlg-div").classList.add("e-de-rtl"),this.numberFormatDiv.classList.add("e-de-rtl")),this.startAtTextBox=document.getElementById(i+"_startAt"),this.startAtTextBox.setAttribute("aria-label","startAt"),this.textIndentAtTextBox=document.getElementById(i+"_textIndent"),this.textIndentAtTextBox.setAttribute("aria-label","textIndent"),this.alignedAtTextBox=document.getElementById(i+"_alignedAt"),this.alignedAtTextBox.setAttribute("aria-label","alignedAt"),this.startAt=new rl.NumericTextBox({format:"#",decimals:0,min:0,max:50,width:"180px",enablePersistence:!1}),this.startAt.addEventListener("change",this.startedValueChangedClickHandler),this.startAt.appendTo(this.startAtTextBox),this.textIndent=new rl.NumericTextBox({format:"#",decimals:0,min:0,max:1584,width:"180px",step:4,enablePersistence:!1}),this.textIndent.addEventListener("change",this.textIndentChangedClickHandler),this.textIndent.appendTo(this.textIndentAtTextBox),this.alignedAt=new rl.NumericTextBox({format:"#",max:1584,step:6,width:"180px",enablePersistence:!1}),this.alignedAt.addEventListener("change",this.alignedAtValueChangedClickHandler),this.alignedAt.appendTo(this.alignedAtTextBox),this.listLevel1=document.getElementById(i+"_listLevel"),this.listLevelElement=new al.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onListLevelValueChanged}),this.listLevelElement.appendTo(this.listLevel1),this.followCharacterElement=document.getElementById(i+"_followCharacter"),this.followNumberWith=new al.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onFollowCharacterValueChanged}),this.followNumberWith.appendTo(this.followCharacterElement),this.numberStyleEle=document.getElementById(i+"_numberStyle"),this.numberStyle=new al.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t,change:this.onLevelPatternValueChanged}),this.numberStyle.appendTo(this.numberStyleEle),this.numberFormat=document.getElementById(i+"_numberFormat"),this.numberFormat.addEventListener("change",this.numberFormatChangedClickHandler),this.restartElement=document.getElementById(i+"_restartBy"),this.restartBy=new al.DropDownList({popupHeight:"150px",width:"180px",enableRtl:t}),this.restartBy.appendTo(this.restartElement),this.button=document.getElementById(i+"_list_info"),this.formatInfoToolTip=new el.Tooltip({width:200}),this.formatInfoToolTip.content=e.getConstant("Number format tooltip information"),this.formatInfoToolTip.position="RightTop",this.formatInfoToolTip.appendTo(this.button)},e.prototype.onTextIndentChangedClick=function(e){this.onTextIndentChanged(e)},e.prototype.onStartedValueChangedClick=function(e){this.onStartValueChanged(e)},e.prototype.onNumberFormatChangedClick=function(e){this.onNumberFormatChanged(e)},e.prototype.onAlignedAtValueChangedClick=function(e){this.onAlignedAtValueChanged(e)},e.prototype.updateRestartLevelBox=function(){for(var e=this.documentHelper.owner.containerId,t=document.getElementById(e+"_listLevel"),i=document.getElementById(e+"_restartBy"),n=0;n<i.options.length;n)i.options.remove(n);if(0===t.selectedIndex){(o=document.createElement("option")).value="No Restart",o.innerHTML="No Restart",i.appendChild(o)}else{for(n=t.selectedIndex;n>0;n--){var r=document.createElement("option");r.value="Level "+n,r.innerHTML="Level "+n,i.appendChild(r)}var o;(o=document.createElement("option")).value="No Restart",o.innerHTML="No Restart",i.appendChild(o)}i.selectedIndex=0},e.prototype.listPatternConverter=function(e){switch(e){case"Arabic":return 0;case"UpRoman":return 1;case"LowRoman":return 2;case"UpLetter":return 3;case"LowLetter":return 4;case"Number":return 5;case"LeadingZero":return 6;case"Bullet":return 7;case"Ordinal":return 8;case"OrdinalText":return 9;case"Special":return 10;case"FarEast":return 11;default:return 12}},e.prototype.followCharacterConverter=function(e){switch(e){case"Tab":return 0;case"Space":return 1;default:return 2}},e.prototype.calculateAlignedAt=function(){return this.viewModel.listLevel.paragraphFormat.firstLineIndent<0?this.viewModel.listLevel.paragraphFormat.leftIndent+this.viewModel.listLevel.paragraphFormat.firstLineIndent:this.viewModel.listLevel.paragraphFormat.firstLineIndent},e.prototype.updateDialogValues=function(){(0,a.isNullOrUndefined)(this.listLevel.characterFormat)&&(this.listLevel.characterFormat=new ka(this.viewModel.listLevel)),(0,a.isNullOrUndefined)(this.listLevel.paragraphFormat)&&(this.listLevel.paragraphFormat=new ba(this.viewModel.listLevel)),(0,a.isNullOrUndefined)(this.viewModel)||(0,a.isNullOrUndefined)(this.viewModel.listLevel)||(this.startAt.value=this.viewModel.listLevel.startAt,this.textIndent.value=this.viewModel.listLevel.paragraphFormat.leftIndent,this.alignedAt.value=this.calculateAlignedAt(),this.followNumberWith.index=this.followCharacterConverter(this.viewModel.followCharacter),this.numberFormat.value=this.viewModel.listLevel.numberFormat,this.numberFormat.style.fontFamily=this.viewModel.listLevel.characterFormat.fontFamily,this.numberStyle.index=this.listPatternConverter(this.viewModel.listLevelPattern),this.listLevelElement.index=this.viewModel.levelNumber)},e.prototype.updateCharacterFormat=function(e){this.listLevel.characterFormat.copyFormat(e)},e.prototype.disposeBindingForListUI=function(){this.followNumberWith.index=-1,this.numberFormat.value=" ",this.numberStyle.index=-1,this.listLevelElement.index=-1,this.restartBy.index=-1,this.viewModel.destroy()},e.prototype.destroy=function(){if(this.alignedAt&&this.alignedAt.destroy(),this.alignedAt=void 0,this.dialog=void 0,this.followNumberWith&&this.followNumberWith.destroy(),this.followNumberWith=void 0,this.listLevelElement&&this.listLevelElement.destroy(),this.listLevelElement=void 0,this.textIndent&&this.textIndent.destroy(),this.textIndent=void 0,this.startAt&&this.startAt.destroy(),this.startAt=void 0,this.numberStyle&&this.numberStyle.destroy(),this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy&&this.restartBy.destroy(),this.restartBy=void 0,!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.removeEvents(),this.removeElements(),this.documentHelper=void 0,this.viewModel=void 0},e.prototype.removeEvents=function(){this.startAt&&this.startAt.removeEventListener("change",this.startedValueChangedClickHandler),this.textIndent&&this.textIndent.removeEventListener("change",this.textIndentChangedClickHandler),this.alignedAt&&this.alignedAt.removeEventListener("change",this.alignedAtValueChangedClickHandler),this.numberFormat&&this.numberFormat.removeEventListener("change",this.numberFormatChangedClickHandler)},e.prototype.removeElements=function(){this.listLevelDiv&&(this.listLevelDiv.remove(),this.listLevelDiv=void 0),this.div&&(this.div.remove(),this.div=void 0),this.numberStyleDiv&&(this.numberStyleDiv.remove(),this.numberStyleDiv=void 0),this.indentsDiv&&(this.indentsDiv.remove(),this.indentsDiv=void 0),this.numberFormatDiv&&(this.numberFormatDiv.remove(),this.numberFormatDiv=void 0),this.startAtTextBox&&(this.startAtTextBox.remove(),this.startAtTextBox=void 0),this.textIndentAtTextBox&&(this.textIndentAtTextBox.remove(),this.textIndentAtTextBox=void 0),this.alignedAtTextBox&&(this.alignedAtTextBox.remove(),this.alignedAtTextBox=void 0),this.listLevel1&&(this.listLevel1.remove(),this.listLevel1=void 0),this.followCharacterElement&&(this.followCharacterElement.remove(),this.followCharacterElement=void 0),this.numberStyleEle&&(this.numberStyleEle.remove(),this.numberStyleEle=void 0),this.restartElement&&(this.restartElement.remove(),this.restartElement=void 0),this.button&&(this.button.remove(),this.button=void 0),this.formatInfoToolTip&&(this.formatInfoToolTip.destroy(),this.formatInfoToolTip=void 0),this.startAtTextBox&&(this.startAtTextBox.remove(),this.startAtTextBox=void 0)},e}(),jh=m(74),Gh=function(){function e(e){var t=this;this.target=void 0,this.styleType=void 0,this.styleBasedOn=void 0,this.styleParagraph=void 0,this.onlyThisDocument=void 0,this.template=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0,this.textAlignment=void 0,this.lineSpacing=void 0,this.leftIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.setLeftAlignmentClickHandler=this.onSetLeftAlignmentClick.bind(this),this.setCenterAlignmentClickHandler=this.onSetCenterAlignmentClick.bind(this),this.setRightAlignmentClickHandler=this.onSetRightAlignmentClick.bind(this),this.setJustifyAlignmentClickHandler=this.onSetJustifyAlignmentClick.bind(this),this.setSingleLineSpacingClickHandler=this.setSingleLineSpacing.bind(this),this.setOnePointFiveLineSpacingClickHandler=this.setOnePointFiveLineSpacing.bind(this),this.setDoubleLineSpacingClickHandler=this.setDoubleLineSpacing.bind(this),this.increaseIndentValueHandler=this.increaseIndentValue.bind(this),this.decreaseIndentValueHandler=this.decreaseIndentValue.bind(this),this.increaseBeforeAfterSpacingValueHandler=this.onIncreaseBeforeAfterSpacing.bind(this),this.decreaseBeforeAfterSpacingValueHandler=this.onDecreaseBeforeAfterSpacing.bind(this),this.setUnderlinePropertyHandler=this.onSetUnderlineProperty.bind(this),this.setItalicPropertyHandler=this.onSetItalicProperty.bind(this),this.setBoldPropertyHandler=this.onSetBoldProperty.bind(this),this.openDialogHandler=this.onOpenDialog.bind(this),this.updateOkButtonClickHandler=this.onUpdateOkButtonClick.bind(this),this.updateNextStyleHandler=this.onUpdateNextStyle.bind(this),this.openDialog=function(e){switch(e.item.id){case"style_font":t.showFontDialog();break;case"style_paragraph":t.showParagraphDialog();break;case"style_numbering":t.showNumberingBulletDialog()}},this.setBoldProperty=function(){t.characterFormat.bold=!t.characterFormat.bold,t.fontButtonClicked()},this.setItalicProperty=function(){t.characterFormat.italic=!t.characterFormat.italic,t.fontButtonClicked()},this.setUnderlineProperty=function(){t.characterFormat.underline="None"===t.characterFormat.underline?"Single":"None",t.fontButtonClicked()},this.fontButtonClicked=function(){t.characterFormat.bold?t.bold.classList.contains("e-active")||t.bold.classList.add("e-active"):t.bold.classList.contains("e-active")&&t.bold.classList.remove("e-active"),t.characterFormat.italic?t.italic.classList.contains("e-active")||t.italic.classList.add("e-active"):t.italic.classList.contains("e-active")&&t.italic.classList.remove("e-active"),void 0!==t.characterFormat.underline&&"None"!==t.characterFormat.underline?t.underline.classList.contains("e-active")||(t.underline.classList.add("e-active"),t.characterFormat.underline="Single"):t.underline.classList.contains("e-active")&&(t.underline.classList.remove("e-active"),t.characterFormat.underline="None")},this.fontSizeUpdate=function(e){t.characterFormat.fontSize=e.value},this.fontFamilyChanged=function(e){t.characterFormat.fontFamily=e.value.toString()},this.fontColorUpdate=function(e){t.characterFormat.fontColor=e.currentValue.hex},this.setLeftAlignment=function(){"Left"===t.textAlignment?t.textAlignment="Justify":t.textAlignment="Left",t.updateParagraphFormat()},this.setRightAlignment=function(){"Right"===t.textAlignment?t.textAlignment="Left":t.textAlignment="Right",t.updateParagraphFormat()},this.setCenterAlignment=function(){"Center"===t.textAlignment?t.textAlignment="Left":t.textAlignment="Center",t.updateParagraphFormat()},this.setJustifyAlignment=function(){"Justify"===t.textAlignment?t.textAlignment="Left":t.textAlignment="Justify",t.updateParagraphFormat()},this.increaseBeforeAfterSpacing=function(){t.beforeSpacing+=6,t.afterSpacing+=6},this.decreaseBeforeAfterSpacing=function(){t.beforeSpacing>=6?t.beforeSpacing-=6:t.beforeSpacing=0,t.afterSpacing>=6?t.afterSpacing-=6:t.afterSpacing=0},this.updateNextStyle=function(e){var i=e.srcElement.value;if(t.getTypeValue()===t.localObj.getConstant("Paragraph")&&!(0,a.isNullOrUndefined)(i)&&""!==i&&!t.isUserNextParaUpdated){var n=t.documentHelper.styles.getStyleNames(t.getTypeValue());t.isEdit&&(n=n.filter((function(e){return e!==t.editStyleName}))),n.push(i),t.styleParagraph.dataSource=n,t.styleParagraph.index=null,t.styleParagraph.index=n.indexOf(i)}},this.updateOkButton=function(){t.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0).value;t.enableOrDisableOkButton()},this.styleTypeChange=function(e){if(e.isInteracted){var i=void 0;"Character"===e.value&&(t.style=new Oa,i="Character"),"Paragraph"!==e.value&&"Linked Style"!==e.value||(t.style=new Wa,i="Paragraph"),t.toggleDisable(),t.updateStyleNames(i)}},this.styleBasedOnChange=function(){},this.styleParagraphChange=function(e){e.isInteracted&&(t.isUserNextParaUpdated=!0)},this.showFontDialog=function(){(0,a.isNullOrUndefined)(t.documentHelper.owner.fontDialogModule)||t.documentHelper.owner.showFontDialog(t.characterFormat),t.updateCharacterFormat()},this.showParagraphDialog=function(){(0,a.isNullOrUndefined)(t.documentHelper.owner.paragraphDialogModule)||t.documentHelper.owner.showParagraphDialog(t.paragraphFormat)},this.showNumberingBulletDialog=function(){t.numberingBulletDialog=new Kh(t.documentHelper),t.style instanceof Wa&&!(0,a.isNullOrUndefined)(t.style.paragraphFormat)&&t.numberingBulletDialog.showNumberBulletDialog(t.style.paragraphFormat.listFormat,t.abstractList)},this.onOkButtonClick=function(){var e=t.documentHelper.owner.stylesDialogModule.getStyleName(a.SanitizeHtmlHelper.sanitize(t.styleNameElement.value));if(!(e.length>0))throw new Error("Enter valid Style name");var i,n=t.documentHelper.styles.findByName(e);if((0,a.isNullOrUndefined)(n)){var r="Paragraph"===t.getTypeValue()?new Wa:new Oa;r.copyStyle(t.style),"Character"===t.getTypeValue()&&r.characterFormat.copyFormat(t.characterFormat);var o=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleBasedOn.value));if("Paragraph"!==t.styleType.value&&"Linked Style"!==t.styleType.value||(e===t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleParagraph.value)?r.next=r:r.next=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleParagraph.value)),t.updateList()),r.link="Linked Style"===t.styleType.value?t.createLinkStyle(e):void 0,r.type=t.getTypeValue(),r.name=e,r.basedOn=o,r.characterFormat=t.characterFormat,r.paragraphFormat=t.paragraphFormat,t.documentHelper.styles.push(r),t.documentHelper.addToStylesMap(r),i=e,t.documentHelper.owner.editorHistoryModule.initializeHistory("ModifyStyle"),t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&"ModifyStyle"===t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action){var s=r instanceof Wa?r.paragraphFormat.listFormat.listId:-1;(d=t.documentHelper.owner.getStyleObject(r,s)).isNew=!0,t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(d),t.applyParagraphFormat()}t.documentHelper.owner.editorHistoryModule.updateHistory();h=t.style instanceof Wa?t.style.paragraphFormat.listFormat.listId:-1;t.documentHelper.owner.setStyleData(i,h),t.documentHelper.owner.editorModule.isSkipOperationsBuild="Character"===t.styleType.value&&t.documentHelper.owner.enableCollaborativeEditing,t.documentHelper.owner.editorModule.applyStyle(i,!0),t.documentHelper.owner.editorModule.isSkipOperationsBuild=!1,t.documentHelper.owner.notify(K,{})}else{if(t.documentHelper.owner.editorHistoryModule.initializeHistory("ModifyStyle"),"Paragraph"!==t.styleType.value&&"Linked Style"!==t.styleType.value||t.updateList(),t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo&&"ModifyStyle"===t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.action){var l=n instanceof Wa?n.paragraphFormat.listFormat.listId:-1,d=t.documentHelper.owner.getStyleObject(n,l);t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(d),t.applyParagraphFormat()}t.documentHelper.owner.editorHistoryModule.updateHistory(),t.style.type=t.getTypeValue(),t.style.basedOn=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleBasedOn.value)),"Paragraph"!==t.styleType.value&&"Linked Style"!==t.styleType.value||(t.style.next=t.documentHelper.styles.findByName(t.documentHelper.owner.stylesDialogModule.getStyleName(t.styleParagraph.value)),t.style.characterFormat.assignFormat(t.characterFormat),t.style.paragraphFormat.assignFormat(t.paragraphFormat,!0),t.style.link="Linked Style"===t.styleType.value?t.createLinkStyle(e,t.isEdit):void 0),t.style.name=n.name,i=n.name,n=t.style;var h=t.style instanceof Wa?t.style.paragraphFormat.listFormat.listId:-1;t.documentHelper.owner.setStyleData(i,h),t.documentHelper.owner.isShiftingEnabled=!0,t.documentHelper.owner.editorModule.isSkipOperationsBuild=t.documentHelper.owner.enableCollaborativeEditing,t.documentHelper.owner.editorModule.layoutWholeDocument(),t.documentHelper.owner.editorModule.isSkipOperationsBuild=!1,t.documentHelper.owner.isShiftingEnabled=!1}t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus(),t.style,t.documentHelper.updateFocus()},this.loadStyleDialog=function(){var e;if(t.documentHelper.updateFocus(),t.isUserNextParaUpdated=!1,t.styleNameElement=t.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0),t.styleNameElement.value=null,t.isEdit||(t.styleType.index=0),t.isEdit){var i=new a.L10n("documenteditor",t.documentHelper.owner.defaultLocale);i.setLocale(t.documentHelper.owner.locale);var n=i.getConstant(t.editStyleName);""===n&&(n=t.editStyleName),t.styleNameElement.value=n,e=t.editStyleName}t.okButton=t.documentHelper.dialog2.element.getElementsByClassName("e-flat e-style-okay").item(0),t.enableOrDisableOkButton(),t.updateStyleNames(t.getTypeValue(),e),t.updateCharacterFormat(t.style.characterFormat),t.updateParagraphFormat(t.style.paragraphFormat)},this.applyParagraphFormat=function(){(0,a.isNullOrUndefined)(t.paragraphFormat)&&(t.paragraphFormat=new ba),(0,a.isNullOrUndefined)(t.textAlignment)||(t.paragraphFormat.textAlignment=t.textAlignment),(0,a.isNullOrUndefined)(t.beforeSpacing)||(t.paragraphFormat.beforeSpacing=t.beforeSpacing),(0,a.isNullOrUndefined)(t.afterSpacing)||(t.paragraphFormat.afterSpacing=t.afterSpacing),(0,a.isNullOrUndefined)(t.leftIndent)||(t.paragraphFormat.leftIndent=t.leftIndent),(0,a.isNullOrUndefined)(t.lineSpacing)||(t.paragraphFormat.lineSpacing=t.lineSpacing),t.updateParagraphFormat()},this.onCancelButtonClick=function(){t.style=void 0,t.characterFormat=void 0,t.paragraphFormat=void 0,t.textAlignment=void 0,t.lineSpacing=void 0,t.leftIndent=void 0,t.beforeSpacing=void 0,t.afterSpacing=void 0,t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.closeStyleDialog=function(){t.documentHelper.updateFocus(),t.textAlignment=void 0,t.lineSpacing=void 0,t.leftIndent=void 0,t.beforeSpacing=void 0,t.afterSpacing=void 0},this.documentHelper=e}return e.prototype.getModuleName=function(){return"StyleDialog"},e.prototype.initStyleDialog=function(e,t){this.localObj=e,this.target=(0,a.createElement)("div",{className:"e-de-style-dialog"}),this.container=(0,a.createElement)("div"),this.properties=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Properties")}),this.container.appendChild(this.properties),this.styleNameTypeDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.container.appendChild(this.styleNameTypeDiv),this.nameWholeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.styleNameTypeDiv.appendChild(this.nameWholeDiv),this.nameValue=(0,a.createElement)("input",{className:"e-input e-de-style-dlg-name-input"}),this.nameValue.addEventListener("keyup",this.updateOkButtonClickHandler),this.nameValue.addEventListener("input",this.updateOkButtonClickHandler),this.nameValue.addEventListener("blur",this.updateNextStyleHandler),this.nameWholeDiv.appendChild(this.nameValue),new rl.TextBox({placeholder:e.getConstant("Name")+":",floatLabelType:"Always"},this.nameValue),this.styleTypeWholeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.styleNameTypeDiv.appendChild(this.styleTypeWholeDiv),this.styleTypeDivElement=(0,a.createElement)("div"),this.styleTypeValue=(0,a.createElement)("select"),this.styleTypeValue.innerHTML='<option value="Paragraph">'+e.getConstant("Paragraph")+'</option><option value="Character">'+e.getConstant("Character")+'</option><option value="Linked Style">'+e.getConstant("Linked Style")+"</option>",this.styleTypeDivElement.appendChild(this.styleTypeValue),this.styleType=new al.DropDownList({change:this.styleTypeChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style type")+":",floatLabelType:"Always"}),this.styleType.appendTo(this.styleTypeValue),this.styleTypeWholeDiv.appendChild(this.styleTypeDivElement),this.styleBasedParaDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.container.appendChild(this.styleBasedParaDiv),this.styleBasedOnWholeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.styleBasedParaDiv.appendChild(this.styleBasedOnWholeDiv),this.styleBasedOnDivElement=(0,a.createElement)("div",{className:"e-de-style-style-based-on-div"}),this.styleBasedOnValue=(0,a.createElement)("input"),this.styleBasedOnDivElement.appendChild(this.styleBasedOnValue),this.styleBasedOn=new al.DropDownList({dataSource:[],select:this.styleBasedOnChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style based on")+":",floatLabelType:"Always"}),this.styleBasedOn.appendTo(this.styleBasedOnValue),this.styleBasedOnWholeDiv.appendChild(this.styleBasedOnDivElement),this.styleParagraphWholeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.styleBasedParaDiv.appendChild(this.styleParagraphWholeDiv),t&&(this.nameWholeDiv.classList.add("e-de-rtl"),this.styleBasedOnWholeDiv.classList.add("e-de-rtl"),this.styleParagraphWholeDiv.classList.add("e-de-rtl")),this.styleParagraphDivElement=(0,a.createElement)("div"),this.styleParagraphValue=(0,a.createElement)("input"),this.styleParagraphDivElement.appendChild(this.styleParagraphValue),this.styleParagraph=new al.DropDownList({dataSource:[],select:this.styleParagraphChange,popupHeight:"253px",enableRtl:t,placeholder:e.getConstant("Style for following paragraph")+":",floatLabelType:"Always"}),this.styleParagraph.appendTo(this.styleParagraphValue),this.styleParagraphWholeDiv.appendChild(this.styleParagraphDivElement),this.formatting=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Formatting")}),this.container.appendChild(this.formatting),this.optionsDiv=(0,a.createElement)("div",{className:"e-de-style-options-div"}),this.container.appendChild(this.optionsDiv),this.fontOptionsDiv=(0,a.createElement)("div",{styles:"display:flex;margin-bottom: 14px;"}),this.optionsDiv.appendChild(this.fontOptionsDiv),this.createFontOptions(this.fontOptionsDiv,t),this.paragraphOptionsDiv=(0,a.createElement)("div",{styles:"display:flex",className:"e-style-paragraph"}),this.optionsDiv.appendChild(this.paragraphOptionsDiv),this.createParagraphOptions(this.paragraphOptionsDiv),this.createFormatDropdown(this.container,e,t),this.target.appendChild(this.container)},e.prototype.createFormatDropdown=function(e,t,i){var n=this;this.formatBtn=(0,a.createElement)("button",{id:"style_format_dropdown",innerHTML:t.getConstant("Format"),attrs:{type:"button"}}),this.formatBtn.style.height="31px",e.appendChild(this.formatBtn);var r=[{text:t.getConstant("Font")+"...",id:"style_font"},{text:t.getConstant("Paragraph")+"...",id:"style_paragraph"},{text:t.getConstant("Numbering")+"...",id:"style_numbering"}];this.styleDropdwn=new pl.DropDownButton({items:r,cssClass:"e-de-style-format-dropdwn",enableRtl:i,beforeItemRender:function(e){n.styleType.value===t.getConstant("Character")?("style_paragraph"===e.item.id&&e.element.classList.add("e-disabled"),"style_numbering"===e.item.id&&e.element.classList.add("e-disabled")):("style_paragraph"===e.item.id&&e.element.classList.remove("e-disabled"),"style_numbering"===e.item.id&&e.element.classList.remove("e-disabled"))}}),this.styleDropdwn.appendTo(this.formatBtn),this.styleDropdwn.addEventListener("select",this.openDialogHandler)},e.prototype.onOpenDialog=function(e){this.openDialog(e)},e.prototype.createFontOptions=function(e,t){var i=this;this.fontFamilyElement=(0,a.createElement)("input",{id:this.target.id+"_fontName"});var n=(0,a.initializeCSPTemplate)((function(e){return'<span style="font-family: '+e.FontName+';">'+e.FontName+"</span>"}));e.appendChild(this.fontFamilyElement),this.fontFamily=new al.ComboBox({dataSource:undefined,query:(new jh.Query).select(["FontName"]),fields:{text:"FontName",value:"value"},allowCustom:!0,width:"123px",popupWidth:"123px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontFamilyChanged,showClearButton:!1,itemTemplate:n}),this.fontFamily.appendTo(this.fontFamilyElement),this.fontFamily.isStringTemplate=!0;for(var r=this.documentHelper.owner.documentEditorSettings.fontFamilies,o=0;o<r.length;o++){var s=r[o],l={FontName:s,value:s};this.fontFamily.addItem(l,o)}this.fontFamily.focus=function(){i.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font")),this.fontSizeElement=(0,a.createElement)("input"),e.appendChild(this.fontSizeElement);this.fontSize=new al.ComboBox({dataSource:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],width:"73px",cssClass:"e-style-font-fmaily-right",enableRtl:t,change:this.fontSizeUpdate}),this.fontSize.showClearButton=!1,this.fontSize.appendTo(this.fontSizeElement),this.fontGroupButton=(0,a.createElement)("div",{className:"e-de-style-font-group-button"}),e.appendChild(this.fontGroupButton),this.bold=this.createButtonElement(this.fontGroupButton,"e-de-bold","e-de-style-bold-button-size",this.documentHelper.owner.containerId+"_style_bold"),this.bold.setAttribute("aria-label","bold"),this.bold.addEventListener("click",this.setBoldPropertyHandler),this.italic=this.createButtonElement(this.fontGroupButton,"e-de-italic","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_italic"),this.italic.setAttribute("aria-label","italic"),this.italic.addEventListener("click",this.setItalicPropertyHandler),this.underline=this.createButtonElement(this.fontGroupButton,"e-de-underline","e-de-style-icon-button-size",this.documentHelper.owner.containerId+"_style_underline"),this.underline.setAttribute("aria-label","underline"),this.underline.addEventListener("click",this.setUnderlinePropertyHandler),this.fontColorElement=(0,a.createElement)("input",{attrs:{type:"color"},className:"e-de-style-icon-button-size"}),e.appendChild(this.fontColorElement);var d=this.documentHelper.owner.documentEditorSettings.colorPickerSettings,h=d.columns,c=d.createPopupOnClick,p=d.disabled,u=d.enablePersistence,g=(d.enableRtl,d.inline),m=d.mode,f=d.modeSwitcher,v=d.noColor,y=d.presetColors,w=d.showButtons;this.fontColor=new rl.ColorPicker({cssClass:"e-de-style-font-color-picker",enableRtl:t,change:this.fontColorUpdate,locale:this.documentHelper.owner.locale,enableOpacity:!1,mode:m,modeSwitcher:f,showButtons:w,columns:h,createPopupOnClick:c,disabled:p,enablePersistence:u,inline:g,noColor:v,presetColors:y}),this.documentHelper.fontColor=this.fontColor,this.fontColor.appendTo(this.fontColorElement)},e.prototype.onSetBoldProperty=function(){this.setBoldProperty()},e.prototype.onSetItalicProperty=function(){this.setItalicProperty()},e.prototype.onSetUnderlineProperty=function(){this.setUnderlineProperty()},e.prototype.createParagraphOptions=function(e){this.alignmentDiv=(0,a.createElement)("div",{className:"e-de-style-paragraph-group-button"}),e.appendChild(this.alignmentDiv),this.leftAlign=this.createButtonElement(this.alignmentDiv,"e-de-align-left","e-de-style-icon-button-size"),this.leftAlign.setAttribute("aria-label","leftAlign"),this.leftAlign.addEventListener("click",this.setLeftAlignmentClickHandler),this.centerAlign=this.createButtonElement(this.alignmentDiv,"e-de-align-center","e-de-style-icon-button-size"),this.centerAlign.setAttribute("aria-label","centerAlign"),this.centerAlign.addEventListener("click",this.setCenterAlignmentClickHandler),this.rightAlign=this.createButtonElement(this.alignmentDiv,"e-de-align-right","e-de-style-icon-button-size"),this.rightAlign.setAttribute("aria-label","rightAlign"),this.rightAlign.addEventListener("click",this.setRightAlignmentClickHandler),this.justify=this.createButtonElement(this.alignmentDiv,"e-de-justify","e-de-style-icon-button-last-size"),this.justify.setAttribute("aria-label","justify"),this.justify.addEventListener("click",this.setJustifyAlignmentClickHandler),this.lineSpacingDiv=(0,a.createElement)("div",{className:"e-de-style-paragraph-group-button"}),e.appendChild(this.lineSpacingDiv),this.singleLineSpacing=this.createButtonElement(this.lineSpacingDiv,"e-de-single-spacing","e-de-style-icon-button-first-size"),this.singleLineSpacing.setAttribute("aria-label","singleLineSpacing"),this.singleLineSpacing.addEventListener("click",this.setSingleLineSpacingClickHandler),this.onePointFiveLineSpacing=this.createButtonElement(this.lineSpacingDiv,"e-de-one-point-five-spacing","e-de-style-icon-button-size"),this.onePointFiveLineSpacing.setAttribute("aria-label","onePointFiveLineSpacing"),this.onePointFiveLineSpacing.addEventListener("click",this.setOnePointFiveLineSpacingClickHandler),this.doubleLineSpacing=this.createButtonElement(this.lineSpacingDiv,"e-de-double-spacing","e-de-style-icon-button-last-size"),this.doubleLineSpacing.setAttribute("aria-label","doubleLineSpacing"),this.doubleLineSpacing.addEventListener("click",this.setDoubleLineSpacingClickHandler),this.spacingDiv=(0,a.createElement)("div",{className:"e-de-style-paragraph-group-button"}),e.appendChild(this.spacingDiv),this.beforeSpacingEle=this.createButtonElement(this.spacingDiv,"e-de-before-spacing","e-de-style-icon-button-first-size"),this.beforeSpacingEle.setAttribute("aria-label","beforeSpacing"),this.afterSpacingEle=this.createButtonElement(this.spacingDiv,"e-de-after-spacing","e-de-style-icon-button-last-size"),this.afterSpacingEle.setAttribute("aria-label","afterSpacing"),this.beforeSpacingEle.addEventListener("click",this.increaseBeforeAfterSpacingValueHandler),this.afterSpacingEle.addEventListener("click",this.decreaseBeforeAfterSpacingValueHandler),this.indentingDiv=(0,a.createElement)("div",{className:"e-de-style-paragraph-indent-group-button"}),e.appendChild(this.indentingDiv),this.decreaseIndent=this.createButtonElement(this.indentingDiv,"e-de-indent","e-de-style-icon-button-first-size"),this.decreaseIndent.setAttribute("aria-label","decreaseIndent"),this.decreaseIndent.addEventListener("click",this.decreaseIndentValueHandler),this.increaseindent=this.createButtonElement(this.indentingDiv,"e-de-outdent","e-de-style-icon-button-size"),this.increaseindent.setAttribute("aria-label","increaseindent"),this.increaseindent.addEventListener("click",this.increaseIndentValueHandler)},e.prototype.setSingleLineSpacing=function(){this.lineSpacing=1,this.updateParagraphFormat()},e.prototype.setOnePointFiveLineSpacing=function(){this.lineSpacing=1.5,this.updateParagraphFormat()},e.prototype.setDoubleLineSpacing=function(){this.lineSpacing=2,this.updateParagraphFormat()},e.prototype.increaseIndentValue=function(){this.leftIndent+=36},e.prototype.decreaseIndentValue=function(){this.leftIndent>=36?this.leftIndent-=36:this.leftIndent=0},e.prototype.onSetLeftAlignmentClick=function(){this.setLeftAlignment()},e.prototype.onSetRightAlignmentClick=function(){this.setRightAlignment()},e.prototype.onSetCenterAlignmentClick=function(){this.setCenterAlignment()},e.prototype.onSetJustifyAlignmentClick=function(){this.setJustifyAlignment()},e.prototype.createButtonElement=function(e,t,i,n){var r=(0,a.createElement)("button",{attrs:{type:"button"}});return(0,a.isNullOrUndefined)(n)||(r.id=n),e.appendChild(r),new tl.Button({iconCss:t,cssClass:i}).appendTo(r),r},e.prototype.onIncreaseBeforeAfterSpacing=function(){this.increaseBeforeAfterSpacing()},e.prototype.onDecreaseBeforeAfterSpacing=function(){this.decreaseBeforeAfterSpacing()},e.prototype.toggleDisable=function(){this.styleType.value===this.localObj.getConstant("Character")?(this.styleParagraph.enabled=!1,this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex;pointer-events:none;opacity:0.5")):(this.styleParagraph.enabled=!0,this.target.getElementsByClassName("e-style-paragraph").item(0).removeAttribute("style"),this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex")),this.styleBasedOn.enabled=!0},e.prototype.onUpdateNextStyle=function(e){this.updateNextStyle(e)},e.prototype.onUpdateOkButtonClick=function(){this.updateOkButton()},e.prototype.show=function(e,t){var i=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);this.isEdit=!(0,a.isNullOrUndefined)(e)&&e.length>0,this.editStyleName=e,this.abstractList=new Aa;var n=this.documentHelper.styles.findByName(e);this.style=this.isEdit?n||this.getStyle(e):new Wa,i.setLocale(this.documentHelper.owner.locale),this.target||this.initStyleDialog(i,this.documentHelper.owner.enableRtl),this.isEdit?this.styleType.value=this.style instanceof Oa?"Character":"Paragraph":this.styleType.value="Paragraph",(0,a.isNullOrUndefined)(t)&&(t=i.getConstant("Create New Style")),this.documentHelper.dialog2.header=t,this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.buttons=[{click:this.onOkButtonClick,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-style-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-style-cancel"}}],this.toggleDisable(),this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.beforeOpen=this.loadStyleDialog,this.documentHelper.dialog2.close=this.closeStyleDialog,this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.show()},e.prototype.updateList=function(){var e=this.style.paragraphFormat.listFormat.listId;e>-1&&(0===this.documentHelper.lists.filter((function(t){return t.listId===e})).length||(this.documentHelper.lists=this.documentHelper.lists.filter((function(t){return t.listId!==e}))),this.documentHelper.lists.push(this.style.paragraphFormat.listFormat.list)),-1!==this.abstractList.abstractListId&&this.documentHelper.abstractLists.push(this.abstractList)},e.prototype.createLinkStyle=function(e,t){var i;return(i=t?this.documentHelper.styles.findByName(e+" Char","Character"):new Oa).type="Character",i.name=e+" Char",i.characterFormat=this.style.characterFormat.cloneFormat(),i.basedOn=this.style.basedOn,t||this.documentHelper.styles.push(i),this.documentHelper.styles.findByName(i.name,"Character")},e.prototype.updateCharacterFormat=function(e){(0,a.isNullOrUndefined)(e)||(this.characterFormat=e.cloneFormat()),this.fontFamily.value=this.characterFormat.fontFamily,this.fontSize.value=this.characterFormat.fontSize;var t=this.characterFormat.fontColor;this.fontColor.value="empty"===t||"#00000000"===t?"#000000":t,this.fontButtonClicked()},e.prototype.updateParagraphFormat=function(e){(0,a.isNullOrUndefined)(e)||(this.paragraphFormat=e.cloneFormat(),this.textAlignment=e.textAlignment,this.lineSpacing=e.lineSpacing),(0,a.isNullOrUndefined)(this.paragraphFormat)||("Left"===this.textAlignment?(this.leftAlign.classList.contains("e-active")||this.leftAlign.classList.add("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Right"===this.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")||this.rightAlign.classList.add("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Center"===this.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")||this.centerAlign.classList.add("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Justify"===this.textAlignment&&(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")||this.justify.classList.add("e-active")),1===this.lineSpacing?(this.singleLineSpacing.classList.add("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")):1.5===this.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.add("e-active"),this.doubleLineSpacing.classList.remove("e-active")):2===this.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.add("e-active")):(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")))},e.prototype.enableOrDisableOkButton=function(){(0,a.isNullOrUndefined)(this.okButton)||(this.okButton.disabled=""===this.styleNameElement.value)},e.prototype.getTypeValue=function(e){var t=(0,a.isNullOrUndefined)(e)?this.styleType.value:e;return"Linked Style"===t||"Paragraph"===t?"Paragraph":"Character"},e.prototype.updateStyleNames=function(e,t){var i=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale);for(var n=this.documentHelper.styles.getStyleNames(e),r=[],o=0;o<n.length;o++){""===(c=i.getConstant(n[parseInt(o.toString(),10)]))&&(c=n[parseInt(o.toString(),10)]),r.push(c)}if(this.styleParagraph.dataSource=r,this.styleParagraph.index=null,t){this.styleBasedOn.dataSource=r.filter((function(e){return e!==t})),this.styleBasedOn.index=null;var s=this.getStyle(t);if(s.basedOn instanceof String||(0,a.isNullOrUndefined)(s.basedOn)?this.styleBasedOn.enabled=!1:this.styleBasedOn.index=n.indexOf(s.basedOn.name)>-1?n.indexOf(s.basedOn.name):0,"Paragraph"===s.type?(0,a.isNullOrUndefined)(s.link)?this.styleType.index=0:this.styleType.index=2:this.styleType.index=1,!(0,a.isNullOrUndefined)(s.next)){var l=s.next.name,d=0;n.indexOf(l)>-1&&(d=n.indexOf(l)),this.styleParagraph.index=d,this.isUserNextParaUpdated=l!==t}}else{this.styleBasedOn.dataSource=r,this.styleBasedOn.index=null;var h=0;if(this.documentHelper.owner.selectionModule){var c=void 0;c="Character"===e?this.documentHelper.owner.selectionModule.characterFormat.styleName:this.documentHelper.owner.selectionModule.paragraphFormat.styleName,h=n.indexOf(c)}this.styleBasedOn.index=h,this.styleParagraph.index=0}this.isEdit?this.styleType.enabled=!1:this.styleType.enabled=!0},e.prototype.getStyle=function(e){return(0,a.isNullOrUndefined)(this.documentHelper.styles.findByName(e))&&this.documentHelper.owner.editorModule.createStyle(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles.findByName(e)},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.fontColor&&(this.fontColor.destroy(),this.fontColor=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily=void 0),this.styleType&&(this.styleType.destroy(),this.styleType=void 0),this.styleBasedOn&&(this.styleBasedOn.destroy(),this.styleBasedOn=void 0),this.styleParagraph&&(this.styleParagraph.destroy(),this.styleParagraph=void 0),this.onlyThisDocument&&this.onlyThisDocument.destroy(),this.onlyThisDocument=void 0,this.template&&(this.template.destroy(),this.template=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.numberingBulletDialog&&(this.numberingBulletDialog.destroy(),this.numberingBulletDialog=void 0),this.styleDropdwn&&(this.styleDropdwn.destroy(),this.styleDropdwn=void 0),this.textAlignment&&(this.textAlignment=void 0),this.lineSpacing&&(this.lineSpacing=void 0),this.leftIndent&&(this.leftIndent=void 0),this.beforeSpacing&&(this.beforeSpacing=void 0),this.afterSpacing&&(this.afterSpacing=void 0),this.removeEvents(),this.removeElements(),this.documentHelper=void 0},e.prototype.removeEvents=function(){this.nameValue&&(this.nameValue.removeEventListener("input",this.updateOkButtonClickHandler),this.nameValue.removeEventListener("keyup",this.updateOkButtonClickHandler),this.nameValue.removeEventListener("blur",this.updateNextStyleHandler)),this.styleDropdwn&&this.styleDropdwn.removeEventListener("select",this.openDialogHandler),this.bold&&this.bold.removeEventListener("click",this.setBoldPropertyHandler),this.italic&&this.italic.removeEventListener("click",this.setItalicPropertyHandler),this.underline&&this.underline.removeEventListener("click",this.setUnderlinePropertyHandler),this.leftAlign&&this.leftAlign.removeEventListener("click",this.setLeftAlignmentClickHandler),this.centerAlign&&this.centerAlign.removeEventListener("click",this.setCenterAlignmentClickHandler),this.rightAlign&&this.rightAlign.removeEventListener("click",this.setRightAlignmentClickHandler),this.justify&&this.justify.removeEventListener("click",this.setJustifyAlignmentClickHandler),this.singleLineSpacing&&this.singleLineSpacing.removeEventListener("click",this.setSingleLineSpacingClickHandler),this.onePointFiveLineSpacing&&this.onePointFiveLineSpacing.removeEventListener("click",this.setOnePointFiveLineSpacingClickHandler),this.doubleLineSpacing&&this.doubleLineSpacing.removeEventListener("click",this.setDoubleLineSpacingClickHandler),this.beforeSpacingEle&&this.beforeSpacingEle.removeEventListener("click",this.increaseBeforeAfterSpacingValueHandler),this.afterSpacingEle&&this.afterSpacingEle.removeEventListener("click",this.decreaseBeforeAfterSpacingValueHandler),this.decreaseIndent&&this.decreaseIndent.removeEventListener("click",this.decreaseIndentValueHandler),this.increaseindent&&this.increaseindent.removeEventListener("click",this.increaseIndentValueHandler)},e.prototype.removeElements=function(){this.container&&(this.container.remove(),this.container=void 0),this.properties&&(this.properties.remove(),this.properties=void 0),this.styleNameTypeDiv&&(this.styleNameTypeDiv.remove(),this.styleNameTypeDiv=void 0),this.nameWholeDiv&&(this.nameWholeDiv.remove(),this.nameWholeDiv=void 0),this.nameValue&&(this.nameValue.remove(),this.nameValue=void 0),this.styleTypeWholeDiv&&(this.styleTypeWholeDiv.remove(),this.styleTypeWholeDiv=void 0),this.styleTypeDivElement&&(this.styleTypeDivElement.remove(),this.styleTypeDivElement=void 0),this.styleTypeValue&&(this.styleTypeValue.remove(),this.styleTypeValue=void 0),this.styleBasedParaDiv&&(this.styleBasedParaDiv.remove(),this.styleBasedParaDiv=void 0),this.styleBasedOnWholeDiv&&(this.styleBasedOnWholeDiv.remove(),this.styleBasedOnWholeDiv=void 0),this.styleBasedOnDivElement&&(this.styleBasedOnDivElement.remove(),this.styleBasedOnDivElement=void 0),this.styleBasedOnValue&&(this.styleBasedOnValue.remove(),this.styleBasedOnValue=void 0),this.styleParagraphWholeDiv&&(this.styleParagraphWholeDiv.remove(),this.styleParagraphWholeDiv=void 0),this.styleParagraphDivElement&&(this.styleParagraphDivElement.remove(),this.styleParagraphDivElement=void 0),this.styleParagraphValue&&(this.styleParagraphValue.remove(),this.styleParagraphValue=void 0),this.formatting&&(this.formatting.remove(),this.formatting=void 0),this.optionsDiv&&(this.optionsDiv.remove(),this.optionsDiv=void 0),this.fontOptionsDiv&&(this.fontOptionsDiv.remove(),this.fontOptionsDiv=void 0),this.paragraphOptionsDiv&&(this.paragraphOptionsDiv.remove(),this.paragraphOptionsDiv=void 0),this.formatBtn&&(this.formatBtn.remove(),this.formatBtn=void 0),this.fontFamilyElement&&(this.fontFamilyElement.remove(),this.fontFamilyElement=void 0),this.fontSizeElement&&(this.fontSizeElement.remove(),this.fontSizeElement=void 0),this.fontGroupButton&&(this.fontGroupButton.remove(),this.fontGroupButton=void 0),this.fontColorElement&&(this.fontColorElement.remove(),this.fontColorElement=void 0),this.alignmentDiv&&(this.alignmentDiv.remove(),this.alignmentDiv=void 0),this.lineSpacingDiv&&(this.lineSpacingDiv.remove(),this.lineSpacingDiv=void 0),this.spacingDiv&&(this.spacingDiv.remove(),this.spacingDiv=void 0),this.beforeSpacingEle&&(this.beforeSpacingEle.remove(),this.beforeSpacingEle=void 0),this.afterSpacingEle&&(this.afterSpacingEle.remove(),this.afterSpacingEle=void 0),this.indentingDiv&&(this.indentingDiv.remove(),this.indentingDiv=void 0),this.decreaseIndent&&(this.decreaseIndent.remove(),this.decreaseIndent=void 0),this.increaseindent&&(this.increaseindent.remove(),this.increaseindent=void 0)},e}(),Kh=function(){function e(e){var t=this;this.isBullet=!1,this.numberListClickHandler=this.onNumberListClick.bind(this),this.bulletListClickHandler=this.onBulletListClick.bind(this),this.numberListClick=function(e){t.isBullet=!1,t.setActiveElement(e),e.currentTarget.classList.contains("e-de-list-numbered-none")?(t.numberFormat=void 0,t.listLevelPattern=void 0):e.currentTarget.classList.contains("e-de-list-numbered-number-dot")?(t.numberFormat="%1.",t.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-number-brace")?(t.numberFormat="%1)",t.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-up-roman")?(t.numberFormat="%1.",t.listLevelPattern="UpRoman"):e.currentTarget.classList.contains("e-de-list-numbered-up-letter")?(t.numberFormat="%1.",t.listLevelPattern="UpLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-letter-brace")?(t.numberFormat="%1)",t.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-numbered-low-letter-dot")?(t.numberFormat="%1.",t.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-roman")&&(t.numberFormat="%1.",t.listLevelPattern="LowRoman")},this.bulletListClick=function(e){t.isBullet=!0,t.setActiveElement(e),e.currentTarget.classList.contains("e-bullet-none")?(t.symbol=void 0,t.fontFamily=void 0):e.currentTarget.classList.contains("e-bullet-dot")?(t.symbol=String.fromCharCode(61623),t.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-circle")?(t.symbol=String.fromCharCode(61551)+String.fromCharCode(32),t.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-square")?(t.symbol=String.fromCharCode(61607),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-flower")?(t.symbol=String.fromCharCode(61558),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-arrow")?(t.symbol=String.fromCharCode(61656),t.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-tick")&&(t.symbol=String.fromCharCode(61692),t.fontFamily="Wingdings")},this.loadNumberingBulletDialog=function(){t.documentHelper.updateFocus()},this.closeNumberingBulletDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.isBullet=!1,t.listLevelPattern=void 0,t.numberFormat=void 0,t.symbol=void 0,t.fontFamily=void 0,t.documentHelper.dialog.hide(),t.unWireEventsAndBindings()},this.onOkButtonClick=function(){t.documentHelper.owner.documentHelper.lists.length>0?(t.listFormat.list.listId=t.documentHelper.owner.documentHelper.lists[t.documentHelper.owner.documentHelper.lists.length-1].listId+1,t.listFormat.listId=t.listFormat.list.listId):(t.listFormat.list.listId=0,t.listFormat.listId=0),t.documentHelper.owner.documentHelper.abstractLists.length>0?t.abstractList.abstractListId=t.documentHelper.owner.documentHelper.abstractLists[t.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1:t.abstractList.abstractListId=0,t.listFormat.list.abstractListId=t.abstractList.abstractListId,t.listFormat.nsid=t.listFormat.list.nsid=t.abstractList.nsid;var e=new Va(t.abstractList);e.listLevelPattern=(0,a.isNullOrUndefined)(t.listLevelPattern)?"Bullet":t.listLevelPattern,e.numberFormat=t.isBullet?t.symbol:t.numberFormat,"Bullet"!==e.listLevelPattern&&(e.startAt=1),e.characterFormat.fontFamily=(0,a.isNullOrUndefined)(t.fontFamily)?"Verdana":t.fontFamily,e.paragraphFormat.leftIndent=36,e.paragraphFormat.firstLineIndent=-18,t.abstractList.levels.push(e),t.listFormat.listLevelNumber=0,t.listFormat.list.abstractList=t.abstractList,t.documentHelper.hideDialog()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"BulletsAndNumberingDialog"},e.prototype.initNumberingBulletDialog=function(e){var t=this.documentHelper.owner.containerId;this.target=(0,a.createElement)("div",{id:t+"_insertNumberBulletDialog",className:"e-de-number-bullet-dlg"}),this.tabTarget=(0,a.createElement)("div",{id:t+"_tabNumberBulletDialog",className:"e-de-tab-number-bullet-dlg"}),this.target.appendChild(this.tabTarget),this.createNumberList(t,e),this.createBulletList(t,e),this.tabObj=new ua.Tab({items:[{header:{text:(0,a.createElement)("div",{innerHTML:e.getConstant("Numbering")})},content:this.numberListDiv},{header:{text:(0,a.createElement)("div",{innerHTML:e.getConstant("Bullets")})},content:this.bulletListDiv}],heightAdjustMode:"None",width:"auto",selecting:this.onTabSelect.bind(this)}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(this.tabTarget)},e.prototype.onTabSelect=function(e){e.preventFocus=!0,1===e.selectingIndex&&(this.bulletListDiv.style.display="block")},e.prototype.createNumberList=function(e,t){this.numberListDiv=(0,a.createElement)("div",{className:"e-de-style-numbered-list",id:e+"_Number"});var i=this.numberListDiv;this.ulTag=(0,a.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"}),i.appendChild(this.ulTag);var n=this.createNumberNoneListTag(this.ulTag,t),r=this.createNumberListTag(this.ulTag,"1.","2.","3.","e-de-list-numbered-number-dot"),o=this.createNumberListTag(this.ulTag,"1)","2)","3)","e-de-list-numbered-number-brace"),s=this.createNumberListTag(this.ulTag,"I.","II.","III.","e-de-list-numbered-up-roman"),l=this.createNumberListTag(this.ulTag,"A.","B.","C.","e-de-list-numbered-up-letter"),d=this.createNumberListTag(this.ulTag,"a.","b.","c.","e-de-numbered-low-letter-dot"),h=this.createNumberListTag(this.ulTag,"a)","b)","c)","e-de-list-numbered-low-letter-brace"),c=this.createNumberListTag(this.ulTag,"i.","ii.","iii.","e-de-list-numbered-low-roman");n.addEventListener("click",this.numberListClickHandler),r.addEventListener("click",this.numberListClickHandler),o.addEventListener("click",this.numberListClickHandler),s.addEventListener("click",this.numberListClickHandler),l.addEventListener("click",this.numberListClickHandler),h.addEventListener("click",this.numberListClickHandler),d.addEventListener("click",this.numberListClickHandler),c.addEventListener("click",this.numberListClickHandler),this.target.appendChild(i)},e.prototype.createNumberListTag=function(e,t,i,n,r){this.liTag=(0,a.createElement)("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size "+r}),e.appendChild(this.liTag);var o="<div>"+t+'<span class="e-de-ui-list-line"></span></div><div>'+i+'<span class="e-de-ui-list-line">';return o+="</span></div><div>"+n+'<span class="e-de-ui-list-line"> </span></div >',this.liInnerDiv=(0,a.createElement)("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:o}),this.liTag.style.cssFloat="left",this.liTag.appendChild(this.liInnerDiv),this.liTag},e.prototype.createNumberNoneListTag=function(e,t){this.liTag1=(0,a.createElement)("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none"}),e.appendChild(this.liTag1);var i='<div class="e-de-ui-bullets e-de-bullet-icons">'+t.getConstant("None")+"</div>";return this.liInnerDiv1=(0,a.createElement)("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:i}),this.liTag1.style.cssFloat="left",this.liTag1.appendChild(this.liInnerDiv1),this.liTag1},e.prototype.createBulletListTag=function(e,t,i,n){this.liTag2=(0,a.createElement)("li",{styles:"display:block;",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size "+i}),e.appendChild(this.liTag2);var r="e-bullet-none"===i;return this.liInnerDiv2=(0,a.createElement)("div",{className:"e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size",styles:r?"font-size:9px;text-align: center;top: 13px;left:-2px;line-height:normal;position: relative":""}),this.liNextDiv=(0,a.createElement)("div",{className:r?"":t,innerHTML:r?n.getConstant("None"):""}),this.liInnerDiv2.appendChild(this.liNextDiv),this.liTag2.appendChild(this.liInnerDiv2),this.liTag2},e.prototype.createBulletList=function(e,t){this.bulletListDiv=(0,a.createElement)("div",{className:"e-de-ui-bullet-list-header-presetmenu",id:e+"_Bullet"});var i=this.bulletListDiv;i.style.display="none",this.ulTag1=(0,a.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"}),i.appendChild(this.ulTag1);var n=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-none e-de-bullet-icons","e-bullet-none",t),r=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-dot e-de-bullet-icons","e-bullet-dot"),o=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-circle e-de-bullet-icons","e-bullet-circle"),s=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-square e-de-bullet-icons","e-bullet-square"),l=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-flower e-de-bullet-icons","e-bullet-flower"),d=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-arrow e-de-bullet-icons","e-bullet-arrow"),h=this.createBulletListTag(this.ulTag1,"e-de-icon-bullet-list-tick e-de-bullet-icons","e-bullet-tick");n.addEventListener("click",this.bulletListClickHandler),r.addEventListener("click",this.bulletListClickHandler),o.addEventListener("click",this.bulletListClickHandler),s.addEventListener("click",this.bulletListClickHandler),l.addEventListener("click",this.bulletListClickHandler),d.addEventListener("click",this.bulletListClickHandler),h.addEventListener("click",this.bulletListClickHandler),this.target.appendChild(i)},e.prototype.showNumberBulletDialog=function(e,t){(0,a.isNullOrUndefined)(e)?this.listFormat=new ya:this.listFormat=e,(0,a.isNullOrUndefined)(this.listFormat.list)&&(this.listFormat.list=new zh),(0,a.isNullOrUndefined)(t)?this.abstractList=new Aa:this.abstractList=t;var i=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale),this.target||this.initNumberingBulletDialog(i),this.documentHelper.dialog.header=i.getConstant("Numbering and Bullets"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadNumberingBulletDialog,this.documentHelper.dialog.close=this.closeNumberingBulletDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.buttons=[{click:this.onOkButtonClick,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-numbering-bullet-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-numbering-bullet-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.tabObj.refresh()},e.prototype.onNumberListClick=function(e){this.numberListClick(e)},e.prototype.setActiveElement=function(e){for(var t=e.currentTarget.parentElement,i=0;i<t.childElementCount;i++)t.childNodes[i].classList.contains("e-de-list-active")&&t.childNodes[i].classList.remove("e-de-list-active");e.currentTarget.classList.add("e-de-list-active")},e.prototype.onBulletListClick=function(e){this.bulletListClick(e)},e.prototype.unWireEventsAndBindings=function(){},e.prototype.destroy=function(){if(this.documentHelper=void 0,this.listFormat&&(this.listFormat.destroy(),this.listFormat=void 0),this.tabObj&&(this.tabObj.destroy(),this.tabObj=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.target&&this.target.parentElement){this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.removeEvents(),this.removeElements(),this.bulletListDiv=void 0,this.numberListDiv=void 0},e.prototype.removeEvents=function(){this.liTag&&this.liTag.removeEventListener("click",this.numberListClickHandler),this.liTag1&&this.liTag1.removeEventListener("click",this.numberListClickHandler),this.liTag2&&this.liTag2.removeEventListener("click",this.numberListClickHandler),this.liTag&&this.liTag.removeEventListener("click",this.bulletListClickHandler),this.liTag1&&this.liTag1.removeEventListener("click",this.bulletListClickHandler),this.liTag2&&this.liTag2.removeEventListener("click",this.bulletListClickHandler)},e.prototype.removeElements=function(){this.ulTag&&(this.ulTag.remove(),this.ulTag=void 0),this.ulTag1&&(this.ulTag1.remove(),this.ulTag1=void 0),this.liTag&&(this.liTag.remove(),this.liTag=void 0),this.liTag1&&(this.liTag1.remove(),this.liTag1=void 0),this.liTag2&&(this.liTag2.remove(),this.liTag2=void 0),this.liNextDiv&&(this.liNextDiv.remove(),this.liNextDiv=void 0),this.liInnerDiv&&(this.liInnerDiv.remove(),this.liInnerDiv=void 0),this.liInnerDiv1&&(this.liInnerDiv1.remove(),this.liInnerDiv1=void 0),this.liInnerDiv2&&(this.liInnerDiv2.remove(),this.liInnerDiv2=void 0)},e}(),Xh=function(){function e(e){var t=this;this.fontStyleInternal=void 0,this.fontNameList=void 0,this.fontStyleText=void 0,this.fontSizeText=void 0,this.colorPicker=void 0,this.underlineDrop=void 0,this.strikethroughBox=void 0,this.doublestrikethrough=void 0,this.superscript=void 0,this.subscript=void 0,this.allcaps=void 0,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontColor=void 0,this.allCaps=void 0,this.isListDialog=!1,this.characterFormat=void 0,this.loadFontDialog=function(){var e;if(t.documentHelper.updateFocus(),e=t.characterFormat?t.characterFormat:t.documentHelper.owner.selectionModule.characterFormat,t.fontNameList.value=e.fontFamily,t.fontNameList.dataBind(),e.bold||e.italic?e.bold&&!e.italic?(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=1):!e.bold&&e.italic?(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=2):e.bold&&e.italic&&(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=3):(t.fontStyleText.value=t.fontSizeText.value,t.fontStyleText.index=0),(0,a.isNullOrUndefined)(e.fontSize)||(t.fontSizeText.value=e.fontSize),(0,a.isNullOrUndefined)(e.fontColor))t.colorPicker.value="#000000";else{var i=e.fontColor;"empty"!==i&&"#00000000"!==i||(i="#000000"),t.colorPicker.value=i}"None"===e.underline?t.underlineDrop.index=0:"Single"===e.underline&&(t.underlineDrop.index=1),"SingleStrike"===e.strikethrough?t.strikethroughBox.checked=!0:"DoubleStrike"===e.strikethrough?t.doublestrikethrough.checked=!0:(t.strikethroughBox.checked=!1,t.doublestrikethrough.checked=!1),"Superscript"===e.baselineAlignment?t.superscript.checked=!0:"Subscript"===e.baselineAlignment?t.subscript.checked=!0:(t.superscript.checked=!1,t.subscript.checked=!1),"none"!==t.documentHelper.selection.caret.style.display&&(t.documentHelper.selection.caret.style.display="none"),e.allCaps?t.allcaps.checked=!0:(t.allcaps.checked=!1,t.allCaps=!1)},this.closeFontDialog=function(){t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.onInsertFontFormat=function(){var e;if(e=t.characterFormat?t.characterFormat:new ka(void 0),(0,a.isNullOrUndefined)(t.bold)||(e.bold=t.bold),(0,a.isNullOrUndefined)(t.italic)||(e.italic=t.italic),!(0,a.isNullOrUndefined)(t.fontSize)&&t.fontSize>0&&(e.fontSize=t.fontSize),(0,a.isNullOrUndefined)(t.fontColor)||(e.fontColor=t.fontColor),(0,a.isNullOrUndefined)(t.baselineAlignment)||(e.baselineAlignment=t.baselineAlignment),(0,a.isNullOrUndefined)(t.strikethrough)||(e.strikethrough=t.strikethrough),(0,a.isNullOrUndefined)(t.underline)||(e.underline=t.underline),!(0,a.isNullOrUndefined)(t.fontFamily)){var i=a.SanitizeHtmlHelper.sanitize(t.fontFamily);e.fontFamily=i,e.fontFamilyAscii=i,e.fontFamilyFarEast=i,e.fontFamilyNonFarEast=i,e.fontFamilyBidi=i}(0,a.isNullOrUndefined)(t.allCaps)||(e.allCaps=t.allCaps),t.characterFormat?t.isListDialog?t.documentHelper.owner.listDialogModule.updateCharacterFormat(e):t.documentHelper.owner.styleDialogModule.updateCharacterFormat():t.onCharacterFormat(t.documentHelper.selection,e),t.documentHelper.hideDialog()},this.fontSizeUpdate=function(e){t.fontSize=e.value},this.fontStyleUpdate=function(e){t.fontStyle=e.value},this.fontFamilyUpdate=function(e){t.fontFamily=e.value},this.underlineUpdate=function(e){t.underline=e.value},this.fontColorUpdate=function(e){(0,a.isNullOrUndefined)(e.currentValue)||(t.fontColor=e.currentValue.hex)},this.singleStrikeUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.strikethrough="SingleStrike":t.strikethrough="None"},this.doubleStrikeUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.strikethrough="DoubleStrike":t.strikethrough="None"},this.superscriptUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.baselineAlignment="Superscript":t.baselineAlignment="Normal"},this.subscriptUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.baselineAlignment="Subscript":t.baselineAlignment="Normal"},this.allcapsUpdate=function(e){t.enableCheckBoxProperty(e),e.checked?t.allCaps=!0:t.allCaps=!1},this.documentHelper=e}return Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this.fontStyleInternal},set:function(e){switch(this.fontStyleInternal=e,this.fontStyle){case"Bold":this.bold=!0,this.italic=!1;break;case"Italic":this.bold=!1,this.italic=!0;break;case"BoldItalic":this.bold=!0,this.italic=!0;break;case"Regular":this.bold=!1,this.italic=!1}},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"FontDialog"},e.prototype.createInputElement=function(e,t,i){return(0,a.createElement)("input",{attrs:{type:e},id:t,className:i})},e.prototype.initFontDialog=function(e,t){this.documentHelper.owner.containerId;this.target=(0,a.createElement)("div",{className:"e-de-font-dlg"});var i=this.getFontDiv(e,t);this.target.appendChild(i);var n=this.getFontSizeDiv(e,t);this.target.appendChild(n),this.colorDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.fontColorDiv=(0,a.createElement)("div",{className:"e-de-font-dlg-display"}),this.fontColorLabel=(0,a.createElement)("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Font color")}),t&&this.fontColorLabel.classList.add("e-de-rtl"),this.fontColorDiv.appendChild(this.fontColorLabel),this.fontColorElement=this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color"),this.fontColorDiv.appendChild(this.fontColorElement),this.colorDiv.appendChild(this.fontColorDiv),this.target.appendChild(this.colorDiv),this.fontEffectsDiv=(0,a.createElement)("div"),this.fontEffectSubDiv1=(0,a.createElement)("div"),this.effectLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Effects")}),this.fontEffectSubDiv1.appendChild(this.effectLabel),this.fontEffectsDiv.appendChild(this.fontEffectSubDiv1),this.target.appendChild(this.fontEffectsDiv),this.effectsProperties=(0,a.createElement)("div",{className:"e-de-container-row"}),this.fontEffectSubDiv2=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.strikeThroughElement=this.createInputElement("checkbox",this.target.id+"_strikeThrough",""),this.fontEffectSubDiv2.appendChild(this.strikeThroughElement),this.checkBoxDiv=(0,a.createElement)("div",{className:"e-de-font-checkbox"}),this.subScriptElement=this.createInputElement("checkbox",this.target.id+"_subScript",""),this.checkBoxDiv.appendChild(this.subScriptElement),this.fontEffectSubDiv2.appendChild(this.checkBoxDiv),this.checkBoxDiv=(0,a.createElement)("div",{className:"e-de-font-checkbox"}),this.allCapsElement=this.createInputElement("checkbox",this.target.id+"_allCaps",""),this.checkBoxDiv.appendChild(this.allCapsElement),this.fontEffectSubDiv2.appendChild(this.checkBoxDiv),this.effectsProperties.appendChild(this.fontEffectSubDiv2),this.fontEffectSubDiv3=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.superScriptElement=this.createInputElement("checkbox",this.target.id+"_superScript",""),this.fontEffectSubDiv3.appendChild(this.superScriptElement),this.checkBoxDiv=(0,a.createElement)("div",{className:"e-de-font-checkbox"}),this.doubleStrikeThroughElement=this.createInputElement("checkbox",this.target.id+"_doubleStrikeThrough",""),this.checkBoxDiv.appendChild(this.doubleStrikeThroughElement),this.fontEffectSubDiv3.appendChild(this.checkBoxDiv),this.effectsProperties.appendChild(this.fontEffectSubDiv3),this.target.appendChild(this.effectsProperties);var r=this.documentHelper.owner.documentEditorSettings.colorPickerSettings,o=r.columns,s=r.createPopupOnClick,l=r.cssClass,d=r.disabled,h=r.enablePersistence,c=r.inline,p=r.mode,u=r.modeSwitcher,g=r.noColor,m=r.presetColors,f=r.showButtons;this.colorPicker=new rl.ColorPicker({change:this.fontColorUpdate,value:"#000000",enableRtl:t,locale:this.documentHelper.owner.locale,enableOpacity:!1,mode:p,modeSwitcher:u,showButtons:f,columns:o,createPopupOnClick:s,cssClass:l,disabled:d,enablePersistence:h,inline:c,noColor:g,presetColors:m}),this.colorPicker.appendTo(this.fontColorElement),this.strikethroughBox=new tl.CheckBox({change:this.singleStrikeUpdate,cssClass:"e-de-font-content-label",label:e.getConstant("Strikethrough"),enableRtl:t}),this.documentHelper.colorPicker=this.colorPicker,this.strikethroughBox.appendTo(this.strikeThroughElement),this.doublestrikethrough=new tl.CheckBox({change:this.doubleStrikeUpdate,label:e.getConstant("Double strikethrough"),enableRtl:t}),this.doublestrikethrough.appendTo(this.doubleStrikeThroughElement),this.subscript=new tl.CheckBox({label:e.getConstant("Subscript"),cssClass:"e-de-font-content-label-width",change:this.subscriptUpdate,enableRtl:t}),this.subscript.appendTo(this.subScriptElement),this.superscript=new tl.CheckBox({label:e.getConstant("Superscript"),cssClass:"e-de-font-content-label",change:this.superscriptUpdate,enableRtl:t}),this.superscript.appendTo(this.superScriptElement),this.allcaps=new tl.CheckBox({label:e.getConstant("All caps"),cssClass:"e-de-font-content-label-caps",change:this.allcapsUpdate,enableRtl:t}),this.allcaps.appendTo(this.allCapsElement),t&&(this.fontEffectSubDiv2.classList.add("e-de-rtl"),this.fontEffectSubDiv3.classList.add("e-de-rtl"),this.fontEffectSubDiv1.classList.remove("e-de-font-content-checkbox-label"))},e.prototype.getFontSizeDiv=function(e,t){this.documentHelper.owner.containerId;this.getSizeDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.sizeSubDiv1=(0,a.createElement)("div",{className:"e-de-subcontainer-left"});var i=e.getConstant("Size");this.getFontSize=(0,a.createElement)("select",{id:this.target.id+"_fontSize"}),this.getFontSize.innerHTML="<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option><option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>",this.sizeSubDiv1.appendChild(this.getFontSize),this.getSizeDiv.appendChild(this.sizeSubDiv1),this.sizeSubDiv2=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),t&&this.sizeSubDiv2.classList.add("e-de-rtl");var n=e.getConstant("Underline style");return this.underlineElement=(0,a.createElement)("select",{id:this.target.id+"_underLine"}),this.underlineElement.innerHTML='<option value="None">'+e.getConstant("None")+'</option><option value="Single">________</option>',this.sizeSubDiv2.appendChild(this.underlineElement),this.getSizeDiv.appendChild(this.sizeSubDiv2),this.fontSizeText=new al.ComboBox({change:this.fontSizeUpdate,allowCustom:!0,showClearButton:!1,enableRtl:t,floatLabelType:"Always",placeholder:i,htmlAttributes:{"aria-labelledby":i}}),this.fontSizeText.appendTo(this.getFontSize),this.underlineDrop=new al.DropDownList({change:this.underlineUpdate,enableRtl:t,floatLabelType:"Always",placeholder:n,htmlAttributes:{"aria-labelledby":n}}),this.underlineDrop.appendTo(this.underlineElement),this.getSizeDiv},e.prototype.getFontDiv=function(e,t){this.documentHelper.owner.containerId;this.fontDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.fontSubDiv1=(0,a.createElement)("div",{className:"e-de-subcontainer-left"});var i=e.getConstant("Font");this.fontNameValues=(0,a.createElement)("select",{id:this.target.id+"_fontName"});for(var n=this.documentHelper.owner.documentEditorSettings.fontFamilies,r=0;r<n.length;r++)this.fontNameValues.innerHTML+="<option>"+n[r]+"</option>";this.fontSubDiv1.appendChild(this.fontNameValues),this.fontDiv.appendChild(this.fontSubDiv1),this.fontSubDiv2=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),t&&this.fontSubDiv2.classList.add("e-de-rtl");var o=e.getConstant("Font style");return this.fontStyleValues=(0,a.createElement)("select",{id:this.target.id+"_fontStyle"}),this.fontStyleValues.innerHTML='<option value="Regular">'+e.getConstant("Regular")+'</option><option value="Bold">'+e.getConstant("Bold")+'</option><option value="Italic">'+e.getConstant("Italic")+'</option><option value="BoldItalic">'+e.getConstant("Bold")+e.getConstant("Italic")+"</option>",this.fontSubDiv2.appendChild(this.fontStyleValues),this.fontDiv.appendChild(this.fontSubDiv2),this.fontNameList=new al.ComboBox({change:this.fontFamilyUpdate,enableRtl:t,floatLabelType:"Always",placeholder:i}),this.fontNameList.showClearButton=!1,this.fontNameList.appendTo(this.fontNameValues),this.fontStyleText=new al.DropDownList({change:this.fontStyleUpdate,enableRtl:t,floatLabelType:"Always",placeholder:o}),this.fontStyleText.appendTo(this.fontStyleValues),this.fontDiv},e.prototype.showFontDialog=function(e,t){e&&(this.characterFormat=e),this.isListDialog=t;var i=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);i.setLocale(this.documentHelper.owner.locale),this.target||this.initFontDialog(i,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=i.getConstant("Font"),this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.close=this.closeFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFontFormat,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-font-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-font-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.onCharacterFormat=function(e,t){if((0,a.isNullOrUndefined)(e)||!e.checkContentControlLocked(!0)){if(this.documentHelper.owner.editorModule.initHistory("CharacterFormat"),e.isEmpty)return e.start.offset===e.getParagraphLength(e.start.paragraph)&&(this.documentHelper.owner.editorModule.applyCharFormatValueInternal(e,e.start.paragraph.characterFormat,void 0,t),this.documentHelper.owner.editorModule.reLayout(e)),void this.documentHelper.updateFocus();this.documentHelper.owner.editorModule.setOffsetValue(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionCharacterFormatting("CharacterFormat",t,!1)}},e.prototype.enableCheckBoxProperty=function(e){this.strikethroughBox.checked&&this.doublestrikethrough.checked&&(this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,e.event.currentTarget.innerText===this.target.id+"Double strikethrough"?this.doublestrikethrough.checked=!0:this.strikethroughBox.checked=!0),this.superscript.checked&&this.subscript.checked&&(this.subscript.checked=!1,this.superscript.checked=!1,e.event.currentTarget.innerText===this.target.id+"Subscript"?this.subscript.checked=!0:this.superscript.checked=!0)},e.prototype.unWireEventsAndBindings=function(){this.fontNameList.value="",this.fontSizeText.value="",this.fontStyleText.value="",this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,this.superscript.checked=!1,this.subscript.checked=!1,this.allcaps.checked=!1,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontColor=void 0,this.fontSize=void 0,this.fontFamily=void 0},e.prototype.destroy=function(){if(this.documentHelper=void 0,this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.removeElements(),this.fontNameList&&this.fontNameList.destroy(),this.fontNameList=void 0,this.fontStyleText&&this.fontStyleText.destroy(),this.fontStyleText=void 0,this.fontSizeText&&this.fontSizeText.destroy(),this.fontSizeText=void 0,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.underlineDrop&&this.underlineDrop.destroy(),this.underlineDrop=void 0,this.strikethroughBox&&this.strikethroughBox.destroy(),this.strikethroughBox=void 0,this.doublestrikethrough&&this.doublestrikethrough.destroy(),this.doublestrikethrough=void 0,this.superscript&&this.superscript.destroy(),this.superscript=void 0,this.subscript&&this.subscript.destroy(),this.subscript=void 0,this.allcaps&&this.allcaps.destroy(),this.allcaps=void 0},e.prototype.removeElements=function(){this.effectLabel&&(this.effectLabel.remove(),this.effectLabel=void 0),this.strikeThroughElement&&(this.strikeThroughElement.remove(),this.strikeThroughElement=void 0),this.superScriptElement&&(this.superScriptElement.remove(),this.superScriptElement=void 0),this.subScriptElement&&(this.subScriptElement.remove(),this.subScriptElement=void 0),this.doubleStrikeThroughElement&&(this.doubleStrikeThroughElement.remove(),this.doubleStrikeThroughElement=void 0),this.allCapsElement&&(this.allCapsElement.remove(),this.allCapsElement=void 0),this.fontEffectSubDiv1&&(this.fontEffectSubDiv1.remove(),this.fontEffectSubDiv1=void 0),this.fontDiv&&(this.fontDiv.remove(),this.fontDiv=void 0),this.colorDiv&&(this.colorDiv.remove(),this.colorDiv=void 0),this.fontColorLabel&&(this.fontColorLabel.remove(),this.fontColorLabel=void 0),this.fontColorElement&&(this.fontColorElement.remove(),this.fontColorElement=void 0),this.fontEffectsDiv&&(this.fontEffectsDiv.remove(),this.fontEffectsDiv=void 0),this.effectsProperties&&(this.effectsProperties.remove(),this.effectsProperties=void 0),this.fontEffectSubDiv2&&(this.fontEffectSubDiv2.remove(),this.fontEffectSubDiv2=void 0),this.checkBoxDiv&&(this.checkBoxDiv.remove(),this.checkBoxDiv=void 0),this.fontEffectSubDiv3&&(this.fontEffectSubDiv3.remove(),this.fontEffectSubDiv3=void 0),this.getSizeDiv&&(this.getSizeDiv.remove(),this.getSizeDiv=void 0),this.sizeSubDiv1&&(this.sizeSubDiv1.remove(),this.sizeSubDiv1=void 0),this.sizeSubDiv2&&(this.sizeSubDiv2.remove(),this.sizeSubDiv2=void 0),this.getFontSize&&(this.getFontSize.remove(),this.getFontSize=void 0),this.underlineElement&&(this.underlineElement.remove(),this.underlineElement=void 0),this.fontNameValues&&(this.fontNameValues.remove(),this.fontNameValues=void 0),this.fontSubDiv2&&(this.fontSubDiv2.remove(),this.fontSubDiv2=void 0),this.fontStyleValues&&(this.fontStyleValues.remove(),this.fontStyleValues=void 0),this.fontSubDiv1&&(this.fontSubDiv1.remove(),this.fontSubDiv1=void 0)},e}(),Zh=function(){function e(e){var t=this;this.hasTableWidth=!1,this.hasCellWidth=!1,this.bidi=!1,this.isTableBordersAndShadingUpdated=!1,this.isCellBordersAndShadingUpdated=!1,this.tabObj=void 0,this.localValue=void 0,this.isCellOptionsUpdated=!1,this.isTableOptionsUpdated=!1,this.onBeforeOpen=function(){t.documentHelper.updateFocus(),t.loadTableProperties()},this.onCloseTablePropertyDialog=function(){t.unWireEvent.bind(t),t.documentHelper.updateFocus()},this.applyTableProperties=function(){var e=t.documentHelper.selection;if(e.tableFormat.title!==t.titleTextBox.value&&((0,a.isNullOrUndefined)(t.titleTextBox.value)||(t.tableFormat.title=a.SanitizeHtmlHelper.sanitize(t.titleTextBox.value))),e.tableFormat.description!==t.descriptionTextBox.value&&((0,a.isNullOrUndefined)(t.descriptionTextBox.value)||(t.tableFormat.description=a.SanitizeHtmlHelper.sanitize(t.descriptionTextBox.value))),t.preferCheckBox.checked||t.preferCheckBox.indeterminate||((0,a.isNullOrUndefined)(e.tableFormat.preferredWidth)||0!==e.tableFormat.preferredWidth)&&(t.tableFormat.preferredWidth=0,t.tableFormat.preferredWidthType="Point"),t.tableFormat.hasValue("tableAlignment")&&"Left"!==t.tableFormat.tableAlignment&&((0,a.isNullOrUndefined)(e.tableFormat.leftIndent)||0!==e.tableFormat.leftIndent)&&(t.tableFormat.leftIndent=0),t.rowHeightCheckBox.checked||t.rowHeightCheckBox.indeterminate||((0,a.isNullOrUndefined)(e.rowFormat.height)||0!==e.rowFormat.height)&&(t.rowFormat.heightType="AtLeast",t.rowFormat.height=0),t.preferredCellWidthCheckBox.checked||t.preferredCellWidthCheckBox.indeterminate){for(var i=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable,n=i.getOwnerWidth(!0),r=i.getTableClientWidth(n),o=0;o<i.childWidgets.length;o++)for(var s=i.childWidgets[parseInt(o.toString(),10)],l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[parseInt(l.toString(),10)];"Percent"===t.cellFormat.preferredWidthType&&"Point"===d.cellFormat.preferredWidthType?(d.cellFormat.preferredWidthType="Percent",d.cellFormat.preferredWidth=d.cellFormat.preferredWidth/r*100):"Point"===t.cellFormat.preferredWidthType&&"Percent"===d.cellFormat.preferredWidthType&&(d.cellFormat.preferredWidthType="Point",d.cellFormat.preferredWidth=d.cellFormat.cellWidth)}if("Percent"===t.cellFormat.preferredWidthType&&!t.tableFormat.hasValue("preferredWidth")&&!t.tableFormat.hasValue("preferredWidthType")&&0===t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth){var h=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(!0),c=t.documentHelper.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(h);t.tableFormat.preferredWidthType="Percent",t.tableFormat.preferredWidth=c/Pa.convertPixelToPoint(t.documentHelper.owner.viewer.clientArea.width)*100}}else((0,a.isNullOrUndefined)(e.cellFormat.preferredWidth)||0!==e.cellFormat.preferredWidth)&&(t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=0);t.rowHeightValue&&(t.rowFormat.hasValue("heightType")||e.rowFormat.heightType===t.rowFormat.heightType||(t.rowFormat.heightType=e.rowFormat.heightType),t.rowFormat.height=t.rowHeightValue),t.isEqualTableFormat(e.tableFormat,t.tableFormat)&&t.isEqualRowFormat(e.rowFormat,t.rowFormat)&&t.isEqualCellFormat(e.cellFormat,t.cellFormat)||(t.documentHelper.owner.editorModule.initComplexHistory("TableProperties"),t.documentHelper.owner.editorModule.onTableFormat(t.tableFormat),t.documentHelper.owner.editorModule.onRowFormat(t.rowFormat),t.documentHelper.owner.editorModule.onCellFormat(t.cellFormat),t.documentHelper.owner.editorHistoryModule.updateComplexHistory()),t.closeTablePropertiesDialog(),t.documentHelper.updateFocus()},this.applyTableSubProperties=function(){if(t.isCellOptionsUpdated){var e=t.documentHelper.owner.cellOptionsDialogModule.cellFormat;t.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(e)}if(t.isTableOptionsUpdated){var i=t.documentHelper.owner.tableOptionsDialogModule.tableFormat;t.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(i)}t.isCellOptionsUpdated=!1,t.isTableOptionsUpdated=!1},this.unWireEvent=function(){t.preferCheckBox.change=void 0,t.tableWidthBox.change=void 0,t.tableWidthType.change=void 0,t.leftIndentBox.change=void 0,t.rowHeightCheckBox.change=void 0,t.rowHeightBox.change=void 0,t.rowHeightType.change=void 0,t.repeatHeader.change=void 0,t.allowRowBreak.change=void 0,t.preferredCellWidthCheckBox.change=void 0,t.cellWidthBox.change=void 0,t.cellWidthType.change=void 0,t.cellFormat.destroy(),t.rowFormat.destroy(),t.tableFormat.destroy(),t.rowHeightValue=void 0,t.documentHelper.dialog2.open=t.documentHelper.selection.hideCaret.bind(t.documentHelper.owner.viewer)},this.closeTablePropertiesDialog=function(){t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.changeBidirectional=function(e){"ltr"===e.value?(t.rtlButton.checked=!t.ltrButton.checked,t.tableFormat.bidi=!1):(t.ltrButton.checked=!t.rtlButton.checked,t.tableFormat.bidi=!0),t.tableFormat.bidi&&"Left"===t.tableFormat.tableAlignment?t.tableFormat.tableAlignment="Right":t.tableFormat.bidi||"Right"!==t.tableFormat.tableAlignment||(t.tableFormat.tableAlignment="Left"),t.activeTableAlignment(t.tableFormat,!0)},this.changeTableCheckBox=function(){var e=t.preferCheckBox.checked||t.preferCheckBox.indeterminate;t.tableWidthBox.enabled=e,t.tableWidthType.enabled=e,t.tableFormat.preferredWidthType=e?"Points"===t.tableWidthType.value?"Point":t.tableWidthType.value:t.documentHelper.selection.tableFormat.preferredWidthType},this.changeTableAlignment=function(e){t.updateClassForAlignmentProperties(t.tableTab);var i=e.target;(0,a.classList)(i,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]);var n=t.tableFormat.bidi||t.rtlButton.checked;i.classList.contains("e-de-table-left-alignment")&&!n||i.classList.contains("e-de-table-right-alignment")&&n?t.leftIndentBox.enabled=!0:t.leftIndentBox.enabled=!1,t.tableFormat.tableAlignment=t.getTableAlignment()},this.changeTableRowCheckBox=function(){t.rowHeightType.enabled=t.rowHeightCheckBox.checked,t.rowHeightBox.enabled=t.rowHeightCheckBox.checked,t.rowHeightType.enabled?t.rowFormat.heightType=t.rowHeightType.value:t.rowFormat.heightType=t.documentHelper.selection.rowFormat.heightType},this.changeTableCellCheckBox=function(){t.cellWidthType.enabled=t.preferredCellWidthCheckBox.checked,t.cellWidthBox.enabled=t.preferredCellWidthCheckBox.checked},this.changeCellAlignment=function(e){t.updateClassForCellAlignment(t.cellTab);var i=e.target;(0,a.classList)(i,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]),t.cellFormat.verticalAlignment=t.getCellAlignment()},this.showTableOptionsDialog=function(){t.documentHelper.owner.tableOptionsDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.showBordersShadingsPropertiesDialog=function(){t.documentHelper.owner.bordersAndShadingDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.showCellOptionsDialog=function(){t.documentHelper.owner.cellOptionsDialogModule.show(),t.documentHelper.dialog2.element.style.pointerEvents="none"},this.documentHelper=e}return Object.defineProperty(e.prototype,"cellFormat",{get:function(){return(0,a.isNullOrUndefined)(this.cellFormatIn)?this.cellFormatIn=new Ma:this.cellFormatIn},set:function(e){this.cellFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableFormat",{get:function(){return(0,a.isNullOrUndefined)(this.tableFormatIn)?(this.tableFormatIn=new Ra,this.tableFormatIn):this.tableFormatIn},set:function(e){this.tableFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paraFormat",{get:function(){return(0,a.isNullOrUndefined)(this.tableFormatIn)?(this.paraFormatIn=new ba,this.paraFormatIn):this.paraFormatIn},set:function(e){this.paraFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowFormat",{get:function(){return(0,a.isNullOrUndefined)(this.rowFormatInternal)?(this.rowFormatInternal=new Ca,this.rowFormatInternal):this.rowFormatInternal},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TablePropertiesDialog"},e.prototype.initTablePropertyDialog=function(e,t){this.localValue=e;var i=this.documentHelper.owner.containerId+"_TablePropertiesDialog";this.target=(0,a.createElement)("div",{id:i,className:"e-de-table-properties-dlg"});var n=(0,a.createElement)("div",{id:this.target.id+"_TabContainer"});this.target.appendChild(n),this.tableTab=(0,a.createElement)("div",{id:this.target.id+"_TablePropertiesContentDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.rowTab=(0,a.createElement)("div",{id:this.target.id+"_RowPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.cellTab=(0,a.createElement)("div",{id:this.target.id+"_CellPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.altTab=(0,a.createElement)("div",{id:this.target.id+"_AltPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"});var r=(0,a.createElement)("div",{className:"e-de-table-dialog-separator-line"}),o=(0,a.createElement)("div",{id:this.target.id+"_TablePropertiesDialogTab",className:"e-de-table-ppty-tab"}),s=(0,a.createElement)("div",{className:"e-tab-header"}),l=(0,a.createElement)("div",{id:this.target.id+"_tableHeader",innerHTML:e.getConstant("Table")}),d=(0,a.createElement)("div",{id:this.target.id+"_rowHeader",innerHTML:e.getConstant("Row")}),h=(0,a.createElement)("div",{id:this.target.id+"_cellHeader",innerHTML:e.getConstant("Cell")}),c=(0,a.createElement)("div",{id:this.target.id+"_altHeader",innerHTML:e.getConstant("Alt Text")});s.appendChild(l),s.appendChild(d),s.appendChild(h),s.appendChild(c);var p=(0,a.createElement)("div",{id:this.target.id+"_tableContent"}),u=(0,a.createElement)("div",{id:this.target.id+"_rowContent"}),g=(0,a.createElement)("div",{id:this.target.id+"_cellContent"}),m=(0,a.createElement)("div",{id:this.target.id+"_altContent"}),f=[{header:{text:l},content:p},{header:{text:d},content:u},{header:{text:h},content:g},{header:{text:c},content:m}];p.appendChild(this.tableTab),u.appendChild(this.rowTab),g.appendChild(this.cellTab),m.appendChild(this.altTab),n.appendChild(o),this.initTableProperties(this.tableTab,e,this.documentHelper.owner.enableRtl),this.initTableRowProperties(this.rowTab,e,this.documentHelper.owner.enableRtl),this.initTableCellProperties(this.cellTab,e,this.documentHelper.owner.enableRtl),this.initTableAltProperties(this.altTab,e,this.documentHelper.owner.enableRtl),this.tabObj=new ua.Tab({items:f,enableRtl:t},o),this.tabObj.isStringTemplate=!0,this.target.appendChild(r);for(var v=this.tableTab.getElementsByClassName(this.tableTab.id+"e-de-table-alignment"),y=0;y<v.length;y++)v[parseInt(y.toString(),10)].addEventListener("click",this.changeTableAlignment);var w=this.cellTab.getElementsByClassName(this.cellTab.id+"e-de-table-cell-alignment");for(y=0;y<w.length;y++)w[parseInt(y.toString(),10)].addEventListener("click",this.changeCellAlignment)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTablePropertyDialog(e,this.documentHelper.owner.enableRtl),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog2.header=e.getConstant("Table Properties"),this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.animationSettings={effect:"None",duration:400,delay:0},this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.height="auto",this.documentHelper.dialog2.content=this.target,this.documentHelper.dialog2.beforeOpen=this.onBeforeOpen,this.documentHelper.dialog2.close=this.onCloseTablePropertyDialog,this.documentHelper.dialog2.open=this.wireEvent.bind(this),this.documentHelper.dialog2.buttons=[{click:this.applyTableProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ppty-okay",isPrimary:!0}},{click:this.closeTablePropertiesDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-ppty-cancel"}}],this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.show();var t=this.documentHelper.dialog2.element;t&&this.documentHelper.updateDialogTabHeight(t,this.target)},e.prototype.isEqualTableFormat=function(e,t){return(!t.hasValue("preferredWidth")||e.preferredWidth===t.preferredWidth)&&((!t.hasValue("preferredWidthType")||e.preferredWidthType===t.preferredWidthType)&&((!t.hasValue("tableAlignment")||e.tableAlignment===t.tableAlignment)&&((!t.hasValue("leftIndent")||e.leftIndent===t.leftIndent)&&((!t.hasValue("bidi")||e.bidi===t.bidi)&&(((0,a.isNullOrUndefined)(e.title)?""===t.title:e.title===t.title)&&((0,a.isNullOrUndefined)(e.description)?""===t.description:e.description===t.description))))))},e.prototype.isEqualRowFormat=function(e,t){return(!t.hasValue("height")||e.height===t.height)&&((!t.hasValue("heightType")||e.heightType===t.heightType)&&((!t.hasValue("allowBreakAcrossPages")||e.allowBreakAcrossPages===t.allowBreakAcrossPages)&&(!t.hasValue("isHeader")||e.isHeader===t.isHeader)))},e.prototype.isEqualCellFormat=function(e,t){return(!t.hasValue("preferredWidth")||e.preferredWidth===t.preferredWidth)&&((!t.hasValue("preferredWidthType")||e.preferredWidthType===t.preferredWidthType)&&(!t.hasValue("verticalAlignment")||e.verticalAlignment===t.verticalAlignment))},e.prototype.calculateGridValue=function(e){e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);var t=this.documentHelper.owner.editorHistoryModule;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()},e.prototype.loadTableProperties=function(){this.setTableProperties(),this.setTableRowProperties(),this.setTableCellProperties(),this.setTableAltProperties(),this.documentHelper.owner.bordersAndShadingDialogModule?this.bordersAndShadingButton.disabled=!1:this.bordersAndShadingButton.disabled=!0,this.tableOptionButton.disabled=!1,this.cellOptionButton.disabled=!1},e.prototype.wireEvent=function(){this.documentHelper.selection.hideCaret(),this.preferCheckBox.change=this.changeTableCheckBox.bind(this),this.tableWidthBox.change=this.onTableWidthChange.bind(this),this.tableWidthType.change=this.onTableWidthTypeChange.bind(this),this.leftIndentBox.change=this.onLeftIndentChange.bind(this),this.rowHeightCheckBox.change=this.changeTableRowCheckBox.bind(this),this.rowHeightBox.change=this.onRowHeightChange.bind(this),this.rowHeightType.change=this.onRowHeightTypeChange.bind(this),this.allowRowBreak.change=this.onAllowBreakAcrossPage.bind(this),this.repeatHeader.change=this.onRepeatHeader.bind(this),this.preferredCellWidthCheckBox.change=this.changeTableCellCheckBox.bind(this),this.cellWidthBox.change=this.onCellWidthChange.bind(this),this.cellWidthType.change=this.onCellWidthTypeChange.bind(this)},e.prototype.initTableProperties=function(e,t,i){var n=(0,a.createElement)("div",{className:"e-de-table-dialog-size-label"}),r=(0,a.createElement)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=(0,a.createElement)("div",{className:"e-de-table-ppty-options-break"}),s=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),l=(0,a.createElement)("div",{className:"e-de-container-row"}),d=(0,a.createElement)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.preferredWidth=(0,a.createElement)("input");var h=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),c=(0,a.createElement)("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"}),p=(0,a.createElement)("div",{className:"e-de-dlg-row"}),u=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),g=(0,a.createElement)("div",{innerHTML:t.getConstant("Alignment"),className:"e-de-table-dlg-alignment-heading"}),m=(0,a.createElement)("div",{className:"e-de-container-row"}),f=e.id+"e-de-table-alignment e-de-table-dialog-alignment-icon",v=(0,a.createElement)("div"),y=(0,a.createElement)("div",{className:"e-de-table-dia-align-div"});this.left=(0,a.createElement)("div",{className:"e-icons e-de-table-properties-alignment e-de-table-left-alignment "+f,id:e.id+"_left_alignment"}),y.appendChild(this.left),y.setAttribute("aria-label",t.getConstant("Left"));var w=(0,a.createElement)("div",{className:"e-de-table-dia-align-div"});this.center=(0,a.createElement)("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-center-alignment "+f,id:e.id+"_center_alignment"}),w.appendChild(this.center),w.setAttribute("aria-label",t.getConstant("Center")),this.right=(0,a.createElement)("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-right-alignment "+f,id:e.id+"_right_alignment"});var b=(0,a.createElement)("div",{className:"e-de-table-dia-align-div"});b.appendChild(this.right),b.setAttribute("aria-label",t.getConstant("Right"));var C=(0,a.createElement)("label",{innerHTML:t.getConstant("Left"),className:"e-de-table-dia-align-label"}),x=(0,a.createElement)("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),I=(0,a.createElement)("label",{innerHTML:t.getConstant("Right"),className:"e-de-table-dia-align-label"}),k=(0,a.createElement)("div",{className:"e-de-subcontainer-right"});this.leftIndent=(0,a.createElement)("input");var F=(0,a.createElement)("div",{innerHTML:t.getConstant("Table direction"),className:"e-de-para-dlg-heading"}),P=(0,a.createElement)("div",{className:"e-de-dlg-row"}),S=(0,a.createElement)("div",{className:"e-de-tbl-rtl-btn-div"}),T=(0,a.createElement)("input");S.appendChild(T),P.appendChild(S);var H=(0,a.createElement)("div",{className:"e-de-tbl-ltr-btn-div"}),E=(0,a.createElement)("input");H.appendChild(E),P.appendChild(H),this.rtlButton=new tl.RadioButton({label:t.getConstant("Right-to-left"),value:"rtl",cssClass:"e-small",change:this.changeBidirectional,enableRtl:i}),this.rtlButton.appendTo(T),T.setAttribute("aria-label",t.getConstant("Right-to-left")),this.ltrButton=new tl.RadioButton({label:t.getConstant("Left-to-right"),value:"ltr",cssClass:"e-small",change:this.changeBidirectional,enableRtl:i}),this.ltrButton.appendTo(E),E.setAttribute("aria-label",t.getConstant("Left-to-right"));var N=(0,a.createElement)("div",{className:"e-de-tbl-dlg-border-btn"});this.bordersAndShadingButton=(0,a.createElement)("button",{innerHTML:t.getConstant("Borders and Shading")+"...",className:"e-control e-btn e-de-ok-button",attrs:{type:"button"}}),this.tableOptionButton=(0,a.createElement)("button",{className:"e-control e-btn",innerHTML:t.getConstant("Options")+"...",attrs:{type:"button"}}),this.tableOptionButton.addEventListener("click",this.showTableOptionsDialog),this.bordersAndShadingButton.addEventListener("click",this.showBordersShadingsPropertiesDialog),N.appendChild(this.bordersAndShadingButton),N.appendChild(this.tableOptionButton),k.appendChild(this.leftIndent),m.appendChild(v),u.appendChild(g),v.appendChild(y),u.appendChild(m),m.appendChild(w),m.appendChild(b),y.appendChild(C),w.appendChild(x),b.appendChild(I),p.appendChild(u),n.appendChild(r),e.appendChild(n),o.appendChild(s),n.appendChild(o),d.appendChild(this.preferredWidth),n.appendChild(l),h.appendChild(c),p.appendChild(k),l.appendChild(d),l.appendChild(h),e.appendChild(p),e.appendChild(F),e.appendChild(P),e.appendChild(N),this.tableWidthBox=new rl.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.tableWidthBox.appendTo(this.preferredWidth),this.leftIndentBox=new rl.NumericTextBox({value:0,decimals:2,min:-1584,max:1584,enablePersistence:!1,floatLabelType:"Always",placeholder:t.getConstant("Indent from left")}),this.leftIndentBox.appendTo(this.leftIndent),this.preferCheckBox=new tl.CheckBox({label:t.getConstant("Preferred Width"),enableRtl:i}),this.preferCheckBox.appendTo(s),s.setAttribute("aria-label",t.getConstant("Preferred Width")),this.leftIndent.setAttribute("aria-labelledby",t.getConstant("Indent from left")),this.tableWidthType=new al.DropDownList({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Measure in"),htmlAttributes:{"aria-labelledby":t.getConstant("Measure in")}}),this.tableWidthType.appendTo(c),i&&(S.classList.add("e-de-rtl"),k.classList.add("e-de-rtl"),N.classList.add("e-de-rtl"),y.classList.add("e-de-rtl"),w.classList.add("e-de-rtl"),b.classList.add("e-de-rtl"))},e.prototype.onTableWidthChange=function(){this.tableFormat.preferredWidth=this.tableWidthBox.value},e.prototype.onTableWidthTypeChange=function(){var e,t=Pa.convertPixelToPoint(this.documentHelper.owner.viewer.clientArea.width);"Percent"===this.tableWidthType.value&&"Percent"!==this.documentHelper.selection.tableFormat.preferredWidthType?(e=this.tableWidthBox.value/t*100,this.formatNumericTextBox(this.tableWidthBox,"Percent",e)):"Points"===this.tableWidthType.value&&"Point"!==this.documentHelper.selection.tableFormat.preferredWidthType?(e=t/100*this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Point",e)):(e="#'%'"===this.tableWidthBox.format?"Points"===this.tableWidthType.value?t/100*this.tableWidthBox.value:this.tableWidthBox.value:"Percent"===this.tableWidthType.value?this.tableWidthBox.value/t*100:this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Points"===this.tableWidthType.value?"Point":this.tableWidthType.value,e)),this.tableFormat.preferredWidthType="Points"===this.tableWidthType.value?"Point":this.tableWidthType.value},e.prototype.onLeftIndentChange=function(){this.tableFormat.leftIndent=this.leftIndentBox.value},e.prototype.setTableAltProperties=function(){var e=this.documentHelper.selection.tableFormat;(0,a.isNullOrUndefined)(e.title)?this.titleTextBox.value="":this.titleTextBox.value=e.title,(0,a.isNullOrUndefined)(e.description)?this.descriptionTextBox.value="":this.descriptionTextBox.value=e.description},e.prototype.setTableProperties=function(){var e=this.documentHelper.selection.tableFormat,t=e.preferredWidth>0,i=e.preferredWidth;(0,a.isNullOrUndefined)(e.preferredWidth)?(this.preferCheckBox.indeterminate=!0,i=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.documentHelper.owner.viewer).tableFormat.preferredWidth):this.preferCheckBox.checked=t;this.tableWidthBox.enabled=t,this.tableWidthType.enabled=t,this.formatNumericTextBox(this.tableWidthBox,e.preferredWidthType,i),"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.tableWidthType.index=0:this.tableWidthType.index=1,this.activeTableAlignment(e,!1),e.bidi?(this.rtlButton.checked=!0,this.ltrButton.checked=!1):(this.ltrButton.checked=!0,this.rtlButton.checked=!1)},e.prototype.activeTableAlignment=function(e,t){var i=t?this.tableFormat.tableAlignment:void 0;(0,a.isNullOrUndefined)(i)&&(e.bidi?"Left"===e.tableAlignment?i="Right":"Right"===e.tableAlignment&&(i="Left"):i=e.tableAlignment),e.bidi?(this.leftIndentBox.enabled="Right"===i,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from right")):(this.leftIndentBox.enabled="Left"===i,this.leftIndentBox.placeholder=this.localValue.getConstant("Indent from left")),this.leftIndentBox.value=e.leftIndent,(0,a.classList)(this.left,[],["e-de-table-alignment-active"]),(0,a.classList)(this.right,[],["e-de-table-alignment-active"]),(0,a.classList)(this.center,[],["e-de-table-alignment-active"]),"Left"===i?(0,a.classList)(this.left,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Center"===i?(0,a.classList)(this.center,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]):"Right"===i&&(0,a.classList)(this.right,["e-de-table-alignment-active"],["e-de-table-properties-alignment"])},e.prototype.getTableAlignment=function(){for(var e=this.tableTab.id,t=this.tableTab.getElementsByClassName(e+"e-de-table-alignment"),i=0;i<t.length;i++){if(t[parseInt(i.toString(),10)].classList.contains("e-de-table-alignment-active"))return 0===i?this.ltrButton.checked?"Left":"Right":1===i?"Center":this.ltrButton.checked?"Right":"Left"}},e.prototype.updateClassForAlignmentProperties=function(e){for(var t=e.id,i=e.getElementsByClassName(t+"e-de-table-alignment"),n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)];r.classList.contains("e-de-table-alignment-active")&&(0,a.classList)(r,["e-de-table-properties-alignment"],["e-de-table-alignment-active"])}},e.prototype.initTableRowProperties=function(e,t,i){var n=(0,a.createElement)("div",{className:"e-de-table-dialog-size-label"}),r=(0,a.createElement)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=(0,a.createElement)("div",{className:"e-de-table-ppty-options-break"}),s=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),l=(0,a.createElement)("div",{className:"e-de-container-row"}),d=(0,a.createElement)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.rowHeight=(0,a.createElement)("input",{attrs:{type:"text"}});var h=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),c=(0,a.createElement)("select",{innerHTML:'<option value="AtLeast">'+t.getConstant("At least")+'</option><option value="Exactly">'+t.getConstant("Exactly")+"</option>"});n.appendChild(r),e.appendChild(n),o.appendChild(s),n.appendChild(o),l.appendChild(d),n.appendChild(l),d.appendChild(this.rowHeight),h.appendChild(c),l.appendChild(h);var p=(0,a.createElement)("div",{innerHTML:t.getConstant("Options")+"...",className:"e-de-para-dlg-heading"}),u=(0,a.createElement)("div",{className:"e-de-table-ppty-options-break"}),g=(0,a.createElement)("div",{className:"e-de-table-ppty-options-header-row"}),m=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),f=(0,a.createElement)("input",{attrs:{type:"checkbox"}});u.appendChild(m),g.appendChild(f),e.appendChild(p),e.appendChild(u),e.appendChild(g),this.rowHeightBox=new rl.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.rowHeightBox.appendTo(this.rowHeight),this.rowHeightCheckBox=new tl.CheckBox({label:t.getConstant("Specify height"),enableRtl:i}),this.rowHeightCheckBox.appendTo(s),s.setAttribute("aria-label",t.getConstant("Specify height")),this.rowHeightType=new al.DropDownList({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Row height is"),htmlAttributes:{"aria-labelledby":t.getConstant("Row height is")}}),this.rowHeightType.appendTo(c),this.allowRowBreak=new tl.CheckBox({label:t.getConstant("Allow row to break across pages"),enableRtl:i}),this.allowRowBreak.appendTo(m),m.setAttribute("aria-label",t.getConstant("Allow row to break across pages")),this.repeatHeader=new tl.CheckBox({label:t.getConstant("Repeat as header row at the top of each page"),enableRtl:i}),this.repeatHeader.appendTo(f),f.setAttribute("aria-label",t.getConstant("Repeat as header row at the top of each page"))},e.prototype.setTableRowProperties=function(){var e=this.documentHelper.selection.rowFormat,t=e.height>0||"Exactly"===e.heightType;t?this.rowHeightCheckBox.checked=!0:void 0===e.heightType?(this.rowHeightCheckBox.indeterminate=!0,t=!0):this.rowHeightCheckBox.checked=!1,this.rowHeightBox.enabled=t,this.rowHeightType.enabled=t;var i=!this.enableRepeatHeader();(0,a.isNullOrUndefined)(this.documentHelper.selection.rowFormat.isHeader)?(this.repeatHeader.indeterminate=!0,this.repeatHeader.disabled=!0):this.documentHelper.selection.rowFormat.isHeader?(this.repeatHeader.checked=!i,this.repeatHeader.indeterminate=i,this.repeatHeader.disabled=i):(this.repeatHeader.checked=!1,this.repeatHeader.indeterminate=!1,this.repeatHeader.disabled=i),(0,a.isNullOrUndefined)(e.allowBreakAcrossPages)?this.allowRowBreak.indeterminate=!0:this.allowRowBreak.checked=e.allowBreakAcrossPages,this.rowHeightBox.value=e.height,"Auto"===e.heightType||"AtLeast"===e.heightType?this.rowHeightType.index=0:this.rowHeightType.index=1},e.prototype.onRowHeightChange=function(){this.rowHeightValue=this.rowHeightBox.value},e.prototype.onRowHeightTypeChange=function(){this.rowFormat.heightType=this.rowHeightType.text},e.prototype.onAllowBreakAcrossPage=function(){this.rowFormat.allowBreakAcrossPages=this.allowRowBreak.checked},e.prototype.onRepeatHeader=function(){this.rowFormat.isHeader=this.repeatHeader.checked},e.prototype.enableRepeatHeader=function(){var e=this.documentHelper.selection,t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var n=t.paragraph.associatedCell,r=i.paragraph.associatedCell;return 0===n.ownerRow.index&&r.ownerTable.equals(n.ownerTable)},e.prototype.initTableAltProperties=function(e,t,i){var n=(0,a.createElement)("div",{className:"e-de-table-dialog-size-label"});e.appendChild(n);var r=(0,a.createElement)("div",{innerHTML:t.getConstant("Title"),className:"e-de-para-dlg-heading"});n.appendChild(r);var o=(0,a.createElement)("div",{className:"e-de-table-ppty-options-break"}),s=(0,a.createElement)("input",{});this.titleTextBox=new rl.TextBox({floatLabelType:"Never"}),n.appendChild(o),o.appendChild(s),this.titleTextBox.appendTo(s);var l=(0,a.createElement)("div",{innerHTML:t.getConstant("Description"),className:"e-de-para-dlg-heading"});n.appendChild(l);var d=(0,a.createElement)("div",{className:"e-de-table-ppty-options-break"}),h=(0,a.createElement)("textarea",{});this.descriptionTextBox=new rl.TextBox({floatLabelType:"Never"}),d.appendChild(h),this.descriptionTextBox.appendTo(h),n.appendChild(d)},e.prototype.initTableCellProperties=function(e,t,i){var n=(0,a.createElement)("div",{className:"e-de-table-dialog-size-label"}),r=(0,a.createElement)("div",{innerHTML:t.getConstant("Size"),className:"e-de-para-dlg-heading"}),o=(0,a.createElement)("div",{className:"e-de-table-ppty-options-break"}),s=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),l=(0,a.createElement)("div",{className:"e-de-container-row"}),d=(0,a.createElement)("div",{className:"e-de-subcontainer-left e-de-table-dialog-row-height"});this.preferredCellWidth=(0,a.createElement)("input",{attrs:{type:"text"}});var h=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),c=(0,a.createElement)("select",{innerHTML:'<option value="Points">'+t.getConstant("Points")+'</option><option value="Percent">'+t.getConstant("Percent")+"</option>"});n.appendChild(r),e.appendChild(n),o.appendChild(s),s.setAttribute("aria-label",t.getConstant("Preferred Width")),n.appendChild(o),d.appendChild(this.preferredCellWidth),n.appendChild(l),l.appendChild(d),l.appendChild(h),h.appendChild(c);var p=(0,a.createElement)("div",{innerHTML:t.getConstant("Vertical alignment"),className:"e-de-para-dlg-heading"}),u=e.id+"e-de-table-cell-alignment e-de-tablecell-dialog-alignment-icon",g=(0,a.createElement)("div",{className:"e-de-container-row"}),m=(0,a.createElement)("div"),f=(0,a.createElement)("div",{className:"e-de-tablecell-dia-align-div"});this.cellTopAlign=(0,a.createElement)("div",{id:e.id+"_cell_top-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment "+u}),f.appendChild(this.cellTopAlign),f.setAttribute("aria-label",t.getConstant("Top"));var v=(0,a.createElement)("div",{className:"e-de-tablecell-dia-align-div"});this.cellCenterAlign=(0,a.createElement)("div",{id:e.id+"_cell_center-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment "+u}),v.appendChild(this.cellCenterAlign),v.setAttribute("aria-label",t.getConstant("Center"));var y=(0,a.createElement)("div",{className:"e-de-tablecell-dia-align-div"});this.cellBottomAlign=(0,a.createElement)("div",{id:e.id+"_cell_bottom-alignment",className:"e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  "+u}),y.appendChild(this.cellBottomAlign),y.setAttribute("aria-label",t.getConstant("Bottom"));var w=(0,a.createElement)("label",{innerHTML:t.getConstant("Top"),className:"e-de-table-dia-align-label"}),b=(0,a.createElement)("label",{innerHTML:t.getConstant("Center"),className:"e-de-table-dia-align-label"}),C=(0,a.createElement)("label",{innerHTML:t.getConstant("Bottom"),className:"e-de-table-dia-align-label"});this.cellOptionButton=(0,a.createElement)("button",{innerHTML:t.getConstant("Options")+"...",className:"e-control e-btn",attrs:{type:"button"}}),this.cellOptionButton.style.cssFloat=i?"left":"right",g.appendChild(m),m.appendChild(f),g.appendChild(v),g.appendChild(y),f.appendChild(w),v.appendChild(b),y.appendChild(C),e.appendChild(p),e.appendChild(g),e.appendChild(this.cellOptionButton),this.cellOptionButton.addEventListener("click",this.showCellOptionsDialog),this.cellWidthBox=new rl.NumericTextBox({value:0,decimals:2,min:0,max:1584,enablePersistence:!1}),this.cellWidthBox.appendTo(this.preferredCellWidth),this.preferredCellWidthCheckBox=new tl.CheckBox({label:t.getConstant("Preferred Width"),enableRtl:i}),this.preferredCellWidthCheckBox.appendTo(s),s.setAttribute("aria-label",t.getConstant("Preferred Width")),this.cellWidthType=new al.DropDownList({enableRtl:i,floatLabelType:"Always",placeholder:t.getConstant("Measure in"),htmlAttributes:{"aria-labelledby":t.getConstant("Measure in")}}),this.cellWidthType.appendTo(c)},e.prototype.setTableCellProperties=function(){var e=this.documentHelper.selection.cellFormat;this.hasCellWidth=e.preferredWidth>0;var t=e.preferredWidth;(0,a.isNullOrUndefined)(e.preferredWidth)?(this.preferredCellWidthCheckBox.indeterminate=!0,t=this.documentHelper.selection.start.paragraph.associatedCell.cellFormat.preferredWidth):this.preferredCellWidthCheckBox.checked=this.hasCellWidth,this.cellWidthBox.enabled=this.hasCellWidth,this.cellWidthType.enabled=this.hasCellWidth,"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.cellWidthType.index=0:this.cellWidthType.index=1,this.formatNumericTextBox(this.cellWidthBox,e.preferredWidthType,t),(0,a.classList)(this.cellTopAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),(0,a.classList)(this.cellCenterAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),(0,a.classList)(this.cellBottomAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),"Top"===e.verticalAlignment?(0,a.classList)(this.cellTopAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Center"===e.verticalAlignment?(0,a.classList)(this.cellCenterAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]):"Bottom"===e.verticalAlignment&&(0,a.classList)(this.cellBottomAlign,["e-de-table-alignment-active"],["e-de-tablecell-alignment"])},e.prototype.updateClassForCellAlignment=function(e){for(var t=e.getElementsByClassName(e.id+"e-de-table-cell-alignment"),i=0;i<t.length;i++){var n=t[parseInt(i.toString(),10)];n.classList.contains("e-de-table-alignment-active")&&(0,a.classList)(n,["e-de-tablecell-alignment"],["e-de-table-alignment-active"])}},e.prototype.formatNumericTextBox=function(e,t,i){e.format="Auto"===t||"Point"===t?"n2":"#'%'",e.step=1,e.decimals=2,e.value=i,e.htmlAttributes={"aria-label":"cellWidth"}},e.prototype.getCellAlignment=function(){for(var e=this.cellTab.id,t=this.cellTab.getElementsByClassName(e+"e-de-table-cell-alignment"),i=0;i<t.length;i++){if(t[parseInt(i.toString(),10)].classList.contains("e-de-table-alignment-active"))return 0===i?"Top":1===i?"Center":"Bottom"}return this.documentHelper.selection.cellFormat.verticalAlignment},e.prototype.onCellWidthChange=function(){this.cellFormat.preferredWidth=this.cellWidthBox.value},e.prototype.onCellWidthTypeChange=function(){var e,t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable,i=t.getOwnerWidth(!0),n=t.getTableClientWidth(i);"Percent"===this.cellWidthType.value&&"Percent"!==this.documentHelper.selection.cellFormat.preferredWidthType?(e=this.cellWidthBox.value/n*100,this.formatNumericTextBox(this.cellWidthBox,"Percent",e)):"Points"===this.cellWidthType.value&&"Point"!==this.documentHelper.selection.cellFormat.preferredWidthType?(e=n/100*this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Point",e)):(e="#'%'"===this.cellWidthBox.format?"Points"===this.cellWidthType.value?n/100*this.cellWidthBox.value:this.cellWidthBox.value:"Percent"===this.cellWidthType.value?this.cellWidthBox.value/n*100:this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Points"===this.cellWidthType.value?"Point":this.cellWidthType.value,e)),this.cellFormat.preferredWidthType="Points"===this.cellWidthType.value?"Point":this.cellWidthType.value},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.cellAlignment=void 0,this.tableAlignment=void 0,this.documentHelper=void 0,this.preferCheckBox=void 0,this.tableWidthType=void 0,this.preferredWidth=void 0,this.rowHeightType=void 0,this.rowHeightCheckBox=void 0,this.rowHeight=void 0,this.cellWidthType=void 0,this.preferredCellWidthCheckBox=void 0,this.preferredCellWidth=void 0,this.tableTab=void 0,this.rowTab=void 0,this.cellTab=void 0,this.left=void 0,this.center=void 0,this.right=void 0,this.leftIndent=void 0,this.allowRowBreak=void 0,this.repeatHeader=void 0,this.cellTopAlign=void 0,this.cellCenterAlign=void 0,this.cellBottomAlign=void 0,this.titleTextBox=void 0,this.descriptionTextBox=void 0,this.altTab=void 0,this.paraFormatIn&&(this.paraFormatIn.destroy(),this.paraFormatIn=void 0),this.tableFormatIn&&this.tableFormatIn.destroy(),this.cellFormatIn&&this.cellFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn=void 0},e}(),Jh=function(){function e(e){var t=this;this.cellFormat=new Ma,this.tableFormat=new Ra,this.isShadingChanged=!1,this.handleSettingCheckBoxActionHandler=this.onhandleSettingCheckBoxActionClicked.bind(this),this.handlePreviewCheckBoxActionHandler=this.onhandlePreviewCheckBoxActionClicked.bind(this),this.applyBordersShadingsProperties=function(){var e=t.documentHelper.owner.tablePropertiesDialogModule,i=t.documentHelper.selection.start.paragraph.associatedCell,n=void 0;(t.checkClassName(t.previewDivTopTop)||t.checkClassName(t.previewDivTopBottom)||t.checkClassName(t.previewDivTopCenter)||t.checkClassName(t.previewDivBottomcenter)||t.checkClassName(t.previewDivBottomLeft)||t.checkClassName(t.previewDivBottomRight)||t.checkClassName(t.previewDivDiagonalRight)||t.checkClassName(t.previewDivLeftDiagonal))&&(n=new va,t.checkClassName(t.previewDivTopTop)&&(n.top=t.getBorder("top")),t.checkClassName(t.previewDivTopBottom)&&(n.bottom=t.getBorder("bottom")),t.checkClassName(t.previewDivBottomLeft)&&(n.left=t.getBorder("left")),t.checkClassName(t.previewDivBottomRight)&&(n.right=t.getBorder("right")),t.checkClassName(t.previewDivTopCenter)&&(n.horizontal=t.getBorder("horizontal")),t.checkClassName(t.previewDivBottomcenter)&&(n.vertical=t.getBorder("vertical")),t.checkClassName(t.previewDivLeftDiagonal)&&(n.diagonalDown=t.getBorder("diagonalDown")),t.checkClassName(t.previewDivDiagonalRight)&&(n.diagonalUp=t.getBorder("diagonalUp")));var r=new Da,o=t.documentHelper.owner.editorModule;if(r.backgroundColor=t.shadingColorPicker.value,"Cell"===t.ulelementShading.value)e&&(e.isCellBordersAndShadingUpdated=!0),t.cellFormat.borders=new va,(0,a.isNullOrUndefined)(n)?t.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&o.applyBordersInternal(t.cellFormat.borders,new va):o.applyBordersInternal(t.cellFormat.borders,n),(0,a.isNullOrUndefined)(i.cellFormat.shading)||(r.foregroundColor=i.cellFormat.shading.foregroundColor,r.textureStyle=i.cellFormat.shading.textureStyle),t.cellFormat.shading=new Da,o.applyShading(t.cellFormat.shading,r);else if("Table"===t.ulelementShading.value){e&&(e.isTableBordersAndShadingUpdated=!0);var s=t.documentHelper.owner.selectionModule.tableFormat.table.tableFormat;if(t.tableFormat.copyFormat(s),t.tableFormat.borders=new va,!(0,a.isNullOrUndefined)(n)||t.noneDiv.classList.contains("e-de-table-border-inside-setting-click"))for(var l=t.documentHelper.owner.selectionModule.tableFormat.table,d=0,h=l.childWidgets;d<h.length;d++){var c=h[d];t.updateBorder(l.tableFormat.borders.left,c.rowFormat.borders.left),t.updateBorder(l.tableFormat.borders.top,c.rowFormat.borders.top),t.updateBorder(l.tableFormat.borders.right,c.rowFormat.borders.right),t.updateBorder(l.tableFormat.borders.bottom,c.rowFormat.borders.bottom);var p=c.rowFormat.borders.horizontal,u=l.tableFormat.borders.horizontal;("Single"===p.lineStyle&&"None"===u.lineStyle||"Cleared"===p.lineStyle&&"Cleared"===u.lineStyle)&&(u.lineStyle="Single",u.lineWidth=p.lineWidth);var g=c.rowFormat.borders.vertical,m=l.tableFormat.borders.vertical;("Single"===g.lineStyle&&"None"===m.lineStyle||"Cleared"===g.lineStyle&&"Cleared"===m.lineStyle)&&(m.lineStyle="Single",m.lineWidth=g.lineWidth),c.rowFormat.borders.clearFormat();for(var f=0,v=c.childWidgets;f<v.length;f++){v[f].cellFormat.borders.clearFormat()}}(0,a.isNullOrUndefined)(n)?t.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&o.applyBordersInternal(t.tableFormat.borders,new va):o.applyBordersInternal(t.tableFormat.borders,n),(0,a.isNullOrUndefined)(s.shading)||(r.foregroundColor=s.shading.foregroundColor,r.textureStyle=s.shading.textureStyle),t.tableFormat.shading=new Da,t.isShadingChanged=s.shading.backgroundColor!==r.backgroundColor,o.applyShading(t.tableFormat.shading,r)}else if("Paragraph"===t.ulelementShading.value){var y=t.noneDiv.classList.contains("e-de-table-border-inside-setting-click");(0,a.isNullOrUndefined)(t.paragraphFormat)?o.onApplyParagraphFormat("borders",y?new va:n,!1,!1):o.applyBordersInternal(t.paragraphFormat.borders,y?new va:n)}t.applyFormat(),t.closeDialog()},this.closeDialog=function(){t.documentHelper.dialog.hide(),t.closeBordersShadingsDialog()},this.closeBordersShadingsDialog=function(){t.paragraphFormat=void 0,t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.handleSettingCheckBoxAction=function(e){var i=e.target.id,n=t.target.id;i===n+"_None_Div"||i===n+"_None_Div_Container"||i===n+"_None_Div_Transparent"?(t.updateClassForSettingDivElements(),t.noneDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("none")):i===n+"_Box_Div"||i===n+"_Box_Div_Container"||i===n+"_Box_Div_Transparent"?(t.updateClassForSettingDivElements(),t.boxDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("box")):i===n+"_All_Div"||i===n+"_All_Div_Container"||i===n+"_All_Div_Transparent"?(t.updateClassForSettingDivElements(),t.allDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("all")):(t.ulelementShading.value,t.updateClassForSettingDivElements(),t.customDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("customDiv"))},this.handlePreviewCheckBoxAction=function(e){var i=e.target.id,n=t.target.id,r="e-de-table-border-inside-preview-click";t.customDiv.click(),i===n+"_Preview_Div_TopTop_Container"||i===n+"_Preview_Div_TopTop"||i===n+"_previewDivTopTopTransParent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivTopTop),t.showHidePreviewDivElements(n,r,"_Preview_Div","_Preview_Div_TopTop","TopTop")):i===n+"_Preview_Div_TopCenter_Container"||i===n+"_Preview_Div_TopCenter"||i===n+"_previewDivTopCenterTransParent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivTopCenter),t.showHidePreviewDivElements(n,r,"_Preview_Div_Horizontal","_Preview_Div_TopCenter","TopCenter")):i===n+"_Preview_Div_TopBottom_Container"||i===n+"_Preview_Div_TopBottom"||i===n+"_previewDivTopBottomTransParent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivTopBottom),t.showHidePreviewDivElements(n,r,"_Preview_Div","_Preview_Div_TopBottom","TopBottom")):i===n+"_Preview_Div_LeftDiagonal_Container"||i===n+"_Preview_Div_LeftDiagonal"||i===n+"_previewDivLeftDiagonalTransParent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivLeftDiagonal),t.showHidePreviewDivElements(n,r,"_Preview_Div_Left_Diagonal","_Preview_Div_LeftDiagonal","LeftDiagonal")):i===n+"_Preview_Div_BottomLeft_Container"||i===n+"_Preview_Div_BottomLeft"||i===n+"_previewDivBottomLeftTransparent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivBottomLeft),t.showHidePreviewDivElements(n,r,"_Preview_Div","_Preview_Div_BottomLeft","BottomLeft")):i===n+"_Preview_Div_BottomCenter_Container"||i===n+"_Preview_Div_BottomCenter"||i===n+"_previewDivBottomcenterTransparent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivBottomcenter),t.showHidePreviewDivElements(n,r,"_Preview_Div_Vertical","_Preview_Div_BottomCenter","BottomCenter")):i===n+"_Preview_Div_BottomRight_Container"||i===n+"_Preview_Div_BottomRight"||i===n+"_previewDivBottomRightTransparent"?(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivBottomRight),t.showHidePreviewDivElements(n,r,"_Preview_Div","_Preview_Div_BottomRight","BottomRight")):i!==n+"_Preview_Div_RightDiagonal_Container"&&i!==n+"_Preview_Div_RightDiagonal"&&i!==n+"_previewDivDiagonalRightTransparent"||(t.handlePreviewCheckBoxShowHide(n,r,t.previewDivDiagonalRight),t.showHidePreviewDivElements(n,r,"_Preview_Div_Right_Diagonal","_Preview_Div_RightDiagonal","RightDiagonal"))},this.applyTableCellPreviewBoxes=function(){(0,a.isNullOrUndefined)(t.ulelementShading)||("Cell"===t.ulelementShading.value?(t.shadingColorPicker.disabled=!1,t.previewDivBottomcenterContainer.style.visibility="hidden",t.previewDivTopCenterContainer.style.visibility="hidden",t.previewVerticalDiv.style.display="none",t.previewHorizontalDiv.style.display="none",t.previewDivLeftDiagonal.style.display="",t.previewDivDiagonalRight.style.display="",t.previewDivBottomRightContainer.style.left="80px",(0,a.classList)(t.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),(0,a.classList)(t.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),(0,a.classList)(t.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),(0,a.classList)(t.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):"Table"===t.ulelementShading.value?(t.shadingColorPicker.disabled=!1,t.previewDivLeftDiagonal.style.display="none",t.previewDivDiagonalRight.style.display="none",t.previewDivBottomcenterContainer.style.visibility="visible",t.previewDivTopCenterContainer.style.visibility="visible",t.previewVerticalDiv.style.display="",t.previewHorizontalDiv.style.display="",t.previewDivBottomRightContainer.style.left="110px",(0,a.classList)(t.noneDivTransparent,["e-de-table-border-none-setting"],["e-de-para-border-none-setting"]),(0,a.classList)(t.boxDivTransparent,["e-de-table-border-box-setting"],["e-de-para-border-box-setting"]),(0,a.classList)(t.allDivTransparent,["e-de-table-border-all-setting"],["e-de-para-border-shadow-setting"]),(0,a.classList)(t.customDivTransparent,["e-de-table-border-custom-setting"],["e-de-para-border-custom-setting"])):(t.shadingColorPicker.disabled=!0,t.previewDivBottomcenterContainer.style.visibility="hidden",t.previewDivTopCenterContainer.style.visibility="hidden",t.previewVerticalDiv.style.display="none",t.previewHorizontalDiv.style.display="none",t.previewLeftDiagonalDiv.style.display="none",t.previewRightDiagonalDiv.style.display="none",(0,a.classList)(t.noneDivTransparent,["e-de-para-border-none-setting"],["e-de-table-border-none-setting"]),(0,a.classList)(t.boxDivTransparent,["e-de-para-border-box-setting"],["e-de-table-border-box-setting"]),(0,a.classList)(t.allDivTransparent,["e-de-para-border-shadow-setting"],["e-de-table-border-all-setting"]),(0,a.classList)(t.customDivTransparent,["e-de-para-border-custom-setting"],["e-de-table-border-custom-setting"])))},this.applyPreviewTableBackgroundColor=function(e){if(!(0,a.isNullOrUndefined)(e.currentValue)){var i=e.currentValue.hex;t.previewDiv.style.backgroundColor=i}},this.applyPreviewTableBorderColor=function(e){if(!(0,a.isNullOrUndefined)(e.currentValue)){var i=e.currentValue.hex;t.previewDiv.style.borderColor=i,t.previewRightDiagonalDiv.style.backgroundColor=i,t.previewLeftDiagonalDiv.style.backgroundColor=i,t.previewVerticalDiv.style.backgroundColor=i,t.previewHorizontalDiv.style.backgroundColor=i}},this.documentHelper=e}return e.prototype.getModuleName=function(){return"BordersAndShadingDialog"},e.prototype.initBordersAndShadingsDialog=function(e,t){this.target=(0,a.createElement)("div",{id:this.documentHelper.owner.containerId+"_table_border_shadings",className:"e-de-table-border-shading-dlg"}),this.displayText=(0,a.createElement)("div",{innerHTML:e.getConstant("Borders"),className:"e-de-table-border-heading"}),this.settingAndPreviewContainer=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.settingsContiner=(0,a.createElement)("div",{}),this.styleContainer=(0,a.createElement)("div",{}),this.previewContiner=(0,a.createElement)("div",{className:"e-de-table-border-preview-container"}),this.previewSubContainer1=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.previewSubContainer2=(0,a.createElement)("div",{}),this.styleSubContainer=(0,a.createElement)("div",{className:"e-de-container-row"}),this.dropdownListDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.dropDownList=(0,a.createElement)("input",{}),this.widthcontainerDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.widthNumericDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.widthNumeric=(0,a.createElement)("input",{}),this.colorDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.colorText=(0,a.createElement)("div",{innerHTML:e.getConstant("Color"),className:"e-de-table-border-clr-heading"}),this.borderColorPickerElement=(0,a.createElement)("input",{attrs:{type:"color"},className:"e-dlg-clr-pkr-top"}),this.settingText=(0,a.createElement)("div",{innerHTML:e.getConstant("Setting"),className:"e-de-table-setting-heading"}),this.settingsSubContiner=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.noneDivContainer=(0,a.createElement)("div",{id:this.target.id+"_None_Div_Container"}),this.noneDiv=(0,a.createElement)("div",{id:this.target.id+"_None_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),this.noneDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("None"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_None_Div_Label"}),this.boxDivContainer=(0,a.createElement)("div",{id:this.target.id+"_Box_Div_Container"}),this.boxDiv=(0,a.createElement)("div",{id:this.target.id+"_Box_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),this.boxDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Box"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Box_Div_Label"}),this.allDivContainer=(0,a.createElement)("div",{id:this.target.id+"_All_Div_Container"}),this.allDiv=(0,a.createElement)("div",{id:this.target.id+"_All_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),this.allDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("All"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_All_Div_Label"}),this.customDivContainer=(0,a.createElement)("div",{id:this.target.id+"_Custom_Div_Container"}),this.customDiv=(0,a.createElement)("div",{id:this.target.id+"_Custom_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"}),this.customDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Custom"),className:"e-de-table-setting-labels-heading",id:this.target.id+"_Custom_Div_Label"}),this.noneDivTransparent=(0,a.createElement)("div",{id:this.target.id+"_None_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-none-setting"}),this.boxDivTransparent=(0,a.createElement)("div",{id:this.target.id+"_Box_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-box-setting"}),this.allDivTransparent=(0,a.createElement)("div",{id:this.target.id+"_All_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-all-setting"}),this.customDivTransparent=(0,a.createElement)("div",{id:this.target.id+"_Custom_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-custom-setting"}),t&&(this.noneDivTransparent.classList.add("e-de-rtl"),this.boxDivTransparent.classList.add("e-de-rtl"),this.allDivTransparent.classList.add("e-de-rtl"),this.customDivTransparent.classList.add("e-de-rtl")),this.previewText=(0,a.createElement)("div",{innerHTML:e.getConstant("Preview"),className:"e-de-table-setting-heading"}),this.previewDiv=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div",className:"e-de-border-dlg-preview-div",styles:"position: relative"}),this.previewRightDiagonalDiv=(0,a.createElement)("div",{styles:"position: absolute;width:1px;height:111px;left: 38px;top: -17px;transform: rotate(135deg); background-color: black",id:this.target.id+"_Preview_Div_Right_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewLeftDiagonalDiv=(0,a.createElement)("div",{styles:"position: absolute;width: 1px;height: 111px;left: 38px;top: -17px;transform:rotate(45deg); background-color: black",id:this.target.id+"_Preview_Div_Left_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewVerticalDiv=(0,a.createElement)("div",{styles:"width: 1px;height: 80px;position: absolute;left: 39px;top: -1px; background-color: black",id:this.target.id+"_Preview_Div_Vertical",className:"e-de-border-dlg-preview-inside-divs"}),this.previewHorizontalDiv=(0,a.createElement)("div",{styles:"width: 80px;height: 1px;position: absolute;left: -1px;top: 41px; background-color: black",id:this.target.id+"_Preview_Div_Horizontal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewDivVerticalContainer=(0,a.createElement)("div"),this.previewDivTopTopContainer=(0,a.createElement)("div",{styles:"margin-top: 0",className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopTop_Container"}),this.previewDivTopTop=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_TopTop",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopCenterContainer=(0,a.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopCenter_Container"}),this.previewDivTopCenter=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_TopCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopBottomContainer=(0,a.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_TopBottom_Container"}),this.previewDivTopBottom=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_TopBottom",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivLeftDiagonalContainer=(0,a.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_LeftDiagonal_Container"}),this.previewDivLeftDiagonal=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_LeftDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivHorizontalContainer=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.previewDivBottomLeftContainer=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_BottomLeft_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomLeft=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_BottomLeft",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomcenterContainer=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_BottomCenter_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomcenter=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_BottomCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomRightContainer=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_BottomRight_Container",className:"e-de-table-border-icon-container"}),this.previewDivBottomRight=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_BottomRight",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivDiagonalRightContainer=(0,a.createElement)("div",{className:"e-de-table-border-icon-container",id:this.target.id+"_Preview_Div_RightDiagonal_Container"}),this.previewDivDiagonalRight=(0,a.createElement)("div",{id:this.target.id+"_Preview_Div_RightDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopTopTransParent=(0,a.createElement)("div",{id:this.target.id+"_previewDivTopTopTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-toptop-alignment"}),this.previewDivTopCenterTransParent=(0,a.createElement)("div",{id:this.target.id+"_previewDivTopCenterTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment"}),this.previewDivTopBottomTransParent=(0,a.createElement)("div",{id:this.target.id+"_previewDivTopBottomTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment"}),this.previewDivLeftDiagonalTransParent=(0,a.createElement)("div",{id:this.target.id+"_previewDivLeftDiagonalTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment"}),this.previewDivBottomLeftTransparent=(0,a.createElement)("div",{id:this.target.id+"_previewDivBottomLeftTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment"}),this.previewDivBottomcenterTransparent=(0,a.createElement)("div",{id:this.target.id+"_previewDivBottomcenterTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment"}),this.previewDivBottomRightTransparent=(0,a.createElement)("div",{id:this.target.id+"_previewDivBottomRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment"}),this.previewDivDiagonalRightTransparent=(0,a.createElement)("div",{id:this.target.id+"_previewDivDiagonalRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment"}),this.shadingContiner=(0,a.createElement)("div",{}),this.shadingText=(0,a.createElement)("div",{innerHTML:e.getConstant("Shading"),className:"e-de-table-border-heading"}),this.shadings=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.colorPickerDiv=(0,a.createElement)("div",{className:"e-de-table-border-clr-left-container"}),this.label=(0,a.createElement)("div",{innerHTML:e.getConstant("Fill"),className:"e-de-table-border-clr-heading"}),this.shadingColorPickerElement=(0,a.createElement)("input",{attrs:{type:"color"},id:this.target.id+"_shading_color"}),this.shdApply=(0,a.createElement)("div",{className:"e-de-subcontainer-right"});var i=(0,a.createElement)("input",{id:this.target.id+"_shading"}),n=[{Value:"Cell",Name:e.getConstant("Cell ")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}];this.shdApply.appendChild(i),this.noneDiv.appendChild(this.noneDivTransparent),this.boxDiv.appendChild(this.boxDivTransparent),this.allDiv.appendChild(this.allDivTransparent),this.customDiv.appendChild(this.customDivTransparent),this.noneDivContainer.appendChild(this.noneDiv),this.noneDivContainer.appendChild(this.noneDivLabel),this.boxDivContainer.appendChild(this.boxDiv),this.boxDivContainer.appendChild(this.boxDivLabel),this.allDivContainer.appendChild(this.allDiv),this.allDivContainer.appendChild(this.allDivLabel),this.customDivContainer.appendChild(this.customDiv),this.customDivContainer.appendChild(this.customDivLabel),this.settingsContiner.appendChild(this.settingText),this.settingsContiner.appendChild(this.settingsSubContiner),this.settingsSubContiner.appendChild(this.noneDivContainer),this.settingsSubContiner.appendChild(this.boxDivContainer),this.settingsSubContiner.appendChild(this.allDivContainer),this.settingsSubContiner.appendChild(this.customDivContainer),this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent),this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent),this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent),this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent),this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent),this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent),this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent),this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent),this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter),this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft),this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight),this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight),this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal),this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom),this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter),this.previewDivTopTopContainer.appendChild(this.previewDivTopTop),this.previewContiner.appendChild(this.previewText),this.previewContiner.appendChild(this.previewSubContainer1),this.previewSubContainer1.appendChild(this.previewDivVerticalContainer),this.previewSubContainer1.appendChild(this.previewSubContainer2),this.previewSubContainer2.appendChild(this.previewDiv),this.previewSubContainer2.appendChild(this.previewDivHorizontalContainer),this.previewDiv.appendChild(this.previewLeftDiagonalDiv),this.previewDiv.appendChild(this.previewRightDiagonalDiv),this.previewDiv.appendChild(this.previewHorizontalDiv),this.previewDiv.appendChild(this.previewVerticalDiv),this.previewDivHorizontalContainer.appendChild(this.previewDivBottomLeftContainer),this.previewDivHorizontalContainer.appendChild(this.previewDivBottomcenterContainer),this.previewDivHorizontalContainer.appendChild(this.previewDivBottomRightContainer),this.previewDivHorizontalContainer.appendChild(this.previewDivDiagonalRightContainer),this.previewDivVerticalContainer.appendChild(this.previewDivTopTopContainer),this.previewDivVerticalContainer.appendChild(this.previewDivTopCenterContainer),this.previewDivVerticalContainer.appendChild(this.previewDivTopBottomContainer),this.previewDivVerticalContainer.appendChild(this.previewDivLeftDiagonalContainer),this.shadings.appendChild(this.colorPickerDiv),this.colorPickerDiv.appendChild(this.label),this.colorPickerDiv.appendChild(this.shadingColorPickerElement),this.shadings.appendChild(this.shdApply),this.shadingContiner.appendChild(this.shadingText),this.shadingContiner.appendChild(this.shadings),this.styleContainer.appendChild(this.styleSubContainer),this.styleSubContainer.appendChild(this.dropdownListDiv),this.dropdownListDiv.appendChild(this.dropDownList),this.styleContainer.appendChild(this.widthcontainerDiv),this.widthcontainerDiv.appendChild(this.widthNumericDiv),this.widthNumericDiv.appendChild(this.widthNumeric),this.widthcontainerDiv.appendChild(this.colorDiv),this.colorDiv.appendChild(this.colorText),this.colorDiv.appendChild(this.borderColorPickerElement),this.borderColorPickerElement.setAttribute("aria-label",this.colorText.innerHTML),this.settingAndPreviewContainer.appendChild(this.settingsContiner),this.settingAndPreviewContainer.appendChild(this.previewContiner),this.target.appendChild(this.displayText),this.target.appendChild(this.settingAndPreviewContainer),this.target.appendChild(this.styleContainer),this.target.appendChild(this.shadingContiner),this.noneDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.boxDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.allDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.customDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.previewDivBottomcenterContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivBottomLeftContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivBottomRightContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivTopTopContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivTopBottomContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivTopCenterContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivDiagonalRightContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivLeftDiagonalContainer.addEventListener("click",this.handlePreviewCheckBoxActionHandler),this.borderWidth=new rl.NumericTextBox({value:.5,min:.25,max:6,decimals:2,step:.25,floatLabelType:"Always",placeholder:e.getConstant("Width"),enablePersistence:!1}),this.borderWidth.appendTo(this.widthNumeric);this.widthNumeric.setAttribute("aria-labelledby",e.getConstant("width"));var r=(0,a.initializeCSPTemplate)((function(e){return"<div>"+e.Svg+"</div>"}));this.borderStyle=new al.DropDownList({popupHeight:"150px",dataSource:[{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Single"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="1 1"/></svg></div>',LineStyle:"Dot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1347_1852)"><path d="M3.05176e-05 5.5H98" stroke-linejoin="round" stroke-dasharray="4 1"/></g><defs><clipPath id="clip0_1347_1852"><rect width="98" height="10" fill="white"/></clipPath></defs></svg></div>',LineStyle:"DashSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="4 4"/></svg></div>',LineStyle:"DashLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round" stroke-dasharray="7 3 3 3"/></svg></div>',LineStyle:"DashDot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4.5H98" stroke-linejoin="round" stroke-dasharray="6 2 2 2 2 2"/></svg></div>',LineStyle:"DashDotDot"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 3.5H98" stroke-linejoin="round"/><path d="M0 5.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Double"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5.5H98" stroke-linejoin="round"/><path d="M0 3.5H98" stroke-linejoin="round"/><path d="M0 7.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Triple"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 4H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 7.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 6H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 2.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 5H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 1.5H98" stroke-linejoin="round"/><path d="M0 8.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickThinSmallGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 3H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinMediumGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 7H98" stroke-width="4" stroke-linejoin="round"/><path d="M0 2H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickMediumGap"},{Svg:'<div class="e-de-svg-border-fill-color"><svg style="width:98%;" height="23" viewBox="0 0 98 23" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M98 8H0V9H98V8ZM98 10H0V14H98V10ZM0 15H98V16H0V15Z" /></svg></div>',LineStyle:"ThinThickThinMediumGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 8.5H98" stroke-linejoin="round"/><path d="M0 3H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThinThickLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2.5H98" stroke-linejoin="round"/><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"ThickThinLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_1347_1892)"><g clip-path="url(#clip0_1407_5)"><path d="M0 0.5H98" stroke-linejoin="round"/><path d="M0 9.5H98" stroke-linejoin="round"/><path d="M0 5H98" stroke-width="2" stroke-linejoin="round"/></g><defs><clipPath id="clip0_1407_5"><rect width="98" height="10" fill="white"/></clipPath></defs></svg></div>',LineStyle:"ThinThickThinLargeGap"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H5V4H3V3ZM2 5V4H3V5H2ZM1 6V5H2V6H1ZM1 6V7H0V6H1ZM6 5H5V4H6V5ZM7 6H6V5H7V6ZM9 6V7H7V6H9ZM10 5V6H9V5H10ZM11 4V5H10V4H11ZM13 4H11V3H13V4ZM14 5H13V4H14V5ZM15 6H14V5H15V6ZM17 6V7H15V6H17ZM18 5V6H17V5H18ZM19 4V5H18V4H19ZM21 4H19V3H21V4ZM22 5H21V4H22V5ZM23 6H22V5H23V6ZM25 6V7H23V6H25ZM26 5V6H25V5H26ZM27 4V5H26V4H27ZM29 4H27V3H29V4ZM30 5H29V4H30V5ZM31 6H30V5H31V6ZM33 6V7H31V6H33ZM34 5V6H33V5H34ZM35 4V5H34V4H35ZM37 4H35V3H37V4ZM38 5H37V4H38V5ZM39 6H38V5H39V6ZM41 6V7H39V6H41ZM42 5V6H41V5H42ZM43 4V5H42V4H43ZM45 4H43V3H45V4ZM46 5H45V4H46V5ZM47 6H46V5H47V6ZM49 6V7H47V6H49ZM50 5V6H49V5H50ZM51 4V5H50V4H51ZM53 4H51V3H53V4ZM54 5H53V4H54V5ZM55 6H54V5H55V6ZM57 6V7H55V6H57ZM58 5V6H57V5H58ZM59 4V5H58V4H59ZM61 4H59V3H61V4ZM62 5H61V4H62V5ZM63 6H62V5H63V6ZM65 6V7H63V6H65ZM66 5V6H65V5H66ZM67 4V5H66V4H67ZM69 4H67V3H69V4ZM70 5H69V4H70V5ZM71 6H70V5H71V6ZM73 6V7H71V6H73ZM74 5V6H73V5H74ZM75 4V5H74V4H75ZM77 4H75V3H77V4ZM78 5H77V4H78V5ZM79 6H78V5H79V6ZM81 6V7H79V6H81ZM82 5V6H81V5H82ZM83 4V5H82V4H83ZM85 4H83V3H85V4ZM86 5H85V4H86V5ZM87 6H86V5H87V6ZM89 6V7H87V6H89ZM90 5V6H89V5H90ZM91 4V5H90V4H91ZM93 4H91V3H93V4ZM94 5H93V4H94V5ZM95 6V5H94V6H95ZM95 6V7H97V6H95Z" fill="black"/></svg></div>',LineStyle:"SingleWavy"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 2H5V3H3V2ZM2 4V3H3V4H2ZM2 4V5H1V4H2ZM6 4H5V3H6V4ZM9 4V5H6V4H9ZM10 3V4H9V3H10ZM12 3H10V2H12V3ZM13 4H12V3H13V4ZM16 4V5H13V4H16ZM17 3V4H16V3H17ZM19 3H17V2H19V3ZM20 4H19V3H20V4ZM23 4V5H20V4H23ZM24 3V4H23V3H24ZM26 3H24V2H26V3ZM27 4H26V3H27V4ZM30 4V5H27V4H30ZM31 3V4H30V3H31ZM33 3H31V2H33V3ZM34 4H33V3H34V4ZM37 4V5H34V4H37ZM38 3V4H37V3H38ZM40 3H38V2H40V3ZM41 4H40V3H41V4ZM44 4V5H41V4H44ZM45 3V4H44V3H45ZM47 3H45V2H47V3ZM48 4H47V3H48V4ZM51 4V5H48V4H51ZM52 3V4H51V3H52ZM54 3H52V2H54V3ZM55 4H54V3H55V4ZM58 4V5H55V4H58ZM59 3V4H58V3H59ZM61 3H59V2H61V3ZM62 4H61V3H62V4ZM65 4V5H62V4H65ZM66 3V4H65V3H66ZM68 3H66V2H68V3ZM69 4H68V3H69V4ZM72 4V5H69V4H72ZM73 3V4H72V3H73ZM75 3H73V2H75V3ZM76 4H75V3H76V4ZM79 4V5H76V4H79ZM80 3V4H79V3H80ZM82 3H80V2H82V3ZM83 4H82V3H83V4ZM86 4V5H83V4H86ZM87 3V4H86V3H87ZM89 3H87V2H89V3ZM90 4H89V3H90V4ZM93 4V5H90V4H93ZM94 3V4H93V3H94ZM96 3H94V2H96V3ZM96 3H97V4H96V3ZM2 7H1V8H2V7ZM3 6H2V7H3V6ZM5 6H3V5H5V6ZM6 7H5V6H6V7ZM9 7V8H6V7H9ZM10 6V7H9V6H10ZM12 6H10V5H12V6ZM13 7H12V6H13V7ZM16 7H13V8H16V7ZM17 6H16V7H17V6ZM19 6V5H17V6H19ZM20 7V6H19V7H20ZM23 7H20V8H23V7ZM24 6H23V7H24V6ZM26 6V5H24V6H26ZM27 7V6H26V7H27ZM30 7V8H27V7H30ZM31 6V7H30V6H31ZM33 6H31V5H33V6ZM34 7H33V6H34V7ZM37 7V8H34V7H37ZM38 6V7H37V6H38ZM40 6H38V5H40V6ZM41 7H40V6H41V7ZM44 7H41V8H44V7ZM45 6H44V7H45V6ZM47 6V5H45V6H47ZM48 7V6H47V7H48ZM51 7H48V8H51V7ZM52 6H51V7H52V6ZM54 6V5H52V6H54ZM55 7V6H54V7H55ZM58 7V8H55V7H58ZM59 6V7H58V6H59ZM61 6H59V5H61V6ZM62 7H61V6H62V7ZM65 7V8H62V7H65ZM66 6V7H65V6H66ZM68 6H66V5H68V6ZM69 7H68V6H69V7ZM72 7H69V8H72V7ZM73 6H72V7H73V6ZM75 6V5H73V6H75ZM76 7V6H75V7H76ZM79 7H76V8H79V7ZM80 6H79V7H80V6ZM82 6V5H80V6H82ZM83 7V6H82V7H83ZM86 7V8H83V7H86ZM87 6V7H86V6H87ZM89 6H87V5H89V6ZM90 7H89V6H90V7ZM93 7V8H90V7H93ZM94 6V7H93V6H94ZM96 6H94V5H96V6ZM96 6V7H97V6H96Z" fill="black"/></svg></div>',LineStyle:"DoubleWavy"},{Svg:'<div class="e-de-svg-border-fill-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 3H4V4H3V5H2V6H1V7H0V3ZM3 6V5H4V6H3ZM5 5V6H4V7H9V6H10V7H11V6H12V7H17V6H18V7H19V6H20V7H25V6H26V7H27V6H28V7H33V6H34V7H35V6H36V7H41V6H42V7H43V6H44V7H49V6H50V7H51V6H52V7H57V6H58V7H59V6H60V7H65V6H66V7H67V6H68V7H73V6H74V7H75V6H76V7H81V6H82V7H83V6H84V7H89V6H90V7H91V6H92V7H97V6H98V5V3H95V4H94V3H93V4H92V3H87V4H86V3H85V4H84V3H79V4H78V3H77V4H76V3H71V4H70V3H69V4H68V3H63V4H62V3H61V4H60V3H55V4H54V3H53V4H52V3H47V4H46V3H45V4H44V3H39V4H38V3H37V4H36V3H31V4H30V3H29V4H28V3H23V4H22V3H21V4H20V3H15V4H14V3H13V4H12V3H7V4H6V3H5V4H4V5H5ZM5 5H6V4H5V5ZM12 5V4H11V5H10V6H11V5H12ZM13 5V6H12V5H13ZM13 5V4H14V5H13ZM20 5V4H19V5H18V6H19V5H20ZM21 5H22V4H21V5ZM21 5H20V6H21V5ZM28 5V4H27V5H26V6H27V5H28ZM29 5V6H28V5H29ZM29 5H30V4H29V5ZM36 5V4H35V5H34V6H35V5H36ZM37 5V4H38V5H37ZM37 5H36V6H37V5ZM44 5V4H43V5H42V6H43V5H44ZM45 5V6H44V5H45ZM45 5V4H46V5H45ZM52 5V4H51V5H50V6H51V5H52ZM53 5H54V4H53V5ZM53 5H52V6H53V5ZM60 5V4H59V5H58V6H59V5H60ZM61 5V6H60V5H61ZM61 5H62V4H61V5ZM68 5V4H67V5H66V6H67V5H68ZM69 5V4H70V5H69ZM69 5H68V6H69V5ZM76 5V4H75V5H74V6H75V5H76ZM77 5V6H76V5H77ZM77 5V4H78V5H77ZM84 5V4H83V5H82V6H83V5H84ZM85 5H86V4H85V5ZM85 5H84V6H85V5ZM92 5V4H91V5H90V6H91V5H92ZM93 5V6H92V5H93ZM93 5H94V4H93V5ZM3 6H2V7H3V6Z" /></svg></div>',LineStyle:"DashDotStroked"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 8H98" stroke-width="2" stroke-linejoin="round"/><path d="M0 5H98" stroke="#808080" stroke-width="4" stroke-linejoin="round"/><path d="M0 2H98" stroke="#C0C0C0" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"Emboss3D"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 2H98" stroke-width="2" stroke-linejoin="round"/><path d="M0 5H98" stroke="#808080" stroke-width="4" stroke-linejoin="round"/><path d="M0 8H98" stroke="#C0C0C0" stroke-width="2" stroke-linejoin="round"/></svg></div>',LineStyle:"Engrave3D"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.5H98" stroke="#A0A0A0" stroke-linejoin="round"/><path d="M0 8.5H98" stroke-linejoin="round"/></svg></div>',LineStyle:"Outset"},{Svg:'<div class="e-de-svg-border-color"><svg style="width:98%;" height="10" viewBox="0 0 98 10" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.5H98" stroke-linejoin="round"/><path d="M0 8.5H98" stroke="#A0A0A0" stroke-linejoin="round"/></svg></div>',LineStyle:"Inset"}],floatLabelType:"Always",fields:{text:"Svg",value:"LineStyle"},itemTemplate:r,valueTemplate:r,placeholder:e.getConstant("Style"),enableRtl:t}),this.borderStyle.appendTo(this.dropDownList),this.dropDownList.setAttribute("aria-lablledby",e.getConstant("Style")),this.ulelementShading=new al.DropDownList({dataSource:n,fields:{text:"Name",value:"Value"},change:this.applyTableCellPreviewBoxes,index:1,floatLabelType:"Always",placeholder:e.getConstant("Apply To"),enableRtl:t,htmlAttributes:{"aria-labelledby":e.getConstant("Apply To")}}),this.ulelementShading.appendTo(i);var o=this.documentHelper.owner.documentEditorSettings.colorPickerSettings,s=o.columns,l=o.createPopupOnClick,d=(o.cssClass,o.disabled),h=o.enablePersistence,c=o.inline,p=o.mode,u=o.modeSwitcher,g=o.noColor,m=o.presetColors,f=o.showButtons;this.borderColorPicker=new rl.ColorPicker({value:"#000000",change:this.applyPreviewTableBorderColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker",enableOpacity:!1,mode:p,modeSwitcher:u,showButtons:f,columns:s,createPopupOnClick:l,disabled:d,enablePersistence:h,inline:c,noColor:g,presetColors:m}),this.documentHelper.borderColorPicker=this.borderColorPicker,this.borderColorPicker.appendTo(this.borderColorPickerElement),this.shadingColorPicker=new rl.ColorPicker({value:"#FFFFFF",change:this.applyPreviewTableBackgroundColor,enableRtl:t,locale:this.documentHelper.owner.locale,cssClass:"e-de-dlg-clr-picker",enableOpacity:!1,mode:p,modeSwitcher:u,showButtons:f,columns:s,createPopupOnClick:l,disabled:d,enablePersistence:h,inline:c,noColor:g,presetColors:m}),this.documentHelper.shadingColorPicker=this.shadingColorPicker,this.shadingColorPicker.appendTo(this.shadingColorPickerElement),t&&this.label.classList.add("e-de-rtl")},e.prototype.updateBorder=function(e,t){"Single"===t.lineStyle&&"None"===e.lineStyle&&(e.lineStyle="Single",e.lineWidth=t.lineWidth)},e.prototype.applyFormat=function(){var e=this.documentHelper.owner.editorModule;"Paragraph"!==this.ulelementShading.value&&(e.initComplexHistory("BordersAndShading"),e.isBordersAndShadingDialog=!0,"Cell"===this.ulelementShading.value?e.onCellFormat(this.cellFormat):"Table"===this.ulelementShading.value&&e.onTableFormat(this.tableFormat,!0),(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistoryModule.currentHistoryInfo)||this.documentHelper.owner.editorHistoryModule.updateComplexHistory(),"Cell"===this.ulelementShading.value?e.isCellFormatApplied=!0:e.isCellFormatApplied=!1),"Cell"===this.ulelementShading.value?e.isCellFormatApplied=!0:e.isCellFormatApplied=!1,e.isBordersAndShadingDialog=!1},e.prototype.getBorder=function(e){var t=new fa;return t.color=this.borderColorPicker.value,t.lineStyle=this.borderStyle.value,t.lineWidth=this.borderWidth.value,t.space="left"===e||"right"===e?4:1,t},e.prototype.checkClassName=function(e){return e.classList.contains("e-de-table-border-inside-preview-click")},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initBordersAndShadingsDialog(e,this.documentHelper.owner.enableRtl),this.loadBordersShadingsPropertiesDialog(e),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Borders and Shading"),this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.closeBordersShadingsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyBordersShadingsProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.onhandleSettingCheckBoxActionClicked=function(e){this.handleSettingCheckBoxAction(e)},e.prototype.onhandlePreviewCheckBoxActionClicked=function(e){this.handlePreviewCheckBoxAction(e)},e.prototype.updateClassForSettingDivElements=function(){for(var e=this.target.getElementsByClassName("e-de-table-border-inside-setting"),t=0;t<e.length;t++)if(-1!==e[parseInt(t.toString(),10)].className.indexOf("e-de-table-border-inside-setting-click")){var i=e[parseInt(t.toString(),10)].className;i=i.replace("e-de-table-border-inside-setting-click",""),e[parseInt(t.toString(),10)].className=i}},e.prototype.setSettingPreviewDivElement=function(e){switch(e){case"none":this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("none");break;case"box":this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("box");break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all")):(this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all"))}},e.prototype.isShowHidePreviewTableElements=function(e){switch(e){case"none":this.previewDiv.style.border="none",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"box":this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"all":"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="block",this.previewVerticalDiv.style.display="block"):(this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none")}},e.prototype.handlePreviewCheckBoxShowHide=function(e,t,i){i.classList.contains(t)?i.classList.remove(t):i.classList.add(t)},e.prototype.showHidePreviewDivElements=function(e,t,i,n,r){var o=document.getElementById(e+i),s=document.getElementById(e+n);"TopTop"===r?this.setPropertyPreviewDivElement(o,s,t,"border-top"):"TopCenter"===r?this.setPropertyPreviewDivElement(o,s,t,"display"):"TopBottom"===r?this.setPropertyPreviewDivElement(o,s,t,"border-bottom"):"LeftDiagonal"===r?this.setPropertyPreviewDivElement(o,s,t,"display"):"BottomLeft"===r?this.setPropertyPreviewDivElement(o,s,t,"border-left"):"BottomCenter"===r?this.setPropertyPreviewDivElement(o,s,t,"display"):"BottomRight"===r?this.setPropertyPreviewDivElement(o,s,t,"border-right"):"RightDiagonal"===r&&this.setPropertyPreviewDivElement(o,s,t,"display")},e.prototype.setPropertyPreviewDivElement=function(e,t,i,n){t.classList.contains(i)&&"border"===n.split("-")[0]?e.style[""+n]="1px solid rgba(0, 0, 0, .54)":t.classList.contains(i)&&"display"===n?e.style[""+n]="block":e.style[""+n]="none"},e.prototype.loadBordersShadingsPropertiesDialog=function(e){var t,i,n,r;if((0,a.isNullOrUndefined)(this.documentHelper.selection.tableFormat.table)){this.shadingContiner.style.display="none",this.ulelementShading.dataSource=[{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind();var o=this.documentHelper.selection.start.paragraph.paragraphFormat;this.ulelementShading.value="Paragraph",this.cloneBorders(o.borders);var s=this.getSelectionBorderFormat();s.hasValues()?(t=this.getLineStyle(s.lineStyle),i=s.color,r=s.lineWidth):(t=0,i="#000000",r=.5),this.shadingColorPicker.disabled=!0}else{this.shadingContiner.style.display="block",this.ulelementShading.dataSource=[{Value:"Cell",Name:e.getConstant("Cell")},{Value:"Table",Name:e.getConstant("Table")},{Value:"Paragraph",Name:e.getConstant("Paragraph")}],this.ulelementShading.dataBind();var l=this.documentHelper.selection.tableFormat.table.tableFormat;(0,a.isNullOrUndefined)(l)||(0,a.isNullOrUndefined)(l.borders)||(this.cloneBorders(l.borders),(0,a.isNullOrUndefined)(l.borders)||(0,a.isNullOrUndefined)(l.borders.top)?(t=0,i="#000000",r=0,n="#000000"):(t=this.getLineStyle(l.borders.top.lineStyle),i=l.borders.top.color,r=l.borders.top.getLineWidth(),n=l.shading.backgroundColor),this.ulelementShading.value="Table",this.shadingColorPicker.value=n,this.shadingColorPicker.disabled=!1)}this.borderColorPicker.value=i,this.previewDivLeftDiagonal.style.display="none",this.previewDivDiagonalRight.style.display="none",this.borderWidth.value=r,this.borderStyle.index=t},e.prototype.getSelectionBorderFormat=function(){var e=new fa,t=this.documentHelper.selection.paragraphFormat.borders;return"None"!==t.top.lineStyle?this.copyToBorder(e,t.top):"None"!==t.left.lineStyle?this.copyToBorder(e,t.left):"None"!==t.bottom.lineStyle?this.copyToBorder(e,t.bottom):"None"!==t.right.lineStyle?this.copyToBorder(e,t.right):e},e.prototype.copyToBorder=function(e,t){return(0,a.isNullOrUndefined)(t.lineStyle)||(e.lineStyle=t.lineStyle),(0,a.isNullOrUndefined)(t.color)||(e.color=t.color),(0,a.isNullOrUndefined)(t.lineWidth)||(e.lineWidth=t.lineWidth),e},e.prototype.cloneBorders=function(e){var t=!1,i=!1,n=!1,r=!1,o=!1,s=!1,a=!1,l=!1,d=!1;null!==e&&(e.top&&(e.top.hasNoneStyle||"None"!==e.top.lineStyle)&&(t=!0),e.bottom&&(e.bottom.hasNoneStyle||"None"!==e.bottom.lineStyle)&&(i=!0),e.left&&(e.left.hasNoneStyle||"None"!==e.left.lineStyle)&&(n=!0),e.right&&(e.right.hasNoneStyle||"None"!==e.right.lineStyle)&&(r=!0),e.horizontal&&(e.horizontal.hasNoneStyle||"None"!==e.horizontal.lineStyle)&&(o=!0),e.vertical&&(e.vertical.hasNoneStyle||"None"!==e.vertical.lineStyle)&&(s=!0),e.diagonalDown&&(e.diagonalDown.hasNoneStyle||"None"!==e.diagonalDown.lineStyle)&&(a=!0),e.diagonalUp&&(e.diagonalUp.hasNoneStyle||"None"!==e.diagonalUp.lineStyle)&&(d=!0),t&&i&&n&&r?t&&i&&n&&r&&o&&s&&!d&&!a?t&&i&&n&&r&&o&&s&&!d&&!a&&(e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("all"),this.allDiv.classList.add("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"))):n&&i&&t&&r&&!o&&!s?e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("box"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.add("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):l=!0:l=!0,this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),t||i||n||r||o||s?l&&(this.customDiv.classList.add("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?t?this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"):t?(this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="1px solid rgba(0,0,0,.54)"):(this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderTop="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?i?this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"):i?(this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="1px solid rgba(0,0,0,.54)"):(this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderBottom="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?n?this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"):n?(this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderLeft="0px"),"Cell"==this.ulelementShading.value||"Table"===this.ulelementShading.value?r?this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"):r?(this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="1px solid rgba(0,0,0,.54)"):(this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDiv.style.borderRight="0px"),s?this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),o?this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click")):"Cell"===this.ulelementShading.value||"Table"===this.ulelementShading.value?(this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")))},e.prototype.getLineStyle=function(e){switch(e){case"Single":return 0;case"Dot":return 1;case"DashSmallGap":return 2;case"DashLargeGap":return 3;case"DashDot":return 4;case"DashDotDot":return 5;case"Double":return 6;case"Triple":return 7;case"ThinThickSmallGap":return 8;case"ThickThinSmallGap":return 9;case"ThinThickThinSmallGap":return 10;case"ThinThickMediumGap":return 11;case"ThickThinMediumGap":return 12;case"ThinThickThinMediumGap":return 13;case"ThinThickLargeGap":return 14;case"ThickThinLargeGap":return 15;case"ThinThickThinLargeGap":return 16;case"SingleWavy":return 17;case"DoubleWavy":return 18;case"DashDotStroked":return 29;case"Emboss3D":return 20;case"Engrave3D":return 21;case"Outset":return 22;case"Inset":return 23}return 0},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.cellFormat&&(this.cellFormat.destroy(),this.cellFormat=void 0),this.tableFormat&&(this.tableFormat.destroy(),this.tableFormat=void 0),this.paragraphFormat&&(this.paragraphFormat.destroy(),this.paragraphFormat=void 0),this.dialog=void 0,this.target=void 0,(0,a.isNullOrUndefined)(this.borderStyle)||this.borderStyle.destroy(),this.borderStyle=void 0,(0,a.isNullOrUndefined)(this.borderColorPicker)||this.borderColorPicker.destroy(),this.borderColorPicker=void 0,(0,a.isNullOrUndefined)(this.shadingColorPicker)||this.shadingColorPicker.destroy(),this.shadingColorPicker=void 0,(0,a.isNullOrUndefined)(this.ulelementShading)||this.ulelementShading.destroy(),this.removeEvents(),this.removeElements(),this.ulelementShading=void 0,this.noneDivTransparent=void 0,this.boxDivTransparent=void 0,this.allDivTransparent=void 0,this.customDivTransparent=void 0,this.previewDiv=void 0,this.previewRightDiagonalDiv=void 0,this.previewLeftDiagonalDiv=void 0,this.previewVerticalDiv=void 0,this.previewHorizontalDiv=void 0,this.previewDivTopTopContainer=void 0,this.previewDivTopTop=void 0,this.previewDivTopCenterContainer=void 0,this.previewDivTopCenter=void 0,this.previewDivTopBottomContainer=void 0,this.previewDivTopBottom=void 0,this.previewDivLeftDiagonalContainer=void 0,this.previewDivLeftDiagonal=void 0,this.previewDivBottomLeftContainer=void 0,this.previewDivBottomLeft=void 0,this.previewDivBottomcenterContainer=void 0,this.previewDivBottomcenter=void 0,this.previewDivBottomRightContainer=void 0,this.previewDivBottomRight=void 0,this.previewDivDiagonalRightContainer=void 0,this.previewDivDiagonalRight=void 0,this.previewDivTopTopTransParent=void 0,this.previewDivTopCenterTransParent=void 0,this.previewDivTopBottomTransParent=void 0,this.previewDivLeftDiagonalTransParent=void 0,this.previewDivBottomLeftTransparent=void 0,this.previewDivBottomcenterTransparent=void 0,this.previewDivBottomRightTransparent=void 0,this.previewDivDiagonalRightTransparent=void 0,this.shadingContiner=void 0,this.noneDiv=void 0,this.customDiv=void 0,this.allDiv=void 0,this.boxDiv=void 0,this.displayText=void 0,this.settingAndPreviewContainer=void 0,this.settingsContiner=void 0,this.styleContainer=void 0,this.previewContiner=void 0,this.previewSubContainer1=void 0,this.previewSubContainer2=void 0,this.styleSubContainer=void 0,this.dropdownListDiv=void 0,this.dropDownList=void 0,this.widthcontainerDiv=void 0,this.widthNumericDiv=void 0,this.widthNumeric=void 0,this.colorDiv=void 0,this.colorText=void 0,this.borderColorPickerElement=void 0,this.settingText=void 0,this.settingsSubContiner=void 0,this.noneDivContainer=void 0,this.noneDivLabel=void 0,this.boxDivContainer=void 0,this.boxDivLabel=void 0,this.allDivContainer=void 0,this.allDivLabel=void 0,this.customDivContainer=void 0,this.customDivLabel=void 0,this.previewDivHorizontalContainer=void 0,this.previewDivVerticalContainer=void 0,this.previewText=void 0,this.shadingText=void 0,this.shadings=void 0,this.colorPickerDiv=void 0,this.label=void 0,this.shadingColorPickerElement=void 0,this.shdApply=void 0,this.documentHelper=void 0},e.prototype.removeEvents=function(){this.noneDivContainer&&this.noneDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.boxDivContainer&&this.boxDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.allDivContainer&&this.allDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.customDivContainer&&this.customDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.previewDivBottomcenterContainer&&this.previewDivBottomcenterContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivBottomLeftContainer&&this.previewDivBottomLeftContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivBottomRightContainer&&this.previewDivBottomRightContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivTopBottomContainer&&this.previewDivTopBottomContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivTopCenterContainer&&this.previewDivTopCenterContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivTopTopContainer&&this.previewDivTopTopContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivDiagonalRightContainer&&this.previewDivDiagonalRightContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler),this.previewDivLeftDiagonalContainer&&this.previewDivLeftDiagonalContainer.removeEventListener("click",this.handlePreviewCheckBoxActionHandler)},e.prototype.removeElements=function(){this.noneDivTransparent&&(this.noneDivTransparent.remove(),this.noneDivTransparent=void 0),this.boxDivTransparent&&(this.boxDivTransparent.remove(),this.boxDivTransparent=void 0),this.allDivTransparent&&(this.allDivTransparent.remove(),this.allDivTransparent=void 0),this.customDivTransparent&&(this.customDivTransparent.remove(),this.customDivTransparent=void 0),this.previewDiv&&(this.previewDiv.remove(),this.previewDiv=void 0),this.previewRightDiagonalDiv&&(this.previewRightDiagonalDiv.remove(),this.previewRightDiagonalDiv=void 0),this.previewLeftDiagonalDiv&&(this.previewLeftDiagonalDiv.remove(),this.previewLeftDiagonalDiv=void 0),this.previewVerticalDiv&&(this.previewVerticalDiv.remove(),this.previewVerticalDiv=void 0),this.previewHorizontalDiv&&(this.previewHorizontalDiv.remove(),this.previewHorizontalDiv=void 0),this.previewDivTopTopContainer&&(this.previewDivTopTopContainer.remove(),this.previewDivTopTopContainer=void 0),this.previewDivTopTop&&(this.previewDivTopTop.remove(),this.previewDivTopTop=void 0),this.previewDivTopCenterContainer&&(this.previewDivTopCenterContainer.remove(),this.previewDivTopCenterContainer=void 0),this.previewDivTopCenter&&(this.previewDivTopCenter.remove(),this.previewDivTopCenter=void 0),this.previewDivTopBottomContainer&&(this.previewDivTopBottomContainer.remove(),this.previewDivTopBottomContainer=void 0),this.previewDivTopBottom&&(this.previewDivTopBottom.remove(),this.previewDivTopBottom=void 0),this.previewDivLeftDiagonalContainer&&(this.previewDivLeftDiagonalContainer.remove(),this.previewDivLeftDiagonalContainer=void 0),this.previewDivLeftDiagonal&&(this.previewDivLeftDiagonal.remove(),this.previewDivLeftDiagonal=void 0),this.previewDivBottomLeftContainer&&(this.previewDivBottomLeftContainer.remove(),this.previewDivBottomLeftContainer=void 0),this.previewDivBottomLeft&&(this.previewDivBottomLeft.remove(),this.previewDivBottomLeft=void 0),this.previewDivBottomcenterContainer&&(this.previewDivBottomcenterContainer.remove(),this.previewDivBottomcenterContainer=void 0),this.previewDivBottomcenter&&(this.previewDivBottomcenter.remove(),this.previewDivBottomcenter=void 0),this.previewDivBottomRightContainer&&(this.previewDivBottomRightContainer.remove(),this.previewDivBottomRightContainer=void 0),this.previewDivBottomRight&&(this.previewDivBottomRight.remove(),this.previewDivBottomRight=void 0),this.previewDivDiagonalRightContainer&&(this.previewDivDiagonalRightContainer.remove(),this.previewDivDiagonalRightContainer=void 0),this.previewDivDiagonalRight&&(this.previewDivDiagonalRight.remove(),this.previewDivDiagonalRight=void 0),this.previewDivTopTopTransParent&&(this.previewDivTopTopTransParent.remove(),this.previewDivTopTopTransParent=void 0),this.previewDivTopCenterTransParent&&(this.previewDivTopCenterTransParent.remove(),this.previewDivTopCenterTransParent=void 0),this.previewDivTopBottomTransParent&&(this.previewDivTopBottomTransParent.remove(),this.previewDivTopBottomTransParent=void 0),this.previewDivLeftDiagonalTransParent&&(this.previewDivLeftDiagonalTransParent.remove(),this.previewDivLeftDiagonalTransParent=void 0),this.previewDivBottomLeftTransparent&&(this.previewDivBottomLeftTransparent.remove(),this.previewDivBottomLeftTransparent=void 0),this.previewDivBottomcenterTransparent&&(this.previewDivBottomcenterTransparent.remove(),this.previewDivBottomcenterTransparent=void 0),this.previewDivBottomRightTransparent&&(this.previewDivBottomRightTransparent.remove(),this.previewDivBottomRightTransparent=void 0),this.previewDivDiagonalRightTransparent&&(this.previewDivDiagonalRightTransparent.remove(),this.previewDivDiagonalRightTransparent=void 0),this.shadingContiner&&(this.shadingContiner.remove(),this.shadingContiner=void 0),this.noneDiv&&(this.noneDiv.remove(),this.noneDiv=void 0),this.customDiv&&(this.customDiv.remove(),this.customDiv=void 0),this.allDiv&&(this.allDiv.remove(),this.allDiv=void 0),this.boxDiv&&(this.boxDiv.remove(),this.boxDiv=void 0),this.displayText&&(this.displayText.remove(),this.displayText=void 0),this.settingAndPreviewContainer&&(this.settingAndPreviewContainer.remove(),this.settingAndPreviewContainer=void 0),this.settingsContiner&&(this.settingsContiner.remove(),this.settingsContiner=void 0),this.styleContainer&&(this.styleContainer.remove(),this.styleContainer=void 0),this.previewContiner&&(this.previewContiner.remove(),this.previewContiner=void 0),this.previewSubContainer1&&(this.previewSubContainer1.remove(),this.previewSubContainer1=void 0),this.previewSubContainer2&&(this.previewSubContainer2.remove(),this.previewSubContainer2=void 0),this.styleSubContainer&&(this.styleSubContainer.remove(),this.styleSubContainer=void 0),this.dropdownListDiv&&(this.dropdownListDiv.remove(),this.dropdownListDiv=void 0),this.dropDownList&&(this.dropDownList.remove(),this.dropDownList=void 0),this.widthcontainerDiv&&(this.widthcontainerDiv.remove(),this.widthcontainerDiv=void 0),this.widthNumericDiv&&(this.widthNumericDiv.remove(),this.widthNumericDiv=void 0),this.widthNumeric&&(this.widthNumeric.remove(),this.widthNumeric=void 0),this.colorDiv&&(this.colorDiv.remove(),this.colorDiv=void 0),this.colorText&&(this.colorText.remove(),this.colorText=void 0),this.borderColorPickerElement&&(this.borderColorPickerElement.remove(),this.borderColorPickerElement=void 0),this.settingText&&(this.settingText.remove(),this.settingText=void 0),this.settingsSubContiner&&(this.settingsSubContiner.remove(),this.settingsSubContiner=void 0),this.noneDivContainer&&(this.noneDivContainer.remove(),this.noneDivContainer=void 0),this.noneDivLabel&&(this.noneDivLabel.remove(),this.noneDivLabel=void 0),this.boxDivContainer&&(this.boxDivContainer.remove(),this.boxDivContainer=void 0),this.boxDivLabel&&(this.boxDivLabel.remove(),this.boxDivLabel=void 0),this.allDivContainer&&(this.allDivContainer.remove(),this.allDivContainer=void 0),this.allDivLabel&&(this.allDivLabel.remove(),this.allDivLabel=void 0),this.customDivContainer&&(this.customDivContainer.remove(),this.customDivContainer=void 0),this.customDivLabel&&(this.customDivLabel.remove(),this.customDivLabel=void 0),this.previewDivHorizontalContainer&&(this.previewDivHorizontalContainer.remove(),this.previewDivHorizontalContainer=void 0),this.previewDivVerticalContainer&&(this.previewDivVerticalContainer.remove(),this.previewDivVerticalContainer=void 0),this.previewText&&(this.previewText.remove(),this.previewText=void 0),this.shadingText&&(this.shadingText.remove(),this.shadingText=void 0),this.shadings&&(this.shadings.remove(),this.shadings=void 0),this.colorPickerDiv&&(this.colorPickerDiv.remove(),this.colorPickerDiv=void 0),this.label&&(this.label.remove(),this.label=void 0),this.shadingColorPickerElement&&(this.shadingColorPickerElement.remove(),this.shadingColorPickerElement=void 0),this.shdApply&&(this.shdApply.remove(),this.shdApply=void 0)},e}(),Yh=function(){function e(e){var t=this;this.applyTableCellProperties=function(){var e=t.documentHelper.selection.tableFormat;(0,a.isNullOrUndefined)(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value||t.cellSpaceTextBox.value)||e.bottomMargin===t.bottomMarginBox.value&&e.leftMargin===t.leftMarginBox.value&&e.rightMargin===t.rightMarginBox.value&&e.topMargin===t.topMarginBox.value&&e.cellSpacing===t.cellSpaceTextBox.value||(t.documentHelper.owner.tablePropertiesDialogModule.isTableOptionsUpdated=!0,t.applyTableOptions(t.tableFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeAllowSpaceCheckBox=function(){t.allowSpaceCheckBox.checked?t.cellSpaceTextBox.enabled=!0:(t.cellSpaceTextBox.enabled=!1,t.cellSpaceTextBox.value=0)},this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.documentHelper=e}return Object.defineProperty(e.prototype,"tableFormat",{get:function(){return(0,a.isNullOrUndefined)(this.tableFormatIn)?this.tableFormatIn=new Ra:this.tableFormatIn},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableOptionsDialog"},e.prototype.initTableOptionsDialog=function(e,t){var i;this.target=(0,a.createElement)("div",{id:this.documentHelper.owner.containerId+"_insertCellMarginsDialog",className:"e-de-table-options-dlg"}),this.innerDiv=(0,a.createElement)("div"),this.innerDivLabel=(0,a.createElement)("Label",{id:this.target.id+"_innerDivLabel",className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default cell margins")}),this.innerDiv.appendChild(this.innerDivLabel),Qh.getCellMarginDialogElements(this,this.innerDiv,e,!1),this.div=(0,a.createElement)("div"),this.cellSpaceLabel=(0,a.createElement)("Label",{className:"e-de-para-dlg-heading",id:this.target.id+"_cellSpaceLabel"}),this.cellSpaceLabel.innerHTML=e.getConstant("Default cell spacing"),this.div.appendChild(this.cellSpaceLabel),this.table2=(0,a.createElement)("TABLE",{styles:"height: 30px;"}),this.tr3=(0,a.createElement)("tr"),this.td5=(0,a.createElement)("td"),this.allowSpaceCheckBox1=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_cellcheck"}),i=t?"padding-right:25px;":"padding-left:25px;",this.td6=(0,a.createElement)("td",{styles:i}),this.cellspacingTextBox=(0,a.createElement)("input",{attrs:{type:"text"},id:this.target.id+"_cellspacing"}),this.td5.appendChild(this.allowSpaceCheckBox1),this.td6.appendChild(this.cellspacingTextBox),this.tr3.appendChild(this.td5),this.tr3.appendChild(this.td6),this.table2.appendChild(this.tr3),this.div.appendChild(this.table2),this.divBtn=document.createElement("div"),this.target.appendChild(this.div),this.target.appendChild(this.divBtn),this.cellSpaceTextBox=new rl.NumericTextBox({value:0,min:0,max:264.5,width:174,decimals:2,enablePersistence:!1}),this.cellSpaceTextBox.appendTo(this.cellspacingTextBox),this.allowSpaceCheckBox=new tl.CheckBox({label:e.getConstant("Allow spacing between cells"),change:this.changeAllowSpaceCheckBox,enableRtl:t,cssClass:"e-de-tbl-margin-sub-header"}),this.allowSpaceCheckBox.appendTo(this.allowSpaceCheckBox1),this.allowSpaceCheckBox1.setAttribute("aria-label",e.getConstant("Allow spacing between cells")),this.cellspacingTextBox.setAttribute("aria-label","cell spacing")},e.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.tableFormat;this.cellSpaceTextBox.value=e.cellSpacing,this.bottomMarginBox.value=e.bottomMargin,this.topMarginBox.value=e.topMargin,this.rightMarginBox.value=e.rightMargin,this.leftMarginBox.value=e.leftMargin,e.cellSpacing>0?(this.allowSpaceCheckBox.checked=!0,this.cellSpaceTextBox.enabled=!0):(this.allowSpaceCheckBox.checked=!1,this.cellSpaceTextBox.enabled=!1)},e.prototype.applySubTableOptions=function(e,t){this.documentHelper.owner.editorHistoryModule.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.applyTableOptionsHistory(e,t),(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistoryModule.currentHistoryInfo)||this.documentHelper.owner.editorHistoryModule.updateComplexHistory()},e.prototype.applyTableOptionsHelper=function(e){this.applySubTableOptionsHelper(e,void 0)},e.prototype.applyTableOptionsHistory=function(e,t){this.documentHelper.owner.editorModule.initHistory("TableOptions"),this.applySubTableOptionsHelper(e,t)},e.prototype.applySubTableOptionsHelper=function(e,t){(0,a.isNullOrUndefined)(t)&&(t=(t=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable).combineWidget(this.documentHelper.owner.viewer));var i=t.tableFormat;(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.addModifiedTableOptions(i),i.cellSpacing=e.cellSpacing,i.leftMargin=e.leftMargin,i.topMargin=e.topMargin,i.rightMargin=e.rightMargin,i.bottomMargin=e.bottomMargin,this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(t)},e.prototype.applyTableOptions=function(e){e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value,e.cellSpacing=this.cellSpaceTextBox.value},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initTableOptionsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Table Options"),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.tableFormatIn&&(this.tableFormatIn.destroy(),this.tableFormatIn=void 0),this.removeElements(),this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.cellspacingTextBox=void 0,this.allowSpaceCheckBox=void 0},e.prototype.removeElements=function(){this.innerDiv&&(this.innerDiv.remove(),this.innerDiv=void 0),this.innerDivLabel&&(this.innerDivLabel.remove(),this.innerDivLabel=void 0),this.div&&(this.div.remove(),this.div=void 0),this.cellSpaceLabel&&(this.cellSpaceLabel.remove(),this.cellSpaceLabel=void 0),this.table2&&(this.table2.remove(),this.table2=void 0),this.tr3&&(this.tr3.remove(),this.tr3=void 0),this.td5&&(this.td5.remove(),this.td5=void 0),this.allowSpaceCheckBox1&&(this.allowSpaceCheckBox1.remove(),this.allowSpaceCheckBox1=void 0),this.td6&&(this.td6.remove(),this.td6=void 0),this.divBtn&&(this.divBtn.remove(),this.divBtn=void 0)},e}(),Qh=function(){function e(e){var t=this;this.changeSameAsTableClickHandler=this.onChangeSameAsTable.bind(this),this.removeEvents=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.documentHelper.updateFocus()},this.changeSameAsTable=function(){t.sameAsTableCheckBox.checked?(t.leftMarginBox.enabled=!1,t.rightMarginBox.enabled=!1,t.bottomMarginBox.enabled=!1,t.topMarginBox.enabled=!1):(t.leftMarginBox.enabled=!0,t.rightMarginBox.enabled=!0,t.bottomMarginBox.enabled=!0,t.topMarginBox.enabled=!0)},this.applyTableCellProperties=function(){var e=t.documentHelper.selection.cellFormat;(0,a.isNullOrUndefined)(t.bottomMarginBox.value||t.leftMarginBox.value||t.rightMarginBox.value||t.topMarginBox.value)||e.bottomMargin===t.bottomMarginBox.value&&e.leftMargin===t.leftMarginBox.value&&e.rightMargin===t.rightMarginBox.value&&e.topMargin===t.topMarginBox.value||(t.documentHelper.owner.tablePropertiesDialogModule.isCellOptionsUpdated=!0,t.applyTableOptions(t.cellFormat),t.documentHelper.owner.tablePropertiesDialogModule.applyTableSubProperties()),t.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.documentHelper=e}return Object.defineProperty(e.prototype,"cellFormat",{get:function(){return(0,a.isNullOrUndefined)(this.cellFormatIn)?this.cellFormatIn=new Ma:this.cellFormatIn},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CellOptionsDialog"},e.prototype.onChangeSameAsTable=function(){this.changeSameAsTable()},e.prototype.initCellMarginsDialog=function(t,i){this.owner=this.documentHelper.owner.viewer,this.target=(0,a.createElement)("div",{className:"e-de-table-cell-margin-dlg"}),this.innerDiv=(0,a.createElement)("div"),this.innerDivLabel=(0,a.createElement)("Label",{className:"e-de-para-dlg-heading"}),this.innerDivLabel.innerHTML=t.getConstant("Cell margins"),this.innerDiv.appendChild(this.innerDivLabel),this.table=(0,a.createElement)("TABLE",{styles:"padding-bottom: 8px;padding-top: 8px;",className:"e-de-cell-margin-top"}),this.tr=(0,a.createElement)("tr"),this.td=(0,a.createElement)("td",{className:"e-de-tbl-btn-separator"});var n=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.target.id+"_sameAsCheckBox"});n.setAttribute("aria-label",t.getConstant("Same as the whole table")),this.td.appendChild(n),this.tr.appendChild(this.td),this.table.appendChild(this.tr),this.innerDiv.appendChild(this.table),e.getCellMarginDialogElements(this,this.innerDiv,t,!0),this.divBtn=document.createElement("div"),this.target.appendChild(this.divBtn),this.sameAsTableCheckBox=new tl.CheckBox({label:t.getConstant("Same as the whole table"),change:this.changeSameAsTable,enableRtl:i}),n.setAttribute("aria-label",t.getConstant("Same as the whole table")),this.sameAsTableCheckBox.appendTo(n),this.sameAsTableCheckBox.addEventListener("change",this.changeSameAsTableClickHandler)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initCellMarginsDialog(e,this.documentHelper.owner.enableRtl),this.loadCellMarginsDialog(),this.documentHelper.dialog.header=e.getConstant("Cell Options"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=void 0,this.documentHelper.dialog.open=void 0,this.documentHelper.dialog.close=this.removeEvents,this.documentHelper.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.loadCellMarginsDialog=function(){var e=this.documentHelper.selection.cellFormat;if(this.sameAsTable=(0,a.isNullOrUndefined)(e.leftMargin||e.topMargin||e.rightMargin||e.bottomMargin),this.sameAsTable){var t=this.documentHelper.selection.tableFormat;this.loadCellProperties(t,!1,!0)}else this.loadCellProperties(e,!0,!1)},e.prototype.loadCellProperties=function(e,t,i){this.leftMarginBox.value=e.leftMargin,this.rightMarginBox.value=e.rightMargin,this.topMarginBox.value=e.topMargin,this.bottomMarginBox.value=e.bottomMargin,this.leftMarginBox.enabled=t,this.rightMarginBox.enabled=t,this.topMarginBox.enabled=t,this.bottomMarginBox.enabled=t,this.sameAsTableCheckBox.checked=i},e.prototype.applySubCellOptions=function(e){this.documentHelper.owner.editorHistoryModule.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo)||(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.insertedFormat=e),this.documentHelper.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner),this.applyCellMarginValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner),this.documentHelper.selection.start,this.documentHelper.selection.end,e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1),(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistoryModule.currentHistoryInfo)||this.documentHelper.owner.editorHistoryModule.updateComplexHistory()},e.prototype.applyCellMarginValue=function(e,t,i,n){if(this.applyCellMarginsInternal(e,n),i.paragraph.associatedCell.ownerRow!==e){var r=e.nextWidget;(0,a.isNullOrUndefined)(r)||this.applyCellMarginValue(r,t,i,n)}},e.prototype.applyCellMarginsInternal=function(e,t){if(!(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo)){var i=e.childWidgets[0].cellFormat;t=this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.addModifiedCellOptions(i,t,e.ownerTable)}(0,a.isNullOrUndefined)(t)||this.applyCellMarginsForCells(e,t)},e.prototype.applyCellMarginsForCells=function(e,t){var i=e.childWidgets;this.iterateCells(i,t)},e.prototype.iterateCells=function(e,t){for(var i=0;i<e.length;i++)this.applySubCellMargins(e[parseInt(i.toString(),10)].cellFormat,t);this.documentHelper.owner.tablePropertiesDialogModule.calculateGridValue(e[0].ownerTable)},e.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},e.prototype.applyTableOptions=function(e){this.sameAsTableCheckBox.checked||(e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value)},e.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}this.removeElements(),this.unWireEvents(),this.dialog=void 0,this.target=void 0,this.documentHelper=void 0,this.sameAsTableCheckBox=void 0},e.prototype.removeElements=function(){this.table&&(this.table.remove(),this.table=void 0),this.innerDiv&&(this.innerDiv.remove(),this.innerDiv=void 0),this.innerDivLabel&&(this.innerDivLabel.remove(),this.innerDivLabel=void 0),this.tr&&(this.tr.remove(),this.tr=void 0),this.td&&(this.td.remove(),this.td=void 0),this.divBtn&&(this.divBtn.remove(),this.divBtn=void 0)},e.prototype.unWireEvents=function(){this.sameAsTableCheckBox&&this.sameAsTableCheckBox.removeEventListener("change",this.changeSameAsTableClickHandler)},e.getCellMarginDialogElements=function(e,t,i,n){if(!(0,a.isNullOrUndefined)(e)){var r=(0,a.createElement)("div"),o=(0,a.createElement)("div",{className:"e-de-container-row"}),s=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),l=(0,a.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});s.appendChild(l);var d=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),h=(0,a.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});d.appendChild(h),o.appendChild(s),o.appendChild(d);var c=(0,a.createElement)("div",{className:n?"e-de-dlg-row":"e-de-container-row"}),p=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),u=(0,a.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});p.appendChild(u);var g=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),m=(0,a.createElement)("input",{attrs:{type:"text"},styles:"width:100%"});g.appendChild(m),c.appendChild(p),c.appendChild(g),r.appendChild(o),r.appendChild(c),t.appendChild(r),e.target.appendChild(t),e.topMarginBox=new rl.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Top"),floatLabelType:"Always"}),e.topMarginBox.appendTo(l),e.leftMarginBox=new rl.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Left"),floatLabelType:"Always"}),e.leftMarginBox.appendTo(h),e.bottomMarginBox=new rl.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Bottom"),floatLabelType:"Always"}),e.bottomMarginBox.appendTo(u),e.rightMarginBox=new rl.NumericTextBox({value:0,min:0,max:1584,decimals:2,enablePersistence:!1,placeholder:i.getConstant("Right"),floatLabelType:"Always"}),e.rightMarginBox.appendTo(m),m.setAttribute("aria-labelledby",i.getConstant("Right")),h.setAttribute("aria-labelledby",i.getConstant("Left")),u.setAttribute("aria-labelledby",i.getConstant("Bottom")),l.setAttribute("aria-labelledby",i.getConstant("Top"))}},e}(),$h=function(){function e(e){var t=this;this.selecHandlerClickHandler=this.onSelecHandlerClick.bind(this),this.addNewStyleClickHandler=this.onAddNewStyleClick.bind(this),this.modifyStyleClickHandler=this.onModifyStyleClick.bind(this),this.modifyStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show(t.styleName,t.localValue.getConstant("Modify Style"))},this.selectHandler=function(e){t.styleName=t.getStyleName(e.text)},this.addNewStyles=function(){t.documentHelper.dialog.hide(),t.documentHelper.owner.styleDialogModule.show()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"StylesDialog"},e.prototype.initStylesDialog=function(e,t,i){var n=this.documentHelper.owner.containerId+"_insert_styles";this.target=(0,a.createElement)("div",{id:n,className:"e-de-styles"});var r=e.getConstant("Styles");this.dlgFields=(0,a.createElement)("div",{innerHTML:r,className:"e-de-para-dlg-heading"}),this.target.appendChild(this.dlgFields),this.commonDiv=(0,a.createElement)("div",{className:"e-styles-common"}),this.target.appendChild(this.commonDiv),this.searchDiv=(0,a.createElement)("div",{className:"e-styles-list"}),this.commonDiv.appendChild(this.searchDiv),i&&this.searchDiv.classList.add("e-de-rtl"),this.listviewDiv=(0,a.createElement)("div",{className:"e-styles-listViewDiv",id:"styles_listview"}),this.searchDiv.appendChild(this.listviewDiv),this.listviewInstance=new il.ListView({dataSource:t,cssClass:"e-styles-listview",fields:{text:"StyleName",iconCss:"IconClass"},showIcon:!0}),this.listviewInstance.appendTo(this.listviewDiv),this.listviewInstance.addEventListener("select",this.selecHandlerClickHandler),this.buttonDiv=(0,a.createElement)("div",{className:"e-styles-button"}),this.commonDiv.appendChild(this.buttonDiv),this.newButtonDiv=(0,a.createElement)("div",{className:"e-styles-addbutton"}),this.buttonDiv.appendChild(this.newButtonDiv),this.newButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("New")+"...",id:"new",attrs:{type:"button"}}),this.newButtonDiv.appendChild(this.newButtonElement),this.newbutton=new tl.Button({cssClass:"e-button-custom"}),this.newbutton.appendTo(this.newButtonElement),this.newButtonElement.addEventListener("click",this.addNewStyleClickHandler),this.modifybuttonDiv=(0,a.createElement)("div",{className:"e-styles-addbutton"}),this.buttonDiv.appendChild(this.modifybuttonDiv),this.modifyButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Modify")+"...",id:"modify",attrs:{type:"button"}}),this.modifybuttonDiv.appendChild(this.modifyButtonElement),this.addbutton=new tl.Button({cssClass:"e-button-custom"}),this.addbutton.appendTo(this.modifyButtonElement),this.modifyButtonElement.addEventListener("click",this.modifyStyleClickHandler)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale);for(var t=this.updateStyleNames("Paragraph").filter((function(e){return"Paragraph"===e.Type})),i=this.updateStyleNames("Paragraph").filter((function(e){return"Linked"===e.Type})),n=this.updateStyleNames("Character").filter((function(e){return"Character"===e.Type})),r=0,o=i;r<o.length;r++)for(var s=o[r],l=0,d=n;l<d.length;l++){var h=d[l];if(s.StyleName+" Char"===h.StyleName){n.splice(n.indexOf(h),1);break}}var c=t.concat(i,n);this.localValue=e,this.initStylesDialog(e,c,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.header=e.getConstant("Styles"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.buttons=[{click:this.hideObjects.bind(this),buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.updateStyleNames=function(e){var t=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale);for(var i=this.documentHelper.owner.documentHelper.styles.getStyles(e),n=[],r=0;r<i.length;r++){var o=t.getConstant(i[parseInt(r.toString(),10)].name);""===o&&(o=i[parseInt(r.toString(),10)].name),"Paragraph"===i[parseInt(r.toString(),10)].type?n.push({StyleName:o,IconClass:"e-de-listview-icon e-de-e-paragraph-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type}):"Character"===i[parseInt(r.toString(),10)].type?n.push({StyleName:o,IconClass:"e-de-listview-icon e-de-e-character-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type}):n.push({StyleName:o,IconClass:"e-de-listview-icon e-de-e-linked-style-mark e-icons",Type:i[parseInt(r.toString(),10)].type})}return n},e.prototype.defaultStyleName=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[parseInt(i.toString(),10)]);return t},e.prototype.onModifyStyleClick=function(){this.modifyStyles()},e.prototype.onSelecHandlerClick=function(e){this.selectHandler(e)},e.prototype.getStyleName=function(e){var t=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);return t.setLocale(this.documentHelper.owner.locale),t.getConstant("Heading 1")===e?e="Heading 1":t.getConstant("Heading 2")===e?e="Heading 2":t.getConstant("Heading 3")===e?e="Heading 3":t.getConstant("Heading 4")===e?e="Heading 4":t.getConstant("Heading 5")===e?e="Heading 5":t.getConstant("Heading 6")===e?e="Heading 6":t.getConstant("Normal")===e?e="Normal":t.getConstant("Header")===e?e="Header":t.getConstant("Footer")===e&&(e="Footer"),e},e.prototype.hideObjects=function(){this.documentHelper.dialog.hide(),this.documentHelper.updateFocus()},e.prototype.onAddNewStyleClick=function(){this.addNewStyles()},e.prototype.destroy=function(){this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.removeEvents(),this.removeElements(),this.documentHelper=void 0,this.styleName=void 0,this.localValue=void 0,this.target=void 0},e.prototype.removeEvents=function(){this.newButtonElement&&this.newButtonElement.removeEventListener("click",this.addNewStyleClickHandler),this.modifyButtonElement&&this.modifyButtonElement.removeEventListener("click",this.modifyStyleClickHandler),this.listviewInstance&&this.listviewInstance.removeEventListener("select",this.selecHandlerClickHandler)},e.prototype.removeElements=function(){this.dlgFields&&(this.dlgFields.remove(),this.dlgFields=void 0),this.commonDiv&&(this.commonDiv.remove(),this.commonDiv=void 0),this.searchDiv&&(this.searchDiv.remove(),this.searchDiv=void 0),this.listviewDiv&&(this.listviewDiv.remove(),this.listviewDiv=void 0),this.buttonDiv&&(this.buttonDiv.remove(),this.buttonDiv=void 0),this.newButtonDiv&&(this.newButtonDiv.remove(),this.newButtonDiv=void 0),this.newButtonElement&&(this.newButtonElement.remove(),this.newButtonElement=void 0),this.newbutton&&(this.newbutton.destroy(),this.newbutton=void 0),this.modifybuttonDiv&&(this.modifybuttonDiv.remove(),this.modifybuttonDiv=void 0),this.modifyButtonElement&&(this.modifyButtonElement.remove(),this.modifyButtonElement=void 0),this.addbutton&&(this.addbutton.destroy(),this.addbutton=void 0)},e}(),ec=function(){function e(e){var t=this;this.ignoreClickHandler=this.onIgnoreClick.bind(this),this.ignoreAllClickHandler=this.onIgnoreAllClick.bind(this),this.addToDictClickHandler=this.onAddToDictClick.bind(this),this.selectHandlerClickHandler=this.onSelectHandlerClick.bind(this),this.changeButtonClickHandler=this.onChangeButtonClick.bind(this),this.onChangeAllButtonClickHandler=this.onChangeAllButtonClick.bind(this),this.selectHandler=function(e){t.selectedText=e.text},this.onCancelButtonClick=function(){t.documentHelper.clearSelectionHighlight(),t.documentHelper.hideDialog()},this.onIgnoreClicked=function(){(0,a.isNullOrUndefined)(t.elementBox)||((0,el.showSpinner)(t.documentHelper.dialog.element),t.parent.spellCheckerModule.manageReplace("Ignore Once",t.elementBox),t.removeErrors(),t.parent.spellCheckerModule.checkForNextError(),(0,el.hideSpinner)(t.documentHelper.dialog.element))},this.onIgnoreAllClicked=function(){if(!(0,a.isNullOrUndefined)(t.elementBox)){(0,el.showSpinner)(t.documentHelper.dialog.element);var e=t.elementBox.text;t.parent.spellCheckerModule.handleIgnoreAllItems({element:t.elementBox,text:e}),t.parent.spellCheckerModule.checkForNextError(),(0,el.hideSpinner)(t.documentHelper.dialog.element)}},this.addToDictClicked=function(){(0,a.isNullOrUndefined)(t.elementBox)||((0,el.showSpinner)(t.documentHelper.dialog.element),t.parent.spellCheckerModule.handleAddToDictionary({element:t.elementBox,text:t.elementBox.text}),t.parent.spellCheckerModule.errorWordCollection.containsKey(t.errorText)&&t.parent.spellCheckerModule.errorWordCollection.remove(t.errorText),t.parent.spellCheckerModule.checkForNextError(),t.documentHelper.hideDialog())},this.changeButtonClicked=function(){(0,a.isNullOrUndefined)(t.selectedText)||(t.isSpellChecking=!0,(0,el.showSpinner)(t.documentHelper.dialog.element),t.parent.spellCheckerModule.manageReplace(t.selectedText,t.elementBox),t.removeErrors(),t.parent.spellCheckerModule.checkForNextError(),(0,el.hideSpinner)(t.documentHelper.dialog.element),t.selectedText=void 0)},this.changeAllButtonClicked=function(){if(!(0,a.isNullOrUndefined)(t.selectedText)){t.isSpellChecking=!0,t.parent.spellCheckerModule.isChangeAll=!0,(0,el.showSpinner)(t.documentHelper.dialog.element);for(var e=t.parent.spellCheckerModule.errorWordCollection.get(t.errorText),i=e.length-1;i>=0;i--)if(e[i]instanceof Ql&&!e[i].ischangeDetected)t.parent.spellCheckerModule.manageReplace(t.selectedText,e[i]);else if(e[i]instanceof Zl){var n=t.parent.spellCheckerModule.getMatchedResultsFromElement(e[i]),r=n.textResults,o=e[i].ischangeDetected?e[i].start.offset:e[i].line.getOffset(e[i],0);t.parent.searchModule.textSearch.updateMatchedTextLocation(n.matches,r,n.elementInfo,0,e[i],!1,null,o);for(var s=0;s<r.length;s++){var l=t.parent.spellCheckerModule.createErrorElementWithInfo(r.innerList[s],e[i]);t.parent.spellCheckerModule.manageReplace(t.selectedText,l)}}t.parent.spellCheckerModule.errorWordCollection.containsKey(t.errorText)&&t.parent.spellCheckerModule.errorWordCollection.remove(t.errorText),t.parent.spellCheckerModule.checkForNextError(),t.documentHelper.hideDialog(),(0,el.hideSpinner)(t.documentHelper.dialog.element),t.parent.spellCheckerModule.isChangeAll=!1,t.selectedText=void 0}},this.documentHelper=e,(0,el.createSpinner)({target:this.documentHelper.dialog.element,cssClass:"e-spin-overlay"})}return Object.defineProperty(e.prototype,"parent",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"SpellCheckDialog"},e.prototype.onSelectHandlerClick=function(e){this.selectHandler(e)},e.prototype.onIgnoreClick=function(){this.onIgnoreClicked()},e.prototype.removeErrors=function(){if(!(0,a.isNullOrUndefined)(this.errorText)&&this.parent.spellCheckerModule.errorWordCollection.containsKey(this.errorText)){var e=this.parent.spellCheckerModule.errorWordCollection.get(this.errorText);e.splice(0,1),0===e.length&&this.parent.spellCheckerModule.errorWordCollection.remove(this.errorText)}0===this.parent.spellCheckerModule.errorWordCollection.length&&this.documentHelper.hideDialog()},e.prototype.onIgnoreAllClick=function(){this.onIgnoreAllClicked()},e.prototype.onAddToDictClick=function(){this.addToDictClicked()},e.prototype.onChangeButtonClick=function(){this.changeButtonClicked()},e.prototype.onChangeAllButtonClick=function(){this.changeAllButtonClicked()},e.prototype.show=function(e,t){this.target=void 0,this.localValue=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localValue.setLocale(this.documentHelper.owner.locale),this.target||this.updateSuggestionDialog(e,t)},e.prototype.updateSuggestionDialog=function(e,t){var i,n=this;this.elementBox=t,this.isSpellChecking?this.parent.spellCheckerModule.callSpellChecker(this.parent.spellCheckerModule.languageID,e,!1,!0).then((function(t){var r=JSON.parse(t);i=r.Suggestions,n.isSpellChecking=!1,n.handleRetrievedSuggestion(e,i)})):(e=this.parent.spellCheckerModule.manageSpecialCharacters(e,void 0,!0),i=this.parent.spellCheckerModule.errorSuggestions.containsKey(e)?this.parent.spellCheckerModule.errorSuggestions.get(e):[],this.handleRetrievedSuggestion(e,i))},e.prototype.handleRetrievedSuggestion=function(e,t){e=this.parent.spellCheckerModule.manageSpecialCharacters(e,void 0,!0),this.initSpellCheckDialog(this.localValue,e,t),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=this.localValue.getConstant("Spelling Editor"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.onCancelButtonClick,buttonModel:{content:this.localValue.getConstant("Cancel"),cssClass:"e-control e-flat",isPrimary:!0}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),(0,el.hideSpinner)(this.documentHelper.dialog.element)},e.prototype.initSpellCheckDialog=function(e,t,i,n){var r=this.documentHelper.owner.containerId+"_add_SpellCheck";this.target=(0,a.createElement)("div",{id:r,className:"e-de-insert-spellchecker"}),this.errorText=t,this.textContainer=(0,a.createElement)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Spelling")}),this.target.appendChild(this.textContainer),this.spellContainer=(0,a.createElement)("div",{className:"e-de-spellcheck-error-container"}),this.listviewDiv=(0,a.createElement)("div",{className:"e-de-dlg-spellcheck-listview"}),this.spellContainer.appendChild(this.listviewDiv),this.spellingListView=new il.ListView({dataSource:[t],cssClass:"e-dlg-spellcheck-listitem"}),this.spellingListView.appendTo(this.listviewDiv),this.buttonDiv=(0,a.createElement)("div",{className:"e-de-spellcheck-btncontainer"}),this.spellContainer.appendChild(this.buttonDiv),this.ignoreButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Ignore")}),this.buttonDiv.appendChild(this.ignoreButtonElement),this.ignoreButtonElement.setAttribute("aria-label",e.getConstant("Ignore")),this.ignorebutton=new tl.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}),this.ignorebutton.appendTo(this.ignoreButtonElement),this.ignoreButtonElement.addEventListener("click",this.ignoreClickHandler),this.ignoreAllButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Ignore All")}),this.ignoreAllButtonElement.setAttribute("aria-label",e.getConstant("Ignore All")),this.buttonDiv.appendChild(this.ignoreAllButtonElement),this.ignoreAllbutton=new tl.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}),this.ignoreAllbutton.appendTo(this.ignoreAllButtonElement),this.ignoreAllButtonElement.addEventListener("click",this.ignoreAllClickHandler),this.addDictButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Add to Dictionary")}),this.addDictButtonElement.setAttribute("aria-label",e.getConstant("Add to Dictionary")),this.buttonDiv.appendChild(this.addDictButtonElement),this.addDictButton=new tl.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}),this.addDictButton.appendTo(this.addDictButtonElement),this.addDictButtonElement.addEventListener("click",this.addToDictClickHandler),this.target.appendChild(this.spellContainer),this.suggestionDiv=(0,a.createElement)("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Suggestions")}),this.target.appendChild(this.suggestionDiv),this.suggestionContainer=(0,a.createElement)("div",{className:"e-de-spellcheck-suggestion-container"}),this.target.appendChild(this.suggestionContainer),this.suggestListDiv=(0,a.createElement)("div",{className:"e-de-dlg-spellcheck-listview"}),this.suggestListDiv.setAttribute("aria-label",e.getConstant("Suggestions")),this.suggestionContainer.appendChild(this.suggestListDiv),this.suggestionListView=new il.ListView({dataSource:i,cssClass:"e-dlg-spellcheck-listitem"}),this.suggestionListView.appendTo(this.suggestListDiv),this.suggestionListView.addEventListener("select",this.selectHandlerClickHandler),this.suggestBtnContainder=(0,a.createElement)("div",{className:"e-de-spellcheck-btncontainer"}),this.suggestionContainer.appendChild(this.suggestBtnContainder),this.changeButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Change")}),this.changeButtonElement.setAttribute("aria-label",e.getConstant("Change")),this.suggestBtnContainder.appendChild(this.changeButtonElement),this.changeButton=new tl.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}),this.changeButton.appendTo(this.changeButtonElement),this.changeButtonElement.addEventListener("click",this.changeButtonClickHandler),this.changeAllButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Change All")}),this.changeAllButtonElement.setAttribute("aria-label",e.getConstant("Change All")),this.suggestBtnContainder.appendChild(this.changeAllButtonElement),this.changeAllbutton=new tl.Button({cssClass:"e-control e-de-ok-button e-de-spellcheck-btn"}),this.changeAllbutton.appendTo(this.changeAllButtonElement),this.changeAllButtonElement.addEventListener("click",this.onChangeAllButtonClickHandler),((0,a.isNullOrUndefined)(i)||0===i.length)&&(this.changeButton.disabled=!0,this.changeAllbutton.disabled=!0)},e.prototype.destroy=function(){this.target&&(this.target.remove(),this.target=void 0),this.elementBox&&(this.elementBox.destroy(),this.elementBox=void 0),this.documentHelper=void 0,this.spellingListView&&(this.spellingListView.destroy(),this.spellingListView=void 0),this.suggestionListView&&(this.suggestionListView.destroy(),this.suggestionListView=void 0),this.selectedText=void 0,this.removeEvents(),this.removeElements()},e.prototype.removeEvents=function(){this.ignoreButtonElement&&this.ignoreButtonElement.removeEventListener("click",this.ignoreClickHandler),this.ignoreAllButtonElement&&this.ignoreAllButtonElement.removeEventListener("click",this.ignoreAllClickHandler),this.addDictButtonElement&&this.addDictButtonElement.removeEventListener("click",this.addToDictClickHandler),this.changeButtonElement&&this.changeButtonElement.removeEventListener("click",this.changeButtonClickHandler),this.changeAllButtonElement&&this.changeAllButtonElement.removeEventListener("click",this.onChangeAllButtonClickHandler),this.suggestionListView&&this.suggestionListView.removeEventListener("select",this.selectHandlerClickHandler)},e.prototype.removeElements=function(){this.textContainer&&(this.textContainer.remove(),this.textContainer=void 0),this.spellContainer&&(this.spellContainer.remove(),this.spellContainer=void 0),this.listviewDiv&&(this.listviewDiv.remove(),this.listviewDiv=void 0),this.buttonDiv&&(this.buttonDiv.remove(),this.buttonDiv=void 0),this.ignoreButtonElement&&(this.ignoreButtonElement.remove(),this.ignoreButtonElement=void 0),this.ignorebutton&&(this.ignorebutton.destroy(),this.ignorebutton=void 0),this.ignoreAllButtonElement&&(this.ignoreAllButtonElement.remove(),this.ignoreAllButtonElement=void 0),this.ignoreAllbutton&&(this.ignoreAllbutton.destroy(),this.ignoreAllbutton=void 0),this.addDictButtonElement&&(this.addDictButtonElement.remove(),this.addDictButtonElement=void 0),this.addDictButton&&(this.addDictButton.destroy(),this.addDictButton=void 0),this.suggestionDiv&&(this.suggestionDiv.remove(),this.suggestionDiv=void 0),this.suggestionContainer&&(this.suggestionContainer.remove(),this.suggestionContainer=void 0),this.suggestListDiv&&(this.suggestListDiv.remove(),this.suggestListDiv=void 0),this.suggestBtnContainder&&(this.suggestBtnContainder.remove(),this.suggestBtnContainder=void 0),this.changeButtonElement&&(this.changeButtonElement.remove(),this.changeButtonElement=void 0),this.changeButton&&(this.changeButton.destroy(),this.changeButton=void 0),this.changeAllButtonElement&&(this.changeAllButtonElement.remove(),this.changeAllButtonElement=void 0),this.changeAllbutton&&(this.changeAllbutton.destroy(),this.changeAllbutton=void 0)},e}(),tc=function(){function e(e){var t=this;this.changeBidirectional=function(e){"exact"===e.value?(t.autoButton.checked=!t.exactButton.checked,t.exactlyNumber.enabled=!0):(t.exactButton.checked=!t.autoButton.checked,t.exactlyNumber.enabled=!1)},this.changeBidirect=function(e){"check"===e.value?t.notCheckedButton.checked=!t.checkedButton.checked:t.checkedButton.checked=!t.notCheckedButton.checked},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertCheckBoxField=function(){t.closeCheckBoxField();var e=new Kl;e.defaultValue=t.checkedButton.checked,e.name=t.bookmarkInputText.value,e.helpText=t.tooltipInputText.value,e.checked=e.defaultValue,e.enabled=t.checBoxEnableElement.checked,t.exactButton.checked?(e.sizeType="Exactly",e.size=t.exactlyNumber.value):(e.sizeType="Auto",e.size=11),t.owner.editorModule.editFormField("CheckBox",e)},this.closeCheckBoxField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CheckBoxFormFieldDialog"},e.prototype.initCheckBoxDialog=function(e,t){this.target=(0,a.createElement)("div"),this.dialogDiv=(0,a.createElement)("div"),this.headingLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Check box size")}),this.sizeParentDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.autoDiv=(0,a.createElement)("div",{className:"e-de-ff-radio-scnd-div"}),this.exactDiv=(0,a.createElement)("div",{className:"e-de-ff-radio-scnd-div"}),this.autoEle=(0,a.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Auto")}}),this.exactEle=(0,a.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Exactly")}}),this.autoButton=new tl.RadioButton({label:e.getConstant("Auto"),cssClass:"e-small",change:this.changeBidirectional,checked:!0,enableRtl:t}),this.exactButton=new tl.RadioButton({label:e.getConstant("Exactly"),value:"exact",cssClass:"e-small",change:this.changeBidirectional,enableRtl:t}),this.exactNumberDiv=(0,a.createElement)("div",{className:"e-de-ff-chck-exact"}),this.exactNumber=(0,a.createElement)("input",{attrs:{type:"text","aria-label":e.getConstant("Exactly")}}),this.exactlyNumber=new rl.NumericTextBox({format:"n",value:10,min:1,max:1584,enablePersistence:!1,enabled:!1,cssClass:"e-de-check-exactnumbr-width",enableRtl:t}),this.defaultValueLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Default value")}),this.defaultcheckDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.notcheckDiv=(0,a.createElement)("div",{className:"e-de-ff-radio-div"}),this.checkDiv=(0,a.createElement)("div",{className:"e-de-ff-radio-div"}),this.notcheckEle=(0,a.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Not checked")}}),this.checkEle=(0,a.createElement)("input",{className:"e-de-rtl-btn-div",attrs:{"aria-label":e.getConstant("Checked")}}),this.notCheckedButton=new tl.RadioButton({label:e.getConstant("Not checked"),enableRtl:t,cssClass:"e-small",change:this.changeBidirect}),this.checkedButton=new tl.RadioButton({label:e.getConstant("Checked"),value:"check",enableRtl:t,cssClass:"e-small",change:this.changeBidirect,checked:!0}),this.fieldSettingsLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")}),this.settingsTotalDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.totalToolTipDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.totalBookmarkDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.tooltipInputText=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input",attrs:{"aira-label":e.getConstant("Tooltip")}}),this.bookmarkInputText=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input",attrs:{"aira-label":e.getConstant("Name")}}),this.checkBoxEnableDiv=(0,a.createElement)("div"),this.checBoxEnableEle=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.checBoxEnableEle.setAttribute("aria-label",e.getConstant("Check box enabled")),this.checBoxEnableElement=new tl.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Check box enabled"),enableRtl:t}),t&&(this.autoDiv.classList.add("e-de-rtl"),this.exactDiv.classList.add("e-de-rtl"),this.exactNumberDiv.classList.add("e-de-rtl"),this.notcheckDiv.classList.add("e-de-rtl"),this.checkDiv.classList.add("e-de-rtl"),this.totalToolTipDiv.classList.add("e-de-rtl"),this.totalBookmarkDiv.classList.add("e-de-rtl")),this.target.appendChild(this.dialogDiv),this.dialogDiv.appendChild(this.defaultValueLabel),this.dialogDiv.appendChild(this.defaultcheckDiv),this.defaultcheckDiv.appendChild(this.notcheckDiv),this.notcheckDiv.appendChild(this.notcheckEle),this.notCheckedButton.appendTo(this.notcheckEle),this.defaultcheckDiv.appendChild(this.checkDiv),this.checkDiv.appendChild(this.checkEle),this.checkedButton.appendTo(this.checkEle),this.dialogDiv.appendChild(this.headingLabel),this.dialogDiv.appendChild(this.sizeParentDiv),this.sizeParentDiv.appendChild(this.autoDiv),this.autoDiv.appendChild(this.autoEle),this.autoButton.appendTo(this.autoEle),this.sizeParentDiv.appendChild(this.exactDiv),this.exactDiv.appendChild(this.exactEle),this.exactButton.appendTo(this.exactEle),this.exactDiv.appendChild(this.exactNumberDiv),this.exactNumberDiv.appendChild(this.exactNumber),this.exactlyNumber.appendTo(this.exactNumber),this.dialogDiv.appendChild(this.fieldSettingsLabel),this.dialogDiv.appendChild(this.settingsTotalDiv),this.settingsTotalDiv.appendChild(this.totalToolTipDiv),this.settingsTotalDiv.appendChild(this.totalBookmarkDiv),this.totalToolTipDiv.appendChild(this.tooltipInputText),this.totalBookmarkDiv.appendChild(this.bookmarkInputText),this.dialogDiv.appendChild(this.checkBoxEnableDiv),this.checkBoxEnableDiv.appendChild(this.checBoxEnableEle),this.checBoxEnableElement.appendTo(this.checBoxEnableEle),new rl.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInputText),new rl.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInputText)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),(0,a.isNullOrUndefined)(this.target)&&this.initCheckBoxDialog(e,this.documentHelper.owner.enableRtl),this.loadCheckBoxDialog(),this.documentHelper.dialog.header=e.getConstant("Check Box Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="400px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertCheckBoxField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.loadCheckBoxDialog=function(){var e=this.owner.selectionModule.getCurrentFormField();if(e instanceof _l){this.fieldBegin=e;var t=this.fieldBegin.formFieldData;t.defaultValue?(this.checkedButton.checked=!0,this.notCheckedButton.checked=!1):(this.checkedButton.checked=!1,this.notCheckedButton.checked=!0),"Auto"!==t.sizeType?(this.exactButton.checked=!0,this.autoButton.checked=!1,this.exactlyNumber.enabled=!0):(this.autoButton.checked=!0,this.exactButton.checked=!1,this.exactlyNumber.enabled=!1),t.size&&(this.exactlyNumber.value=t.size),t.enabled?this.checBoxEnableElement.checked=!0:this.checBoxEnableElement.checked=!1,t.name&&""!==t.name?this.bookmarkInputText.value=t.name:this.bookmarkInputText.value="",t.helpText&&""!==t.helpText?this.tooltipInputText.value=t.helpText:this.tooltipInputText.value=""}},e.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.autoButton&&(this.autoButton.destroy(),this.autoButton=void 0),this.exactButton&&(this.exactButton.destroy(),this.exactButton=void 0),this.notCheckedButton&&(this.notCheckedButton.destroy(),this.notCheckedButton=void 0),this.checkedButton&&(this.checkedButton.destroy(),this.checkedButton=void 0),this.bookmarkInputText=void 0,this.tooltipInputText=void 0,this.checBoxEnableElement&&(this.checBoxEnableElement.destroy(),this.checBoxEnableElement=void 0),this.exactlyNumber&&(this.exactlyNumber.destroy(),this.exactlyNumber=void 0),this.exactNumberDiv=void 0,this.removeElements()},e.prototype.removeElements=function(){this.dialogDiv&&(this.dialogDiv.remove(),this.dialogDiv=void 0),this.headingLabel&&(this.headingLabel.remove(),this.headingLabel=void 0),this.sizeParentDiv&&(this.sizeParentDiv.remove(),this.sizeParentDiv=void 0),this.autoDiv&&(this.autoDiv.remove(),this.autoDiv=void 0),this.exactDiv&&(this.exactDiv.remove(),this.exactDiv=void 0),this.autoEle&&(this.autoEle.remove(),this.autoEle=void 0),this.exactEle&&(this.exactEle.remove(),this.exactEle=void 0),this.exactNumber&&(this.exactNumber.remove(),this.exactNumber=void 0),this.defaultValueLabel&&(this.defaultValueLabel.remove(),this.defaultValueLabel=void 0),this.defaultcheckDiv&&(this.defaultcheckDiv.remove(),this.defaultcheckDiv=void 0),this.notcheckDiv&&(this.notcheckDiv.remove(),this.notcheckDiv=void 0),this.checkDiv&&(this.checkDiv.remove(),this.checkDiv=void 0),this.notcheckEle&&(this.notcheckEle.remove(),this.notcheckEle=void 0),this.checkEle&&(this.checkEle.remove(),this.checkEle=void 0),this.checkBoxEnableDiv&&(this.checkBoxEnableDiv.remove(),this.checkBoxEnableDiv=void 0),this.checBoxEnableEle&&(this.checBoxEnableEle.remove(),this.checBoxEnableEle=void 0),this.fieldSettingsLabel&&(this.fieldSettingsLabel.remove(),this.fieldSettingsLabel=void 0),this.settingsTotalDiv&&(this.settingsTotalDiv.remove(),this.settingsTotalDiv=void 0),this.totalToolTipDiv&&(this.totalToolTipDiv.remove(),this.totalToolTipDiv=void 0),this.totalBookmarkDiv&&(this.totalBookmarkDiv.remove(),this.totalBookmarkDiv=void 0)},e}(),ic=function(){function e(e){var t=this;this.updateTextFormtas=function(){var e=t.updateFormats(t.defaultTextInput.value);t.defaultTextInput.value=(0,a.isNullOrUndefined)(e)?"":e},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertTextField=function(){var e=!0;if("Date"===t.typeDropDown.value&&(e=t.isValidDateFormat()),e)if(t.updateTextFormtas(),t.defaultTextInput.value.length>t.maxLengthNumber.value&&!(0,a.isNullOrUndefined)(t.maxLengthNumber.value)&&0!==t.maxLengthNumber.value)el.DialogUtility.alert({content:"The maximum length value must be equal or greater than the length of the default text.",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=t.owner.enableRtl;else{var i=void 0;i="Date"===t.typeDropDown.value?"Date":"Number"===t.typeDropDown.value?"Number":"Text";var n=a.SanitizeHtmlHelper.sanitize(t.textFormatDropDown.value),r=new Gl;r.type=i,r.defaultValue=t.defaultTextInput.value,r.maxLength=t.maxLengthNumber.value,r.format=(0,a.isNullOrUndefined)(n)?"":n,r.name=t.bookmarkTextInput.value,r.helpText=t.tooltipTextInput.value,r.enabled=t.fillInEnable.checked,t.owner.editorModule.editFormField("Text",r),t.closeTextField()}else el.DialogUtility.alert({content:"A valid date or time is required",showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=t.owner.enableRtl},this.closeTextField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TextFormFieldDialog"},e.prototype.initTextDialog=function(e,t){var i=this;this.target=(0,a.createElement)("div"),this.dialogDiv=(0,a.createElement)("div"),this.firstDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.typeDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.defaultTextDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"});var n=[{Value:"Regular text",Name:e.getConstant("Regular text")},{Value:"Number",Name:e.getConstant("Number")},{Value:"Date",Name:e.getConstant("Date")}];this.typeDropDownList=(0,a.createElement)("input"),this.typeDropDown=new al.DropDownList({dataSource:n,popupHeight:"150px",value:"Regular text",change:this.changeTypeDropDown.bind(this),floatLabelType:"Always",placeholder:e.getConstant("Type"),fields:{text:"Name",value:"Value"},htmlAttributes:{"aria-labelledby":e.getConstant("Type")}}),this.defaultTextInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.secondDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.maxLengthDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.maxLength=(0,a.createElement)("input",{attrs:{"aria-labelledby":e.getConstant("Maximum length")}}),this.maxLengthNumber=new rl.NumericTextBox({format:"n",value:0,min:0,max:32767,width:"100%",enablePersistence:!1,placeholder:e.getConstant("Maximum length"),floatLabelType:"Always",change:function(t){t.value||(this.element.value=e.getConstant("Unlimited"))},focus:function(t){t.value||(this.element.value=e.getConstant("Unlimited"))},blur:function(t){if(!t.value){var i=this;setTimeout((function(){i.element.value=e.getConstant("Unlimited")}),0)}}}),this.textFromatDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.textFormatList=(0,a.createElement)("input");var r=[{Value:"Uppercase",Name:e.getConstant("Uppercase")},{Value:"Lowercase",Name:e.getConstant("Lowercase")},{Value:"FirstCapital",Name:e.getConstant("FirstCapital")},{Value:"Titlecase",Name:e.getConstant("TitleCase")}];this.textFormatDropDown=new al.ComboBox({dataSource:r,popupHeight:"150px",allowCustom:!0,showClearButton:!1,change:this.updateTextFormtas.bind(this),placeholder:e.getConstant("Text format"),floatLabelType:"Always",fields:{text:"Name",value:"Value"}}),this.textFormatDropDown.focus=function(){i.textFormatDropDown.element.select()},this.fileSettingsLabel=(0,a.createElement)("div",{className:"e-de-ff-dlg-heading",innerHTML:e.getConstant("Field settings")}),this.thirdDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.toolTipTotalDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.bookmarkTotalDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.tooltipTextInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkTextInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.fillInEnableDiv=(0,a.createElement)("div"),this.fillInEnableEle=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.fillInEnableEle.setAttribute("aria-label",e.getConstant("Fillin enabled")),this.fillInEnable=new tl.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Fillin enabled"),enableRtl:t}),t&&(this.typeDiv.classList.add("e-de-rtl"),this.maxLengthDiv.classList.add("e-de-rtl"),this.toolTipTotalDiv.classList.add("e-de-rtl"),this.bookmarkTotalDiv.classList.add("e-de-rtl")),this.target.appendChild(this.dialogDiv),this.dialogDiv.appendChild(this.firstDiv),this.firstDiv.appendChild(this.typeDiv),this.typeDiv.appendChild(this.typeDropDownList),this.typeDropDown.appendTo(this.typeDropDownList),this.firstDiv.appendChild(this.defaultTextDiv),this.defaultTextDiv.appendChild(this.defaultTextInput),this.dialogDiv.appendChild(this.secondDiv),this.secondDiv.appendChild(this.maxLengthDiv),this.maxLengthDiv.appendChild(this.maxLength),this.maxLengthNumber.appendTo(this.maxLength),this.secondDiv.appendChild(this.textFromatDiv),this.textFromatDiv.appendChild(this.textFormatList),this.textFormatDropDown.appendTo(this.textFormatList),this.dialogDiv.appendChild(this.fileSettingsLabel),this.dialogDiv.appendChild(this.thirdDiv),this.thirdDiv.appendChild(this.toolTipTotalDiv),this.toolTipTotalDiv.appendChild(this.tooltipTextInput),this.thirdDiv.appendChild(this.bookmarkTotalDiv),this.bookmarkTotalDiv.appendChild(this.bookmarkTextInput),this.dialogDiv.appendChild(this.fillInEnableDiv),this.fillInEnableDiv.appendChild(this.fillInEnableEle),this.fillInEnable.appendTo(this.fillInEnableEle),this.defaultTextLabel=new rl.TextBox({placeholder:e.getConstant("Default text"),floatLabelType:"Always"},this.defaultTextInput),new rl.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipTextInput),new rl.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always",htmlAttributes:{"aria-labelledby":e.getConstant("Name")}},this.bookmarkTextInput),this.defaultTextInput.setAttribute("aria-labelledby",e.getConstant("Default text")),this.tooltipTextInput.setAttribute("aria-labelledby",e.getConstant("Tooltip")),this.bookmarkTextInput.setAttribute("aria-labelledby",e.getConstant("Name"))},e.prototype.show=function(){this.localObj=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localObj.setLocale(this.documentHelper.owner.locale),(0,a.isNullOrUndefined)(this.target)&&this.initTextDialog(this.localObj,this.documentHelper.owner.enableRtl),this.loadTextDialog(this.localObj),this.documentHelper.dialog.header=this.localObj.getConstant("Text Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertTextField,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.changeTypeDropDown=function(e){e.isInteracted&&(this.defaultTextInput.value="",this.textFormatDropDown.value=""),"Regular text"===e.value?(this.textFormatDropDown.fields={text:"Name",value:"Value"},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default text"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Text format"),this.textFormatDropDown.dataSource=[{Value:"Uppercase",Name:this.localObj.getConstant("Uppercase")},{Value:"Lowercase",Name:this.localObj.getConstant("Lowercase")},{Value:"FirstCapital",Name:this.localObj.getConstant("FirstCapital")},{Value:"Titlecase",Name:this.localObj.getConstant("TitleCase")}]):"Number"===e.value?(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default number"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Number format"),this.textFormatDropDown.dataSource=["0","0.00","#,##0","#,##0.00","$#,##0.00;($#,##0.00)","0%"]):"Date"===e.value&&(this.textFormatDropDown.fields={text:null,value:null},this.defaultTextLabel.placeholder=this.localObj.getConstant("Default date"),this.textFormatDropDown.placeholder=this.localObj.getConstant("Date format"),this.textFormatDropDown.dataSource=["M/d/yyyy","dddd, MMMM d, yyyy","MMMM d, yyyy","M/d/yy","yyyy-MM-dd","d-MMM-yy","M.d.yyyy","MMM. d, yy","d MMMM yyyy","MMMM yy","MMM-yy","M/d/yyyy h:mm am/pm","M/d/yyyy h:mm:ss am/pm","h:mm am/pm","h:mm:ss am/pm","HH:mm","HH:mm:ss"]),this.defaultTextLabel.dataBind(),this.textFormatDropDown.dataBind()},e.prototype.loadTextDialog=function(e){var t=this.owner.selectionModule.getCurrentFormField();if(t instanceof _l){this.fieldBegin=t;var i=t.formFieldData;i.maxLength>0?this.maxLengthNumber.value=i.maxLength:(this.maxLengthNumber.value=0,this.maxLengthNumber.element.value=e?e.getConstant("Unlimited"):"Unlimited"),"Date"===i.type?this.typeDropDown.value="Date":"Number"===i.type?this.typeDropDown.value="Number":this.typeDropDown.value="Regular text",i.format?this.textFormatDropDown.value=i.format:this.textFormatDropDown.value="",this.defaultTextInput.value=(0,a.isNullOrUndefined)(i.defaultValue)?"":i.defaultValue,this.fillInEnable.checked=i.enabled,this.tooltipTextInput.value=(0,a.isNullOrUndefined)(i.helpText)?"":i.helpText,this.bookmarkTextInput.value=(0,a.isNullOrUndefined)(i.name)?"":i.name}},e.prototype.updateFormats=function(e){var t=(0,a.isNullOrUndefined)(this.textFormatDropDown.value)?"":this.textFormatDropDown.value.toString();if("Regular text"===this.typeDropDown.value)return Pa.formatText(t,e);if("Number"===this.typeDropDown.value){var i=Pa.formatNumber(t,e);return"NaN"!==i.toString()?i:""}return"Date"===this.typeDropDown.value?Pa.formatDate(t,e):""},e.prototype.isValidDateFormat=function(){var e=this.defaultTextInput.value;if(""!==e){var t=new Date(e);if(isNaN(t.getDate()))return!1}return!0},e.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.maxLengthNumber&&(this.maxLengthNumber.destroy(),this.maxLengthNumber=void 0),this.fillInEnable&&(this.fillInEnable.destroy(),this.fillInEnable=void 0),this.typeDropDown&&(this.typeDropDown.destroy(),this.typeDropDown=void 0),this.textFormatDropDown&&(this.textFormatDropDown.destroy(),this.textFormatDropDown=void 0),this.owner=void 0,this.defaultTextInput=void 0,this.tooltipTextInput=void 0,this.bookmarkTextInput=void 0,this.defaultTextLabel=void 0,this.defaultTextDiv=void 0,this.textFormatLabel=void 0,this.removeElements()},e.prototype.removeElements=function(){this.dialogDiv&&(this.dialogDiv.remove(),this.dialogDiv=void 0),this.firstDiv&&(this.firstDiv.remove(),this.firstDiv=void 0),this.typeDiv&&(this.typeDiv.remove(),this.typeDiv=void 0),this.typeDropDownList&&(this.typeDropDownList.remove(),this.typeDropDownList=void 0),this.secondDiv&&(this.secondDiv.remove(),this.secondDiv=void 0),this.maxLengthDiv&&(this.maxLengthDiv.remove(),this.maxLengthDiv=void 0),this.maxLength&&(this.maxLength.remove(),this.maxLength=void 0),this.textFromatDiv&&(this.textFromatDiv.remove(),this.textFromatDiv=void 0),this.textFormatList&&(this.textFormatList.remove(),this.textFormatList=void 0),this.fileSettingsLabel&&(this.fileSettingsLabel.remove(),this.fileSettingsLabel=void 0),this.thirdDiv&&(this.thirdDiv.remove(),this.thirdDiv=void 0),this.toolTipTotalDiv&&(this.toolTipTotalDiv.remove(),this.toolTipTotalDiv=void 0),this.bookmarkTotalDiv&&(this.bookmarkTotalDiv.remove(),this.bookmarkTotalDiv=void 0),this.fillInEnableDiv&&(this.fillInEnableDiv.remove(),this.fillInEnableDiv=void 0),this.fillInEnableEle&&(this.fillInEnableEle.remove(),this.fillInEnableEle=void 0)},e}(),nc=function(){function e(e){var t=this;this.moveDownItemClickHandler=this.onMouseDownItemClick.bind(this),this.keyUpOnTextBoxClickHandler=this.onKeyUpOnTextBoxClick.bind(this),this.addItemtoListClickHandler=this.onAddItemtoListClick.bind(this),this.moveUpItemClickHandler=this.onMoveUpItemClick.bind(this),this.removeItemFromListClickHandler=this.onRemoveItemFromListClick.bind(this),this.addItemtoList=function(){t.dropDownItems.push(t.drpDownItemsInput.value),t.currentSelectedItem=t.drpDownItemsInput.value,t.drpDownItemsInput.value="",t.enableOrDisableButton(),t.updateList()},this.removeItemFromList=function(){for(var e=0;e<t.dropDownItems.length;e++)t.dropDownItems[e]===t.currentSelectedItem&&t.dropDownItems.splice(e,1);t.updateList()},this.selectHandler=function(e){t.currentSelectedItem=e.text},this.moveUpItem=function(){var e=t.getSelectedIndex();t.moveUp(e,e-1),t.updateList()},this.moveDownItem=function(){var e=t.getSelectedIndex();t.moveDown(e,e+1),t.updateList()},this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.onCancelButtonClick=function(){t.documentHelper.dialog.hide()},this.insertDropDownField=function(){var e=new Xl;e.dropdownItems=t.dropDownItems,e.selectedIndex=0,e.name=t.bookmarkInput.value,e.helpText=t.tooltipInput.value,e.enabled=t.dropDownEnable.checked,t.owner.editorModule.editFormField("DropDown",e),t.closeDropDownField()},this.closeDropDownField=function(){t.documentHelper.dialog.hide(),t.documentHelper.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"DropDownFormFieldDialog"},e.prototype.initTextDialog=function(e,t){this.target=(0,a.createElement)("div"),this.dialogDiv=(0,a.createElement)("div"),this.firstDiv=(0,a.createElement)("div",{className:"e-de-drp-dwn-frst-div"}),this.drpDownItemsInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input",id:"fielditems_text_box"}),this.drpDownItemsInput.addEventListener("keyup",this.keyUpOnTextBoxClickHandler),this.secondDiv=(0,a.createElement)("div",{className:"e-de-ff-drpdwn-dlg-scndiv"}),this.itemsDrpItemsLabel=(0,a.createElement)("div",{className:"e-de-ff-dlg-drpdwn-heading",innerHTML:e.getConstant("Items in dropdown list")}),this.listviewDiv=(0,a.createElement)("div",{className:"e-bookmark-listViewDiv e-de-ff-drpdwn-listview",attrs:{style:"height:100%"}}),this.listviewInstance=new il.ListView({cssClass:"e-bookmark-listview",select:this.selectHandler}),this.buttonDiv=(0,a.createElement)("div"),this.addButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.addButtonEle=(0,a.createElement)("button",{innerHTML:e.getConstant("ADD"),attrs:{type:"button",style:"height:36px;width:100%"}}),this.addButton=new tl.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButtonEle.setAttribute("aria-label",e.getConstant("ADD")),this.addButtonEle.addEventListener("click",this.addItemtoListClickHandler),this.editButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.editButtonDiv.style.display="none",this.editButtonEle=(0,a.createElement)("button",{innerHTML:"EDIT",attrs:{type:"button",style:"height:36px;width:100%"}}),this.editButton=new tl.Button({cssClass:"e-button-custom"}),this.editButtonEle.setAttribute("aria-label","EDIT"),this.removeButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.removeButtonEle=(0,a.createElement)("button",{innerHTML:e.getConstant("REMOVE"),attrs:{type:"button",style:"height:36px;width:100%"}}),this.removeButtonEle.setAttribute("aria-label",e.getConstant("REMOVE")),this.removeButton=new tl.Button({cssClass:"e-button-custom"}),this.removeButtonEle.addEventListener("click",this.removeItemFromListClickHandler),this.moveBtnDiv=(0,a.createElement)("div",{attrs:{style:"display:inline-flex"}}),this.moveUpButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.moveUpButtonEle=(0,a.createElement)("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvup"}),this.moveUpButtonEle.setAttribute("aria-label","moveUp"),this.moveUpButton=new tl.Button({cssClass:"e-button-custom",iconCss:"e-de-arrow-up"}),this.moveUpButtonEle.addEventListener("click",this.moveUpItemClickHandler),this.moveDownButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.moveDownButtonEle=(0,a.createElement)("button",{attrs:{type:"button",style:"height:36px;width:40px"},className:"e-de-ff-drpdwn-mvdn"}),this.moveDownButtonEle.setAttribute("aria-label","moveDown"),this.moveDownButton=new tl.Button({cssClass:"e-button-custom",iconCss:"e-de-arrow-down"}),this.moveDownButtonEle.addEventListener("click",this.moveDownItemClickHandler),this.fileSettingsLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Field settings")}),this.thirdDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.toolTipDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.bookmarkDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.tooltipInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.bookmarkInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input"}),this.dropDownEnableDiv=(0,a.createElement)("div"),this.dropDownEnableEle=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.dropDownEnable=new tl.CheckBox({cssClass:"e-de-ff-dlg-check",label:e.getConstant("Dropdown enabled"),enableRtl:t}),t&&(this.listviewDiv.classList.add("e-de-rtl"),this.moveUpButtonEle.classList.add("e-de-rtl"),this.toolTipDiv.classList.add("e-de-rtl"),this.bookmarkDiv.classList.add("e-de-rtl")),this.dropDownEnableDiv.setAttribute("aria-label",e.getConstant("Dropdown enabled")),this.target.appendChild(this.dialogDiv),this.dialogDiv.appendChild(this.firstDiv),this.firstDiv.appendChild(this.drpDownItemsInput),this.dialogDiv.appendChild(this.itemsDrpItemsLabel),this.dialogDiv.appendChild(this.secondDiv),this.secondDiv.appendChild(this.listviewDiv),this.listviewInstance.appendTo(this.listviewDiv),this.secondDiv.appendChild(this.buttonDiv),this.buttonDiv.appendChild(this.addButtonDiv),this.addButtonDiv.appendChild(this.addButtonEle),this.addButton.appendTo(this.addButtonEle),this.buttonDiv.appendChild(this.editButtonDiv),this.editButtonDiv.appendChild(this.editButtonEle),this.editButton.appendTo(this.editButtonEle),this.buttonDiv.appendChild(this.removeButtonDiv),this.removeButtonDiv.appendChild(this.removeButtonEle),this.removeButton.appendTo(this.removeButtonEle),this.buttonDiv.appendChild(this.moveBtnDiv),this.moveBtnDiv.appendChild(this.moveUpButtonDiv),this.moveUpButtonDiv.appendChild(this.moveUpButtonEle),this.moveUpButton.appendTo(this.moveUpButtonEle),this.moveBtnDiv.appendChild(this.moveDownButtonDiv),this.moveDownButtonDiv.appendChild(this.moveDownButtonEle),this.moveDownButton.appendTo(this.moveDownButtonEle),this.dialogDiv.appendChild(this.fileSettingsLabel),this.dialogDiv.appendChild(this.thirdDiv),this.thirdDiv.appendChild(this.toolTipDiv),this.toolTipDiv.appendChild(this.tooltipInput),this.thirdDiv.appendChild(this.bookmarkDiv),this.bookmarkDiv.appendChild(this.bookmarkInput),this.dialogDiv.appendChild(this.dropDownEnableDiv),this.dropDownEnableDiv.appendChild(this.dropDownEnableEle),this.dropDownEnable.appendTo(this.dropDownEnableEle),new rl.TextBox({placeholder:e.getConstant("Tooltip"),floatLabelType:"Always"},this.tooltipInput),new rl.TextBox({placeholder:e.getConstant("Name"),floatLabelType:"Always"},this.bookmarkInput),new rl.TextBox({placeholder:e.getConstant("Dropdown items"),floatLabelType:"Always"},this.drpDownItemsInput),this.tooltipInput.setAttribute("aria-labelledby",e.getConstant("Tooltip")),this.bookmarkInput.setAttribute("aria-labelledby",e.getConstant("Name")),this.drpDownItemsInput.setAttribute("aria-labelledby",e.getConstant("Dropdown items"))},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),(0,a.isNullOrUndefined)(this.target)&&this.initTextDialog(e,this.documentHelper.owner.enableRtl),this.loadDropDownDialog(),this.documentHelper.dialog.header=e.getConstant("Drop Down Form Field"),this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="448px",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.insertDropDownField,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.documentHelper.dialog.show()},e.prototype.loadDropDownDialog=function(){var e=this.owner.selectionModule.getCurrentFormField();if(e instanceof _l){if(this.fieldBegin=e,this.dropDownInstance=e.formFieldData,this.dropDownInstance.dropdownItems.length>0){var t=this.dropDownInstance.selectedIndex;this.currentSelectedItem=this.dropDownInstance.dropdownItems[t]}this.dropDownInstance.enabled?this.dropDownEnable.checked=!0:this.dropDownEnable.disabled=!1,""!==this.dropDownInstance.helpText?this.tooltipInput.value=this.dropDownInstance.helpText:this.tooltipInput.value="",""!==this.dropDownInstance.name?this.bookmarkInput.value=this.dropDownInstance.name:this.bookmarkInput.value="",this.dropDownItems=this.dropDownInstance.dropdownItems.slice(),this.updateList()}},e.prototype.updateList=function(){if(this.listviewInstance.dataSource=this.dropDownItems.slice(),this.listviewInstance.dataBind(),this.currentSelectedItem){var e=this.currentSelectedItem;this.listviewInstance.selectItem(e)}},e.prototype.onAddItemtoListClick=function(){this.addItemtoList()},e.prototype.onRemoveItemFromListClick=function(){this.removeItemFromList()},e.prototype.onMoveUpItemClick=function(){this.moveUpItem()},e.prototype.onMouseDownItemClick=function(){this.moveDownItem()},e.prototype.getSelectedIndex=function(){for(var e=0;e<this.dropDownItems.length;e++)if(this.dropDownItems[e]===this.currentSelectedItem)return e;return 0},e.prototype.moveUp=function(e,t){var i=[];if(0===e){for(var n=0;n<this.dropDownItems.length;n++)n<this.dropDownItems.length-1?i[n]=this.dropDownItems[n+1]:i[n]=this.dropDownItems[0];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},e.prototype.moveDown=function(e,t){var i=[];if(e===this.dropDownItems.length-1){for(var n=0;n<this.dropDownItems.length;n++)i[n]=0!==n?this.dropDownItems[n-1]:this.dropDownItems[this.dropDownItems.length-1];this.dropDownItems=i}else{var r=this.dropDownItems[e];this.dropDownItems[e]=this.dropDownItems[t],this.dropDownItems[t]=r}},e.prototype.onKeyUpOnTextBoxClick=function(){this.onKeyUpOnTextBox()},e.prototype.enableOrDisableButton=function(){(0,a.isNullOrUndefined)(this.addButton)||(this.addButton.disabled=""===this.drpDownItemsInput.value)},e.prototype.destroy=function(){var e=this.target;e&&(e.parentElement&&e.parentElement.removeChild(e),this.target=void 0),this.owner=void 0,this.drpDownItemsInput=void 0,this.removeEvents(),this.removeElements(),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.addButton&&(this.addButton.destroy(),this.addButton=void 0),this.editButton&&(this.editButton.destroy(),this.editButton=void 0),this.removeButton&&(this.removeButton.destroy(),this.removeButton=void 0),this.moveUpButton&&(this.moveUpButton.destroy(),this.moveUpButton=void 0),this.moveDownButton&&(this.moveDownButton.destroy(),this.moveDownButton=void 0),this.tooltipInput=void 0,this.bookmarkInput=void 0,this.dropDownEnable&&(this.dropDownEnable.destroy(),this.dropDownEnable=void 0),this.dropDownInstance=void 0},e.prototype.removeEvents=function(){this.addButtonEle&&this.addButtonEle.removeEventListener("click",this.addItemtoListClickHandler),this.removeButtonEle&&this.removeButtonEle.removeEventListener("click",this.removeItemFromListClickHandler),this.moveUpButtonEle&&this.moveUpButtonEle.removeEventListener("click",this.moveUpItemClickHandler),this.moveDownButtonEle&&this.moveDownButtonEle.removeEventListener("click",this.moveDownItemClickHandler),this.drpDownItemsInput&&this.drpDownItemsInput.removeEventListener("keyup",this.keyUpOnTextBoxClickHandler)},e.prototype.removeElements=function(){this.dialogDiv&&(this.dialogDiv.remove(),this.dialogDiv=void 0),this.firstDiv&&(this.firstDiv.remove(),this.firstDiv=void 0),this.secondDiv&&(this.secondDiv.remove(),this.secondDiv=void 0),this.itemsDrpItemsLabel&&(this.itemsDrpItemsLabel.remove(),this.itemsDrpItemsLabel=void 0),this.listviewDiv&&(this.listviewDiv.remove(),this.listviewDiv=void 0),this.buttonDiv&&(this.buttonDiv.remove(),this.buttonDiv=void 0),this.addButtonDiv&&(this.addButtonDiv.remove(),this.addButtonDiv=void 0),this.addButtonEle&&(this.addButtonEle.remove(),this.addButtonEle=void 0),this.editButtonDiv&&(this.editButtonDiv.remove(),this.editButtonDiv=void 0),this.editButtonEle&&(this.editButtonEle.remove(),this.editButtonEle=void 0),this.removeButtonDiv&&(this.removeButtonDiv.remove(),this.removeButtonDiv=void 0),this.removeButtonEle&&(this.removeButtonEle.remove(),this.removeButtonEle=void 0),this.moveBtnDiv&&(this.moveBtnDiv.remove(),this.moveBtnDiv=void 0),this.moveUpButtonDiv&&(this.moveUpButtonDiv.remove(),this.moveUpButtonDiv=void 0),this.moveUpButtonEle&&(this.moveUpButtonEle.remove(),this.moveUpButtonEle=void 0),this.moveDownButtonDiv&&(this.moveDownButtonDiv.remove(),this.moveDownButtonDiv=void 0),this.moveDownButtonEle&&(this.moveDownButtonEle.remove(),this.moveDownButtonEle=void 0),this.fileSettingsLabel&&(this.fileSettingsLabel.remove(),this.fileSettingsLabel=void 0),this.thirdDiv&&(this.thirdDiv.remove(),this.thirdDiv=void 0),this.toolTipDiv&&(this.toolTipDiv.remove(),this.toolTipDiv=void 0),this.bookmarkDiv&&(this.bookmarkDiv.remove(),this.bookmarkDiv=void 0),this.dropDownEnableDiv&&(this.dropDownEnableDiv.remove(),this.dropDownEnableDiv=void 0),this.dropDownEnableEle&&(this.dropDownEnableEle.remove(),this.dropDownEnableEle=void 0)},e}(),rc=function(){},oc=function(){function e(e){var t=this;this.lineCheckbox=void 0,this.equalCheckbox=void 0,this.handleSettingCheckBoxActionHandler=this.onhandleSettingCheckBoxActionClicked.bind(this),this.checkBox=function(e){for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)];!0===t.equalCheckbox.checked?0!==i&&(n.width.enabled=!1,n.space.enabled=!1):(n.width.enabled=!0,n.space.enabled=!0)}},this.createTextBox=function(e){if(1===t.columnValueTexBox.value?(t.oneDiv.classList.add("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")):2===t.columnValueTexBox.value?(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.twoDiv.classList.add("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")):3===t.columnValueTexBox.value&&(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.add("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")),t.numberOfColumns=e.value,e.value>=1){t.equalCheckbox.disabled=!1,t.lineCheckbox.disabled=!1;for(var i=e.previousValue;i<t.numberOfColumns;)t.createColumn(i+1),i++;for(;i>t.numberOfColumns;)t.columnTable.deleteRow(t.columnTable.rows.length-1),t.columns.splice(t.columns.length-1,t.columns.length),1===t.numberOfColumns&&(t.equalCheckbox.disabled=!0,t.columns[0].space.enabled=!1),i--;t.canUpdateColumnWidthAndSpacing(e.value,void 0,void 0,void 0)}},this.widthChange=function(e){!0===e.isInteracted&&(e.event.target.parentElement.classList.replace("width1","Width"),t.checkAndApplyColumnFormatWidth(e.value))},this.spaceChange=function(e){!0===e.isInteracted&&(e.event.target.parentElement.classList.replace("space1","Space"),t.checkAndApplyColumnFormatSpace(e.value))},this.checkAndApplyColumnFormatWidth=function(e){if(1===t.numberOfColumns)e>t.pageWidth?t.columns[0].width.value=e-1:t.columns[0].width.value=e+1;else{if(!0===t.equalCheckbox.checked)for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)];if(e>=36&&t.columns[0].space.value>=0){var r=(t.pageWidth-t.numberOfColumns*e)/(t.numberOfColumns-1);n.width.value=e,i<t.columns.length-1&&(n.space.value=r)}else t.columns[0].width.value=t.columns[1].width.value}if(!1===t.equalCheckbox.checked)for(i=0;i<t.columns.length;i++){n=t.columns[parseInt(i.toString(),10)];var o=void 0;if(e===t.columns[parseInt(i.toString(),10)].width.value)if((o=i)+1!==t.columns.length)if(e>t.columns[0].width.value||e>t.columns[t.columns.length-1].width.value)for(var s=o+1;s<=t.columns.length;s++){var a=t.columns[parseInt(s.toString(),10)];if(s<t.columns.length&&a.width.value>36&&(a.width.value=a.width.value-1),0===t.columns[0].space.value)for(var l=o-1;l>=0;l--){var d=t.columns[parseInt(l.toString(),10)];d.width.value>36&&(d.width.value=d.width.value-1)}if(s>=t.columns.length&&36===t.columns[0].width.value||36===t.columns[s-1].width.value&&0!==t.columns[0].space.value)for(var h=0;h<t.columns.length-1;h++){var c=t.columns[parseInt(h.toString(),10)];c.space.value>0&&h<t.columns.length-1&&(c.space.value=c.space.value-1)}if(36===t.columns[0].width.value&&0===t.columns[0].space.value||36===t.columns[s-1].width.value&&0===t.columns[0].space.value)for(h=0;h<t.columns.length;h++){var p=t.columns[parseInt(h.toString(),10)];36!==p.width.value&&e>t.pageWidth-36*(t.numberOfColumns-1)&&(p.width.value=e-1)}}else for(s=o+1;s<t.columns.length;s++){var u=t.columns[parseInt(s.toString(),10)];u.width.value>36&&(u.width.value=u.width.value+1)}else if(e>t.columns[0].width.value||e>t.columns[t.columns.length-1].width.value)for(s=o+1;s<=t.columns.length;s++){if(0===t.columns[0].space.value)for(l=o-1;l>=0;l--){var g=t.columns[parseInt(l.toString(),10)];g.width.value>36&&(g.width.value=g.width.value-1)}if(s<=t.columns.length&&0!==t.columns[0].space.value)for(h=0;h<t.columns.length-1;h++){var m=t.columns[parseInt(h.toString(),10)];m.space.value>0&&h<t.columns.length-1&&(m.space.value=m.space.value-1)}if(36===t.columns[0].width.value&&0===t.columns[0].space.value)for(h=0;h<t.columns.length;h++){var f=t.columns[parseInt(h.toString(),10)];36!==f.width.value&&e>t.pageWidth-36*(t.numberOfColumns-1)&&(f.width.value=e-1)}}else for(s=o+1;s<t.columns.length;s++){var v=t.columns[parseInt(s.toString(),10)];v.width.value>36&&(v.width.value=v.width.value+1)}}}},this.checkAndApplyColumnFormatSpace=function(e){if(!0===t.equalCheckbox.checked)for(var i=0;i<t.columns.length;i++){var n=t.columns[parseInt(i.toString(),10)];if(e>=0&&t.columns[0].width.value>=36){var r=(t.pageWidth-e*(t.numberOfColumns-1))/t.numberOfColumns;n.width.value=r,i<t.columns.length-1&&(n.space.value=e)}else t.columns[0].space.value=t.columns[1].space.value}if(!1===t.equalCheckbox.checked)for(i=0;i<t.columns.length;i++){n=t.columns[parseInt(i.toString(),10)];var o=void 0;if(e===t.columns[parseInt(i.toString(),10)].space.value)if((o=i)+1!==t.columns.length)if(t.columns[t.columns.length-1].space.value=0,e>t.columns[0].space.value||e>t.columns[t.columns.length-2].space.value)for(var s=o+1;s<=t.columns.length;s++){var a=t.columns[parseInt(s.toString(),10)];if(s<t.columns.length&&a.width.value>36&&(a.width.value=a.width.value-1),36===t.columns[o+1].width.value&&t.columns[parseInt(o.toString(),10)].width.value>36)for(var l=o;l>=0;l--){var d=t.columns[parseInt(l.toString(),10)];d.width.value>36&&(d.width.value=d.width.value-1)}if(36===t.columns[parseInt(o.toString(),10)].width.value&&(0!==t.columns[0].space.value||0!==t.columns[o+1].space.value))for(var h=0;h<t.columns.length-1;h++){var c=t.columns[parseInt(h.toString(),10)];c.space.value>0&&h<t.columns.length-1&&(c.space.value=c.space.value-1,t.columns[parseInt(o.toString(),10)].space.value=e)}if(36===t.columns[0].width.value&&(0===t.columns[0].space.value||0===t.columns[o+1].space.value))for(l=0;l<t.columns.length;l++){var p=t.columns[parseInt(l.toString(),10)];0!==p.space.value&&e>t.pageWidth-36*t.numberOfColumns&&(p.space.value=e-1)}}else for(s=o+1;s<t.columns.length;s++){var u=t.columns[parseInt(s.toString(),10)];u.width.value>36&&(u.width.value=u.width.value+.5)}else t.columns[parseInt(o.toString(),10)].space.value=0}},this.canUpdateColumnWidthAndSpacing=function(e,i,n,r){var o=(t.pageWidth-36*(e-1))/e,s=(t.pageWidth-36*e)/(e-1);if(2===e&&(t.equalCheckbox.checked=!0),!0===t.equalCheckbox.checked){if(e>1){t.columns[e-1].index.value=e;for(var a=0;a<e;a++){var l=t.columns[parseInt(a.toString(),10)];l.width.value=e<=6?o:36,l.width.value=o,a<e-1&&(l.space.value=e<=6?36:s),l.width.enabled=!1,l.space.enabled=!1}}else t.columns[0].width.value=t.pageWidth;t.columns[0].width.enabled=!0,t.columns[0].space.enabled=e>1}if(!1===t.equalCheckbox.checked)if(e>2){t.columns[e-1].index.value=e;for(a=0;a<e;a++){var d=t.columns[parseInt(a.toString(),10)];d.width.value=o,a<e-1&&(d.width.value<=36?d.space.value=s:d.space.value=36),d.width.enabled=!0,d.space.enabled=!0}}else t.columns[0].width.value=t.pageWidth},this.closeDialog=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.closeColumnsDialog()},this.closeColumnsDialog=function(){t.documentHelper.dialog2.element.style.pointerEvents="",t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.unWireEventsAndBindings=function(){t.equalCheckbox.checked=!0,t.lineCheckbox.checked=!1,t.equalCheckbox.disabled=!0;for(var e=0;e<t.columns.length;e++)t.columns.splice(1,t.columns.length-1),t.columns[0].space.enabled=!1;for(;t.columnTable.rows.length>1;)t.columnTable.deleteRow(t.columnTable.rows.length-1)},this.openColumnsDialog=function(){var e=t.documentHelper.selection.sectionFormat,i=e.pageWidth-e.leftMargin-e.rightMargin;switch(t.columnValueTexBox.max=i/36,t.columns[0].width.value=i,t.documentHelper.updateFocus(),t.equalCheckbox.checked=e.equalWidth,t.lineCheckbox.checked=e.lineBetweenColumns,t.columnValueTexBox.value=0===e.columns.length?1:e.columns.length,t.columnValueTexBox.value){case 1:t.oneDiv.classList.add("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click");break;case 2:t.twoDiv.classList.add("e-de-table-border-inside-setting-click"),t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click");break;case 3:t.threeDiv.classList.add("e-de-table-border-inside-setting-click"),t.twoDiv.classList.remove("e-de-table-border-inside-setting-click"),t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click")}1!==t.columnValueTexBox.value&&(t.columns[0].space.value=e.columns[0].space,t.columns[0].width.value=e.columns[0].width),1===t.columnValueTexBox.value&&(t.columns[0].space.value=0);for(var n=1;n<t.columnValueTexBox.value;n++)t.createColumn(n+1,e.columns[n].width,e.columns[n].space)},this.handleSettingCheckBoxAction=function(e){var i=e.target.id,n=t.target.id;i===n+"_One_Div"||i===n+"_One_Div_Container"?(t.oneDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("one")):i===n+"_Two_Div"||i===n+"_Two_Div_Container"?(t.twoDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("two")):i===n+"_Three_Div"||i===n+"_Three_Div_Container"?(t.threeDiv.classList.add("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("three")):i===n+"_Left_Div"||i===n+"_Left_Div_Container"?(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.rightDiv.classList.remove("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("two","left")):i!==n+"_Right_Div"&&i!==n+"_Right_Div_Container"||(t.oneDiv.classList.remove("e-de-table-border-inside-setting-click"),t.threeDiv.classList.remove("e-de-table-border-inside-setting-click"),t.leftDiv.classList.remove("e-de-table-border-inside-setting-click"),t.setSettingPreviewDivElement("two","right"))},this.applyColumnDialog=function(){if(!t.documentHelper.selection.isEmpty){t.documentHelper.owner.editorHistory&&t.documentHelper.owner.editor.initComplexHistory("InsertSectionBreak");var e=t.documentHelper.selection.getParagraphInfo(t.documentHelper.selection.start),i=t.documentHelper.selection.getParagraphInfo(t.documentHelper.selection.end),r=t.documentHelper.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),o=t.documentHelper.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());t.documentHelper.selection.select(o,o),t.documentHelper.owner.editorModule.insertSectionBreak(n.Continuous),t.documentHelper.selection.select(r,r),t.documentHelper.owner.editorModule.insertSectionBreak(n.Continuous)}var s=new ga,a=t.documentHelper.selection.sectionFormat;s.bottomMargin=a.bottomMargin,s.topMargin=a.topMargin,s.leftMargin=a.leftMargin,s.rightMargin=a.rightMargin,s.pageWidth=a.pageWidth,s.pageHeight=a.pageHeight,s.differentOddAndEvenPages=a.differentOddAndEvenPages,s.differentFirstPage=a.differentFirstPage,s.headerDistance=a.headerDistance,s.footerDistance=a.footerDistance,s.numberOfColumns=t.numberOfColumns,s.equalWidth=t.equalCheckbox.checked,s.lineBetweenColumns=t.lineCheckbox.checked;for(var l=[],d=0;d<t.columns.length;d++){var h=new ma;h.width=Pa.convertPointToPixel(t.columns[parseInt(d.toString(),10)].width.value),h.space=Pa.convertPointToPixel(t.columns[parseInt(d.toString(),10)].space.value),l.push(h)}s.columns=l,s.breakCode=a.breakCode,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,s),t.documentHelper.owner.editorHistory&&t.documentHelper.owner.editorHistory.updateComplexHistory(),t.documentHelper.hideDialog()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"ColumnsDialog"},e.prototype.initColumnsDialog=function(e,t){this.columns=[],this.target=(0,a.createElement)("div",{id:this.documentHelper.owner.containerId+"_Columns",className:"e-de-table-border-shading-dlg"}),this.displayText=(0,a.createElement)("div",{innerHTML:e.getConstant("Presets"),className:"e-de-para-dlg-heading"}),this.PresetsContainer=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.oneDivContainer=(0,a.createElement)("div",{id:this.target.id+"_One_Div_Container",className:"e-de-preset-container"}),this.oneDiv=(0,a.createElement)("div",{id:this.target.id+"_One_Div",className:"e-icons e-de-ctnr-columns-one e-de-columns-presets-genral"}),this.oneDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("One"),className:"e-de-column-label",id:this.target.id+"_One_Div_Label"}),this.twoDivContainer=(0,a.createElement)("div",{id:this.target.id+"_Two_Div_Container",className:"e-de-preset-container"}),this.twoDiv=(0,a.createElement)("div",{id:this.target.id+"_Two_Div",className:"e-icons e-de-ctnr-columns-two e-de-columns-presets-genral"}),this.twoDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Two"),className:"e-de-column-label",id:this.target.id+"_Two_Div_Label"}),this.threeDivContainer=(0,a.createElement)("div",{id:this.target.id+"_Three_Div_Container",className:"e-de-preset-container"}),this.threeDiv=(0,a.createElement)("div",{id:this.target.id+"_Three_Div",className:"e-icons e-de-ctnr-columns-three  e-de-columns-presets-genral"}),this.threeDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Three"),className:"e-de-column-label",id:this.target.id+"_Three_Div_Label"}),this.leftDivContainer=(0,a.createElement)("div",{id:this.target.id+"_Left_Div_Container",className:"e-de-preset-container"}),this.leftDiv=(0,a.createElement)("div",{id:this.target.id+"_Left_Div",className:"e-icons e-de-ctnr-columns-left e-de-columns-presets-genral"}),this.leftDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Left"),className:"e-de-column-label",id:this.target.id+"_Left_Div_Label"}),this.rightDivContainer=(0,a.createElement)("div",{id:this.target.id+"_Right_Div_Container",className:"e-de-preset-container"}),this.rightDiv=(0,a.createElement)("div",{id:this.target.id+"_Right_Div",className:"e-icons e-de-ctnr-columns-right e-de-columns-presets-genral"}),this.rightDivLabel=(0,a.createElement)("label",{innerHTML:e.getConstant("Right"),className:"e-de-column-label",id:this.target.id+"_Right_Div_Label"}),this.nuberOfColumnsContainer=(0,a.createElement)("div",{className:"e-de-container-row e-de-columns-padding-alignment"}),this.subcontainer=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.oneDivContainer.setAttribute("aria-label",e.getConstant("One")),this.twoDivContainer.setAttribute("aria-label",e.getConstant("Two")),this.threeDivContainer.setAttribute("aria-label",e.getConstant("Three")),this.leftDivContainer.setAttribute("aria-label",e.getConstant("Left")),this.rightDivContainer.setAttribute("aria-label",e.getConstant("Right")),t&&(this.oneDiv.classList.add("e-de-rtl"),this.twoDiv.classList.add("e-de-rtl"),this.threeDiv.classList.add("e-de-rtl"),this.leftDiv.classList.add("e-de-rtl"),this.rightDiv.classList.add("e-de-rtl"),this.oneDivContainer.classList.add("e-de-rtl"),this.twoDivContainer.classList.add("e-de-rtl"),this.threeDivContainer.classList.add("e-de-rtl"),this.leftDivContainer.classList.add("e-de-rtl"),this.rightDivContainer.classList.add("e-de-rtl"),this.oneDivLabel.classList.add("e-de-rtl"),this.twoDivLabel.classList.add("e-de-rtl"),this.threeDivLabel.classList.add("e-de-rtl"),this.leftDivLabel.classList.add("e-de-rtl"),this.rightDivLabel.classList.add("e-de-rtl")),this.columnsCountBox=(0,a.createElement)("input",{attrs:{type:"text"}}),this.subcontainer.appendChild(this.columnsCountBox),this.nuberOfColumnsContainer.appendChild(this.subcontainer),this.section=this.documentHelper.selection.sectionFormat,this.pageWidth=this.section.pageWidth-this.section.leftMargin-this.section.rightMargin,this.columnValueTexBox=new rl.NumericTextBox({format:"#",value:1,min:1,strictMode:!0,placeholder:e.getConstant("Number of columns"),floatLabelType:"Always",change:this.createTextBox}),this.columnValueTexBox.appendTo(this.columnsCountBox),this.subcontainer1=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.lineCheckDiv=(0,a.createElement)("div",{className:"e-de-columns-padding-alignment"}),this.lineCheck=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.subcontainer1.appendChild(this.lineCheckDiv),this.lineCheckDiv.appendChild(this.lineCheck),this.lineCheck.setAttribute("aria-labelledby",e.getConstant("Line between column")),this.columnsCountBox.setAttribute("aria-labelledby",e.getConstant("Number of columns")),this.lineCheckbox=new tl.CheckBox({label:e.getConstant("Line between column")}),this.widthAndSpacingContainer=(0,a.createElement)("div",{className:"e-de-dlg-row"}),this.widthAndSpacingContainerDiv=(0,a.createElement)("div",{}),this.widthAndSpacingText=(0,a.createElement)("div",{innerHTML:e.getConstant("Width and Spacing"),className:"e-de-para-dlg-heading"}),this.columnElementDiv=(0,a.createElement)("div",{className:"e-width-space-div "}),this.widthcontainerDiv1=(0,a.createElement)("div",{className:"e-de-container-row"}),this.widthContainer=(0,a.createElement)("div",{className:"e-de-container-row"}),this.tableElement=(0,a.createElement)("table"),this.tableElement.style.width="96%";var i=this.tableElement.insertRow(),n=i.insertCell();n.innerHTML=e.getConstant("Column"),n.style.width="20%",n.style.display="table-cell",n.classList.add("e-de-dlg-sub-header"),(n=i.insertCell()).innerHTML=e.getConstant("Width"),n.style.width="40%",n.style.display="table-cell",n.classList.add("e-de-dlg-sub-header"),(n=i.insertCell()).innerHTML=e.getConstant("Spacing"),n.style.width="40%",n.style.display="table-cell",n.classList.add("e-de-dlg-sub-header"),this.columnDiv=(0,a.createElement)("div",{styles:"width:100%;height:100px;overflow-y: scroll;overflow-x: hidden;"}),this.columnTable=(0,a.createElement)("table",{styles:"width:100%;"});var r=this.columnTable.insertRow(),o=r.insertCell();o.style.width="20%";var s=new rc;this.columnCountBox1=(0,a.createElement)("input",{}),s.index=new rl.NumericTextBox({format:"#",min:1,value:1,enabled:!1,cssClass:"index1",showSpinButton:!1,floatLabelType:"Always",change:this.spaceChange}),o.appendChild(this.columnCountBox1),s.index.appendTo(this.columnCountBox1);var l=r.insertCell();l.style.width="40%",this.widthCountBox1=(0,a.createElement)("input",{attrs:{type:"text"}}),s.width=new rl.NumericTextBox({min:36,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"width1",floatLabelType:"Always",change:this.widthChange}),l.appendChild(this.widthCountBox1),l.style.width="40%",s.width.appendTo(this.widthCountBox1);var d=r.insertCell();d.style.width="40%",this.spacingCountBox1=(0,a.createElement)("input",{attrs:{type:"text"}}),s.space=new rl.NumericTextBox({min:0,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"space1",floatLabelType:"Always",change:this.spaceChange}),d.appendChild(this.spacingCountBox1),s.space.appendTo(this.spacingCountBox1),this.columns.push(s),s.space.enabled=!1,this.widthCountBox1.setAttribute("aria-labelledby","Width"),this.spacingCountBox1.setAttribute("aria-labelledby","Space"),this.equalCheckDiv=(0,a.createElement)("div",{className:"e-de-columns-padding-alignment"}),this.equalCheck=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.equalCheckDiv.appendChild(this.equalCheck),this.equalCheckDiv.setAttribute("aria-label",e.getConstant("Equal column width")),this.equalCheckbox=new tl.CheckBox({label:e.getConstant("Equal column width"),change:this.checkBox}),this.equalCheckbox.appendTo(this.equalCheck),this.lineCheckbox.appendTo(this.lineCheck),this.nuberOfColumnsContainer.appendChild(this.subcontainer1),this.oneDivContainer.appendChild(this.oneDiv),this.oneDivContainer.appendChild(this.oneDivLabel),this.twoDivContainer.appendChild(this.twoDiv),this.twoDivContainer.appendChild(this.twoDivLabel),this.threeDivContainer.appendChild(this.threeDiv),this.threeDivContainer.appendChild(this.threeDivLabel),this.leftDivContainer.appendChild(this.leftDiv),this.leftDivContainer.appendChild(this.leftDivLabel),this.rightDivContainer.appendChild(this.rightDiv),this.rightDivContainer.appendChild(this.rightDivLabel),this.PresetsContainer.appendChild(this.oneDivContainer),this.PresetsContainer.appendChild(this.twoDivContainer),this.PresetsContainer.appendChild(this.threeDivContainer),this.PresetsContainer.appendChild(this.leftDivContainer),this.PresetsContainer.appendChild(this.rightDivContainer),this.widthAndSpacingContainerDiv.appendChild(this.widthAndSpacingText),this.widthAndSpacingContainerDiv.appendChild(this.tableElement),this.columnDiv.appendChild(this.columnTable),this.widthAndSpacingContainerDiv.appendChild(this.columnDiv),this.widthAndSpacingContainer.appendChild(this.widthAndSpacingContainerDiv),this.target.appendChild(this.displayText),this.target.appendChild(this.PresetsContainer),this.target.appendChild(this.nuberOfColumnsContainer),this.target.appendChild(this.widthAndSpacingContainer),this.target.appendChild(this.equalCheckDiv),this.oneDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.twoDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.threeDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.leftDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.rightDivContainer.addEventListener("click",this.handleSettingCheckBoxActionHandler),this.widthcontainerDiv1.style.display="flex",this.equalCheckbox.checked=!0,this.equalCheckbox.disabled=!0,this.lineCheckbox.disabled=!0},e.prototype.createColumn=function(e,t,i){this.widthContainer=(0,a.createElement)("div",{className:"e-de-container-row"}),this.widthContainer.style.display="flex";var n=this.columnTable.insertRow(),r=n.insertCell();r.style.width="20%";var o=new rc;this.columnCount=(0,a.createElement)("input",{}),o.index=new rl.NumericTextBox({format:"#",min:1,value:e,enabled:!1,cssClass:"column1",showSpinButton:!1,floatLabelType:"Always"}),r.appendChild(this.columnCount),o.index.appendTo(this.columnCount);var s=n.insertCell();s.style.width="40%";var l=(0,a.createElement)("input",{attrs:{type:"text"}});o.width=new rl.NumericTextBox({min:36,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"width1",floatLabelType:"Always",change:this.widthChange}),(0,a.isNullOrUndefined)(t)||(o.width.value=t),s.appendChild(l),o.width.appendTo(l);var d=n.insertCell();d.style.width="40%";var h=(0,a.createElement)("input",{attrs:{type:"text"}});o.space=new rl.NumericTextBox({min:0,decimals:2,strictMode:!0,enablePersistence:!1,cssClass:"space1",floatLabelType:"Always",change:this.spaceChange}),(0,a.isNullOrUndefined)(i)||(o.space.value=i),d.appendChild(h),o.space.appendTo(h),this.columns.push(o)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.target||this.initColumnsDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.header=e.getConstant("Columns"),this.documentHelper.dialog.beforeOpen=this.openColumnsDialog,this.documentHelper.dialog.close=this.closeColumnsDialog,this.documentHelper.dialog.position={X:"center",Y:"center"},this.documentHelper.dialog.width="auto",this.documentHelper.dialog.height="auto",this.documentHelper.dialog.buttons=[{click:this.applyColumnDialog,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.onhandleSettingCheckBoxActionClicked=function(e){this.handleSettingCheckBoxAction(e)},e.prototype.setSettingPreviewDivElement=function(e,t){var i=this;switch(this.equalCheckbox.checked=!0,e){case"one":this.columnValueTexBox.value=1;break;case"two":this.columnValueTexBox.value=2,setTimeout((function(){if("left"!==t&&"right"!==t||(i.equalCheckbox.checked=!1),"left"===t){i.numberOfColumns=2,i.leftDiv.classList.add("e-de-table-border-inside-setting-click"),i.twoDiv.classList.remove("e-de-table-border-inside-setting-click");var e=(i.pageWidth-72)/3;i.columns[0].width.value=e,i.columns[1].width.value=e+e+36,i.columns[1].space.value=void 0}else if("right"===t){i.numberOfColumns=2,i.rightDiv.classList.add("e-de-table-border-inside-setting-click"),i.twoDiv.classList.remove("e-de-table-border-inside-setting-click");e=(i.pageWidth-72)/3;i.columns[0].width.value=e+e+36,i.columns[1].width.value=e,i.columns[1].space.value=void 0}}),5);break;case"three":this.columnValueTexBox.value=3}},e.prototype.destroy=function(){this.removeElements(),this.removeEvents(),this.target=void 0,this.oneDiv=void 0,this.twoDiv=void 0,this.threeDiv=void 0,this.leftDiv=void 0,this.rightDiv=void 0,this.documentHelper=void 0},e.prototype.removeEvents=function(){this.oneDivContainer&&this.oneDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.twoDivContainer&&this.twoDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.threeDivContainer&&this.threeDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.leftDivContainer&&this.leftDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler),this.rightDivContainer&&this.rightDivContainer.removeEventListener("click",this.handleSettingCheckBoxActionHandler)},e.prototype.removeElements=function(){this.target&&this.target.remove(),this.oneDiv&&(this.oneDiv.remove(),this.oneDiv=void 0),this.twoDiv&&(this.twoDiv.remove(),this.twoDiv=void 0),this.threeDiv&&(this.threeDiv.remove(),this.threeDiv=void 0),this.leftDiv&&(this.leftDiv.remove(),this.leftDiv=void 0),this.rightDiv&&(this.rightDiv.remove(),this.rightDiv=void 0),this.columnsCountBox&&(this.columnsCountBox.remove(),this.columnsCountBox=void 0),this.columnValueTexBox&&this.columnValueTexBox.element&&this.columnValueTexBox.element.parentNode&&(this.columnValueTexBox.destroy(),this.columnValueTexBox=void 0),this.lineCheckbox&&(this.lineCheckbox.destroy(),this.lineCheckbox=void 0),this.equalCheckbox&&(this.equalCheckbox.destroy(),this.equalCheckbox=void 0),this.columnCountBox1&&(this.columnCountBox1.remove(),this.columnCountBox1=void 0),this.widthCountBox1&&(this.widthCountBox1.remove(),this.widthCountBox1=void 0),this.spacingCountBox1&&(this.spacingCountBox1.remove(),this.spacingCountBox1=void 0),this.columnTable&&(this.columnTable.remove(),this.columnTable=void 0),this.displayText&&(this.displayText.remove(),this.displayText=void 0),this.PresetsContainer&&(this.PresetsContainer.remove(),this.PresetsContainer=void 0),this.oneDivContainer&&(this.oneDivContainer.remove(),this.oneDivContainer=void 0),this.oneDivLabel&&(this.oneDivLabel.remove(),this.oneDivLabel=void 0),this.twoDivContainer&&(this.twoDivContainer.remove(),this.twoDivContainer=void 0),this.twoDivLabel&&(this.twoDivLabel.remove(),this.twoDivLabel=void 0),this.threeDivContainer&&(this.threeDivContainer.remove(),this.threeDivContainer=void 0),this.threeDivLabel&&(this.threeDivLabel.remove(),this.threeDivLabel=void 0),this.leftDivContainer&&(this.leftDivContainer.remove(),this.leftDivContainer=void 0),this.leftDivLabel&&(this.leftDivLabel.remove(),this.leftDivLabel=void 0),this.rightDivContainer&&(this.rightDivContainer.remove(),this.rightDivContainer=void 0),this.rightDivLabel&&(this.rightDivLabel.remove(),this.rightDivLabel=void 0),this.nuberOfColumnsContainer&&(this.nuberOfColumnsContainer.remove(),this.nuberOfColumnsContainer=void 0),this.subcontainer&&(this.subcontainer.remove(),this.subcontainer=void 0),this.subcontainer1&&(this.subcontainer1.remove(),this.subcontainer1=void 0),this.lineCheckDiv&&(this.lineCheckDiv.remove(),this.lineCheckDiv=void 0),this.lineCheck&&(this.lineCheck.remove(),this.lineCheck=void 0),this.widthAndSpacingContainer&&(this.widthAndSpacingContainer.remove(),this.widthAndSpacingContainer=void 0),this.widthAndSpacingContainerDiv&&(this.widthAndSpacingContainerDiv.remove(),this.widthAndSpacingContainerDiv=void 0),this.widthAndSpacingText&&(this.widthAndSpacingText.remove(),this.widthAndSpacingText=void 0),this.tableElement&&(this.tableElement.remove(),this.tableElement=void 0),this.columnDiv&&(this.columnDiv.remove(),this.columnDiv=void 0),this.columnCount&&(this.columnCount.remove(),this.columnCount=void 0),this.equalCheckDiv&&(this.equalCheckDiv.remove(),this.equalCheckDiv=void 0),this.equalCheck&&(this.equalCheck.remove(),this.equalCheck=void 0)},e}(),sc=function(){function e(e){var t=this;this.isBarClicked=!1,this.removedItems=[],this.tabStopList=[],this.isAddUnits=!0,this.textBoxInputChangeClickHandler=this.onTextBoxInputChangeClick.bind(this),this.selectHandlerClickHandler=this.onSelectHandlerClick.bind(this),this.setButtonClickHandler=this.onSetButtonClick.bind(this),this.clearButtonClickHandler=this.onClearButtonClick.bind(this),this.clearAllButtonClickHandler=this.onClearAllButtonClick.bind(this),this.applyParagraphFormat=function(){if(t.defaultTabStopIn.value!==t.documentHelper.defaultTabWidth&&(t.documentHelper.defaultTabWidth=t.defaultTabStopIn.value),t.removedItems.length>0){for(var e=[],i=0;i<t.removedItems.length;i++)e.push(t.removedItems[parseInt(i.toString(),10)].value);t.documentHelper.owner.editorModule.removeTabStops(t.documentHelper.selection.getParagraphsInSelection(),e)}var n=(0,a.isNullOrUndefined)(t.selectedTabStop)?new wa:t.selectedTabStop.value;n.deletePosition=0,n.tabJustification=t.getTabAlignmentValue(),n.tabLeader=t.getTabLeaderValue();var r=[];for(i=0;i<t.tabStopList.length;i++)r.push(t.tabStopList[parseInt(i.toString(),10)].value);if((0,a.isNullOrUndefined)(t.selectedTabStop)){var o=Pa.getNumberFromString(t.textBoxInput.value);"NaN"!==o.toString()&&(n.position=o,r.push(n))}t.documentHelper.owner.editorModule.onApplyParagraphFormat("tabStop",r,!1,!1),t.closeTabDialog()},this.textBoxInputChange=function(e){for(var i=Pa.getNumberFromString(t.textBoxInput.value),n=0;n<t.tabStopList.length;n++){if(Pa.getNumberFromString(t.tabStopList[parseInt(n.toString(),10)].displayText)===i){t.selectedTabStop=t.tabStopList[parseInt(n.toString(),10)];break}t.selectedTabStop=void 0}t.isAddUnits=!1;var r=t.listviewInstance.dataSource.indexOf(t.selectedTabStop),o=r>=0?t.listviewInstance.dataSource[parseInt(r.toString(),10)]:void 0;t.listviewInstance.selectItem(o),t.isAddUnits=!0},this.setButtonClick=function(e){if((0,a.isNullOrUndefined)(t.selectedTabStop)){if("NaN"===(l=parseFloat(Pa.getNumberFromString(t.textBoxInput.value).toFixed(2))).toString())return;var i=new wa;i.position=l,i.tabJustification=t.getTabAlignmentValue(),i.tabLeader=t.getTabLeaderValue(),i.deletePosition=0;for(var n=[],r=0;r<t.tabStopList.length;r++)n.push(t.tabStopList[parseInt(r.toString(),10)].value);var o=t.documentHelper.owner.editorModule.addTabStopToCollection(n,i,!0),s={displayText:parseFloat(l.toFixed(2))+" pt",value:i};t.tabStopList.splice(o,0,s),t.selectedTabStop=s,t.listviewInstance.dataSource=t.tabStopList,t.listviewInstance.refresh(),t.listviewInstance.selectItem(t.selectedTabStop)}else{var l;(l=t.selectedTabStop.value).tabJustification=t.getTabAlignmentValue(),l.tabLeader=t.getTabLeaderValue()}},this.clearAllButtonClick=function(e){for(var i=0;i<t.tabStopList.length;i++)t.removedItems.push(t.tabStopList[parseInt(i.toString(),10)]);t.displayDiv.innerText=t.localeValue.getConstant("All"),t.tabStopList=[],t.listviewInstance.dataSource=[],t.listviewInstance.refresh(),t.selectedTabStop=void 0,t.textBoxInput.value="",t.updateButtons()},this.clearButtonClick=function(e){t.removedItems.push(t.selectedTabStop),t.displayDiv.innerText!==t.localeValue.getConstant("All")&&(""!==t.displayDiv.innerText&&(t.displayDiv.innerText+=", "),t.displayDiv.innerText+=t.selectedTabStop.displayText);var i=t.tabStopList.indexOf(t.selectedTabStop);i===t.tabStopList.length-1?(t.tabStopList.splice(i,1),t.selectedTabStop=t.tabStopList[i-1]):0===t.tabStopList.length?t.selectedTabStop=void 0:(t.tabStopList.splice(i,1),t.selectedTabStop=t.tabStopList[parseInt(i.toString(),10)]),t.listviewInstance.refresh(),(0,a.isNullOrUndefined)(t.selectedTabStop)?t.textBoxInput.value="":t.textBoxInput.value=!(0,a.isNullOrUndefined)(t.selectedTabStop)&&t.tabStopList.length>0?t.selectedTabStop.displayText:"",t.updateButtons()},this.closeTabDialog=function(){t.documentHelper.hideDialog()},this.selectHandler=function(e){t.isAddUnits&&t.focusTextBox(e.text),t.selectedTabStop=e.data,(0,a.isNullOrUndefined)(t.selectedTabStop)||"Bar"!==t.selectedTabStop.value.tabJustification||(t.isBarClicked=!0),t.updateButtons()},this.onBarClick=function(e){t.clearTabLeaderButton(),t.disableOrEnableTabLeaderButton(!0),t.isBarClicked=!0},this.onTabAlignmentButtonClick=function(e){t.disableOrEnableTabLeaderButton(!1),t.isBarClicked&&(t.updateTabLeaderButton("None"),t.isBarClicked=!1)},this.documentHelper=e}return e.prototype.getModuleName=function(){return"TabDialog"},e.prototype.onTextBoxInputChangeClick=function(e){this.textBoxInputChange(e)},e.prototype.onSetButtonClick=function(e){this.setButtonClick(e)},e.prototype.onClearAllButtonClick=function(e){this.clearAllButtonClick(e)},e.prototype.onClearButtonClick=function(e){this.clearButtonClick(e)},e.prototype.initTabsDialog=function(e,t){var i=this.documentHelper.owner.containerId;this.target=(0,a.createElement)("div",{id:i+"_tab",className:"e-de-tab"}),this.commonDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.target.appendChild(this.commonDiv),this.tabStopLabelDiv=(0,a.createElement)("div",{innerHTML:e.getConstant("Tab stop position")+":",className:"e-de-para-dlg-heading"}),this.tabStopDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-left"}),this.tabStopDiv.appendChild(this.tabStopLabelDiv),this.tabListDiv=(0,a.createElement)("div",{className:"e-tab-list"}),this.tabStopDiv.appendChild(this.tabListDiv),t&&this.tabListDiv.classList.add("e-de-rtl"),this.textBoxDiv=(0,a.createElement)("div",{className:"e-bookmark-textboxdiv"}),this.tabListDiv.appendChild(this.textBoxDiv),this.textBoxInput=(0,a.createElement)("input",{className:"e-input e-tab-textbox-input",attrs:{autofocus:"true"}}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.setAttribute("aria-label",e.getConstant("Tab stop position")),this.textBoxDiv.appendChild(this.textBoxInput),this.textBoxDiv.addEventListener("keyup",this.textBoxInputChangeClickHandler),this.textBoxInput.value=!(0,a.isNullOrUndefined)(this.tabStopList)&&this.tabStopList.length>0?this.tabStopList[0].displayText:"",this.listviewDiv=(0,a.createElement)("div",{className:"e-tab-listViewDiv",attrs:{tabindex:"-1"}}),this.listviewDiv.setAttribute("aria-label",e.getConstant("TabMarkList")),this.tabListDiv.appendChild(this.listviewDiv),this.listviewInstance=new il.ListView({dataSource:this.tabStopList,fields:{text:"displayText"},cssClass:"e-bookmark-listview"}),this.listviewInstance.appendTo(this.listviewDiv),this.listviewInstance.addEventListener("select",this.selectHandlerClickHandler),this.commonDiv.appendChild(this.tabStopDiv),this.defaultTablabelDiv=(0,a.createElement)("div",{innerHTML:e.getConstant("Default tab stops")+":",className:"e-de-para-dlg-heading"}),this.defaultTabDiv=(0,a.createElement)("div",{className:"e-de-subcontainer-right"}),this.commonDiv.appendChild(this.defaultTabDiv),this.defaultTabStopDiv=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.defaultTabStop=(0,a.createElement)("input",{attrs:{type:"text"}}),this.defaultTabStopDiv.appendChild(this.defaultTablabelDiv),this.defaultTabStopDiv.appendChild(this.defaultTabStop),this.defaultTabDiv.appendChild(this.defaultTabStopDiv),this.defaultTabStopIn=new rl.NumericTextBox({format:"# pt",value:this.documentHelper.defaultTabWidth,min:0,max:1584,step:1,enablePersistence:!1,placeholder:e.getConstant("Default tab stops")}),this.defaultTabStopIn.appendTo(this.defaultTabStop),this.defaultTabWarningDiv=(0,a.createElement)("div",{innerHTML:e.getConstant("Tab stops to be cleared")+":",className:"e-de-dlg-container"}),this.defaultTabDiv.appendChild(this.defaultTabWarningDiv),this.displayDiv=(0,a.createElement)("div",{className:"e-defaultTablabelDiv"}),this.documentHelper.owner.enableRtl?this.displayDiv.style.marginRight="20px":this.displayDiv.style.marginLeft="20px",this.defaultTabDiv.appendChild(this.displayDiv),this.alignmentDiv=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.target.appendChild(this.alignmentDiv),this.alignmentLabelDiv=(0,a.createElement)("div",{innerHTML:e.getConstant("Alignment")+":",className:"e-de-para-dlg-heading"}),this.alignmentDiv.appendChild(this.alignmentLabelDiv),this.alignmentPropertyDiv=(0,a.createElement)("div",{styles:"display: flex;"}),this.alignmentDiv.appendChild(this.alignmentPropertyDiv),this.alignmentPropertyDiv1=(0,a.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),this.leftDiv=(0,a.createElement)("div"),this.leftRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.decimalDiv=(0,a.createElement)("div"),this.decimalRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.leftDiv.appendChild(this.leftRadioBtn),this.decimalDiv.appendChild(this.decimalRadioBtn),this.alignmentPropertyDiv1.appendChild(this.leftDiv),this.alignmentPropertyDiv1.appendChild(this.decimalDiv),this.alignmentPropertyDiv.appendChild(this.alignmentPropertyDiv1),this.left=new tl.RadioButton({label:e.getConstant("Left"),name:"alignment",value:"left",cssClass:"e-small",checked:!0,enableRtl:t,change:this.onTabAlignmentButtonClick}),this.decimal=new tl.RadioButton({label:e.getConstant("Decimal"),name:"alignment",value:"decimal",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.left.appendTo(this.leftRadioBtn),this.decimal.appendTo(this.decimalRadioBtn),this.leftRadioBtn.setAttribute("aria-label",e.getConstant("Left")),this.decimalRadioBtn.setAttribute("aria-label",e.getConstant("Decimal")),this.alignmentPropertyDiv2=(0,a.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),this.centerDiv=(0,a.createElement)("div"),this.centerRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.barDiv=(0,a.createElement)("div"),this.barRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.barDiv.appendChild(this.barRadioBtn),this.centerDiv.appendChild(this.centerRadioBtn),this.alignmentPropertyDiv2.appendChild(this.centerDiv),this.alignmentPropertyDiv2.appendChild(this.barDiv),this.bar=new tl.RadioButton({label:e.getConstant("Bar"),name:"alignment",value:"bar",cssClass:"e-small",enableRtl:t,change:this.onBarClick}),this.center=new tl.RadioButton({label:e.getConstant("Center"),name:"alignment",value:"center",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.bar.appendTo(this.barRadioBtn),this.center.appendTo(this.centerRadioBtn),this.barRadioBtn.setAttribute("aria-label",e.getConstant("Bar")),this.centerRadioBtn.setAttribute("aria-label",e.getConstant("Center")),this.alignmentPropertyDiv.appendChild(this.alignmentPropertyDiv2),this.alignmentPropertyDiv3=(0,a.createElement)("div",{styles:"display: flex; flex-direction: column;width: 33.33%"}),this.rightDiv=(0,a.createElement)("div"),this.rightRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.rightDiv.appendChild(this.rightRadioBtn),this.alignmentPropertyDiv3.appendChild(this.rightDiv),this.right=new tl.RadioButton({label:e.getConstant("Right"),name:"alignment",value:"right",cssClass:"e-small",enableRtl:t,change:this.onTabAlignmentButtonClick}),this.right.appendTo(this.rightRadioBtn),this.rightRadioBtn.setAttribute("aria-label",e.getConstant("Right")),this.alignmentPropertyDiv.appendChild(this.alignmentPropertyDiv3),this.tabLeaderDiv=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.tabLeaderLabelDiv=(0,a.createElement)("div",{innerHTML:e.getConstant("Leader")+":",className:"e-de-para-dlg-heading"}),this.tabLeaderDiv.appendChild(this.tabLeaderLabelDiv),this.target.appendChild(this.tabLeaderDiv),this.tabLeaderPropertyDiv=(0,a.createElement)("div",{styles:"display: flex;"}),this.tabLeaderDiv.appendChild(this.tabLeaderPropertyDiv),this.tabLeaderPropertyDiv1=(0,a.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),this.noneDiv=(0,a.createElement)("div"),this.noneRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.underscoreDiv=(0,a.createElement)("div"),this.underscoreRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.noneDiv.appendChild(this.noneRadioBtn),this.underscoreDiv.appendChild(this.underscoreRadioBtn),this.tabLeaderPropertyDiv1.appendChild(this.noneDiv),this.tabLeaderPropertyDiv1.appendChild(this.underscoreDiv),this.none=new tl.RadioButton({label:"1 "+e.getConstant("None"),name:"tabLeader",value:"none",cssClass:"e-small",checked:!0,enableRtl:t}),this.underscore=new tl.RadioButton({label:"4 _____",name:"tabLeader",value:"underscore",cssClass:"e-small",enableRtl:t}),this.none.appendTo(this.noneRadioBtn),this.underscore.appendTo(this.underscoreRadioBtn),this.tabLeaderPropertyDiv.appendChild(this.tabLeaderPropertyDiv1),this.tabLeaderPropertyDiv2=(0,a.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),this.dottedDiv=(0,a.createElement)("div"),this.dottedRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.singleDiv=(0,a.createElement)("div"),this.singleRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.dottedDiv.appendChild(this.dottedRadioBtn),this.singleDiv.appendChild(this.singleRadioBtn),this.dotted=new tl.RadioButton({label:"2 .......",name:"tabLeader",value:"dotted",cssClass:"e-small",enableRtl:t}),this.single=new tl.RadioButton({label:"5 -------",name:"tabLeader",value:"single",cssClass:"e-small",enableRtl:t}),this.dotted.appendTo(this.dottedRadioBtn),this.single.appendTo(this.singleRadioBtn),this.tabLeaderPropertyDiv2.appendChild(this.dottedDiv),this.tabLeaderPropertyDiv2.appendChild(this.singleDiv),this.tabLeaderPropertyDiv.appendChild(this.tabLeaderPropertyDiv2),this.tabLeaderPropertyDiv3=(0,a.createElement)("div",{styles:"display: flex; flex-direction: column; width: 33.33%"}),this.HyphenDiv=(0,a.createElement)("div"),this.HyphenRadioBtn=(0,a.createElement)("input",{attrs:{type:"radiobutton"}}),this.HyphenDiv.appendChild(this.HyphenRadioBtn),this.tabLeaderPropertyDiv3.appendChild(this.HyphenDiv),this.Hyphen=new tl.RadioButton({label:"3 -------",name:"tabLeader",value:"hyphen",cssClass:"e-small",enableRtl:t}),this.Hyphen.appendTo(this.HyphenRadioBtn),this.tabLeaderPropertyDiv.appendChild(this.tabLeaderPropertyDiv3),this.buttonDiv=(0,a.createElement)("div",{className:"e-de-tab-button",styles:"display: flex;"}),this.target.appendChild(this.buttonDiv),this.tableElement=(0,a.createElement)("table"),this.buttonDiv.appendChild(this.tableElement),this.tableElement.style.width="100%";var n=this.tableElement.insertRow(),r=n.insertCell();this.setbuttonDiv=(0,a.createElement)("div",{className:"e-de-tab-setBtn"}),this.buttonDiv.appendChild(this.setbuttonDiv),this.setButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Set"),attrs:{type:"button"}}),this.setButtonElement.setAttribute("aria-label",e.getConstant("Set")),this.setbuttonDiv.appendChild(this.setButtonElement),this.setButton=new tl.Button({cssClass:"e-button-custom"}),this.setButton.appendTo(this.setButtonElement),r.appendChild(this.setbuttonDiv),this.setButtonElement.addEventListener("click",this.setButtonClickHandler),r.style.width="33.33%",r.style.display="table-cell",r=n.insertCell(),this.clearbuttonDiv=(0,a.createElement)("div",{className:"e-de-tab-clearBtn"}),this.buttonDiv.appendChild(this.clearbuttonDiv),this.clearButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Clear"),attrs:{type:"button"}}),this.clearButtonElement.setAttribute("aria-label",e.getConstant("Clear")),this.clearbuttonDiv.appendChild(this.clearButtonElement),this.clearButton=new tl.Button({cssClass:"e-button-custom"}),this.clearButton.appendTo(this.clearButtonElement),this.clearButtonElement.addEventListener("click",this.clearButtonClickHandler),r.appendChild(this.clearbuttonDiv),r.style.width="33.33%",r.style.display="table-cell",r=n.insertCell(),this.clearAllbuttonDiv=(0,a.createElement)("div",{className:"e-de-tab-clearAllBtn"}),this.buttonDiv.appendChild(this.clearAllbuttonDiv),this.clearAllButtonElement=(0,a.createElement)("button",{innerHTML:e.getConstant("Clear All"),attrs:{type:"button"}}),this.clearAllButtonElement.setAttribute("aria-label",e.getConstant("Clear All")),this.clearAllbuttonDiv.appendChild(this.clearAllButtonElement),this.clearAllButton=new tl.Button({cssClass:"e-button-custom"}),this.clearAllButton.appendTo(this.clearAllButtonElement),this.clearAllButtonElement.addEventListener("click",this.clearAllButtonClickHandler),r.appendChild(this.clearAllbuttonDiv),r.style.width="33.33%",r.style.display="table-cell",this.selectedTabStop=!(0,a.isNullOrUndefined)(this.tabStopList)&&this.tabStopList.length>0?this.tabStopList[0]:void 0,this.updateButtons()},e.prototype.getTabAlignmentValue=function(){return this.left.checked?"Left":this.center.checked?"Center":this.right.checked?"Right":this.decimal.checked?"Decimal":this.bar.checked?"Bar":"Left"},e.prototype.getTabLeaderValue=function(){return this.none.checked?"None":this.dotted.checked?"Dot":this.Hyphen.checked?"Hyphen":this.underscore.checked?"Underscore":this.single.checked?"Single":"None"},e.prototype.onSelectHandlerClick=function(e){this.selectHandler(e)},e.prototype.updateButtons=function(){(0,a.isNullOrUndefined)(this.selectedTabStop)?(this.updateTabAlignmentButton("Left"),this.updateTabLeaderButton("None")):(this.updateTabAlignmentButton(this.selectedTabStop.value.tabJustification),this.updateTabLeaderButton(this.selectedTabStop.value.tabLeader))},e.prototype.updateTabLeaderButton=function(e){if(this.clearTabLeaderButton(),"Bar"!==this.getTabAlignmentValue())switch(e){case"None":default:this.none.checked=!0;break;case"Single":this.single.checked=!0;break;case"Dot":this.dotted.checked=!0;break;case"Hyphen":this.Hyphen.checked=!0;break;case"Underscore":this.underscore.checked=!0}},e.prototype.updateTabAlignmentButton=function(e){switch(this.clearTabAlignmentButton(),e){case"Left":this.left.checked=!0;break;case"Center":this.center.checked=!0;break;case"Right":this.right.checked=!0;break;case"Decimal":this.decimal.checked=!0;break;case"Bar":return this.bar.checked=!0,this.clearTabLeaderButton(),void this.disableOrEnableTabLeaderButton(!0)}this.disableOrEnableTabLeaderButton(!1)},e.prototype.clearTabLeaderButton=function(){this.none.checked=!1,this.single.checked=!1,this.dotted.checked=!1,this.Hyphen.checked=!1,this.underscore.checked=!1},e.prototype.disableOrEnableTabLeaderButton=function(e){this.none.disabled=e,this.single.disabled=e,this.dotted.disabled=e,this.Hyphen.disabled=e,this.underscore.disabled=e},e.prototype.clearTabAlignmentButton=function(){this.left.checked=!1,this.center.checked=!1,this.right.checked=!1,this.decimal.checked=!1,this.bar.checked=!1},e.prototype.focusTextBox=function(e){this.textBoxInput.value=e;var t=this.textBoxInput;t.setSelectionRange(0,e.length),t.focus()},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e;var t=this.documentHelper.owner.editorModule.getTabsInSelection();this.tabStopList=[];for(var i=0;i<t.length;i++){var n={displayText:parseFloat(t[i].position.toFixed(2))+" pt",value:t[i].clone()};this.tabStopList.push(n)}this.initTabsDialog(e,this.documentHelper.owner.enableRtl),this.documentHelper.dialog.header=e.getConstant("Tabs"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.buttons=[{click:this.applyParagraphFormat,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeTabDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.show()},e.prototype.destroy=function(){this.removeEvents(),this.removeElements(),this.target=void 0,this.textBoxInput=void 0,this.defaultTabStopIn=void 0,this.left=void 0,this.right=void 0,this.center=void 0,this.decimal=void 0,this.bar=void 0,this.none=void 0,this.dotted=void 0,this.single=void 0,this.Hyphen=void 0,this.setButton=void 0,this.clearButton=void 0,this.clearAllButton=void 0,this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.selectedTabStop=void 0,this.isBarClicked=void 0,this.removedItems=void 0,this.tabStopList=void 0,this.localeValue=void 0},e.prototype.removeEvents=function(){this.textBoxDiv&&this.textBoxDiv.removeEventListener("keyup",this.textBoxInputChangeClickHandler),this.setButtonElement&&this.setButtonElement.removeEventListener("click",this.setButtonClickHandler),this.clearButtonElement&&this.clearButtonElement.removeEventListener("click",this.clearButtonClickHandler),this.clearAllButtonElement&&this.clearAllButtonElement.removeEventListener("click",this.clearAllButtonClickHandler),this.listviewInstance&&this.listviewInstance.removeEventListener("select",this.selectHandlerClickHandler)},e.prototype.removeElements=function(){this.commonDiv&&(this.commonDiv.remove(),this.commonDiv=void 0),this.tabStopLabelDiv&&(this.tabStopLabelDiv.remove(),this.tabStopLabelDiv=void 0),this.tabStopDiv&&(this.tabStopDiv.remove(),this.tabStopDiv=void 0),this.tabListDiv&&(this.tabListDiv.remove(),this.tabListDiv=void 0),this.textBoxDiv&&(this.textBoxDiv.remove(),this.textBoxDiv=void 0),this.listviewDiv&&(this.listviewDiv.remove(),this.listviewDiv=void 0),this.defaultTablabelDiv&&(this.defaultTablabelDiv.remove(),this.defaultTablabelDiv=void 0),this.defaultTabDiv&&(this.defaultTabDiv.remove(),this.defaultTabDiv=void 0),this.defaultTabStopDiv&&(this.defaultTabStopDiv.remove(),this.defaultTabStopDiv=void 0),this.defaultTabWarningDiv&&(this.defaultTabWarningDiv.remove(),this.defaultTabWarningDiv=void 0),this.defaultTabStop&&(this.defaultTabStop.remove(),this.defaultTabStop=void 0),this.displayDiv&&(this.displayDiv.remove(),this.displayDiv=void 0),this.alignmentDiv&&(this.alignmentDiv.remove(),this.alignmentDiv=void 0),this.alignmentLabelDiv&&(this.alignmentLabelDiv.remove(),this.alignmentLabelDiv=void 0),this.alignmentPropertyDiv&&(this.alignmentPropertyDiv.remove(),this.alignmentPropertyDiv=void 0),this.alignmentPropertyDiv1&&(this.alignmentPropertyDiv1.remove(),this.alignmentPropertyDiv1=void 0),this.leftDiv&&(this.leftDiv.remove(),this.leftDiv=void 0),this.leftRadioBtn&&(this.leftRadioBtn.remove(),this.leftRadioBtn=void 0),this.decimalDiv&&(this.decimalDiv.remove(),this.decimalDiv=void 0),this.decimalRadioBtn&&(this.decimalRadioBtn.remove(),this.decimalRadioBtn=void 0),this.alignmentPropertyDiv2&&(this.alignmentPropertyDiv2.remove(),this.alignmentPropertyDiv2=void 0),this.centerDiv&&(this.centerDiv.remove(),this.centerDiv=void 0),this.centerRadioBtn&&(this.centerRadioBtn.remove(),this.centerRadioBtn=void 0),this.barDiv&&(this.barDiv.remove(),this.barDiv=void 0),this.barRadioBtn&&(this.barRadioBtn.remove(),this.barRadioBtn=void 0),this.alignmentPropertyDiv3&&(this.alignmentPropertyDiv3.remove(),this.alignmentPropertyDiv3=void 0),this.rightDiv&&(this.rightDiv.remove(),this.rightDiv=void 0),this.rightRadioBtn&&(this.rightRadioBtn.remove(),this.rightRadioBtn=void 0),this.tabLeaderDiv&&(this.tabLeaderDiv.remove(),this.tabLeaderDiv=void 0),this.tabLeaderLabelDiv&&(this.tabLeaderLabelDiv.remove(),this.tabLeaderLabelDiv=void 0),this.tabLeaderPropertyDiv&&(this.tabLeaderPropertyDiv.remove(),this.tabLeaderPropertyDiv=void 0),this.tabLeaderPropertyDiv1&&(this.tabLeaderPropertyDiv1.remove(),this.tabLeaderPropertyDiv1=void 0),this.noneDiv&&(this.noneDiv.remove(),this.noneDiv=void 0),this.noneRadioBtn&&(this.noneRadioBtn.remove(),this.noneRadioBtn=void 0),this.underscoreDiv&&(this.underscoreDiv.remove(),this.underscoreDiv=void 0),this.underscoreRadioBtn&&(this.underscoreRadioBtn.remove(),this.underscoreRadioBtn=void 0),this.tabLeaderPropertyDiv2&&(this.tabLeaderPropertyDiv2.remove(),this.tabLeaderPropertyDiv2=void 0),this.dottedDiv&&(this.dottedDiv.remove(),this.dottedDiv=void 0),this.dottedRadioBtn&&(this.dottedRadioBtn.remove(),this.dottedRadioBtn=void 0),this.singleDiv&&(this.singleDiv.remove(),this.singleDiv=void 0),this.singleRadioBtn&&(this.singleRadioBtn.remove(),this.singleRadioBtn=void 0),this.tabLeaderPropertyDiv3&&(this.tabLeaderPropertyDiv3.remove(),this.tabLeaderPropertyDiv3=void 0),this.HyphenDiv&&(this.HyphenDiv.remove(),this.HyphenDiv=void 0),this.HyphenRadioBtn&&(this.HyphenRadioBtn.remove(),this.HyphenRadioBtn=void 0),this.buttonDiv&&(this.buttonDiv.remove(),this.buttonDiv=void 0),this.tableElement&&(this.tableElement.remove(),this.tableElement=void 0),this.setbuttonDiv&&(this.setbuttonDiv.remove(),this.setbuttonDiv=void 0),this.setButtonElement&&(this.setButtonElement.remove(),this.setButtonElement=void 0),this.setButton&&(this.setButton.destroy(),this.setButton=void 0),this.clearbuttonDiv&&(this.clearbuttonDiv.remove(),this.clearbuttonDiv=void 0),this.clearButtonElement&&(this.clearButtonElement.remove(),this.clearButtonElement=void 0),this.clearButton&&(this.clearButton.destroy(),this.clearButton=void 0),this.clearAllbuttonDiv&&(this.clearAllbuttonDiv.remove(),this.clearAllbuttonDiv=void 0),this.clearAllButtonElement&&(this.clearAllButtonElement.remove(),this.clearAllButtonElement=void 0),this.clearAllButton&&(this.clearAllButton.destroy(),this.clearAllButton=void 0),this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0)},e}(),ac=function(){function e(e){this.location=new Sa(0,0),this.isUpdateLocation=!0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selectionModule.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selectionModule.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selectionModule.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCurrentParaBidi",{get:function(){return!(0,a.isNullOrUndefined)(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e(this.owner);return t.currentWidget=this.currentWidget,t.offset=this.offset,t.location=this.location,t},e.prototype.containsRtlText=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].isRightToLeft)return!0;return!1},e.prototype.setPositionForSelection=function(e,t,i,n){var r=!1;(0,a.isNullOrUndefined)(t)?this.currentWidget=e:(this.currentWidget=t.line,t.nextNode instanceof _l&&i>t.length&&(r=this.selection.isLastRenderedInline(t,t.length))),this.location=n,this.offset=r?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,i)},e.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof Sa&&this.location.copy(i)},e.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):e.paragraph.lastChild.getEndOffset()+1,this.updatePhysicalPosition(!0)},e.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},e.prototype.setPositionForCurrentIndex=function(e){var t={index:e},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index),this.setPositionParagraph(i,this.offset)},e.prototype.getPage=function(e){var t=e.index.indexOf(";"),i="0";return t>=0&&(i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";","")),t=parseInt(i,10),this.documentHelper.pages[t]},e.prototype.getParagraphWidget=function(e){if(!(0,a.isNullOrUndefined)(e.index)){var t=this.getPage(e);return this.getLineWidget(void 0,e,t)}},e.prototype.getLineWidget=function(e,t,i){if(!(0,a.isNullOrUndefined)(t.index)){var n=t.index.indexOf(";"),r="0";if(n>=0&&(r=t.index.substring(0,n),t.index=t.index.substring(n).replace(";","")),"H"===r||"F"===r)e="H"===r?i.headerWidget:i.footerWidget;else if("FN"===r||"EN"===r){var o=t.index.indexOf(";"),s=t.index.substring(0,o);t.index=t.index.substring(o).replace(";",""),e="FN"===r?i.footnoteWidget.bodyWidgets[s]:i.endnoteWidget.bodyWidgets[s]}else(0,a.isNullOrUndefined)(i)||(e=parseInt(r,10)<i.bodyWidgets.length?i.bodyWidgets[parseInt(r,10)]:i.bodyWidgets[0]);if(n=parseInt(r,10),e instanceof Wl&&(n=t.index.indexOf(";"),r="0",r=t.index.substring(0,n),t.index=t.index.substring(n).replace(";",""),n=parseInt(r,10)),e instanceof Ul&&n>=e.childWidgets.length&&(t.index="0;0",n=e.childWidgets.length-1),n>=0&&n<e.childWidgets.length){var l=e.childWidgets[n];if(l instanceof zl)return t.index.indexOf(";")>0&&(t.index="0"),l;if(l instanceof Nl)return t.index.indexOf(";")>0?this.getLineWidget(l,t):l instanceof Al?this.getLineWidget(this.documentHelper.getFirstParagraphInFirstCell(l),t):l instanceof Ul&&-1===t.index.indexOf(";")?this.documentHelper.getFirstParagraphInFirstCell(l.ownerTable).childWidgets[0]:void 0}else if(e.nextRenderedWidget instanceof Nl)return t.index="0",e.nextRenderedWidget instanceof Al?this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,t)}},e.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},e.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},e.prototype.isInSameParagraphIndex=function(e){if((0,a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");return this.paragraph.index===e.paragraph.index},e.prototype.isInSameParagraph=function(e){if((0,a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},e.prototype.isInSameListParagraph=function(e){if((0,a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");return this.paragraph.paragraphFormat.listFormat.listId===e.paragraph.paragraphFormat.listFormat.listId},e.prototype.isExistBefore=function(e){if((0,a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset<e.offset;var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return t===i?t.childWidgets.indexOf(this.currentWidget)<i.childWidgets.indexOf(e.currentWidget):t.containerWidget===i.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)<i.containerWidget.childWidgets.indexOf(i):this.owner.selectionModule.isExistBefore(t,i)},e.prototype.isExistAfter=function(e){if((0,a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset>e.offset;if(this.currentWidget.paragraph===e.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget);var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(i)&&(t.containerWidget instanceof Ol&&i.containerWidget instanceof Ol&&t.containerWidget===i.containerWidget?t.isInsideTable&&i.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)>i.containerWidget.childWidgets.indexOf(i):this.owner.selectionModule.isExistAfter(t,i))},e.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},e.prototype.getHierarchicalIndex=function(e,t){return e?e.getHierarchicalIndex(t):t},e.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.setPositionForLineWidget=function(e,t){var i=this.selection.getLineLength(e),n=e.paragraph.childWidgets.indexOf(e);if(e.isLastLine()&&((0,a.isNullOrUndefined)(e.paragraph.bodyWidget.footNoteReference)?i+=1:i+=e.paragraph.bodyWidget.footNoteReference.text.length),t>i){var r=void 0;if(n>=e.paragraph.childWidgets.length-1){var o=this.selection.getNextRenderedBlock(e.paragraph);o&&o.index===e.paragraph.index&&(r=o.firstChild)}else r=e.paragraph.childWidgets[n+1];this.setPositionForLineWidget(r,t-i)}else if(t<0){var s=e.paragraph.childWidgets[n-1],l=this.selection.getLineLength(s)+t;this.setPositionForLineWidget(s,l)}else this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.moveNextPosition=function(t){(0,a.isNullOrUndefined)(t)&&(t=!0);var i=this.selection.getNextStartInline(this.currentWidget,this.offset);if(i instanceof _l&&0===i.fieldType&&!(0,a.isNullOrUndefined)(i.fieldEnd)){if(t)return this.moveNextPositionInternal(i),void this.moveNextPosition();var n=i.fieldEnd.line,r=i.fieldEnd,o=n.getOffset(r,1),s=this.getHierarchicalIndex(n,o.toString());if(e.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),s))return void this.selection.end.moveToInline(i.fieldEnd,1);this.moveToInline(i.fieldEnd,1)}var l=this.selection.getNextValidOffset(this.currentWidget,this.offset),d=this.paragraph.childWidgets.indexOf(this.currentWidget),h=0;if(l>this.offset){this.offset=l;var c=this.currentWidget.getInline(this.offset,h);if(i=c.element,h=c.index,!(0,a.isNullOrUndefined)(i)&&h===i.length&&(i.nextNode instanceof _l||i.nextNode instanceof td)){var p=this.documentHelper.getNextValidElement(i.nextNode);(p instanceof _l&&1===p.fieldType||p instanceof td&&1===p.bookmarkType)&&(i=p,this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,this.documentHelper.isFormFillProtectedMode?0:1))}}else if(d+1<this.paragraph.childWidgets.length){var u=this.paragraph.childWidgets[d+1];u&&(this.currentWidget=u,this.offset=this.selection.getStartLineOffset(this.currentWidget));var g=this.currentWidget.getInline(this.offset,h);i=g.element,h=g.index,i instanceof _l&&0===i.fieldType&&this.offset++}else this.updateOffsetToNextParagraph(h,!1);this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousParagraphInTable=function(e){var t,i=this.currentWidget.paragraph;t=i.isInsideTable?e.getPreviousSelectionCell(i.associatedCell):e.getPreviousParagraphBlock(i),(0,a.isNullOrUndefined)(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.updateOffsetToNextParagraph=function(e,t){var i,n=!1,r=void 0,o=this.paragraph.childWidgets.indexOf(this.currentWidget);if(t)if(o+1<this.paragraph.childWidgets.length){var s=this.paragraph.childWidgets[o+1];s&&(this.currentWidget=s,this.offset=1)}else{if(r=this.selection.getNextSelectionBlock(this.paragraph),!(0,a.isNullOrUndefined)(r))if(r.containerWidget instanceof Vl)if(this.selection.start.paragraph.isInsideTable)n=!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,r.associatedCell).ownerTable.contains(r.associatedCell);else n=!0}else r=this.selection.getNextParagraphBlock(this.paragraph);!(0,a.isNullOrUndefined)(r)&&r.childWidgets.length>0&&(n?(this.currentWidget=r.childWidgets[r.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=r.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget)));var l=this.currentWidget.getInline(this.offset,e);i=l.element,e=l.index,i instanceof _l&&0===i.fieldType&&this.offset++},e.prototype.updateOffsetToPrevPosition=function(e,t){var i,n,r=this.paragraph.childWidgets.indexOf(this.currentWidget),o=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);if(this.offset>o)this.offset=o;else if(r>0){var s=this.paragraph.childWidgets[r-1];if(s){this.currentWidget=s;var l=this.currentWidget.getEndOffset();this.offset=l>0?l-1:l}}else{var d=void 0,h=!1;if(t){if(d=this.selection.getPreviousSelectionBlock(this.paragraph),!(0,a.isNullOrUndefined)(d))if(d.containerWidget instanceof Vl)if(this.selection.start.paragraph.isInsideTable)h=!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,d.associatedCell).ownerTable.contains(d.associatedCell);else h=!0}else d=this.selection.getPreviousParagraphBlock(this.paragraph);(0,a.isNullOrUndefined)(d)||(h?(this.currentWidget=d.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=d.childWidgets[d.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset()))}if(e=0,n=(i=this.currentWidget.getInline(this.offset,e)).element,e=i.index,n instanceof _l&&0===n.fieldType&&this.offset++,n instanceof _l){var c=this.selection.getPreviousValidElement(n);(0,a.isNullOrUndefined)(c)||(n=c,this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,n.length),n instanceof _l&&0===n.fieldType&&this.offset--)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;(0,a.isNullOrUndefined)(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},e.prototype.movePreviousPosition=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;e=t.index;this.paragraph.childWidgets.indexOf(this.currentWidget);(i instanceof _l&&1===i.fieldType&&!(0,a.isNullOrUndefined)(i.fieldBegin)||i instanceof td&&1===i.bookmarkType)&&this.movePreviousPositionInternal(i),this.updateOffsetToPrevPosition(e,!1)},e.prototype.moveNextPositionInternal=function(e){var t;(0,a.isNullOrUndefined)(e.fieldSeparator)?t=e.fieldEnd:(t=e.fieldSeparator,this.currentWidget=t.line,this.currentWidget!==e.fieldEnd.line||this.selection.hasValidInline(this.paragraph,t,e.fieldEnd)||(t=e.fieldEnd)),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1)},e.prototype.moveBackward=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),n=i.element;if(t=i.index,!this.owner.selectionModule.isEmpty&&!(0,a.isNullOrUndefined)(n)){var r=this.selection.getNextRenderedElementBox(n,t);if(r instanceof _l&&0===r.fieldType){var o=this.owner.selectionModule.start.getHierarchicalIndexInternal(),s=r.fieldEnd.line.getOffset(r.fieldEnd,1),l=this.getHierarchicalIndex(r.fieldEnd.line,s.toString());if(!e.isForwardSelection(l,o))return void this.owner.selectionModule.start.setPositionParagraph(r.fieldEnd.line,s)}}if(n instanceof _l&&1===n.fieldType&&!(0,a.isNullOrUndefined)(n.fieldBegin)){o=this.owner.selectionModule.start.getHierarchicalIndexInternal(),s=n.line.getOffset(n,1),l=this.getHierarchicalIndex(n.line,s.toString());if(!e.isForwardSelection(o,l)){var d=n.fieldBegin.line.getOffset(n.fieldBegin,0);return this.currentWidget=n.fieldBegin.line,this.offset=d,void this.updatePhysicalPosition(!0)}this.movePreviousPositionInternal(n)}this.updateOffsetToPrevPosition(t,!0)},e.prototype.moveForward=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),n=i.element;if(t=i.index,!(0,a.isNullOrUndefined)(n)){if(!this.owner.selectionModule.isEmpty&&t===n.length&&n instanceof _l&&1===n.fieldType){var r=this.owner.selectionModule.start.getHierarchicalIndexInternal(),o=n.fieldBegin.line.getOffset(n.fieldBegin,0),s=this.getHierarchicalIndex(n.fieldBegin.line,o.toString());if(!e.isForwardSelection(r,s))return void this.owner.selectionModule.start.setPositionParagraph(n.fieldBegin.line,o)}n=this.selection.getNextRenderedElementBox(n,t)}if(n instanceof _l&&!(0,a.isNullOrUndefined)(n.fieldEnd)){var l=0,d=this.owner.selectionModule.start.paragraph.getInline(this.owner.selectionModule.start.offset,l),h=d.element;if(l=d.index,this.selection.getNextRenderedElementBox(h,l)!==n)return n=n.fieldEnd,this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(n)}else n instanceof _l&&(0===n.fieldType||1===n.fieldType)&&(this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,1));t=0;var c=this.selection.getNextValidOffset(this.currentWidget,this.offset),p=this.selection.getLineLength(this.currentWidget),u=this.selection.isParagraphLastLine(this.currentWidget);if(this.offset<c){this.offset=c;var g=this.currentWidget.getInline(this.offset,t);if(n=g.element,t=g.index,!(0,a.isNullOrUndefined)(n)&&t===n.length&&n.nextNode instanceof _l){var m=this.documentHelper.getNextValidElement(n.nextNode);m instanceof _l&&1===m.fieldType&&(n=m,this.offset=this.currentWidget.getOffset(n,1))}}else this.offset===c&&n instanceof _l&&1===n.fieldType&&n.previousNode instanceof gd?this.offset=c:this.offset===c&&this.offset<p+1&&u?this.offset=p+1:this.updateOffsetToNextParagraph(t,!0);this.updatePhysicalPosition(!0)},e.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},e.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/S;/g,""),t=t.replace(/S;/g,""),e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,""),e=e.replace(/FN;/g,""),t=t.replace(/FN;/g,""),e=e.replace(/EN;/g,""),t=t.replace(/EN;/g,"");var i=e.split(";"),n=t.split(";"),r=i.length;r>n.length&&(r=n.length-1);for(var o=0;o<r;o++){var s=parseFloat(i[o]),a=parseFloat(n[o]);if(s!==a)return s<a}return!1},e.prototype.movePreviousPositionInternal=function(e){var t;t=e instanceof _l&&(0,a.isNullOrUndefined)(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),this.currentWidget=t.line;var i=t instanceof _l||t instanceof td&&1===t.bookmarkType?0:t.length;this.offset=this.currentWidget.getOffset(t,i)},e.prototype.moveToWordStartInternal=function(e){var t=this.currentWidget.getEndOffset(),i=this.currentWidget.paragraph,n=this.selection;if(2!==e||this.offset!==t&&this.offset!==t+1){if(this.offset===t+1)this.offset=t;else if(this.offset===n.getStartOffset(i)&&this.currentWidget===i.childWidgets[0]){var r=n.getPreviousParagraphBlock(i);if((0,a.isNullOrUndefined)(r))return;this.currentWidget=r.childWidgets[r.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{if(this.offset===n.getStartLineOffset(this.currentWidget)){var o=i.childWidgets.indexOf(this.currentWidget);o-1>=0&&(this.currentWidget=i.childWidgets[o-1],this.offset=this.currentWidget.getEndOffset())}var s=0,l=this.currentWidget.getInline(this.offset,s),d=l.element;s=l.index,this.getPreviousWordOffset(d,n,s,e,d instanceof _l&&1===d.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},e.prototype.getNextWordOffset=function(e,t,i,n,r,o,s){e instanceof Zl?this.getNextWordOffsetSpan(e,t,i,n,r,o,s):e instanceof gd?this.getNextWordOffsetImage(e,t,i,n,r,o,s):e instanceof _l&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,n,r,o,s):e instanceof _l&&2===e.fieldType||e instanceof td&&0===e.bookmarkType?this.getNextWordOffsetFieldSeparator(e,t,i,n,r,o,s):e instanceof _l&&1===e.fieldType||e instanceof td&&1===e.bookmarkType?this.getNextWordOffsetFieldEnd(e,t,i,n,r,o,s):e instanceof Bd?this.getNextWordOffsetComment(e,t,i,n,r,o,s):e instanceof id&&this.getNextWordOffsetContentControl(e,t,i,n,r,o,s)},e.prototype.getNextWordOffsetFieldBegin=function(e,t,i,n,r,o,s){var l=e.line.getOffset(e,0);e.length;if((0,a.isNullOrUndefined)(e.fieldSeparator))this.getNextWordOffsetFieldEnd(e.fieldEnd,0,i,n,r,o,s);else if(0===i)this.getNextWordOffsetFieldSeparator(e.fieldSeparator,0,i,n,r,o,s);else if(!(0,a.isNullOrUndefined)(e.fieldEnd)){var d=e.fieldSeparator;if(d.line.paragraph!==e.fieldEnd.line.paragraph||this.selection.hasValidInline(d.line.paragraph,d,e.fieldEnd)||(d=e.fieldEnd),this.getNextWordOffset(d,0,i,!(o.paragraph===e.line.paragraph&&o.offset===l),r,o,s),r&&!(0,a.isNullOrUndefined)(e.fieldSeparator)&&o.paragraph===e.line.paragraph&&o.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))return void o.setPositionParagraph(e.line,l);r||o.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length))}},e.prototype.getNextWordOffsetImage=function(e,t,i,n,r,o,s){if(n)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(r=!1);if(0===t){var l=e.line.getOffset(e,0);r=!0,o.offset===l?(0,a.isNullOrUndefined)(e.nextNode)?o.setPositionParagraph(e.line,l+e.length):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s):o.setPositionParagraph(e.line,l)}else(0,a.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},e.prototype.getNextWordOffsetSpan=function(e,t,i,n,r,o,s){if("\t"===e.text||"\v"===e.text){if(n)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(r=!1);if(0===t){r=!0;var l=e.line.getOffset(e,0);o.offset===l?o.setPositionParagraph(e.line,l+e.length):o.setPositionParagraph(e.line,l)}else(0,a.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}else{var d=0;if(0===t&&r&&-1===Pa.wordSplitCharacters.indexOf(e.text[0])){if(o.setPositionParagraph(e.line,e.line.getOffset(e,t)),n)return}else if(t<e.length){var h=t>0&&e.text.length-1>=t?e.text.slice(t,e.length):e.text;if(-1===(d=Pa.indexOfAny(h,Pa.wordSplitCharacters))&&e.nextNode instanceof Bd&&(0,a.isNullOrUndefined)(e.nextNode.nextNode)&&(d=e.length),-1!==d){if(n)return void(r=!1);var c=e.line.getOffset(e,d+t),p=[" ","　"];if((s||-1===p.indexOf(h[d]))&&!r&&e.line.paragraph===o.paragraph&&c!==o.offset)return r=!0,void o.setPositionParagraph(e.line,c);var u=!1;for(-1!==p.indexOf(h[d])&&-1===p.indexOf(h[d+1])&&(u=!0,d++);d<h.length&&!u&&-1!==Pa.wordSplitCharacters.indexOf(h[d]);)if(d++,-1!==p.indexOf(h[d])&&-1===p.indexOf(h[d+1])&&-1!==Pa.wordSplitCharacters.indexOf(h[d+1])){d++;break}r=!0;var g=void 0;(0,a.isNullOrUndefined)(e.nextNode)||(g=e.nextNode.text),d<h.length||!(0,a.isNullOrUndefined)(g)&&e.line==e.nextNode.line&&-1!==p.indexOf(h[h.length-1])&&-1===p.indexOf(g[0])||(0,a.isNullOrUndefined)(e.nextNode)?o.setPositionParagraph(e.line,e.line.getOffset(e,d+t)):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}else(0,a.isNullOrUndefined)(e.nextNode)?o.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}else(0,a.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)}},e.prototype.getNextWordOffsetFieldSeparator=function(e,t,i,n,r,o,s){(0,a.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},e.prototype.getNextWordOffsetComment=function(e,t,i,n,r,o,s){(0,a.isNullOrUndefined)(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},e.prototype.getNextWordOffsetContentControl=function(e,t,i,n,r,o,s){(0,a.isNullOrUndefined)(e.nextNode)?o.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,i,n,r,o,s)},e.prototype.getNextWordOffsetFieldEnd=function(e,t,i,n,r,o,s){var l=e.line.getOffset(e,0),d=l+e.length;o.offset===l&&(o.setPositionParagraph(e.line,d),(0,a.isNullOrUndefined)(e.nextNode))||((0,a.isNullOrUndefined)(e.nextNode)?o.setPositionParagraph(e.line,l):(this.getNextWordOffset(e.nextNode,0,i,!1,r,o,s),o.offset===d&&o.setPositionParagraph(e.line,l)),r=!0)},e.prototype.getPreviousWordOffset=function(e,t,i,n,r,o,s,a){e instanceof Zl?this.getPreviousWordOffsetSpan(e,t,i,n,r,o,s,a):e instanceof gd?this.getPreviousWordOffsetImage(e,t,i,n,r,o,s,a):e instanceof _l&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,n,r,o,s,a):e instanceof _l&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,n,r,o,s,a):e instanceof _l&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,n,r,o,s,a):e instanceof td?this.getPreviousWordOffsetBookMark(e,t,i,n,r,o,s,a):e instanceof md&&e.previousNode?this.getPreviousWordOffsetSpan(e.previousNode,t,i,n,r,o,s,a):e instanceof Bd?this.getPreviousWordOffsetComment(e,t,i,n,r,o,s,a):e instanceof id&&this.getPreviousWordOffsetContentControl(e,t,i,n,r,o,s,a)},e.prototype.getPreviousWordOffsetBookMark=function(e,t,i,n,r,o,s,a){if(e.previousNode){if(e.previousNode instanceof Zl){var l=e.previousNode;Pa.lastIndexOfAny(l.text,Pa.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,n,r,o,s,a):a.setPositionParagraph(e.line,e.line.getOffset(e,0))}}else a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldEnd=function(e,t,i,n,r,o,s,l){var d=e.line.getOffset(e,0),h=d+e.length;if((0,a.isNullOrUndefined)(e.fieldSeparator))this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,0,n,r,o,s,l);else if(0!==n||(0,a.isNullOrUndefined)(e.previousNode)){if(!(0,a.isNullOrUndefined)(e.fieldBegin)&&0!==n){c=e.previousNode;if(((0,a.isNullOrUndefined)(c)||c.line.paragraph===e.fieldBegin.line.paragraph&&!t.hasValidInline(c.line.paragraph,c,e.fieldBegin))&&(c=e.fieldBegin),this.getPreviousWordOffset(c,t,c.length,n,!(l.paragraph===e.line.paragraph&&l.offset===h),o,s,l),s&&l.paragraph===e.line.paragraph&&l.offset===d)return void l.setPositionParagraph(e.line,h);s||l.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))}}else{var c=e.previousNode;this.getPreviousWordOffset(c,t,c.length,n,c instanceof _l&&1===c.fieldType,o,s,l)}},e.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,n,r,o,s,a){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,n,r,o,s,a)},e.prototype.getPreviousWordOffsetComment=function(e,t,i,n,r,o,s,a){if(e.previousNode){var l=e.previousNode;e.previousNode instanceof Zl&&Pa.lastIndexOfAny(l.text,Pa.wordSplitCharacters)===l.text.length-1&&t.isSelectCurrentWord?a.setPositionParagraph(e.line,e.line.getOffset(e,1)):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a)}else a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetContentControl=function(e,t,i,n,r,o,s,a){e.previousNode?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldBegin=function(e,t,i,n,r,o,s,l){var d=e.line.getOffset(e,0),h=d+e.length;l.offset===h&&l.setPositionParagraph(e.line,d),(0,a.isNullOrUndefined)(e.previousNode)?e.fieldSeparator?l.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)):l.setPositionParagraph(e.line,t.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,!1,o,s,l),l.offset===d&&(0===n||(0,a.isNullOrUndefined)(e.fieldSeparator)||l.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))))},e.prototype.getPreviousWordOffsetImage=function(e,t,i,n,r,o,s,l){if(r)return l.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(s=!1);if(i===e.length){var d=e.line.getOffset(e,e.length);d===l.offset?l.setPositionParagraph(e.line,d-e.length):l.setPositionParagraph(e.line,d)}else(0,a.isNullOrUndefined)(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,l)},e.prototype.getPreviousWordOffsetSpan=function(e,t,i,n,r,o,s,l){if("\t"===e.text||"\v"===e.text){if(r)return void(s=!1);if(i===e.length){s=!0;var d=e.line.getOffset(e,e.length);d===l.offset?l.setPositionParagraph(e.line,d-e.length):l.setPositionParagraph(e.line,d)}else(0,a.isNullOrUndefined)(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,l)}else{var h=0;if(!o){for(;i>0&&" "===e.text[i-1];)i--;l.setPositionParagraph(e.line,e.line.getOffset(e,i))}if(i>0){if(o=!0,0===i&&s&&-1===Pa.wordSplitCharacters.indexOf(e.text[0]))return l.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(s=!0);var c=e.text.length>i?e.text.slice(0,i):e.text;if(-1!==(h=Pa.lastIndexOfAny(c,Pa.wordSplitCharacters))){if(r)return void(s=!1);for(;h>0&&s&&" "!==c[h]&&-1!==Pa.wordSplitCharacters.indexOf(c[h-1]);)h--;if(" "===c[h]&&!(0,a.isNullOrUndefined)(e.nextElement)&&e.nextElement instanceof Bd&&1===e.nextElement.commentType&&h++," "!==c[h]&&"　"!==c[h]&&s||h++,s=!0,h>0){var p=e.line.getOffset(e,h);e.line.paragraph===l.paragraph&&p===l.offset?this.getPreviousWordOffsetSpan(e,t,i,n,r,o,s,l):l.setPositionParagraph(e.line,p)}else if(e.previousNode instanceof Zl){var u=e.previousNode.text;if(-1!==Pa.wordSplitCharacters.indexOf(e.text[0])&&-1===Pa.wordSplitCharacters.indexOf(u[u.length-1])){p=e.line.getOffset(e,h);return void l.setPositionParagraph(e.line,p)}this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,l)}else l.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,t,i,n,r,o,s,l)}else this.setPreviousWordOffset(e,t,i,n,r,o,s,l)}},e.prototype.setPreviousWordOffset=function(e,t,i,n,r,o,s,a){e.previousNode instanceof ql&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,n,r,o,s,a):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.validateForwardFieldSelection=function(t,i){var n=new e(this.owner);n.setPositionForCurrentIndex(t),n.isUpdateLocation=!1;var r=!1;for(this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.start.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);t!==i&&e.isForwardSelection(t,i);){if(!r)if(n.moveNextPosition(!1),t===n.getHierarchicalIndexInternal())break;var o=0,s=n.currentWidget.getInline(n.offset,o),l=s.element;if(o=s.index,!(0,a.isNullOrUndefined)(l)){var d=this.selection.start.getHierarchicalIndexInternal();if(o===l.length&&l instanceof _l&&1===l.fieldType){if(l.line.getOffset(l,0)===this.offset)return;var h=l.fieldBegin.line,c=h.getOffset(l.fieldBegin,0),p=this.getHierarchicalIndex(h,c.toString());e.isForwardSelection(d,p)||this.selection.start.setPositionParagraph(h,c)}var u=this.selection.getNextRenderedElementBox(l,o);!(0,a.isNullOrUndefined)(u)&&u instanceof ql&&(l=u)}if(r=l instanceof _l&&0===l.fieldType&&!(0,a.isNullOrUndefined)(l.fieldEnd)){if(l.line.getOffset(l,0)===this.offset)return;var g=l.fieldEnd,m=(g.line.paragraph,g.line.getOffset(g,1)),f=this.getHierarchicalIndex(g.line,m.toString());if(!e.isForwardSelection(f,i))return void this.moveToInline(l.fieldEnd,1);n.moveToInline(l.fieldEnd,1)}t=n.getHierarchicalIndexInternal()}},e.prototype.validateBackwardFieldSelection=function(t,i){var n=new e(this.owner);n.setPositionForCurrentIndex(t),n.isUpdateLocation=!1;var r=!1;(this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph)||((0,a.isNullOrUndefined)(this.selection.start.paragraph.previousRenderedWidget)&&this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.end.offset===this.selection.getStartOffset(this.selection.end.paragraph)||this.selection.start.paragraph!==this.selection.end.paragraph)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.start.currentWidget.isLastLine())&&(r=!0),r&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1);for(var o=this.selection.start.getHierarchicalIndexInternal();t!==i&&e.isForwardSelection(i,t);){var s=0,l=n.currentWidget.getInline(n.offset,s),d=l.element;if(s=l.index,!(0,a.isNullOrUndefined)(d)){var h=this.selection.getNextRenderedElementBox(d,s);if(h instanceof _l&&0===h.fieldType){var c=h.fieldEnd.line,p=c.getOffset(h.fieldEnd,1),u=this.getHierarchicalIndex(c,p.toString());e.isForwardSelection(u,o)||(this.selection.start.setPositionParagraph(c,p),o=u)}}if(d instanceof _l&&1===d.fieldType&&!(0,a.isNullOrUndefined)(d.fieldBegin)){var g=d.fieldBegin.line,m=d.fieldBegin,f=g.getOffset(m,0),v=this.getHierarchicalIndex(g,f.toString());if(!e.isForwardSelection(i,v))return void this.moveToInline(d.fieldBegin,0);n.moveToInline(d.fieldBegin,0)}else n.movePreviousPosition();t=n.getHierarchicalIndexInternal()}},e.prototype.paragraphStartInternal=function(e,t){var i=e.getStartLineOffset(this.currentWidget);if(this.offset===i&&t){if(this.moveToNextParagraphInTableCheck())this.moveToPreviousParagraphInTable(e);else if(!(0,a.isNullOrUndefined)(e.getPreviousParagraphBlock(this.currentWidget.paragraph))){var n=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=n.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)}}else this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=i;this.calculateOffset()},e.prototype.calculateOffset=function(){var e=this.owner.selectionModule.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},e.prototype.moveToParagraphStartInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.previousSplitWidget;)i=i.previousSplitWidget;var n=e.getStartOffset(i);this.offset===n&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):(0,a.isNullOrUndefined)(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph)):(this.currentWidget=i.firstChild,this.offset=e.getStartLineOffset(this.currentWidget));var r=this.owner.selectionModule.start.getHierarchicalIndexInternal(),o=this.getHierarchicalIndexInternal();r!==o&&this.validateBackwardFieldSelection(r,o),this.updatePhysicalPosition(!1)},e.prototype.moveToParagraphEndInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.nextSplitWidget;)i=i.nextSplitWidget;this.currentWidget=i.childWidgets[i.childWidgets.length-1];var n=this.currentWidget.getEndOffset()+1;if(this.offset===n&&t){if(this.moveToNextParagraphInTableCheck())this.moveToNextParagraphInTable();else if(!(0,a.isNullOrUndefined)(e.getNextParagraphBlock(this.currentWidget.paragraph))){var r=e.getNextParagraphBlock(this.currentWidget.paragraph);this.currentWidget=r.childWidgets[r.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1}}else this.offset=n;this.calculateOffset()},e.prototype.moveUp=function(e,t){var i=this.currentWidget.paragraph;this.moveToLineStartInternal(e,!0),this.movePreviousPosition();var n=void 0,r=this.currentWidget.paragraph;if(i.isInsideTable&&i!==r&&i.associatedCell!==r.associatedCell&&!(0,a.isNullOrUndefined)(r.associatedCell)&&i.associatedCell.ownerRow===r.associatedCell.ownerRow){var o=r.associatedCell.ownerRow;if(o.previousRenderedWidget instanceof Ul){var s=e.getFirstCellInRegion(o.previousRenderedWidget,r.associatedCell,t,!0),l=e.getLastParagraph(s);this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}else{var d=o.ownerTable.previousRenderedWidget;do{d instanceof Al&&(d=e.getLastBlockInLastCell(d))}while(d instanceof Al);d instanceof Rl&&this.setPosition(d.childWidgets[d.childWidgets.length-1],!1)}n=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable){s=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!0),l=e.getLastParagraph(s);this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}else if(i.isInsideTable&&!(0,a.isNullOrUndefined)(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.previousRenderedWidget!==i.associatedCell.ownerRow.previousSplitWidget&&i.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){s=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!0),l=e.getLastParagraph(s);this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}n=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var h=e.getTop(n);(this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak)&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x),e.updateTextPositionWidget(n,new Sa(t,h),this,!1)},e.prototype.moveDown=function(e,t){var i=this.currentWidget.paragraph,n=this.currentWidget;this.moveToLineEndInternal(e,!0);var r=this.selection.getParagraphLength(this.currentWidget.paragraph);this.offset>r&&(this.offset=r),this.moveNextPosition();var o=void 0;if(i.isInsideTable&&i!==this.currentWidget.paragraph&&i.associatedCell!==this.currentWidget.paragraph.associatedCell&&!(0,a.isNullOrUndefined)(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var s=this.currentWidget.paragraph.associatedCell.ownerRow;if(i.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&i.associatedCell.cellFormat.rowSpan>1&&i.associatedCell.cellFormat.rowSpan+i.associatedCell.ownerRow.rowIndex===i.associatedCell.ownerTable.childWidgets.length&&(s=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),s.nextRenderedWidget instanceof Ul){var l=this.selection.getLastCellInRegion(s.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(l).childWidgets[0],!0)}else{var d=this.selection.getNextRenderedBlock(s.ownerTable);do{d instanceof Al&&(d=this.selection.getFirstBlockInFirstCell(d))}while(d instanceof Al);d instanceof Rl&&this.setPosition(d.childWidgets[0],!0)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable){l=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!1);this.setPosition(this.selection.getFirstParagraph(l).childWidgets[0],!0)}else if(i.isInsideTable&&!(0,a.isNullOrUndefined)(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.nextRenderedWidget!==i.associatedCell.ownerRow.nextSplitWidget)if(i.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){l=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selectionModule.upDownSelectionLength,!0);this.setPosition(e.getFirstParagraph(l).childWidgets[0],!1)}else if(this.currentWidget.paragraph.isInsideTable&&i.associatedCell.ownerRow.nextRenderedWidget instanceof Ul&&i.associatedCell.ownerRow!==this.currentWidget.paragraph.associatedCell.ownerRow){l=this.selection.getLastCellInRegion(i.associatedCell.ownerRow.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(l).childWidgets[0],!0)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var h=this.selection.getTop(o);o!==n&&this.selection.updateTextPositionWidget(o,new Sa(t,h),this,!1)},e.prototype.moveToLineStartInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetInternal(this.currentWidget,this.offset,t),n=e.getFirstElementInternal(i);this.documentHelper.moveCaretPosition=1;var r=e.getStartOffset(this.currentWidget.paragraph);if((0,a.isNullOrUndefined)(n)&&this.offset>r){var o=0,s=(d=this.currentWidget.getInline(this.offset,o)).element;o=d.index,s instanceof Zl&&"\v"!==s.text&&(this.offset=r)}else if(!(0,a.isNullOrUndefined)(n)){var l=0;l+=n instanceof id&&e.isHomeEnd?n.length:0,this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,l),l=0;var d;s=(d=this.currentWidget.getInline(this.offset,l)).element;if(l=d.index,s instanceof _l){var h=e.getPreviousValidElement(s);(0,a.isNullOrUndefined)(h)||(s=h,this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,s.length),s instanceof _l&&this.offset--)}}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},e.prototype.moveToWordEndInternal=function(e,t){var i=0,n=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof md&&(i=1),this.currentWidget.children[1]instanceof md&&(i=2)),this.offset+i!==n&&this.offset!==n+1||!(0,a.isNullOrUndefined)(this.currentWidget.nextLine)){var r=0,o=this.currentWidget.getInline(this.offset,r),s=o.element;r=o.index,this.getNextWordOffset(s,r,e,!1,!1,this,t)}else if(this.offset===n&&0!==e)this.setPositionParagraph(this.currentWidget,n+1);else{var l=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if((0,a.isNullOrUndefined)(l))return;if(this.currentWidget=l.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e)this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,t)}if(0!==e){var d=this.owner.selectionModule.start.getHierarchicalIndexInternal(),h=this.getHierarchicalIndexInternal();d!==h&&this.validateForwardFieldSelection(d,h)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,t=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);(0,a.isNullOrUndefined)(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.moveToPreviousParagraph=function(e){var t=e.getStartOffset(this.currentWidget.paragraph);if(this.offset!==t||(0,a.isNullOrUndefined)(e.getPreviousParagraphBlock(this.currentWidget.paragraph)))this.offset=e.getStartOffset(this.currentWidget.paragraph);else{var i=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=i.childWidgets[0],this.offset=e.getStartOffset(this.currentWidget.paragraph)}this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),n=e.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward();var r=e.getLineWidgetParagraph(this.offset,this.currentWidget),o=e.getLeft(r);if(e.getWidth(r,!0)+o>=t&&n!==r){var s=e.getTop(r),a=new Sa(t,s);e.updateTextPositionWidget(r,a,this,!0)}var l=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(i,l)},e.prototype.moveToLineEndInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetParagraph(this.offset,this.currentWidget),n=e.getFirstElementInternal(i),r=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,(0,a.isNullOrUndefined)(n)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!(0,a.isNullOrUndefined)(n)){var o=void 0;if(r&&this.containsRtlText(i)){var s=i.getEndOffset();o=i.getInline(s,0).element}else(o=i.children[i.children.length-1])instanceof md&&i.children.length>2&&(o=i.children[i.children.length-3]);var l=0;if(l+=o instanceof Zl?o.length:o instanceof id&&e.isHomeEnd?0:1,this.currentWidget=o.line,l===o.length&&(0,a.isNullOrUndefined)(o.nextNode)&&e.isParagraphLastLine(this.currentWidget)){var d=e.getLineLength(this.currentWidget);this.offset=t?d+1:d}else{for(var h=o;!(0,a.isNullOrUndefined)(h)&&h.length===l&&h.nextNode instanceof _l;){var c=this.documentHelper.getNextValidElement(h.nextNode);if(h!==c&&(h=c,l=0),h instanceof _l&&0===h.fieldType&&!(0,a.isNullOrUndefined)(h.fieldEnd)){var p=h;(0,a.isNullOrUndefined)(p.fieldSeparator)?h=p.fieldEnd:(h=p.fieldSeparator,this.currentWidget=h.line,this.currentWidget!==p.fieldEnd.line||e.hasValidInline(this.currentWidget.paragraph,h,p.fieldEnd)||(h=p.fieldEnd)),this.currentWidget=h.line}h instanceof _l&&(l=1)}l===h.length&&(0,a.isNullOrUndefined)(h.nextNode)&&l++,!t&&h instanceof ql&&"\v"===h.text&&l--,this.offset=this.currentWidget.getOffset(h,l)}this.updatePhysicalPosition(t)}},e.prototype.moveToNextLine=function(t){var i=this.selection,n=new e(this.owner);n.setPositionInternal(this);var r=this.getHierarchicalIndexInternal();i.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineEndInternal(i,!0);var o=!n.isAtSamePosition(this);(n.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable)?this.moveDownInTable(i):(this.moveNextPosition(),0===this.offset||this.moveForward());var s=i.getLineWidgetParagraph(this.offset,this.currentWidget),l=i.getLeft(s),d=i.getFirstElementInternal(s),h=(0,a.isNullOrUndefined)(d)?i.getWidth(s,!0):i.getLeftInternal(s,d,1)-l;if(l<t&&h/2<t-l){var c=i.getTop(s),p=new Sa(t,c);i.updateTextPositionWidget(s,p,this,!0),i.getWidth(s,!0)<t-l&&this.moveToLineEndInternal(i,!0)}else o&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selectionModule.start.currentWidget?this.setPositionInternal(n):o||this.moveToLineEndInternal(i,!0);var u=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(r,u)},e.prototype.moveUpInTable=function(e){var t=!1,i=this.owner.selectionModule.end,n=!this.owner.selectionModule.isEmpty;if(t=i.paragraph.isInsideTable){var r=this.currentWidget.paragraph.associatedCell,o=i.paragraph.associatedCell,s=e.getContainerCellOf(o,r);if(t=s.ownerTable.contains(r)){o=e.getSelectedCell(o,s),r=e.getSelectedCell(r,s);var l=e.containsCell(s,this.currentWidget.paragraph.associatedCell),d=e.isCellSelected(s,this,i);if(d||(d=this.currentWidget.paragraph===e.getFirstParagraph(s)&&this.isAtParagraphStart),(l&&d||!l)&&!(0,a.isNullOrUndefined)(r.ownerRow.previousRenderedWidget)){var h=r.ownerRow.previousRenderedWidget,c=e.getFirstCellInRegion(h,s,this.owner.selectionModule.upDownSelectionLength,!0),p=e.getLastParagraph(c);return void this.setPosition(p.childWidgets[0],!0)}if(l&&d&&(0,a.isNullOrUndefined)(r.ownerRow.previousRenderedWidget)||!l)if(n){r=r.ownerRow.childWidgets[0];p=e.getFirstParagraph(r);this.setPosition(p.childWidgets[0],!0)}else{r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1];p=e.getLastParagraph(r);this.setPosition(p.childWidgets[0],!1)}}}if(!t){c=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(n){c=c.ownerRow.childWidgets[0];p=e.getFirstParagraph(c);this.setPosition(p.childWidgets[0],!0)}else{c=c.ownerRow.childWidgets[c.ownerRow.childWidgets.length-1];p=e.getLastParagraph(c);this.setPosition(p.childWidgets[0],!1)}}this.moveBackward()},e.prototype.moveDownInTable=function(e){var t=!1,i=this.owner.selectionModule.isEmpty||this.owner.selectionModule.isForward;if(t=this.owner.selectionModule.start.paragraph.isInsideTable){var n=this.owner.selectionModule.start.paragraph.associatedCell,r=this.currentWidget.paragraph.associatedCell,o=e.getContainerCellOf(n,r);if(t=o.ownerTable.contains(r)){n=e.getSelectedCell(n,o),r=e.getSelectedCell(r,o);var s=e.containsCell(o,this.currentWidget.paragraph.associatedCell),l=e.isCellSelected(o,this.owner.selectionModule.start,this);if((s&&l||!s)&&!(0,a.isNullOrUndefined)(r.ownerRow.nextRenderedWidget)){var d=r.ownerRow.nextRenderedWidget,h=e.getLastCellInRegion(d,o,this.owner.selectionModule.upDownSelectionLength,!1),c=e.getLastParagraph(h);return void this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}if(s&&l&&(0,a.isNullOrUndefined)(r.ownerRow.nextRenderedWidget)||!s)if(i){r=r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1];c=e.getLastParagraph(r);this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}else{r=r.ownerRow.childWidgets[0];c=e.getFirstParagraph(r);this.setPosition(c.childWidgets[c.childWidgets.length-1],!0)}}}if(!t){h=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(i){h=h.ownerRow.childWidgets[h.ownerRow.childWidgets.length-1];c=e.getLastParagraph(h);this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}else if(h.ownerRow.nextRenderedWidget){h=h.ownerRow.nextRenderedWidget.childWidgets[0];c=e.getFirstParagraph(h);this.setPosition(c.childWidgets[c.childWidgets.length-1],!0)}}this.moveForward()},e.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,(0,a.isNullOrUndefined)(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.documentHelper=void 0},e}(),lc=function(){function e(e,t){this.leftIn=0,this.widthIn=0,this.color="",this.leftIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0,this.floatingItems=[],this.floatingItems=void 0},e}(),dc=function(){function e(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1,this.isCrossRefField=!1,this.screenTipText="";var i=t.getFieldCode(e),n=i.toLowerCase();"hyperlink"===n.substring(0,9)?this.parseFieldValues(i.substring(9).trim(),!0):0===n.indexOf("ref ")&&n.match("\\h")?(this.parseFieldValues(i.substring(4).trim(),!1),this.isCrossRefField=!0):0===n.indexOf("pageref")&&this.parseFieldValues(i.substring(7).trim(),!1)}return Object.defineProperty(e.prototype,"screenTip",{get:function(){return this.screenTipText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),e.prototype.parseFieldValues=function(e,t){var i=e.split("\\o ");2===i.length&&(this.screenTipText=this.parseFieldValue(i[1],'"'===i[1]?'"':void 0,t),this.screenTipText=this.screenTipText.substring(0,this.screenTipText.length-1),e=i[0],i=void 0),i=e.split(" ");var n=!1,r=!0;if(t)for(var o=0;o<i.length;o++){var s=i[o];s.length<1||("\\t"===s||"\\l"===s?n=!0:"\\n"===s?this.opensNewWindow=!0:(s=this.parseFieldValue(s,'"'===s[0]?'"':void 0,t),n?(this.localRef=s,n=!1,r=!1):this.linkInternal=r?this.parseFieldValue(e,'"'===e[0]?'"':void 0,t):s))}else this.localRef=i[0];this.setLinkType()},e.prototype.parseFieldValue=function(e,t,i){e=i?e.substring(1):e.substring(0);var n=t?e.indexOf(t):-1;return n<0&&(n=e.length),e.substring(0,n).trim()},e.prototype.setLinkType=function(){(0,a.isNullOrUndefined)(this.linkInternal)||this.linkInternal.length<1?this.typeInternal="Bookmark":("www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),"http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?this.typeInternal="WebPage":"mailto:"===this.linkInternal.substring(0,7)?this.typeInternal="Email":this.typeInternal="File")},e.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0,this.screenTipText=void 0},e}(),hc=function(){function e(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height,this.alternatetext=e.alternateText}return e.prototype.destroy=function(){this.width=void 0,this.height=void 0,this.alternatetext=void 0},e}(),cc=function(){function e(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}return Object.defineProperty(e.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0},e}(),pc=function(){function e(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}return Object.defineProperty(e.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.modifiedFormat&&this.modifiedFormat.destroy(),this.modifiedFormat=void 0,this.ownerFormat=void 0},e}(),uc=function(){function e(e,t,i,n){this.startingPoint=t,this.rowFormat=i,this.rowHeightType=i.heightType,this.tableHierarchicalIndex=n.selectionModule.getHierarchicalIndex(e,"0")}return e.prototype.revertChanges=function(e,t,i){var n=this.rowFormat.heightType,r=i.childWidgets[this.rowFormat.ownerBase.index];t.editorModule.tableResize.updateRowHeight(r,e?this.displacement:-this.displacement),t.documentHelper.layout.reLayoutTable(i),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=n},e}(),gc=function(){function e(e,t){this.tableHolder=new Rd,this.tableFormat=new mc,this.rows=[],this.owner=t,this.copyProperties(e)}return e.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=e.tableFormat.allowAutoFit);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],n=new fc;n.gridBefore=i.rowFormat.gridBefore,n.gridBeforeWidth=i.rowFormat.gridBeforeWidth,n.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,n.gridAfter=i.rowFormat.gridAfter,n.gridAfterWidth=i.rowFormat.gridAfterWidth,n.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[parseInt(r.toString(),10)],s=new vc;s.columnIndex=o.columnIndex,s.columnSpan=o.cellFormat.columnSpan,s.preferredWidth=o.cellFormat.preferredWidth,s.preferredWidthType=o.cellFormat.preferredWidthType,n.cells.push(s)}this.rows.push(n)}this.tableHierarchicalIndex=this.owner.selectionModule.getHierarchicalIndex(e,"0")},e.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)},e}(),mc=function(){},fc=function(){this.cells=[]},vc=function(){},yc=function(e){this.startingPoint=e},wc=function(){function e(e){this.cellOperation=[],this.splittedRevisions=[],this.isRemovedNodes=!1,this.modifiedFormatOperation=[],this.revisionOperation=[],this.markerData=[],this.pastedComments=[],this.ownerIn=e,this.documentHelper=e.documentHelper,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[],this.insertedNodes=[]}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.owner.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e,this.owner.enableCollaborativeEditing&&!this.editorHistory.isUndoing&&0===this.cellOperation.length&&("DeleteColumn"===e||"DeleteCells"===e||"ClearCells"===e||"MergeCells"===e?(this.owner.selectionModule.isTableSelected(!0)||this.owner.selectionModule.isRowSelect())&&"ClearCells"!==e&&"MergeCells"!==e||(this.insertedText=o.Cell,this.deleteColumnOperation(this.action)):"Accept Change"===e||"Reject Change"===e?this.createAcceptRejectOperation(this.action):"SectionBreak"===e?(this.insertedText=o.Section_Break,this.type="NewPage"):"SectionBreakContinuous"===e&&(this.insertedText=o.Section_Break,this.type="Continuous"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e,!this.owner.enableCollaborativeEditing||this.owner.editorModule.isRemoteAction||""===e||(0,a.isNullOrUndefined)(e)||-1!==e.indexOf("C")||(this.insertIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),e.prototype.updateSelection=function(){this.updateCollaborativeSelection(this.owner.selectionModule.start.clone(),this.owner.selectionModule.end.clone());var e=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.start);this.selectionStart=this.owner.selectionModule.getHierarchicalIndex(e.paragraph,e.offset.toString()),e=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.end),this.selectionEnd=this.owner.selectionModule.getHierarchicalIndex(e.paragraph,e.offset.toString())},e.prototype.updateCollaborativeSelection=function(e,t){if(this.owner.enableCollaborativeEditing&&!this.owner.editorModule.isRemoteAction){if("RemoveEditRange"===this.action){var i=this.owner.selectionModule.getEditRangeStartElement(),n=this.owner.selectionModule.getPosition(i);e=n.startPosition,t=n.endPosition}else this.updateTableSelection(e,t);this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(e),this.owner.selectionModule.isEndOffset=!0,this.endIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(t),this.owner.selectionModule.isEndOffset=!1;var r=this.owner.selectionModule.isForward;r?this.startIndex-=this.owner.selectionModule.getTableRelativeValue(e,t):this.endIndex-=this.owner.selectionModule.getTableRelativeValue(t,e),!(r?e.paragraph.equals(t.paragraph)&&e.isAtParagraphStart:e.paragraph.equals(t.paragraph)&&t.isAtParagraphStart)&&e.paragraph.equals(t.paragraph)||(r?this.endIndex+=this.paraInclude(t):this.startIndex+=this.paraInclude(e)),this.owner.enableTrackChanges||this.splitOperationForDelete(e,t)}},e.prototype.paraInclude=function(e){var t=this.owner.selectionModule.getParagraphInfo(e);return!(e.paragraph.getTotalLength()<t.offset)||e.paragraph.isInsideTable&&e.paragraph.equals(e.paragraph.associatedCell.lastChild)?0:1},e.prototype.updateTableSelection=function(e,t){var i=e,n=t;if(this.owner.selectionModule.isForward||(i=t,n=e),i.paragraph.isInsideTable){var r=this.owner.selectionModule.getFirstParagraph(i.paragraph.associatedCell);if(n.paragraph.isInsideTable){if(!i.paragraph.associatedCell.equals(n.paragraph.associatedCell)){var o=this.owner.selectionModule.getLastParagraph(n.paragraph.associatedCell);i.setPosition(r.firstChild,!0),n.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)}}else i.setPosition(r.firstChild,!0)}else if(n.paragraph.isInsideTable){o=this.owner.selectionModule.getLastParagraph(n.paragraph.associatedCell);n.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)}},e.prototype.splitOperationForDelete=function(e,t){var i=e,n=t;if((this.owner.selectionModule.isForward||(i=t,n=e),!i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&("BackSpace"===this.action||"Delete"===this.action))&&!this.owner.selectionModule.getLastBlockInLastCell(n.paragraph.associatedCell.ownerTable).associatedCell.equals(n.paragraph.associatedCell)){var r=this.startIndex,o=i.currentWidget,s=i.offset;i.setPosition(i.paragraph.firstChild,!0),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i);var a=this.startIndex,l=this.owner.documentHelper.layout.getParentTable(n.paragraph.associatedCell.ownerTable),d={paragraph:null,offset:0},h=this.owner.selectionModule.getPositionInfoForHeaderFooter(d,{position:0,done:!1},l).position;this.startIndex=h+1,this.cellOperation.push(this.getDeleteOperation(this.action)),this.startIndex=h+3,0!==s&&(this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,i.currentWidget,i.offset,o,s,!1,!0),this.cellOperation.push(this.getPasteOpertion(this.pasteContent,r-a))),this.endIndex=h,this.startIndex=a,this.cellOperation.push(this.getDeleteOperation(this.action))}if("PasteColumn"===this.action||"PasteOverwrite"===this.action||"PasteRow"===this.action){l=e.paragraph.associatedCell.ownerTable,d={paragraph:null,offset:0};this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(d,{position:0,done:!1},l).position,this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,l,0,{done:!1},!0,void 0,void 0)}},e.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},e.prototype.setContentControlInfo=function(e){this.removedNodes.push({contentcontrol:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},e.prototype.setFormFieldInfo=function(e,t){this.removedNodes.push({formField:e,value:t})},e.prototype.setEditRangeInfo=function(e){this.removedNodes.push({editStart:e,startIndex:e.indexInOwner,endIndex:e.editRangeEnd.indexInOwner})},e.prototype.setContentControlCheckBox=function(e,t){this.removedNodes.push({contentControlCheckBox:e,value:t})},e.prototype.revertFormTextFormat=function(){var e=this.removedNodes[0],t=e.value,i=e.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.recordChanges(this)):(t=Pa.formatText(i.formFieldData.format,t),this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.undoStack.push(this))},e.prototype.revertFormField=function(){var e=this.removedNodes[0],t=e.formField;t.formFieldData instanceof Kl?this.owner.editorModule.toggleCheckBoxFormField(t,!0,e.value):this.owner.editorModule.updateFormField(t,e.value)},e.prototype.revertContentControl=function(){var e=this.removedNodes[0],t=e.contentcontrol;if(this.editorHistory.isUndoing){var i=this.owner.editorModule.getMarkerData(t);this.markerData.push(i),t.line.children.splice(e.startIndex,0,t),this.documentHelper.owner.editorModule.insertContentControlInCollection(t),this.markerData.push(i),t.reference.line.children.splice(e.endIndex,0,t.reference),this.owner.editorModule.updatePropertiesToBlock(t,!0),this.owner.selectionModule.updateContentControlHighlightSelection(),this.editorHistory.recordChanges(this),this.viewer.updateScrollBars(),this.owner.editorModule.fireContentChange()}else this.owner.editorModule.removeContentControlInternal(),this.editorHistory.undoStack.push(this)},e.prototype.revertBookmark=function(){var e=this.removedNodes[0],t=e.bookmark;if((0,a.isNullOrUndefined)(t)||-1!==t.line.indexInOwner&&-1!==t.line.paragraph.indexInOwner||(0,a.isNullOrUndefined)(this.owner.documentHelper)||!(this.owner.documentHelper.bookmarks.length>0)||(t=this.owner.documentHelper.bookmarks.get(t.name),this.removedNodes[0].bookmark=t),this.editorHistory.isUndoing){var i=this.owner.editorModule.getMarkerData(t);this.documentHelper.bookmarks.add(t.name,t),this.markerData.push(i),t.line.children.splice(e.startIndex,0,t);var n=t.previousNode;n instanceof _l&&!(0,a.isNullOrUndefined)(n.formFieldData)&&(n.formFieldData.name=t.name),this.markerData.push(i),t.reference.line.children.splice(e.endIndex,0,t.reference),this.editorHistory.currentHistoryInfo&&"InsertBookmark"===this.editorHistory.currentHistoryInfo.action||this.editorHistory.recordChanges(this),!0===this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars(),this.owner.editorModule.fireContentChange()}else this.owner.editorModule.deleteBookmarkInternal(t),this.editorHistory.currentHistoryInfo&&"InsertBookmark"===this.editorHistory.currentHistoryInfo.action||this.editorHistory.undoStack.push(this)},e.prototype.revertComment=function(){var e=this.insertPosition,t=this.removedNodes[0],i=!1;if("ResolveComment"===this.action)return this.editorHistory.currentBaseHistoryInfo=this,void this.owner.editorModule.resolveOrReopenComment(t,!t.isResolved);if("EditComment"===this.action){var n=this.modifiedProperties[0];this.editorHistory.currentBaseHistoryInfo=this;var r=this.owner.commentReviewPane.commentPane.comments.get(t);return r.commentText.innerText=n.text,n.text=t.text,t.text=r.commentText.innerText,this.owner.editorHistoryModule.updateHistory(),void this.owner.fireContentChange()}if("InsertCommentWidget"===this.action?i=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(i=this.editorHistory.isUndoing),i)t&&(this.insertedElement=t.clone(),t.isReply?this.owner.editorModule.addReplyComment(t,this.insertPosition):this.owner.editorModule.addCommentWidget(t,!1,!0,!0));else{var o=this.owner.editorModule.getCommentElementBox(e);this.owner.editorModule.deleteCommentWidget(o)}},e.prototype.revertEditRangeRegion=function(){var e=this.removedNodes[0],t=e.editStart;if(this.editorHistory.isUndoing){var i=""===t.user?t.group:t.user;this.owner.editorModule.updateRangeCollection(t,i),this.markerData.push(this.owner.editorModule.getMarkerData(t)),this.markerData.push(this.owner.editorModule.getMarkerData(t.editRangeEnd)),t.line.children.splice(e.startIndex,0,t),t.editRangeEnd.line.children.splice(e.endIndex,0,t.editRangeEnd),this.editorHistory.recordChanges(this)}else this.owner.editorModule.removeUserRestrictionsInternal(t),this.editorHistory.undoStack.push(this);this.owner.editorModule.fireContentChange()},e.prototype.revertContentControlProperties=function(){var e=this.selectionStart,t=this.selectionEnd;if(!(0,a.isNullOrUndefined)(this.selectionStart)&&!(0,a.isNullOrUndefined)(this.selectionEnd)){var i=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(e),n=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(t);this.owner.selectionModule.selectRange(i,n);var r=this.owner.selection.currentContentControl;if(r)if("CheckBox"===r.contentControlProperties.type&&0===this.modifiedProperties.length){var o=this.removedNodes[0];this.owner.editorModule.toggleContentControlCheckBox(r,!o.value),o.value=!o.value}else{var s=this.modifiedProperties.pop();this.editorHistory.currentBaseHistoryInfo=this;var l=this.owner.editorModule.getContentControlPropObject(r.contentControlProperties);this.owner.editorModule.assignContentControl(r.contentControlProperties,s),this.modifiedProperties.push(l),this.format=JSON.stringify(s)}}this.editorHistory.isUndoing?this.editorHistory.recordChanges(this):this.editorHistory.undoStack.push(this),this.owner.editorModule.fireContentChange()},e.prototype.revert=function(){if("FormTextFormat"!==this.action)if("UpdateFormField"!==this.action)if("DeleteBookmark"!==this.action)if("RemoveContentControl"!==this.action)if("RemoveEditRange"!==this.action)if("InsertCommentWidget"!==this.action&&"DeleteCommentWidget"!==this.action&&"ResolveComment"!==this.action&&"EditComment"!==this.action)if("UpdateContentControl"!==this.action){if("ListFormat"===this.action&&""!==this.owner.editorModule.listNumberFormat){var e=this.documentHelper.lists[0].abstractList.levels[this.owner.editorModule.listLevelNumber],t=e.listLevelPattern,i=e.numberFormat;e.listLevelPattern=this.owner.editorModule.listLevelPattern,e.numberFormat=this.owner.editorModule.listNumberFormat,this.owner.editorModule.listLevelPattern=t,this.owner.editorModule.listNumberFormat=i}this.owner.isShiftingEnabled=!0;var n=void 0,r=void 0,o=this.selectionStart,s=this.selectionEnd;this.collabStart=this.selectionStart,this.collabEnd=this.selectionEnd;var l=ac.isForwardSelection(o,s);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)n=(0,a.isNullOrUndefined)(o)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(o),r=(0,a.isNullOrUndefined)(s)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(s),this.owner.enableCollaborativeEditing&&this.updateCollaborativeSelection(n,r),this.revertModifiedProperties(n,r);else{if(this.owner.enableCollaborativeEditing&&((0,a.isNullOrUndefined)(this.insertPosition)||(this.insertIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(this.insertPosition)),!(0,a.isNullOrUndefined)(this.endPosition))){var d=this.owner.selection.getTextPosBasedOnLogicalIndex(this.insertPosition),h=this.owner.selection.getTextPosBasedOnLogicalIndex(this.endPosition);this.updateCollaborativeSelection(d,h)}var c=this.owner.selectionModule,p=this.removedNodes;if(this.removedNodes.length>0){if("InsertTable"===this.action&&this.editorHistory.isRedoing)for(var u=0;u<this.removedNodes.length;u++)this.insertedNodes.push(this.removedNodes[parseInt(u.toString(),10)]);this.isRemovedNodes=!0}else this.isRemovedNodes=!1;this.removedNodesIn=[],(0,a.isNullOrUndefined)(this.endPosition)&&(this.endPosition=this.insertPosition);var g,m=ac.isForwardSelection(this.insertPosition,this.endPosition),f=c.getTextPosBasedOnLogicalIndex(m?this.insertPosition:this.endPosition),v=c.getTextPosBasedOnLogicalIndex(m?this.endPosition:this.insertPosition);if("RemoveRowTrack"===this.action&&this.editorHistory.isUndoing){this.owner.selectionModule.select(this.selectionEnd,this.selectionEnd);var y=this.owner.selectionModule.start.paragraph===this.owner.editor.getLastParaForBodywidgetCollection(this.owner.selectionModule.start.paragraph);(this.owner.selectionModule.start.paragraph.isInsideTable||y&&this.owner.selectionModule.end.paragraph.isEmpty()&&p.length>0&&p[0]instanceof Al)&&(this.endRevisionLogicalIndex=this.selectionEnd)}if(this.editorHistory.isUndoing&&(this.lastElementRevision&&(0,a.isNullOrUndefined)(this.isAcceptOrReject)&&p.length>0&&p[0]instanceof Rl&&p[0].isEmpty()||"Delete"===this.action&&this.editorHistory.currentHistoryInfo&&"RemoveHyperlink"===this.editorHistory.currentHistoryInfo.action&&this.lastElementRevision instanceof _l?this.endRevisionLogicalIndex=this.selectionEnd:this.lastElementRevision&&(0,a.isNullOrUndefined)(this.endRevisionLogicalIndex)?this.updateEndRevisionInfo():"RemoveRowTrack"===this.action&&(this.endRevisionLogicalIndex=this.selectionEnd)),"ClearRevisions"===this.action){var w=c.getHyperlinkField();if(this.isHyperlinkField&&!(0,a.isNullOrUndefined)(w)){var b=w.fieldSeparator.line.getOffset(w.fieldSeparator,1);v.setPositionParagraph(w.fieldSeparator.line,b),this.undoRevisionForElements(f,v,p[p.length-1]);var C=w.fieldEnd;f.setPositionParagraph(C.line,C.line.getOffset(C,0)),v.setPositionParagraph(C.line,C.line.getOffset(C,1)),this.undoRevisionForElements(f,v,p[p.length-1])}else this.owner.selectionModule.select(this.selectionEnd,this.selectionEnd),this.undoRevisionForElements(f,v,p[p.length-1]);var x=p[p.length-1];-1===this.removedNodes.indexOf(x)&&this.removedNodes.push(x),p=[]}if("Uppercase"===this.action)return c.selectPosition(f,v),this.editorHistory.currentBaseHistoryInfo=this,(g=this.owner.editorModule).changeSelectedTextCase(c,f,v,this.action.toString(),p),void g.reLayout(c);if("Lowercase"===this.action)return c.selectPosition(f,v),this.editorHistory.currentBaseHistoryInfo=this,(g=this.owner.editorModule).changeSelectedTextCase(c,f,v,this.action.toString(),p),void g.reLayout(c);if("CapitalizeEachWord"===this.action)return c.selectPosition(f,v),this.editorHistory.currentBaseHistoryInfo=this,(g=this.owner.editorModule).changeSelectedTextCase(c,f,v,this.action.toString(),p),void g.reLayout(c);if("SentenceCase"===this.action)return c.selectPosition(f,v),this.editorHistory.currentBaseHistoryInfo=this,(g=this.owner.editorModule).changeSelectedTextCase(c,f,v,this.action.toString(),p),void g.reLayout(c);if("ToggleCase"===this.action)return c.selectPosition(f,v),this.editorHistory.currentBaseHistoryInfo=this,(g=this.owner.editorModule).changeSelectedTextCase(c,f,v,this.action.toString(),p),void g.reLayout(c);if(f.isAtSamePosition(v)?c.selectContent(f,!0):c.selectPosition(f,v),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing){w=this.owner.selectionModule.getHyperlinkField();if(!(0,a.isNullOrUndefined)(w)){b=w.line.getOffset(w,0);f.setPositionParagraph(w.line,b),this.owner.selectionModule.start.setPositionInternal(f),b=w.fieldEnd.line.getOffset(w.fieldEnd,1),v.setPositionParagraph(w.fieldEnd.line,b)}}this.editorHistory.currentBaseHistoryInfo=this,this.selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var I=!1,k=!1;if("DeleteCells"!==this.action&&"RemoveRowTrack"!==this.action||(k=!0),this.endRevisionLogicalIndex&&p.length>0){var F=c.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex);(this.editorHistory.isUndoing&&!this.editorHistory.currentBaseHistoryInfo.isRevisionEndInAnotherCell||this.editorHistory.isRedoing&&f.isAtSamePosition(v))&&c.selectPosition(f,F),this.collabEnd=this.endRevisionLogicalIndex,this.owner.enableCollaborativeEditing&&(this.endIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(F),this.endIndex+=this.paraInclude(F)),(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&!this.owner.selectionModule.isEmpty&&p.length>0)&&(this.owner.editorModule.deleteSelectedContents(c,!0,k),I=!0)}if(f.isAtSamePosition(v)||I)if("SectionBreakContinuous"===this.action&&f&&this.editorHistory.isUndoing){if(0===f.offset&&!(0,a.isNullOrUndefined)(f.paragraph.previousRenderedWidget)&&f.paragraph.previousRenderedWidget instanceof Rl&&f.paragraph.previousRenderedWidget.isEndsWithPageBreak&&f.paragraph.containerWidget instanceof Ol&&f.currentWidget===f.currentWidget.paragraph.firstChild&&"NoBreak"===f.paragraph.containerWidget.sectionFormat.breakCode){var P=f.paragraph.previousRenderedWidget.containerWidget;this.owner.editorModule.combineSectionInternal(this.owner.selectionModule,P,f.paragraph.containerWidget),this.owner.editorModule.layoutWholeDocument()}}else I=!1,f.isAtSamePosition(v)||(I="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action);else{I="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action||"PasteOverwrite"===this.action||"PasteRow"===this.action||"PasteNested"===this.action;var S=p.length>0&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action;if(!I&&"MergeCells"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"Borders"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&(c.end.setPositionInternal(v),!this.owner.selectionModule.isEmpty&&!S)){if(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action)this.owner.editorModule.removeSelectedContents(c);else{w=c.getHyperlinkField();if(this.isHyperlinkField&&!(0,a.isNullOrUndefined)(w)&&this.editorHistory.isRedoing&&"Accept Change"===this.action){C=w.fieldEnd;c.start.setPositionParagraph(w.line,w.line.getOffset(w,0)),c.end.setPositionParagraph(w.fieldSeparator.line,w.fieldSeparator.line.getOffset(w.fieldSeparator,1)),this.owner.editorModule.deleteSelectedContents(c,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),c.start.setPositionParagraph(C.line,C.line.getOffset(C,0)),c.end.setPositionParagraph(C.line,C.line.getOffset(C,1)),this.owner.editorModule.deleteSelectedContents(c,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.reverse()}else this.owner.editorModule.deleteSelectedContents(c,!0)}!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1)}}if("Paste"===this.action&&this.pastedComments.length>0)if(this.editorHistory.isUndoing)for(u=0;u<this.pastedComments.length;u++){var T=this.pastedComments[u];this.owner.editorModule.deleteCommentWidget(T)}else if(this.editorHistory.isRedoing)for(var H=0;H<this.pastedComments.length;H++){T=this.pastedComments[H];if(this.owner.editorModule.addCommentWidget(T,!1,this.owner.showComments,!1),T.replyComments.length>0)for(var E=0;E<T.replyComments.length;E++)this.owner.commentReviewPane.addReply(T.replyComments[E],!1,!1)}var N=this.editorHistory.isRedoing&&!I;I=!this.lastElementRevision&&I,this.revertModifiedNodes(p,N,l?o:s,o===s,l?s:o),I&&this.removeContent(f,v,k)}var W=!1,O=!1;(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Paste"!==this.editorHistory.currentHistoryInfo.action||(O=!0),("TrackingPageBreak"!==this.action&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||O)&&(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||O)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&("RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(n=(0,a.isNullOrUndefined)(this.selectionStart)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionStart),r=(0,a.isNullOrUndefined)(this.selectionEnd)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(n=(0,a.isNullOrUndefined)(o)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(o),r=(0,a.isNullOrUndefined)(s)?void 0:this.owner.selectionModule.getTextPosBasedOnLogicalIndex(s)),"ModifyStyle"!==this.action&&this.owner.selectionModule.selectRange(n,r),this.documentHelper.updateFocus(),W=!0),this.owner.trackChangesPane.isTrackingPageBreak=!1;var B=this.insertIndex;this.insertPosition=o,this.endPosition=s,"InsertHyperlink"===this.action&&(this.insertIndex=B),(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"RemoveComment"!==this.editorHistory.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),this.owner.editorModule.reLayout(this.owner.selectionModule,this.owner.selectionModule.isEmpty),this.editorHistory.isUndoing&&"SectionBreak"===this.action&&(this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.layoutWholeDocument(),this.owner.editorModule.isSkipOperationsBuild=!1),W&&this.documentHelper.scrollToPosition(this.owner.selectionModule.start,this.owner.selectionModule.end),this.highlightListText()}else this.revertContentControlProperties();else this.revertComment();else this.revertEditRangeRegion();else this.revertContentControl();else this.revertBookmark();else this.revertFormField();else this.revertFormTextFormat()},e.prototype.highlightListText=function(){if(!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var e=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionStart).currentWidget;this.documentHelper.selection.highlightListText(e)}},e.prototype.removeContent=function(e,t,i){if(!(0,a.isNullOrUndefined)(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof Ol&&!(0,a.isNullOrUndefined)(t.paragraph.containerWidget)&&t.paragraph.containerWidget instanceof Ol||!(0,a.isNullOrUndefined)(e.paragraph.containerWidget)&&!(0,a.isNullOrUndefined)(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof Vl&&t.paragraph.containerWidget instanceof Vl&&!(0,a.isNullOrUndefined)(e.paragraph.bodyWidget)||!(0,a.isNullOrUndefined)(e.paragraph.containerWidget)&&!(0,a.isNullOrUndefined)(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof cd&&t.paragraph.containerWidget instanceof cd){this.owner.selectionModule.selectRange(e,t),this.documentHelper.updateFocus();var n=!1;"BackSpace"!==this.action&&"Uppercase"!==this.action&&"RemoveRowTrack"!==this.action||(n=!0),this.owner.editorModule.deleteSelectedContents(this.owner.selectionModule,n,i)}},e.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var e=this.retrieveEndPosition(this.lastElementRevision),t=this.owner.selectionModule.getParagraphInfo(e),i=t.paragraph==this.owner.editor.getLastParaForBodywidgetCollection(t.paragraph);t.paragraph.isInsideTable&&t.paragraph==this.owner.selection.getLastParagraph(t.paragraph.associatedCell)&&(i=!0);var n=!!(0,a.isNullOrUndefined)(this.selectionEnd);if(!(0,a.isNullOrUndefined)(this.selectionEnd)){var r=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.selectionEnd),o=this.owner.selectionModule.getParagraphInfo(r);n=o.paragraph!==t.paragraph||o.paragraph.getLength()+1===o.offset}t.paragraph.getLength()==t.offset&&n&&!i&&t.offset++,this.endRevisionLogicalIndex=this.owner.selectionModule.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.lastElementRevision.isMarkedForRevision=!1},e.prototype.retrieveEndPosition=function(e){var t=new ac(this.owner),i=e.line.getOffset(e,0)+e.length;return t.setPositionFromLine(e.line,i),t},e.prototype.checkAdjacentNodeForMarkedRevision=function(e){for(var t,i=e.nextNode;!(0,a.isNullOrUndefined)(i)&&i.isMarkedForRevision;)t=i,i=i.nextNode;return(0,a.isNullOrUndefined)(t)?e:t},e.prototype.revertModifiedProperties=function(e,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1),(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(t)||this.owner.selectionModule.selectRange(e,t),this.documentHelper.updateFocus(),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},e.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action=this.action,this.action){case"BackSpace":e.singleBackspace(this.owner.selectionModule,!0);break;case"Delete":e.singleDelete(this.owner.selectionModule,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":e.insertSection(this.owner.selectionModule,!0);break;case"SectionBreakContinuous":e.insertSection(this.owner.selectionModule,!0,void 0,!0);break;case"TableAutoFitToContents":e.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":e.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":e.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selectionModule.handleAcceptReject(!0)}},e.prototype.revertModifiedNodes=function(e,t,i,n,r){if((!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action&&"PasteColumn"!==this.action&&"PasteOverwrite"!==this.action&&"PasteNested"!==this.action||(this.redoAction(),"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action))&&e.length>0)if(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action||"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action){var o=this.selectionStart,s=this.owner.editorModule.getBlock({index:o}).node,l=e[e.length-1];if((s instanceof Al||s.previousRenderedWidget instanceof Al||s.isInsideTable)&&l instanceof Al){if(s instanceof Rl&&!s.isInsideTable?s=s.previousRenderedWidget:s instanceof Rl&&s.isInsideTable&&(s=s.associatedCell.ownerTable),s=s.combineWidget(this.viewer),this.owner.enableCollaborativeEditing){var d={paragraph:null,offset:0};this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(d,{position:0,done:!1},s).position,this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,s,0,{done:!1},!0,void 0,void 0);var h=this.getDeleteOperation("Delete");this.owner.enableTrackChanges&&((0,a.isNullOrUndefined)(h.markerData)&&(h.markerData={}),h.markerData.isSkipTracking=!0),this.cellOperation.push(h)}this.owner.editorModule.insertTableInternal(s,l,!1),"PasteColumn"===this.action||"PasteRow"===this.action||"PasteOverwrite"===this.action||"PasteNested"===this.action?this.removedNodes.push(s):(e.splice(e.indexOf(l),1),e.length>0&&(!(0,a.isNullOrUndefined)(e[e.length-1])&&!(0,a.isNullOrUndefined)(l.nextRenderedWidget)&&l.nextRenderedWidget instanceof Rl&&(this.owner.selectionModule.start.setPositionParagraph(l.nextRenderedWidget.firstChild,0),this.owner.selectionModule.end.setPositionParagraph(l.nextRenderedWidget.firstChild,0)),this.insertRemovedNodes(e,e[e.length-1])))}else l instanceof Al&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlock(l):this.insertRemovedNodes(e,e[e.length-1])}else{var c=i;s=this.owner.editorModule.getBlock({index:c}).node;if(e.length>0&&("BackSpace"===this.action&&n||!(s instanceof Al)&&!(s instanceof Bl))){(l=e[0])instanceof Ol&&!(0,a.isNullOrUndefined)(e[1])&&(l=e[1]),("TrackingPageBreak"===this.action||("SectionBreak"===this.action||"SectionBreakContinuous"===this.action)&&l instanceof Ol||!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(l=e[1]);var p=!1;if((0,a.isNullOrUndefined)(this.isAcceptOrReject)||(p=!0,(!(0,a.isNullOrUndefined)(this.owner.selectionModule.start.paragraph.nextRenderedWidget)&&this.owner.selectionModule.start.paragraph.nextRenderedWidget instanceof Al||"BackSpace"===this.action&&2==e.length&&l instanceof Rl&&l.isEmpty()&&e[1]instanceof Rl&&e[1].isEmpty())&&(p=!1)),l instanceof Rl&&this.owner.selectionModule.start.offset>0&&!p&&(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action&&1===e.length?this.owner.editorModule.insertNewParagraphWidget(l,!1):this.owner.editorModule.insertNewParagraphWidget(l,!0),l.characterFormat.removedIds.length>0&&this.owner.editorModule.constructRevisionFromID(l.characterFormat,void 0),e.splice(e.indexOf(l),1),(0,a.isNullOrUndefined)(s))){var u=this.documentHelper.selection.getNextParagraphBlock(l.getSplitWidgets().pop());this.owner.selectionModule.getNextRenderedBlock(l);var g=this.owner.selectionModule.start.paragraph;!(u&&g&&g.bodyWidget instanceof Ol)||g.isInsideTable||this.owner.selectionModule.isinEndnote||this.owner.selectionModule.isinFootnote||g.bodyWidget.equals(u.bodyWidget)||(u=void 0),(0,a.isNullOrUndefined)(u)&&this.owner.selectionModule.selectParagraphInternal(l,!0)}if(l instanceof Al&&this.owner.selectionModule.start.offset>0){var m=e[e.length-1];if(m instanceof Rl&&(this.owner.editorModule.insertNewParagraphWidget(m,!0),e.splice(e.indexOf(m),1),(0,a.isNullOrUndefined)(s))){u=this.documentHelper.selection.getNextParagraphBlock(m.getSplitWidgets().pop());(0,a.isNullOrUndefined)(u)&&this.owner.selectionModule.selectParagraphInternal(m,!0)}}}if(e.length>0){var f=e[e.length-1];if(s instanceof Al&&(s=s.combineWidget(this.viewer),f instanceof Al)){if(this.owner.enableCollaborativeEditing){d={paragraph:null,offset:0};var v=this.owner.selectionModule.getPositionInfoForHeaderFooter(d,{position:0,done:!1},s).position,y=v+this.owner.selectionModule.getBlockLength(void 0,s,0,{done:!1},!0,void 0,void 0);(h=this.getDeleteOperation("Delete")).offset=v,h.length=y-v,this.cellOperation.push(h)}this.owner.editorModule.insertTableInternal(s,f,!0),e.splice(e.indexOf(f),1),this.insertPosition=i;var w=f.getSplitWidgets().pop();w.nextRenderedWidget instanceof Al?s=w.nextRenderedWidget:(c=i,s=this.owner.editorModule.getBlock({index:c}).node)}if(f instanceof Rl&&this.owner.selectionModule.start.offset>0&&this.owner.selectionModule.start.offset===this.owner.selectionModule.getLineLength(this.owner.selectionModule.start.paragraph.lastChild)){var b=this.owner.editorModule;b.insertNewParagraphWidget(f,!1),f.characterFormat.removedIds.length>0&&this.owner.editorModule.constructRevisionFromID(f.characterFormat,void 0),e.splice(e.indexOf(f),1),"Paste"!==this.action&&this.owner.selectionModule.start.paragraph!==f.containerWidget.lastChild&&b.removeBlock(this.owner.selectionModule.start.paragraph);var C=this.documentHelper.selection.getNextParagraphBlock(f.getSplitWidgets().pop());(0,a.isNullOrUndefined)(C)||f===f.containerWidget.lastChild?(0,a.isNullOrUndefined)(f)||this.owner.selectionModule.selectParagraphInternal(f,!1):this.owner.selectionModule.selectParagraphInternal(C,!0)}else if(e[0]instanceof Al&&1!==e.length){var x=e[1];x instanceof Rl&&x.isEmpty()&&e.splice(e.indexOf(x),1)}}e.length>0&&(s instanceof Al&&(s=s.combineWidget(this.viewer)),this.insertRemovedNodes(e,s,r))}},e.prototype.insertRemovedNodes=function(e,t,i){for(var n=!1,r=this.owner.selection.start.paragraph.isInsideTable,o=e.length-1;o>-1;o--){var s=e[o];if(0===o&&(r=!1),this.isHyperlinkField&&!(0,a.isNullOrUndefined)(i)&&s instanceof _l&&1===s.fieldType&&(this.owner.selectionModule.start.setPositionInternal(this.owner.selectionModule.getTextPosBasedOnLogicalIndex(i)),this.owner.selectionModule.end.setPositionInternal(this.owner.selectionModule.start)),s instanceof ql)this.owner.editorModule.insertInlineInSelection(this.owner.selectionModule,s);else if(s instanceof Rl&&void 0===s.childWidgets)this.owner.selection.moveToNextParagraph();else if(s instanceof Ll)s instanceof Ul?t instanceof Al&&(t.childWidgets.splice(0,0,s),this.owner.editorModule.updateNextBlocksIndex(s,!0),0!==o&&e[o-1]instanceof Ul||this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof Al&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlockTable(this.owner.selectionModule,s,t):s instanceof Rl&&!s.isInsideTable&&"RemoveRowTrack"===this.action?this.owner.editorModule.insertNewParagraphWidget(s,!1):s instanceof Al&&"RemoveRowTrack"===this.action?(this.owner.editorModule.insertTableInternal(s,s,!1,!0),!(0,a.isNullOrUndefined)(e[o-1])&&!(0,a.isNullOrUndefined)(s.nextRenderedWidget)&&s.nextRenderedWidget instanceof Rl&&(this.owner.selectionModule.start.setPositionParagraph(s.nextRenderedWidget.firstChild,0),this.owner.selectionModule.end.setPositionParagraph(s.nextRenderedWidget.firstChild,0))):this.owner.editorModule.insertBlock(s,r);else if(s instanceof ka){var l=this.selectionStart,d=this.owner.editorModule.getBlock({index:l}).node;if(d instanceof Rl)if(s.removedIds.length>0)d.characterFormat.removedIds=s.removedIds.slice(),this.owner.editorModule.constructRevisionFromID(d.characterFormat,!0);else if(d.characterFormat.revisions.length>0){for(var h=0;h<d.characterFormat.revisions.length;h++){var c=(g=d.characterFormat.revisions[h]).range.indexOf(d.characterFormat);-1!==c&&(g.range.splice(c,1),this.owner.trackChangesPane.updateCurrentTrackChanges(g),0===g.range.length&&this.owner.revisions.remove(g))}s.ownerBase=d,d.characterFormat=s}}else if(s instanceof Ol)(0,a.isNullOrUndefined)(s.removedHeaderFooters)||0===s.removedHeaderFooters.length||(this.owner.documentHelper.headersFooters.splice(s.sectionIndex,0,s.removedHeaderFooters[0]),s.removedHeaderFooters=void 0),n=!0,this.owner.editorModule.insertSection(this.owner.selectionModule,!1,!0,void 0,void 0,s.sectionFormat);else if("string"==typeof s&&"AcceptTOC"===this.action){l=this.selectionStart;var p=this.owner.editorModule.getBlock({index:l}).node,u=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,g=this.owner.documentHelper.revisionsInternal.get(s);if(this.editorHistory.isUndoing){for(;p instanceof Rl&&p!==u;)this.owner.editorModule.insertRevisionForBlock(p,g.revisionType,!0,g),p=this.documentHelper.selection.getNextParagraphBlock(p.getSplitWidgets().pop());this.owner.editorModule.insertRevisionForBlock(u,g.revisionType,!0,g)}else for(;g.range.length>0;){var m=g.range[0],f=m.revisions.indexOf(g);if(f>=0){m.revisions.splice(f,1);var v=g.range.indexOf(m);g.range.splice(v,1),this.owner.trackChangesPane.updateCurrentTrackChanges(g)}0===g.range.length&&this.owner.revisions.remove(g)}this.owner.editorModule.addRemovedNodes(g.revisionID)}}n&&(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument(!0)),e=[]},e.prototype.undoRevisionForElements=function(e,t,i){var n=e.paragraph,r=t.paragraph,o=this.documentHelper.revisionsInternal.get(i),s=this.owner.selectionModule.getParagraphInfo(e).offset,l=this.owner.selectionModule.getParagraphInfo(t).offset,d=e.paragraph===t.paragraph,h=!1;if(this.editorHistory.isUndoing){for(;n!==r;){h=!1;var c=0;(0,a.isNullOrUndefined)(n.previousSplitWidget)?c=n.getLength():(s=n.previousSplitWidget.getLength()+1,c=n.previousSplitWidget.getLength()+n.getLength()),this.owner.editorModule.applyRevisionForCurrentPara(n,s,c,i,!0),n=this.documentHelper.selection.getNextParagraphBlock(n),!(0,a.isNullOrUndefined)(n)&&!(0,a.isNullOrUndefined)(n.previousRenderedWidget)&&n.previousRenderedWidget instanceof Rl&&n.previousRenderedWidget.nextSplitWidget&&n===r&&(h=!0),n!==r&&(s=0)}n===r&&(d||(s=0),h&&(s=n.previousRenderedWidget.getLength()),this.owner.editorModule.applyRevisionForCurrentPara(n,s,l,i,!1))}else for(;o.range.length>0;){var p=o.range[0],u=p.revisions.indexOf(o);if(u>=0){p.revisions.splice(u,1);var g=o.range.indexOf(p);o.range.splice(g,1)}if(0===o.range.length&&this.owner.revisions.remove(o),n.characterFormat.revisions.length>0&&this.editorHistory.isRedoing)for(var m=0;m<n.characterFormat.revisions.length;m++){0===n.characterFormat.revisions[m].range.length&&(n.characterFormat.revisions.splice(m,1),m--)}}this.owner.trackChangesPane.updateCurrentTrackChanges(o),this.removedNodes.push(i)},e.prototype.revertResizing=function(){if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action){if(this.modifiedProperties[0]instanceof uc){var e=this.modifiedProperties[0].tableHierarchicalIndex;(t=this.owner.editorModule.getBlock({index:e}).node)instanceof Al&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner,t)}}else if(this.modifiedProperties[0]instanceof gc){0===this.owner.selectionModule.selectedWidgets.length&&this.owner.selectionModule.highlightSelection(!0);var t,i=this.modifiedProperties[0];e=i.tableHierarchicalIndex;if((t=this.owner.editorModule.getBlock({index:e}).node)instanceof Al){var n=this.owner.editorModule.tableResize;if(this.owner.editorModule.setOffsetValue(this.owner.selectionModule),t=t.combineWidget(this.owner.viewer),n.currentResizingTable=t,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=new gc(t,this.owner);this.modifiedProperties.splice(0,0,r),this.owner.isLayoutEnabled=!1,n.applyProperties(n.currentResizingTable,i),n.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,n.updateGridValue(n.currentResizingTable,!1),i.destroy(),i=void 0}}}},e.prototype.revertTableDialogProperties=function(e){if(this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===e){var t=this.owner.selectionModule,i=this.modifiedProperties[0];this.owner.editorModule.updateCellMargins(t,i)}else"TableOptions"===e&&this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},e.prototype.addModifiedPropertiesForSection=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.modifiedProperties,r=this.currentPropertyIndex<n.length?n[this.currentPropertyIndex]:n[n.length-1];(0,a.isNullOrUndefined)(t)?(i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(i=r.getPropertyValue(t),r.copyFormat(e)),this.currentPropertyIndex++}else if((0,a.isNullOrUndefined)(t))this.modifiedProperties.push(e.cloneFormat());else{var o=new ga;o.copyFormat(e),this.modifiedProperties.push(o)}return i},e.prototype.addModifiedProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],r=!1;if(e.ownerBase instanceof ql){var o=this.modifiedNodeLength[this.currentPropertyIndex];if(e.ownerBase.length<o){r=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,o-e.ownerBase.length);var s=new ka(void 0);s.copyFormat(n),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,s)}}"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(i=n,r||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++}else{if((0,a.isNullOrUndefined)(t))this.modifiedProperties.push(e.cloneFormat());else{var l=new ka(void 0);l.copyFormat(e),this.modifiedProperties.push(l)}e.ownerBase instanceof ql?this.modifiedNodeLength.push(e.ownerBase.length):this.modifiedNodeLength.push(0)}return i},e.prototype.buildCharacterFormatOperation=function(e,t){var i=this.owner.selectionModule.getElementPosition(e,!0).startPosition,n=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i);i.offset+=e.length;var r=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(i),o=this.owner.sfdtExportModule.writeCharacterFormat(t,0,!0),s={action:"Format",offset:n,length:r-n,format:JSON.stringify(o),type:"CharacterFormat"};this.modifiedFormatOperation.push(s)},e.prototype.addModifiedPropertiesForParagraphFormat=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(i=n,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,i;if((0,a.isNullOrUndefined)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;if("listFormat"===t)return(i=new ba(void 0)).copyFormat(n),n.listFormat=new ya(n),n.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,i;if("tabStop"===t){i=[];for(var r=0;r<n.tabs.length;r++)i.push(n.tabs[r]);return(o=new ba(void 0)).copyFormat(e),this.modifiedProperties[this.currentPropertyIndex]=o,this.currentPropertyIndex++,i}if("styleName"===t)return(0,a.isNullOrUndefined)(n.baseStyle)?void((0,a.isNullOrUndefined)(e.baseStyle)||(n.baseStyle=new Wa,n.baseStyle.copyStyle(e.baseStyle))):((i=new Wa).copyStyle(n.baseStyle),this.currentPropertyIndex++,(0,a.isNullOrUndefined)(e.baseStyle)||(n.baseStyle=new Wa,n.baseStyle.copyStyle(e.baseStyle)),i);i="borders"===t?n.borders.cloneFormat():this.action.indexOf("Border")>=0?n.borders.getBorder(t.replace("Border","")):n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var o;if((0,a.isNullOrUndefined)(t))this.modifiedProperties.push(e.cloneFormat());else(o=new ba(void 0)).copyFormat(e),this.modifiedProperties.push(o)}return i},e.prototype.getParagraohFormatOperation=function(e,t){var i;if((this.modifiedProperties.length>1||this.modifiedFormatOperation.length>0)&&!(0,a.isNullOrUndefined)(e)){var n=this.owner.selectionModule.setPositionForBlock(e,!0);this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(n),this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,e,0,{done:!1},!0,void 0,void 0)-1,this.insertedFormat=t,(i=this.modifiedFormatOperation).push.apply(i,this.getActionInfo(!0))}},e.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,t;var i=new ba;return i.copyFormat(e),this.modifiedProperties.push(i),t},e.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++,t):(this.modifiedProperties.push(e.listId),t)},e.prototype.addModifiedPropertiesForList=function(e){var t;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];t=i,i=new cc(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++}else this.modifiedProperties.push(new cc(e,this.owner.editorModule.cloneListLevel(e))),t=e;return t},e.prototype.revertProperties=function(){this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof ka){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof ba){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selectionModule,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof ba)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editorModule.setPreviousBlockToLayout(),this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if("LinkToPrevious"===this.action&&this.modifiedProperties[0]instanceof ga){var t=parseInt(this.selectionStart.split(";")[0]);this.owner.editorModule.updateHeaderFooters(e,void 0,t,this.modifiedProperties[0].removedHeaderFooters[0])}else if(this.modifiedProperties[0]instanceof ga)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selectionModule,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof hc){var i=this.modifiedProperties[0];this.insertedData={width:Pa.convertPixelToPoint(i.width),height:Pa.convertPixelToPoint(i.height),alternativeText:i.alternatetext},this.owner.selectionModule.updateImageSize(i)}else if(this.modifiedProperties[0]instanceof cc){for(var n=new l,r=0;r<this.modifiedProperties.length;r++){var o=this.modifiedProperties[r];n.add(r,o)}this.editorHistory.updateListChanges(n),n.destroy(),n=void 0}else if(this.modifiedProperties[0]instanceof Ra)this.owner.editorModule.updateTableFormat(this.owner.selectionModule,e,void 0);else if(this.modifiedProperties[0]instanceof Ma)this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selectionModule,e,void 0);else if(this.modifiedProperties[0]instanceof Ca)this.owner.editorModule.updateRowFormat(this.owner.selectionModule,e,void 0);else if("ModifyStyle"===this.action){var s=this.modifiedProperties.pop();this.owner.editor.updateStyleObject(s)}}this.currentPropertyIndex=0,"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.startParagraph=void 0,this.owner.editorModule.endParagraph=void 0},e.prototype.addModifiedCellOptions=function(e,t,i){var n;return n=(0,a.isNullOrUndefined)(e.bottomMargin)&&(0,a.isNullOrUndefined)(e.topMargin)&&(0,a.isNullOrUndefined)(e.rightMargin)&&(0,a.isNullOrUndefined)(e.leftMargin)?this.copyCellOptions(i.tableFormat):this.copyCellOptions(e),this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++,t):(this.modifiedProperties.push(n),t)},e.prototype.copyCellOptions=function(e){var t=new Ma;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},e.prototype.addModifiedTableOptions=function(e){var t=this.copyTableOptions(e);if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,t):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++}else this.modifiedProperties.push(t)},e.prototype.copyTableOptions=function(e){var t=new Ra;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},e.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":case"TableLeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"DifferentOddAndEvenPages":return"differentOddAndEvenPages";case"TableAlignment":return"tableAlignment";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing";case"LinkToPrevious":return"linkToPrevious";case"LeftBorder":case"TopBorder":case"RightBorder":case"BottomBorder":case"HorizontalBorder":case"VerticalBorder":case"Borders":return this.action[0].toLowerCase()+this.action.slice(1);case"TabStop":return"tabStop"}},e.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},e.prototype.addModifiedTableProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if((0,a.isNullOrUndefined)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?n.shading:n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var r=new Ra;r.copyFormat(e),this.modifiedProperties.push(r)}return i},e.prototype.addModifiedRowProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(this.owner.enableCollaborativeEditing&&this.modifiedProperties.length>1&&e.ownerBase){var r=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},e.ownerBase).position,o=r+1,s={};(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(s,n,0);var l={action:"Format",offset:r,length:o-r,format:JSON.stringify(s),type:"RowFormat"};this.modifiedFormatOperation.push(l)}if((0,a.isNullOrUndefined)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i=n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var d=new Ca;d.copyFormat(e),this.modifiedProperties.push(d)}return i},e.prototype.addModifiedCellProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if((0,a.isNullOrUndefined)(t))return i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?n.shading:n.getPropertyValue(t),n.copyFormat(e),this.currentPropertyIndex++}else{var r=new Ma;r.copyFormat(e),this.modifiedProperties.push(r)}return i},e.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,(0,a.isNullOrUndefined)(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!(0,a.isNullOrUndefined)(this.modifiedProperties)){for(var e=0;e<this.modifiedProperties.length;e++){var t=this.modifiedProperties[e];(t instanceof ka||t instanceof ba||t instanceof ga||t instanceof cc)&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),e--}this.modifiedPropertiesIn=void 0}if(!(0,a.isNullOrUndefined)(this.removedNodes)){for(e=0;e<this.removedNodes.length;e++){(i=this.removedNodes[e])instanceof Rl?i.destroyInternal(this.viewer):i instanceof ql&&!(i instanceof Bd)&&i.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(i),1),e--}this.removedNodesIn=void 0}if(!(0,a.isNullOrUndefined)(this.insertedNodes)){for(e=0;e<this.insertedNodes.length;e++){var i;(i=this.insertedNodes[e])instanceof Rl?i.destroyInternal(this.viewer):i instanceof ql&&!(i instanceof Bd)&&i.destroy(),this.insertedNodes.splice(this.insertedNodes.indexOf(i),1),e--}this.insertedNodes=void 0}this.ownerIn=void 0},e.prototype.recordInsertRevisionDeletetion=function(e,t,i){if(this.startIndex>this.endIndex){var n=this.startIndex;this.startIndex=this.endIndex,this.endIndex=n}var r=this.startIndex,o=this.endIndex;if(e instanceof Zl||e instanceof gd||e instanceof _l||e instanceof td){if(e.revisions.length>0){var s=this.owner.selectionModule.getElementPosition(e,!0).startPosition;t=(0,a.isNullOrUndefined)(t)?0:t,i=(0,a.isNullOrUndefined)(i)?e.length:i,s.setPositionParagraph(e.line,t+s.offset),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(s),this.endIndex=this.startIndex+i;var l=this.owner.editorModule.retrieveRevisionInOder(e),d=""===this.owner.currentUser?"Guest user":this.owner.currentUser;if("Insertion"===l.revisionType&&l.author!==d)this.revisionOperation.push(this.getFormatOperation());else if("Insertion"===l.revisionType){var h=this.getDeleteOperation("Delete",void 0,void 0);this.revisionOperation.push(h),o-=h.length}else if("Deletion"===l.revisionType&&l.author!==d){h=this.getFormatOperation(e);if(e.removedIds.length>0)for(var c=0;c<e.removedIds.length;c++)(0,a.isNullOrUndefined)(h.markerData.removedIds)||(h.markerData.removedIds=[]),h.markerData.removedIds.push(e.removedIds[c]);this.revisionOperation.push(h)}}}else if(e instanceof Rl){var p=!0;for(c=0;c<e.childWidgets.length;c++){var u=e.childWidgets[c];0===u.children.length&&(p=!1);for(var g=0;g<u.children.length;g++){var m=u.children[g];(m.revisions.length<=0||"Insertion"!==m.revisions[0].revisionType)&&(p=!1)}}if(p){var f=new ac(this.owner);f.setPositionParagraph(e.childWidgets[0],0),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(f);var v=this.owner.selectionModule.getBlockLength(void 0,e,0,{done:!1},!0,void 0,void 0);(d=""===this.owner.currentUser?"Guest user":this.owner.currentUser)===(l=this.owner.editorModule.retrieveRevisionInOder(e.childWidgets[0].children[0])).author&&(this.endIndex=this.startIndex+v,this.revisionOperation.push(this.getDeleteOperation(this.action,void 0,this.getRemovedText(e))),o-=v)}else for(c=0;c<e.childWidgets.length;c++)for(g=0;g<e.childWidgets[c].children.length;g++)this.recordInsertRevisionDeletetion(e.childWidgets[c].children[g]),r=this.startIndex,o=this.endIndex}this.startIndex=r,this.endIndex=o},e.prototype.getDeleteOperationsForTrackChanges=function(){var e=[],t=this.startIndex,i=this.endIndex;this.insertIndex;this.startIndex=t,this.endIndex=i;for(var n=0;n<this.revisionOperation.length;n++)"Format"==this.revisionOperation[n].action&&(0,a.isNullOrUndefined)(this.revisionOperation[n].markerData)&&(this.revisionOperation[n].markerData=this.markerData.pop()),e.push(this.revisionOperation[n]);for(n=this.removedNodes.length-1;n>=0;n--){var r=this.removedNodes[n];if(r instanceof Zl||r instanceof gd||r instanceof _l||r instanceof td){if(0===r.removedIds.length){var o=this.getFormatOperation();if(!(0,a.isNullOrUndefined)(o.markerData))for(var s=0;s<this.markerData.length;s++)"Deletion"===this.markerData[s].revisionType&&((0,a.isNullOrUndefined)(o.markerData.splittedRevisions)&&(o.markerData.splittedRevisions=[]),this.checkValidRevision(this.markerData[s].revisionId)&&o.markerData.splittedRevisions.push(this.markerData[s]),this.markerData.splice(s,1),s--);e.push(o);break}}else if(r instanceof Rl)if(r.characterFormat.revisions.length>0)e.push(this.getDeleteOperation(this.action));else{if(r.characterFormat.removedIds.length>0){o=this.getDeleteOperation(this.action);if((0,a.isNullOrUndefined)(this.isAcceptOrReject)||(o.markerData.isAcceptOrReject=this.isAcceptOrReject),e.push(o),!this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.insertPosition).isAtParagraphStart){var l=this.endIndex;this.endIndex=this.startIndex,e.push(this.getDeleteOperation("Delete")),this.endIndex=l}break}if(0===r.characterFormat.revisions.length){for(o=this.getFormatOperation(),s=0;s<this.markerData.length;s++)"Deletion"===this.markerData[s].revisionType&&((0,a.isNullOrUndefined)(o.markerData.splittedRevisions)&&(o.markerData.splittedRevisions=[]),this.checkValidRevision(this.markerData[s].revisionId)&&o.markerData.splittedRevisions.push(this.markerData[s]),this.markerData.splice(s,1),s--);this.markerData=[],e.push(o);break}}}return e},e.prototype.checkValidRevision=function(e){for(var t=0;t<this.owner.revisions.changes.length;t++)if(this.owner.revisions.changes[t].revisionID===e)return!0;return!1},e.prototype.getDeleteOperationForTrackChanges=function(e){var t;if(e instanceof Zl||e instanceof gd||e instanceof _l||e instanceof td)if(0===e.removedIds.length)t=this.getFormatOperation(e);else if(e.removedIds.length>0){var i=e.removedIds[0],n=this.owner.editorModule.getRevision(i),r=""===this.owner.currentUser?"Guest user":this.owner.currentUser;if("Insertion"===n.revisionType&&n.author!==r)t=this.getFormatOperation(e);else if("Insertion"===n.revisionType)t=this.getDeleteOperation(this.action,void 0,this.getRemovedText(e));else if("Deletion"===n.revisionType&&n.author!==r&&(t=this.getFormatOperation(e),e.removedIds.length>0))for(var o=0;o<e.removedIds.length;o++)(0,a.isNullOrUndefined)(t.markerData.removedIds)||(t.markerData.removedIds=[]),t.markerData.removedIds.push(e.removedIds[o])}return"Enter"===this.action||e instanceof Rl||!(0,a.isNullOrUndefined)(t)&&"Delete"===t.action||(this.startIndex+=e.length),t},e.prototype.getActionInfo=function(e){var t=this.action;(0,a.isNullOrUndefined)(this.isAcceptOrReject)||"Reject"!==this.isAcceptOrReject||(t="Reject Change");var i=[];switch(t.toString()){case"Insert":case"InsertTextParaReplace":case"Enter":case"InsertInline":case"SectionBreak":case"SectionBreakContinuous":if(this.removedNodes.length>0&&(0,a.isNullOrUndefined)(this.dropDownIndex))if(this.owner.enableTrackChanges&&!this.editorHistory.isUndoing)i=this.getDeleteOperationsForTrackChanges(),"InsertInline"!==t&&(this.insertIndex=this.endIndex);else{"InsertTextParaReplace"===t&&(this.startIndex>this.endIndex?this.startIndex:this.endIndex-=1);var n=this.getDeleteOperation(t);"Enter"===t&&this.owner.enableTrackChanges&&this.editorHistory.isUndoing&&(n.markerData={isSkipTracking:!0}),i.push(n)}if("Enter"===t||this.insertedText.length>0)if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&"Enter"!==t&&"SectionBreak"!==t&&"SectionBreakContinuous"!==t){if(this.isRemovedNodes){var r=this.getDeleteContent(t);i=i.concat(r)}}else{var s=this.getInsertOperation(t);if(this.owner.enableTrackChanges&&"Enter"!==this.action){this.insertedElement instanceof Yl&&(s.markerData=this.markerData[0],this.markerData.splice(0,1),s.text=o.Marker_Start,s.markerData.type=this.insertedElement.footnoteType,s.markerData.revisionForFootnoteEndnoteContent=this.markerData.pop()),i.push(s);for(var l=0;l<this.splittedRevisions.length;l++)(0,a.isNullOrUndefined)(s.markerData)&&(s.markerData={}),(0,a.isNullOrUndefined)(s.markerData.splittedRevisions)&&(s.markerData.splittedRevisions=[]),s.markerData.splittedRevisions.push(this.splittedRevisions[l])}else i.push(s)}var d=i[i.length-1];"Insert"!==t||(0,a.isNullOrUndefined)(d.text)||(d.length=d.text.length),(0,a.isNullOrUndefined)(this.dropDownIndex)||(d.markerData={type:"Field",dropDownIndex:this.dropDownIndex},d.offset=this.getElementAbsolutePosition(this.fieldBegin),d.type="DropDown");break;case"InsertTable":case"InsertTableBelow":if(this.removedNodes.length>0&&i.push(this.getDeleteOperation(t)),this.editorHistory.isUndoing&&this.isRemovedNodes)i.push(this.getUndoRedoOperation(t));else{var h=this.buildTableRowCellOperation(t);for(l=0;l<h.length;l++)i.push(h[l])}break;case"InsertRowAbove":case"InsertRowBelow":case"InsertColumnLeft":case"InsertColumnRight":if(this.editorHistory.isUndoing){for(l=0;l<this.cellOperation.length;l++)i.push(this.cellOperation[l]);s=this.getUndoRedoOperation(t,!0);this.owner.enableTrackChanges&&(0,a.isNullOrUndefined)(s.markerData)&&(s.markerData={isSkipTracking:!0}),i.push(s)}else{var c=this.buildTableRowCellOperation(t);i="InsertRowAbove"===t||"InsertRowBelow"===t?c.slice():c.reverse().slice()}break;case"BackSpace":case"Delete":case"Cut":case"DeleteBookmark":case"RemoveEditRange":case"RemoveContentControl":if(this.editorHistory.isUndoing)if("DeleteBookmark"==t||"RemoveEditRange"==t){if(this.startIndex-=1,this.insertIndex=this.startIndex,this.insertedText=o.Marker_Start,i.push(this.getInsertOperation(t)),this.insertedText=o.Marker_End,i.push(this.getInsertOperation(t,!0)),"RemoveEditRange"===t)(s=i[i.length-1]).offset-=1;this.startIndex+=1}else if(this.endRevisionLogicalIndex&&this.editorHistory.isUndoing){if(this.removedNodes.length>0)(n=this.getDeleteOperation(t)).markerData={isSkipTracking:!0},i.push(n);if(this.isRemovedNodes){r=this.getDeleteContent(t);i=i.concat(r)}}else{r=this.getDeleteContent(t);i=i.concat(r)}else if(this.cellOperation.length>0)i=this.cellOperation,this.cellOperation=[];else if(this.removedNodes.length>0)if(this.owner.enableTrackChanges)if(this.editorHistory.isRedoing){if(this.removedNodes.length>0)(n=this.getDeleteOperation(t)).markerData={isSkipTracking:!0},i.push(n);if(this.isRemovedNodes){r=this.getDeleteContent(t);i=i.concat(r)}}else i=this.getDeleteOperationsForTrackChanges();else{n=this.getDeleteOperation(t);i.push(n);for(l=0;l<this.removedNodes.length;l++){var p=this.removedNodes[parseInt(l.toString(),10)];if(p instanceof Ol)for(var u=p.removedHeaderFooters,g=0;g<u.length;g++){var m=u[parseInt(g.toString(),10)];if(Object.keys(m).length>0){i.push(this.getDeleteOperation("DeleteHeaderFooter",void 0));break}}}if("DeleteBookmark"===t||"RemoveEditRange"===t){if(i.push(this.getDeleteOperation(t,!0)),"RemoveEditRange"===t)(s=i[i.length-1]).offset-=1}else if("RemoveContentControl"===t){(s=this.getDeleteOperation(t,!0)).text=o.Marker_End,i.push(s)}}this.markerData=[];break;case"ResolveComment":case"EditComment":for(l=0;l<this.removedNodes.length;l++){s=this.getUpdateOperation();i.push(this.getCommentOperation(s,t,this.removedNodes[l]))}break;case"ClearRevisions":case"TrackingPageBreak":case"AcceptTOC":if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){if(this.removedNodes.length>0)(n=this.getDeleteOperation(t)).markerData={isSkipTracking:!0},i.push(n);if(this.isRemovedNodes){var f=void 0;if("string"==typeof this.removedNodes[0]&&(f=this.owner.editorModule.getRevision(this.removedNodes[0])),f&&f.range[0]instanceof ka)i.push(this.getInsertOperation("Enter"));else{r=this.getDeleteContent(t);i=i.concat(r)}}}else if(this.removedNodes.length>0){f=this.owner.editorModule.getRevision(this.removedNodes[0]);if("TrackingPageBreak"===t&&"string"!=typeof this.removedNodes[0]){(s=this.getDeleteOperation(t)).markerData.isAcceptOrReject="Reject",i.push(s);break}i.push(this.getRevisionOperation(f))}break;case"Reject Change":if(this.isRemovedNodes){r=this.getDeleteContent(t);i=i.concat(r)}else{(s=this.getDeleteOperation(t)).markerData.isAcceptOrReject="Reject",i.push(s)}break;case"Accept Change":if(this.isRemovedNodes){r=this.getDeleteContent(t);i=i.concat(r)}else{(n=this.getDeleteOperation(t)).markerData.isAcceptOrReject="Accept",i.push(n)}break;case"Paste":case"PasteColumn":case"PasteOverwrite":case"PasteRow":if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){if(this.removedNodes.length>0&&i.push(this.getDeleteOperation("Delete")),this.isRemovedNodes)if("Paste"===this.action){r=this.getDeleteContent(t);i=i.concat(r)}else i.push(this.getUndoRedoOperation(t,!0))}else{this.removedNodes.length>0&&i.push(this.getDeleteOperation("Delete"));var v=this.getPasteContentLength();"Paste"!==t&&this.owner.selectionModule.start.paragraph.isInsideTable&&(v=this.owner.selectionModule.getBlockLength(void 0,this.owner.selectionModule.start.paragraph.associatedCell.ownerTable,0,{done:!1},!0,void 0,void 0));var y={action:"Insert",offset:this.startIndex,length:v,pasteContent:JSON.stringify(this.pasteContent),type:(0,a.isNullOrUndefined)(this.type)?"Paste":this.type,markerData:this.markerData.pop()};i.push(y)}break;case"InsertHyperlink":if((0,a.isNullOrUndefined)(this.fieldBegin)){if(i.push(this.getDeleteOperation("BackSpace")),this.isRemovedNodes){r=this.getDeleteContent(t);i=i.concat(r)}}else i=this.isEditHyperlink?this.getEditHyperlinkOperation():this.getFieldOperation();this.fieldBegin=void 0;break;case"UpdateFormField":this.insertedText="";var w=this.getInsertOperation("UpdateFormField");w.text=o.Marker_Start,w.markerData={type:"Field",checkBoxValue:this.fieldBegin.formFieldData.checked},w.offset=this.getElementAbsolutePosition(this.fieldBegin),i.push(w);break;case"DeleteRow":case"DeleteCells":case"DeleteColumn":case"DeleteTable":case"ClearCells":case"MergeCells":if(this.editorHistory.isUndoing)"DeleteTable"==t?i.push(this.getUndoRedoOperation(t)):(i=this.cellOperation.slice(),this.insertIndex=this.startIndex,i.push(this.getUndoRedoOperation(t,!0)),this.cellOperation=[]);else if(this.removedNodes.length>0){if(this.cellOperation.length>0){for(l=0;l<this.cellOperation.length;l++)i.push(this.cellOperation[l]);"MergeCells"===t?(i.push(this.getPasteMergeOperation()),i.push(this.getFormatOperation()),this.type=void 0):i.reverse()}else this.owner.enableTrackChanges?i.push(this.getFormatOperation(void 0,t)):i.push(this.getDeleteOperation(t));this.cellOperation=[]}break;case"RemoveRowTrack":if(this.editorHistory.isUndoing){if(this.isRemovedNodes&&this.editorHistory.isUndoing){i=this.cellOperation.slice();r=this.getDeleteContent(t);(0,a.isNullOrUndefined)(r[0].markerData)&&(r[0].markerData={isSkipTracking:!0}),i.push.apply(i,r)}}else this.removedNodes.length>0&&(this.cellOperation.length>0?i.push.apply(i,this.cellOperation):(i=this.revisionOperation.slice(),this.getTrackchangesOperation(i)));break;case"RowResizing":case"CellResizing":i=this.getResizingOperation(t);break;case"ImageResizing":i.push(this.getFormatOperation());break;case"Bold":case"Italic":case"Underline":case"FontSize":case"Strikethrough":case"BaselineAlignment":case"HighlightColor":case"FontColor":case"FontFamily":case"Uppercase":case"Lowercase":case"CapitalizeEachWord":case"SentenceCase":case"ToggleCase":case"CharacterFormat":if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)if("Uppercase"===t){if(i.push(this.getDeleteOperation(t)),this.removedNodes){r=this.getDeleteContent(t);i=i.concat(r)}}else i=this.modifiedFormatOperation,this.modifiedFormatOperation=[];else i=this.buildFormatOperation(t,!0).slice();break;case"AfterSpacing":case"BeforeSpacing":case"RightIndent":case"LeftIndent":case"FirstLineIndent":case"LineSpacing":case"LineSpacingType":case"TextAlignment":case"Borders":case"TopBorder":case"BottomBorder":case"LeftBorder":case"RightBorder":case"HorizontalBorder":case"VerticalBorder":case"ListFormat":case"ParagraphFormat":case"StyleName":case"ClearParagraphFormat":case"SpaceBeforeAuto":case"SpaceAfterAuto":case"ParagraphBidi":case"ContextualSpacing":case"ContinueNumbering":case"List":if(this.modifiedFormatOperation.length>0&&!e)i=this.modifiedFormatOperation,this.modifiedFormatOperation=[];else{if(e&&this.editorHistory.isUndoing&&("ListFormat"===t||"ClearParagraphFormat"===t)&&(t="ParagraphFormat"),"ContinueNumbering"===t&&(this.type=t.toString()),"Borders"===t&&this.removedNodes[this.removedNodes.length-1]instanceof Al){this.insertedText=o.Cell,this.type="CellFormat",this.createCellFormat(t),i=this.getSelectedCellOperation(t,void 0,!0,!1,!0);break}i=this.buildFormatOperation(t,!1).slice()}break;case"TableAlignment":case"DefaultCellSpacing":case"TableLeftIndent":case"DefaultCellLeftMargin":case"DefaultCellRightMargin":case"DefaultCellTopMargin":case"DefaultCellBottomMargin":case"TablePreferredWidth":case"TablePreferredWidthType":case"TableBidi":this.createTableFormat(t),this.type="TableFormat",i.push(this.getFormatOperation()),this.format=void 0;break;case"RestartNumbering":this.type=t.toString();var b=this.getFormatOperation(void 0,t);this.createListFormat(t,b),i.push(b);break;case"Shading":this.createCellFormat(t),this.type="CellFormat",i=this.getSelectedCellOperation(t,void 0,void 0,!0,!0);break;case"TableAutoFitToContents":case"TableAutoFitToWindow":case"TableFixedColumnWidth":this.editorHistory.isUndoing?i=this.getDeleteContent("Insert"):(this.createTableFormat(t),this.type="TableFormat",this.insertedText=t.toString(),i.push(this.getFormatOperation()),this.format=void 0);break;case"SectionFormat":case"HeaderDistance":case"FooterDistance":case"DifferentFirstPage":case"DifferentOddAndEvenPages":case"PageWidth":case"PageHeight":case"LeftMargin":case"TopMargin":case"RightMargin":case"BottomMargin":case"RestartPageNumbering":case"PageStartingNumber":case"EndnoteNumberFormat":case"FootNoteNumberFormat":case"RestartIndexForEndnotes":case"RestartIndexForFootnotes":case"InitialFootNoteNumber":case"InitialEndNoteNumber":case"LineBetweenColumns":case"EqualWidth":case"BreakCode":case"LinkToPrevious":if(this.createSectionFormat(t),this.type="SectionFormat",i.push(this.getFormatOperation(void 0)),"LinkToPrevious"===t)(s=i[i.length-1]).offset=this.insertIndex;break;case"RowHeight":case"RowHeightType":case"AllowBreakAcrossPages":case"RowHeader":this.editorHistory.isUndoing||this.editorHistory.isRedoing&&this.modifiedProperties.length>1?(i=this.modifiedFormatOperation,this.modifiedFormatOperation=[]):(this.createRowFormat(t),this.type="RowFormat",i.push(this.getFormatOperation(void 0)),this.format=void 0);break;case"CellContentVerticalAlignment":case"CellLeftMargin":case"CellRightMargin":case"CellBottomMargin":case"CellTopMargin":case"CellPreferredWidth":case"CellPreferredWidthType":this.createCellFormat(t),this.type="CellFormat",i=this.getSelectedCellOperation(t,!1,!1,!1,!0).slice(),this.format=void 0;break;case"UpdateContentControl":if(this.modifiedProperties.length>0)(s=this.getFormatOperation()).text=o.Marker_Start,i.push(s);else if(this.removedNodes.length>0){(s=this.getFormatOperation()).text=o.Marker_Start;var C=this.removedNodes[0];s.markerData={type:"ContentControlCheckBox",checkBoxValue:C.value},i.push(s)}}return this.cellOperation=[],this.revisionOperation=[],this.isRemovedNodes=!1,i},e.prototype.getTrackchangesOperation=function(e){for(var t=this.markerData,i=t.length-1;i>=0;i--)if(!(0,a.isNullOrUndefined)(t[i].revisionId)){var n=this.getRevision(t[i].revisionId);if(n&&n.range.length>0)if(n.range[0]instanceof Ca)e.push(this.buildRowOperationForTrackChanges(n.range[0].ownerBase,"RemoveRowTrack"));else{var r=new ac(this.owner),o=new ac(this.owner);this.owner.selection.selectRevision(n,r,o),this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(r),this.endIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(o),e.push(this.getFormatOperation(void 0))}else this.owner.editorModule.removeMarkerInfoRevision(t[i].revisionId,t)}},e.prototype.getRevision=function(e){for(var t=0;t<this.owner.revisions.changes.length;t++){if(this.owner.revisions.changes[t].revisionID===e)return this.owner.revisions.changes[t]}},e.prototype.getElementAbsolutePosition=function(e){if(e){var t=this.owner.selectionModule.getElementPosition(e);return this.owner.selectionModule.getAbsolutePositionFromRelativePosition(t.startPosition)}},e.prototype.getFieldOperation=function(){var e=[],t=this.fieldBegin,i=!1,n=this.insertIndex;if(!(0,a.isNullOrUndefined)(t))do{var r=void 0,s=void 0,l=void 0,d=void 0,h=void 0;if(!t.skipformFieldLength){if(t instanceof _l){if(0===t.fieldType&&""!==this.getRemovedText()){e.push(this.getDeleteOperation("Delete"));var c=e[e.length-1];c.offset=n,!(0,a.isNullOrUndefined)(c.markerData)&&this.owner.enableTrackChanges&&(c.markerData.isSkipTracking=!0)}r=0===t.fieldType?o.Marker_Start:1===t.fieldType?o.Marker_End:2===t.fieldType?o.Field_Separator:"",0===t.fieldType&&t.formFieldData?(h=this.formFieldType,t.revisions.length>0&&(s=this.owner.editorModule.getRevisionMarkerData(s,t.revisions[0])),(0,a.isNullOrUndefined)(s)&&(s={}),s.type="Field",s.formFieldData=JSON.stringify(t.formFieldData)):(t.revisions.length>0&&(s=this.owner.editorModule.getRevisionMarkerData(s,t.revisions[0])),(0,a.isNullOrUndefined)(s)&&(s={}),s.type="Field"),l=t.length}else this.fieldBegin.formFieldData&&t instanceof td?(r=0===t.bookmarkType?o.Marker_Start:o.Marker_End,s={bookmarkName:t.name,type:"Bookmark"},l=t.length):t instanceof Zl&&(r=t.text,l=t.length,t.revisions.length>0&&(s=this.owner.editorModule.getRevisionMarkerData(s,t.revisions[0])));if(!(t instanceof td)){var p=this.owner.sfdtExportModule.writeCharacterFormat(t.characterFormat,0);d=JSON.stringify(p)}var u={action:"Insert",offset:n,type:h,text:r,length:l,markerData:s,format:d};if(e.push(u),n+=t.length,s=void 0,h=void 0,d=void 0,t instanceof _l&&1===t.fieldType&&(i=!0,this.fieldBegin.formFieldData&&t.nextNode instanceof td)){var g=t.nextNode;r=0===g.bookmarkType?o.Marker_Start:o.Marker_End,g.revisions.length>0&&(s=this.owner.editorModule.getRevisionMarkerData(s,g.revisions[0])),(0,a.isNullOrUndefined)(s)&&(s={}),s.bookmarkName=g.name,s.type="Bookmark";var m={action:"Insert",offset:n,text:r,length:l=g.length,markerData:s};e.push(m)}}t=t.nextNode}while(!i&&!(0,a.isNullOrUndefined)(t));return e},e.prototype.getDeleteContent=function(e){var t=[],i=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabStart),n=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabEnd),r=n.clone();if(r.offset=n.offset-1,i.isAtParagraphStart&&r.isAtParagraphEnd&&!i.currentWidget.paragraph.isInsideTable)t.push(this.getInsertOperation("Enter",!1,!0)),t.push(this.getUndoRedoOperation(e));else if(i.paragraph==n.paragraph)i.isAtSamePosition(n)?(this.owner.selectionModule.isEmpty&&"BackSpace"===e&&(this.insertIndex-=1),t.push(this.getUndoRedoOperation(e,!1,!0))):t.push(this.getUndoRedoOperation(e));else if(i.currentWidget.paragraph.isInsideTable)(t=this.cellOperation.slice()).push(this.getUndoRedoOperation(e,!0));else if(t.push(this.getUndoRedoOperation(e)),this.startIndex=this.endIndex+1,!i.isAtParagraphStart&&!r.isAtParagraphEnd){var o=this.getDeleteOperation("Delete");this.owner.enableTrackChanges&&(o.markerData={isSkipTracking:!0}),t.push(o)}return t},e.prototype.getEditHyperlinkOperation=function(){var e=[],t=this.fieldBegin;if(t){var i=this.getElementAbsolutePosition(t);e.push(this.getDeleteOperation("Delete"));var n=e[e.length-1];n.offset=i;var r=this.getRemovedFieldCode();n.length=r.length,n.text=r,e.push(this.getInsertOperation("InsertHyperlink")),(n=e[e.length-1]).offset=i,r=this.owner.selectionModule.getFieldCode(t,!0),n.text=r,n.length=r.length}return e},e.prototype.getPasteContentLength=function(){for(var e=0,t=0;t<this.insertedNodes.length;t++){var i=this.insertedNodes[t];e+=i instanceof Zl?i.length:this.owner.selectionModule.getBlockLength(void 0,i,0,{done:!1},!0,void 0,void 0)}return this.insertedNodes=[],e},e.prototype.getUpdateOperation=function(){return{action:"Update"}},e.prototype.getResizingOperation=function(e){var t=[],i=this.owner.editorModule.tableResize,n=i.currentResizingTable;if(!(0,a.isNullOrUndefined)(n.childWidgets)){n=n.combineWidget(this.owner.viewer);var r=i.resizerPosition,s={paragraph:null,offset:0};if("RowResizing"==e){var l=n.childWidgets[r];(0,a.isNullOrUndefined)(l)&&(l=this.modifiedProperties[0].rowFormat.ownerBase),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(s,{position:0,done:!1},l).position,this.endIndex=this.startIndex+this.getRowLength(l);var d={};(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(d,l.rowFormat,0),this.format=JSON.stringify(d),this.insertedText=o.Row,t.push(this.getFormatOperation())}else{var h=r,c=r-1;this.insertedText=o.Cell;var p=!1;if(this.owner.selectionModule.isEmpty){p=!0;for(l=n.firstChild;l;){for(w=l.firstChild;w;){if(w.index==h||w.index==c){b={};(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||(b=this.owner.sfdtExportModule.writeCellFormat(w.cellFormat,0)),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(s,{position:0,done:!1},w).position,this.endIndex=this.startIndex+this.owner.selectionModule.calculateCellLength(w)+1,this.type="CellFormat",this.format=JSON.stringify(b),t.push(this.getFormatOperation())}w=w.nextWidget}d={};(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(d,l.rowFormat,0),this.format=JSON.stringify(d),this.type="RowFormat",this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(s,{position:0,done:!1},l).position,this.endIndex=this.startIndex+this.getRowLength(l),t.push(this.getFormatOperation()),l=l.getSplitWidgets().pop().nextRenderedWidget}}else{var u=i.getTableCellWidget(i.startingPoint);if(u&&(this.owner.selectionModule.selectedWidgets.containsKey(u)||u.previousWidget&&this.owner.selectionModule.selectedWidgets.containsKey(u.previousWidget))){p=!0;for(var g=this.owner.selectionModule.getSelectedCells(),m=g[0],f=g[g.length-1],v=n.childWidgets.indexOf(m.ownerRow),y=n.childWidgets.indexOf(f.ownerRow),l=n.childWidgets[v];l&&l.index<=y;){for(var w=l.firstChild;w;){if(w.index==h||w.index==c){var b={};(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||(b=this.owner.sfdtExportModule.writeCellFormat(w.cellFormat,0)),this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(s,{position:0,done:!1},w).position,this.endIndex=this.startIndex+this.owner.selectionModule.calculateCellLength(w)+1,this.type="CellFormat",this.format=JSON.stringify(b),t.push(this.getFormatOperation())}w=w.nextWidget}var d={};(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(d,l.rowFormat,0),this.format=JSON.stringify(d),this.type="RowFormat",this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(s,{position:0,done:!1},l).position,this.endIndex=this.startIndex+this.getRowLength(l),t.push(this.getFormatOperation()),l=l.getSplitWidgets().pop().nextRenderedWidget}}}if(p){var C;C=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeTableFormat(n.tableFormat,0):{},this.format=JSON.stringify(C),this.type="TableFormat",this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(s,{position:0,done:!1},n).position,this.endIndex=this.startIndex+this.owner.selectionModule.getBlockLength(void 0,n,0,{done:!1},!0,void 0,void 0)-1,t.push(this.getFormatOperation())}}this.owner.documentHelper.layout.reLayoutTable(n)}return this.format=void 0,t},e.prototype.getRowLength=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=this.owner.selectionModule.calculateCellLength(e.childWidgets[i])+1;return t},e.prototype.getDeleteOperation=function(e,t,i){if(this.startIndex>this.endIndex){var n=this.startIndex;this.startIndex=this.endIndex,this.endIndex=n}if("Delete"===e&&this.endIndex<this.startIndex){var r=this.startIndex;this.startIndex=this.endIndex,this.endIndex=r}this.endIndex===this.startIndex&&"DeleteBookmark"!==e&&"RemoveEditRange"!==e&&"InsertHyperlink"!==this.action&&("BackSpace"===e||"Insert"===e||"Enter"===e?this.startIndex--:this.endIndex++),"DeleteHeaderFooter"===e&&(this.startIndex=this.headerFooterStart,this.endIndex=this.headerFooterEnd);var o,s=(0,a.isNullOrUndefined)(i)?this.endIndex-this.startIndex:i.length;"DeleteBookmark"===e||"RemoveEditRange"===e||"RemoveContentControl"===e?(o=this.insertedText,s=1):"DeleteHeaderFooter"===e||("DeleteTable"===e||"DeleteRow"===e||"DeleteColumn"===e||"MergeCells"===e||"RemoveRowTrack"===e?(o=this.insertedText,"DeleteTable"!==e&&"DeleteRow"!==e&&(s=this.tableRelatedLength)):o=(0,a.isNullOrUndefined)(i)?this.getRemovedText():i),"Cut"===e&&" "===o[o.length-1]&&s<o.length&&(s=o.length);var l={action:"Delete",offset:t?this.endIndex:this.startIndex,text:o,length:"Paste"===e||0===s?o.length:s,skipOperation:"DeleteHeaderFooter"===e||void 0,markerData:this.markerData[0]};if(this.removedNodes[0]instanceof Yl)if(this.editorHistory.isUndoing&&l.length>=3)l.length+=1;else{var d=this.removedNodes[0],h=d.bodyWidget.lastChild,c={position:0,done:!1},p={paragraph:h,offset:this.owner.selectionModule.getParagraphLength(h)+1};this.owner.selectionModule.getPositionInfoForBodyContent(p,c,d.bodyWidget.firstChild),l.length+=c.position}return l},e.prototype.getInsertOperation=function(e,t,i){var n,r="Enter"===e?"\n":this.insertedText;"InsertTable"===e||"InsertTableBelow"===e||"InsertRowAbove"===e||"InsertRowBelow"===e||"InsertColumnLeft"===e||"InsertColumnRight"===e||"MergeCells"===e||"RemoveRowTrack"===e?(n=this.tableRelatedLength,"InsertTable"!==this.action&&"InsertTableBelow"!==this.action||(this.insertIndex=this.startIndex)):(0,a.isNullOrUndefined)(r)||(n=r.length);var o={action:"Insert",offset:t?this.endIndex:this.insertIndex,text:r,type:this.type,length:n,skipOperation:!1,imageData:this.insertedData,format:this.format};return(0,a.isNullOrUndefined)(this.markerData)||i||(o.markerData=this.markerData.pop()),this.insertedElement instanceof Yl&&(o.length+=this.getFootNoteLength()),o},e.prototype.getFootNoteLength=function(){var e=this.insertedElement.bodyWidget.lastChild,t={position:0,done:!1},i={paragraph:e,offset:this.owner.selectionModule.getParagraphLength(e)+1};return this.owner.selectionModule.getPositionInfoForBodyContent(i,t,this.insertedElement.bodyWidget.firstChild),t.position},e.prototype.getUndoRedoOperation=function(e,t,i){var n,r,o,s,a,l,d=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabStart),h=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabEnd),c=0;if(t){if("BackSpace"===e||"Delete"===e||"Insert"===e){n=d.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},n).position,h.currentWidget.paragraph.isInsideTable?(s=(r=this.documentHelper.getLastParagraphBlock(h.currentWidget.paragraph.associatedCell.ownerTable)).lastChild,a=r.lastChild.getEndOffset()):(s=h.currentWidget,a=h.offset)}else n=this.owner.selectionModule.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),s=(r=this.documentHelper.getLastParagraphBlock(n)).lastChild,a=r.lastChild.getEndOffset();o=this.documentHelper.getFirstParagraphBlock(n).firstChild,l=0,c=this.owner.selectionModule.getBlockLength(void 0,n,0,{done:!1},!0,void 0,void 0)}else{o=d.currentWidget,s=h.currentWidget,a=i?"BackSpace"==e?h.offset:h.offset+1:h.offset,l=i&&"BackSpace"===e?d.offset-1:d.offset;var p=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(this.collabStart);c=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(this.collabEnd)-p}return this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,o,l,s,a,!1,!0),this.getPasteOpertion(this.pasteContent,c)},e.prototype.getPasteOpertion=function(e,t){var i={action:"Insert",offset:this.startIndex,length:t>0?t:1,pasteContent:JSON.stringify(e),type:"Paste"};return this.owner.enableTrackChanges&&(i.markerData={isSkipTracking:!0}),!(0,a.isNullOrUndefined)(this.insertedElement)&&this.insertedElement instanceof Yl&&(i.length+=this.getFootNoteLength()),i},e.prototype.buildTableRowCellOperation=function(e){var t=[];if(this.insertedNodes.length>0){if(this.insertedNodes[0]instanceof Ul){var i=this.insertedNodes[0],n={paragraph:null,offset:0};this.insertIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(n,{position:0,done:!1},this.insertedNodes[0]).position;var r=this.insertedNodes.length;i.ownerTable.childWidgets.length===i.indexInOwner+r&&(this.insertIndex-=1)}if(this.insertedNodes.length>1&&"InsertTable"===e){var s=this.getInsertOperation("Enter",!1,!0);(0,a.isNullOrUndefined)(s.markerData)&&(s.markerData={}),s.markerData.isSkipTracking=!0,t.push(s)}for(var l=0;l<this.insertedNodes.length;l++)if(this.insertedNodes[l]instanceof Al){var d=this.insertedNodes[l].combineWidget(this.owner.viewer);this.tableRelatedLength="InsertTableBelow"===e?0:1,this.insertedText=o.Table;var h=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeTableFormat(d.tableFormat,0):{};this.format=JSON.stringify(h),t.push(this.getInsertOperation(e,!1,!0));for(var c=0;c<d.childWidgets.length;c++){i=d.childWidgets[c];t.push(this.buildRowOperation(i,e));for(var p=0;p<i.childWidgets.length;p++)for(var u=i.childWidgets[p],g=this.buildCellOperation(u,e,!0),m=0;m<g.length;m++)t.push(g[m])}}else if(this.insertedNodes[l]instanceof Ul){i=this.insertedNodes[l];t.push(this.buildRowOperation(i,e));for(c=0;c<i.childWidgets.length;c++)for(u=i.childWidgets[c],g=this.buildCellOperation(u,e,!0),m=0;m<g.length;m++)t.push(g[m])}else if(this.insertedNodes[l]instanceof Vl){var f=(u=this.insertedNodes[l]).ownerTable.combineWidget(this.owner.viewer),v=0;for(c=0;c<f.childWidgets.length;c++){l=this.insertedNodes.length;for(i=f.childWidgets[c],p=0;p<i.childWidgets.length;p++){var y=i.childWidgets[p];n={paragraph:null,offset:0};if(-1!==this.insertedNodes.indexOf(y)){var w=this.owner.selectionModule.getPositionInfoForHeaderFooter(n,{position:0,done:!1},y).position;this.insertIndex=w-v,y.ownerTable.childWidgets.length===y.ownerRow.indexInOwner+1&&-1!==this.insertedNodes.indexOf(i.childWidgets[i.childWidgets.length-1])&&(this.insertIndex-=1);for(g=this.buildCellOperation(y,e,!0),m=0;m<g.length;m++)t.push(g[m]);v+=2}else{w=this.owner.selectionModule.getPositionInfoForHeaderFooter(n,{position:0,done:!1},y).position;this.insertIndex=w-v;for(g=this.buildCellOperation(y,e,!1),m=0;m<g.length;m++)t.push(g[m])}}}}this.insertedNodes=[]}return t},e.prototype.assignRevisionData=function(e,t,i,n){return{revisionType:e,author:t,date:i,revisionId:n}},e.prototype.createAcceptRejectOperation=function(e){var t=this.owner.selectionModule.start;if(t.paragraph.isInsideTable){var i=t.paragraph.associatedCell.ownerRow,n=0;if(this.insertedText=o.Row,i.rowFormat.revisions.length>0){var r=i.rowFormat.revisions[0],s=void 0;"Accept Change"===e?s="Accept":"Reject Change"===e&&(s="Reject"),this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,r,s))}var a=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},i).position;if(i.rowFormat.revisions.length>0){if("Insertion"===i.rowFormat.revisions[0].revisionType){if("Accept Change"===e)this.startIndex=a,this.tableRelatedLength=1,this.cellOperation.push(this.getFormatOperation(void 0,"RemoveRowTrack"));else if("Reject Change"===e){this.startIndex=a;for(var l=0;l<i.childWidgets.length;l++)n+=this.owner.selectionModule.calculateCellLength(i.childWidgets[l])+1;this.tableRelatedLength=n,this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack"))}}else if("Deletion"===i.rowFormat.revisions[0].revisionType)if("Accept Change"===e){this.startIndex=a;for(l=0;l<i.childWidgets.length;l++)n+=this.owner.selectionModule.calculateCellLength(i.childWidgets[l])+1;this.tableRelatedLength=n,this.cellOperation.push(this.getDeleteOperation("RemoveRowTrack"))}else if("Reject Change"===e){this.startIndex=a;for(l=0;l<i.childWidgets.length;l++)n+=this.owner.selectionModule.calculateCellLength(i.childWidgets[l])+1;this.tableRelatedLength=n,this.cellOperation.push(this.getFormatOperation(void 0,"RemoveRowTrack"))}this.markerData=[]}}},e.prototype.buildRowOperation=function(e,t){this.insertedText=o.Row;var i={};if((0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(i,e.rowFormat,0),this.format=JSON.stringify(i),"InsertTable"===t&&e.rowFormat.revisions.length>0){var n=e.rowFormat.revisions[e.rowFormat.revisions.length-1],r=this.markerData[this.markerData.length-1];((0,a.isNullOrUndefined)(r)||r.revisionId!==n.revisionID)&&this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,n))}this.tableRelatedLength=1;var s=this.getInsertOperation(t);return this.format=void 0,s},e.prototype.buildRowOperationForTrackChanges=function(e,t){var i=0,n=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},e).position;this.startIndex=n;for(var r=0;r<e.childWidgets.length;r++)i+=this.owner.selectionModule.calculateCellLength(e.childWidgets[r])+1;this.tableRelatedLength=i,this.insertedText=o.Row;var s=this.getFormatOperation(void 0,t);return this.insertedText="",s},e.prototype.buildCellOperation=function(e,t,i){var n=[];this.tableRelatedLength=i?1:0,this.insertedText=o.Cell,this.type="CellFormat";var r=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeCellFormat(e.cellFormat,0);if(this.format=JSON.stringify(r),n.push(this.getInsertOperation(t,!1,!0)),!i)return n;this.tableRelatedLength=i?1:0,this.type="ParagraphFormat";var s=this.owner.sfdtExportModule.writeParagraphFormat(e.childWidgets[0].paragraphFormat,0,!0);this.format=JSON.stringify(s),n.push(this.getInsertOperation(t,!1,!0)),this.tableRelatedLength=0,this.type="CharacterFormat";var l=this.owner.sfdtExportModule.writeCharacterFormat(e.childWidgets[0].characterFormat,0,!0);return this.format=JSON.stringify(l),n.push(this.getInsertOperation(t,!1,!0)),this.format=void 0,this.type=void 0,n},e.prototype.deleteColumnOperation=function(e){var t=this.owner.editorModule.getOwnerCell(this.owner.selectionModule.isForward),i=this.owner.editorModule.getOwnerCell(!this.owner.selectionModule.isForward),n=t.ownerTable.combineWidget(this.owner.viewer),r=[],o=0,s=0;if("DeleteColumn"===e)r=n.getColumnCellsForSelection(t,i);else{var a=this.owner.selectionModule.getCellLeft(t.ownerRow,t),l=a+t.cellFormat.cellWidth,d=this.owner.selectionModule.getCellLeft(i.ownerRow,i),h=d+i.cellFormat.cellWidth,c=this.owner.editorModule.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end,s=n.childWidgets.indexOf(i.ownerRow);for(var p=o=n.childWidgets.indexOf(t.ownerRow);p<=s;p++)for(var u=n.childWidgets[p],g=0;g<u.childWidgets.length;g++){var m=u.childWidgets[g],f=this.owner.selectionModule.getCellLeft(u,m);Pa.round(a,2)<=Pa.round(f,2)&&Pa.round(f,2)<Pa.round(l,2)&&r.push(m)}}var v=this.owner.selectionModule.isRowSelect()&&o!=s;for(p=0;p<r.length;p++)if("ClearCells"===e)this.deleteCell(e,r[p],!1);else if("MergeCells"===e){if(0!==p){var y=v&&!r[0].ownerRow.equals(r[p].ownerRow)&&0==r[p].index;this.deleteCell(e,r[p],y)}}else this.deleteCell("DeleteColumn",r[p],!1);"MergeCells"===e&&(this.cellOperation.reverse(),this.deleteCell("ClearCells",r[0],!1))},e.prototype.getPasteMergeOperation=function(){var e=this.owner.selectionModule.start.paragraph.associatedCell,t=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},e).position,i=this.owner.selectionModule.calculateCellLength(e)-1,n=this.owner.selectionModule.getFirstParagraph(e),r=this.owner.selectionModule.getLastParagraph(e),s=n.firstChild,a=r.lastChild;this.pasteContent=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,s,0,a,a.getEndOffset(),!1,!0),this.startIndex=t+1;var l={action:"Insert",offset:this.startIndex,length:i,pasteContent:JSON.stringify(this.pasteContent),type:"Paste"};return this.insertedText=o.Cell,this.type="CellFormat",this.startIndex=t,this.endIndex=t,this.format=JSON.stringify(this.owner.sfdtExportModule.writeCellFormat(e.cellFormat,0)),l},e.prototype.deleteCell=function(e,t,i){this.tableRelatedLength=this.owner.selectionModule.calculateCellLength(t)+1;if(this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},t).position,this.startIndex-=i?1:0,this.tableRelatedLength+=i?1:0,!this.owner.enableTrackChanges)if("ClearCells"===e){var n=t.childWidgets[0];if(1===t.childWidgets.length&&n instanceof Rl&&n.isEmpty())return;this.endIndex=this.startIndex+this.tableRelatedLength-1,this.startIndex+=1,this.cellOperation.push(this.getDeleteOperation("ClearCells"))}else this.cellOperation.push(this.getDeleteOperation("DeleteColumn"))},e.prototype.getFormatOperation=function(e,t,i){if(this.startIndex>this.endIndex){var n=this.startIndex;this.startIndex=this.endIndex,this.endIndex=n}var r=0;this.endIndex!==this.startIndex||i||"DeleteBookmark"===this.action||"RemoveEditRange"===this.action||"InsertHyperlink"===this.action||("BackSpace"===this.action?this.startIndex--:this.endIndex++),r="RemoveRowTrack"===t?this.tableRelatedLength:"RowResizing"===t||"CellResizing"===t||"ImageResizing"===t?this.insertedText.length:(0,a.isNullOrUndefined)(e)?this.endIndex-this.startIndex:e.length;var o={action:"Format",offset:this.startIndex,length:r,markerData:this.markerData[this.markerData.length-1],imageData:this.insertedData,text:this.insertedText,format:this.format};return this.markerData.pop(),(0,a.isNullOrUndefined)(t)?o.type=this.type:o.type=t.toString(),o},e.prototype.getRemovedText=function(e){var t="";if((0,a.isNullOrUndefined)(e))for(var i=this.removedNodes.length-1;i>=0;i--){var n;(n=this.removedNodes[i])instanceof Rl?t+=this.getParagraphText(n):n instanceof ql?n instanceof Zl?t+=n.text:n instanceof md||(t+=ql.objectCharacter):n instanceof Al?t+=this.getTableText(n):n instanceof Ul&&(t+=this.getRowText(n))}else(n=e)instanceof Rl?t+=this.getParagraphText(n):n instanceof ql?n instanceof Zl?t+=n.text:n instanceof md||(t+=ql.objectCharacter):n instanceof Al?t+=this.getTableText(n):n instanceof Ul&&(t+=this.getRowText(n));return t},e.prototype.getRevisionOperation=function(e){return"Insertion"===e.revisionType?(this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,e,"Accept")),this.getFormatOperation()):"Deletion"===e.revisionType?(this.markerData.push(this.owner.editorModule.getMarkerData(void 0,void 0,e,"Reject")),this.getFormatOperation()):{}},e.prototype.getRemovedFieldCode=function(){for(var e="",t=!1,i=this.removedNodes.length-1;i>=0;i--){var n=this.removedNodes[i];if(n instanceof ql){if(n instanceof _l&&0===n.fieldType&&(t=!0),n&&n instanceof Zl&&t&&(e+=n.text),n instanceof _l&&(2===n.fieldType||1===n.fieldType))return e}else if(n instanceof Rl)for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];if(a instanceof _l&&0===a.fieldType&&(t=!0),a instanceof Zl&&t&&(e+=a.text),a instanceof _l&&(2===a.fieldType||1===a.fieldType))return e}}},e.prototype.getParagraphText=function(e){var t="";if(!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(e.childWidgets)){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++)n.children[r]instanceof md||(n.children[r]instanceof Zl?t+=n.children[r].text:t+=ql.objectCharacter);return t+"\n"}return t},e.prototype.getTableText=function(e){for(var t=o.Table,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];t+=this.getRowText(n)}return t},e.prototype.getRowText=function(e){for(var t=o.Row,i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){t+=o.Cell;var s=n.childWidgets[r];t+=s instanceof Rl?this.getParagraphText(s):this.getTableText(s)}return t},e.prototype.getCommentOperation=function(e,t,i){if("InsertInline"===t||"RemoveInline"===t){var n="RemoveInline"===t?this.removedNodes[0]:this.insertedElement,r=n.comment;e.text=0===n.commentType?o.Marker_Start:o.Marker_End,e.markerData={type:"Comment",commentId:n.commentId,ownerCommentId:r.isReply?r.ownerComment.commentId:void 0}}else if("InsertCommentWidget"===t||"DeleteCommentWidget"===t){if((0,a.isNullOrUndefined)(i)&&(i=this.removedNodes[0]),e.length=1,e.action="Format",e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,e.offset-=1,e.text=o.Marker_Start+o.Marker_End,e.markerData={type:"Comment",commentId:i.commentId,author:i.author,date:i.date,commentIndex:i.isReply?i.ownerComment.replyComments.indexOf(i):this.owner.documentHelper.comments.indexOf(i),initial:i.initial,done:i.isResolved,text:i.text,isReply:i.isReply},!(0,a.isNullOrUndefined)(i.ownerComment)){var s=this.owner.selection.getElementPosition(i.ownerComment.commentEnd,!0).startPosition;e.offset=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(s)}"DeleteCommentWidget"===t?(e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,e.offset-=1,e.markerData.commentAction="remove"):"InsertCommentWidget"===t&&(e.markerData.commentAction="add")}else"ResolveComment"===t?(e.action="Format",e.length=1,e.text=o.Marker_Start+o.Marker_End,e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,e.offset-=1,e.markerData={type:"Comment",commentId:i.commentId,done:i.isResolved}):"EditComment"===t&&(e.action="Format",e.length=1,e.text=o.Marker_Start+o.Marker_End,e.offset=this.startIndex<this.endIndex?this.endIndex:this.startIndex,e.offset-=1,e.markerData={type:"Comment",text:i.text});return e},e.prototype.getDeleteCommentOperation=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n instanceof Cc&&"DeleteComment"===n.action)this.getDeleteCommentOperation(n.modifiedActions,t);else{var r=n.getDeleteOperation(n.action);if(n.getCommentOperation(r,n.action),"DeleteCommentWidget"===n.action&&!(0,a.isNullOrUndefined)(e[i+1])){var o=e[i+1];r.offset=o.startIndex<o.endIndex?o.startIndex:o.endIndex}t.push(r)}}},e.prototype.buildFormatOperation=function(e,t){var i;return("ApplyStyle"===e||"StyleName"===e)&&this.insertedFormat instanceof Wa?(this.insertedFormat=this.insertedFormat.name,this.type="ParagraphFormat",this.createParagraphFormat(e)):("ApplyStyle"!==e&&"StyleName"!==e||(this.insertedFormat instanceof ka&&this.insertedFormat.baseCharStyle?this.insertedFormat=this.insertedFormat.baseCharStyle.name:this.insertedFormat=this.insertedFormat.name),t?(this.type="CharacterFormat",this.createCharacterFormat(e)):(this.type="ContinueNumbering"==e?"ContinueNumbering":"ParagraphFormat",this.createParagraphFormat(e))),i=this.getSelectedCellOperation(e,t),this.format=void 0,i},e.prototype.getSelectedCellOperation=function(e,t,i,n,r){var o=[],s=this.owner.selectionModule.start,l=this.owner.selectionModule.end;if(s.paragraph.isInsideTable&&l.paragraph.isInsideTable&&s.paragraph.associatedCell.ownerTable.equals(l.paragraph.associatedCell.ownerTable)&&this.owner.selectionModule.isCellSelected(s.paragraph.associatedCell,s,l))for(var d=this.owner.selectionModule.getSelectedCells(),h=0;h<d.length;h++){var c=d[h],p={paragraph:null,offset:0};this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(p,{position:0,done:!1},c).position;var u=this.owner.selectionModule.calculateCellLength(c)+1;if(this.endIndex=this.startIndex+u,0!==u||!t){if(!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||t)this.writeBorderFormat(i,n,c);else if(!(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)){var g=this.owner.sfdtExportModule.writeCellFormat(c.cellFormat,0);this.format=JSON.stringify(g)}var m=void 0;"ListFormat"===e?((m=this.getFormatOperation(void 0,void 0,!0)).type="ListFormat",this.createListFormat(e,m)):m=this.getFormatOperation(void 0,void 0,!0),o.push(m)}}else{var f=void 0;if("ListFormat"===e)f=this.getFormatOperation(void 0,e),this.createListFormat(e,f);else{if(s.paragraph.isInsideTable&&r){p={paragraph:null,offset:0};this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter(p,{position:0,done:!1},s.paragraph.associatedCell).position;var v=this.owner.selectionModule.calculateCellLength(s.paragraph.associatedCell)+1;this.endIndex=this.startIndex+v,this.writeBorderFormat(i,n,s.paragraph.associatedCell)}if("ClearFormat"===e&&this.editorHistory.isUndoing)return this.buildclearFormatOperations(o),o;f=this.getFormatOperation(void 0,void 0,!0)}o.push(f)}return o},e.prototype.buildclearFormatOperations=function(e){var t=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabStart),i=this.owner.selectionModule.getTextPosBasedOnLogicalIndex(this.collabEnd),n=t.paragraph,r=!1;do{if(r=n.equals(i.paragraph),n instanceof Rl)this.buildclearFormatOperation(n,e);else{var o={done:!1};this.tableClearFormatOperation(n,i.paragraph,e,o),o.done&&(r=!0)}n=n.nextRenderedWidget}while(!r)},e.prototype.tableClearFormatOperation=function(e,t,i,n){for(var r=e.firstChild;r;){for(var o=r.firstChild;o;){var s=o.firstChild;if(s instanceof Rl)this.buildclearFormatOperation(s,i);else if(this.tableClearFormatOperation(s,t,i,n),n.done)return;if(t.equals(s))return void(n.done=!0);o=o.nextWidget}r=r.getSplitWidgets().pop().nextRenderedWidget}},e.prototype.buildclearFormatOperation=function(e,t){for(var i=!0,n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.children.length;o++)if(r.children[o]instanceof Zl){var s=this.owner.selectionModule.getElementPosition(r.children[o],!0).startPosition;this.startIndex=this.owner.selectionModule.getAbsolutePositionFromRelativePosition(s);var a=this.getFormatOperation(r.children[o]);if(a.length+=1,i){var l={action:"Format",offset:a.offset,length:a.length,type:"ParagraphFormat",format:JSON.stringify(this.owner.sfdtExportModule.writeParagraphFormat(e.paragraphFormat,0,!0))};t.push(l),i=!1}a.type="CharacterFormat",a.format=JSON.stringify(this.owner.sfdtExportModule.writeCharacterFormat(r.children[o].characterFormat,0,!0)),t.push(a)}},e.prototype.writeBorderFormat=function(e,t,i){var n={};e&&(n.borders=Pa.writeBorders(i.cellFormat.borders,0),this.format=JSON.stringify(n)),t&&(n.shading=this.owner.sfdtExportModule?this.owner.sfdtExportModule.writeShading(i.cellFormat.shading,0):{},this.format=JSON.stringify(n))},e.prototype.createListFormat=function(e,t){var i,n;if("ListFormat"===e?(i=this.insertedFormat.listId,t.text=e.toString().charAt(0).toLowerCase()+e.toString().slice(1)):(i=this.insertedFormat.listId,n=this.insertedFormat.nsid),i>-1){var r=this.owner.documentHelper.getListById(i),o={};o.optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||(this.owner.sfdtExportModule.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0,o[re[this.owner.sfdtExportModule.keywordIndex]]=[],o[re[this.owner.sfdtExportModule.keywordIndex]].push(this.owner.sfdtExportModule.writeList(r)),o[oe[this.owner.sfdtExportModule.keywordIndex]]=[],(0,a.isNullOrUndefined)(r)||o[oe[this.owner.sfdtExportModule.keywordIndex]].push(this.owner.sfdtExportModule.writeAbstractList(r.abstractList)),"RestartNumbering"==e&&(o[ht[this.owner.sfdtExportModule.keywordIndex]]=i,o[ds]=n)),t.listData=JSON.stringify(o)}},e.prototype.createCharacterFormat=function(e){var t={};if("Uppercase"===e)t.Uppercase=!0;else if("Lowercase"===e)t.Lowercase=!0;else if("SentenceCase"===e)t.SentenceCase=!0;else if("ToggleCase"===e)t.ToggleCase=!0;else if("CapitalizeEachWord"===e)t.CapitalizeEachWord=!0;else if("ApplyStyle"===e||"StyleName"===e)(0,a.isNullOrUndefined)(this.insertedFormat)?t.styleName=null:t.styleName=this.insertedFormat;else if("CharacterFormat"===e){var i=this.insertedFormat;t.bold=i.hasValue("bold")?i.bold:t.bold,t.italic=i.hasValue("italic")?i.italic:t.italic,t.fontSize=i.hasValue("fontSize")?i.fontSize:t.fontSize,t.underline=i.hasValue("underline")?i.underline:t.underline,t.strikethrough=i.hasValue("strikethrough")?i.strikethrough:t.strikethrough,t.baselineAlignment=i.hasValue("baselineAlignment")?i.baselineAlignment:t.baselineAlignment,t.highlightColor=i.hasValue("highlightColor")?i.highlightColor:t.highlightColor,t.fontColor=i.hasValue("fontColor")?i.fontColor:t.fontColor,t.fontFamily=i.hasValue("fontFamily")?i.fontFamily:t.fontFamily,t.allCaps=i.hasValue("allCaps")?i.allCaps:t.allCaps,t.LowerCase=i.hasValue("Lowercase")?i.Lowercase:t.Lowercase,t.Uppercase=i.hasValue("Uppercase")?i.Lowercase:t.Uppercase,t.CapitalizeEachWord=i.hasValue("CapitalizeEachWord")?i.CapitalizeEachWord:t.CapitalizeEachWord,t.SentenceCase=i.hasValue("SentenceCase")?i.SentenceCase:t.SentenceCase,t.ToggleCase=i.hasValue("ToggleCase")?i.ToggleCase:t.ToggleCase}else if("increment"===this.insertedFormat||"decrement"===this.insertedFormat)this.type=this.insertedFormat,t.fontSize=0;else if("ClearFormat"!==e){var n=e.toString().charAt(0).toLowerCase()+e.toString().slice(1);this.insertedFormat instanceof ka&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.insertedFormat=this.insertedFormat[n]),t[n]=this.insertedFormat}this.format=JSON.stringify(t)},e.prototype.createParagraphFormat=function(e){var t={};if("ParagraphFormat"===e||"ContinueNumbering"===e){var i=this.insertedFormat;if(t.afterSpacing=i.hasValue("afterSpacing")?i.afterSpacing:t.afterSpacing,t.beforeSpacing=i.hasValue("beforeSpacing")?i.beforeSpacing:t.beforeSpacing,t.spaceAfterAuto=i.hasValue("spaceAfterAuto")?i.spaceAfterAuto:t.spaceAfterAuto,t.spaceBeforeAuto=i.hasValue("spaceBeforeAuto")?i.spaceBeforeAuto:t.spaceBeforeAuto,t.rightIndent=i.hasValue("rightIndent")?i.rightIndent:t.rightIndent,t.leftIndent=i.hasValue("leftIndent")?i.leftIndent:t.leftIndent,t.firstLineIndent=i.hasValue("firstLineIndent")?i.firstLineIndent:t.firstLineIndent,t.lineSpacing=i.hasValue("lineSpacing")?i.lineSpacing:t.lineSpacing,t.lineSpacingType=i.hasValue("lineSpacingType")?i.lineSpacingType:t.lineSpacingType,t.textAlignment=i.hasValue("textAlignment")?i.textAlignment:t.textAlignment,t.outlineLevel=i.hasValue("outlineLevel")?i.outlineLevel:t.outlineLevel,t.bidi=i.hasValue("bidi")?i.bidi:t.bidi,t.bidi&&("Right"===t.textAlignment?t.textAlignment="Left":"Left"===t.textAlignment&&(t.textAlignment="Right")),t.borders=i.hasValue("borders")?i.borders:t.borders,-1!==i.listFormat.listId)(n={}).listId=i.listFormat.listId,n.listLevelNumber=i.listFormat.listLevelNumber,n.nsid=i.listFormat.nsid,t.listFormat=n;t.styleName=i.hasValue("styleName")?t.styleName.name:void 0,t.contextualSpacing=i.hasValue("contextualSpacing")?i.contextualSpacing:t.contextualSpacing,t.keepWithNext=i.hasValue("keepWithNext")?i.keepWithNext:t.keepWithNext,t.keepLinesTogether=i.hasValue("keepLinesTogether")?i.keepLinesTogether:t.keepLinesTogether,t.widowControl=i.hasValue("contextualSpacing")?i.widowControl:t.widowControl}else if("ListFormat"===e){var n;this.insertedFormat instanceof ba&&(this.insertedFormat=this.insertedFormat.listFormat),(n={}).listId=this.insertedFormat.listId,n.nsid=this.insertedFormat.nsid,n.listLevelNumber=this.insertedFormat.listLevelNumber,t.listFormat=n}else if("ApplyStyle"===e||"StyleName"===e)t.styleName=this.insertedFormat;else if("ParagraphBidi"===e)t.bidi=this.insertedFormat;else if("Borders"===e)t.borders=Pa.writeBorders(this.insertedFormat,0);else if(this.insertedFormat instanceof ba){i=this.owner.sfdtExportModule.writeParagraphFormat(this.insertedFormat,0);t[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=i}else"List"===e?t=this.insertedFormat:t[e.toString().charAt(0).toLowerCase()+e.toString().slice(1)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.createTableFormat=function(e){this.startIndex=this.owner.selectionModule.getPositionInfoForHeaderFooter({paragraph:null,offset:0},{position:0,done:!1},this.owner.selectionModule.start.paragraph.associatedCell.ownerTable).position,this.endIndex=this.startIndex,this.endIndex+=this.owner.selectionModule.getBlockLength(void 0,this.owner.selectionModule.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),0,{done:!1},!0,void 0,void 0)-1;var t={};if("TableFormat"===e){var i=this.insertedFormat;(0,a.isNullOrUndefined)(i)||(t.bidi=i.hasValue("bidi")?i.bidi:void 0,t.preferredWidth=i.hasValue("preferredWidth")?i.preferredWidth:void 0,t.preferredWidthType=i.hasValue("preferredWidthType")?i.preferredWidthType:void 0,t.tableAlignment=i.hasValue("tableAlignment")?i.tableAlignment:void 0,t.leftIndent=i.hasValue("leftIndent")?i.leftIndent:void 0)}else if("TableOptions"===e){var n=this.owner.selectionModule.start.paragraph.associatedCell.ownerTable.tableFormat;(0,a.isNullOrUndefined)(n)||(t.cellSpacing=n.hasValue("cellSpacing")?n.cellSpacing:void 0,t.leftMargin=n.hasValue("leftMargin")?n.leftMargin:void 0,t.topMargin=n.hasValue("topMargin")?n.topMargin:void 0,t.rightMargin=n.hasValue("rightMargin")?n.rightMargin:void 0,t.bottomMargin=n.hasValue("bottomMargin")?n.bottomMargin:void 0)}else if("BordersAndShading"===e){var r=this.insertedFormat;t=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeTableFormat(r,0)}else t[this.getTableFormatString(e)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.createRowFormat=function(e){var t={};if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.assignRowFormat(t,this.owner.selectionModule.start.paragraph.associatedCell.ownerRow.rowFormat,0);else if("RowFormat"===e){var i=this.insertedFormat;(0,a.isNullOrUndefined)(i)||(t.height=i.hasValue("height")?i.height:void 0,t.heightType=i.hasValue("heightType")?i.heightType:void 0,t.isHeader=i.hasValue("isHeader")?i.isHeader:void 0,t.allowBreakAcrossPages=i.hasValue("allowBreakAcrossPages")?i.allowBreakAcrossPages:void 0)}else t[this.getRowString(e)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.createCellFormat=function(e){var t={};if("CellFormat"===e){var i=this.insertedFormat;t.preferredWidth=i.hasValue("preferredWidth")?i.preferredWidth:void 0,t.preferredWidthType=i.hasValue("preferredWidthType")?i.preferredWidthType:void 0,t.verticalAlignment=i.hasValue("verticalAlignment")?i.verticalAlignment:void 0}else if("CellOptions"===e){var n=this.insertedFormat;t.leftMargin=n.leftMargin,t.rightMargin=n.rightMargin,t.bottomMargin=n.bottomMargin,t.topMargin=n.topMargin}else"Shading"===e?t[this.getCellString(e)]=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeShading(this.insertedFormat,0):"Borders"===e?t.borders=Pa.writeBorders(this.insertedFormat,0):"BordersAndShading"===e?(t.shading=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.writeShading(this.insertedFormat,0),t.borders=Pa.writeBorders(this.insertedFormat.borders,0)):t[this.getCellString(e)]=this.insertedFormat;this.format=JSON.stringify(t)},e.prototype.getTableFormatString=function(e){switch(e){case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellLeftMargin":return"leftMargin";case"DefaultCellRightMargin":return"rightMargin";case"DefaultCellBottomMargin":return"bottomMargin";case"DefaultCellTopMargin":return"topMargin";case"TablePreferredWidth":return"preferredWidth";case"TablePreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"TableBidi":return"bidi";default:return"cellSpacing"}},e.prototype.createSectionFormat=function(e){var t={};if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||this.owner.sfdtExportModule.writeSectionFormat(this.owner.selectionModule.start.paragraph.bodyWidget.sectionFormat,t,0);else{if("LinkToPrevious"===e){var i=this.owner.selectionModule.start.paragraph.bodyWidget,n=i.sectionIndex,r=i.headerFooterType;return void(this.format=JSON.stringify({linkToPrevious:this.insertedFormat,sectionIndex:n,headerFooterType:r}))}if("SectionFormat"===e){var o=this.insertedFormat;this.owner.sfdtExportModule.writeSectionFormat(o,t,0)}else t[e[0].toLowerCase()+e.slice(1)]=this.insertedFormat}this.format=JSON.stringify(t)},e.prototype.getRowString=function(e){switch(e){case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";default:return"allowBreakAcrossPages"}},e.prototype.getCellString=function(e){switch(e){case"CellContentVerticalAlignment":return"verticalAlignment";case"CellLeftMargin":return"leftMargin";case"CellRightMargin":return"rightMargin";case"CellBottomMargin":return"bottomMargin";case"CellTopMargin":return"topMargin";case"CellPreferredWidth":return"preferredWidth";case"Shading":return"shading";default:return"preferredWidthType"}},e}(),bc=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Cc=function(e){function t(t,i){var n=e.call(this,t)||this;return n.isChildHistoryInfo=!1,n.editRangeStart=void 0,n.documentHelper=t.documentHelper,n.isChildHistoryInfo=i,n}return bc(t,e),Object.defineProperty(t.prototype,"hasAction",{get:function(){return!(0,a.isNullOrUndefined)(this.modifiedActions)},enumerable:!0,configurable:!0}),t.prototype.addModifiedAction=function(e){this.editorHistory.isUndoing||this.editorHistory.isRedoing||((0,a.isNullOrUndefined)(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(e))},t.prototype.getActionInfo=function(e){var i=this.action,n=[];switch(i){case"Insert":for(var r=0;r<this.modifiedActions.length;r++){var s=this.modifiedActions[parseInt(r.toString(),10)];n.push(s.getInsertOperation(s.action))}break;case"InsertContentControl":for(r=0;r<this.modifiedActions.length;r++){s=this.modifiedActions[parseInt(r.toString(),10)];n.push(s.getInsertOperation(s.action))}break;case"InsertBookmark":case"RestrictEditing":if(this.editorHistory.isUndoing)for(r=0;r<this.modifiedActions.length;r++)"RestrictEditing"===i&&this.modifiedActions[parseInt(r.toString(),10)].markerData.push(this.owner.editorModule.getMarkerData(this.modifiedActions[parseInt(r.toString(),10)].removedNodes[0])),n.push(this.modifiedActions[parseInt(r.toString(),10)].getDeleteOperation("DeleteBookmark",0===r||void 0)),this.modifiedActions[parseInt(r.toString(),10)].markerData.shift();else for(r=0;r<this.modifiedActions.length;r++){"DeleteBookmark"!==(s=this.modifiedActions[parseInt(r.toString(),10)]).action?n.push(s.getInsertOperation(i)):(n.push(s.getDeleteOperation("DeleteBookmark")),n.push(s.getDeleteOperation("DeleteBookmark",!0)))}break;case"BackSpace":case"Delete":case"RemoveEditRange":if(this.editorHistory.isUndoing){for(r=0;r<this.modifiedActions.length;r++){if("InsertInline"===(s=this.modifiedActions[parseInt(r.toString(),10)]).action){var l=s.getDeleteOperation("DeleteBookmark",!0);n.push(l)}else{var d=s.getActionInfo();n=n.concat(d),"RemoveEditRange"===s.action&&n.push(s.getDeleteOperation(i,!0))}}n.reverse()}else for(r=0;r<this.modifiedActions.length;r++){if("InsertInline"===(s=this.modifiedActions[parseInt(r.toString(),10)]).action){l=s.getInsertOperation("InsertBookmark");n.push(l)}else n.push(s.getDeleteOperation(i)),"RemoveEditRange"===s.action&&n.push(s.getDeleteOperation(i,!0))}break;case"PageBreak":case"ColumnBreak":if(this.owner.enableTrackChanges)for(r=0;r<this.modifiedActions.length;r++){(s=this.modifiedActions[parseInt(r.toString(),10)]).removedNodes.length>0&&(n=n.concat(s.getDeleteOperationsForTrackChanges()));var h=s.markerData[s.markerData.length-1],c=(l=s.getInsertOperation("Enter"),this.getInsertOperation(i));l.markerData=h,c.markerData=this.owner.editorModule.getMarkerData(void 0,void 0,this.owner.editorModule.getRevision(h.revisionId)),n.push(l),n.push(c),n.push(l),l.markerData.skipOperation=!0}else if(this.editorHistory.isUndoing)for(r=0;r<this.modifiedActions.length;r++){if((s=this.modifiedActions[parseInt(r.toString(),10)]).endIndex=s.startIndex,n.push(s.getDeleteOperation("Delete")),n.push(s.getDeleteOperation("Delete")),n.push(s.getDeleteOperation("Delete")),s.isRemovedNodes){d=s.getDeleteContent("BackSpace");n=n.concat(d)}}else{for(r=0;r<this.modifiedActions.length;r++){(s=this.modifiedActions[parseInt(r.toString(),10)]).removedNodes.length>0&&n.push(s.getDeleteOperation(i))}(l=this.getInsertOperation("Enter")).markerData={skipOperation:!0},n.push(l),n.push(l),n.push(this.getInsertOperation(i)),n.push(l)}break;case"InsertHyperlink":case"AutoFormatHyperlink":case"RemoveHyperlink":if(this.editorHistory.isUndoing&&"RemoveHyperlink"===i){var p=0;for(r=0;r<this.modifiedActions.length;r++){"FontColor"!==(s=this.modifiedActions[parseInt(r.toString(),10)]).action&&"Underline"!==s.action||(p=s.endIndex-s.startIndex)}if(!(0,a.isNullOrUndefined)(this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].fieldBegin)){this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].endIndex=this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].startIndex+p,(l=this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].getDeleteOperation("Delete")).markerData=void 0,n.push(l);d=this.modifiedActions[parseInt((this.modifiedActions.length-1).toString(),10)].getFieldOperation();n=n.concat(d)}}else{for(r=0;r<this.modifiedActions.length;r++){"InsertHyperlink"===(s=this.modifiedActions[parseInt(r.toString(),10)]).action?n.push.apply(n,s.getActionInfo()):"InsertInline"===s.action?s.insertedText===o.Marker_Start||s.insertedText===o.Marker_End?this.editorHistory.isUndoing?n.push(s.getDeleteOperation(s.action)):n.push(s.getInsertOperation("InsertHyperlink")):this.editorHistory.isUndoing?n.push(s.getDeleteOperation(s.action)):n.push(s.getInsertOperation("Insert")):"Delete"===s.action?n.push(s.getDeleteOperation(s.action)):("Underline"===s.action||"FontColor"===s.action)&&(n=n.concat(s.getActionInfo()))}this.editorHistory.isUndoing&&n.reverse()}break;case"InsertComment":if(this.editorHistory.isUndoing)this.getDeleteCommentOperation(this.modifiedActions,n);else for(r=0;r<this.modifiedActions.length;r++){l=(s=this.modifiedActions[parseInt(r.toString(),10)]).getInsertOperation(s.action);s.insertedElement instanceof Bd&&"InsertInline"===s.action?n.push(s.getCommentOperation(l,s.action)):"InsertCommentWidget"===s.action&&(l=this.getUpdateOperation(),n.push(s.getCommentOperation(l,s.action)))}break;case"RemoveComment":if(this.editorHistory.isUndoing)for(r=this.modifiedActions.length-1;r>=0;r--){l=void 0,d=[];"InsertInline"===(s=this.modifiedActions[parseInt(r.toString(),10)]).action&&s.insertedElement instanceof Bd?(l=s.getDeleteOperation(s.action),d.push(s.getCommentOperation(l,"InsertInline"))):"RemoveInline"===s.action?(l=s.getDeleteOperation(s.action),d.push(s.getCommentOperation(l,"InsertInline")),l=s.getInsertOperation(s.action),d.push(s.getCommentOperation(l,"InsertInline"))):"DeleteComment"===s.action?d=s.getActionInfo():(this.owner.sfdtExportModule.iscontentInsert=!1,d=s.getActionInfo(),this.owner.sfdtExportModule.iscontentInsert=!0),n=n.concat(d)}else for(r=0;r<this.modifiedActions.length;r++){l=void 0,d=[];"RemoveInline"===(s=this.modifiedActions[parseInt(r.toString(),10)]).action&&s.removedNodes[0]instanceof Bd?(l=s.getDeleteOperation(s.action),d.push(s.getCommentOperation(l,s.action))):"InsertInline"===s.action&&s.insertedElement instanceof Bd?(l=s.getInsertOperation(s.action),d.push(s.getCommentOperation(l,s.action))):d=s.getActionInfo(),n=n.concat(d)}break;case"DeleteComment":if(this.editorHistory.isUndoing)for(var u=this.modifiedActions.length-1;u>=0;u--){var g=this.modifiedActions[parseInt(u.toString(),10)];l=g.getInsertOperation(g.action);g.insertedElement instanceof Bd&&"RemoveInline"===g.action?n.push(g.getCommentOperation(l,"InsertInline")):"DeleteCommentWidget"===g.action?(l=this.getUpdateOperation(),n.push(g.getCommentOperation(l,"InsertCommentWidget"))):"DeleteComment"===g.action&&g.getActionInfo()}else this.getDeleteCommentOperation(this.modifiedActions,n);break;case"FormField":n=(s=this.modifiedActions.pop()).getFieldOperation();break;case"IMEInput":if(!e||this.editorHistory.isUndoing||this.editorHistory.isRedoing){s=this.modifiedActions[this.modifiedActions.length-1];if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)for(r=0;r<this.modifiedActions.length;r++){if((s=this.modifiedActions[parseInt(r.toString(),10)]).removedNodes.length>0&&n.push(s.getDeleteOperation(i)),s.isRemovedNodes){d=s.getDeleteContent("BackSpace");n=n.concat(d)}s.isRemovedNodes=!1}else s.removedNodes.length>0&&n.push(s.getDeleteOperation(i)),n.push(s.getInsertOperation(this.action));s.isRemovedNodes=!1}else{if(this.modifiedActions[0].removedNodes.length>0){var m=this.modifiedActions[0].getDeleteOperation("Delete");m.length=m.text.length,n.push(m)}var f=this.modifiedActions[this.modifiedActions.length-1].getInsertOperation("Insert");f.length=f.text.length,n.push(f),n.reverse();for(var r=0;r<n.length;r++){"Insert"===(l=n[parseInt(r.toString(),10)]).action?l.action="Delete":"Delete"===l.action&&(l.action="Insert")}}break;case"Accept All":case"ReplaceAll":case"Reject All":if(this.editorHistory.isUndoing)for(r=this.modifiedActions.length-1;r>=0;r--){s=this.modifiedActions[parseInt(r.toString(),10)];if(!(0,a.isNullOrUndefined)(s.cellOperation)&&s.cellOperation.length>0)n.push(s.cellOperation[0]),s.cellOperation=[];else{var v=s.getActionInfo();n.push.apply(n,v)}}else for(r=0;r<this.modifiedActions.length;r++){s=this.modifiedActions[parseInt(r.toString(),10)];if(!(0,a.isNullOrUndefined)(s.cellOperation)&&s.cellOperation.length>0)n.push(s.cellOperation[0]),s.cellOperation=[];else{v=s.getActionInfo();n.push.apply(n,v)}}break;case"Paste":for(r=0;r<this.modifiedActions.length;r++){(s=this.modifiedActions[parseInt(r.toString(),10)]).type="PasteToc"===this.type?this.type:"Paste";var y=s.getActionInfo();n.push.apply(n,y)}break;case"TOC":if(this.modifiedActions)if(this.editorHistory.isUndoing)for(r=this.modifiedActions.length-1;r>=0;r--){(s=this.modifiedActions[parseInt(r.toString(),10)]).type="Paste"===s.action?"PasteToc":void 0;var w=s.getActionInfo();n.push.apply(n,w)}else for(r=0;r<this.modifiedActions.length;r++){(s=this.modifiedActions[parseInt(r.toString(),10)]).type="Paste"===s.action?"PasteToc":void 0;w=s.getActionInfo();n.push.apply(n,w)}break;case"DragAndDropContent":for(r=0;r<this.modifiedActions.length;r++){(s=this.modifiedActions[parseInt(r.toString(),10)]).type="Paste"===s.action?"Paste":void 0;var b=s.getActionInfo();n.push.apply(n,b)}break;case"ClearFormat":if(this.editorHistory.isUndoing)for(r=0;r<this.modifiedActions.length;r++)n.push.apply(n,this.modifiedActions[parseInt(r.toString(),10)].modifiedFormatOperation),this.modifiedActions[parseInt(r.toString(),10)].modifiedFormatOperation=[];else n=this.modifiedActions[this.modifiedActions.length-1].buildFormatOperation("ClearFormat",!0).slice();break;case"ApplyStyle":var C=[];if(this.modifiedActions[0]instanceof t)n=(C=this.modifiedActions[0].modifiedActions[0].buildFormatOperation("ClearFormat",!0)).slice();if(!(this.modifiedActions[this.modifiedActions.length-1]instanceof t)){C=this.modifiedActions[this.modifiedActions.length-1].buildFormatOperation(i,!0);for(r=0;r<C.length;r++)n.push(C[parseInt(r.toString(),10)])}break;case"TableMarginsSelection":this.modifiedActions[this.modifiedActions.length-1].createTableFormat(this.modifiedActions[this.modifiedActions.length-1].action),this.modifiedActions[this.modifiedActions.length-1].type="TableFormat",n.push(this.modifiedActions[this.modifiedActions.length-1].getFormatOperation());break;case"BordersAndShading":"TableFormat"===this.modifiedActions[0].action?(this.modifiedActions[0].type="TableFormat",this.modifiedActions[0].createTableFormat("BordersAndShading"),n.push(this.modifiedActions[0].getFormatOperation())):(this.modifiedActions[0].createCellFormat("BordersAndShading"),this.modifiedActions[0].type="CellFormat",n=this.modifiedActions[0].getSelectedCellOperation("BordersAndShading",void 0,!0,!0,!0));break;case"AutoList":for(r=0;r<this.modifiedActions.length;r++){var x=(s=this.modifiedActions[parseInt(r.toString(),10)]).getActionInfo();n.push.apply(n,x)}break;case"TableProperties":for(r=0;r<this.modifiedActions.length;r++){var I=this.modifiedActions[parseInt(r.toString(),10)];if("TableFormat"===I.action)I.createTableFormat(I.action),I.type="TableFormat",n.push(I.getFormatOperation());else if("RowFormat"===I.action)this.editorHistory.isUndoing||this.editorHistory.isRedoing&&I.modifiedProperties.length>1?(n=I.modifiedFormatOperation,I.modifiedFormatOperation=[]):(I.createRowFormat(I.action),I.type="RowFormat",n.push(I.getFormatOperation()));else if("CellFormat"===I.action){I.createCellFormat(I.action),I.type="CellFormat";for(var k=I.getSelectedCellOperation(I.action,!1,!1,!1,!0),F=0;F<k.length;F++)n.push(k[parseInt(F.toString(),10)])}}break;case"CellMarginsSelection":this.modifiedActions[this.modifiedActions.length-1].createCellFormat("CellOptions"),this.modifiedActions[this.modifiedActions.length-1].type="CellFormat",n=this.modifiedActions[this.modifiedActions.length-1].getSelectedCellOperation("CellOptions",!1,!1,!1,!0).slice()}return n},t.prototype.revert=function(){if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!(0,a.isNullOrUndefined)(this.modifiedActions))if(this.editorHistory.isUndoing)for(var e=this.modifiedActions.length;e>0;){this.modifiedActions[e-1].revert(),e-=1}else for(e=0;e<this.modifiedActions.length;){this.modifiedActions[parseInt(e.toString(),10)].revert(),e+=1}if("RestrictEditing"===this.action){var t=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group;if(this.editorHistory.isUndoing){var i=this.owner.documentHelper.editRanges.get(t).indexOf(this.editRangeStart);-1!==i&&this.owner.documentHelper.editRanges.get(t).splice(i,1)}else this.owner.editorModule.updateRangeCollection(this.editRangeStart,t);this.owner.selectionModule.updateEditRangeCollection()}this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},t.prototype.destroy=function(){if(!(0,a.isNullOrUndefined)(this.modifiedActions)){for(;this.modifiedActions.length>0;){var t=this.modifiedActions[this.modifiedActions.length-1];t.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(t),1)}this.modifiedActions=void 0}e.prototype.destroy.call(this)},t}(wc),xc=function(){function e(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoGroupingEnded=!0,this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.documentHelper=e.documentHelper,this.modifiedParaFormats=new l,this.undoLimitIn=500,this.redoLimitIn=500}return Object.defineProperty(e.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&this.historyInfoStack.length>0?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof Cc?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoLimit",{get:function(){return(0,a.isNullOrUndefined)(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoLimit",{get:function(){return(0,a.isNullOrUndefined)(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"EditorHistory"},e.prototype.canUndo=function(){return!(0,a.isNullOrUndefined)(this.undoStack)&&this.undoStack.length>0},e.prototype.canRedo=function(){return!(0,a.isNullOrUndefined)(this.redoStack)&&this.redoStack.length>0},e.prototype.initializeHistory=function(e){(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.destroy(),this.currentBaseHistoryInfo=new wc(this.owner),this.currentBaseHistoryInfo.action=e,"ModifyStyle"!==e&&this.currentBaseHistoryInfo.updateSelection(),!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.isEmpty&&("BackSpace"===e||"Delete"===e||"Insert"===e&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.editor)&&this.documentHelper.owner.editor.handledTextInput)&&(this.currentBaseHistoryInfo.isEmptySelection=!0)},e.prototype.initComplexHistory=function(e,t){switch(this.currentHistoryInfo=new Cc(e.owner,!(0,a.isNullOrUndefined)(this.currentHistoryInfo)),this.currentHistoryInfo.action=t,t){case"PageBreak":this.currentHistoryInfo.insertedText=o.PageBreak,this.currentHistoryInfo.insertPosition=e.startOffset;break;case"ColumnBreak":this.currentHistoryInfo.insertedText=o.ColumnBreak,this.currentHistoryInfo.insertPosition=e.startOffset}this.currentHistoryInfo.updateSelection()},e.prototype.initResizingHistory=function(e,t){if(1===t.resizeNode)this.initializeHistory("RowResizing"),(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)||(t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer),this.currentBaseHistoryInfo.modifiedProperties.push(new uc(t.currentResizingTable,e,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat,this.owner)),this.documentHelper.layout.reLayoutTable(t.currentResizingTable));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer);var i=new gc(t.currentResizingTable,this.owner);i.startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(i),this.documentHelper.layout.reLayoutTable(t.currentResizingTable)}},e.prototype.beginUndoAction=function(){this.isUndoGroupingEnded&&(this.owner.editorModule.initComplexHistory("Grouping"),this.isUndoGroupingEnded=!1,this.clearRedoStack())},e.prototype.endUndoAction=function(){this.isUndoGroupingEnded||(this.updateComplexHistory(),this.isUndoGroupingEnded=!0)},e.prototype.updateResizingHistory=function(e,t){if(1===t.resizeNode){if(!(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)){var i=this.currentBaseHistoryInfo.modifiedProperties[0];i.startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(i.displacement=Pa.convertPixelToPoint(e.y-i.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.owner.fireContentChange(),this.currentBaseHistoryInfo=void 0)}}else if(!(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)){var n=this.currentBaseHistoryInfo.modifiedProperties[0];n.startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(n.displacement=Pa.convertPixelToPoint(e.x-n.startingPoint.x),n.endIndex=t.getCellReSizerPosition(e),this.owner.editorHistoryModule.recordChanges(this.currentBaseHistoryInfo),this.owner.fireContentChange(),this.currentBaseHistoryInfo=void 0)}},e.prototype.recordChanges=function(e){if(this.owner.enableHistoryMode){if(this.isUndoing){if((0,a.isNullOrUndefined)(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0){var t=this.undoLimit>20?10:1;this.redoStackIn.splice(0,t)}this.redoStack.length<this.redoLimit&&this.redoStack.push(e)}else{if(this.isRedoing||this.clearRedoStack(),(0,a.isNullOrUndefined)(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0){t=this.undoLimit>20?10:1;this.undoStackIn.splice(0,t)}this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)}this.lastOperation=e}},e.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)&&(!(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)&&(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),(0,a.isNullOrUndefined)(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},e.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(this.owner.editorModule.removedBookmarkElements.length>0&&this.owner.editorModule.insertRemoveBookMarkElements(e)&&(e=!0),this.owner.editorModule.removedEditRangeEndElements.length>0&&this.owner.editorModule.insertRemovedEditRangeEndElements(e)&&(e=!0),this.owner.editorModule.removedEditRangeStartElements.length>0&&this.owner.editorModule.insertRemovedEditRangeStartElements(e)&&(e=!0),this.owner.editorModule.removedContentControlElements.length>0&&this.owner.editorModule.insertRemoveContentControlElements(e)&&(e=!0)),this.documentHelper.owner.enableHistoryMode&&!(0,a.isNullOrUndefined)(this.currentHistoryInfo)?"Grouping"!==this.currentHistoryInfo.action&&(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},e.prototype.updateComplexHistory=function(){var e=this.documentHelper.selection;if(!(0,a.isNullOrUndefined)(this.currentHistoryInfo)&&this.currentHistoryInfo.hasAction){if("AutoFormatHyperlink"!==this.currentHistoryInfo.action&&"SkipCommentInline"!==this.currentHistoryInfo.action&&"DeleteCommentInline"!==this.currentHistoryInfo.action&&"RemoveComment"!==this.currentHistoryInfo.action||(e.owner.editorHistoryModule.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.endPosition))),"InsertHyperlink"===this.currentHistoryInfo.action){var t=new ac(e.owner);if(!(0,a.isNullOrUndefined)(this.currentHistoryInfo.insertPosition)){this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition);var i=new ac(e.owner);this.owner.editorModule.setPositionForCurrentIndex(i,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0),i.paragraph!==t.paragraph&&this.documentHelper.layout.reLayoutParagraph(i.paragraph,0,0)}}"ReplaceAll"===this.currentHistoryInfo.action?(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument()):e.owner.isShiftingEnabled&&((0,a.isNullOrUndefined)(e.editRegionHighlighters)||e.editRegionHighlighters.clear(),this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages())}this.owner.showRevisions&&!this.owner.editorModule.restrictLayout&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,(0,a.isNullOrUndefined)(this.currentHistoryInfo)||"ApplyStyle"!==this.currentHistoryInfo.action?(e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):e.end.updatePhysicalPosition(!0)):this.owner.editorModule.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,this.documentHelper.isScrollHandler=!0,this.owner.editorModule.restrictLayout||this.viewer.updateScrollBars(),e.fireSelectionChanged(!0),this.documentHelper.isScrollHandler=!1,this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.isInsertingTOC||this.owner.editorModule.fireContentChange()},e.prototype.updateComplexHistoryInternal=function(){if(!(0,a.isNullOrUndefined)(this.currentHistoryInfo)){if((0,a.isNullOrUndefined)(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1)this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo);else this.recordChanges(this.currentHistoryInfo);this.currentHistoryInfo=void 0}},e.prototype.updateListChangesInHistory=function(e,t){this.currentBaseHistoryInfo=new wc(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var i=new l,n=0;n<e.levels.length;n++){var r=this.documentHelper.getAbstractListById(t.abstractListId).levels[parseInt(n.toString(),10)];this.currentBaseHistoryInfo.addModifiedPropertiesForList(r);var o=new cc(r,e.levels[parseInt(n.toString(),10)]);(0,a.isNullOrUndefined)(r)||this.documentHelper.owner.editorModule.copyListLevel(r,e.levels[parseInt(n.toString(),10)]),i.add(n,o)}return i},e.prototype.applyListChanges=function(e,t){(0,a.isNullOrUndefined)(this.modifiedParaFormats)&&(this.modifiedParaFormats=new l);for(var i=[],n=0;n<this.documentHelper.listParagraphs.length;n++){var r=this.documentHelper.listParagraphs[parseInt(n.toString(),10)].paragraphFormat,o=this.documentHelper.getListById(r.listFormat.listId),s=this.documentHelper.layout.getListLevel(o,r.listFormat.listLevelNumber);if(t.containsKey(r.listFormat.listLevelNumber)&&t.get(r.listFormat.listLevelNumber).ownerListLevel===s){var d=new ba(null);d.leftIndent=r.leftIndent,d.firstLineIndent=r.firstLineIndent;var h=new pc(r,d);i.push(h),this.owner.editorModule.copyFromListLevelParagraphFormat(r,s.paragraphFormat)}}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,i)},e.prototype.updateListChanges=function(e){this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var t=0;t<e.keys.length;t++){var i=e.keys[parseInt(t.toString(),10)],n=e.get(i);(0,a.isNullOrUndefined)(this.currentBaseHistoryInfo)||(n=this.currentBaseHistoryInfo.addModifiedPropertiesForList(n.ownerListLevel)),this.owner.editorModule.copyListLevel(n.ownerListLevel,n.modifiedListLevel)}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.owner.editorModule.layoutWholeDocument();var r=this.documentHelper.selection;r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!1),this.updateHistory()},e.prototype.undo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode){var e=this.undoStack.pop();this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selectionModule.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.redo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode){var e=this.redoStack.pop();"BordersAndShading"===e.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selectionModule.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},e.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},e.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var e=this.undoStack.pop();e.destroy(),e=void 0}},e.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var e=this.redoStack.pop();e.destroy(),e=void 0}},e}(),Ic=function(){function e(e){this.resizeNode=0,this.resizerPosition=-1,this.currentResizingTable=void 0,this.isResizerEnabled=!1,this.owner=e,this.documentHelper=this.owner.documentHelper,this.startingPoint=new Sa(0,0)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableResizer"},e.prototype.updateResizingHistory=function(e){this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateResizingHistory(e,this),this.documentHelper.isRowOrCellResizing=!1,this.resizerPosition=-1},e.prototype.handleResize=function(e){this.owner.documentHelper.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistoryModule.initResizingHistory(e,this)},e.prototype.isInRowResizerArea=function(e){var t=this.getRowReSizerPosition(void 0,e);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},e.prototype.isInCellResizerArea=function(e){var t=this.getCellReSizerPosition(e);return-1===t?(this.isResizerEnabled=!1,!1):(this.resizeNode=0,this.isResizerEnabled=!0,this.resizerPosition=t,!0)},e.prototype.getCellReSizerPosition=function(e){var t=-1,i=this.getTableWidget(e),n=this.getTableCellWidget(e),r=(0,a.isNullOrUndefined)(i)?0:i.tableFormat.cellSpacing;if(i&&r>0){if(this.currentResizingTable=i,this.documentHelper.isInsideRect(i.x-Pa.convertPointToPixel(i.leftBorderWidth)-.25,i.y,Pa.convertPointToPixel(i.leftBorderWidth)+.5,i.height,e))return 0;for(var o=i.x,s=0;s<i.tableHolder.columns.length;s++){var l=Pa.convertPointToPixel(i.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,i.y,i.leftBorderWidth+2,i.height,e))return s>0?s:0;if(s>0&&this.documentHelper.isInsideRect(o+l-1,i.y,2,i.height,e))return s+1;o+=l}}else if(!(0,a.isNullOrUndefined)(n)){if(this.currentResizingTable=n.ownerTable,this.documentHelper.isInsideRect(n.x-n.margin.left-1,n.y-n.margin.top,2,n.height+n.margin.top+n.margin.bottom,e))return n.columnIndex;if((0,a.isNullOrUndefined)(n.nextRenderedWidget)&&this.documentHelper.isInsideRect(n.x+n.margin.right+n.width-1,n.y-n.margin.top,2,n.height+n.margin.top+n.margin.bottom,e))return n.columnIndex+n.cellFormat.columnSpan;if(n.childWidgets.length>0)return this.getCellReSizerPositionInternal(n,e)}return t},e.prototype.getCellReSizerPositionInternal=function(e,t){var i=-1,n=this.getTableWidgetFromWidget(t,e),r=void 0;if(!(0,a.isNullOrUndefined)(n)&&n.tableFormat.cellSpacing>0){if(this.currentResizingTable=n,this.documentHelper.isInsideRect(n.x-n.leftBorderWidth-.25,n.y,n.leftBorderWidth+.5,n.height,t))return 0;for(var o=n.x,s=0;s<n.tableHolder.columns.length;s++){var l=Pa.convertPointToPixel(n.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,n.y,n.leftBorderWidth+2,n.height,t))return s>0?s:0;if(s>0&&this.documentHelper.isInsideRect(o+l-1,n.y,2,n.height,t))return s+1;o+=l}}else if((0,a.isNullOrUndefined)(n)||(r=n.getTableCellWidget(t)),(0,a.isNullOrUndefined)(r))this.isResizerEnabled&&0===this.owner.selection.getSelectedCells().length&&this.owner.documentHelper.isMouseDown&&(i=this.resizerPosition);else{if(this.currentResizingTable=r.ownerTable,this.documentHelper.isInsideRect(r.x-r.margin.left-1,r.y-r.margin.top,2,r.height,t))return r.columnIndex;if((0,a.isNullOrUndefined)(r.nextRenderedWidget)&&this.documentHelper.isInsideRect(r.x+r.margin.right+r.width-1,r.y-r.margin.top,2,r.height,t))return r.columnIndex+r.cellFormat.columnSpan;if(r.childWidgets.length>0)return this.getCellReSizerPositionInternal(r,t)}return i},e.prototype.getRowReSizerPosition=function(e,t){var i=void 0,n=void 0;(0,a.isNullOrUndefined)(e)?(i=this.getTableWidget(t),n=this.getTableCellWidget(t)):i=this.getTableWidgetFromWidget(t,e);var r=(0,a.isNullOrUndefined)(i)?0:i.tableFormat.cellSpacing;if(i&&r>0){if(this.currentResizingTable=i,this.owner.documentHelper.isInsideRect(i.x,i.y+i.height-r,this.getActualWidth(i.lastChild),(0,a.isNullOrUndefined)(i.nextSplitWidget)?i.bottomBorderWidth+r:0,t))return i.lastChild.rowIndex;for(var o=0;o<i.childWidgets.length;o++){var s=i.childWidgets[parseInt(o.toString(),10)];if(i.childWidgets.indexOf(s)>-1&&this.owner.documentHelper.isInsideRect(s.x,s.y+s.height+r/2,this.getActualWidth(s),r/2,t))return s.rowIndex}}else if(i&&n&&(n=this.getTableCellWidget(t)),n){var l=0;if(l=(s=n.containerWidget).rowIndex===s.ownerTable.childWidgets.length-1?s.bottomBorderWidth+2:s.nextRenderedWidget.topBorderWidth+2,this.owner.documentHelper.isInsideRect(s.x,s.y+s.height-l,s.width,2*l,t))return this.currentResizingTable=s.ownerTable,s.rowIndex;if(n.childWidgets.length>0)return this.getRowReSizerPosition(n,t)}return-1},e.prototype.handleResizing=function(e,t,i){this.owner.isShiftingEnabled=!0,t?0===this.resizeNode&&this.resizeTableCellColumn(i):0===this.resizeNode?(i=e.x-this.startingPoint.x,this.resizeTableCellColumn(i)):(i=e.y-this.startingPoint.y,this.resizeTableRow(i))},e.prototype.resizeTableRow=function(e){var t=this.currentResizingTable;if(!(0,a.isNullOrUndefined)(t)&&0!==e&&-1!==this.resizerPosition){var i=this.owner.selectionModule;t.isInsideTable&&(this.owner.isLayoutEnabled=!1);var n=void 0;if(this.resizerPosition>-1&&((n=t.childWidgets[this.resizerPosition])&&this.updateRowHeight(n,e),i.selectPosition(i.start,i.end)),t.isInsideTable){var r=this.owner.documentHelper.layout.getParentTable(t);this.owner.isLayoutEnabled=!0,t=r}this.startingPoint.y+=Pa.convertPointToPixel(e),this.owner.documentHelper.layout.reLayoutTable(t),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.reLayout(this.owner.selectionModule),this.owner.editorModule.isSkipOperationsBuild=!1,n&&this.getRowReSizerPosition(void 0,this.startingPoint),!this.currentResizingTable||void 0!==this.currentResizingTable.childWidgets&&void 0!==this.currentResizingTable.childWidgets[this.resizerPosition]||(this.resizerPosition=-1)}},e.prototype.getTableWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!(0,a.isNullOrUndefined)(i))for(var n=0;n<i.bodyWidgets.length;n++){var r=i.bodyWidgets[parseInt(n.toString(),10)];if(t=this.getTableWidgetFromWidget(e,r),!(0,a.isNullOrUndefined)(t))break;if("Pages"===this.documentHelper.owner.layoutType){var o=i.headerWidget;if(t=this.getTableWidgetFromWidget(e,o),!(0,a.isNullOrUndefined)(t))break;var s=i.footerWidget;if(t=this.getTableWidgetFromWidget(e,s),!(0,a.isNullOrUndefined)(t))break}}return t},e.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[parseInt(i.toString(),10)]instanceof Al){var n=t.childWidgets[parseInt(i.toString(),10)],r=0;if(n.wrapTextAround&&(r=n.getTableCellWidth()),!n.wrapTextAround&&n.y<=e.y&&n.y+n.height>=e.y)return n;if(n.wrapTextAround&&n.x<=e.x&&n.x+r>=e.x&&n.y<=e.y&&n.y+n.height>=e.y)return n}},e.prototype.getTableCellWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!(0,a.isNullOrUndefined)(i))for(var n=0;n<i.bodyWidgets.length;n++){if(t=i.bodyWidgets[parseInt(n.toString(),10)].getTableCellWidget(e),!(0,a.isNullOrUndefined)(t))break;if("Pages"===this.documentHelper.owner.layoutType&&this.viewer.owner.enableHeaderAndFooter){if(t=i.headerWidget.getTableCellWidget(e),!(0,a.isNullOrUndefined)(t))break;if(t=i.footerWidget.getTableCellWidget(e),!(0,a.isNullOrUndefined)(t))break}}return t},e.prototype.updateRowHeight=function(e,t){var i=e.rowFormat;if("Auto"===i.heightType){i.heightType="AtLeast";var n=i.ownerBase,r=this.owner.documentHelper.layout.getRowHeight(n,[n]);r+t>=2.7&&i.height!==r+t&&(i.height=r+t)}else i.height!==i.height+t&&(i.height=i.height+t<2.7?2.7:i.height+t)},e.prototype.resizeTableCellColumn=function(e){var t=this.currentResizingTable;if(!((0,a.isNullOrUndefined)(t)||0===e||(0,a.isNullOrUndefined)(t.childWidgets)||this.resizerPosition<0)){var i=!0,n=this.owner.selectionModule;this.owner.editorModule.setOffsetValue(n),t=t.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(t);var r=t.getOwnerWidth(!0),o=t.leftIndent,s=t.tableFormat.tableAlignment;if(n.isEmpty||(i=this.resizeColumnWithSelection(n,t,e)),i){if(0===this.resizerPosition){var l=this.resizerPosition,d=t.tableHolder.columns[parseInt(l.toString(),10)],h=d.preferredWidth;if(e>0){var c=e;do{if((p=Pa.round(d.preferredWidth-e,1))>=d.minimumWidth){d.preferredWidth=p,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}c=e,e+=p-d.minimumWidth}while(e!==c)}else{c=e;do{var p;if((p=Pa.round(d.preferredWidth-e,1))<=2112){d.preferredWidth=p,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}c=e,e-=p-2112}while(e!==c)}var u=e;"Left"!==s&&t.tableHolder.getTotalWidth(0)>r&&"Auto"===t.tableFormat.preferredWidthType&&(t.tableHolder.isFitColumns(r,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType)?t.tableHolder.fitColumns(r,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType,t.tableFormat.allowAutoFit):d.preferredWidth=h,u=0),"Center"===s&&(t.tableHolder.getTotalWidth(0)<r||"Auto"!==t.tableFormat.preferredWidthType)&&(u/=2),t.tableFormat.leftIndent="Left"===s?o:0,t.tableHolder.tableWidth=t.tableHolder.getTotalWidth(0),this.updateCellPreferredWidths(t),"Auto"!==t.tableFormat.preferredWidthType&&t.updateWidth(e),this.updateGridValue(t,!0,u)}else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(t,e,r);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(t,e)}this.owner.isLayoutEnabled=!0,n.selectPosition(n.start,n.end)}else this.updateGridValue(t,!0)}},e.prototype.resizeColumnWithSelection=function(e,t,i){var n=this.getTableCellWidget(this.startingPoint);if(n&&(e.selectedWidgets.containsKey(n)||n.previousWidget&&e.selectedWidgets.containsKey(n.previousWidget))){var r=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,r);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];-1!==r.indexOf(a)&&this.increaseOrDecreaseWidth(a,i,!0)}this.updateRowsGridAfterWidth(t),t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var l=this.resizerPosition,d=(o=this.getColumnCells(t,l,!0),this.getColumnCells(t,l,!1)),h=this.isColumnSelected(t,l);if(o.length>0&&!h)for(s=0;s<o.length;s++)-1===r.indexOf(o[parseInt(s.toString(),10)])&&(o.splice(s,1),s--);if(d.length>0&&!h)for(s=0;s<d.length;s++)-1===r.indexOf(d[parseInt(s.toString(),10)])&&(d.splice(s,1),s--);if(0===o.length&&d.length>0)for(s=0;s<d.length;s++){(a=d[parseInt(s.toString(),10)]).previousWidget&&o.push(a.previousWidget)}else if(0===d.length&&o.length>0)for(s=0;s<o.length;s++){(a=o[parseInt(s.toString(),10)]).nextWidget&&d.push(a.nextWidget)}this.changeWidthOfCells(t,o,d,i),t.tableFormat.allowAutoFit&&t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},e.prototype.resizeColumnAtStart=function(e,t,i){var n=e.leftIndent,r=i[0].ownerRow,o=r.rowFormat;if(o.beforeWidth>0){var s=o.beforeWidth+t;if(s>0)this.updateGridBefore(r,t);else if(s<(l=this.getLeastGridBefore(e,r))&&0!==s){n=e.leftIndent+s,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440;for(var a=0;a<e.childWidgets.length;a++){r!==(d=e.childWidgets[parseInt(a.toString(),10)])&&this.updateGridBefore(d,-s)}}}else if(t<0)n=e.leftIndent+t,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{var l=this.getLeastGridBefore(e,r);if(0===e.tableFormat.leftIndent)for(a=0;a<e.childWidgets.length;a++){var d=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(d.childWidgets[0])&&(this.updateGridBefore(d,t),this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1))}else if(l-t>0)n=e.leftIndent+t,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440,this.updateWidthForCells(e,i,t);else{n=e.leftIndent+l,e.tableFormat.leftIndent=n>=-1440?n<=1440?n:1440:-1440;for(a=0;a<e.childWidgets.length;a++){d=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(d.childWidgets[0])?(this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1),this.updateGridBefore(d,t-l)):this.updateGridBefore(d,-l)}}}e.tableFormat.allowAutoFit=!1,this.updateGridValue(e,!0,t)},e.prototype.updateWidthForCells=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[parseInt(n.toString(),10)];-1!==t.indexOf(r.childWidgets[0])?this.increaseOrDecreaseWidth(r.childWidgets[0],i,!1):this.updateGridBefore(r,-i)}},e.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var n=e.tableFormat.tableAlignment,r=e.tableFormat.preferredWidth,o=this.resizerPosition,s=e.tableHolder.columns[o-1],a=0;t!==a;){var l=Pa.round(s.preferredWidth+t,1);l>=s.minimumWidth?(s.preferredWidth=l,a=t):(a=t,t-=l-s.minimumWidth)}this.updateCellPreferredWidths(e),(r||e.tableHolder.getTotalWidth(0)>i)&&(e.tableFormat.allowAutoFit=!1,e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0));var d=t;"Right"===n?d=0:"Center"===n&&(d/=2),this.updateGridValue(e,!0,d)},e.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,n=e.tableHolder.columns[i-1],r=e.tableHolder.columns[parseInt(i.toString(),10)];if(t>0)for(var o=!0;o;){(s=Pa.round(r.preferredWidth-t,1))>=r.minimumWidth?(r.preferredWidth=s,n.preferredWidth=n.preferredWidth+t,o=!1):t+=s-r.minimumWidth}else for(o=!0;o;){var s;(s=Pa.round(n.preferredWidth+t,1))>=n.minimumWidth?(n.preferredWidth=s,r.preferredWidth=r.preferredWidth-t,o=!1):t-=s-n.minimumWidth}this.updateCellPreferredWidths(e),e.tableFormat.allowAutoFit&&e.updateWidth(t),e.tableFormat.allowAutoFit=!1,e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0),this.updateGridValue(e,!1,t)},e.prototype.updateGridValue=function(e,t,i){if(t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable){var n=this.documentHelper.layout.getParentTable(e);this.documentHelper.layout.reLayoutTable(n)}else this.documentHelper.layout.reLayoutTable(e);this.owner.editorModule.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.owner.editorModule.reLayout(this.owner.selectionModule),this.owner.editorModule.isSkipOperationsBuild=!1,i&&(this.startingPoint.x+=Pa.convertPointToPixel(i))},e.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[parseInt(r.toString(),10)],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[parseInt(s.toString(),10)];i?a.columnIndex+a.cellFormat.columnSpan===t&&n.push(a):a.columnIndex===t&&n.push(a)}return n},e.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},e.prototype.getLeastGridBefore=function(e,t){for(var i=0,n=0,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[parseInt(r.toString(),10)];o!==t&&(0===n&&(i=o.rowFormat.beforeWidth,n++),o.rowFormat.beforeWidth<=i&&(i=o.rowFormat.beforeWidth))}return i},e.prototype.increaseOrDecreaseWidth=function(e,t,i){var n=e.cellFormat.preferredWidth;"Auto"===e.cellFormat.preferredWidthType&&(n=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point");var r=e.ownerColumn.minWidth;"Percent"===e.cellFormat.preferredWidthType&&(r=e.convertPointToPercent(r)),e.cellFormat.preferredWidth=i?n+t>r?n+t:r:n-t>r?n-t:r},e.prototype.changeWidthOfCells=function(e,t,i,n){if(t.length>0){for(var r=!1,o=0;o<t.length;o++){var s=t[parseInt(o.toString(),10)];this.increaseOrDecreaseWidth(s,n,!0),s.cellIndex===s.ownerRow.childWidgets.length-1&&(r=!0)}r&&this.updateRowsGridAfterWidth(e)}if(i.length>0){var a=0;for(o=0;o<i.length;o++){if(0===(s=i[parseInt(o.toString(),10)]).cellIndex){var l=s.ownerRow.rowFormat.beforeWidth+n;l>=0?this.updateGridBefore(s.ownerRow,n):(a!==l&&(a=l),s.ownerRow.rowFormat.gridBeforeWidth=0,s.ownerRow.rowFormat.gridBeforeWidthType="Auto")}this.increaseOrDecreaseWidth(s,n,!1)}if(0!==a){var d=e.leftIndent+a;e.tableFormat.leftIndent=d>=-1440?d<=1440?d:1440:-1440;for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[parseInt(h.toString(),10)];-1===i.indexOf(c.childWidgets[0])&&this.updateGridBefore(c,a>0?a:-a)}}}},e.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)],r=this.getRowWidth(n,!0);if(t>=r&&n.rowFormat.afterWidth!==t-r){var o=t-r;n.rowFormat.gridAfterWidth=o,n.rowFormat.afterWidth=o}}},e.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var n=0;n<e.childWidgets.length;n++){i+=e.childWidgets[parseInt(n.toString(),10)].cellFormat.cellWidth}return i},e.prototype.getMaxRowWidth=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[parseInt(n.toString(),10)],o=0;t&&(o+=r.rowFormat.beforeWidth);for(var s=0;s<r.childWidgets.length;s++){o+=r.childWidgets[parseInt(s.toString(),10)].cellFormat.cellWidth}i<o&&(i=o)}return i},e.prototype.isColumnSelected=function(e,t){for(var i=this.owner.selectionModule.getSelectedCells(),n=this.getColumnCells(e,t,!0),r=this.getColumnCells(e,t,!1),o=!1,s=0;s<n.length;s++){var a=n[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}if(!o)for(s=0;s<r.length;s++){a=r[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}return o},e.prototype.applyProperties=function(e,t){if(!(0,a.isNullOrUndefined)(t)){t.tableHolder&&(e.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(e.tableFormat.leftIndent=t.tableFormat.leftIndent,e.tableFormat.preferredWidth=t.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,e.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit);for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)],r=t.rows[parseInt(i.toString(),10)];n.rowFormat.gridBefore=r.gridBefore,n.rowFormat.gridBeforeWidth=r.gridBeforeWidth,n.rowFormat.gridBeforeWidthType=r.gridBeforeWidthType,n.rowFormat.gridAfter=r.gridAfter,n.rowFormat.gridAfterWidth=r.gridAfterWidth,n.rowFormat.gridAfterWidthType=r.gridAfterWidthType;for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[parseInt(o.toString(),10)],l=r.cells[parseInt(o.toString(),10)];s.columnIndex=l.columnIndex,s.cellFormat.columnSpan=l.columnSpan,s.cellFormat.preferredWidth=l.preferredWidth,s.cellFormat.preferredWidthType=l.preferredWidthType}}var d=e.getOwnerWidth(!0),h=e.getTableClientWidth(d);e.setWidthToCells(h,"Auto"===e.tableFormat.preferredWidthType)}},e.prototype.getActualWidth=function(e){var t=0;if(e.childWidgets.length>0)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[parseInt(i.toString(),10)].cellFormat.cellWidth;return t},e.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],n=i.rowFormat;n.gridBefore>0&&(n.gridBeforeWidth=n.beforeWidth,n.gridBeforeWidthType="Point");for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[parseInt(r.toString(),10)];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}n.gridAfter>0&&(n.gridAfterWidth=n.afterWidth,n.gridAfterWidthType="Point")}},e.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[parseInt(i.toString(),10)];if(n.rowFormat.gridBefore>0){var r=e.tableHolder.getCellWidth(0,n.rowFormat.gridBefore,t);this.updateGridBeforeWidth(r,n)}for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[parseInt(o.toString(),10)];s.updateWidth(e.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,t))}n.rowFormat.gridAfter>0&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(n.childWidgets.length,n.rowFormat.gridAfter,t),n)}},e.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;if(e!==i.beforeWidth)if(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)i.gridBeforeWidth=i.beforeWidth;else{var n=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),r=t.ownerTable.convertPointToPercent(i.beforeWidth,n);i.gridBeforeWidth=r}},e.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;if(e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)i.gridAfterWidth=i.afterWidth;else{var n=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),r=t.ownerTable.convertPointToPercent(i.afterWidth,n);i.gridAfterWidth=r}},e.prototype.destroy=function(){this.documentHelper=void 0,this.owner=void 0},e}(),kc=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i((function(t){t(e.value)})).then(s,a)}l((n=n.apply(e,t||[])).next())}))},Fc=function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Pc=function(){function e(e){var t=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.formFieldCounter=1,this.skipFieldDeleteTracking=!1,this.skipFootNoteDeleteTracking=!1,this.isForHyperlinkFormat=!1,this.isTrackingFormField=!1,this.isInsertText=!1,this.casingIndex=-1,this.checkLastLetterSpace="",this.checkLastLetterSpaceDot="",this.pasteFootNoteType="",this.isInsertingText=!1,this.keywordIndex=0,this.dictionaryObjcetIDIncreament=1,this.dictionaryObjectIndexIncrement=0,this.XMLFilesCount=1,this.XMLFilesNameSpaceCount=1,this.xmlData=[],this.dictionaryObject=[],this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1,this.handledEnter=!1,this.handledTextInput=!1,this.removeEditRange=!1,this.isRemoveRevision=!1,this.isFootNoteInsert=!1,this.isTableInsert=!1,this.isFootNote=!1,this.isHandledComplex=!1,this.isUserInsert=!1,this.tableResize=void 0,this.tocStyles={},this.triggerPageSpellCheck=!0,this.chartType=!1,this.removedBookmarkElements=[],this.removedEditRangeStartElements=[],this.removedEditRangeEndElements=[],this.removedContentControlElements=[],this.tocBookmarkId=0,this.copiedData=void 0,this.isPasteContentCheck=!1,this.pageRefFields={},this.delBlockContinue=!1,this.delBlock=void 0,this.delSection=void 0,this.isInsertingTOC=!1,this.isMeasureParaWidth=!1,this.editStartRangeCollection=[],this.skipReplace=!1,this.skipTableElements=!1,this.editRangeID=[],this.isImageInsert=!1,this.isSkipOperationsBuild=!1,this.isCellFormatApplied=!1,this.revisionData=void 0,this.splittedRevisions=[],this.isSkipComments=!1,this.isRemoteAction=!1,this.isIncrementalSave=!1,this.listNumberFormat="",this.listLevelNumber=0,this.isXmlMapped=!1,this.restrictLayout=!1,this.isAutoList=!1,this.isLastParaMarkCopied=!1,this.combineLastBlock=!1,this.remotePasteRevision=[],this.isFieldOperation=!1,this.copiedContent="",this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.pasteTextPosition=void 0,this.isPaste=!1,this.isPasteListUpdated=!1,this.isHtmlPaste=!1,this.isInsertField=!1,this.isBordersAndShadingDialog=!1,this.pasteImageIndex=void 0,this.onTextInputInternal=function(){if(a.Browser.isDevice){var e=t.documentHelper,i=new RegExp(String.fromCharCode(160),"g"),n=new RegExp(String.fromCharCode(10),"g");e.prefix=e.prefix.replace(i," ").replace(n," ");var r=(o=e.editableDiv.textContent.replace(i," ").replace(n," ")).substring(2);if(e.isCompositionStart&&e.isCompositionUpdated)return e.isCompositionUpdated=!1,void(!e.owner.isReadOnlyMode&&e.owner.isDocumentLoaded&&t.canEditContentControl&&e.prefix.substring(2)!==r&&(t.selection.isEmpty?(t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(r),e.prefix="@"+String.fromCharCode(160)+r):(t.handleTextInput(r),e.prefix="@"+String.fromCharCode(160)+r)));if(e.isCompositionStart&&e.isCompositionEnd&&""===e.suffix)return e.prefix.substring(2)!==r?t.selection.isEmpty&&e.isCompositionStart?(e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-e.prefix.substring(2).length),t.selection.retrieveCurrentFormatProperties(),""!==e.suffix&&""!==r||t.handleTextInput(r)):t.selection.isEmpty||(e.isCompositionStart=!1,t.handleTextInput(r)):""===r?(e.isCompositionStart=!1,t.handleBackKey()):e.prefix.substring(2)===r&&""===e.suffix&&(e.isCompositionStart=!1,t.handleTextInput(" ")),void(e.isCompositionEnd=!1);if(e.isCompositionEnd||e.isCompositionStart&&!e.isCompositionUpdated){if(r.length<e.prefix.length&&r===e.prefix.substring(2,e.prefix.length-1)||e.editableDiv.innerText.length<2)return void t.handleBackKey();if(""!==e.suffix&&e.editableDiv.innerText[e.editableDiv.innerText.length-1]!==String.fromCharCode(160))return e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.selection.end.setPositionForLineWidget(e.selection.end.currentWidget,t.selection.end.offset+e.suffix.length),t.selection.retrieveCurrentFormatProperties(),void t.handleTextInput(r)}"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!e.owner.isReadOnlyMode&&!1===e.isControlPressed&&t.canEditContentControl&&("@"===o||"@"!==o[0]||""===o||o.length<e.prefix.length&&r===e.prefix.substring(2,e.prefix.length-1)?(t.handleBackKey(),e.editableDiv.innerText.length<2&&t.predictText()):0===o.indexOf(e.prefix)&&o.length>e.prefix.length?t.handleTextInput(o.substring(e.prefix.length)):-1===o.indexOf(e.prefix)&&o[o.length-1]!==String.fromCharCode(160)&&" "!==o[o.length-1]?(r.charAt(0).toLowerCase()+r.slice(1)===e.prefix.substring(2)&&t.selection.start.setPositionParagraph(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(r)):2!==o.length&&t.handleTextInput(" "))}else{var o;(o=t.documentHelper.editableDiv.innerText)!==String.fromCharCode(160)?"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!t.owner.isReadOnlyMode&&!1===t.documentHelper.isControlPressed&&t.canEditContentControl&&t.handleTextInput(o):t.handleTextInput(" "),t.documentHelper.editableDiv.innerText=""}},this.onPaste=function(e){!t.owner.isReadOnlyMode&&t.canEditContentControl&&t.pasteInternal(e),e.preventDefault()},this.documentHelper=e,(0,a.isNullOrUndefined)(this.documentHelper)||(this.tableResize=new Ic(this.documentHelper.owner)),this.base64=new Ta}return Object.defineProperty(e.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())&&"RevisionsOnly"!==this.documentHelper.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&(("ReadOnly"===this.documentHelper.protectionType||this.documentHelper.isCommentOnlyMode)&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEditContentControl",{get:function(){var e=this.selection.currentContentControl;if((0,a.isNullOrUndefined)(e)){if(this.selection.checkContentControlLocked())return!1}else if(e.contentControlProperties.lockContents||"DropDownList"===e.contentControlProperties.type)return!1;return!this.owner.isReadOnly},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){if(!(0,a.isNullOrUndefined)(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){if(this.documentHelper)return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Editor"},e.prototype.beginBatchEdit=function(){this.restrictLayout=!0},e.prototype.endBatchEdit=function(){this.restrictLayout=!1,this.layoutWholeDocument()},e.prototype.setFieldInfo=function(e){var t=this.selection.getHyperlinkField(!0);(0,a.isNullOrUndefined)(t)||(this.selection.selectField(),this.insertField(e.code,e.result))},e.prototype.insertField=function(e,t){this.isInsertField=!0;var i=e;if("NUMPAGES"===(i=Pa.trimStart(i)).substring(0,8))this.insertPageCount(t);else if("PAGE"===i.substring(0,4))this.insertPageNumber(t);else{if((0,a.isNullOrUndefined)(t)&&"MERGEFIELD"===i.substring(0,10)){var n=(i=i.substring(10).trim()).indexOf("\\*");t="«"+i.substring(0,n).trim()+"»"}var r=new Rl,o=new ka,s=this.selection.start.paragraph;this.selection.isForward||(s=this.selection.end.paragraph);var l=this.selection.start.currentWidget.getInline(this.selection.start.offset,0);o=s.isEmpty()?s.characterFormat:(0,a.isNullOrUndefined)(l.element)?this.copyInsertFormat(o,!1):l.element.characterFormat;var d=new zl(r),h=new _l(0);h.characterFormat.assignFormat(o),d.children.push(h);var c=new Zl;c.characterFormat.assignFormat(o),c.text=e,d.children.push(c);var p=new _l(2);p.characterFormat.assignFormat(o),p.fieldBegin=h,h.fieldSeparator=p,d.children.push(p);var u=new Zl;u.text=t,u.characterFormat.assignFormat(o),!this.documentHelper.textHelper.isRTLText(t)&&u.characterFormat.bidi&&(u.characterFormat.bidi=!1),d.children.push(u);var g=new _l(1);g.characterFormat.assignFormat(o),g.fieldSeparator=p,g.fieldBegin=h,h.fieldEnd=g,p.fieldEnd=g,d.children.push(g),h.line=d,r.childWidgets.push(d),this.documentHelper.fields.push(h);var m=new Ol;m.sectionFormat=new ga(m),m.childWidgets.push(r),this.pasteContentsInternal([m],!1)}this.isInsertField=!1},e.prototype.isLinkedStyle=function(e){var t=this.documentHelper.styles.findByName(e);return!(0,a.isNullOrUndefined)(t.link)},e.prototype.applyStyle=function(e,t){t=!(0,a.isNullOrUndefined)(t)&&t;var i=void 0,n=void 0,r=this.documentHelper.styles.findByName(e);if(t){this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),i=this.startOffset,n=this.endOffset;var o=this.selection.isEmpty;this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,!(0,a.isNullOrUndefined)(r)&&r instanceof Oa&&"Character"===r.type?this.clearFormattingInternal(!1,!0):this.clearFormattingInternal(!0,!0),this.isSkipOperationsBuild=!1,o&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start)}if(void 0!==r)if(r instanceof Oa&&"Character"===r.type)if(this.selection.isEmpty){var s=this.selection.start.offset,l=this.selection.start.clone(),d=this.selection.end.clone();this.selection.selectCurrentWord(),s===this.selection.start.offset||s===this.selection.end.offset-1?(this.selection.start=l,this.selection.end=d,this.selection.characterFormat.copyFormat(r.characterFormat)):this.onApplyCharacterFormat("styleName",r,!1,!0)}else this.onApplyCharacterFormat("styleName",r,!1,!0);else this.onApplyParagraphFormat("styleName",r,!1,!0);else this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles),this.applyStyle(e);this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=i,this.endOffset=n,this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.cut=function(){if(!this.owner.isReadOnlyMode&&!this.selection.isEmpty&&this.canEditContentControl){var e=this.selection.start,t=this.selection.end,i=0===e.offset?this.selection.getElementInfo(e.currentWidget,e.offset-1):this.selection.getElementInfo(e.currentWidget,this.selection.isForward?e.offset:e.offset+1),n=0===t.offset?this.selection.getElementInfo(t.currentWidget,t.offset-1):this.selection.getElementInfo(t.currentWidget,this.selection.isForward?t.offset+1:t.offset);!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(n)&&i.element&&n.element&&-1!==i.index&&-1!==n.index&&i.element instanceof td&&n.element instanceof td&&i.element.name===n.element.name&&!(!(0,a.isNullOrUndefined)(i.element.nextElement)&&!(0,a.isNullOrUndefined)(n.element.previousElement)&&i.element.nextElement instanceof _l&&n.element.previousElement instanceof _l)&&(this.selection.isForward?(this.selection.start.setPositionParagraph(i.element.line,i.element.line.getOffset(i.element,0)),this.selection.end.setPositionParagraph(n.element.line,n.element.line.getOffset(n.element,1))):(this.selection.start.setPositionParagraph(i.element.line,i.element.line.getOffset(i.element,1)),this.selection.end.setPositionParagraph(n.element.line,n.element.line.getOffset(n.element,0)))),this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0}},e.prototype.insertEditingRegion=function(e){this.insertEditRangeElement(e&&""!==e?e:"Everyone")},e.prototype.enforceProtection=function(e,t,i){var n,r;"boolean"==typeof t?(n=i?"ReadOnly":this.documentHelper.protectionType,r=t):n=t,(0,a.isNullOrUndefined)(r)||(this.documentHelper.restrictFormatting=r),this.documentHelper.protectionType=n,this.selection.isHighlightEditRegion=!0,this.addProtection(e,this.documentHelper.protectionType,!1)},e.prototype.enforceProtectionAsync=function(e,t,i){return kc(this,void 0,void 0,(function(){var n,r;return Fc(this,(function(o){switch(o.label){case 0:return"boolean"==typeof t?(n=i?"ReadOnly":this.documentHelper.protectionType,r=t):(r=!0,n=t),this.documentHelper.restrictFormatting=r,this.documentHelper.protectionType=n,this.selection.isHighlightEditRegion=!0,[4,this.addProtection(e,this.documentHelper.protectionType,!0)];case 1:return o.sent(),[2]}}))}))},e.prototype.getCommentHierarchicalIndex=function(e){for(var t="";e.ownerComment;)(0,a.isNullOrUndefined)(e.ownerComment)?t=e.replyComments.indexOf(e)+";"+t:(t=e.ownerComment.replyComments.indexOf(e)+";"+t,e=e.ownerComment);return t="C;"+this.documentHelper.comments.indexOf(e)+";"+t},e.prototype.alertBox=function(){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),el.DialogUtility.alert({title:e.getConstant("Information"),content:e.getConstant("Multiple Comment")})},e.prototype.insertReplyComment=function(e,t,i){var n,r,o=this.getCommentInfo(t);if(n={author:i.author?i.author:"Guest user",initial:this.constructCommentInitial(i.author?i.author:"Guest user"),text:(0,a.isNullOrUndefined)(o.innerText)?a.SanitizeHtmlHelper.sanitize(t):a.SanitizeHtmlHelper.sanitize(o.innerText),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),done:!1,date:i.dateTime?Pa.getUtcDate(i.dateTime):Pa.getUtcDate()},this.documentHelper.comments.length>0)for(var l=0;l<this.documentHelper.comments.length;l++)if(this.documentHelper.comments[l].commentId===e){r=this.documentHelper.comments[l];break}this.replyComment(r,(0,a.isNullOrUndefined)(o.innerText)?t:o.innerText,o.itemData,n);var d={author:n.author,isResolved:n.done,dateTime:this.parseDateTime(n.date)};return new s(n.commentId,d,t)},e.prototype.getCommentInfo=function(e){for(var t,i=[],n=[],r=/<a href="mailto:([^"]+)">([^<]+)<\/a>/g,o=0;null!==(t=r.exec(e));)t.index>o&&n.push({text:e.substring(o,t.index)}),n.push({mailto:t[1],text:t[2]}),o=r.lastIndex;o<e.length&&n.push({text:e.substring(o)});var s="";if(n.length>0)for(var a=0;a<n.length;a++)n[a].mailto?(i.push({text:n[a].text.replace("@",""),value:n[a].mailto}),s+='<span contenteditable="false" class="e-mention-chip">'+n[a].text.replace("@","")+"</span>"):n[a].text&&(s+=n[a].text.replace(/(\r\n|\n\r|\n|\r)/g,"<br>"));else""!==e&&(s=e.replace(/(\r\n|\n\r|\n|\r)/g,"<br>"));return{itemData:i,innerText:s}},e.prototype.insertComment=function(e,t){if(!((0,a.isNullOrUndefined)(this.selection.start)||this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.viewer.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.selection.isPlainContentControl())){if(this.viewer.owner.commentReviewPane.commentPane.isEditMode)return this.alertBox();(0,a.isNullOrUndefined)(e)&&(e="");var i={},n=this.getCommentInfo(e);if((0,a.isNullOrUndefined)(t))i={author:this.owner.currentUser?a.SanitizeHtmlHelper.sanitize(this.owner.currentUser):"Guest user",initial:this.constructCommentInitial(this.owner.currentUser?a.SanitizeHtmlHelper.sanitize(this.owner.currentUser):"Guest user"),text:a.SanitizeHtmlHelper.sanitize(e),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),done:!1,date:Pa.getUtcDate()};else{var r=(0,a.isNullOrUndefined)(t.author)?this.owner.currentUser:t.author;i={author:r,initial:this.constructCommentInitial(r),text:a.SanitizeHtmlHelper.sanitize(""===n.innerText?e:n.innerText),commentId:Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),done:!!t.isResolved&&t.isResolved,date:t.dateTime?Pa.getUtcDate(t.dateTime):Pa.getUtcDate()}}this.insertCommentInternal((0,a.isNullOrUndefined)(n.innerText)?"":n.innerText,i,n.itemData);var o={author:i.author,isResolved:i.done,dateTime:this.parseDateTime(i.date)};return new s(i.commentId,o,e)}},e.prototype.parseDateTime=function(e){var t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},e.prototype.insertCommentInternal=function(e,t,i){if(this.documentHelper.layout.allowLayout=!1,this.selection.isEmpty){if(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd){var n=this.selection.start.offset;this.selection.start.offset=n-1!=-1?n-1:n}this.selection.selectCurrentWord()}this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&(this.selection.end.offset-=1);var r=this.selection.getParagraphInfo(this.selection.start),s=(this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.selection.getParagraphInfo(this.selection.end)),l=this.selection.getHierarchicalIndex(s.paragraph,s.offset.toString());this.initComplexHistory("InsertComment");var d=this.selection.start,h=this.selection.end,c=new ac(this.owner);this.selection.isForward||(d=this.selection.end,h=this.selection.start),c.setPositionInternal(h);var p=new Bd(0),u=new Bd(1),g=d.currentWidget===h.currentWidget;h.setPositionInternal(d);c.currentWidget.indexInOwner,c.currentWidget.paragraph;if(this.initInsertInline(p),(0,a.isNullOrUndefined)(c.paragraph)||-1===c.currentWidget.indexInOwner){var m=this.selection.getTextPosBasedOnLogicalIndex(l);c.setPositionInternal(m)}g&&c.setPositionParagraph(c.currentWidget,c.offset+p.length),d.setPositionInternal(c),h.setPositionInternal(c),this.initInsertInline(u);var f=new Ld(t.date);if(i&&i.length>0&&(f.mentions=i),this.owner.editorHistoryModule&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistoryModule.currentBaseHistoryInfo.insertedText=o.Marker_Start+o.Marker_End,this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(f)),this.updateCommentElement(f,p,u,t),this.addCommentWidget(f,!0,!0,!0),this.owner.isSpellCheck&&p.previousElement&&p.previousElement instanceof Zl&&(p.previousElement.ischangeDetected=!0),this.owner.isSpellCheck&&u.previousElement&&u.previousElement instanceof Zl&&p.line!==u.line&&(u.previousElement.ischangeDetected=!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(f),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),this.documentHelper.layout.allowLayout=!0,!this.isUserInsert){var v=this.owner.commentReviewPane.commentPane.comments.get(f);i&&i.length>0&&(v.itemData=i),v.postComment()}},e.prototype.updateCommentElement=function(e,t,i,n){return e.author=n.author,e.initial=n.initial,e.text=n.text,e.commentId=n.commentId,(0,a.isNullOrUndefined)(n.done)||(e.isResolved=n.done),(0,a.isNullOrUndefined)(n.isReply)||(e.isReply=n.isReply),(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(i)||(t.comment=e,t.commentId=e.commentId,i.comment=e,i.commentId=e.commentId,e.commentStart=t,e.commentEnd=i),e},e.prototype.deleteAllComments=function(){if(0!==this.documentHelper.comments.length){var e;for(this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1,this.editorHistory&&this.editorHistory.currentHistoryInfo&&(e=this.editorHistory.currentHistoryInfo);this.documentHelper.comments.length>0;){var t=this.documentHelper.comments[0];this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&e.addModifiedAction(this.editorHistory.currentHistoryInfo)}this.selection.selectContent(this.owner.documentStart,!0),this.editorHistory&&(this.editorHistory.currentHistoryInfo=e,this.editorHistory.updateComplexHistory())}},e.prototype.deleteComment=function(e){var t;if(!(this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||(0,a.isNullOrUndefined)(this.owner)||(0,a.isNullOrUndefined)(this.owner.viewer)||(0,a.isNullOrUndefined)(this.owner.documentHelper.currentSelectedComment)&&(0,a.isNullOrUndefined)(e)||this.owner.enableHeaderAndFooter)&&this.viewer.owner.enableComment)if((0,a.isNullOrUndefined)(e))this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment);else{var i=void 0;if(this.documentHelper.comments.length>0)for(var n=0;n<this.documentHelper.comments.length;n++){if((i=this.documentHelper.comments[n]).commentId===e){t=this.documentHelper.comments[n];break}if(i.replyComments&&i.replyComments.length>0)for(var r=0;r<i.replyComments.length;r++)if(i.replyComments[r].commentId===e){t=i.replyComments[r];break}}if((0,a.isNullOrUndefined)(t))throw new Error("Enter a valid comment id.");this.deleteCommentInternal(t)}},e.prototype.deleteCommentInternal=function(e){if(this.initComplexHistory("DeleteComment"),e){if(e.replyComments.length>0)for(var t=e.replyComments.length-1;t>=0;t--)this.deleteCommentInternal(e.replyComments[t]);this.deleteCommentWidgetInternal(e);var i=e.commentStart,n=e.commentEnd;-1!==n.indexInOwner&&this.removeInline(n),-1!==i.indexInOwner&&this.removeInline(i),i.removeCommentMark()}this.editorHistory&&this.editorHistory.updateComplexHistory()},e.prototype.deleteCommentWidgetInternal=function(e){this.owner.editorHistoryModule&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistoryModule.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(e),this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(e)),this.deleteCommentWidget(e),this.editorHistory&&this.editorHistory.updateHistory()},e.prototype.deleteCommentWidget=function(e){var t=this.documentHelper.comments.indexOf(e);-1!==t?this.documentHelper.comments.splice(t,1):e.isReply&&e.ownerComment&&(t=e.ownerComment.replyComments.indexOf(e),e.ownerComment.replyComments.splice(t,1)),this.owner.commentReviewPane&&(this.owner.commentReviewPane.deleteComment(e),this.documentHelper.currentSelectedComment===e&&(this.documentHelper.currentSelectedComment=void 0))},e.prototype.resolveComment=function(e){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var t={author:e.author,cancel:!1,type:"Resolve"};this.owner.trigger(W,t),t.cancel&&"Resolve"===t.type||(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!0))}},e.prototype.reopenComment=function(e){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var t={author:e.author,cancel:!1,type:"Reopen"};this.owner.trigger(W,t),t.cancel&&"Reopen"===t.type||(this.initHistory("ResolveComment"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e),this.resolveOrReopenComment(e,!1))}},e.prototype.resolveOrReopenComment=function(e,t){e.isResolved=t;for(var i=0;i<e.replyComments.length;i++)e.replyComments[i].isResolved=t;this.owner.commentReviewPane&&(t?this.owner.commentReviewPane.resolveComment(e):this.owner.commentReviewPane.reopenComment(e)),this.reLayout(this.selection,!1,!1)},e.prototype.replyComment=function(e,t,i,n){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var r=e;if(e){var s=void 0;n?((s=new Ld(n.date)).author=n.author,s.text=t,s.mentions=i||[],s.commentId=n.commentId,s.isReply=!0):((s=new Ld(Pa.getUtcDate())).author=this.owner.currentUser?a.SanitizeHtmlHelper.sanitize(this.owner.currentUser):"Guest user",s.text=t||"",s.mentions=i||[],s.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),s.isReply=!0);var l={author:s.author,cancel:!1,type:"Post",text:s.text,mentions:s.mentions};if(this.owner.trigger(W,l),l.cancel&&"Post"===l.type)return;this.initComplexHistory("InsertComment");var d=r.commentStart,h=r.commentEnd,c=r.replyComments.length,p=d.line.getOffset(d,c+1),u=new ac(this.documentHelper.owner);u.setPositionParagraph(d.line,p);var g=h.line.getOffset(h,c+1),m=new ac(this.documentHelper.owner);m.setPositionParagraph(h.line,g),this.selection.start.setPositionInternal(u),this.selection.end.setPositionInternal(m),u=this.selection.start,m=this.selection.end;var f=new ac(this.owner);f.setPositionInternal(m);var v=new Bd(0),y=new Bd(1),w=u.currentWidget===m.currentWidget;m.setPositionInternal(u);var b=f.currentWidget.indexInOwner;this.initInsertInline(v),-1===f.currentWidget.indexInOwner&&(f.currentWidget=f.currentWidget.paragraph.childWidgets[b]),w&&f.setPositionParagraph(f.currentWidget,f.offset+v.length),u.setPositionInternal(f),m.setPositionInternal(f),this.initInsertInline(y),r.replyComments.push(s),s.ownerComment=r,this.owner.editorHistoryModule&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistoryModule.currentBaseHistoryInfo.removedNodes.push(s),this.owner.editorHistoryModule.currentBaseHistoryInfo.insertedText=o.Marker_Start+o.Marker_End),v.comment=s,v.commentId=s.commentId,y.comment=s,y.commentId=s.commentId,s.commentStart=v,s.commentEnd=y,this.owner.commentReviewPane&&this.owner.commentReviewPane.addReply(s,!1,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(s),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.reLayout(this.selection),this.isSkipOperationsBuild=!1}}},e.prototype.removeInline=function(e){this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+e.length),this.initHistory("RemoveInline"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0),this.removeSelectedContents(this.documentHelper.selection),this.editorHistory&&this.editorHistory.updateHistory(),this.fireContentChange()},e.prototype.addCommentWidget=function(e,t,i,n){if(-1===this.documentHelper.comments.indexOf(e)){var r=!1;if(this.documentHelper.comments.length>0)for(var o=this.selection.getElementPosition(e.commentStart).startPosition,s=0;s<this.documentHelper.comments.length;s++){var a=this.selection.getElementPosition(this.documentHelper.comments[s].commentStart).startPosition;if(o.isExistBefore(a)){r=!0,this.documentHelper.comments.splice(s,0,e);break}}r||this.documentHelper.comments.push(e),this.owner.commentReviewPane&&(this.owner.showComments=i,this.owner.commentReviewPane.selectedTab=0,this.owner.commentReviewPane.addComment(e,t,n),this.owner.commentReviewPane.reviewTab.selectedItem=0,n&&this.owner.selectionModule.selectComment(e))}},e.prototype.addReplyComment=function(e,t){var i=t.split(";"),n=this.documentHelper.comments[parseInt(i[1],10)];""!==i[2]&&(n.replyComments.splice(parseInt(i[2],10),0,e),e.ownerComment=n),this.owner.commentReviewPane&&(this.owner.showComments=!0,this.owner.commentReviewPane.addReply(e,!1,!0),this.owner.selectionModule.selectComment(e))},e.prototype.addProtection=function(e,t,i){return kc(this,void 0,void 0,(function(){var n=this;return Fc(this,(function(r){return[2,new Promise((function(r,o){if(i=!!(0,a.isNullOrUndefined)(i)||i,""===e)n.protectDocument(t),r();else{n.currentProtectionType=t;var s=new c,l={passwordBase64:n.base64.encodeString(e),saltBase64:"",spinCount:1e5},d=n.owner.serviceUrl+n.owner.serverActionSettings.restrictEditing;s.url=d,s.contentType="application/json;charset=UTF-8",s.onSuccess=function(e){n.enforceProtectionInternal(e),r()},s.onFailure=function(e){n.protectionFailureHandler(e),o()},s.onError=function(e){n.protectionFailureHandler(e),o()},s.customHeaders=n.owner.headers;var h={serverActionType:"RestrictEditing",headers:n.owner.headers,timeout:0,cancel:!1,withCredentials:!1};n.owner.trigger(_,h),h.cancel?n.documentHelper.dialog.visible&&n.documentHelper.dialog.hide():s.send(l,h,i)}}))]}))}))},e.prototype.protectionFailureHandler=function(e){if(this.owner){var t=new a.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale),"onError"===e.name?el.DialogUtility.alert(t.getConstant("Error in establishing connection with web server")):(this.owner.fireServiceFailure(e),console.error(e.statusText))}},e.prototype.enforceProtectionInternal=function(e){var t=JSON.parse(e.data);this.enforceProtectionAssign(t[0],t[1],this.currentProtectionType),this.owner.showHideRulers()},e.prototype.enforceProtectionAssign=function(e,t,i){this.documentHelper&&(this.documentHelper.saltValue=e,this.documentHelper.hashValue=t,this.protectDocument(i))},e.prototype.toggleTrackChangesProtection=function(e){this.viewer.owner.enableTrackChanges=e;var t={isTrackChangesEnabled:e};this.owner.trigger(M,t)},e.prototype.protectDocument=function(e){this.documentHelper.owner.getSettingData("protection",null,this.documentHelper.hashValue,this.documentHelper.saltValue,e),this.protect(e);var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&(this.documentHelper.restrictEditingPane.showStopProtectionPane(!0),this.documentHelper.restrictEditingPane.loadPaneValue(),this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide()),this.owner.notify(j,{}),"RevisionsOnly"===e&&this.toggleTrackChangesProtection(!0),this.owner.trackChangesPane.enableDisableButton(!1),this.documentHelper.owner.enableCollaborativeEditing||this.fireContentChange()},e.prototype.stopProtection=function(e){if(this.documentHelper.isDocumentProtected){if(!(0,a.isNullOrUndefined)(this.documentHelper.saltValue)&&""===this.documentHelper.saltValue&&!(0,a.isNullOrUndefined)(this.documentHelper.hashValue)&&""===this.documentHelper.hashValue&&!(0,a.isNullOrUndefined)(e)&&""===e)return void this.unProtectDocument();var t=new c,i={passwordBase64:this.base64.encodeString(e),saltBase64:this.documentHelper.saltValue,spinCount:1e5};t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,t.contentType="application/json;charset=UTF-8",t.customHeaders=this.owner.headers,t.onSuccess=this.onUnProtectionSuccess.bind(this),t.onFailure=this.protectionFailureHandler.bind(this),t.onError=this.protectionFailureHandler.bind(this);var n={serverActionType:"RestrictEditing",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1};this.owner.trigger(_,n),n.cancel?this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide():t.send(i,n,!1),this.owner.enableTrackChanges||this.toggleTrackChangesProtection(!1)}},e.prototype.stopProtectionAsync=function(e){return kc(this,void 0,void 0,(function(){var t=this;return Fc(this,(function(i){return[2,new Promise((function(i,n){if(t.documentHelper.isDocumentProtected){if(!(0,a.isNullOrUndefined)(t.documentHelper.saltValue)&&""===t.documentHelper.saltValue&&!(0,a.isNullOrUndefined)(t.documentHelper.hashValue)&&""===t.documentHelper.hashValue&&!(0,a.isNullOrUndefined)(e)&&""===e)return t.unProtectDocument(),void i();var r=new c,o={passwordBase64:t.base64.encodeString(e),saltBase64:t.documentHelper.saltValue,spinCount:1e5};r.url=t.owner.serviceUrl+t.owner.serverActionSettings.restrictEditing,r.contentType="application/json;charset=UTF-8",r.customHeaders=t.owner.headers,r.onSuccess=function(e){t.onUnProtectionSuccess(e)?i():n()},r.onFailure=function(e){t.protectionFailureHandler(e),n()},r.onError=function(e){t.protectionFailureHandler(e),n()};var s={serverActionType:"RestrictEditing",headers:t.owner.headers,timeout:0,cancel:!1,withCredentials:!1};t.owner.trigger(_,s),s.cancel?t.documentHelper.dialog.visible&&t.documentHelper.dialog.hide():r.send(o,s),t.owner.enableTrackChanges||t.toggleTrackChangesProtection(!1)}}))]}))}))},e.prototype.onUnProtectionSuccess=function(e){var t=JSON.parse(e.data),i=this.validateHashValue(t[1]);return this.owner.showHideRulers(),i},e.prototype.validateHashValue=function(e){this.currentHashValue=e;var t=new a.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.documentHelper.owner.locale);var i=this.base64.decodeString(e),n=this.documentHelper.hashValue,r=this.base64.decodeString(n),o=!0;if(i.length===r.length){for(var s=0;s<i.length;s++)if(i[s]!==r[s]){o=!1;break}}else o=!1;return o?(this.unProtectDocument(),!0):(el.DialogUtility.alert(t.getConstant("The password is incorrect")),!1)},e.prototype.unProtectDocument=function(){this.documentHelper.owner.getSettingData("protection",!1,this.currentHashValue),this.currentHashValue=null;var e=this.documentHelper.protectionType;this.documentHelper.isDocumentProtected=!1,this.documentHelper.restrictFormatting=!1,this.documentHelper.protectionType="NoProtection",this.documentHelper.saltValue="",this.documentHelper.hashValue="",this.documentHelper.selection.highlightEditRegion();var t=this.documentHelper.restrictEditingPane.restrictPane;t&&"block"===t.style.display&&this.documentHelper.restrictEditingPane.showStopProtectionPane(!1),"RevisionsOnly"!==e||this.owner.enableTrackChanges||this.toggleTrackChangesProtection(!1),this.owner.trackChangesPane.enableDisableButton(!0),(0,a.isNullOrUndefined)(this.editorHistory)||this.owner.editorHistoryModule.clearHistory(),this.owner.notify(j,{}),this.documentHelper.dialog.visible&&this.documentHelper.dialog.hide(),this.owner.showHideRulers(),this.documentHelper.owner.enableCollaborativeEditing||this.fireContentChange()},e.prototype.fireContentChange=function(){this.owner.documentHelper.render.commentMarkDictionary.clear(),this.selection.isHighlightEditRegion&&(this.owner.enableLockAndEdit?this.owner.collaborativeEditingModule.updateLockRegion():this.selection.onHighlight()),this.selection.highlightFormFields(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0)),!this.documentHelper.owner.isLayoutEnabled||this.documentHelper.owner.editorModule.isUserInsert||this.documentHelper.owner.isShiftingEnabled||this.isSkipOperationsBuild||this.isRemoteAction||this.documentHelper.owner.fireContentChange(),!(0,a.isNullOrUndefined)(this.owner.optionsPaneModule)&&this.owner.optionsPaneModule.isOptionsPaneShow&&!this.owner.optionsPaneModule.isUpdateHeading&&"BodyText"!==this.selection.paragraphFormat.outlineLevel&&this.owner.optionsPaneModule.isHeadingTab&&this.owner.optionsPaneModule.updateHeadingTab(),this.owner.isSpellCheck&&!(0,a.isNullOrUndefined)(this.selection.editPosition)&&(this.triggerPageSpellCheck=!1)},e.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},e.prototype.predictText=function(){this.documentHelper.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix(),this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix,this.documentHelper.editableDiv.innerText=this.documentHelper.prefix,this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},e.prototype.getPrefixAndSuffix=function(){var e=this.owner.documentHelper;if(""===this.selection.text){var t=0,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,t),n=i.element;if(t=i.index,void 0!==n){var r=this.selection.getElementBoxInternal(n,t),o=r.element;t=r.index;var s=0;if(!(0,a.isNullOrUndefined)(o)){var l=!1;for(o instanceof Zl&&t>0&&o.line.isFirstLine()&&(e.prefix=""),n instanceof Zl||(n=this.selection.getPreviousTextElement(n));(s=e.prefix.lastIndexOf(" "))<0&&n instanceof Zl;)if(n.previousNode instanceof Zl&&-1===e.prefix.indexOf(" ")){if(l?e.prefix=n.text+e.prefix:(e.prefix=n.text.substring(0,t),l=!0),(n=n.previousNode)instanceof md)break;n instanceof Zl||(n=this.selection.getPreviousTextElement(n))}else if(!(n.previousNode instanceof Zl)){l?e.prefix=n.text+e.prefix:(e.prefix=n.text.substring(0,t),l=!0);break}e.prefix.length>1&&" "===e.prefix[e.prefix.length-1]&&"."===e.prefix[e.prefix.length-2]?(s=-1,e.prefix=""):s=e.prefix.lastIndexOf(" "),e.prefix=s<0?e.prefix:e.prefix.substring(s),0===e.prefix.indexOf(" ")&&e.prefix.length>=1&&(e.prefix=e.prefix.substring(1));var d=0,h=this.selection.end.currentWidget.getInline(this.selection.end.offset,d),c=h.element;if(d=h.index,o=(r=this.selection.getElementBoxInternal(c,d)).element,d=r.index,o){var p=!1;for(o instanceof Zl&&d<o.length&&(e.suffix="");(s=e.suffix.indexOf(" "))<0&&c instanceof Zl;)if(c.nextNode instanceof Zl&&-1===e.suffix.indexOf(" "))p?e.suffix=e.suffix+c.text:(e.suffix=o.text.substring(d),p=!0),c=c.nextNode;else if(!(c.nextNode instanceof Zl)){p?e.suffix=e.suffix+c.text:(e.suffix=o.text.substring(d),p=!0);break}s=e.suffix.indexOf(" "),e.suffix=s<0?e.suffix:e.suffix.substring(0,s)}}}}else e.prefix=""},e.prototype.onKeyDownInternal=function(e,t,i,n){var r=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(r){case 13:this.owner.isReadOnlyMode||(e.preventDefault(),this.insertColumnBreak());break;case 68:this.owner.isReadOnlyMode||this.owner.selectionModule.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selectionModule.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:if(e.preventDefault(),!this.owner.isReadOnlyMode){var o={isTrackChangesEnabled:!this.owner.enableTrackChanges};this.owner.trigger(M,o)}}else if(!i&&t&&n)switch(r){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(r){case 8:e.preventDefault(),this.handleBackKey();break;case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!0,!1)):this.documentHelper.editableDiv.blur();break;case 13:e.preventDefault(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!0),this.handleEnterKey(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1);break;case 27:e.preventDefault(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete(),e.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:var s=this.selection.getDocumentEnd();s.offset=this.selection.getDocumentEnd().offset+1,this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(s)?this.owner.updateFields():this.selection.updateRefField()}else switch(r){case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!1,!0)):this.documentHelper.editableDiv.blur();break;case 13:this.handleShiftEnter(),e.preventDefault();break;case 114:e.preventDefault(),this.changeCase(this.toggleChangeCase())}else switch(this.documentHelper.isControlPressed=!0,r){case 8:e.preventDefault(),this.handleCtrlBackKey();break;case 46:e.preventDefault(),this.handleCtrlDelete();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault();var a=0,l=this.documentHelper.selection.start.paragraph.paragraphFormat.beforeSpacing;l>12?a=12:l>0&&l<=12?a=0:0===l&&(a=12),this.onApplyParagraphFormat("beforeSpacing",a,!0,!1);break;case 49:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBold();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.fontDialogModule&&this.owner.fontDialogModule.showFontDialog();break;case 69:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),!this.owner.isReadOnly&&this.owner.optionsPaneModule&&(this.owner.optionsPaneModule.isReplace=!0,this.owner.documentEditorSettings.showNavigationPane=!0);break;case 73:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.hyperlinkDialogModule&&!this.owner.isReadOnlyMode&&this.owner.hyperlinkDialogModule.show();break;case 76:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selectionModule.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selectionModule.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editorModule.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBaselineAlignment("Subscript")}},e.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},e.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||"FormFieldsOnly"===this.documentHelper.protectionType&&this.canEditContentControl&&!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},e.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||"FormFieldsOnly"===this.documentHelper.protectionType&&this.canEditContentControl&&!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete(),this.selection.checkForCursorVisibility()},e.prototype.handleEnterKey=function(){var e=this.documentHelper.owner.selection.currentContentControl;(!this.owner.isReadOnlyMode&&!this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode()||("FormFieldsOnly"===this.documentHelper.protectionType||"NoProtection"==this.documentHelper.protectionType)&&e.contentControlProperties.multiline&&!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||!(0,a.isNullOrUndefined)(e)&&"RichText"===e.contentControlProperties.type&&this.canEditContentControl&&("Block"===e.contentControlWidgetType||"Cell"===e.contentControlWidgetType))&&(a.Browser.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter()),this.selection.checkForCursorVisibility()},e.prototype.handleCtrlBackKey=function(){var e=this.selection.start,t=this.selection.end;if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())if(this.selection.isForward||(e=t),this.selection.isEmpty)this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace();else{if(((0,a.isNullOrUndefined)(e.paragraph.previousRenderedWidget)||e.paragraph.previousRenderedWidget instanceof Al)&&0===e.offset)return;this.selection.handleLeftKey(),this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()}},e.prototype.handleCtrlDelete=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())if(this.selection.isEmpty)this.selection.handleControlShiftRightKey(),this.owner.editorModule.delete();else{this.selection.handleLeftKey(),this.selection.handleControlShiftRightKey();var e=this.selection.text;Pa.endsWith(e)&&this.selection.handleShiftLeftKey(),this.owner.editorModule.delete()}},e.prototype.handleTextInput=function(e){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||"FormFieldsOnly"===this.documentHelper.protectionType&&this.canEditContentControl&&!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),(0,a.classList)(this.selection.caret,[],["e-de-cursor-animation"]),this.handledTextInput=!0,this.owner.editorModule.insertText(e),this.handledTextInput=!1,this.animationTimer=Number(setTimeout((function(){t.animationTimer&&clearTimeout(t.animationTimer),t.selection&&t.selection.caret&&(0,a.classList)(t.selection.caret,["e-de-cursor-animation"],[])}),600))),this.selection.checkForCursorVisibility()},e.prototype.copyInsertFormat=function(e,t,i){var n=i?new ka(i):new ka,r=this.selection.characterFormat;return t&&n.copyFormat(e),(0,a.isNullOrUndefined)(r.bidi)||e.bidi===r.bidi||(n.bidi=r.bidi),(0,a.isNullOrUndefined)(r.bold)||e.bold===r.bold||(n.bold=r.bold),(0,a.isNullOrUndefined)(r.italic)||e.italic===r.italic||(n.italic=r.italic),r.fontSize>0&&e.fontSize!==r.fontSize&&(n.fontSize=r.fontSize),(0,a.isNullOrUndefined)(r.fontFamily)||e.fontFamily===r.fontFamily||(n.fontFamily=r.fontFamily),(0,a.isNullOrUndefined)(r.highlightColor)||e.highlightColor===r.highlightColor||(n.highlightColor=r.highlightColor),(0,a.isNullOrUndefined)(r.baselineAlignment)||e.baselineAlignment===r.baselineAlignment||(n.baselineAlignment=r.baselineAlignment),(0,a.isNullOrUndefined)(r.fontColor)||e.fontColor===r.fontColor||(n.fontColor=r.fontColor),(0,a.isNullOrUndefined)(r.underline)||e.underline===r.underline||(n.underline=r.underline),(0,a.isNullOrUndefined)(r.strikethrough)||e.strikethrough===r.strikethrough||(n.strikethrough=r.strikethrough),(0,a.isNullOrUndefined)(r.boldBidi)||e.boldBidi===r.boldBidi||(n.boldBidi=r.boldBidi),(0,a.isNullOrUndefined)(r.italicBidi)||e.italicBidi===r.italicBidi||(n.italicBidi=r.italicBidi),r.fontSizeBidi>0&&e.fontSizeBidi!==r.fontSizeBidi&&(n.fontSizeBidi=r.fontSizeBidi),n},e.prototype.getResultContentControlText=function(e){for(var t=e.nextNode,i="";!(t instanceof id||(t instanceof Zl&&(i+=t.text),(0,a.isNullOrUndefined)(t)));)if((0,a.isNullOrUndefined)(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return i},e.prototype.insertContentControlPlaceholder=function(){var e=this.owner.selection.currentContentControl;if(!(0,a.isNullOrUndefined)(e)&&e.nextElement instanceof id&&e.nextElement===e.reference){var t=new Zl,i=new a.L10n("documenteditor",this.owner.defaultLocale);i.setLocale(this.owner.locale),t.text=i.getConstant("Default Content Control Text"),"ComboBox"!==e.contentControlProperties.type&&"DropDownList"!==e.contentControlProperties.type||(t.text=i.getConstant("Choose an item")),"Date"===e.contentControlProperties.type&&(t.text=i.getConstant("Default Date Picker")),t.characterFormat=this.owner.editor.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.owner.editor.insertElementsInternal(this.owner.selectionModule.end,[t]),e.contentControlProperties.hasPlaceHolderText=!0}},e.prototype.insertContentControl=function(e,t,i){if(!this.selection.isPlainContentControl()){var n,r;switch(this.selection.isSelectionisInCC=!1,"string"!=typeof e?(n=e.type,t=e.value,i=e.items,r=e):n=e,(0,a.isNullOrUndefined)(r)&&(r={title:void 0,tag:void 0,value:String(t),canDelete:!1,canEdit:!1,type:n,xmlString:void 0,xmlPath:void 0}),(0,a.isNullOrUndefined)(r)||(0,a.isNullOrUndefined)(r.xmlString)||(0,a.isNullOrUndefined)(r.xmlString)||(t=(r=this.mapXmlStringPath(r)).value,this.owner.isXmlMapCC=!0),n){case"RichText":if((0,a.isNullOrUndefined)(t))this.applyRichText();else try{var o=t;"object"!=typeof o&&(o=JSON.parse(t)),(o&&"object"==typeof o||"sections"in o)&&this.applyRichText(t,r.title,r.tag,r.canDelete,r.canEdit)}catch(e){var s={sections:[{blocks:[{inlines:[{text:t}]}]}]};this.applyRichText(JSON.stringify(s),r.title,r.tag,r.canDelete,r.canEdit)}break;case"Text":(0,a.isNullOrUndefined)(t)?this.applyPlainText():this.applyPlainText(t,r.title,r.tag,r.canDelete,r.canEdit);break;case"Picture":this.applyPictureContentControl(n,t,r.title,r.tag,r.canDelete,r.canEdit);break;case"ComboBox":this.applyComboBox("ComboBox",i,t,r.title,r.tag,r.canDelete,r.canEdit);break;case"DropDownList":this.applyComboBox("DropDownList",i,t,r.title,r.tag,r.canDelete,r.canEdit);break;case"Date":this.applyDatePickerContentControl(n,t,r.title,r.tag,r.canDelete,r.canEdit);break;case"CheckBox":this.applyCheckBoxContentControl(n,String.fromCharCode(9744),t,r.title,r.tag,r.canDelete,r.canEdit)}var l=this.selection.currentContentControl;if(!(0,a.isNullOrUndefined)(l))return{title:l.contentControlProperties.title,tag:l.contentControlProperties.tag,value:String(t),canDelete:l.contentControlProperties.lockContentControl,canEdit:l.contentControlProperties.lockContents,type:l.contentControlProperties.type,xmlString:r.xmlString,xmlPath:r.xmlPath}}},e.prototype.openContentDialog=function(e){var t=new a.L10n("documenteditor",this.owner.defaultLocale);t.setLocale(this.owner.locale),el.DialogUtility.alert({title:t.getConstant("Information"),content:e?t.getConstant("Rich text Controls"):t.getConstant("Plain text Controls"),showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"center",Y:"center"}})},e.prototype.updatePropertiesToBlock=function(e,t){if("Block"===e.contentControlProperties.contentControlWidgetType)for(var i=e.line.paragraph,n=e.reference.line.paragraph,r=i.isInsideTable?this.documentHelper.layout.getParentTable(i):i,o=n.isInsideTable?this.documentHelper.layout.getParentTable(n):n;r;)r.contentControlProperties=t?e.contentControlProperties:void 0,r=r!==o?r.nextRenderedWidget:void 0},e.prototype.updateContentControlPosition=function(e,t){var i=e.currentWidget.getInline(e.offset,0),n=t.currentWidget.getInline(t.offset,0);i&&i.element instanceof id&&"Block"===i.element.contentControlWidgetType&&e.offset++,n&&n.element instanceof id&&"Block"===n.element.contentControlWidgetType&&t.offset--},e.prototype.applyRichText=function(e,t,i,n,r){var o=this.selection.isForward?this.selection.start.clone():this.selection.end.clone(),s=this.selection.isForward?this.selection.end.clone():this.selection.start.clone();if(this.selection.isParagraphMarkSelected()&&(s.offset-=1),o.paragraph!==s.paragraph)if(o.isAtParagraphStart){if(o.isAtParagraphStart&&!s.isAtParagraphEnd){var l=void 0;l=s.paragraph.previousRenderedWidget instanceof Al?this.selection.getLastBlockInLastCell(s.paragraph.previousRenderedWidget):s.paragraph.previousRenderedWidget,s.setPositionParagraph(l.lastChild,l.lastChild.getEndOffset())}}else s.setPositionParagraph(o.paragraph.lastChild,o.paragraph.lastChild.getEndOffset());var d=!0;o.isAtParagraphStart&&s.isAtParagraphEnd&&(d=!1),this.updateContentControlPosition(o,s),this.editorHistory&&this.initComplexHistory("InsertContentControl");var h=new id(d?"Inline":"Block"),c=new id(d?"Inline":"Block"),p=new nd(d?"Inline":"Block");if(p.color="#00000000",o.isAtSamePosition(s)?p.hasPlaceHolderText=!0:p.hasPlaceHolderText=!1,p.isTemporary=!1,p.lockContentControl=!(0,a.isNullOrUndefined)(n)&&!n,p.lockContents=!(0,a.isNullOrUndefined)(r)&&!r,p.tag=(0,a.isNullOrUndefined)(i)?void 0:i,p.title=(0,a.isNullOrUndefined)(t)?void 0:t,p.multiline=!1,p.type="RichText",this.owner.isXmlMapCC&&this.addXmlProperties(p,this.owner.xPathString),h.contentControlProperties=p,c.contentControlProperties=h.contentControlProperties,h.type=0,c.type=1,p.hasPlaceHolderText){var u=new Zl,g=new a.L10n("documenteditor",this.owner.defaultLocale);g.setLocale(this.owner.locale),u.text=g.getConstant("Default Content Control Text"),u.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(o,[h]),this.insertElementsInternal(o,[u]),o.offset,u.length,this.insertElementsInternal(o,[c])}else{o.currentWidget===s.currentWidget&&s.offset++;var m=this.selection.getParagraphInfo(s),f=this.selection.getHierarchicalIndex(m.paragraph,m.offset.toString());this.insertElementsInternal(o,[h]),s=this.owner.selection.getTextPosBasedOnLogicalIndex(f),this.insertElementsInternal(s,[c])}(0,a.isNullOrUndefined)(e)||(this.documentHelper.selection.selectContentInternal(h),this.paste(e),p.hasPlaceHolderText=!1),this.updatePropertiesToBlock(h,!0),p.hasPlaceHolderText?this.selection.selectPlaceHolderText(h):this.selection.selectContentInternal(h),this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl(),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()},e.prototype.isInvalidElementPresent=function(e,t){for(var i=this.selection.getElementInfo(e.currentWidget,e.offset+1),n=this.selection.getElementInfo(t.currentWidget,t.offset),r=e.currentWidget.indexInOwner;r<t.currentWidget.indexInOwner+1;r++)for(var o=e.currentWidget.paragraph.childWidgets[r],s=i.element.indexInOwner;s<o.children.length;s++){var a=o.children[s];if(!(a instanceof Zl))return!0;if(n.element==a)return!1}return!1},e.prototype.applyPlainText=function(e,t,i,n,r){var o=this.selection.currentContentControl;if((0,a.isNullOrUndefined)(o)||"RichText"===o.contentControlProperties.type){var s=this.selection.isForward?this.selection.start.clone():this.selection.end.clone(),l=this.selection.isForward?this.selection.end.clone():this.selection.start.clone();this.selection.isParagraphMarkSelected()&&(l.offset-=1),s.paragraph!==l.paragraph&&l.setPositionParagraph(s.paragraph.lastChild,s.paragraph.lastChild.getEndOffset());var d=!0;s.isAtParagraphStart&&l.isAtParagraphEnd&&(d=!1);var h=s.isAtSamePosition(l);if(!h&&this.isInvalidElementPresent(s,l))return void this.openContentDialog(!1);var c=new id(d?"Inline":"Block"),p=new id(d?"Inline":"Block"),u=new nd(d?"Inline":"Block");if(u.color="#00000000",u.hasPlaceHolderText=!!h,u.isTemporary=!1,u.lockContentControl=!(0,a.isNullOrUndefined)(n)&&!n,u.lockContents=!(0,a.isNullOrUndefined)(r)&&!r,u.tag=(0,a.isNullOrUndefined)(i)?void 0:i,u.title=(0,a.isNullOrUndefined)(t)?void 0:t,u.multiline=!1,u.type="Text",this.owner.isXmlMapCC&&this.addXmlProperties(u,this.owner.xPathString),c.contentControlProperties=u,p.contentControlProperties=c.contentControlProperties,c.type=0,p.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl"),u.hasPlaceHolderText){var g=new Zl;if((0,a.isNullOrUndefined)(e)){var m=new a.L10n("documenteditor",this.owner.defaultLocale);m.setLocale(this.owner.locale),g.text=m.getConstant("Default Content Control Text")}else g.text=e,u.hasPlaceHolderText=!1;g.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(s,[c]),this.insertElementsInternal(s,[g]),s.offset,g.length,this.insertElementsInternal(s,[p])}else{s.currentWidget===l.currentWidget&&l.offset++;var f=this.selection.getParagraphInfo(l),v=this.selection.getHierarchicalIndex(f.paragraph,f.offset.toString());this.insertElementsInternal(s,[c]),l=this.owner.selection.getTextPosBasedOnLogicalIndex(v),this.insertElementsInternal(l,[p])}this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=u,this.updatePropertiesToBlock(c,!0),u.hasPlaceHolderText?this.selection.selectPlaceHolderText(c):this.selection.selectContentInternal(c),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()}},e.prototype.applyComboBox=function(e,t,i,n,r,o,s){var l=this.selection.currentContentControl;if((0,a.isNullOrUndefined)(l)||"RichText"===l.contentControlProperties.type){var d=new id("Inline"),h=new id("Inline"),c=new nd("Inline");c.color="#00000000",c.type=e,c.tag=(0,a.isNullOrUndefined)(r)?void 0:r,c.title=(0,a.isNullOrUndefined)(n)?void 0:n,this.selection.isEmpty?c.hasPlaceHolderText=!0:c.hasPlaceHolderText=!1,c.isTemporary=!1,c.lockContentControl=!(0,a.isNullOrUndefined)(o)&&o,c.lockContents=!(0,a.isNullOrUndefined)(s)&&s,c.multiline=!1;var p=[];if((0,a.isNullOrUndefined)(t)){v=new rd;var u=new a.L10n("documenteditor",this.owner.defaultLocale);v.displayText=u.getConstant("Choose an item"),v.value=u.getConstant("Choose an item"),p.push(v)}else for(var g=0;g<t.length;g++){(v=new rd).displayText=t[g],v.value=t[g],p.push(v)}c.contentControlListItems=p,c.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(c,this.owner.xPathString),d.contentControlProperties=c,h.contentControlProperties=d.contentControlProperties,d.type=0,h.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl");var m=this.selection.isForward?this.selection.start.clone():this.selection.end.clone(),f=this.selection.isForward?this.selection.end.clone():this.selection.start.clone();if(f.paragraph!==m.paragraph&&(f=new ac(this.owner)).setPositionParagraph(m.paragraph.lastChild,m.paragraph.lastChild.getEndOffset()),c.hasPlaceHolderText){var v=new Zl;u=new a.L10n("documenteditor",this.owner.defaultLocale);v.text=u.getConstant("Choose an item"),v.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(m,[d]),this.insertElementsInternal(m,[v]),m.offset,v.length,this.insertElementsInternal(m,[h])}else this.insertElementsInternal(m,[d]),f.offset++,this.insertElementsInternal(f,[h]);this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=c,(0,a.isNullOrUndefined)(t)||this.dropDownChange(d,i),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()}},e.prototype.applyDatePickerContentControl=function(e,t,i,n,r,o){this.dateValue=t;var s=this.selection.currentContentControl;if((0,a.isNullOrUndefined)(s)||"RichText"===s.contentControlProperties.type){var l=new id("Inline"),d=new id("Inline"),h=new nd("Inline");h.color="#00000000",this.selection.isEmpty?h.hasPlaceHolderText=!0:h.hasPlaceHolderText=!1,h.isTemporary=!1,h.lockContentControl=!(0,a.isNullOrUndefined)(r)&&!r,h.lockContents=!(0,a.isNullOrUndefined)(o)&&!o,h.tag=(0,a.isNullOrUndefined)(n)?void 0:n,h.title=(0,a.isNullOrUndefined)(i)?void 0:i,h.multiline=!1,h.type=e,h.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(h,this.owner.xPathString),l.contentControlProperties=h,d.contentControlProperties=l.contentControlProperties,l.type=0,d.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl");var c=this.selection.isForward?this.selection.start.clone():this.selection.end.clone(),p=this.selection.isForward?this.selection.end.clone():this.selection.start.clone();if(p.paragraph!==c.paragraph&&(p=new ac(this.owner)).setPositionParagraph(c.paragraph.lastChild,c.paragraph.lastChild.getEndOffset()),h.hasPlaceHolderText){var u=new Zl;if(t)u.text=t;else{var g=new a.L10n("documenteditor",this.owner.defaultLocale);g.setLocale(this.owner.locale),u.text=g.getConstant("Default Date Picker")}u.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(c,[l]),this.insertElementsInternal(c,[u]),c.offset,u.length,this.insertElementsInternal(c,[d])}else this.insertElementsInternal(c,[l]),p.offset++,this.insertElementsInternal(p,[d]);this.selection.start.currentWidget.getInline(this.selection.start.offset-1,0).element.contentControlProperties=h,this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()}},e.prototype.applyCheckBoxContentControl=function(e,t,i,n,r,o,s){var l=this.selection.currentContentControl;if((0,a.isNullOrUndefined)(l)||"RichText"===l.contentControlProperties.type){var d=new id("Inline"),h=new id("Inline"),c=new nd("Inline");c.color="#00000000",c.hasPlaceHolderText=!1,c.isTemporary=!1,c.lockContentControl=!(0,a.isNullOrUndefined)(o)&&o,c.lockContents=!(0,a.isNullOrUndefined)(s)&&s,c.multiline=!1,c.type=e,c.tag=(0,a.isNullOrUndefined)(r)?void 0:r,c.title=(0,a.isNullOrUndefined)(n)?void 0:n,(0,a.isNullOrUndefined)(i)?c.isChecked=!1:c.isChecked=i,c.uncheckedState=new od,c.uncheckedState.font=this.selection.characterFormat.fontFamily,c.uncheckedState.value=String.fromCharCode(9744),c.checkedState=new od,c.checkedState.font=this.selection.characterFormat.fontFamily,c.checkedState.value=String.fromCharCode(9746),c.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(c,this.owner.xPathString),d.contentControlProperties=c,h.contentControlProperties=d.contentControlProperties,d.type=0,h.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl");var p=this.selection.isForward?this.selection.start.clone():this.selection.end.clone(),u=this.selection.isForward?this.selection.end.clone():this.selection.start.clone();if(u.paragraph!==p.paragraph&&(u=new ac(this.owner)).setPositionParagraph(p.paragraph.lastChild,p.paragraph.lastChild.getEndOffset()),this.selection){var g=new Zl;g.text=t,g.characterFormat=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0),this.insertElementsInternal(p,[d]),this.insertElementsInternal(p,[g]),p.offset,g.length,this.insertElementsInternal(p,[h])}this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()}},e.prototype.applyPictureContentControl=function(e,t,i,n,r,o){var s=this.selection.currentContentControl;if((0,a.isNullOrUndefined)(s)||"RichText"===s.contentControlProperties.type){var l=new id("Inline"),d=new id("Inline"),h=new nd("Inline");h.color="#00000000",h.hasPlaceHolderText=!1,h.isTemporary=!1,h.lockContentControl=!(0,a.isNullOrUndefined)(r)&&r,h.lockContents=!(0,a.isNullOrUndefined)(o)&&o,h.multiline=!1,h.type=e,h.tag=(0,a.isNullOrUndefined)(n)?void 0:n,h.title=(0,a.isNullOrUndefined)(i)?void 0:i,h.contentControlWidgetType="Inline",this.owner.isXmlMapCC&&this.addXmlProperties(h,this.owner.xPathString),l.contentControlProperties=h,d.contentControlProperties=l.contentControlProperties,l.type=0,d.type=1,this.editorHistory&&this.initComplexHistory("InsertContentControl");var c=this.selection.start.clone(),p=this.selection.end.clone();this.selection.isForward||(l.type=1,d.type=0),this.selection.start.paragraph==this.selection.end.paragraph&&(this.insertElementsInternal(c,[l]),(0,a.isNullOrUndefined)(t)||this.insertImageAsync(t),this.insertElementsInternal(p,[d])),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.viewer.updateScrollBars()}},e.prototype.getPrefixMapping=function(e){var t=(new DOMParser).parseFromString(e,"application/xml");this.documentHelper.owner.prefixMappings=t.documentElement.namespaceURI},e.prototype.addXmlProperties=function(e,t){e.xmlMapping=new sd,e.xmlMapping.isMapped=!0,(0,a.isNullOrUndefined)(this.documentHelper.owner.prefixMappings)?e.xmlMapping.prefixMapping=" ":e.xmlMapping.prefixMapping=this.documentHelper.owner.prefixMappings,e.xmlMapping.xPath=t,(0,a.isNullOrUndefined)(this.guid)&&(this.guid=this.createGuid()),e.xmlMapping.storeItemId="{"+this.guid+"}",this.documentHelper.customXmlData.add(e.xmlMapping.storeItemId,this.xmlStringValue)},e.prototype.createGuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))},e.prototype.mapXmlStringPath=function(e){this.getPrefixMapping(e.xmlString);var t=this.parseXml(e.xmlString),i=this.objectToArray(t);this.setXmlData(t,i);this.xmlData;var n=e.xmlPath.split("/").pop(),r=e.xmlPath.split("/"),o=r[r.length-2],s=this.getXmlValue(o,n);return this.owner.isXmlMapCC=!0,e.xmlPath=this.transformString(e.xmlPath),this.owner.xPathString="/"+e.xmlPath,e.value=s,e},e.prototype.setContentControlInfo=function(e){var t=this.documentHelper.selection.getContentControlInfo();if(!(0,a.isNullOrUndefined)(t)){t.xmlString=e.xmlString,t.xmlPath=e.xmlPath,t.title=e.title,t.tag=e.tag,t.value=e.value,t.canDelete=e.canDelete,t.canEdit=e.canEdit;var i=this.selection.currentContentControl,n=this.documentHelper.owner.getImageContentControl();if(!((0,a.isNullOrUndefined)(i)&&(0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(t))){if(!(0,a.isNullOrUndefined)(t.xmlString)&&!(0,a.isNullOrUndefined)(t.xmlString)){t=this.mapXmlStringPath(t),this.documentHelper.owner.selection.selectContentInternal(i),this.insertText(t.value);var r=this.getContentControl();this.addXmlProperties(r.contentControlProperties,this.owner.xPathString),this.owner.isXmlMapCC=!1}(0,a.isNullOrUndefined)(t.tag)||t.tag===i.contentControlProperties.tag||(i.contentControlProperties.tag=t.tag),(0,a.isNullOrUndefined)(t.title)||t.title===i.contentControlProperties.title||(i.contentControlProperties.title=t.title),(0,a.isNullOrUndefined)(t.value)||i.nextElement.text===t.value||t.canEdit||this.insertText(t.value),(0,a.isNullOrUndefined)(t.canDelete)||t.canDelete===i.contentControlProperties.lockContentControl||(i.contentControlProperties.lockContentControl=t.canDelete),(0,a.isNullOrUndefined)(t.canEdit)||t.canEdit===i.contentControlProperties.lockContents||(i.contentControlProperties.lockContents=t.canEdit)}return t}},e.prototype.transformString=function(e){return e.split("/").map((function(e){return e+"[1]"})).join("/")},e.prototype.getXmlValue=function(e,t){for(var i,n,r,o=0;o<this.xmlData.length;o++)if(this.xmlData[o].displayText==e&&(i=this.xmlData[o].id),i=Number(i),!isNaN(i)&&this.xmlData[o].displayText==t&&this.xmlData[i-1].displayText==e){n=this.xmlData[o].id,n=Number(n),r=(r=this.xmlData[o].displayValue).toString();break}return r},e.prototype.objectToArray=function(e){return Object.keys(e).map((function(t,i){return{index:String(i+1),data:e[t]}}))},e.prototype.parseXml=function(e){this.xmlStringValue=e;try{var t=(new DOMParser).parseFromString(e,"text/xml"),i=this.xmlToJson(t.documentElement);return this.xmlTitle=t.documentElement.nodeName,i}catch(e){return console.error("Error parsing XML string:",e),null}},e.prototype.xmlToJson=function(e){var t={};if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(1===n.nodeType)n.nextSibling&&n.nextSibling.nodeName===n.nodeName?(t[n.nodeName]||(t[n.nodeName]=[]),t[n.nodeName].push(this.xmlToJson(n))):t[n.nodeName]=this.xmlToJson(n);else if(3===n.nodeType){var r=n.textContent.trim();r&&(t=r)}}return t},e.prototype.setXmlData=function(e,t){var i=2;this.xmlData=[],this.xmlData.push({id:1,displayText:this.xmlTitle,hasChild:!0,expanded:!0});var n=0;for(var r in e){for(var o=!0;n<t.length;n++){var s=t[n].data;o=s instanceof Object&&Object.keys(s).length>0,n+=1;break}this.xmlData.push({id:i++,displayText:r,displayValue:e[r],pid:"1",hasChild:o,expanded:o});for(var a=e[r],l=0;l<t.length;l++){var d=t[l].data,h=(i-1).toString();if(d instanceof Object&&d==a)for(var c in d)this.xmlData.push({id:i++,displayText:c,displayValue:a[c],pid:h})}}this.dictionaryObject[this.dictionaryObjectIndexIncrement++]={ID:"(no namespace)_"+this.dictionaryObjcetIDIncreament,Data:this.xmlData},this.dictionaryObjcetIDIncreament++},e.prototype.dropDownChange=function(e,t){(0,a.isNullOrUndefined)(e)||(this.documentHelper.selection.selectContentInternal(e),this.insertTextInternal(t,!0),e.contentControlProperties.isTemporary&&this.removeContentControl())},e.prototype.updateXmlMappedContentControl=function(){if(this.isXmlMapped){var e=this.selection.currentContentControl;e&&e.contentControlProperties&&this.updateCustomXml(e.contentControlProperties.xmlMapping.storeItemId,e.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(e))}},e.prototype.updateCustomXml=function(e,t,i){if(this.documentHelper.customXmlData.containsKey(e)&&!(0,a.isNullOrUndefined)(t)){var n=this.documentHelper.customXmlData.get(e),r=(new DOMParser).parseFromString(n,"text/xml"),o=t.substring(t.lastIndexOf("/")+1);o=(o=(o=o.split("[")[0]).substring(o.lastIndexOf(":")+1)).substring(o.lastIndexOf("@")+1);var s=r.getElementsByTagName(o);if(s.length>0)s[0].childNodes[0].nodeValue=i;else{if(!(r.documentElement.attributes.length>0&&null!==r.documentElement.attributes.getNamedItem(o)))return;r.documentElement.attributes.getNamedItem(o).value=i}var l=(new XMLSerializer).serializeToString(r);this.documentHelper.customXmlData.set(e,l)}},e.prototype.insertText=function(e){(0,a.isNullOrUndefined)(e)||""===e||this.owner.isReadOnly||"ReadOnly"===this.documentHelper.protectionType&&!this.selection.isSelectionInEditRegion()||"CommentsOnly"===this.documentHelper.protectionType&&this.owner.isReadOnly||(this.isInsertingText=!0,this.insertTextInternal(e,!1),this.isInsertingText=!1)},e.prototype.insertTextInternal=function(e,t,i,n,r){if(e.indexOf("\r")>=0||e.indexOf("\n")>=0)"\r"===e||"\n"===e||"\r\n"===e?this.onEnter():(this.isInsertText=!0,this.pasteContents(e),this.isInsertText=!1);else{if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){if(!(D=this.selection.currentFormField).formFieldData.enabled)return;var o=this.getFieldResultText(D),s=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");o.length>0&&""===o.replace(s,"")&&(o="",this.selection.selectFieldInternal(D));var l=D.formFieldData.maxLength;if(0!==l&&o.length>=l)return}t&&(this.documentHelper.layout.isReplaceAll=!(0,a.isNullOrUndefined)(n)&&!n);var d=this.documentHelper.owner.selection.currentContentControl;!(0,a.isNullOrUndefined)(d)&&d.contentControlProperties.hasPlaceHolderText&&(this.documentHelper.selection.selectContentInternal(d),d.contentControlProperties.hasPlaceHolderText=!1);var h,c=this.documentHelper.selection,p=!0,u=!1;i=this.owner.enableTrackChanges&&(0,a.isNullOrUndefined)(i)?"Insertion":i;var g=this.checkAndRemoveComments(t);this.isListTextSelected(),this.documentHelper.isBookmarkInserted&&!c.isEmpty&&c.bookmarks.length>0&&this.extendSelectionToBookmarkStart();var m=!1;if(c.isEmpty){var f=c.start.isAtParagraphStart,v=c.end.isAtParagraphEnd;if(f||v){var y=(B=c.start.currentWidget.getInline(c.start.offset,0)).element;if(y&&y instanceof id&&"Block"===y.contentControlWidgetType&&y.reference&&y.paragraph!==y.reference.paragraph&&(this.initComplexHistory("Insert"),m=!0,this.onEnter(),f)){var w=y.paragraph.previousWidget;w instanceof Rl&&w.isEmpty()&&c.moveToPreviousParagraph()}}}if(((0,a.isNullOrUndefined)(i)||"Insertion"===i)&&(this.initHistory("Insert"),!(0,a.isNullOrUndefined)(this.editorHistory)&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedText=e,"FormFieldsOnly"===this.documentHelper.protectionType))){var b=this.documentHelper.selection.getCurrentFormField();b&&b instanceof _l&&b.formFieldData&&b.formFieldData instanceof Xl&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=b,this.editorHistory.currentBaseHistoryInfo.dropDownIndex=b.formFieldData.selectedIndex)}var C=this.selection.getParagraphInfo(c.start),x=C.paragraph.paragraphFormat;c.editPosition=c.getHierarchicalIndex(C.paragraph,C.offset.toString());var I=c.start.paragraph.paragraphFormat.bidi;if(!c.isEmpty&&!c.isImageSelected||this.documentHelper.isListTextSelected&&"List"===c.contextType){c.isSkipLayouting=!0,c.skipFormatRetrieval=!0;var k=void 0,F=void 0,P=0,S=0;if(this.owner.enableTrackChanges&&(this.selection.start.isExistBefore(this.selection.end)?(F=this.selection.getParagraphInfo(c.end),k=this.selection.end.clone()):(F=this.selection.getParagraphInfo(c.start),k=this.selection.start.clone()),S=F.paragraph.getLength(),P=F.offset-1===S?F.offset-1:F.offset,this.skipReplace=!0),(p=this.removeSelectedContents(c))&&(this.updateInsertPosition(),u=!0),this.skipReplace=!1,!(0,a.isNullOrUndefined)(k)&&this.owner.searchModule&&this.owner.searchModule.isRepalceTracking)this.owner.searchModule.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(k);else if(P>0&&P<=S){var T=F.paragraph.getLength();S!==T&&(P-=S-T),this.setPositionParagraph(F.paragraph,P,!0)}c.skipFormatRetrieval=!1,c.isSkipLayouting=!1}else!c.isEmpty||this.documentHelper.isListTextSelected||t||(this.documentHelper.isTextInput=!0);(C=this.selection.getParagraphInfo(c.start)).paragraph.paragraphFormat.copyFormat(x);var H=this.documentHelper.textHelper.containsSpecialCharAlone(e);if(p){if(c.owner.isShiftingEnabled=!0,u||this.updateInsertPosition(),(h=c.start).paragraph.isEmpty()){var E=new Zl,N=this.copyInsertFormat(h.paragraph.characterFormat,!0);E.characterFormat.copyFormat(N),E.text=e;var W=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi;if(E.characterFormat.bidi=W,N.bidi=W,E.isRightToLeft=W,E.line=h.paragraph.childWidgets[0],E.margin=new El(0,0,0,0),E.line.children.push(E),this.setCharFormatForCollaborativeEditing(E.characterFormat),this.owner.enableTrackChanges){if(E.paragraph.characterFormat.revisions.length>0){var O=this.getMatchedRevisionsToCombine(E.paragraph.characterFormat.revisions,i);O.length>0&&this.mapMatchedRevisions(O,E.paragraph.characterFormat,E,!0)}this.checkToCombineRevisionWithPrevPara(E,i)||0!==E.revisions.length||this.insertRevision(E,i)}("Center"===h.paragraph.paragraphFormat.textAlignment||"Right"===h.paragraph.paragraphFormat.textAlignment||"Justify"===h.paragraph.paragraphFormat.textAlignment&&h.paragraph.paragraphFormat.bidi)&&-1===h.paragraph.paragraphFormat.listFormat.listId&&(h.paragraph.x=h.paragraph.clientX,h.paragraph.clientX=void 0,h.paragraph.hasOwnProperty("absoluteXPosition")&&delete h.paragraph.absoluteXPosition),E instanceof Zl&&E.text.length>90&&Pa.splitWordByMaxLength(E,E.line),this.documentHelper.layout.reLayoutParagraph(h.paragraph,0,0)}else{var B,L=0,D=(B=h.currentWidget.getInline(h.offset,L,I,!t,this.documentHelper.owner.isSpellCheck)).element;L=B.index,D.ischangeDetected=!0,!D.paragraph.isInsideTable&&D instanceof td&&1===D.bookmarkType&&!(0,a.isNullOrUndefined)(D.properties)&&D.properties.hasOwnProperty("isAfterParagraphMark")&&delete D.properties.isAfterParagraphMark,D instanceof Zl&&" "!==e&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellCheckerModule.removeErrorsFromCollection({element:D,text:D.text}),t||(D.ignoreOnceItems=[])),D.canTrigger&&D.text.length<=1&&(D.canTrigger=!1);N=this.copyInsertFormat(D.characterFormat,!0),W=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,this.documentHelper.textHelper.getRtlLanguage(e).id;var R=0,M=!1,A=!1;if(D instanceof Zl&&(R=this.documentHelper.textHelper.getRtlLanguage(D.text).id,M=this.documentHelper.textHelper.getRtlLanguage(D.text).isRtl,A=this.documentHelper.textHelper.containsSpecialCharAlone(e)),(!W&&D.characterFormat.bidi&&(0!==R||A&&M)||" "===e&&this.selection.characterFormat.bidi)&&(W=!0),!W&&this.documentHelper.owner.isSpellCheck||(N.bidi=W),this.setCharFormatForCollaborativeEditing(N),(!this.documentHelper.owner.isSpellCheck||" "!==e&&" "!==D.text)&&!(D instanceof id)&&N.isSameFormat(D.characterFormat)&&this.canInsertRevision(D,i)||""===e.trim()&&!W&&D.characterFormat.bidi||M&&N.isSameFormat(D.characterFormat)&&H)this.insertTextInline(D,c,e,L),this.setCharFormatForCollaborativeEditing(D.characterFormat);else{var U=new Zl;U.text=e,U.line=D.line,U.isRightToLeft=M,U.characterFormat.copyFormat(N),!(0,a.isNullOrUndefined)(D)&&D.contentControlProperties&&(U.contentControlProperties=D.contentControlProperties),this.setCharFormatForCollaborativeEditing(U.characterFormat),D instanceof Yl&&(U.characterFormat.baselineAlignment="Normal");var V=!1,z=D.indexInOwner,q=U.revisions.length;if(L!==D.length||r)if(0!==L||r){if(D instanceof Zl){var _=new Zl;_.line=D.line,_.characterFormat.copyFormat(D.characterFormat),!(0,a.isNullOrUndefined)(D)&&D.contentControlProperties&&(_.contentControlProperties=D.contentControlProperties),_.text=D.text.substring(L),this.owner.enableTrackChanges||this.selection.isInField||this.updateRevisionForSpittedTextElement(D,_),D.text=D.text.slice(0,L),D.isWidthUpdated=!1,this.owner.enableTrackChanges?(V=this.checkToMapRevisionWithInlineText(D,L,U,W,i))||U.revisions.length>q?this.copyElementRevision(D,_,!0):U.revisions.length===q&&(this.updateRevisionForSpittedTextElement(D,_),this.insertRevision(U,i)):this.selection.isInField&&(this.copyElementRevision(D,_,!1),this.updateElementInFieldRevision(D,U,D.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellCheckerModule.updateSplittedElementError(D,_),""!==_.text&&D.line.children.splice(z+1,0,_)}V||D.line.children.splice(z+1,0,U)}else this.owner.enableTrackChanges&&((V=this.checkToMapRevisionWithInlineText(D,L,U,W,i))||0!==U.revisions.length||this.checkToMapRevisionWithPreviousNode(D.previousNode,U,W,i)),V||(D.line.children.splice(z,0,U),this.checkToCombineRevisionsinBlocks(U,q===U.revisions.length,!0,i));else{var j;j=z+1,!this.owner.enableTrackChanges||D instanceof td||(V=this.checkToMapRevisionWithInlineText(D,L,U,W,i))||U.revisions.length!==q||(V=null!=D.nextNode&&1==D.nextNode.revisions.length?this.checkToMapRevisionWithNextNode(D.nextNode,U,W,i):1==D.paragraph.characterFormat.revisions.length&&"Deletion"==D.paragraph.characterFormat.revisions[0].revisionType?this.checkToMapRevisionWithNextNode(D.nextNode,U,W,i,D.paragraph):this.checkToMapRevisionWithNextNode(D.nextNode,U,W,i)),V||(D.line.children.splice(j,0,U),this.checkToCombineRevisionsinBlocks(U,q===U.revisions.length,!0,i))}U instanceof Zl&&U.text.length>90&&Pa.splitWordByMaxLength(U,U.line),((0,a.isNullOrUndefined)(i)||"Deletion"!==i||h.paragraph.isLayouted)&&this.documentHelper.layout.reLayoutParagraph(h.paragraph,D.line.indexInOwner,0),D instanceof Zl&&-1!==D.line.children.indexOf(D)&&""===D.text&&D.line.children.splice(D.line.children.indexOf(D),1)}}!(0,a.isNullOrUndefined)(d)&&d.contentControlProperties.isTemporary&&this.removeContentControl(),this.documentHelper.layout.allowLayout=!0,this.setPositionParagraph(C.paragraph,C.offset+e.length,!0),this.updateEndPosition(),(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.documentHelper.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),!(0,a.isNullOrUndefined)(i)&&"Insertion"!==i||this.isFieldOperation||this.reLayout(c),m&&this.editorHistory&&this.editorHistory.updateComplexHistory(),this.documentHelper.isTextInput=!1}if(this.updateXmlMappedContentControl(),!t&&p&&(" "===e||"\t"===e||"\v"===e)){var G=!1;if("\v"===e||this.isRemoteAction||(G=this.checkAndConvertList(c,"\t"===e)),!G){if(!(0,a.isNullOrUndefined)(c.getHyperlinkField()))return;this.checkAndConvertToHyperlink(c,!1)}}this.updateHistoryForComments(g)}},e.prototype.extendSelectionToBookmarkStart=function(){if(this.documentHelper.bookmarks.length>0){var e=this.selection.start;this.selection.end;this.selection.isForward||(e=this.selection.end,this.selection.start);for(var t=void 0,i=this.selection.bookmarks,n=0;n<i.length;n++)if(t=this.documentHelper.bookmarks.get(i[n]),this.selection.isElementInSelection(t.reference,!1)&&!this.selection.isElementInSelection(t,!0)){var r=t.line.paragraph,o=this.selection.getParagraphInfo(e);if(r.equals(o.paragraph)){var s=t.line.getOffset(t,t.bookmarkType);t.line===e.currentWidget&&o.offset===s+1&&e.offset--}}}},e.prototype.updateElementInFieldRevision=function(e,t,i,n){for(var r=0;r<i.length;r++){var o=i[r],s=o.range.indexOf(e);o.range.splice(n?s+1:s,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}},e.prototype.retrieveFieldResultantText=function(e){var t="";if(1===e.fieldType){var i=e.previousElement;for((0,a.isNullOrUndefined)(i)&&0===e.indexInOwner&&!(0,a.isNullOrUndefined)(e.line)&&!(0,a.isNullOrUndefined)(e.line.previousLine)&&e.line.previousLine.children[e.line.previousLine.children.length-1]instanceof Zl&&(i=e.line.previousLine.children[e.line.previousLine.children.length-1]);!(0,a.isNullOrUndefined)(i)&&i instanceof Zl;)t=i.text+t,i=(0,a.isNullOrUndefined)(i.previousNode)?void 0:i.previousNode.previousValidNodeForTracking}return t},e.prototype.checkToCombineRevisionsinBlocks=function(e,t,i,n){if(t&&this.owner.enableTrackChanges&&!(e instanceof td||e instanceof Bd||e instanceof vd||e instanceof fd)){(i?this.combineRevisionWithNextPara(e,n):this.combineRevisionWithPrevPara(e,n))||this.insertRevision(e,n)}},e.prototype.checkToMapRevisionWithNextNode=function(e,t,i,n,r){if(!(0,a.isNullOrUndefined)(r)&&1==r.characterFormat.revisions.length){var o=r.characterFormat;return!(0,a.isNullOrUndefined)(o)&&this.checkToMapRevisionWithInlineText(void 0,0,t,i,n,o)}if((0,a.isNullOrUndefined)(e))return!1;var s=e.nextValidNodeForTracking;return!(0,a.isNullOrUndefined)(s)&&this.checkToMapRevisionWithInlineText(s,0,t,i,n)},e.prototype.checkToMapRevisionWithPreviousNode=function(e,t,i,n){if((0,a.isNullOrUndefined)(e))return!1;var r=e.previousValidNodeForTracking;return!(0,a.isNullOrUndefined)(r)&&this.checkToMapRevisionWithInlineText(r,r.length,t,i,n)},e.prototype.checkToMapRevisionWithInlineText=function(e,t,i,n,r,o){if((0,a.isNullOrUndefined)(o)){if(!(0,a.isNullOrUndefined)(e))if("Deletion"===r&&this.updateLastElementRevision(i),e.length===t&&null!=e.previousValidNodeForTracking){if(t=(e=e.previousValidNodeForTracking).length,e.revisions.length>0)return this.applyMatchedRevisionInorder(e,i,t,!1,n,r)}else if(0===t&&(e=e.nextValidNodeForTracking,!(0,a.isNullOrUndefined)(e)&&e.revisions.length>0))return this.applyMatchedRevisionInorder(e,i,t,!0,n,r)}else if("Deletion"===r&&this.updateLastElementRevision(i),!(0,a.isNullOrUndefined)(o)&&o.revisions.length>0)return this.applyMatchedRevisionInorder(void 0,i,t,!0,n,r,o);return!1},e.prototype.combineElementRevisions=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++){var o=t.revisions[i];-1===n.range.indexOf(t)&&o.revisionType===n.revisionType&&o.author===n.author&&(t.revisions.splice(r,1),n.range.push(t),t.revisions.splice(r,0,n),this.owner.trackChangesPane.updateCurrentTrackChanges(n))}},e.prototype.applyMatchedRevisionInorder=function(e,t,i,n,r,o,s){var l;return!(0,a.isNullOrUndefined)(s)&&(0,a.isNullOrUndefined)(e)?((l=this.getMatchedRevisionsToCombine(s.revisions,o)).length>0&&this.mapMatchedRevisions(l,s,t,n),!1):((l=this.getMatchedRevisionsToCombine(e.revisions,o)).length>0&&this.mapMatchedRevisions(l,e,t,n),!1)},e.prototype.copyElementRevision=function(e,t,i){if(!this.isTrackingFormField)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e);t.revisions.splice(0,0,r),r.range.splice(o+(i?2:1),0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},e.prototype.mapMatchedRevisions=function(e,t,i,n){for(var r=0;r<e.length;r++){var o=e[r];if(!this.isRevisionAlreadyIn(i,o)){i.revisions.splice(0,0,o),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&0===this.editorHistory.currentBaseHistoryInfo.markerData.length&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,o)),i instanceof Yl&&this.insertRevisionForFootnoteWidget(i,o);var s=o.range.indexOf(t);o.range.splice(n?s:s+1,0,i),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}}},e.prototype.isRevisionAlreadyIn=function(e,t){if(e.revisions.length>0)for(var i=0;i<e.revisions.length;i++){if(e.revisions[i].revisionID===t.revisionID)return!0}return!1},e.prototype.getMatchedRevisionsToCombine=function(e,t){for(var i=[],n=0;n<e.length;n++)this.isRevisionMatched(e[n],t)&&i.push(e[n]);return i},e.prototype.decideInlineForTrackChanges=function(e,t){var i=!1;if(this.owner.enableTrackChanges&&!this.canInsertRevision(e,t)){var n=e.nextValidNodeForTracking;!(0,a.isNullOrUndefined)(n)&&this.canInsertRevision(n,t)&&(e=n,i=!0)}return{element:e,isMatched:i}},e.prototype.insertIMEText=function(e,t){if(this.documentHelper.lastComposedText!==e||!t){var i=this.selection.getParagraphInfo(this.selection.start),n=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());this.insertText(e),this.documentHelper.lastComposedText=e;var r=this.selection.start;this.setPositionForCurrentIndex(r,n);var o=new ac(this.owner);o.setPositionForLineWidget(r.currentWidget,r.offset+e.length),this.owner.enableTrackChanges?(t||this.selection.start.setPositionInternal(this.selection.end),this.selection.end.updatePhysicalPosition(!0)):this.selection.selectPosition(t?r:o,o)}},e.prototype.insertSectionBreak=function(e,t){(0,a.isNullOrUndefined)(e)&&(e=n.NewPage);var i=this.documentHelper.selection;(0,a.isNullOrUndefined)(i)||this.owner.isReadOnlyMode||i.start.paragraph.isInHeaderFooter||(e===n.Continuous?this.initHistory("SectionBreakContinuous"):this.initHistory("SectionBreak"),i.isEmpty||i.selectContent(i.isForward?i.start:i.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),e===n.Continuous?(this.documentHelper.layout.isSectionBreakCont=!0,this.insertSection(i,!0,void 0,!0,void 0,t)):this.insertSection(i,!0,void 0,void 0,!0,t),this.updateEndPosition(),this.reLayout(i,!0),this.layoutWholeDocument(!0),this.documentHelper.layout.isSectionBreakCont=!1)},e.prototype.combineRevisionWithBlocks=function(e,t){if(this.owner.enableTrackChanges&&!(0,a.isNullOrUndefined)(e)){for(;e instanceof td||e instanceof Bd||e instanceof md;)e=e.nextElement;if(!(0,a.isNullOrUndefined)(e)){var i=e instanceof Rl?e.previousRenderedWidget:e.paragraph.previousRenderedWidget;if(e instanceof Zl&&0===e.paragraph.firstChild.children[0].revisions.length&&(i=void 0),!(i instanceof Al)){var n,r;if(n=e instanceof Rl?e.characterFormat:e,!(0,a.isNullOrUndefined)(i)&&i.characterFormat.revisions.length>0){var o=i.lastChild;if((0,a.isNullOrUndefined)(o)||0===o.children.length)return;for(var s=o.children[o.children.length-1];s instanceof td||s instanceof Bd||s instanceof md;)s=s.previousElement;if(i.isEmpty()&&(s=i.characterFormat),s.revisions.length>0&&this.compareElementRevision(i.characterFormat,n)){var l=n.revisions[n.revisions.length-1];if(this.compareElementRevision(s,n))if(l!==(p=s.revisions[s.revisions.length-1])){var d=p.range.indexOf(s)+1;p.range.filter((function(e){return e instanceof ka}))&&(d+=1),this.clearAndUpdateRevisons(l.range,p,d),this.owner.revisions.remove(l)}}}if(e instanceof Rl)r=e.characterFormat;else{for(o=e.paragraph.lastChild;0==o.children.length&&!(0,a.isNullOrUndefined)(o.previousLine);)o=o.previousLine;e=null==(r=o.children[o.children.length-1])?e:r}var h=e instanceof Rl?e.nextRenderedWidget:e.paragraph.nextRenderedWidget;if(!(h instanceof Al)){if(!(0,a.isNullOrUndefined)(h)){for(var c=h.firstChild.children[0];c instanceof td||c instanceof Bd||c instanceof md;)c=c.nextElement;if(h.isEmpty()&&(c=h.characterFormat),(0,a.isNullOrUndefined)(c))return;if(c.revisions.length>0){var p,u=c.revisions[c.revisions.length-1];if(this.compareElementRevision(n,c))if(this.compareElementRevision(n,c))u!==(p=n.revisions[n.revisions.length-1])&&(this.clearAndUpdateRevisons(p.range,u,0,!0),this.owner.revisions.remove(p))}}e instanceof ql&&0===e.revisions.length&&this.insertRevision(e,t)}}}}},e.prototype.checkToCombineRevisionWithNextPara=function(e,t){var i=e.paragraph.nextRenderedWidget;if(i instanceof Al)return!1;if(!(0,a.isNullOrUndefined)(i)&&!i.isEmpty()){for(var n=i.firstChild.children[0];n instanceof td||n instanceof Bd;)n=n.previousElement;if((0,a.isNullOrUndefined)(n))return!1;if(n.revisions.length>0){var r=this.getMatchedRevisionsToCombine(n.revisions,t);if(r.length>0)return this.mapMatchedRevisions(r,n,e,!0),!0}}return!1},e.prototype.checkToCombineRevisionWithPrevPara=function(e,t,i){var n=e instanceof ql?e.paragraph.previousRenderedWidget:e;if(n instanceof Al)return!1;if(!(0,a.isNullOrUndefined)(n)&&n.characterFormat.revisions.length>0){if(!this.isRevisionMatched(n.characterFormat,t))return!1;var r=this.getMatchedRevisionsToCombine(n.characterFormat.revisions,t);if(r.length>0)return this.mapMatchedRevisions(r,n.characterFormat,e instanceof ql?e:i.characterFormat,!1),!0}return!1},e.prototype.combineRevisionWithNextPara=function(e,t){var i=e.line.isLastLine(),n=e.nextNode;return!(!i||!(0,a.isNullOrUndefined)(n))&&this.checkToCombineRevisionWithNextPara(e,t)},e.prototype.combineRevisionWithPrevPara=function(e,t){var i=e.line.isFirstLine(),n=e.previousNode;return!(!i||!(0,a.isNullOrUndefined)(n))&&this.checkToCombineRevisionWithPrevPara(e,t)},e.prototype.removeRevision=function(e){var t=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=t.element;if(t.element.revisions.length>0)for(var n=0;n<i.revisions.length;n++)if(i.revisions[n].revisionType===e.revisionType)for(var r=i.revisions[n],o=r.range.indexOf(i),s=o;o<r.range.length;o++)r.range[s].revisions.splice(n,1),r.range.splice(s,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r)},e.prototype.clearElementRevision=function(e){if(!(0,a.isNullOrUndefined)(e))for(var t=0;t<e.range.length;t++)if(e.range[t]instanceof ql){var i=e.range[t];i.revisions.splice(i.revisions.length-1,1),e.range.splice(t,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e)}},e.prototype.insertRevision=function(e,t,i,n,r,o,s){if(!this.isRemoteAction||!(0,a.isNullOrUndefined)(this.revisionData)||this.documentHelper.owner.parser.isPaste){var l;if(!(0,a.isNullOrUndefined)(this.revisionData)&&this.revisionData.length>0){var d=this.revisionData.pop();i=d.author,n=d.date,l=d.revisionId}(0,a.isNullOrUndefined)(s)||(l=s),i=(0,a.isNullOrUndefined)(i)?this.owner.currentUser?this.owner.currentUser:"Guest user":i;var h=(0,a.isNullOrUndefined)(n)?Pa.getUtcDate():n;if(e instanceof ql&&!(0,a.isNullOrUndefined)(e.line)&&e.line.paragraph.associatedCell||e instanceof ka&&e.ownerBase instanceof Rl&&e.ownerBase.associatedCell){var c=void 0;if(e instanceof ql?c=e.line.paragraph.associatedCell:e instanceof ka&&(c=e.ownerBase.associatedCell),c.ownerRow.rowFormat.revisions.length>0){var p=c.ownerRow.rowFormat,u=this.getMatchedRevisionsToCombine(p.revisions,t);if(u.length>0){!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&0===this.editorHistory.currentBaseHistoryInfo.markerData.length&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,u[0]));for(var g=0;g<u.length;g++)e.revisions.splice(0,0,u[g]),u[g].range.push(e);return}}}var m=new xa(this.owner,i,h);return m.revisionType=t,this.owner.enableCollaborativeEditing&&this.isRemoteAction&&!(0,a.isNullOrUndefined)(l)&&""!=l?m.revisionID=l:m.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),this.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(this.getRevision(m.revisionID))&&(m=this.getRevision(m.revisionID)),!(0,a.isNullOrUndefined)(r)&&r.length>0&&this.clearAndUpdateRevisons(r,m,r.indexOf(e)),(0,a.isNullOrUndefined)(e)||(-1===e.revisions.indexOf(m)&&e.revisions.push(m),(0,a.isNullOrUndefined)(r)?m.range.push(e):-1===m.range.indexOf(e)&&m.range.splice(0,0,e)),this.isRemoteAction&&this.documentHelper.owner.parser.isPaste?this.remotePasteRevision.push(m):m.range.length>0&&this.updateRevisionCollection(m),(0,a.isNullOrUndefined)(e)||(e instanceof Yl&&this.insertRevisionForFootnoteWidget(e,m),this.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&!o&&this.editorHistory.currentBaseHistoryInfo.markerData.splice(0,0,this.getMarkerData(e,void 0,m))),m}},e.prototype.insertRevisionForFootnoteWidget=function(e,t){var i=e.bodyWidget.childWidgets;this.skipFootNoteDeleteTracking=!0,this.footnoteRevision=t;for(var n=0;n<i.length;n++)this.insertRevisionForBlock(i[n],t.revisionType,!1,t);this.footnoteRevision=void 0,this.skipFootNoteDeleteTracking=!1},e.prototype.clearAndUpdateRevisons=function(e,t,i,n){for(var r=0,o=0;o<e.length;o++)if(e[o]instanceof ql||e[o]instanceof ka){var s=e[o],a=!1;if(s instanceof Zl&&""===s.text){s.revisions.splice(s.revisions.length-1,1);continue}s.revisions[s.revisions.length-1].range===e&&(s.revisions[s.revisions.length-1].range.splice(s.revisions.length-1,1),a=!0,this.owner.trackChangesPane.updateCurrentTrackChanges(s.revisions[s.revisions.length-1])),s.revisions.splice(s.revisions.length-1,1),s.revisions.push(t),t.range.splice(n?r:i+r,0,s),this.owner.trackChangesPane.updateCurrentTrackChanges(t),a&&o--,r++}},e.prototype.splitRevisionByElement=function(e,t){if(e.revisions.length>0){var i=t.range,n=i.indexOf(e);return t.range=i.splice(0,n+1),this.owner.trackChangesPane.updateCurrentTrackChanges(t),i}},e.prototype.updateRevisionForSpittedTextElement=function(e,t){!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.splittedRevisions=[]);for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=this.splitRevisionByElement(e,n);t&&t instanceof Zl&&""===t.text&&(t=void 0);var o=this.insertRevision(t,n.revisionType,n.author,n.date,r,!0);this.isRemoteAction||this.editorHistory.currentBaseHistoryInfo.splittedRevisions.push(this.getMarkerData(void 0,void 0,this.getRevision(o.revisionID)))}},e.prototype.getRevision=function(e){for(var t=0;t<this.owner.documentHelper.revisionsInternal.length;t++){var i=this.owner.documentHelper.revisionsInternal.keys[t];if(i===e)return this.owner.documentHelper.revisionsInternal.get(i)}},e.prototype.isRevisionMatched=function(e,t){var i=this.owner.currentUser?this.owner.currentUser:"Guest user";if(e instanceof xa){if(((0,a.isNullOrUndefined)(t)||t===e.revisionType)&&e.author===i)return!0}else if(e.revisions.length>0)for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n];if(((0,a.isNullOrUndefined)(t)||t===r.revisionType)&&r.author===i)return!0}return!1},e.prototype.compareElementRevision=function(e,t){if(0===e.revisions.length||0===t.revisions.length)return!1;for(var i=0;i<e.revisions.length;i++)for(var n=e.revisions[i],r=0;r<t.revisions.length;r++)if(n.author===t.revisions[r].author&&n.revisionType===t.revisions[r].revisionType)return!0;return!1},e.prototype.canInsertRevision=function(e,t){var i=(0,a.isNullOrUndefined)(t)?"Insertion":t;return"Deletion"!==i&&(this.owner.enableTrackChanges?this.isRevisionMatched(e,i):!(e.revisions.length>0))},e.prototype.insertRevisionAtEnd=function(e,t,i){return!(t instanceof td||t instanceof Bd||t instanceof vd||t instanceof fd)&&(e=e.previousValidNodeForTracking,!(0,a.isNullOrUndefined)(e)&&this.insertRevisionAtPosition(e,t,!0,i))},e.prototype.insertRevisionAtPosition=function(e,t,i,n){var r=t.revisions.length,o=this.checkToMapRevisionWithInlineText(e,i?e.length:0,t,!1,n);return i?o||t.revisions.length!==r||(o=this.checkToMapRevisionWithNextNode(e.nextNode,t,!1,n)):o||t.revisions.length!==r||(o=this.checkToMapRevisionWithPreviousNode(e.previousNode,t,!1,n)),o},e.prototype.insertRevisionAtBegining=function(e,t,i){return!(t instanceof td||t instanceof Bd||t instanceof vd||t instanceof fd)&&(e=e.nextValidNodeForTracking,!(0,a.isNullOrUndefined)(e)&&this.insertRevisionAtPosition(e,t,!1,i))},e.prototype.splitRevisionForSpittedElement=function(e,t){for(var i=e.revisions.length-1;i>=0;i--){var n=e.revisions[i],r=this.splitRevisionByElement(e,n);this.insertRevision(t,n.revisionType,n.author,n.date,r)}},e.prototype.combineElementRevisionToPrevNxt=function(e){e.revisions.length>0&&e.nextNode instanceof ql&&e.nextNode.revisions.length>0&&this.combineElementRevision(e.revisions,e.nextNode.revisions)},e.prototype.combineElementRevision=function(e,t,i){for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++){var o=e[n],s=t[r];if(o===s)break;if(o.author===s.author&&o.revisionType===s.revisionType){for(var l=s.range.length,d=0;d<l;d++){var h=s.range[0];h.revisions.splice(h.revisions.indexOf(s),1),s.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(s);var c=-1;if(i)if(h instanceof Zl&&0===h.indexInOwner&&0===h.line.indexInOwner&&!(0,a.isNullOrUndefined)(h.paragraph.previousWidget)&&h.paragraph.previousWidget instanceof Rl)c=o.range.indexOf(h.paragraph.previousWidget.characterFormat);else if(h instanceof Zl&&0!==h.indexInOwner&&!(0,a.isNullOrUndefined)(h.previousElement))c=o.range.indexOf(h.previousElement);else if(h instanceof ka&&!h.ownerBase.isEmpty()){var p=h.ownerBase.lastChild.children[h.ownerBase.lastChild.children.length-1];c=o.range.indexOf(p)}-1!==c?o.range.splice(c+1,0,h):i?o.range.splice(d,0,h):o.range.push(h);var u=void 0;(0,a.isNullOrUndefined)(o)||(u=this.owner.trackChangesPane.changes.get(o)),(0,a.isNullOrUndefined)(u)&&o.range.length>0&&this.updateRevisionCollection(o),this.owner.trackChangesPane.updateCurrentTrackChanges(o),h.revisions.push(o)}0===s.range.length&&(this.owner.revisions.remove(s),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.removeMarkerInfoRevision(s.revisionID,this.editorHistory.currentBaseHistoryInfo.markerData))}}},e.prototype.removeMarkerInfoRevision=function(e,t){for(var i=0;i<t.length;i++)(0,a.isNullOrUndefined)(t[i].revisionId)||t[i].revisionId!==e||t.splice(t.indexOf(t[i]),1)},e.prototype.combineRevisions=function(e,t,i){if(this.owner.enableTrackChanges){var n=this.selection.getLineInfo(e,t.offset).line.getInline(t.offset,0).element;if(n.revisions.length>0&&this.isRevisionMatched(n,"Insertion")){var r=n.nextElement;if(!(0,a.isNullOrUndefined)(r)&&r.revisions.length>0){var o=n.revisions[n.revisions.length-1],s=r.revisions[r.revisions.length-1].range;o!==r.revisions[r.revisions.length-1]&&this.clearAndUpdateRevisons(s,o,o.range.indexOf(n)+1)}}}},e.prototype.insertRevisionForBlock=function(e,t,i,n,r,o,s){var l=!1;if(0===e.childWidgets.length||!this.owner.enableTrackChanges)return l;if("Deletion"!==t||this.editorHistory.isUndoing){var d=!1;if((0,a.isNullOrUndefined)(n)){var h=this.owner.currentUser?this.owner.currentUser:"Guest user";(n=new xa(this.owner,h,Pa.getUtcDate())).revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),n.revisionType=t}for(T=0;T<e.childWidgets.length;T++){var c=e.childWidgets[T].children;if(0===c.length&&!(0,a.isNullOrUndefined)(e.containerWidget)){var p=e.containerWidget.childWidgets.indexOf(e),u=void 0;if(p>0&&(u=e.containerWidget.childWidgets[p-1]),!(0,a.isNullOrUndefined)(u)&&u instanceof Rl&&u.characterFormat.revisions.length>0&&this.isRevisionMatched(u.characterFormat,t)){var g=this.getMatchedRevisionsToCombine(u.characterFormat.revisions,t);g.length>0&&(this.mapMatchedRevisions(g,u.characterFormat,e.characterFormat,!1),d=!0,n=void 0)}}for(var m=0;m<c.length;m++)if(0!==m||i)c[m].revisions.push(n),n.range.push(c[m]);else{var f=c[T].revisions.length;this.checkToCombineRevisionsinBlocks(c[T],!0,!1,"Insertion"),c[T].revisions.length>f?n=c[T].revisions[c[T].revisions.length-1]:(c[m].revisions.push(n),n.range.push(c[m]))}}d||(e.characterFormat.revisions.push(n),n.range.push(e.characterFormat)),(0,a.isNullOrUndefined)(n)||(this.owner.trackChangesPane.updateCurrentTrackChanges(n),this.updateRevisionCollection(n))}else{var v=this.selection.editPosition,y=this.selection.start.clone(),w=this.selection.end.clone();this.documentHelper.layout.clearListElementBox(e);var b=e==this.getLastParaForBodywidgetCollection(e),C=this.selection.getNextParagraphBlock(e),x=this.selection.getParagraphInfo(this.selection.start),I=this.selection.getParagraphInfo(this.selection.end),k=this.selection.getHierarchicalIndex(x.paragraph,x.offset.toString()),F=this.selection.getHierarchicalIndex(I.paragraph,I.offset.toString()),P=!1,S=!1;e.isInsideTable&&e==this.selection.getLastParagraph(e.associatedCell)&&(b=!0),b||(0,a.isNullOrUndefined)(C)&&e.isEmpty()||o||(S=!0),S&&((0,a.isNullOrUndefined)(C)||C.isInsideTable||e.bodyWidget.sectionIndex===C.bodyWidget.sectionIndex||this.addRemovedNodes(e.bodyWidget),(0,a.isNullOrUndefined)(this.owner.editorHistoryModule)||(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentBaseHistoryInfo)||this.owner.editorHistoryModule.currentBaseHistoryInfo.recordInsertRevisionDeletetion(e),s||(this.addRemovedNodes(e.clone()),P=this.handleDeleteParaMark(e,void 0)));for(var T=e.childWidgets.length-1;T>-1;T--){var H=e.childWidgets[T];this.removeContent(H,0,this.documentHelper.selection.getLineLength(H),void 0,!!s||!o&&!b)}S&&(s&&(P=this.handleDeleteParaMark(e,void 0)),P&&e.isEmpty()&&(l=!0,this.removeBlock(e))),(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(e.isEmpty()&&this.selection.end.paragraph===e&&b?this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex=this.selection.endOffset:P&&(this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex=void 0));for(var E=e.lastChild;0==E.children.length&&!(0,a.isNullOrUndefined)(E.previousLine);)E=E.previousLine;if(E.children.length>0){var N=E.children[E.children.length-1];this.combineElementRevision(e.characterFormat.revisions,N.revisions,!s)}if(this.selection.editPosition=v,this.selection.start.setPositionInternal(y),this.selection.end.setPositionInternal(w),this.removeEmptyLine(e),!r&&!(0,a.isNullOrUndefined)(e.containerWidget)){if(this.documentHelper.layout.reLayoutParagraph(e,0,0),-1===this.selection.start.currentWidget.indexInOwner&&-1!==x.paragraph.indexInOwner){var W=this.selection.getTextPosBasedOnLogicalIndex(k);this.selection.start.setPositionInternal(W)}if(-1===this.selection.end.currentWidget.indexInOwner&&-1!==I.paragraph.indexInOwner){var O=this.selection.getTextPosBasedOnLogicalIndex(F);this.selection.end.setPositionInternal(O)}}}return l},e.prototype.getLastParaForBodywidgetCollection=function(e){var t=e.containerWidget;if(t.containerWidget instanceof Dl)return t.childWidgets[t.childWidgets.length-1];if(e.isInsideTable&&e.associatedCell)return e.associatedCell.lastChild;var i=this.documentHelper.pages[this.documentHelper.pages.length-1],n=i.bodyWidgets[i.bodyWidgets.length-1];return n.childWidgets[n.childWidgets.length-1]},e.prototype.updatePasteRevision=function(){for(var e=0;e<this.remotePasteRevision.length;e++)this.owner.revisions.changes.indexOf(this.remotePasteRevision[e])<0?this.updateRevisionCollection(this.remotePasteRevision[e]):this.owner.trackChangesPane.updateCurrentTrackChanges(this.remotePasteRevision[e]);this.remotePasteRevision=[]},e.prototype.updateRevisionCollection=function(e){var t=!1,i=void 0;if(this.owner.revisions.changes.indexOf(e)<0){if(this.documentHelper.revisionsInternal.containsKey(e.revisionID)||this.documentHelper.revisionsInternal.add(e.revisionID,e),this.owner.revisions.changes.length>0)for(var n=this.owner.selection.isForward?this.owner.selectionModule.start:this.owner.selectionModule.end,r=0;r<this.owner.revisions.changes.length;r++){var o=this.owner.revisions.changes[r].range[0];if(o instanceof ql&&!(0,a.isNullOrUndefined)(o.line)&&o.line.paragraph.bodyWidget){var s=this.owner.revisions.changes[r].range[0];o instanceof _d&&o.paragraph.containerWidget.footNoteReference.revisions.length>0&&(s=o.paragraph.containerWidget.footNoteReference),i=this.selection.getElementPosition(s).startPosition}else if(o instanceof Ca){var l=o.ownerBase,d=l.childWidgets[0];if(0===d.childWidgets.length)for(var h=1;h<l.childWidgets.length;h++)if(l.childWidgets[h].childWidgets.length>0){d=l.childWidgets[h];break}var c=void 0;if(this.selection.getFirstParagraph(d).bodyWidget){var p=this.documentHelper.selection;(0,a.isNullOrUndefined)(p.editPosition)||(c=p.editPosition),this.updateEditPosition(d,p),i=this.selection.getTextPosBasedOnLogicalIndex(p.editPosition),(0,a.isNullOrUndefined)(c)||this.selection.start.paragraph.isInsideTable||(p.editPosition=c)}}else if(o instanceof ka){var u=o.ownerBase;if(u.lastChild&&u.lastChild.paragraph.bodyWidget){var g=u.getLength(),m=new ac(this.owner);m.setPositionParagraph(u.lastChild,g),i=m}}if(this.footnoteRevision===this.owner.revisions.changes[r]){var f=this.owner.revisions.changes.indexOf(this.footnoteRevision);t=!0,this.owner.revisions.changes.splice(f+1,0,e);var v=(b=new gl(this.owner,this.owner.trackChangesPane)).createSingleChangesDiv(e),y=this.owner.trackChangesPane.changes.get(this.footnoteRevision).outerSingleDiv.nextSibling;y?this.owner.trackChangesPane.changesInfoDiv.insertBefore(v,y):this.owner.trackChangesPane.changesInfoDiv.appendChild(v),this.owner.trackChangesPane.revisions.splice(f+1,0,e),this.owner.trackChangesPane.changes.add(e,b),this.owner.trackChangesPane.renderedChanges.add(e,b);break}if(!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(n)){var w=this.selection.start.paragraph.isInsideTable&&this.selection.end.paragraph.isInsideTable&&this.selection.start.paragraph.associatedCell!==this.selection.end.paragraph.associatedCell;if(!(!n.isExistBefore(i)||e.range[0]instanceof Ca||w)){t=!0,this.owner.revisions.changes.splice(r,0,e);var b=new gl(this.owner,this.owner.trackChangesPane);this.owner.trackChangesPane.changesInfoDiv.insertBefore(b.createSingleChangesDiv(e),this.owner.trackChangesPane.changesInfoDiv.children[r+1]),this.owner.trackChangesPane.revisions.splice(r,0,e),this.owner.trackChangesPane.changes.add(e,b),this.owner.trackChangesPane.renderedChanges.add(e,b);break}if(e.range[0]instanceof Ca&&o instanceof Ca&&e.range[0].ownerBase.containerWidget===o.ownerBase.containerWidget&&e.range[0].ownerBase.index===o.ownerBase.index){t=!0,this.owner.revisions.changes.splice(r-e.range[0].ownerBase.indexInOwner,0,e);break}if(!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(n)&&(n.isExistBefore(i)||n.isAtSamePosition(i)||n.paragraph.isInsideTable&&i.paragraph.isInsideTable&&n.paragraph.associatedCell===i.paragraph.associatedCell)){if(o instanceof Ca&&e.range[0]instanceof Ca&&o.ownerBase.containerWidget===e.range[0].ownerBase.containerWidget){if(o.ownerBase.index-1===e.range[0].ownerBase.index){this.owner.revisions.changes.splice(r,0,e),t=!0;break}this.owner.revisions.changes.splice(r+e.range[0].ownerBase.indexInOwner,0,e),t=!0;break}if(e.range[0]instanceof Ca){this.owner.revisions.changes.splice(r,0,e),t=!0;break}}}}if(!(t||(this.owner.revisions.changes.push(e),e.range[0]instanceof Ca))){b=new gl(this.owner,this.owner.trackChangesPane);this.owner.trackChangesPane.changesInfoDiv.appendChild(b.createSingleChangesDiv(e)),this.owner.trackChangesPane.revisions.push(e),this.owner.trackChangesPane.changes.add(e,b),this.owner.trackChangesPane.renderedChanges.add(e,b)}this.documentHelper.updateAuthorIdentity()}},e.prototype.insertSection=function(e,t,i,n,r,o){var s,l,d,h=this.selection.start.paragraph;if(n&&!i&&!h.isInsideTable&&0===e.start.offset&&e.start.currentWidget===h.firstChild&&!(0,a.isNullOrUndefined)(h.previousRenderedWidget)&&h.previousRenderedWidget instanceof Rl&&h.previousRenderedWidget.isEndsWithPageBreak)return this.selection.start.paragraph.bodyWidget.sectionFormat.breakCode="NoBreak",this.selection.start.paragraph.index=0,this.updateNextBlocksIndex(this.selection.start.paragraph,!0),this.updateSectionIndex(this.selection.start.paragraph.bodyWidget.sectionFormat,this.selection.start.paragraph.bodyWidget,!0),this.selection.moveToNextParagraph(),this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,void this.updateInsertPosition();if(s=(0,a.isNullOrUndefined)(o)?this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat():o,e.start.paragraph.isInsideTable){var c=this.documentHelper.layout.getParentTable(e.start.paragraph);c=c.combineWidget(this.owner.viewer);var p=!1;0===e.start.paragraph.associatedCell.rowIndex&&(p=!0);var u=new Rl,g=c.previousRenderedWidget;p?l=c:(l=this.splitTable(c,e.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1),l=l.getSplitWidgets().pop());var m=0;!(0,a.isNullOrUndefined)(g)&&g.bodyWidget.equals(l.bodyWidget)||!p?(m=l.indexInOwner+1,u.index=l.index+1):(m=0,u.index=0),l.containerWidget.childWidgets.splice(m,0,u),u.containerWidget=l.containerWidget,this.updateNextBlocksIndex(u,!0),this.documentHelper.layout.layoutBodyWidgetCollection(u.index,u.containerWidget,u,!1),l=u}else{var f=this.selection.getParagraphInfo(e.start),v=this.selection.getHierarchicalIndex(f.paragraph,f.offset.toString());i||this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset,e.start.paragraph.characterFormat),this.setPositionForCurrentIndex(e.start,v),l=e.start.paragraph.getSplitWidgets().pop(),i&&void 0!==l.previousRenderedWidget&&(l=l.previousRenderedWidget)}d=this.splitBodyWidget(l.bodyWidget,s,l,n,r).firstChild;var y=l.previousWidget;return l instanceof Rl&&l.isEmpty()&&y instanceof Rl&&(l.isSectionBreak=!0,this.documentHelper.layout.reLayoutParagraph(l,0,0)),d instanceof Al&&d.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.containerWidget,d,!1),d instanceof Al&&(d=this.documentHelper.getFirstParagraphInFirstCell(d)),t&&e.selectParagraphInternal(d,!0),d},e.prototype.splitBodyWidget=function(e,t,i,n,r){var o=!0,s=this.documentHelper.layout.moveBlocksToNextPage(i,!0,void 0,n);if((this.editorHistory.isUndoing||this.editorHistory.isRedoing&&!(0,a.isNullOrUndefined)(t.ownerBase))&&(i.bodyWidget.sectionFormat=t),void 0===s.page)s.page=e.page,e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,s);else if(e.page.bodyWidgets.length>1&&void 0!==s.page&&!this.editorHistory.isUndoing){for(var l=s;!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&s!==e.nextRenderedWidget;){var d=e.nextRenderedWidget.page.bodyWidgets.indexOf(e.nextRenderedWidget);s.page.bodyWidgets.push(e.nextRenderedWidget),e.nextRenderedWidget.page.bodyWidgets.splice(d,1)}for(;!(0,a.isNullOrUndefined)(s.nextRenderedWidget);)s.nextRenderedWidget.page=s.page,s=s.nextRenderedWidget;(s=l).sectionFormat=new ga(s),t.numberOfColumns>1&&(this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat),o=!1),s.sectionFormat.breakCode="NewPage"}return n&&(t.numberOfColumns>1&&o?(s.sectionFormat=t,this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat)):(s.sectionFormat=new ga(s),(t.numberOfColumns>1||!(0,a.isNullOrUndefined)(e.page)&&!(0,a.isNullOrUndefined)(e.page.nextPage)&&this.documentHelper.getPageWidth(e.page)!==this.documentHelper.getPageWidth(e.page.nextPage))&&this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat)),s.sectionFormat.breakCode="NoBreak"),r&&(t.numberOfColumns>1&&o?(s.sectionFormat=t,this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat)):(s.sectionFormat=new ga(s),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,s.sectionFormat)),s.sectionFormat.breakCode="NewPage"),this.updateSectionIndex(s.sectionFormat,s,!0),s.sectionFormat.numberOfColumns>1&&this.updateColumnIndex(s,!1),this.editorHistory&&!this.editorHistory.isUndoing&&this.insertRemoveHeaderFooter(s.sectionIndex,!0),this.updateBlockIndex(0,s.firstChild),this.owner.viewer.updateClientArea(s,s.page),s},e.prototype.insertRemoveHeaderFooter=function(e,t){this.documentHelper.headersFooters[e]?this.documentHelper.headersFooters.splice(e,0,{}):this.documentHelper.headersFooters[e]={}},e.prototype.updateBlockIndex=function(e,t){var i,n=t.bodyWidget.sectionIndex;do{i=t.getSplitWidgets();for(var r=0;r<i.length;r++)i[r].index=e;e++,t=i.pop().nextRenderedWidget}while(!(0,a.isNullOrUndefined)(t)&&t.bodyWidget.sectionIndex===n)},e.prototype.updateSectionIndex=function(e,t,i){var n=t.sectionIndex,r=t;do{r.index===n&&e&&(r.sectionFormat=e),i?r.index++:r.index--,r=r.nextRenderedWidget}while(r)},e.prototype.updateColumnIndex=function(e,t){var i=e;do{if(!t&&0===i.columnIndex)break;if(t?i.columnIndex++:i.columnIndex--,!(0,a.isNullOrUndefined)(i.nextRenderedWidget)&&i.sectionIndex!==i.nextRenderedWidget.sectionIndex)break;i=i.nextRenderedWidget}while(i)},e.prototype.checkAndConvertList=function(e,t){var i=e.paragraphFormat.getList();if(!(0,a.isNullOrUndefined)(i)||e.start.paragraph.containerWidget instanceof Dl)return!1;var n=!1,r=!1,o=0,s=e.start.currentWidget.getInline(e.start.offset-1,o),l=s.element;if(o=s.index,!(l instanceof Zl))return!1;for(var d=l,h=d.text.substring(0,o),c=0,p=0;!(0,a.isNullOrUndefined)(d.previousNode);){if(!(d.previousNode instanceof Zl)||"\t"!==d.previousNode.text&&0!==d.previousNode.text.trim().length)return!1;"\t"===d.previousNode.text?c+=36:p=2.5*d.previousNode.text.length,d=d.previousNode}d=l;var u=0,g=h.lastIndexOf("\t");for(u=g>=0?g+1:h.lastIndexOf(" ")+1;d.previousNode instanceof Zl&&0===u;){var m=(d=d.previousNode).text;u=(g=m.lastIndexOf("\t"))>=0?g+1:m.lastIndexOf(" ")+1,h=(h=d.text+h).substring(u)}var f=(h=Pa.trimStart(h)).substring(1,2),v=void 0,y=this.getListLevelPattern(h.substring(0,1));if("None"!==y&&this.checkNumberFormat(f,"Bullet"===y,h)?(v=this.checkNextLevelAutoList(h),n=!0):this.checkLeadingZero(h)?(r=!0,n=!0):(v=this.checkNextLevelAutoList(h),(0,a.isNullOrUndefined)(v)||(n=!0)),!n||"Bullet"!==y||"- "!==l.text||(0,a.isNullOrUndefined)(l.paragraph.previousWidget)||l.paragraph.previousWidget.firstChild.children[0]instanceof md||(n=!1),n){this.initComplexHistory("AutoList");var w=l.paragraph;e.start.setPositionParagraph(w.childWidgets[0],w.childWidgets[0].getOffset(l,o+1)),e.end.setPositionParagraph(w.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1);var b=t?"Tab":"Space";f=r?"%1"+h.substring(h.length-1,h.length):"%1"+f;var C=h.substring(h.length-3,h.length-1);y=r?this.getListLevelPattern(C):y;var x=new Va(void 0);x.listLevelPattern=y,"Bullet"===y?"*"===h?(x.numberFormat=String.fromCharCode(61623),x.characterFormat.fontFamily="Symbol"):"-"===h&&(x.numberFormat="-"):x.numberFormat=f,x.followCharacter=b;var I=e.paragraphFormat.leftIndent;x.paragraphFormat.leftIndent=0!==c||0!==p?I+18+c+p:o>2?I+2.5*(o-2)+18:I>0?I+18:36,x.paragraphFormat.firstLineIndent=-18,!r&&"0"===h.substring(0,1)||"00"===C?x.startAt=0:x.startAt=1,(0,a.isNullOrUndefined)(v)?this.autoConvertList(e,x):e.paragraphFormat.setList(v),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)}return n},e.prototype.checkNextLevelAutoList=function(e){for(var t=this.documentHelper.selection,i=void 0,n=!1,r=t.start.paragraph,o=t.getPreviousParagraphBlock(r);!(0,a.isNullOrUndefined)(o)&&o instanceof Rl;){if(o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId){var s=o.paragraphFormat.listFormat.listLevelNumber;if(n=this.isConvertList(e,o)){this.listLevelNumber=s,this.isAutoList=!0;break}if("*"===e||"-"===e){this.isAutoList=!0,n=!0;break}}o=t.getPreviousParagraphBlock(o,!0)}return n&&(i=this.documentHelper.getListById(o.paragraphFormat.listFormat.listId)),i},e.prototype.isConvertList=function(e,t){var i,n=!1,r=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat,!0),o=r.substring(0,r.length-1),s=e.substring(0,e.length-1);if(r.substring(r.length-1)!==e.substring(e.length-1))n=!1;else if(s.match(/^[0-9]+$/)&&o.match(/^[0-9]+$/))i=parseInt(s,10),parseInt(o,10)!==i&&parseInt(o,10)+1!==i&&parseInt(o,10)+2!==i||(n=!0);else if(s.match(/^[a-zA-Z]+$/)&&o.match(/^[a-zA-Z]+$/))if(o.charCodeAt(0)===e.charCodeAt(0)||o.charCodeAt(0)+1===e.charCodeAt(0)||o.charCodeAt(0)+2===e.charCodeAt(0))n=!0;else if(s.match(/^[MDCLXVImdclxvi]+$/)&&o.match(/^[MDCLXVImdclxvi]+$/)){var a=this.getNumber(o.toUpperCase()),l=this.getNumber(s.toUpperCase());a!==l&&a+1!==l&&a+2!==l||(n=!0)}return n},e.prototype.getNumber=function(e){for(var t={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},i=e.split(""),n=0,r=0;r<i.length;r++){var o=t[i[r]];o<t[i[r+1]]?n-=o:n+=o}return n},e.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},e.prototype.autoConvertList=function(e,t){e.start;e.isForward||e.end;var i=new zh;this.documentHelper.lists.length>0?i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:i.listId=0;var n=new Aa,r=this.documentHelper;r.abstractLists.length>0?n.abstractListId=r.abstractLists[r.abstractLists.length-1].abstractListId+1:n.abstractListId=0,i.abstractListId=n.abstractListId,i.abstractList=n,i.nsid=n.nsid=Pa.generateUniqueId(r.lists),r.abstractLists.push(n),n.levels.push(t),t.ownerBase=n,e.paragraphFormat.setList(i),e.paragraphFormat.listLevelNumber=0},e.prototype.checkNumberFormat=function(e,t,i){if(t)return""===e;var n=i.indexOf(e);return("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(n,i.length-1)},e.prototype.checkLeadingZero=function(e){for(var t,i=!1,n=0;n<=e.length-1;n++){if("0"!==e.charAt(n)){t=n;break}i=!0}var r=void 0;return r="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t),i&&this.checkNumberFormat(r,!1,e)},e.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof Ol||e.containerWidget instanceof Bl?t=e.containerWidget.page:e.containerWidget instanceof Vl&&(t=e.containerWidget.bodyWidget.page),t},e.prototype.insertTextInline=function(e,t,i,n,r){if(e instanceof Zl){if(e.text=Pa.insert(e.text,n,i),e.isWidthUpdated=!1,this.owner.enableTrackChanges){var o=e.revisions[0];(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(void 0,void 0,o)),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}var s=e.line.paragraph,l=s.childWidgets.indexOf(e.line),d=e.line.children.indexOf(e);e instanceof Zl&&e.text.length>90&&Pa.splitWordByMaxLength(e,e.line),!(0,a.isNullOrUndefined)(r)&&r||this.documentHelper.layout.reLayoutParagraph(s,l,d,e.line.paragraph.bidi)}else e instanceof gd?this.insertImageText(e,t,i,n):e instanceof _l?0===e.fieldType?this.insertFieldBeginText(e,t,i,n):2===e.fieldType?this.insertFieldSeparatorText(e,t,i,n):this.insertFieldEndText(e,t,i,n):(e instanceof td||e instanceof vd||e instanceof fd)&&this.insertBookMarkText(e,i)},e.prototype.insertFieldBeginText=function(e,t,i,n){var r=new Zl;r.text=i;var o=e.line.paragraph.childWidgets.indexOf(e.line),s=e.line.children.indexOf(e);this.owner.enableCollaborativeEditing&&this.isRemoteAction&&s++,r.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(s,0,r),r.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,o,s)},e.prototype.insertBookMarkText=function(e,t){var i=new Zl;i.text=t;var n=e.line.paragraph.childWidgets.indexOf(e.line),r=e.line.children.indexOf(e);i.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(r+1,0,i),i.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,n,r)},e.prototype.insertFieldSeparatorText=function(e,t,i,n){var r=t.getPreviousTextInline(e),o=t.getNextTextInline(e),s=new Zl;s.text=i;var l=e.line.children.indexOf(e);if(n===e.length&&l++,(0,a.isNullOrUndefined)(r)&&(0,a.isNullOrUndefined)(o))s.characterFormat.copyFormat(e.line.paragraph.characterFormat);else if((0,a.isNullOrUndefined)(r))s.characterFormat.copyFormat(o.characterFormat);else if(this.owner.enableCollaborativeEditing&&this.isRemoteAction){var d=this.getCharacterFormat(this.selection);s.characterFormat.copyFormat(d)}else s.characterFormat.copyFormat(r.characterFormat);e.line.children.splice(l,0,s),s.line=e.line;var h=e.line.paragraph.childWidgets.indexOf(e.line);this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,h,l)},e.prototype.insertFieldEndText=function(e,t,i,n){var r=new Zl;r.text=i;var o=e.line.children.indexOf(e);r.characterFormat.copyFormat(e.characterFormat),t.isInlineFormFillMode()&&0==n?e.line.children.splice(o,0,r):e.line.children.splice(o+1,0,r),r.line=e.line;var s=e.line.paragraph.childWidgets.indexOf(e.line);if(this.owner.enableTrackChanges){var a=this.documentHelper.textHelper.getRtlLanguage(i).isRtl,l="Insertion",d=this.checkToMapRevisionWithInlineText(e,n,r,a,l);d||0!==r.revisions.length||(d=this.checkToMapRevisionWithNextNode(e.nextNode,r,a,l))}this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,s,o)},e.prototype.insertImageText=function(e,t,i,n){var r=t.getPreviousTextInline(e),o=t.getNextTextInline(e),s=e.line,l=new Zl,d=s.paragraph,h=d.childWidgets.indexOf(s);l.text=i;var c=s.children.indexOf(e);n===e.length&&c++,(0,a.isNullOrUndefined)(r)&&(0,a.isNullOrUndefined)(o)?l.characterFormat.copyFormat(d.characterFormat):(0,a.isNullOrUndefined)(r)?l.characterFormat.copyFormat(o.characterFormat):l.characterFormat.copyFormat(r.characterFormat),s.children.splice(c,0,l),l.line=s,this.documentHelper.layout.reLayoutParagraph(d,h,c)},e.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},e.prototype.checkAndConvertToHyperlink=function(e,t,i){var n,r;if(t)n=(r=i.lastChild.children[i.lastChild.children.length-1]).text;else{var o=0,s=e.start.currentWidget.getInline(e.start.offset-1,o),a=s.element;if(o=s.index,!(a instanceof Zl))return;n=(r=a).text.substring(0,o)}var l=0,d=n.lastIndexOf("\t");for(l=d>=0?d+1:n.lastIndexOf(" ")+1;r.previousElement instanceof Zl&&0===l;){var h=(r=r.previousNode).text;l=(d=h.lastIndexOf("\t"))>=0?d+1:h.lastIndexOf(" ")+1,n=r.text+n}var c=(n=n.substring(l)).toLowerCase(),p=!1;if("file:///"===c.substring(0,8)||"http://"===c.substring(0,7)&&c.length>7||"https://"===c.substring(0,8)&&c.length>8||"www."===c.substring(0,4)&&c.length>4||"\\"===c.substring(0,3)&&c.length>3||"mailto:"===c.substring(0,7)&&c.length>7)p=!0,"www."===c.substring(0,4)&&c.length>4&&(n="http://"+n);else{var u=n.indexOf("@"),g=n.lastIndexOf(".");u>0&&u<g&&g<n.length-1&&(p=!0,n="mailto:"+n)}if(p){var m=new ac(this.documentHelper.owner);m.setPositionParagraph(r.line,r.line.getOffset(r,l));var f=new ac(this.documentHelper.owner);if(t)f.setPositionParagraph(r.line,r.line.getEndOffset());else if(0===e.end.currentWidget.children.length&&0===e.end.offset){var v=e.end.currentWidget.previousLine;f.setPositionParagraph(v,v.getEndOffset())}else f.setPositionParagraph(e.end.currentWidget,e.end.offset-1);this.autoFormatHyperlink(e,n,m,f)}},e.prototype.autoFormatHyperlink=function(e,t,i,n){if(!this.owner.enableCollaborativeEditing||!this.isRemoteAction){this.initComplexHistory("AutoFormatHyperlink");var r=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=o),e.start.setPositionInternal(i),e.end.setPositionInternal(n);var s=this.getCharacterFormat(e),a=new ka;a.copyFormat(s);var l=this.createHyperlinkElement(t,i,n,a);e.start.setPositionParagraph(l.line,l.line.getOffset(l,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),r=this.selection.getParagraphInfo(e.end);var d=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=d,this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!1,this.reLayout(e)):this.updateComplexWithoutHistory(0,o,d)}},e.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},e.prototype.createHyperlinkElement=function(e,t,i,n){var r=this.selection;this.documentHelper.layout.allowLayout=!1,this.documentHelper.layout.isReplaceAll=!0,this.appylingHyperlinkFormat(r);var o=new _l(1);o.characterFormat.copyFormat(n),o.line=r.end.currentWidget,r.start.setPositionInternal(r.end),this.initInsertInline(o),r.start.setPositionInternal(t),r.end.setPositionInternal(r.start);var s=this.insertHyperlinkfield(r,n,e),a=r.start.paragraph.childWidgets.indexOf(s.line),l=s.line.children.indexOf(s);return o.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.isReplaceAll=!1,this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(r.start.paragraph,a,l),o},e.prototype.insertHyperlinkfield=function(e,t,i,n){var r=new _l(0);r.characterFormat.copyFormat(t),r.line=e.start.currentWidget,this.initInsertInline(r);var o=new Zl;o.characterFormat.copyFormat(t),o.text=n?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',o.line=e.start.currentWidget,this.initInsertInline(o);var s=new _l(2);return s.characterFormat.copyFormat(t),s.line=e.start.currentWidget,this.initInsertInline(s),r},e.prototype.unlinkRangeFromRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);r>=0&&(n.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n)),0===n.range.length&&t&&(this.owner.revisions.remove(n),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(n.revisionID)&&(this.documentHelper.revisionsInternal.remove(n.revisionID),this.owner.trackChangesPane.updateTrackChanges()))}this.constructRevisionnsForLink(e,!0)},e.prototype.constructRevisionnsForLink=function(e,t){if(e instanceof _l&&2===e.fieldType&&!(0,a.isNullOrUndefined)(this.editorHistory)&&!(0,a.isNullOrUndefined)(this.editorHistory.historyInfoStack)&&this.editorHistory.historyInfoStack.length>0&&"InsertHyperlink"===this.editorHistory.historyInfoStack[0].action){var i=e.nextElement,n=!1;for((0,a.isNullOrUndefined)(e.fieldEnd)||-1===e.fieldEnd.indexInOwner||(n=!0);!((0,a.isNullOrUndefined)(i)||i instanceof _l&&1===i.fieldType);)t?(this.unlinkRangeFromRevision(i),this.addRemovedRevisionInfo(i,void 0)):n&&i.removedIds.length>0&&this.constructRevisionFromID(i,!0,!1,i.previousElement),(0,a.isNullOrUndefined)(i.nextElement)?!(0,a.isNullOrUndefined)(i.paragraph)&&!(0,a.isNullOrUndefined)(i.paragraph.nextRenderedWidget)&&i.paragraph.nextRenderedWidget instanceof Rl&&!i.paragraph.nextRenderedWidget.isEmpty()?(t?(this.unlinkRangeFromRevision(i.paragraph.characterFormat),this.addRemovedRevisionInfo(i.paragraph.characterFormat,void 0)):n&&i.paragraph.characterFormat.removedIds.length>0&&this.constructRevisionFromID(i.paragraph.characterFormat,!0),i=i.paragraph.nextRenderedWidget.firstChild.children[0]):i=void 0:i=i.nextElement}},e.prototype.unlinkWholeRangeInRevision=function(e,t){var i=t;e.revisions.splice(e.revisions.indexOf(e),1);for(var n=i.range.length,r=0;r<n;r++)i.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&(this.documentHelper.revisionsInternal.remove(i.revisionID),this.owner.trackChangesPane.updateTrackChanges()))},e.prototype.unLinkFieldCharacter=function(e){if(e instanceof _l&&0===e.fieldType&&e.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=e,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldEnd&&(e.fieldEnd.fieldBegin=void 0),e.fieldEnd=void 0),e instanceof _l&&2===e.fieldType)(0,a.isNullOrUndefined)(e.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0);else if(e instanceof _l&&1===e.fieldType&&e.fieldBegin){(0,a.isNullOrUndefined)(this.documentHelper)||(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph);var t=this.documentHelper.fields.indexOf(e.fieldBegin);-1!==t&&this.documentHelper.fields.splice(t,1);var i=this.documentHelper.formFields.indexOf(e.fieldBegin);-1!==i&&this.documentHelper.formFields.splice(i,1),e.fieldBegin.fieldEnd=void 0,e.fieldBegin=void 0}},e.prototype.getCharacterFormat=function(e){return e.start.paragraph.isEmpty()?e.start.paragraph.characterFormat:e.start.currentWidget.getInline(e.start.offset+1,0).element.characterFormat},e.prototype.insertHyperlink=function(e,t,i){(Pa.startsWith(e,"http://")||Pa.startsWith(e,"https://"))&&(e=e.replace(/\s/g,"")),(0,a.isNullOrUndefined)(t)&&(t=e),(0,a.isNullOrUndefined)(i)||(e=e+'" \\o "'+i),this.insertHyperlinkInternal(e,t,this.owner.selectionModule.text!==t,!1)},e.prototype.insertHyperlinkInternal=function(e,t,i,n){var r=this.documentHelper.selection;if(r.start.paragraph.associatedCell===r.end.paragraph.associatedCell&&!this.selection.isPlainContentControl()){var o=r.start,s=r.end;if(r.isForward||(o=r.end,s=r.start),s.offset==s.paragraph.getLength()+1&&s.movePreviousPosition(),i)this.insertHyperlinkInternalInternal(r,e,t,n);else{this.documentHelper.layout.allowLayout=!1;var a=new ac(this.documentHelper.owner);a.setPositionInternal(o);var l=this.getCharacterFormat(r),d=new ka(void 0);d.copyFormat(l),this.initComplexHistory("InsertHyperlink");var h=this.selection.getParagraphInfo(o),c=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString())),this.appylingHyperlinkFormat(r),o.setPositionInternal(s);var p=new _l(1);p.characterFormat.copyFormat(d),p.line=r.end.currentWidget,o.setPositionInternal(s),this.initInsertInline(p),o.setPositionInternal(a),s.setPositionInternal(o);var u=this.insertHyperlinkfield(r,d,e,n);p.linkFieldCharacter(this.documentHelper);var g=r.start.paragraph.childWidgets.indexOf(u.line),m=u.line.children.indexOf(u);this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(r.start.paragraph,g,m);var f=p.line;r.selects(f,f.getOffset(p,p.length),!0),h=this.selection.getParagraphInfo(s);var v=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,c,v)}}},e.prototype.insertHyperlinkInternalInternal=function(e,t,i,n){if(!(0,a.isNullOrUndefined)(e.start)&&!this.editHyperlink(e,t,i)){var r=this.checkAndRemoveComments(),o=this.getCharacterFormat(e);this.initHistory("InsertHyperlink");var s=!0;if(!e.isEmpty){var l=this.owner.enableTrackChanges;this.owner.enableTrackChanges=!1,s=this.removeSelectedContents(e),this.owner.enableTrackChanges=l}if(s){var d=new ka;d.copyFormat(o),this.insertHyperlinkByFormat(e,t,i,d,n)}this.updateHistoryForComments(r)}},e.prototype.insertHyperlinkByFormat=function(e,t,i,n,r){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var o=[],s=new _l(0);!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=s),o.push(s);var l=new Zl;l.text=r?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',o.push(l);var d=new _l(2);o.push(d),(0,a.isNullOrUndefined)(i)||""===i||((l=new Zl).characterFormat.copyFormat(n),l.characterFormat.underline="Single",l.characterFormat.fontColor="#0563c1",l.text=i,o.push(l));var h=new _l(1);o.push(h),s.fieldSeparator=h.fieldSeparator=d,s.fieldEnd=d.fieldEnd=h,d.fieldBegin=h.fieldBegin=s,this.insertElement(o),h.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(s)&&this.documentHelper.fields.push(s),e.selects(h.line,h.line.getOffset(h,h.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},e.prototype.initInsertInline=function(e,t,i){var n=this.selection;this.initHistory("InsertInline"),this.insertInlineInSelection(n,e),this.editorHistory&&this.editorHistory.updateHistory()},e.prototype.insertElementInCurrentLine=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.editHyperlink=function(e,t,i,n){var r=e.getHyperlinkField();if((0,a.isNullOrUndefined)(r))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=(0,a.isNullOrUndefined)(this.editorHistory)||this.editorHistory&&(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo);var o="",s=!1,l=this.getCharacterFormat(e),d=new ka;d.copyFormat(l);var h=void 0;if(!(0,a.isNullOrUndefined)(r.fieldSeparator)){h=r.fieldSeparator;var c=e.getHyperlinkDisplayText(r.fieldSeparator.line.paragraph,r.fieldSeparator,r.fieldEnd,s,d);o=c.displayText,s=c.isNestedField,d=c.format}var p=r.line.getOffset(r,0);if(e.start.setPositionParagraph(r.line,p),p=r.fieldEnd.line.getOffset(r.fieldEnd,1),e.end.setPositionParagraph(r.fieldEnd.line,p),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(e,!0),!s&&o!==i||(0,a.isNullOrUndefined)(h))this.insertHyperlinkByFormat(e,t,i,d,n),this.skipFieldDeleteTracking=!1;else{this.updateInsertPosition();var u=new _l(0);this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=u,this.editorHistory.currentBaseHistoryInfo.isEditHyperlink=!0),u.characterFormat.copyFormat(r.characterFormat),u.line=e.start.currentWidget,this.insertInlineInternal(u);var g=new Zl;g.characterFormat.copyFormat(r.characterFormat),g.text=n?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',g.line=e.start.currentWidget,this.insertInlineInternal(g);var m=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes;this.insertClonedFieldResult(e,m,h),e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.documentHelper),this.skipFieldDeleteTracking=!1;var f=u.line.paragraph,v=u.line.paragraph.childWidgets.indexOf(u.line),y=u.line.children.indexOf(u);this.documentHelper.layout.reLayoutParagraph(f,v,y),p=u.fieldEnd.line.getOffset(u.fieldEnd,1),e.selects(u.fieldEnd.line,p,!0),this.updateEndPosition(),this.reLayout(e,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.insertClonedFieldResult=function(e,t,i){for(var n=!1,r=t.length-1;r>-1;r--){var o=t[r];if(!n){if(i!==o){if(o instanceof Rl&&o===i.line.paragraph){n=!0;var s=void 0;if(r===t.length-1){s=e.start.paragraph;var a=i.line.paragraph;this.getClonedFieldResultWithSel(a,e,i)}else s=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(s,!0);e.selectParagraphInternal(e.getNextParagraphBlock(s),!0)}continue}n=!0}o instanceof ql?this.insertInlineInternal(o.clone()):o instanceof Ll&&this.insertBlock(o.clone())}},e.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var n=e.childWidgets.indexOf(i.line),r=e.childWidgets[n].children.indexOf(i),o=n;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==n&&(r=0);for(var a=r;a<s.children.length;a++)this.insertInlineInternal(s.children[a].clone())}},e.prototype.getClonedFieldResult=function(e,t){var i=new Rl;i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat);for(var n=e.childWidgets.indexOf(t.line),r=e.childWidgets[n].children.indexOf(t),o=n;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==n&&(r=0);for(var a=r;a<s.children.length;a++)i.childWidgets[0].children.push(s.children[a])}return i},e.prototype.removeContentControl=function(){var e=this.documentHelper.owner.selection.currentContentControl;if(e instanceof id){var t=e.reference,i=this.selection.start.clone(),n=this.selection.end.clone(),r=this.selection.getElementInfo(n.currentWidget,n.offset);this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,e.length)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,t.length)-1),this.initHistory("RemoveContentControl"),this.selection.selectPosition(i,n),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push({text:"RemoveContentControl",type:e.contentControlWidgetType}),this.editorHistory.currentBaseHistoryInfo.setContentControlInfo(e)),this.removeContentControlInternal(e),this.editorHistory&&this.editorHistory.updateHistory(),r.element!==e&&r.element!==t&&this.selection.end.setPositionParagraph(r.element.line,r.element.line.getOffset(r.element,r.index))}this.fireContentChange(),this.viewer.updateScrollBars()},e.prototype.removeContentControlInternal=function(e){(0,a.isNullOrUndefined)(e)&&(e=this.documentHelper.owner.selection.currentContentControl),"Picture"==e.contentControlProperties.type&&this.owner.renderPictureContentControlElement(this.owner,!1,!1);var t=this.documentHelper.contentControlCollection.indexOf(e);t>=0&&(this.updatePropertiesToBlock(e),this.documentHelper.contentControlCollection.splice(t,1),e.line.children.splice(e.indexInOwner,1),(0,a.isNullOrUndefined)(e.reference)||(e.reference.line.children.splice(e.reference.indexInOwner,1),this.updatePropertiesToBlock(e))),this.selection.updateContentControlHighlightSelection();var i=document.getElementById("contenticon"),n=document.getElementById(this.owner.element.id+"PICTURE_CONTENT_CONTROL");i&&(i.style.display="none"),n&&(n.style.display="none"),this.viewer.updateScrollBars()},e.prototype.removeHyperlink=function(){if(!this.owner.isReadOnlyMode){var e=this.selection,t=e.getHyperlinkField();if(!(0,a.isNullOrUndefined)(t)){var i=t.fieldEnd,n=t.fieldSeparator,r=new ac(e.owner);r.setPositionParagraph(t.line,t.line.getOffset(t,0));var o=this.selection.getParagraphInfo(r),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),l=new ac(e.owner);l.setPositionParagraph(n.line,n.line.getOffset(n,n.length)),o=this.selection.getParagraphInfo(l);var d=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(i.line,i.line.getOffset(i,0)),o=this.selection.getParagraphInfo(e.start);var h=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());e.end.setPositionParagraph(i.line,i.line.getOffset(i,1)),this.delete(),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(d)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),e.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(h)),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(s)),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.combineElementRevision(n.revisions,i.revisions),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}}},e.prototype.updateHyperlinkFormat=function(e){var t=e.getHyperlinkField();if(!(0,a.isNullOrUndefined)(t)){var i=t.fieldEnd,n=t.fieldSeparator;e.start.setPositionParagraph(n.line,n.line.getOffset(n,n.length)),e.end.setPositionParagraph(i.line,i.line.getOffset(i,0)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)}},e.prototype.pasteInternal=function(e,t){if(this.currentPasteOptions=this.owner.defaultPasteOption,this.isHtmlPaste=!1,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0,this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),(0,a.isNullOrUndefined)(t)&&(t=window);var i,n="",r="",o="",s=t.clipboardData?t.clipboardData:e.clipboardData;if("msie"!==a.Browser.info.name&&(r=s.getData("Text/Rtf"),n=s.getData("Text/Html"),o=s.getData("application/json")),this.copiedTextContent=i=Pa.sanitizeString(s.getData("Text")),this.previousCharFormat=new ka,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new ba,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(n="",r=""),""!==o)this.pasteFormattedContent({data:JSON.parse(o)});else if(""!==r)this.pasteAjax(r,".rtf");else if(""!==n){this.isHtmlPaste=!0;var l=(new DOMParser).parseFromString(n,"text/html"),d=(new XMLSerializer).serializeToString(l);d=(d=(d=d.replace(/<!--StartFragment-->/gi,"")).replace(/<!--EndFragment-->/gi,"")).replace('xmlns="http://www.w3.org/1999/xhtml"',""),this.pasteAjax(d,".html")}else if(null!==i&&""!==i)this.selection.currentPasteAction="TextOnly",this.pasteContents(i),this.applyPasteOptions(this.currentPasteOptions,!0),this.copiedContent=void 0,this.documentHelper.editableDiv.innerHTML="";else if("msie"!==a.Browser.info.name&&void 0!==s.items&&0!==s.items.length)for(var h=0;h<s.items.length;h++){var c=s.items[h];("image/png"===c.type||"image/svg+xml"===c.type&&"string"!==c.kind)&&this.pasteImage(c.getAsFile())}else"msie"===a.Browser.info.name&&void 0!==s.files&&0!==s.files.length&&"image/png"===s.files[0].type&&this.pasteImage(s.files[0])}},e.prototype.pasteImage=function(e){var t=this,i=new FileReader;i.onload=function(){t.onPasteImage(i.result)},i.readAsDataURL(e)},e.prototype.onPasteImage=function(e){var t=document.createElement("img"),i=this;t.addEventListener("load",(function(){i.insertImageInternal(e,!0,this.width,this.height,this.alt)})),t.src=e},e.prototype.pasteAjax=function(e,t){var i={content:e,type:t};this.pasteRequestHandler=new c,this.owner.documentHelper.viewerContainer.focus(),(0,el.showSpinner)(this.owner.element),this.pasteRequestHandler.url=this.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard,this.pasteRequestHandler.responseType="json",this.pasteRequestHandler.contentType="application/json;charset=UTF-8",this.pasteRequestHandler.customHeaders=this.owner.headers,this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this),this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this),this.pasteRequestHandler.onError=this.onPasteFailure.bind(this);var n={serverActionType:"SystemClipboard",headers:this.owner.headers,timeout:0,cancel:!1,withCredentials:!1,clipboardData:i};this.owner.trigger(_,n),n.cancel?(0,el.hideSpinner)(this.owner.element):this.pasteRequestHandler.send(i,n)},e.prototype.pasteFormattedContent=function(e){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.pasteContents((0,a.isNullOrUndefined)(e.data)?this.copiedTextContent:Pa.getSfdtDocument(e.data)),"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions),(0,el.hideSpinner)(this.owner.element),setTimeout((function(){(0,a.isNullOrUndefined)(t.viewer)||(t.documentHelper.isScrollHandler=!0,t.isPasteContentCheck=!0,t.viewer.updateScrollBars(),t.documentHelper.isScrollHandler=!1,t.isPasteContentCheck=!1)}),0)},e.prototype.onPasteFailure=function(e){this.owner.fireServiceFailure(e),console.error(e.status,e.statusText),(0,el.hideSpinner)(this.owner.element),this.documentHelper.updateFocus()},e.prototype.paste=function(e,t){var i=this;if((0,a.isNullOrUndefined)(e)&&(e=this.owner.enableLocalPaste?this.copiedData:void 0),(0,a.isNullOrUndefined)(t)||(this.currentPasteOptions=t),e){var n=Pa.getSfdtDocument(e);this.pasteContents(n,null,t),this.applyPasteOptions(this.currentPasteOptions),this.currentPasteOptions=void 0,this.chartType&&(setTimeout((function(){(0,a.isNullOrUndefined)(i.viewer)||i.viewer.updateScrollBars()}),30),this.chartType=!1)}},e.prototype.getUniqueListOrAbstractListId=function(e){if(e&&this.documentHelper.lists.length){var t=this.documentHelper.lists.slice().sort((function(e,t){return e.listId-t.listId}));return t[t.length-1].listId+1}if(this.documentHelper.abstractLists.length){var i=this.documentHelper.abstractLists.slice().sort((function(e,t){return e.abstractListId-t.abstractListId}));return i[i.length-1].abstractListId+1}return 0},e.prototype.getBlocksToUpdate=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(n[ne[this.keywordIndex]]&&n[ne[this.keywordIndex]][kt[this.keywordIndex]]&&Object.keys(n[ne[this.keywordIndex]][kt[this.keywordIndex]]).length>0)t.push(n);else if(n[Eo[this.keywordIndex]])for(var r=0;r<n[Eo[this.keywordIndex]].length;r++)for(var o=n[Eo[this.keywordIndex]][r],s=0;s<o[Ho[this.keywordIndex]].length;s++){var a=o[Ho[this.keywordIndex]][s];t=t.concat(this.getBlocksToUpdate(a[Go[this.keywordIndex]]))}}return t},e.prototype.updateListIdForBlocks=function(e,t,i,n,r,o,s){for(var l=!1,d=0;d<e.length;d++){var h=e[d];if(h[ne[this.keywordIndex]]&&h[ne[this.keywordIndex]][kt[this.keywordIndex]]&&Object.keys(h[ne[this.keywordIndex]][kt[this.keywordIndex]]).length>0){var c=h[ne[this.keywordIndex]][kt[this.keywordIndex]],p=this.isNsIdMatchWithExistingAbstractList(t[ds]);c[ht[this.keywordIndex]]===n&&((0,a.isNullOrUndefined)(p)?(l=!0,c[ht[this.keywordIndex]]=r):o?(l=!0,c[ht[this.keywordIndex]]=r,c[ds]=s):(c.isUpdated||(c[ht[this.keywordIndex]]=p.listId,c.isUpdated=!0),l=!1))}else if(h[Eo[this.keywordIndex]])for(var u=0;u<h[Eo[this.keywordIndex]].length;u++)for(var g=h[Eo[this.keywordIndex]][u],m=0;m<g[Ho[this.keywordIndex]].length;m++){var f=g[Ho[this.keywordIndex]][m],v=this.updateListIdForBlocks(f[Go[this.keywordIndex]],t,i,n,r);l||(l=v)}}return l},e.prototype.isNsIdMatchWithExistingAbstractList=function(e){for(var t=0;t<this.documentHelper.lists.length;t++){var i=this.documentHelper.lists[t];if(i.abstractList.nsid===e)return i}},e.prototype.updatePasteContent=function(e,t){var i=this,n=this.getUniqueListOrAbstractListId(!0);if(e[re[this.keywordIndex]].filter((function(e){return e[ht[i.keywordIndex]]===n})).length>0){var r=e[re[this.keywordIndex]].slice().sort((function(e,t){return e[ht[i.keywordIndex]]-t[ht[i.keywordIndex]]}));n=r[r.length-1][ht[this.keywordIndex]]+1}var o=this.getUniqueListOrAbstractListId(!1);if(e[oe[this.keywordIndex]].filter((function(e){return e[ls[i.keywordIndex]]===o})).length>0){var s=e[oe[this.keywordIndex]].slice().sort((function(e,t){return e[ls[i.keywordIndex]]-t[ls[i.keywordIndex]]}));o=s[s.length-1][ls[this.keywordIndex]]+1}for(var l,d=e[re[this.keywordIndex]].length,h=function(r){var s=e[re[c.keywordIndex]][r],h=e[oe[c.keywordIndex]].filter((function(e){return e[ls[i.keywordIndex]]===s[ls[i.keywordIndex]]}))[0],p=c.documentHelper.lists.filter((function(e){return e.listId===s[ht[i.keywordIndex]]}));if(!(0,a.isNullOrUndefined)(h)){var u=!1,g=0;if((0,a.isNullOrUndefined)(c.selection)||(0,a.isNullOrUndefined)(c.selection.start.paragraph)||(u=c.getPreviousParagraphListFormat(c.selection.start.paragraph,d))&&(g=Pa.generateUniqueId(c.documentHelper.lists)),c.updateListIdForBlocks(e[ee[c.keywordIndex]][t][Go[c.keywordIndex]],h,p[0],s[ht[c.keywordIndex]],n,u,g)){for(var m=h[ls[c.keywordIndex]],f=0;f<e[re[c.keywordIndex]].length;f++){var v=e[re[c.keywordIndex]][f];v[ls[c.keywordIndex]]===m&&(v[ls[c.keywordIndex]]=o)}h[ls[c.keywordIndex]]=o,s[ht[c.keywordIndex]]=n,u&&0!==g&&(h[ds]=s[ds]=g),n++,o++}else e[re[c.keywordIndex]].splice(r,1),e[oe[c.keywordIndex]].splice(e[oe[c.keywordIndex]].indexOf(h),1),r--}l=r},c=this,p=0;p<e[re[this.keywordIndex]].length;p++)h(p),p=l;for(var u=this.getBlocksToUpdate(e[ee[this.keywordIndex]][t][Go[this.keywordIndex]]),g=0;g<u.length;g++){delete u[g][ne[this.keywordIndex]][kt[this.keywordIndex]].isUpdated}},e.prototype.getPreviousParagraphListFormat=function(e,t){if(!(0,a.isNullOrUndefined)(this.documentHelper.layout)){for(var i=this.selection.getPreviousParagraphBlock(e);!(0,a.isNullOrUndefined)(i)&&(i.isEmpty()||!this.documentHelper.layout.hasValidElement(i));)i=this.selection.getPreviousParagraphBlock(i);if(!(0,a.isNullOrUndefined)(i)&&-1===i.paragraphFormat.listFormat.listId&&1===t)return!0}return!1},e.prototype.getBlocks=function(e,t,i,n,r,o){var s=[];if("string"==typeof e){var d=this.selection.start.paragraph;this.selection.isForward||(d=this.selection.end.paragraph);var h=[],c=e;h=(c=c.replace(/\r?\n/g,"\r")).split("\r");var p=[];(k=new Ol).sectionFormat=new ga(k),k.childWidgets=p;for(var u=0;u<h.length;u++)if(u!==h.length-1||0!==h[u].length||this.isInsertText){var g=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),m=this.selection.getPreviousValidElement(g.element);m!==g.element&&(m=this.documentHelper.getNextValidElement(g.element));var f=void 0;d.isEmpty()?f=d.characterFormat:(0,a.isNullOrUndefined)(m)||this.isInsertText?this.copyInsertFormat(d.characterFormat,!1):f=m.characterFormat;var v=void 0;this.isInsertText&&!this.selection.isEmpty?(v=new ba).copyFormat(this.selection.end.paragraph.paragraphFormat):v=this.documentHelper.selection.copySelectionParagraphFormat(),(0,a.isNullOrUndefined)(this.previousParaFormat)||(v=this.previousParaFormat);var y=new Rl;y.paragraphFormat.copyFormat(v);var w=new zl(y);if(h[u].length>0)for(var b=h[u].split(/(\s+)/),C=0;C<b.length;C++){var x=new Zl;x.characterFormat.copyFormat(f),x.text=b[C],w.children.push(x),x.line=w}y.childWidgets.push(w),y.containerWidget=k,p.push(y)}s.push(k)}else{var I=this.documentHelper.owner.parser;I.keywordIndex=this.keywordIndex,I.isPaste=t,I.isContextBasedPaste=!(0,a.isNullOrUndefined)(o)&&o,I.isHtmlPaste=this.isHtmlPaste,o||(I.addCustomStyles(e),e[le[this.keywordIndex]]&&e[le[this.keywordIndex]].length>0&&(I.commentsCollection=new l,I.commentStarts=new l,I.commentEnds=new l,I.parseComments(e,n||this.documentHelper.comments)),e[he[this.keywordIndex]]&&e[he[this.keywordIndex]].length>0&&I.parseCustomXml(e));var k=void 0;this.selection.currentPasteAction="DefaultPaste";for(u=0;u<e[ee[this.keywordIndex]].length;u++){if(!o&&(this.isPasteListUpdated||(0,a.isNullOrUndefined)(e[re[this.keywordIndex]])||(this.documentHelper.lists.length>0&&this.updatePasteContent(e,u),this.isPasteListUpdated=!0,(0,a.isNullOrUndefined)(e[oe[this.keywordIndex]])||I.parseAbstractList(e,this.documentHelper.abstractLists),(0,a.isNullOrUndefined)(e[re[this.keywordIndex]])||I.parseList(e,this.documentHelper.lists)),!(0,a.isNullOrUndefined)(e[de[this.keywordIndex]])))if(t){var F=this.viewer.owner.revisionsInternal.changes;(0,a.isNullOrUndefined)(I.revisionCollection)||(I.revisionCollection=void 0),this.isRemoteAction?I.revisionCollection=this.documentHelper.revisionsInternal:I.revisionCollection=new l;var P=I.revisionCollection;if((!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!I.isCutPerformed)&&e[de[this.keywordIndex]].length>=1)for(var S=0;S<e[de[this.keywordIndex]].length;S++){var T=!0;if(P.containsKey(e[de[this.keywordIndex]][S][jr[this.keywordIndex]])){if(F.length>0)for(var H=0;H<F.length;H++)F[H].revisionID===e[de[this.keywordIndex]][S][jr[this.keywordIndex]]&&(T=!1);if(T&&!this.isRemoteAction){var E=P.get(e[de[this.keywordIndex]][S][jr[this.keywordIndex]]);F.push(E)}}else I.parseRevisions(e,F)}this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else I.revisionCollection=this.documentHelper.revisionsInternal,I.parseRevisions(e,r);if((k=new Ol).sectionFormat=new ga(k),!t||o?i.unshift(k):s.push(k),t&&!o&&!(0,a.isNullOrUndefined)(e[ae[this.keywordIndex]]))for(C=0;C<e[ae[this.keywordIndex]].length;C++){var N=e[ae[this.keywordIndex]][C][We[this.keywordIndex]],W=this.documentHelper.styles.findByName(N);(0,a.isNullOrUndefined)(W)&&I.parseStyle(e,e[ae[this.keywordIndex]][C],this.documentHelper.styles)}if(I.parseBody(e[ee[this.keywordIndex]][u][Go[this.keywordIndex]],k.childWidgets,void 0,void 0,void 0,e[ae[this.keywordIndex]]),((e[Pe[this.keywordIndex]]||this.owner.enableLocalPaste)&&this.selection.start.paragraph.isEmpty()&&1==this.documentHelper.pages.length&&1==this.documentHelper.pages[0].bodyWidgets[0].childWidgets.length||e[ee[this.keywordIndex]][u][es[this.keywordIndex]]&&e[ee[this.keywordIndex]][u][es[this.keywordIndex]][Qt[this.keywordIndex]]>1||e[ee[this.keywordIndex]][u][es[this.keywordIndex]]&&"NoBreak"===e[ee[this.keywordIndex]][u][es[this.keywordIndex]][ti[this.keywordIndex]])&&I.parseSectionFormat(this.keywordIndex,e[ee[this.keywordIndex]][u][es[this.keywordIndex]],k.sectionFormat),t&&!this.isRemoteAction&&!(0,a.isNullOrUndefined)(n)){for(var O=[],B=0;B<this.documentHelper.comments.length;B++)O.push(this.documentHelper.comments[B].commentId);for(var L=0;L<n.length;L++){var D=n[L];if(-1!==O.indexOf(D.commentId)&&!(0,a.isNullOrUndefined)(D.commentStart)&&!(0,a.isNullOrUndefined)(D.commentEnd)){var R=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);D.commentId=D.commentStart.commentId=D.commentEnd.commentId=R}this.documentHelper.comments.push(D)}}I.isPaste=!1,I.isHtmlPaste=!1,I.isContextBasedPaste=!1}if(e[Pe[this.keywordIndex]]&&!o||this.owner.documentEditorSettings.pasteAsNewParagraph){this.isLastParaMarkCopied=!0;var M=new Rl;k.childWidgets.push(M)}}return"MergeWithExistingFormatting"!==this.currentPasteOptions||o||this.applyMergeFormat(s),s},e.prototype.applyMergeFormat=function(e){for(var t=this.selection.start.paragraph,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),n=this.selection.getPreviousValidElement(i.element),r=n?n.characterFormat:this.copyInsertFormat(t.characterFormat,!0,t),o=this.documentHelper.selection.paragraphFormat,s=0;s<e.length;s++)for(var a=e[s].childWidgets,l=0;l<a.length;l++){var d=a[l];if(d instanceof Rl)this.applyParaFormatInternal(d.paragraphFormat,o),this.applyFormatInternal(d,r);else for(var h=0;h<d.childWidgets.length;h++)for(var c=d.childWidgets[h],p=0;p<c.childWidgets.length;p++)for(var u=c.childWidgets[p],g=0;g<u.childWidgets.length;g++)this.applyFormatInternal(u.childWidgets[g],r)}},e.prototype.applyParaFormatInternal=function(e,t){(0,a.isNullOrUndefined)(t.leftIndent)||(e.leftIndent=t.leftIndent),(0,a.isNullOrUndefined)(t.rightIndent)||(e.rightIndent=t.rightIndent),(0,a.isNullOrUndefined)(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent),(0,a.isNullOrUndefined)(t.textAlignment)?e.textAlignment="Left":e.textAlignment=t.textAlignment,(0,a.isNullOrUndefined)(t.outlineLevel)?e.outlineLevel="BodyText":e.outlineLevel=t.outlineLevel,-1===t.beforeSpacing?e.beforeSpacing=0:e.beforeSpacing=t.beforeSpacing,-1===t.afterSpacing?e.afterSpacing=0:e.afterSpacing=t.afterSpacing,0===t.lineSpacing?e.lineSpacing=1:e.lineSpacing=t.lineSpacing,(0,a.isNullOrUndefined)(t.lineSpacingType)||(e.lineSpacingType=t.lineSpacingType),(0,a.isNullOrUndefined)(t.bidi)||(e.bidi=t.bidi),(0,a.isNullOrUndefined)(t.spaceAfterAuto)||(e.spaceAfterAuto=t.spaceAfterAuto),(0,a.isNullOrUndefined)(t.spaceBeforeAuto)||(e.spaceBeforeAuto=t.spaceBeforeAuto),(0,a.isNullOrUndefined)(t.keepWithNext)||(e.keepWithNext=t.keepWithNext),(0,a.isNullOrUndefined)(t.keepLinesTogether)||(e.keepLinesTogether=t.keepLinesTogether),(0,a.isNullOrUndefined)(t.widowControl)||(e.widowControl=t.widowControl),(0,a.isNullOrUndefined)(t.contextualSpacing)||(e.contextualSpacing=t.contextualSpacing),e.tabs&&(e.tabs=[])},e.prototype.applyFormatInternal=function(e,t){if(e instanceof Rl)for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r].characterFormat.cloneFormat();o.bold&&(n.children[r].characterFormat.bold=o.bold),o.italic&&(n.children[r].characterFormat.italic=o.italic),"None"!==o.underline&&(n.children[r].characterFormat.underline=o.underline),"MergeWithExistingFormatting"!==this.currentPasteOptions||(0,a.isNullOrUndefined)(t)||(t.bold&&(n.children[r].characterFormat.bold=t.bold),t.italic&&(n.children[r].characterFormat.italic=t.italic),"None"!==t.underline&&(n.children[r].characterFormat.underline=t.underline),n.children[r].characterFormat.fontColor!==t.fontColor&&(n.children[r].characterFormat.fontColor=t.fontColor),n.children[r].characterFormat.fontSize!==t.fontSize&&(n.children[r].characterFormat.fontSize=t.fontSize,n.children[r].characterFormat.fontSizeBidi=t.fontSizeBidi),n.children[r].characterFormat.fontFamily!==t.fontFamily&&(n.children[r].characterFormat.fontFamily=t.fontFamily,n.children[r].characterFormat.fontFamilyBidi=t.fontFamilyBidi),n.children[r].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(n.children[r].characterFormat.fontFamilyAscii=t.fontFamilyAscii),n.children[r].characterFormat.fontFamilyFarEast!==t.fontFamilyFarEast&&(n.children[r].characterFormat.fontFamilyFarEast=t.fontFamilyFarEast),n.children[r].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(n.children[r].characterFormat.fontFamilyAscii=t.fontFamilyAscii))}else for(i=0;i<e.childWidgets.length;i++){var s=e.childWidgets[i];for(r=0;r<s.childWidgets.length;r++)for(var l=s.childWidgets[r],d=0;d<l.childWidgets.length;d++)this.applyFormatInternal(l.childWidgets[d],t)}},e.prototype.applyPasteOptions=function(e,t){if(!(0,a.isNullOrUndefined)(this.copiedContent)&&""!==this.copiedTextContent&&!t){this.currentPasteOptions=e;var i=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.paragraphFormat,n=this.copiedContent,r=this.copiedTextContent;switch(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.copiedContent=n,this.copiedTextContent=r,this.selection.isViewPasteOptions=!0,e){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,i);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}}},e.prototype.applyTablePasteOptions=function(e){if(!(0,a.isNullOrUndefined)(this.copiedContent)&&""!==this.copiedTextContent){this.isPaste=!0;var t=""!==this.copiedContent?this.copiedContent:this.copiedTextContent;this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop());var i=this.getBlocks(t,!0),n=this.selection.start.paragraph.paragraphFormat;switch(e){case"NestTable":this.pasteAsNestedTable(i,n);break;case"InsertAsRows":this.pasteAsNewRow(i[0].childWidgets[0]);break;case"InsertAsColumns":this.pasteAsNewColumn(i[0].childWidgets[0]);break;case"OverwriteCells":this.pasteOverwriteCell(i[0].childWidgets[0])}this.isPaste=!1}},e.prototype.pasteContents=function(e,t,i){if(!(0,a.isNullOrUndefined)(e.optimizeSfdt)&&e.optimizeSfdt?this.keywordIndex=1:this.keywordIndex=0,"string"!=typeof e&&(this.copiedContent=e),!(0,a.isNullOrUndefined)(this.documentHelper)){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()){var n=this.selection.getCurrentFormField(),r=this.getFieldResultText(),o=n.formFieldData.maxLength,s=this.documentHelper.selection.text.length;if(o>0)if(0===s){var d=o-r.length;e=e.substring(0,d)}else s>0&&(e=e.substring(0,s))}if(!(0,a.isNullOrUndefined)(e[na[this.keywordIndex]])){var h=e[na[this.keywordIndex]];if(this.documentHelper.images.length>0){this.pasteImageIndex=new l;var c={};for(var p in h){var u=Math.max.apply(Math,this.documentHelper.images.keys)+1+parseInt(p);c[u]=h[p],this.pasteImageIndex.add(p,u.toString())}h=c}this.documentHelper.owner.parser.parseImages(h)}var g=[],m=this.getBlocks(e,!0,void 0,g);this.pasteContentsInternal(m,!0,t,i,g),!(0,a.isNullOrUndefined)(g)&&g.length>0&&this.documentHelper.layout.layoutComments(g),(0,a.isNullOrUndefined)(this.pasteImageIndex)||this.pasteImageIndex.destroy(),this.pasteImageIndex=void 0,this.isInsertField=!1,this.isPasteListUpdated=!1,this.isLastParaMarkCopied=!1}},e.prototype.pasteContentsInternal=function(e,t,i,n,r){this.isPaste=t;var o,s=this.documentHelper.selection;if(s.start.paragraph.isInsideTable&&s.end.paragraph.isInsideTable&&!this.documentHelper.isDragging){var l=!1;if(1===e.length){var d=e[0].childWidgets;d.length<3&&(1===d.length&&d[0]instanceof Al||2===d.length&&d[0]instanceof Al&&d[1].isEmpty())&&(l=!0)}if(l){var h=s.start.paragraph.associatedCell,c=s.end.paragraph.associatedCell,p=e[0].childWidgets[0];if((0,a.isNullOrUndefined)(n)||"MergeWithExistingFormatting"===n||"KeepSourceFormatting"===n||"KeepTextOnly"===n)h.ownerTable.equals(c.ownerTable)&&(0===s.start.paragraph.associatedCell.rowIndex&&0===s.end.paragraph.associatedCell.rowIndex&&h.equals(c)&&!this.selection.isCellSelected(h,s.start,s.end)?(this.selection.currentPasteAction="InsertAsColumns",this.pasteAsNewColumn(p)):(this.selection.currentPasteAction="OverwriteCells",this.pasteOverwriteCell(p)));else switch(n){case"InsertAsColumns":this.selection.currentPasteAction="InsertAsColumns",this.pasteAsNewColumn(p);break;case"OverwriteCells":this.selection.currentPasteAction="OverwriteCells",this.pasteOverwriteCell(p);break;case"NestTable":this.selection.currentPasteAction="NestTable",this.pasteAsNestedTable(e);break;case"InsertAsRows":this.selection.currentPasteAction="InsertAsRows",this.pasteAsNewRow(p)}return void(this.isPaste=!1)}}o=this.checkAndRemoveComments(),this.defaultPaste(e,i,r),this.updateHistoryForComments(o)},e.prototype.defaultPaste=function(e,t,i){var n,r=this.documentHelper.selection,o=!0,s=!1;if(this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected){var l=r.start.paragraph;l.paragraphFormat.listFormat&&-1!==l.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)}if(this.initHistory("Paste"),(r.isEmpty||this.owner.documentHelper.isDragging&&this.owner.selection.isImageSelected)&&!this.documentHelper.isListTextSelected||(o=this.removeSelectedContentInternal(r,r.start,r.end)),o?(s=this.pasteContent(e,t),this.owner.enableTrackChanges&&this.isInsertingTOC&&(0,a.isNullOrUndefined)(this.owner.documentHelper.blockToShift)&&(this.owner.documentHelper.blockToShift=this.selection.start.paragraph),this.isRemoteAction&&(this.updatePasteRevision(),this.owner.trackChangesPane.updateTrackChanges())):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo){if(this.editorHistory.currentBaseHistoryInfo&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex&&(this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex=void 0);var d=this.selection.getTextPosBasedOnLogicalIndex(this.editorHistory.currentBaseHistoryInfo.insertPosition),h=this.selection.getTextPosBasedOnLogicalIndex(this.editorHistory.currentBaseHistoryInfo.endPosition);if(!this.isRemoteAction){var c=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,d.currentWidget,d.offset,h.currentWidget,h.offset,!1,!0);this.editorHistory.currentBaseHistoryInfo.pasteContent=c}!(0,a.isNullOrUndefined)(i)&&i.length>0&&(n=this.editorHistory.currentBaseHistoryInfo.pastedComments).push.apply(n,i)}this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory(),r.isHighlightContentControlEditRegion=!0}else this.reLayout(r,r.isEmpty);s&&(this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),this.restrictLayout||this.layoutWholeDocument(!0)),this.isPaste=!1},e.prototype.pasteAsNewColumn=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteColumn");var t=this.getOwnerCell(this.selection.isForward),i=t.ownerRow.ownerTable.combineWidget(this.owner.viewer);if(this.editorHistory)this.cloneTableToHistoryInfo(i);this.selection.owner.isLayoutEnabled=!1;var n=e.clone(),r=n.childWidgets[0],o=n.childWidgets.length,s=r.childWidgets.length,l=t.columnIndex,d=void 0,h=void 0,c=s,p=[];o>i.childWidgets.length?(this.addRows(o-i.childWidgets.length,i),this.tableUpdate(i)):i.childWidgets.length>o&&(this.addRows(i.childWidgets.length-o,n,i),this.tableUpdate(i));for(var u=0;u<c;u++)for(var g=0;g<i.childWidgets.length;g++){var m=i.childWidgets[g],f=n.childWidgets[g].childWidgets[u],v=m.childWidgets[t.columnIndex];(h=this.createColumn(this.selection.getLastParagraph(t))).index=g,h.rowIndex=m.index,h.containerWidget=m;var y=m.previousWidget,w=this.rowspannedCollection(m,p);if(null!=v)h.cellFormat.copyFormat(v.cellFormat),h.cellFormat.rowSpan=1;else if(w.length>0)for(var b=0;b<w.length;b++)y.rowIndex+(w[b].cellFormat.rowSpan-1)>=m.rowIndex&&(h.cellFormat.copyFormat(w[b].cellFormat),h.cellFormat.rowSpan=1);f.containerWidget=h.containerWidget,h.childWidgets=f.childWidgets,(0,a.isNullOrUndefined)(d)&&(d=this.selection.getFirstParagraph(h)),0===l?m.childWidgets.splice(u,0,h):this.insertSpannedCells(m,p,h,l)}this.tableReLayout(i,d,h,!0)}},e.prototype.pasteAsNestedTable=function(e,t){var i=e[0].childWidgets[0];if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteNested");var n=this.getOwnerCell(this.selection.isForward),r=n.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(r);var o=void 0,s=i.clone(),l=this.selection.end.paragraph.containerWidget,d=void 0;if(n!=l){for(var h=n.ownerRow;h!=l.ownerRow.nextRow;){for(var c=n.columnIndex;c<=l.columnIndex;c++){d=h.childWidgets[c];var p=s.clone(),u=new Rl;d.childWidgets=[],d.childWidgets[0]=p,d.childWidgets[1]=u,u.containerWidget=d,p.containerWidget=d,p.index=0,u.index=1,h.childWidgets[c]=d,(0,a.isNullOrUndefined)(o)&&(o=this.selection.getFirstParagraph(d))}h=h.nextRow}this.tableReLayout(r,o,d)}else this.defaultPaste(e,t)}},e.prototype.pasteOverwriteCell=function(e){if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("PasteOverwrite");var t=this.getOwnerCell(this.selection.isForward),i=t.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(i);var n=e.clone(),r=n.childWidgets.length,o=this.getOwnerCell(!this.selection.isForward),s=(t.columnIndex,t.rowIndex),l=void 0,d=this.selection.start.paragraph.associatedCell.ownerRow,h=n.childWidgets[0],c=void 0,p=(h.childWidgets.length,t.ownerRow);if(t!=o){for(var u=0,g=void 0,m=void 0,f=void 0,v=void 0;p!=o.ownerRow.nextRow;){for(var y=(h=n.childWidgets[u]||n.childWidgets[u=0]).childWidgets.length,w=0,b=t.columnIndex;b<=o.columnIndex;b++){g>1&&m===b&&(b++,g--,m=null),f>1&&w>=y-(f-1)&&(b+=(f=1)-1,w=0),v=(c=(h=n.childWidgets[u]).childWidgets[w]||h.childWidgets[w=0]).clone();for(var C=p.getCell(p.index,b),x=0;x<v.childWidgets.length;x++){(T=v.childWidgets[x]).containerWidget=C,v.childWidgets[x]=T}C.childWidgets=v.childWidgets,c.cellFormat.rowSpan>1&&(g=c.cellFormat.rowSpan,m=b),c.cellFormat.columnSpan>1&&(f=c.cellFormat.columnSpan),(0,a.isNullOrUndefined)(l)&&(l=this.selection.getFirstParagraph(v)),w++}p=p.nextRow,u++}this.tableReLayout(i,l,v,!0)}else{var I=void 0;g=void 0,m=void 0,C=void 0;r>i.childWidgets.length-s&&(I=r-i.childWidgets.length+s,this.addRows(I,i));for(var k=0;k<r;k++){b=t.columnIndex;for(var F=(h=n.childWidgets[k]).childWidgets.length,P=0;P<F;P++){v=(c=h.childWidgets[P]).clone();g>1&&m===b&&(b++,g--,m=null),(C=d.childWidgets[b])||((C=v).containerWidget=d,C.index=b);for(var S=0;S<v.childWidgets.length;S++){var T;(T=v.childWidgets[S]).containerWidget=C,v.childWidgets[S]=T}C.childWidgets=v.childWidgets,c.cellFormat.rowSpan>1&&(g=c.cellFormat.rowSpan,m=b),d.childWidgets.splice(b++,1,C),(0,a.isNullOrUndefined)(l)&&(l=this.selection.getFirstParagraph(C))}d=d.nextRow}this.tableReLayout(i,l,C,!0)}}},e.prototype.pasteAsNewRow=function(e){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){this.checkIsNotRedoing()&&this.initHistory("PasteRow"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],i=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],n=t.ownerTable.combineWidget(this.owner.viewer),r=i.ownerRow;this.editorHistory&&this.cloneTableToHistoryInfo(n);this.getRowCountToInsert(),this.getColumnCountToInsert();var o=[],s=r.rowIndex;s++;for(var a=e.childWidgets.length,l=0;l<a;l++){var d=e.childWidgets[l].clone();this.owner.enableTrackChanges&&this.insertRevision(d.rowFormat,"Insertion"),o.push(d)}n.insertTableRowsInternal(o,s,!1);var h=void 0,c=void 0;if(n.childWidgets[s]instanceof Ul)h=n.childWidgets[s].firstChild,c=this.selection.getFirstParagraph(h);else{for(var p=void 0;!(p instanceof Al);)p=n.nextRenderedWidget;c=this.documentHelper.getFirstParagraphInFirstCell(p)}this.copyContent(n),this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(c,!0),this.reLayout(this.selection,!0)}},e.prototype.tableUpdate=function(e){e.isGridUpdated=!1,e.calculateGrid(),e.buildTableColumns(),e.isGridUpdated=!0},e.prototype.rowspannedCollection=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];n.cellFormat.rowSpan>1&&t.push(n)}return t},e.prototype.insertSpannedCells=function(e,t,i,n){for(var r=!1,o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(s.cellFormat.rowSpan>1&&t.push(s),(s.columnIndex+s.cellFormat.columnSpan===n||n>s.columnIndex&&s.columnIndex+s.cellFormat.columnSpan>n&&n<s.columnIndex+s.cellFormat.columnSpan)&&(e.childWidgets.splice(s.cellIndex+1,0,i),r=!0),r)break}if(!r&&t.length>0)for(var a=0;a<t.length;a++){var l=t[a];if(l.ownerRow!==e&&e.rowIndex<=l.ownerRow.rowIndex+l.cellFormat.rowSpan-1&&(l.columnIndex+l.cellFormat.columnSpan===n?(l.cellIndex>e.childWidgets.length?e.childWidgets.push(i):e.childWidgets.splice(l.cellIndex+1,0,i),r=!0):n>l.columnIndex&&l.columnIndex+l.cellFormat.columnSpan>n&&n<l.columnIndex+l.cellFormat.columnSpan&&(e.childWidgets.splice(l.columnIndex,0,i),r=!0)),r)break}},e.prototype.addRows=function(e,t,i){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var n=this.selection.isForward?this.selection.start:this.selection.end,r=(this.selection.isForward?this.selection.end:this.selection.start,t.childWidgets.length),o=t.childWidgets[r-1],s=o.childWidgets.length;if(n.paragraph.isInsideTable){var a=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],l=o.childWidgets[s-1],d=l.ownerRow;this.rowInsertion(e,"Below",a,l,d,t,!1)}}},e.prototype.pasteContent=function(e,t){this.documentHelper.owner.isShiftingEnabled=!0;var i="";if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition(),i=this.editorHistory.currentBaseHistoryInfo.insertPosition;else{var n=this.selection.start;this.selection.isForward||(n=this.selection.end);var r=this.selection.getParagraphInfo(n);i=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.owner.isPastingContent=!0;var o=this.pasteCopiedData(e,t),s="";if(this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)s=this.editorHistory.currentBaseHistoryInfo.endPosition;else{r=this.selection.getParagraphInfo(this.selection.start);s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}this.selection.start.paragraph.isEmpty()&&this.selection.start.paragraph.paragraphFormat.bidi&&this.documentHelper.layout.reLayoutParagraph(this.selection.start.paragraph,0,0);var a=new ac(this.documentHelper.owner);this.setPositionForCurrentIndex(a,i);var l=new ac(this.documentHelper.owner);return this.setPositionForCurrentIndex(l,s),this.pasteTextPosition={startPosition:a,endPosition:l},this.documentHelper.owner.isPastingContent=!1,this.documentHelper.selection.fireSelectionChanged(!0),o},e.prototype.pasteCopiedData=function(e,t){var i=this.selection.start.paragraph.isInsideTable,n=!1,r=!1;if(this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter){if(this.previousSectionFormat=new ga,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(e[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,this.owner.viewer instanceof kl){var o=this.selection.start.paragraph.bodyWidget.page;this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,o,o.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget,o)}n=!0}this.documentHelper.layout.isPastingContent=!0;for(var s=0;s<e.length;s++){0!==s&&this.insertSectionBreak(e[s].sectionFormat.breakCode,e[s].sectionFormat);for(var l=e[s].childWidgets,d=s===e.length-1,h=0;h<l.length;h++){var c=h===l.length-1;c&&(i=!c),c&&d&&(this.documentHelper.layout.isPastingContent=!1);var p=l[h];if(p instanceof Al&&!0,p instanceof Rl&&0===p.childWidgets.length&&(p.childWidgets[0]=new zl(p)),p instanceof Rl&&!(0,a.isNullOrUndefined)(t)){p.paragraphFormat.copyFormat(t);var u=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1);p.characterFormat.mergeFormat(u)}if(h!==l.length-1&&this.isPaste&&(0,a.isNullOrUndefined)(t)&&this.previousParaFormat&&p instanceof Rl&&!(0,a.isNullOrUndefined)(p.paragraphFormat.listFormat)&&(0,a.isNullOrUndefined)(p.paragraphFormat.listFormat.list)&&-1===p.paragraphFormat.listFormat.listId)if(this.previousParaFormat.listFormat&&this.previousParaFormat.listFormat.list&&-1!==this.previousParaFormat.listFormat.listId)p.paragraphFormat.listFormat.copyFormat(this.previousParaFormat.listFormat),p.paragraphFormat.leftIndent=this.previousParaFormat.leftIndent;else if(this.previousParaFormat.baseStyle&&this.previousParaFormat.baseStyle instanceof Wa&&this.previousParaFormat.baseStyle.paragraphFormat.listFormat&&this.previousParaFormat.baseStyle.paragraphFormat.listFormat.list&&-1!==this.previousParaFormat.baseStyle.paragraphFormat.listFormat.listId){var g=this.previousParaFormat.baseStyle.paragraphFormat;p.paragraphFormat.listFormat.copyFormat(g.listFormat),p.paragraphFormat.leftIndent=g.leftIndent}if(h===l.length-1&&p instanceof Rl&&!(0,a.isNullOrUndefined)(p.paragraphFormat.listFormat)&&(0,a.isNullOrUndefined)(p.paragraphFormat.listFormat.list)&&-1===p.paragraphFormat.listFormat.listId){var m=p;if(m.childWidgets.length>0&&m.childWidgets[0].children.length>0){var f=this.selection.start;"Center"!==f.paragraph.paragraphFormat.textAlignment&&"Right"!==f.paragraph.paragraphFormat.textAlignment||-1!==f.paragraph.paragraphFormat.listFormat.listId||(f.paragraph.x=this.owner.viewer.clientActiveArea.x),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(m.clone()),r=this.insertElement(m.childWidgets[0].children,m.paragraphFormat)}else if(c&&d){var v=this.selection.start.paragraph;this.documentHelper.layout.reLayoutParagraph(v,0,0,v.paragraphFormat.bidi)}}else if(p instanceof Ll){var y=p,w=this.selection.start.paragraph;if(y instanceof Al){var b=y;if(this.generateTableRevision(b),w.isInsideTable){var C=w.getContainerWidth();b.fitCellsToClientArea(C)}if(w.isEmpty()&&w.previousWidget instanceof Al&&!this.isPaste)return this.insertTableRows(b,w.previousWidget),n}this.insertBlockInternal(y,void 0,i,this.isRemoteAction)}}}return this.documentHelper.layout.isPastingContent=!1,r&&(n=!0,"Footnote"===this.pasteFootNoteType?this.arrangeFootnoteCollection():"Endnote"===this.pasteFootNoteType&&this.arrangeEndnoteCollection()),!n&&(0,a.isNullOrUndefined)(this.documentHelper.blockToShift)&&this.shiftFootnoteContent(),n},e.prototype.arrangeEndnoteCollection=function(){for(var e=0;e<this.documentHelper.endnoteCollection.length;e++)for(var t=0;t<this.documentHelper.endnoteCollection.length-1-e;t++){var i=this.selection.getElementPosition(this.documentHelper.endnoteCollection[t]).startPosition,n=this.selection.getElementPosition(this.documentHelper.endnoteCollection[t+1]).startPosition;if(!i.isExistBefore(n)){var r=this.documentHelper.endnoteCollection[t];this.documentHelper.endnoteCollection[t]=this.documentHelper.endnoteCollection[t+1],this.documentHelper.endnoteCollection[t+1]=r}}},e.prototype.arrangeFootnoteCollection=function(){for(var e=0;e<this.documentHelper.footnoteCollection.length;e++)for(var t=0;t<this.documentHelper.footnoteCollection.length-1-e;t++){var i=this.selection.getElementPosition(this.documentHelper.footnoteCollection[t]).startPosition,n=this.selection.getElementPosition(this.documentHelper.footnoteCollection[t+1]).startPosition;if(!i.isExistBefore(n)){var r=this.documentHelper.footnoteCollection[t];this.documentHelper.footnoteCollection[t]=this.documentHelper.footnoteCollection[t+1],this.documentHelper.footnoteCollection[t+1]=r}}},e.prototype.generateTableRevision=function(e){if(this.owner.enableTrackChanges&&!(0,a.isNullOrUndefined)(e))for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.insertRevision(i.rowFormat,"Insertion");for(var n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];(0,a.isNullOrUndefined)(s)||(s instanceof Rl?this.insertRevisionForBlock(s,"Insertion"):this.generateTableRevision(s))}}},e.prototype.isSectionEmpty=function(e){var t=e.start.paragraph;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==e.end.paragraph)return!1;var i=t.bodyWidget;if(i){var n=i.page;if(n&&((0,a.isNullOrUndefined)(n.previousPage)||n.previousPage.sectionIndex!==n.sectionIndex)&&(0,a.isNullOrUndefined)(n.nextPage)&&t.isEmpty()&&1===i.childWidgets.length){var r=!0,o=e.start.paragraph.bodyWidget.sectionIndex,s=this.documentHelper.headersFooters[o];if(s){for(var l in s){var d=s[l];if((0,a.isNullOrUndefined)(d))r=!1;else{var h=d.childWidgets[0];(h instanceof Al||h instanceof Rl&&!h.isEmpty())&&(r=!1)}if(!r)break}return r}}}}return!1},e.prototype.insertTableInternal=function(e,t,i,n){var r,o=e.index,s=this.selection.start.paragraph;if(!e.isInsideTable&&t.isInsideTable&&(o=t.index,n=!0,r=s.containerWidget),i)for(var l=0,d=0;l<e.childWidgets.length;l++,d++){var h=e.childWidgets[l];t.childWidgets.splice(d,0,h),h.containerWidget=t,e.childWidgets.splice(l,1),l--}if(!s.isInsideTable&&(0,a.isNullOrUndefined)(r)?(e.containerWidget=s.containerWidget,r=s.containerWidget):(0,a.isNullOrUndefined)(r)&&(r=e.containerWidget),e.isInsideTable&&(r=r.combineWidget(this.owner.viewer)),this.constructRevisionsForTable(e,!1),n||this.removeBlock(e,!0),this.removeRevisionFromTable(t),r instanceof Vl)r=r.combineWidget(this.owner.viewer);else{var c=this.documentHelper.layout.checkAndGetBlock(r,o);-1!==r.childWidgets.indexOf(c)&&(o=r.childWidgets.indexOf(c))}r.childWidgets.splice(o,0,t),n||(e.containerWidget=void 0,t.index=e.index),t.containerWidget=r,this.documentHelper.layout.clearTableWidget(t,!0,!0,!0),t.buildTableColumns(),this.constructRevisionsForTable(t,!0),t.isGridUpdated=!0,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.linkFieldInTable(t),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,r,t,!1)},e.prototype.removeRevisionFromTable=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];if(i.rowFormat.revisions.length>0)for(var n=0;n<i.rowFormat.revisions.length;n++)if(0===i.rowFormat.revisions[n].range.length){var r=i.rowFormat.revisions.indexOf(i.rowFormat.revisions[n]);i.rowFormat.revisions.splice(r,1),n--}for(n=0;n<i.childWidgets.length;n++)for(var o=i.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];a instanceof Al&&this.removeRevisionFromTable(a)}}},e.prototype.canConstructRevision=function(e){return e.revisions.length>0&&0===e.revisions[0].range.length||e.removedIds.length>0},e.prototype.constructRevisionsForTable=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=e.childWidgets[i];if(t){this.canConstructRevision(n.rowFormat)&&this.constructRevisionFromID(n.rowFormat,!0);for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof Rl?this.constructRevisionsForBlock(o.childWidgets[s],t):o.childWidgets[s]instanceof Al&&this.constructRevisionsForTable(o.childWidgets[s],!0)}else this.removeDeletedCellRevision(n,!0)}},e.prototype.deleteRevision=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){for(var i=e.rowFormat.revisions[t],n=0;n<i.range.length;n++)i.range.splice(n,1),n--,this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.constructRevisionForFootnote=function(e,t){for(var i=0;i<e.bodyWidget.childWidgets.length;i++)e.bodyWidget.childWidgets[i]instanceof Rl&&this.constructRevisionsForBlock(e.bodyWidget.childWidgets[i],t)},e.prototype.constructRevisionsForBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++)if(t&&(n.children[r]instanceof ql&&this.canConstructRevision(n.children[r])&&this.constructRevisionFromID(n.children[r],!0),n.children[r]instanceof Yl)){var o=n.children[r];this.constructRevisionForFootnote(o,t)}this.canConstructRevision(e.characterFormat)&&this.constructRevisionFromID(e.characterFormat,!0)},e.prototype.applyRevisionForCurrentPara=function(e,t,i,n,r){var o=e.getInline(t+1,0),s=o.element;o.element instanceof Zl&&""===o.element.text&&!(0,a.isNullOrUndefined)(o.element.previousElement)&&(s=o.element.previousElement);var l=!1;t===e.getLength()&&(l=!0),t===i&&e.nextSplitWidget&&(i+=s.length);var d=e.getInline(i,0).element;(0,a.isNullOrUndefined)(e.nextSplitWidget)||(r=!1);for(var h=0,c=e;c;)(0,a.isNullOrUndefined)(c)||(h+=c.getLength()),c=c.previousSplitWidget;if((0,a.isNullOrUndefined)(e.previousSplitWidget)||0===h||t===h||(l=!1),i>h&&(r=!0),(0,a.isNullOrUndefined)(s)||(0,a.isNullOrUndefined)(d))(0,a.isNullOrUndefined)(s)||l?(0,a.isNullOrUndefined)(d)||(d.removedIds.push(n),this.constructRevisionFromID(d,!0,!0)):(s.removedIds.push(n),this.constructRevisionFromID(s,!0,!0));else if(l||s!==d){for(;!(0,a.isNullOrUndefined)(s)&&s!==d;)l||(s.removedIds.push(n),this.constructRevisionFromID(s,!0,!0)),(0,a.isNullOrUndefined)(s.nextNode)||(s=s.nextNode instanceof td?s.nextNode:s.nextNode.nextValidNodeForTracking),l=!1;(0,a.isNullOrUndefined)(s)||l||(s.removedIds.push(n),this.constructRevisionFromID(s,!0,!0))}else s.removedIds.push(n),this.constructRevisionFromID(s,!0,!0);r&&(e.characterFormat.removedIds.length>0&&(e.characterFormat.removedIds=[]),e.characterFormat.removedIds.push(n),this.constructRevisionFromID(e.characterFormat,!0,!0))},e.prototype.insertBlockTable=function(e,t,i){var n=e.start.offset;e.start.paragraph.childWidgets.indexOf(e.start.currentWidget);t instanceof Rl&&n>0&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,n,e.start.currentWidget),e.selectParagraphInternal(e.start.paragraph,!0),this.checkInsertPosition(e)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,n.toString()),!0)),n>0&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0);var r=i.indexInOwner;if(i.containerWidget.childWidgets.splice(r,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),t instanceof Rl&&this.constructRevisionsForBlock(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)){var o=void 0;t instanceof Rl&&(o=t),t instanceof Al&&(o=this.documentHelper.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(o,"0"),!0)}},e.prototype.handleCut=function(e){var t=e.start,i=e.end,n=this.checkAndRemoveComments();e.isForward||(t=e.end,i=e.start);if(t.paragraph===i.paragraph&&t.offset+1===i.offset){t.paragraph.getInline(i.offset,0).element}var r=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3);var o=new ac(e.owner);this.setPositionForCurrentIndex(o,e.editPosition),e.selectContent(o,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.updateHistoryForComments(n)},e.prototype.insertInlineInternal=function(e,t){var i=this.selection,n=e.length,r=this.selection.getParagraphInfo(i.start);if(t=(0,a.isNullOrUndefined)(t)?"Insertion":t,i.start.paragraph.isEmpty()){var o=i.start.paragraph;"Center"!==o.paragraphFormat.textAlignment&&"Right"!==o.paragraphFormat.textAlignment||-1!==o.paragraphFormat.listFormat.listId||(o.x=this.owner.viewer.clientActiveArea.x);var s=!(0,a.isNullOrUndefined)(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing);o.childWidgets[0].children.push(e),e.line=o.childWidgets[0],this.owner.enableTrackChanges&&e.isValidNodeForTracking&&!s&&this.insertRevision(e,t),(e.removedIds.length>0||s)&&this.constructRevisionFromID(e,!0),e.linkFieldCharacter(this.documentHelper),e instanceof Yl&&(this.constructRevisionForFootnote(e,!0),s&&(e.isLayout=!1),"Footnote"===e.footnoteType&&this.updateFootnoteCollection(e),"Endnote"===e.footnoteType&&this.updateEndnoteCollection(e)),this.documentHelper.layout.reLayoutParagraph(o,0,0,void 0,void 0)}else{var l=0,d=i.start.currentWidget.getInline(i.start.offset,l),h=d.element;l=d.index,this.insertElementInternal(h,e,l,t,!0)}var c=e.revisions[0];(0,a.isNullOrUndefined)(c)||this.owner.trackChangesPane.updateCurrentTrackChanges(c),this.setPositionParagraph(r.paragraph,r.offset+n,!0)},e.prototype.insertElement=function(e,t){var i=!1,n=this.selection,r=0,o=void 0,s=-1,l=void 0,d=0,h=void 0,c=this.selection.getParagraphInfo(n.start),p=this.owner.enableTrackChanges,u=void 0,g=void 0,m=0;if(n.start.paragraph.isEmpty())l=(o=n.start.paragraph).childWidgets[0],s=0;else{var f=n.start.currentWidget.getInline(n.start.offset,m);u=f.element,m=f.index,s=(o=u.line.paragraph).childWidgets.indexOf(u.line),d=u.indexInOwner,l=u.line,m===u.length?(d++,h=!1):0===m?((0,a.isNullOrUndefined)(u.previousNode)&&(d=0),h=!0):(d++,(g=new Zl).characterFormat.copyFormat(u.characterFormat),g.text=u.text.substring(m),u.text=u.text.slice(0,m),u.isWidthUpdated=!1,u.revisions.length>0&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(u,g),l.children.splice(d,0,g),g.line=u.line)}for(var v=0;v<e.length;v++){r+=e[v].length,e[v]instanceof Zl&&e[v].text.indexOf(" ")>=0&&(this.documentHelper.triggerSpellCheck=!0);var y=e[v].revisions.length;e[v].ischangeDetected=!0,l.children.splice(d,0,e[v]),e[v].line=l,e[v].linkFieldCharacter(this.documentHelper);var w=this.updateRevisionForElement(u,e[v],m,0===v,g,h);p&&!w&&e[v].revisions.length===y&&this.checkToCombineRevisionsinBlocks(e[v],y===e[v].revisions.length,v>0&&v===e.length-1,"Insertion"),u=e[v],d++,e[v]instanceof Yl&&(this.pasteFootNoteType=e[v].footnoteType,i=!0)}if(!this.isPaste&&t&&((0,a.isNullOrUndefined)(o.paragraphFormat.listFormat.list)||!(0,a.isNullOrUndefined)(o.paragraphFormat.listFormat)&&-1===o.paragraphFormat.listFormat.listId)&&o.paragraphFormat.copyFormat(t),this.isPaste){if(this.isRemoteAction){var b=t.ownerBase.characterFormat.revisions,C=!1;for(v=0;v<b.length;v++){o.characterFormat.revisions.push(b[v]);for(var x=b[v].range,I=0;I<x.length;I++)if(x[I]instanceof ka&&x[I]==t.ownerBase.characterFormat){x.splice(I,1),x.push(o.characterFormat),C=!0;break}if(C)break}}o.textWrapWidth=!1,this.viewer.updateClientAreaForBlock(o,!0),o.x=this.viewer.clientActiveArea.x}return this.documentHelper.layout.reLayoutParagraph(o,s,0,this.isInsertField?void 0:o.paragraphFormat.bidi),this.setPositionParagraph(c.paragraph,c.offset+r,!0),i},e.prototype.updateRevisionForElement=function(e,t,i,n,r,o){if(!this.owner.enableTrackChanges)return!1;if((0,a.isNullOrUndefined)(e)&&(0,a.isNullOrUndefined)(r))return!1;var s=!!(0,a.isNullOrUndefined)(o),l=t.revisions.length;return n?s?(this.checkToMapRevisionWithInlineText(e,i,t,!1,"Insertion")||t.revisions.length>l?this.copyElementRevision(e,r,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(e,r),this.insertRevision(t,"Insertion")),!1):o?this.insertRevisionAtBegining(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion")},e.prototype.insertElementInternal=function(e,t,i,n,r,o){var s=e.line,l=s.paragraph,d=s.indexInOwner,h=e.indexInOwner,c=l.paragraphFormat.bidi&&e.isRightToLeft,p=!1;n=(0,a.isNullOrUndefined)(n)?"Insertion":n;var u=this.skipTracking(),g=this.owner.enableTrackChanges,m=!1,f=t.revisions.length;if(this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.isUndoing||this.owner.editorHistoryModule.isRedoing)&&t instanceof Zl&&(p=e.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text)),p)e.text=e.text.substring(0,i)+t.text+e.text.substring(i),e.isWidthUpdated=!1;else if(i===e.length)h=this.incrementCommentIndex(c,e,h),t.removedIds.length>0||u?this.constructRevisionFromID(t,!0,!1,e):!g||u||this.skipFieldDeleteTracking||(m=this.insertRevisionAtEnd(e,t,n)),t instanceof Yl&&(t.revisions.length>0&&(this.footnoteRevision=t.revisions[0]),this.constructRevisionForFootnote(t,!0),this.footnoteRevision=void 0),s.children.splice(h,0,t),t instanceof _l&&2===t.fieldType&&this.constructRevisionnsForLink(t,!1);else if(0===i)t.removedIds.length>0?this.constructRevisionFromID(t,!1,!1,void 0,h):!g||u||this.skipFieldDeleteTracking||(m=this.insertRevisionAtBegining(e,t,n)),(0,a.isNullOrUndefined)(e.previousNode)?(e.line.children.splice(0,0,t),h=0):e.line.children.splice(h,0,t);else if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.isHyperlinkField&&t instanceof _l&&1===t.fieldType&&t.removedIds.length>0)this.constructRevisionFromID(t,!1),s.children.splice(h,0,t);else{h=this.incrementCommentIndex(c,e,h);var v=new Zl;if(v.characterFormat.copyFormat(e.characterFormat),v.text=e.text.substring(i),e.revisions.length>0&&!g&&!u&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(e,v),e.text=e.text.substr(0,i),e.isWidthUpdated=!1,s.children.splice(h,0,v),v.line=e.line,m=!0,this.isTrackingFormField=e.previousElement instanceof _l,t.removedIds.length>0&&!this.isTrackingFormField)this.constructRevisionFromID(t,!1),this.copyElementRevision(e,v,!0);else if(this.owner.enableTrackChanges){if(t instanceof td||t instanceof Bd||t instanceof vd||t instanceof fd)t instanceof Bd?(this.splitRevisionForSpittedElement(e,v),this.copyElementRevision(e,t,!1)):this.copyElementRevision(e,v,!1);else this.checkToMapRevisionWithInlineText(e,i,t,c,n)||t.revisions.length>f?this.copyElementRevision(e,v,!0):t.revisions.length===f&&(this.splitRevisionForSpittedElement(e,v),this.insertRevision(t,n))}s.children.splice(h,0,t),h-=1}if(t.line=e.line,t instanceof td){var y=this.documentHelper.bookmarks;t.reference&&(t.reference.reference=t),y.containsKey(t.name)||y.add(t.name,t)}!(0,a.isNullOrUndefined)(t.line.paragraph.containerWidget)&&!(0,a.isNullOrUndefined)(t.line.paragraph.containerWidget.containerWidget)&&t.line.paragraph.containerWidget.containerWidget instanceof Dl&&(t.line.paragraph.containerWidget.containerWidget.height+=t.height),t.linkFieldCharacter(this.documentHelper),t instanceof id&&0===t.type&&(this.insertContentControlInCollection(t),this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.isUndoing||this.owner.editorHistoryModule.isRedoing)&&this.updatePropertiesToBlock(t,!0)),(t instanceof gd&&"Inline"!==t.textWrappingStyle||t instanceof hd)&&(-1===l.floatingElements.indexOf(t)&&l.floatingElements.push(t),-1===l.bodyWidget.floatingElements.indexOf(t)&&"Inline"!==t.textWrappingStyle&&l.bodyWidget.floatingElements.push(t)),!g||m||u||this.skipFieldDeleteTracking||this.checkToCombineRevisionsinBlocks(t,f===t.revisions.length,i===e.length,n),t instanceof Yl&&(u&&(t.isLayout=!1),"Footnote"===t.footnoteType&&(this.updateFootnoteCollection(t),this.updateFootNoteIndex()),"Endnote"===t.footnoteType&&(this.updateEndnoteCollection(t),this.updateEndNoteIndex())),t instanceof Bd||this.combineElementRevisionToPrevNxt(t),r&&!o&&this.documentHelper.layout.reLayoutParagraph(l,d,h,void 0,void 0)},e.prototype.incrementCommentIndex=function(e,t,i){return this.owner.editorHistoryModule&&this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentHistoryInfo&&(!this.owner.editorHistoryModule||!this.owner.editorHistoryModule.currentHistoryInfo||"SkipCommentInline"===this.owner.editorHistoryModule.currentHistoryInfo.action&&("SkipCommentInline"!==this.owner.editorHistoryModule.currentHistoryInfo.action||this.owner.editorHistoryModule.currentHistoryInfo.modifiedActions[0]!==this.editorHistory.currentBaseHistoryInfo&&(this.owner.editorHistoryModule.currentHistoryInfo.modifiedActions[0]===this.editorHistory.currentBaseHistoryInfo||t instanceof Bd)))||i++,i},e.prototype.constructRevisionFromID=function(e,t,i,n,r){if(e.removedIds.length>0){for(var o=0;o<e.removedIds.length;o++){var s=void 0;if(this.documentHelper.revisionsInternal.containsKey(e.removedIds[o])){s=this.documentHelper.revisionsInternal.get(e.removedIds[o]),e.revisions.push(s),(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(e,void 0,s));var l=e instanceof _l&&0===e.fieldType;t=!!t||!l&&this.skipTracking();var d=!1;if(this.editorHistory.isUndoing&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&this.owner.editorHistoryModule.currentBaseHistoryInfo.isHyperlinkField&&"Accept Change"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&e instanceof _l&&1===e.fieldType&&(d=!0),t&&(this.editorHistory.isRedoing&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&this.selection.isTOC()&&(t=!1),this.editorHistory.isRedoing&&this.owner.editorHistoryModule.currentHistoryInfo&&"RemoveHyperlink"===this.owner.editorHistoryModule.currentHistoryInfo.action&&e instanceof _l&&0===e.fieldType&&(t=!1)),!(0,a.isNullOrUndefined)(r)&&s.range.length>0&&s.range[s.range.length-1]instanceof Zl&&s.range[s.range.length-1].paragraph.indexInOwner===this.selection.start.paragraph.indexInOwner)s.range.splice(r,0,e);else if((0,a.isNullOrUndefined)(n)){var h=void 0;if(!(0,a.isNullOrUndefined)(this.owner.editorHistory)&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&!(e instanceof Ca)){var c=this.owner.selectionModule.start.paragraph.index,p=this.owner.selectionModule.start.paragraph.isInsideTable;e instanceof ka&&e.ownerBase?c=e.ownerBase.index:e instanceof Zl&&e.paragraph&&p&&(c=e.paragraph.index);for(var u=0,g=0;g<s.range.length;g++)if(s.range[g]instanceof Zl?u=s.range[g].paragraph.index:s.range[g]instanceof ka&&(u=s.range[g].ownerBase.index),c<u){h=g;break}t&&c===u&&(0,a.isNullOrUndefined)(h)&&s.range.length>0&&s.range[s.range.length-1]instanceof ka&&(h=s.range.length-1)}(0,a.isNullOrUndefined)(h)&&(h=t?s.range.length:0),s.range.splice(h,0,e)}else{var m=s.range.indexOf(n);-1===m&&d&&s.range.length>0&&(m=s.range.indexOf(s.range[s.range.length-1])),m>=0?s.range.splice(m+(t?1:0),0,e):s.range.splice(0,0,e)}i||this.owner.trackChangesPane.updateCurrentTrackChanges(s),this.updateRevisionCollection(s)}}e.removedIds=[]}else for(o=0;o<e.revisions.length;o++){var f=e.revisions[o];this.documentHelper.revisionsInternal.containsKey(f.revisionID)&&((f=this.documentHelper.revisionsInternal.get(f.revisionID)).range.splice(t?f.range.length:0,0,e),this.updateRevisionCollection(f))}},e.prototype.insertBlock=function(e,t){var i=!0,n=!1,r=this.selection;if(r.isEmpty||(i=this.removeSelectedContents(r),n=!0),i||r.selectContent(r.start,!1),this.insertBlockInternal(e,n,t),this.checkInsertPosition(r)){var o=void 0;o=e instanceof Rl?e:this.documentHelper.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.selection.getHierarchicalIndex(o,"0"),!0)}this.fireContentChange()},e.prototype.insertBlockInternal=function(e,t,i,n){var r=this.selection,o=this.selection.start.paragraph,s=this.selection.start.isAtParagraphStart;if(!r.start.isAtParagraphStart){if(e instanceof Rl){var l=r.start.clone();return this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||n||(r.start.isAtParagraphEnd&&this.isRevisionMatched(o.characterFormat,"Insertion")?this.insertRevisionForBlock(e,"Insertion",!1,this.retrieveRevisionByType(o.characterFormat,"Insertion")):this.insertRevisionForBlock(e,"Insertion")),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e.clone())),this.insertNewParagraphWidget(e,!1),void(this.isInsertingTOC||this.combineRevisions(e,l,this.selection.end))}this.updateInsertPosition(),o=o.combineWidget(this.owner.viewer),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(o)),this.splitParagraph(o,o.firstChild,0,r.start.currentWidget,r.start.offset,!1),r.selectParagraphInternal(this.selection.start.paragraph,!0)}var d=r.start.paragraph.containerWidget,h=r.start.paragraph.index;if(!(0,a.isNullOrUndefined)(d)){if(!(0,a.isNullOrUndefined)(this.editorHistory)&&((0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e.clone()),this.editorHistory.isRedoing&&t&&d.firstChild instanceof Rl&&d.firstChild.isEmpty()&&d.firstChild===d.lastChild&&e instanceof Rl&&e.isEmpty()))return;var c=d.childWidgets.indexOf(r.start.paragraph);d.childWidgets[d.childWidgets.length-1]===r.start.paragraph&&e instanceof Rl&&e.isSectionBreak&&(c++,h++),r.start.paragraph.isEmpty()&&r.start.paragraph.index===e.index&&1===d.childWidgets.length&&r.start.paragraph.containerWidget.containerWidget instanceof Dl&&this.owner.editorHistory.isUndoing&&d.childWidgets.splice(0,1),d.childWidgets.splice(c,0,e),e.containerWidget=d,e.index=h,e.height=0,e instanceof Al&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof Rl&&!n?this.insertRevisionForBlock(e,"Insertion"):e instanceof Rl?this.constructRevisionsForBlock(e,!0):e instanceof Al&&this.constructRevisionsForTable(e,!0),this.documentHelper.owner.editorModule.isRemoteAction&&!s&&e instanceof Al&&(this.updateNextBlocksIndex(e.nextWidget,!1),d.childWidgets.splice(e.indexInOwner+1,1)),e instanceof Rl&&this.documentHelper.layout.linkFieldInParagraph(e),this.isPaste&&!(0,a.isNullOrUndefined)(e.previousWidget)&&e.previousWidget instanceof Rl&&e instanceof Rl&&e.paragraphFormat.contextualSpacing&&!i&&this.documentHelper.layout.reLayoutParagraph(e.previousWidget,0,0),this.documentHelper.layout.layoutBodyWidgetCollection(h,d,e,!1,void 0,i)}},e.prototype.insertImage=function(e,t,i,n){this.insertImageInternal(e,!1,t,i,n)},e.prototype.insertImageAsync=function(e,t,i,n){return kc(this,void 0,void 0,(function(){return Fc(this,(function(r){switch(r.label){case 0:return[4,this.insertImageInternal(e,!1,t,i,n)];case 1:return r.sent(),[2]}}))}))},e.prototype.insertImageInternal=function(e,t,i,n,r){return kc(this,void 0,void 0,(function(){var o=this;return Fc(this,(function(s){return[2,new Promise((function(s,l){var d=o.selection.getCurrentFormField(),h="FormFieldsOnly"===o.documentHelper.protectionType&&!(0,a.isNullOrUndefined)(d)&&d.formFieldData instanceof Gl;if(!o.owner.isReadOnlyMode&&o.canEditContentControl||h){if((0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(n)){var c=document.createElement("img"),p=o;c.addEventListener("load",(function(){this.width=(0,a.isNullOrUndefined)(i)?this.width:i,this.height=(0,a.isNullOrUndefined)(n)?this.height:n,p.insertPicture(e,this.width,this.height,this.alt,!0),s()})),c.src=e}else o.insertPicture(e,i,n,r,t),s();setTimeout((function(){(0,a.isNullOrUndefined)(o.documentHelper)||o.viewer.updateScrollBars()}),30)}else s()}))]}))}))},e.prototype.insertTable=function(e,t){var i=this.selection.start;if(!this.owner.isReadOnlyMode&&this.canEditContentControl&&!this.selection.isPlainContentControl()){e=e||1,t=t||1;var n=new a.L10n("documenteditor",this.owner.defaultLocale);if(n.setLocale(this.documentHelper.owner.locale),t<1||t>this.documentHelper.owner.documentEditorSettings.maximumColumns){var r=n.getConstant("Number of columns must be between")+" 1 "+n.getConstant("and")+" "+this.documentHelper.owner.documentEditorSettings.maximumColumns.toString();el.DialogUtility.alert(r).enableRtl=this.documentHelper.owner.enableRtl}else{if(e<1||e>this.documentHelper.owner.documentEditorSettings.maximumRows){var o=n.getConstant("Number of rows must be between")+" 1 "+n.getConstant("and")+" "+this.documentHelper.owner.documentEditorSettings.maximumColumns.toString();return n.getConstant("Number of rows must be between 1 and 32767.").replace("32767",this.documentHelper.owner.documentEditorSettings.maximumRows.toString()),void(el.DialogUtility.alert(o).enableRtl=this.documentHelper.owner.enableRtl)}var s,l=this.createTable(e,t),d=i.paragraph.getContainerWidth()-l.tableFormat.leftIndent;l.splitWidthToTableCells(d);var h=i.paragraph.previousWidget;if(i.currentWidget.isFirstLine()&&0===i.offset&&h instanceof Al)return this.insertTableRows(l,h),void l.destroy();s=this.checkAndRemoveComments(),this.initHistory("InsertTable"),this.documentHelper.owner.isShiftingEnabled=!0,this.insertBlock(l),!(0,a.isNullOrUndefined)(l.containerWidget)&&!(0,a.isNullOrUndefined)(l.containerWidget.containerWidget)&&l.containerWidget.containerWidget instanceof Dl&&(l.containerWidget.containerWidget.height+=l.height,this.isTableInsert=!0);var c=this.documentHelper.getFirstParagraphInFirstCell(l).childWidgets[0];i.setPosition(c,!0),this.selection.end.setPositionInternal(i);var p=this.documentHelper.getLastParagraphInLastCell(l.getSplitWidgets().pop()),u=p.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(p,u.toString())),this.reLayout(this.selection),this.isTableInsert=!1,this.updateHistoryForComments(s)}}},e.prototype.insertRow=function(e,t){var i=e?"Above":"Below";if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var n=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(n.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===i?"InsertRowAbove":"InsertRowBelow"),this.documentHelper.owner.isShiftingEnabled=!0;var r=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],o=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],s=r.ownerTable.combineWidget(this.owner.viewer),a="Below"===i?o.ownerRow:r.ownerRow;if(this.editorHistory)this.cloneTableToHistoryInfo(s);this.rowInsertion(t,i,r,o,a,s,!0)}this.reLayout(this.selection,!0)}},e.prototype.rowInsertion=function(e,t,i,n,r,o,s){var l=e||this.getRowCountToInsert(),d=[],h=r.rowIndex;if("Below"===t){h++;var c=(0,a.isNullOrUndefined)(n.previousWidget)||n.columnIndex===n.previousWidget.columnIndex+1;n.cellIndex!==n.columnIndex&&c&&r.rowIndex+i.cellFormat.rowSpan-1===n.ownerRow.rowIndex||n.cellFormat.rowSpan>1&&!(0,a.isNullOrUndefined)(r.nextWidget)&&r.nextWidget instanceof Ul&&(n.cellFormat.rowSpan+=l,r=r.nextWidget),r.bottomBorderWidth=0}for(var p=0;p<l;p++){var u=this.updateRowspan(r,"Below"===t?n:i,t),g=this.createRowAndColumn(u.count,p,h,o);g.rowFormat=r.rowFormat.cloneFormat(),g.rowFormat.ownerBase=g,this.owner.enableTrackChanges&&this.insertRevision(g.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(g,u.cellFormats),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(g),d.push(g)}o.insertTableRowsInternal(d,h,s);var m=void 0,f=void 0;if(o.childWidgets[h]instanceof Ul)m=o.childWidgets[h].firstChild,f=this.selection.getFirstParagraph(m);else{for(var v=void 0;!(v instanceof Al);)v=o.nextRenderedWidget;f=this.documentHelper.getFirstParagraphInFirstCell(v)}s&&this.documentHelper.layout.reLayoutTable(o),this.selection.selectParagraphInternal(f,!0)},e.prototype.autoFitTable=function(e){!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl&&this.insertAutoFitTable(e)},e.prototype.insertAutoFitTable=function(e,t){if((0,a.isNullOrUndefined)(t)){var i=this.selection.start,n=this.selection.end;this.selection.isForward||(i=this.selection.end,n=this.selection.start),t=(t=this.selection.getTable(i,n)).getSplitWidgets()[0]}var r=this.documentHelper.layout.getParentTable(t);(0,a.isNullOrUndefined)(r)||(this.setOffsetValue(this.selection),r=r.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===e?"TableAutoFitToContents":"FitToWindow"===e?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(r),r.updateProperties(!0,t,e),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(t),this.reLayout(this.selection,!0))},e.prototype.rowInsertionForCE=function(e,t,i,n,r,o,s,a){for(var l=[],d=0;d<i;d++){var h=this.createRowAndColumn(t,d,e,n);this.documentHelper.owner.parser.parseRowFormat(r,h.rowFormat,0);for(var c=0;c<t;c++){var p=h.childWidgets[c];this.documentHelper.owner.parser.parseCellFormat(o[c],p.cellFormat,0),this.documentHelper.owner.parser.parseParagraphFormat(0,s[c],p.childWidgets[0].paragraphFormat),this.documentHelper.owner.parser.parseCharacterFormat(0,a[c],p.childWidgets[0].characterFormat)}this.owner.enableTrackChanges&&this.insertRevision(h.rowFormat,"Insertion"),l.push(h)}n.insertTableRowsInternal(l,e,!0);var u=void 0,g=void 0;if(n.childWidgets[e]instanceof Ul)u=n.childWidgets[e].firstChild,g=this.selection.getFirstParagraph(u);else{for(var m=void 0;!(m instanceof Al);)m=n.nextRenderedWidget;g=this.documentHelper.getFirstParagraphInFirstCell(m)}this.documentHelper.layout.reLayoutTable(n),this.selection.selectParagraphInternal(g,!0),this.reLayout(this.selection,!0)},e.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},e.prototype.updateRowspan=function(e,t,i){for(var n=e.getPreviousRowSpannedCells(!0),r=0,o=[],s=0;s<e.childWidgets.length;s++){for(var l=e.childWidgets[s],d=!1,h=(0,a.isNullOrUndefined)(l.previousWidget)||l.columnIndex!==l.previousWidget.columnIndex+1,c=0;c<n.length;c++)if(h){var p=n[c],u=p.ownerRow.rowIndex+p.cellFormat.rowSpan-1;if(l.columnIndex<p.columnIndex&&l.cellIndex!==l.columnIndex&&!d&&(d=!0,r++,o.push(l.cellFormat)),1===t.cellFormat.rowSpan)if(u>l.ownerRow.rowIndex){if("Above"===i&&p.ownerRow===t.ownerRow)continue;p.cellFormat.rowSpan+=1,n.splice(c,1),c--}else l.cellIndex!==l.columnIndex&&h&&u===l.ownerRow.rowIndex&&("Above"===i?(p.cellFormat.rowSpan+=1,n.splice(c,1),c--):(r++,o.push(p.cellFormat),n.splice(c,1),c--));else if(p!==t){if("Above"===i&&(p.ownerRow===t.ownerRow||p.columnIndex===t.columnIndex))continue;p.columnIndex!==t.columnIndex&&p.ownerRow.rowIndex!==l.ownerRow.rowIndex&&(u>t.ownerRow.rowIndex||"Above"===i&&u===t.ownerRow.rowIndex)&&(p.cellFormat.rowSpan+=1,n.splice(c,1),c--)}}-1===n.indexOf(l)&&l.cellFormat.rowSpan>1&&(d=!0),d||(r++,o.push(l.cellFormat))}return o.sort((function(e,t){return e.ownerBase.columnIndex-t.ownerBase.columnIndex})),{count:r,cellFormats:o}},e.prototype.getInsertedTable=function(e,t){e.childWidgets&&e.childWidgets.length>0&&(e.childWidgets.splice(0,t),this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(e))},e.prototype.insertTableRows=function(e,t){this.initHistory("InsertTableBelow"),e.containerWidget=t.containerWidget;var i=(t=t.combineWidget(this.owner.viewer)).childWidgets[t.childWidgets.length-1],n=t.childWidgets.length,r=!1,o=e.tableFormat.borders,s=t.tableFormat.borders;o.left.lineStyle===s.left.lineStyle&&o.top.lineStyle===s.top.lineStyle&&o.right.lineStyle===s.right.lineStyle&&o.bottom.lineStyle===s.bottom.lineStyle||(r=!0),t.insertTableRowsInternal(e.childWidgets,n,!0,r);var a=t.clone();this.getInsertedTable(a,n);var l=this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]);t.isDefaultFormatUpdated=!1,this.documentHelper.layout.reLayoutTable(t),this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(l,"0"),!0),this.selection.start.setPosition(l.firstChild,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1),this.selection.end.setPosition(l.firstChild,!0),this.reLayout(this.selection)},e.prototype.insertColumn=function(e,t){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var i=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"===i?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;var n=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),o=n.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(o),this.selection.owner.isLayoutEnabled=!1;var s=n.columnIndex;"Right"===i&&(s=r.columnIndex+r.cellFormat.columnSpan);for(var l=void 0,d=void 0,h=t||this.getColumnCountToInsert(),c=[],p=0;p<h;p++)for(var u=0;u<o.childWidgets.length;u++){var g=o.childWidgets[u];(d=this.createColumn(this.selection.getLastParagraph(n))).index=u,d.rowIndex=g.rowIndex,d.containerWidget=g,d.cellFormat.copyFormat(n.cellFormat),d.cellFormat.rowSpan=1,(0,a.isNullOrUndefined)(l)&&(l=this.selection.getFirstParagraph(d)),0===s?g.childWidgets.splice(s,0,d):this.insertSpannedCells(g,c,d,s),this.copyCellFormats(g,s),this.editorHistory.currentBaseHistoryInfo.insertedNodes.push(d)}this.tableReLayout(o,l,d)}}},e.prototype.cellInsertionForCE=function(e,t,i,n,r){var o=void 0;o=this.createColumn(void 0);var s=new zl(o.childWidgets[0]);o.childWidgets[0].childWidgets.push(s),o.index=t.index,o.rowIndex=t.rowIndex,o.containerWidget=t,this.documentHelper.owner.parser.parseCellFormat(i,o.cellFormat,0),this.documentHelper.owner.parser.parseParagraphFormat(0,n,o.childWidgets[0].paragraphFormat),this.documentHelper.owner.parser.parseCharacterFormat(0,r,o.childWidgets[0].characterFormat),o.cellFormat.rowSpan=1,t.childWidgets.splice(e,0,o)},e.prototype.copyCellFormats=function(e,t){var i=e.childWidgets[t];if(!(0,a.isNullOrUndefined)(i)){var n=i.childWidgets[0];t==e.childWidgets.length-1?--t:++t;for(var r=e.childWidgets[t],o=r.childWidgets[0];o instanceof Al;)o=o.childWidgets[0].childWidgets[0].childWidgets[0];var s=r.childWidgets[0],l=void 0,d=void 0;s.childWidgets.length>0&&(l=s.childWidgets[0]).children.length>0&&(d=l.children[0]),n.paragraphFormat.copyFormat(s.paragraphFormat),(0,a.isNullOrUndefined)(d)?n.characterFormat.copyFormat(s.characterFormat):n.characterFormat.copyFormat(d.characterFormat)}},e.prototype.copyContent=function(e){if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.owner.enableCollaborativeEditing){var t=this.documentHelper.getLastParagraphBlock(e),i=this.documentHelper.getFirstParagraphBlock(e);0===i.childWidgets.length&&(i.childWidgets[0]=new zl(i)),0===t.childWidgets.length&&(t.childWidgets[0]=new zl(t));var n=i.firstChild,r=t.lastChild,o=t.lastChild.getEndOffset(),s=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,n,0,r,o,!1,!0);this.editorHistory.currentBaseHistoryInfo.pasteContent=s}},e.prototype.tableReLayout=function(e,t,i,n){e.updateRowIndex(0);var r=this.documentHelper.layout.getParentTable(e);r?r.fitChildToClientArea():e.fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.skipScrollToPosition=!0,n&&this.copyContent(e),this.documentHelper.layout.reLayoutTable(e),this.selection.start.setPosition(t.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(i).firstChild,!1),(this.checkIsNotRedoing()||(0,a.isNullOrUndefined)(this.editorHistory))&&this.reLayout(this.selection)},e.prototype.createTable=function(e,t){this.selection.start.paragraph;var i=new Al;i.tableFormat.preferredWidthType="Auto",i.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,i.tableFormat.initializeTableBorders();for(var n=0;n<e;){var r=this.createRowAndColumn(t,n);r.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(r.rowFormat,"Insertion"),r.containerWidget=i,i.childWidgets.push(r),n++}return i},e.prototype.createRowAndColumn=function(e,t,i,n){var r=n,o=this.selection.start.paragraph,s=new Ul;s.rowFormat=new Ca(s),s.index=t;for(var l=0;l<e;l++){if(!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(r))if(i&&i>0&&r.childWidgets[i-1]&&r.childWidgets[i-1].childWidgets[l]){for(var d=r.childWidgets[i-1].childWidgets[l].childWidgets[0];d instanceof Al;)d=d.childWidgets[0].childWidgets[0].childWidgets[0];o=d}else if(0==i){for(d=r.childWidgets[i].childWidgets[l].childWidgets[0];d instanceof Al;)d=d.childWidgets[0].childWidgets[0].childWidgets[0];o=d}var h=this.createColumn(o,!0);h.index=l,h.rowIndex=t,h.containerWidget=s,s.childWidgets.push(h)}return s},e.prototype.createColumn=function(e,t){var i=new Vl,n=new Rl;if(t){n.paragraphFormat.copyFormat(e.paragraphFormat),n.paragraphFormat.leftIndent=0,n.paragraphFormat.firstLineIndent=0;var r=void 0;(0,a.isNullOrUndefined)(e.childWidgets[0])||(r=e.childWidgets[0].children[0]),(0,a.isNullOrUndefined)(r)?n.characterFormat.copyFormat(e.characterFormat):n.characterFormat.copyFormat(r.characterFormat)}return n.containerWidget=i,i.childWidgets.push(n),i.cellFormat=new Ma(i),i},e.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return 1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;e=0;for(var n=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),r=0;r<n.length;r++)t.paragraph.associatedCell.ownerRow===n[r].ownerRow&&e++}return 0===e?1:e},e.prototype.getRowCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;return this.selection.isForward||(t=this.selection.end,i=this.selection.start),(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(this.selection.getTable(t,i))?0===e?1:e:t.paragraph.associatedCell===i.paragraph.associatedCell||t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},e.prototype.getOwnerCell=function(e){for(var t=void 0,i=e?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell,n=e?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell,r=(t=i).ownerTable;!(0,a.isNullOrUndefined)(r)&&r.containerWidget instanceof Vl&&r!==n.ownerTable;)r=(t=r.containerWidget).ownerTable;return t},e.prototype.getOwnerRow=function(e){for(var t,i=e?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow,n=e?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow,r=(t=i).ownerTable;!(0,a.isNullOrUndefined)(r)&&r.containerWidget instanceof Vl&&r!==n.ownerTable;)r=(t=r.containerWidget.ownerRow).ownerTable;return t},e.prototype.getOwnerTable=function(e){var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,n=this.selection.end.paragraph.associatedCell.ownerTable;for(t=e?i:n;t.containerWidget instanceof Vl&&t!==(e?n:i);)t=t.containerWidget.ownerTable;return t},e.prototype.mergeSelectedCellsInTable=function(){if(this.canMergeCells())if(this.owner.enableTrackChanges){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.alertDialog=el.DialogUtility.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.confirmCellMerge.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl}else this.confirmCellMerge()},e.prototype.confirmCellMerge=function(){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start);var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),r=this.selection.getContainerCellOf(i,n);if(r.ownerTable.contains(n)&&!this.selection.containsCell(r,n)){var o=i.ownerTable.combineWidget(this.owner.viewer);i=this.selection.getSelectedCell(i,r),n=this.selection.getSelectedCell(n,r);var s=this.mergeSelectedCells(o,i,n),l=this.selection.getFirstParagraph(s);e.setPosition(l.firstChild,!0);var d=this.selection.getLastParagraph(s);t.setPosition(d.lastChild,!1),this.selection.fireSelectionChanged(!1)}(this.checkIsNotRedoing()||(0,a.isNullOrUndefined)(this.editorHistory))&&this.reLayout(this.selection,!1),(0,a.isNullOrUndefined)(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)},e.prototype.mergeSelectedCells=function(e,t,i){this.cloneTableToHistoryInfo(e);this.selection.owner.isLayoutEnabled=!1;var n=this.selection.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.selection.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth,l=this.updateSelectedCellsInTable(n,r,o,s);n=l.start,r=l.end;for(var d,h=i.cellFormat.rowSpan,c=e.childWidgets.indexOf(i.ownerRow),p=e.childWidgets.indexOf(t.ownerRow),u=void 0,g=p;g<=c;g++){for(var m=e.childWidgets[g],f=0;f<m.childWidgets.length;f++){var v=m.childWidgets[f],y=this.selection.getCellLeft(m,v);if(Pa.round(n,2)<=Pa.round(y,2)&&Pa.round(y,2)<Pa.round(r,2)){var w=v.lastChild;if(w instanceof Rl&&w.isEmpty()&&v.childWidgets.pop(),(0,a.isNullOrUndefined)(u))u=v,d=w;else{g===p&&(u.cellFormat.preferredWidth+=v.cellFormat.preferredWidth,u.cellFormat.columnSpan+=v.cellFormat.columnSpan,this.mergeBorders(u,v));for(var b=0;b<v.childWidgets.length;b++){(I=v.childWidgets[b].clone()).containerWidget=u,u.childWidgets.push(I)}m.childWidgets.splice(f,1),v.destroy(),f--;for(var C=this.documentHelper.contentControlCollection.length-1;C>-1;C--){var x=this.documentHelper.contentControlCollection[C];(0,a.isNullOrUndefined)(x.contentControlProperties)&&this.documentHelper.contentControlCollection.splice(C)}}}}if((0===u.childWidgets.length||1===u.childWidgets.length&&u.childWidgets[0]instanceof Al)&&d){var I=d.clone();u.childWidgets.push(I),I.containerWidget=u}if(0===m.childWidgets.length){var k=e.childWidgets.indexOf(m);m.updateRowBySpannedCells(),e.childWidgets.splice(k,1),c--,g--}}return!(0,a.isNullOrUndefined)(u)&&p<c&&(u.cellFormat.rowSpan=c-p+h),this.updateBlockIndexAfterMerge(u),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,u},e.prototype.mergeBorders=function(e,t){var i=void 0,n=null;if((0,a.isNullOrUndefined)(e.cellFormat.borders)||(i=e.cellFormat.borders),(0,a.isNullOrUndefined)(t.cellFormat.borders)||(n=t.cellFormat.borders),!(0,a.isNullOrUndefined)(i)||!(0,a.isNullOrUndefined)(n))if((0,a.isNullOrUndefined)(i))(i=new va(e.cellFormat)).copyFormat(n);else{if((0,a.isNullOrUndefined)(n))return;e.ownerRow.rowIndex===t.ownerRow.rowIndex&&(i.top=e.getBorderBasedOnPriority(i.top,n.bottom),i.bottom=e.getBorderBasedOnPriority(i.bottom,n.bottom))}},e.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},e.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start,this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var e=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),i=this.selection.getContainerCellOf(e,t);if(i.ownerTable.contains(t)&&!this.selection.containsCell(i,t)){e=this.selection.getSelectedCell(e,i),t=this.selection.getSelectedCell(t,i);var n=1;if(e.ownerRow===t.ownerRow){for(var r=e.ownerRow.childWidgets.indexOf(e),o=r;o<=e.ownerRow.childWidgets.indexOf(t);o++){var s=e.ownerRow.childWidgets[o],l=s.previousWidget;if(o!==r){if(s.cellFormat.rowSpan!==n)return!1;if(!(0,a.isNullOrUndefined)(l)&&s.columnIndex!==l.cellFormat.columnSpan+l.columnIndex)return!1}n=s.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(e.ownerTable,e,t)}return!1},e.prototype.canMergeSelectedCellsInTable=function(e,t,i){var n=e.childWidgets.indexOf(i.ownerRow),r=e.childWidgets.indexOf(t.ownerRow),o=this.selection.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,l=this.selection.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(o,s,l,d);o=h.start,s=h.end;for(var c=0,p=0,u=!1,g=!1,m=[],f=r;f<=n;f++){for(var v=e.childWidgets[f],y=0,w=0,b=!1,C=0;C<v.childWidgets.length;C++){var x=v.childWidgets[C],I=this.selection.getCellLeft(v,x);if(this.checkCellWithInSelection(o,s,I)){u=!1,g=!1,x.cellFormat.rowSpan>1&&m.push(x),b||(y=I,w=I,b=!0);var k=x.previousWidget;0!==w&&Pa.round(w,0)!==Pa.round(I,0)&&(w=I),w+=Pa.convertPointToPixel(x.cellFormat.cellWidth);var F=this.checkPrevOrNextCellIsWithinSel(o,s,x,!0),P=this.checkPrevOrNextCellIsWithinSel(o,s,x,!1),S=0===m.length||1===m.length&&m[0]===x,T=this.checkCurrentCell(m,x,F,P);if(f===n&&!(0,a.isNullOrUndefined)(k)&&x.cellFormat.rowSpan>k.cellFormat.rowSpan&&!T)return!1;if(f!==r)for(var H=0;H<m.length;H++){var E=m[H].ownerRow.rowIndex+m[H].cellFormat.rowSpan-1;if(E>=v.rowIndex){if(m[H].columnIndex>x.columnIndex?g=!0:u=!0,f===n&&m[H]!==x&&E>x.ownerRow.rowIndex+x.cellFormat.rowSpan-1)return!1;E!==v.rowIndex||this.checkPrevOrNextCellIsWithinSel(o,s,x,!1)||m.splice(m.indexOf(m[H]),1)}}if(F&&!(0,a.isNullOrUndefined)(k)&&S&&x.columnIndex!==k.columnIndex+1&&this.checkCellWidth(x))return!1}}if(f===r)c=y,p=w;else{if(w>0&&y>0&&(!u&&Math.round(c)!==Math.round(y)||!g&&Math.round(p)!==Math.round(w)))return!1;if(f===n)return!0}}return!1},e.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.documentHelper.selection.getCellLeft(e.ownerRow,e),n=this.documentHelper.selection.getCellLeft(e.ownerRow,t)+Pa.convertPointToPixel(t.cellFormat.cellWidth);return Pa.round(n,2)!==Pa.round(i,2)},e.prototype.checkCellWithInSelection=function(e,t,i){return Pa.round(e,2)<=Pa.round(i,2)&&Pa.round(i,2)<Pa.round(t,2)},e.prototype.checkPrevOrNextCellIsWithinSel=function(e,t,i,n){var r,o=n?i.previousWidget:i.nextWidget;return!(0,a.isNullOrUndefined)(o)&&(r=this.documentHelper.selection.getCellLeft(o.ownerRow,o),this.checkCellWithInSelection(e,t,r))},e.prototype.checkCurrentCell=function(e,t,i,n){var r=t.ownerRow;if(e.length>0)for(var o=0;o<e.length;o++){var s=e[o].ownerRow,a=s.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!n&&!i)return!0;if(e[o]!==t&&s.rowIndex<r.rowIndex&&a===r.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},e.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},e.prototype.insertNewParagraphWidget=function(e,t){if(this.updateInsertPosition(),this.insertParagraph(e,t),!t){var i=void 0,n=e;do{n=i=this.selection.getNextParagraphBlock(n)}while(i&&i.equals(e));(0,a.isNullOrUndefined)(i)?this.selection.selectParagraphInternal(e,!0):this.selection.selectParagraphInternal(i,!0)}this.fireContentChange()},e.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,n=this.selection.start.offset;this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentBaseHistoryInfo&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(n=0);var r=this.selection.start.paragraph;if(r=r.combineWidget(this.owner.viewer),t){var o=this.selection.getLineLength(r.lastChild),s=e.firstChild?e.firstChild.children.length:0;if(this.moveInlines(r,e,s,n,i,o,r.lastChild),r.characterFormat.revisions.length>0)for(;r.characterFormat.revisions.length>0;){var a=r.characterFormat.revisions.shift();-1===e.characterFormat.revisions.indexOf(a)&&e.characterFormat.revisions.push(a)}if(this.updateCharacterFormatRevision(r,e),e.characterFormat.removedIds.length>0){for(;e.characterFormat.removedIds.length>0;)r.characterFormat.removedIds.push(e.characterFormat.removedIds.shift());this.constructRevisionFromID(r.characterFormat,!0)}}else if(n>0){var l=r.getLength();if(this.moveInlines(r,e,0,0,r.firstChild,n,i),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&l===n&&r.characterFormat.revisions.length>0)for(;r.characterFormat.revisions.length>0;)e.characterFormat.revisions.push(r.characterFormat.revisions.shift())}var d=r.getSplitWidgets(),h=(r=t?d[d.length-1]:d[0]).containerWidget.childWidgets.indexOf(r);t&&h++;var c=r.containerWidget;e.index=r.index,e.containerWidget=c,c.childWidgets.splice(h,0,e),this.constructRevisionsForBlock(e,!0),this.updateNextBlocksIndex(t?r:e,!0),e.height=0,e instanceof Rl&&this.documentHelper.layout.linkFieldInParagraph(e),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,c,e,!1)},e.prototype.updateCharacterFormatRevision=function(e,t){for(var i=t.characterFormat.revisions,n=0;n<i.length;n++){var r=i[n];if(-1!==r.range.indexOf(e.characterFormat)){var o=r.range.indexOf(e.characterFormat);r.range.splice(o,1,t.characterFormat);break}}},e.prototype.moveInlines=function(e,t,i,n,r,o,s,a){if(0===t.childWidgets.length){var l=new zl(t);t.childWidgets.push(l)}var d=!1;this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h];if(r===c&&s===c){i=this.moveContent(c,n,o,i,t);break}if(s===c){i=this.moveContent(c,0,o,i,t);break}r===c?(d=!0,i=this.moveContent(c,n,this.documentHelper.selection.getLineLength(c),i,t)):d&&(i=this.moveContent(c,0,this.documentHelper.selection.getLineLength(c),i,t))}this.removeEmptyLine(e),e.isInsideTable||a||(this.viewer.updateClientArea(e.bodyWidget,e.bodyWidget.page),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.moveContent=function(e,t,i,n,r){for(var o=0,s=0;s<e.children.length;s++){var a=e.children[s];if(t>=o+a.length||a instanceof md)a instanceof md||(o+=a.length);else{var l=0;t>o&&(l=t-o);var d=i-o;if(d>a.length&&(d=a.length),l>0&&(o+=l),0===l&&d===a.length){if(a instanceof dd){var h=e.paragraph.floatingElements.indexOf(a);-1!==h&&e.paragraph.floatingElements.splice(h,1)}r.firstChild.children.splice(n,0,a),a.line=r.firstChild,n++,e.children.splice(s,1),s--}else if(a instanceof Zl){var c=new Zl;c.characterFormat.copyFormat(a.characterFormat),c.text=a.text.substr(l,d-l),a.ischangeDetected=!0,c.ischangeDetected=!0,r.firstChild.children.splice(n,0,c),c.line=r.firstChild,n++,this.updateRevisionForMovedContent(a,c),a.text=a.text.slice(0,l)+a.text.slice(d),a.isWidthUpdated=!1,a.ischangeDetected=!0}if(i<=o+d-l)break;o+=d-l}}return n},e.prototype.updateRevisionForMovedContent=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i],r=n.range.indexOf(e);t.revisions.splice(0,0,n),n.range.splice(r,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(n)}},e.prototype.updateComplexWithoutHistory=function(e,t,i){var n=this.documentHelper.selection;if(0===e){var r=new ac(n.owner);this.setPositionForCurrentIndex(r,t),this.documentHelper.layout.reLayoutParagraph(r.paragraph,0,0),this.setPositionForCurrentIndex(n.start,i),this.setPositionForCurrentIndex(n.end,i)}if(1===e){r=new ac(n.owner);this.setPositionForCurrentIndex(r,t);var o=new ac(n.owner);this.setPositionForCurrentIndex(o,i),this.documentHelper.layout.reLayoutParagraph(r.paragraph,0,0),o.paragraph!==r.paragraph&&this.documentHelper.layout.reLayoutParagraph(o.paragraph,0,0)}n.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget()),n.owner.isShiftingEnabled=!1,n.start.updatePhysicalPosition(!0),n.isEmpty?n.end.setPositionInternal(n.start):n.end.updatePhysicalPosition(!0),n.upDownSelectionLength=n.end.location.x,n.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.owner.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},e.prototype.reLayout=function(e,t,i){if(!(0,a.isNullOrUndefined)(this.previousBlockToLayout)){var n=this.previousBlockToLayout;this.documentHelper.layout.layoutBodyWidgetCollection(n.index,n.bodyWidget,n,!1,!1),this.previousBlockToLayout=void 0}if(!this.documentHelper.isComposingIME&&this.editorHistory&&this.editorHistory.isHandledComplexHistory()&&(this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&("DragAndDropContent"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.shiftLayoutedItems(!0),this.startParagraph=void 0,this.endParagraph=void 0),this.isHandledComplex=!1,!this.editorHistory.currentHistoryInfo||"ColumnBreak"!==this.editorHistory.currentHistoryInfo.action&&"PageBreak"!==this.editorHistory.currentHistoryInfo.action))return this.shiftFootnoteContent(),void this.selection.updateContentControlHighlightSelection();if((0,a.isNullOrUndefined)(e.editRegionHighlighters)||e.editRegionHighlighters.clear(),(0,a.isNullOrUndefined)(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.documentHelper.layout.checkAndShiftEndnote(!0),this.selection.updateContentControlHighlightSelection(),this.documentHelper.owner.enableHeaderAndFooter||this.owner.viewer.updateScrollBars(),e.owner.isShiftingEnabled&&!this.documentHelper.isRowOrCellResizing||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),(0,a.isNullOrUndefined)(t)&&(t=e.isEmpty),this.owner.showRevisions&&this.owner.trackChangesPane.isUpdateTrackChanges(this.owner.revisions.length)&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled){e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0;var r=e.start.paragraph.bodyWidget,o=r.getSplitWidgets();r=o[o.length-1];var s=!!(this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ColumnBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.isMultiColumnDoc);if("Word2010"!==this.documentHelper.compatibilityMode||!(r.isWord2010NextColumn||!(0,a.isNullOrUndefined)(r.nextRenderedWidget)&&(r.nextRenderedWidget.isWord2010NextColumn||r.nextRenderedWidget.sectionFormat.numberOfColumns>1&&"NoBreak"===r.nextRenderedWidget.sectionFormat.breakCode))||r instanceof Bl||!(0,a.isNullOrUndefined)(r.containerWidget)&&r.containerWidget instanceof Dl)if(!(!(0,a.isNullOrUndefined)(r.nextRenderedWidget)&&"NoBreak"===r.nextRenderedWidget.sectionFormat.breakCode&&this.documentHelper.layout.isMultiColumnDoc||"NoBreak"===r.sectionFormat.breakCode&&r.sectionIndex===r.page.bodyWidgets[0].sectionIndex&&r.sectionFormat.numberOfColumns>1||s)||r instanceof Bl||!(0,a.isNullOrUndefined)(r.containerWidget)&&r.containerWidget instanceof Dl)this.documentHelper.layout.shiftLayoutedItems(!0);else{var l=this.documentHelper.selection.start,d=this.documentHelper.selection.end,h=this.selection.getParagraphInfo(l),c=this.selection.getParagraphInfo(d),p=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),u=this.selection.getHierarchicalIndex(c.paragraph,c.offset.toString());this.documentHelper.layout.shiftLayoutedItems(!0),this.setPositionForCurrentIndex(l,p),this.setPositionForCurrentIndex(d,u),this.documentHelper.selection.selectPosition(l,d),this.documentHelper.owner.enableHeaderAndFooter||this.owner.viewer.updateScrollBars()}else this.layoutWholeDocument(!0,!0);this.documentHelper.owner.enableHeaderAndFooter&&(this.updateHeaderFooterWidget(),this.owner.viewer.updateScrollBars()),this.documentHelper.isRowOrCellResizing||(this.shiftFootnoteContent(),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0)}else this.documentHelper.owner.enableHeaderAndFooter&&(this.updateHeaderFooterWidget(),this.owner.viewer.updateScrollBars());this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&this.editorHistory.undoStack.length>0&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]instanceof Cc&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory()),i?!(0,a.isNullOrUndefined)(e)&&this.documentHelper.formFields.length>0&&e.highlightFormFields():(this.fireContentChange(),this.owner.enableLockAndEdit&&this.owner.viewer.updateScrollBars(),this.owner.documentHelper.layout.isRelayout=!1,this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1)},e.prototype.shiftFootnoteContent=function(){(0,a.isNullOrUndefined)(this.selection.start.paragraph)||!(0,a.isNullOrUndefined)(this.selection.start.paragraph.bodyWidget)&&!(0,a.isNullOrUndefined)(this.selection.start.paragraph.bodyWidget.containerWidget)&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof Dl&&("Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(this.selection.start.paragraph.bodyWidget.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent()))},e.prototype.updateHeaderFooterWidget=function(e){(0,a.isNullOrUndefined)(e)&&(e=this.selection.start.paragraph.bodyWidget),this.updateHeaderFooterWidgetToPage(e),this.shiftPageContent(e.headerFooterType,e.sectionFormat)},e.prototype.updateHeaderFooterWidgetToPage=function(e){e.page;for(var t="EvenHeader"===e.headerFooterType||"EvenFooter"===e.headerFooterType,i="FirstPageHeader"===e.headerFooterType||"FirstPageFooter"===e.headerFooterType,n=0;n<this.documentHelper.pages.length;n++){var r=this.documentHelper.pages[n];!r.bodyWidgets[0].sectionFormat.differentFirstPage||!i||r.headerWidgetIn.headerFooterType!=e.headerFooterType&&r.footerWidgetIn.headerFooterType!=e.headerFooterType?r.bodyWidgets[0].sectionFormat.differentFirstPage&&(i||!i&&0==r.index||r.sectionIndex!=r.previousPage.sectionIndex)||(r.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?t&&(n+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):t||(n+1)%2==0||(n>0||!r.bodyWidgets[0].sectionFormat.differentFirstPage)&&this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header"))):this.updateHeaderFooterWidgetToPageInternal(r,e,-1!==e.headerFooterType.indexOf("Header"))}},e.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){if(i?t!=e.headerWidgetIn&&t.page.headerWidget==e.headerWidget:t!=e.footerWidgetIn&&t.page.footerWidget==e.footerWidget){var n=t.clone();this.documentHelper.layout.clearBlockWidget(n.childWidgets,!0,!0,!0),n.page=e,n.parentHeaderFooter=t,this.owner.viewer.updateHFClientArea(n.sectionFormat,i),n=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,n);var r=void 0;i?(r=e.headerWidgetIn,e.headerWidget=n):(r=e.footerWidgetIn,e.footerWidget=n),this.removeFieldInWidget(r),this.removeFieldInWidget(r,void 0,!0),r.destroy()}},e.prototype.removeFieldInWidget=function(e,t,i,n){(0,a.isNullOrUndefined)(t)&&(t=!1);for(var r=0;r<e.childWidgets.length;r++)this.removeFieldInBlock(e.childWidgets[r],t,i,n)},e.prototype.removeFieldInBlock=function(e,t,i,n){if(e instanceof Al){if(e.wrapTextAround&&!(0,a.isNullOrUndefined)(e.bodyWidget)){var r=e.bodyWidget.floatingElements.indexOf(e);-1!==r&&e.bodyWidget.floatingElements.splice(r,1)}this.removeFieldTable(e,t,i,n)}else if(e instanceof Ul)for(var o=0;o<e.childWidgets.length;o++)this.removeFieldInWidget(e.childWidgets[o],t,i,n);else this.removeField(e,t,i,n)},e.prototype.removeFieldTable=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.removeFieldInWidget(o.childWidgets[s],t,i,n)},e.prototype.shiftFootnotePageContent=function(e){var t=this.documentHelper.pages[0].bodyWidgets[0];if(!(0,a.isNullOrUndefined)(e)){var i=this.documentHelper.pages.indexOf(e.page);t=this.documentHelper.pages[i].bodyWidgets[0]}(0,a.isNullOrUndefined)(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget,!(0,a.isNullOrUndefined)(e)),(0,a.isNullOrUndefined)(t.page.endnoteWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},e.prototype.shiftPageContent=function(e,t){var i;if(-1!==e.indexOf("First"))i=0;else if(t.differentOddAndEvenPages){var n=-1!==e.indexOf("Even");i=t.differentFirstPage?n?1:2:n?1:0}else 1===(i=t.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(i=0);var r=this.documentHelper.pages[i].bodyWidgets[0];do{if(-1!==e.indexOf("Header")){var o=r.page.headerWidget,s=!o.isEmpty||o.isEmpty&&this.owner.enableHeaderAndFooter,l=r.firstChild,d=Pa.convertPointToPixel(t.topMargin),h=Pa.convertPointToPixel(t.headerDistance);if(s&&(d=Math.max(h+r.page.headerWidget.height,d)),l.y!==d&&"NoBreak"!==r.sectionFormat.breakCode){this.owner.viewer.updateClientArea(r,r.page);var c=(l=l.combineWidget(this.owner.viewer)).previousRenderedWidget;c&&(!l.containerWidget.equals(c.containerWidget)||c.containerWidget.lastChild instanceof Rl&&(c.containerWidget.lastChild.isEndsWithPageBreak||c.containerWidget.lastChild.isEndsWithColumnBreak)||(this.owner.viewer.cutFromTop(c.y+c.height),this.documentHelper.layout.updateContainerWidget(l,c.containerWidget,c.indexInOwner+1,!1))),this.documentHelper.blockToShift=l}}else this.checkAndShiftFromBottom(r.page,r.page.footerWidget);for(this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));r;){var p=r;do{var u=r.getSplitWidgets();r=u[u.length-1].nextRenderedWidget}while(r&&p.page===r.page);if(r){if(0===i)break;if(r.page.index+1===0&&1===i||r.page.index+1!==0&&2===i)break;var g=r.page.nextPage;if(!(0,a.isNullOrUndefined)(g)&&g.bodyWidgets[0].equals(r)){r=g.bodyWidgets[0];break}}}}while(r)},e.prototype.checkAndShiftFromBottom=function(e,t,i){var n,r=e.bodyWidgets[0];if(r.childWidgets.length>1){for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];if(s.y+s.height>t.y){n=s;break}if(!(t instanceof Dl)&&r.childWidgets.length-1===o&&s.y+s.height<t.y){n=s;break}}(0,a.isNullOrUndefined)(n)&&i&&(n=r.lastChild),(0,a.isNullOrUndefined)(n)||(this.owner.viewer.updateClientArea(r,e,!0),this.owner.viewer.cutFromTop(n.y),this.documentHelper.blockToShift=n)}},e.prototype.allowFormattingInFormFields=function(e){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!(0,a.isNullOrUndefined)(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(e.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},e.prototype.insertContentControlInCollection=function(e){var t=this.documentHelper.contentControlCollection,i=this.selection.getElementPosition(e).startPosition;(0,a.isNullOrUndefined)(i)&&(i=this.selection.isForward?this.selection.start:this.selection.end);var n=void 0,r=!1;if(-1===t.indexOf(e))for(var o=0;o<t.length;o++){var s=t[o];if(n=this.selection.getElementPosition(s).startPosition,!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(n)&&i.isExistBefore(n)){t.splice(o,0,e),r=!0;break}}r||t.push(e)},e.prototype.getContentControl=function(){var e=this.getContentControls();if(e.length>0)return e[e.length-1]},e.prototype.getContentControls=function(){for(var e=[],t=0;t<this.documentHelper.contentControlCollection.length;t++)if(!this.documentHelper.contentControlCollection[t].paragraph.isInHeaderFooter||"Continuous"!==this.documentHelper.owner.layoutType){var i=this.documentHelper.contentControlCollection[t];if(this.owner.enableHeaderAndFooter&&i.paragraph.isInHeaderFooter){if(this.pushContentControlByOrder(i,e))break}else if(!i.paragraph.isInHeaderFooter&&this.pushContentControlByOrder(i,e))break}return e},e.prototype.pushContentControlByOrder=function(e,t){var i=e.line;if(!(0,a.isNullOrUndefined)(i.children)&&!(0,a.isNullOrUndefined)(i.children.length)){var n=this.selection.getPosition(e);if(n.startPosition&&n.endPosition){var r=n.startPosition,o=n.endPosition,s=this.selection.start,l=this.selection.end;this.selection.isForward||(s=this.selection.end,l=this.selection.start);var d=s.isExistAfter(r)||s.isAtSamePosition(r),h=l.isExistBefore(o)||l.isAtSamePosition(o);if(d&&h)t.push(e);else if(!d)return!0}}return!1},e.prototype.checkPlainTextContentControl=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(t=this.selection.start,e=this.selection.end);var i=0,n=0,r=e.currentWidget.getInline(e.offset,i),o=t.currentWidget.getInline(t.offset,n);i=r.index,n=o.index;var s,l,d=r.element,h=o.element;if(d&&d.contentControlProperties&&"Text"===d.contentControlProperties.type||h&&h.contentControlProperties&&"Text"===h.contentControlProperties.type){if(d=this.getContentControl(),!(0,a.isNullOrUndefined)(d)&&d.contentControlProperties){var c=d.line.getOffset(d,1);(s=new ac(this.owner)).setPositionParagraph(d.line,c)}else s=e;if(h.contentControlProperties&&!(0,a.isNullOrUndefined)(d)&&d.reference){var p=(h=d.reference).line.getOffset(h,h.length);(l=new ac(this.owner)).setPositionParagraph(h.line,p)}else l=t;this.selection.selectRange(s,l)}else e.paragraph.contentControlProperties&&"Text"===e.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},e.prototype.onApplyCharacterFormat=function(e,t,i,n){var r=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!r||!(0,a.isNullOrUndefined)(this.selection)&&this.selection.checkContentControlLocked(!0))){this.documentHelper.layout.isBidiReLayout=!0;var o=this.documentHelper.selection;if((!o.owner.isReadOnlyMode||r)&&o.owner.isDocumentLoaded){i=!(0,a.isNullOrUndefined)(i)&&i,n=!(0,a.isNullOrUndefined)(n)&&n;var s=e[0].toUpperCase()+e.slice(1),l=o.start.paragraph;l.childWidgets[l.childWidgets.length-1];if(this.checkPlainTextContentControl(),o.isEmpty&&"List"!==o.contextType&&!n)return o.skipFormatRetrieval=!0,o.end.isAtParagraphEnd?(this.initHistory(s),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(l.characterFormat,e,t,i),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):o.fireSelectionChanged(!0),void(o.skipFormatRetrieval=!1);if("highlightColor"===e&&o.start.isInSameParagraph(o.end)){var d=o.start,h=o.end;if(this.selection.isForward||(h=o.start,d=o.end),h.offset===o.getLineLength(h.currentWidget)+1&&h.offset-1===d.offset)return}this.setOffsetValue(o),this.initHistory(s),"List"===o.contextType?this.applyCharacterFormatForListText(o,e,t,i):this.updateSelectionCharacterFormatting(e,t,i),this.documentHelper.layout.isBidiReLayout=!1}}},e.prototype.applyCharacterFormatForListText=function(e,t,i,n){var r=e.getListLevel(e.start.paragraph);if(!(0,a.isNullOrUndefined)(r)){var o=r.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(e,o,"bold",!o.bold);break;case"italic":this.applyListCharacterFormatByValue(e,o,"italic",!o.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,o,"fontColor",i);break;case"fontFamily":this.applyListCharacterFormatByValue(e,o,"fontFamily",i);break;case"fontSize":this.applyListCharacterFormatByValue(e,o,"fontSize",i);break;case"highlightColor":this.applyListCharacterFormatByValue(e,o,"highlightColor",i);break;case"baselineAlignment":o.baselineAlignment===i&&(i="Normal"),this.applyListCharacterFormatByValue(e,o,"baselineAlignment",i);break;case"strikethrough":o.strikethrough===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"strikethrough",i);break;case"underline":o.underline===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"underline",i);break;case"characterFormat":this.applyListCharacterFormatByValue(e,o,void 0,i)}}},e.prototype.applyListCharacterFormatByValue=function(e,t,i,n){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,n,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},e.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},e.prototype.updateListTextSelRange=function(e,t,i,n){this.documentHelper.owner.isShiftingEnabled=!0;var r=e.start,o=e.end;e.isForward||(r=e.end,o=e.start),this.initHistoryPosition(e,r);var s=e.getListLevel(e.start.paragraph);this.applyCharFormatValue(s.characterFormat,t,i,n),this.startSelectionReLayouting(r.paragraph,e,r,o)},e.prototype.updateInsertPosition=function(){var e=this.documentHelper.selection,t=e.start;e.isForward||(t=e.end),!this.editorHistory||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},e.prototype.setOffsetValue=function(e){var t=this.selection.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.selection.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},e.prototype.toggleHighlightColor=function(e){var t=this.documentHelper.selection;((0,a.isNullOrUndefined)(e)||"NoColor"===e)&&(e="Yellow"),t.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},e.prototype.toggleSubscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.toggleSuperscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.increaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},e.prototype.applyBullet=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,"Bullet",t)},e.prototype.applyNumbering=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,t,"Verdana")},e.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},e.prototype.clearFormattingInternal=function(e,t){var i=this.documentHelper.selection;this.setPreviousBlockToLayout(),this.initComplexHistory("ClearFormat"),(i.isEmpty||!(0,a.isNullOrUndefined)(e)&&e)&&(i.start.moveToParagraphStartInternal(i,!1),i.end.moveToParagraphEndInternal(i,!1)),this.setOffsetValue(i),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(i),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(i),((0,a.isNullOrUndefined)(e)||e)&&(this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1)),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(i),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&(t?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.clearFormatting=function(){this.clearFormattingInternal()},e.prototype.updateProperty=function(e,t){var i=this.selection;if((!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&i.owner.isDocumentLoaded){var n=i.start;i.end;i.isForward||(n=i.end,i.start);var r=0,o=n.currentWidget.getInline(n.offset,r),s=o.element;r=o.index;var l=n.paragraph;if((0,a.isNullOrUndefined)(s)||s.length!==r||this.selection.isEmpty||(s=s.nextNode),1===e){var d="None";(0,a.isNullOrUndefined)(s)?(0,a.isNullOrUndefined)(l)||(d=l.characterFormat.underline):d=s.characterFormat.underline,this.selection.characterFormat.underline=t===d?"None":t}else{var h="Normal";(0,a.isNullOrUndefined)(s)?(0,a.isNullOrUndefined)(l)||(h=l.characterFormat.baselineAlignment):h=s.characterFormat.baselineAlignment,h===t&&(t="Normal"),this.selection.characterFormat.baselineAlignment=t}}},e.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.documentHelper.preDefinedStyles.keys;t<i.length;t++){var n=i[t];e+=this.documentHelper.preDefinedStyles.get(n)+","}return e.slice(0,-1)+"]}"},e.prototype.intializeDefaultStyles=function(){for(var e=this.owner.getStyleNames("Paragraph"),t=0,i=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6","Heading 7","Heading 8","Heading 9","Header","Footer"].filter((function(t){return-1===e.indexOf(t)}));t<i.length;t++){var n=i[t];this.createStyle(this.documentHelper.preDefinedStyles.get(n))}},e.prototype.createStyle=function(e,t){return this.createStyleIn(e,t).name},e.prototype.createStyleIn=function(e,t){var i=JSON.parse(e),n=this.documentHelper.styles.findByName(i.name),r=i.type;return(0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(t)||!t?(void 0!==n&&(i.name=this.getUniqueStyleName(i.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),i,this.documentHelper.styles,!0)):r===n.type?this.setStyle(n,i):(i.name=this.getUniqueStyleName(i.name),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),i,this.documentHelper.styles,!0)),this.owner.notify(K,{}),this.documentHelper.styles.findByName(i.name)},e.prototype.setStyle=function(e,t){if(!(0,a.isNullOrUndefined)(t.basedOn)){var i=this.documentHelper.styles.findByName(t.basedOn);if((0,a.isNullOrUndefined)(i)){var n=this.getStyle(t.basedOn,JSON.parse(this.getCompleteStyles())),r=void 0;r=(0,a.isNullOrUndefined)(n)||n.type!==t.type?"Paragraph"===t.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):n,e.basedOn=this.documentHelper.styles.findByName(r.name)}else i.type===t.type&&(e.basedOn=i)}if(!(0,a.isNullOrUndefined)(t.next)&&"Paragraph"===t.type)if(t.next===t.name)e.next=e;else{var o=this.documentHelper.styles.findByName(t.next);(0,a.isNullOrUndefined)(o)||o.type!==e.type?e.next=e:e.next=o}if(!(0,a.isNullOrUndefined)(t.link)){var s=this.documentHelper.styles.findByName(t.link),l=void 0;if((0,a.isNullOrUndefined)(s)||"Character"!==s.type){var d={};d.characterFormat=t.characterFormat,void 0!==this.documentHelper.styles.findByName(t.name+" Char").name?d.name=this.getUniqueStyleName(t.name)+" Char":d.name=t.name+" Char",d.type="Character",d.basedOn="Default Paragraph Font",l=d,this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),l,this.documentHelper.styles),e.link=this.documentHelper.styles.findByName(l.name)}else this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,s.characterFormat),e.link=s;if("Character"==t.type)for(var h=0;h<this.documentHelper.styles.length;h++){var c=this.documentHelper.styles.getItem(h),p=c.link,u=void 0===p?"":p.name;"Paragraph"===c.type&&u===t.link&&((0,a.isNullOrUndefined)(c.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,c.characterFormat))}}(0,a.isNullOrUndefined)(t.paragraphFormat)||this.documentHelper.owner.parser.parseParagraphFormat(0,t.paragraphFormat,e.paragraphFormat),(0,a.isNullOrUndefined)(t.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,e.characterFormat)},e.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},e.prototype.getUniqueStyleName=function(e){for(var t=this.getUniqueName(e),i=this.documentHelper.styles.findByName(t);!(0,a.isNullOrUndefined)(i);)t=this.getUniqueStyleName(i.name),i=this.documentHelper.styles.findByName(t);return t},e.prototype.getUniqueName=function(e){var t=e.match(/\d+$/);return!(0,a.isNullOrUndefined)(t)&&t.length>0?e.replace(t[0],(parseInt(t[0],10)+1).toString()):e+"_1"},e.prototype.updateSelectionCharacterFormatting=function(e,t,i){switch((0,a.isNullOrUndefined)(e)&&(e="CharacterFormat"),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t),e){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1,this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,i);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},e.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,e,t,!1)},e.prototype.updateCharacterFormatWithUpdate=function(e,t,i,n,r){r=!(0,a.isNullOrUndefined)(r)&&r,this.documentHelper.owner.isShiftingEnabled=!0;var o=e.start,s=e.end;if(e.isEmpty||e.isForward||(o=e.end,s=e.start),e.isEmpty&&r){var l=o.offset,d=o.clone(),h=s.clone();this.selection.selectCurrentWord(),l!==this.selection.start.offset&&l!==this.selection.end.offset-1||(this.selection.start=d,this.selection.end=h)}this.applyCharFormatSelectedContent(o.paragraph,e,o,s,t,i,n)},e.prototype.applyCharFormatSelectedContent=function(e,t,i,n,r,o,s){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n)){l=e;do{l=l instanceof Rl?this.applyCharFormat(l,t,i,n,r,o,s):this.applyCharFormatForTable(0,l,t,i,n,r,o,s)}while(l)}else{var a;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),a=i.paragraph.associatedCell;for(var l=this.applyCharFormatCell(a,t,i,n,r,o,s);l;)l=l instanceof Rl?this.applyCharFormat(l,t,i,n,r,o,s):this.applyCharFormatForTable(0,l,t,i,n,r,o,s);var d=a.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.containerWidget,d,!1)}},e.prototype.applyCharFormatForSelectedPara=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.children.length;a++){var l=s.children[a];l.isWidthUpdated=!1,this.applyCharFormatValue(l.characterFormat,i,n,r)}this.applyCharFormatValue(e.characterFormat,i,n,r)},e.prototype.splittedLastParagraph=function(e){var t=e.getSplitWidgets();return t[t.length-1]},e.prototype.getNextParagraphForCharacterFormatting=function(e,t,i,n,r,o){var s=e.getSplitWidgets();return e=s[s.length-1],this.documentHelper.selection.getNextRenderedBlock(e)},e.prototype.applyCharFormat=function(e,t,i,n,r,o,s){var l=e.previousSplitWidget,d=!1;!(0,a.isNullOrUndefined)(l)&&l instanceof Rl&&l.isEndsWithPageBreak&&(d=!0),e=e.combineWidget(this.owner.viewer);var h=0,c=t.getParagraphLength(e),p=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,u=n.offset,g=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;if((0,a.isNullOrUndefined)(t)||e===i.paragraph&&(h=i.offset),e.equals(n.paragraph)){m=e.childWidgets[e.childWidgets.length-1];t.isParagraphLastLine(m)&&n.currentWidget===m&&(u===t.getLineLength(m)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,r,o,s)}else{var m=e.childWidgets[e.childWidgets.length-1];"highlightColor"===r&&t.isParagraphLastLine(m)&&i.currentWidget===m&&i.offset===t.getLineLength(m)||this.applyCharFormatValue(e.characterFormat,r,o,s),u=c}for(var f=p;f<=g;f++){var v=e.childWidgets[f];f!==p&&(h=t.getStartLineOffset(v)),u=v===n.currentWidget?n.offset:t.getLineLength(v);for(var y=0,w=void 0,b=-1,C=!0,x=0;x<v.children.length;C?x++:x--){var I=v.children[x];if(I.isWidthUpdated=!1,!(I instanceof md))if(w===I&&(w=void 0,x=b,b=-1,C=!0),h>=y+I.length)y+=I.length;else{var k=0;h>y&&(k=h-y);var F=u-y,P=I.length;F>P&&(F=P);var S=this.applyCharFormatInline(I,t,k,F,r,o,s);if(("fontColor"!==r||0===e.characterFormat.revisions.length)&&!e.equals(n.paragraph)&&this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&v.children[x].indexInOwner===v.children.length-1&&v===v.paragraph.lastChild&&!(0,a.isNullOrUndefined)(I)&&I.revisions.length>0){var T=I.revisions[I.revisions.length-1];e.characterFormat.revisions.push(T),T.range.push(e.characterFormat),this.owner.trackChangesPane.updateCurrentTrackChanges(T)}if(x+=S,u<=y+P)break;y+=P}}}var H=n.paragraph;if(this.documentHelper.layout.reLayoutParagraph(e,d?0:p,0),!e.equals(H))return this.getNextParagraphForCharacterFormatting(e,i,n,r,o,s)},e.prototype.toggleBold=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=e}},e.prototype.toggleItalic=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=e}},e.prototype.changeCase=function(e){if(!this.selection.isEmpty&&(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())){this.initHistory(e),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection,i=t.start,n=t.end;t.isForward||(i=t.end,n=t.start),this.changeSelectedTextCase(t,i,n,e),this.reLayout(t)}},e.prototype.changeSelectedTextCase=function(e,t,i,n,r){var o=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(t,!0);var s=this.editorHistory.isUndoing;s&&!(0,a.isNullOrUndefined)(r)&&r.length>0&&(this.removedTextNodes=r);var l=e.isForward?i.selection.endOffset:i.selection.startOffset;this.changeTextCase(t.paragraph,e,t,i,n,s),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i=e.getTextPosBasedOnLogicalIndex(l),this.checkEndPosition(e)&&this.updateHistoryPosition(i,!1),e.selectPosition(t,i))},e.prototype.changeTextCase=function(e,t,i,n,r,o){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,n))this.changeCaseParagraph(e,t,i,n,r,o);else{var s;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),s=i.paragraph.associatedCell,this.changeCaseParaFormatInCell(s,i,n,r,o);var a=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1)}},e.prototype.changeCaseParagraph=function(e,t,i,n,r,o){e=e.combineWidget(this.owner.viewer);var s=0,l=t.getParagraphLength(e),d=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,h=n.offset,c=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;(0,a.isNullOrUndefined)(t)||e===i.paragraph&&(s=i.offset),e.equals(n.paragraph)||(h=l);for(var p=d;p<=c;p++){this.checkLastLetterSpaceDot="",this.checkLastLetterSpace="";var u=e.childWidgets[p];p!==d&&(s=t.getStartLineOffset(u)),h=u===n.currentWidget?n.offset:t.getLineLength(u);for(var g=0,m=void 0,f=-1,v=!0,y=0;y<u.children.length;v?y++:y--){var w=u.children[y],b=!1;if((0===y||y>0&&u.children[y-1]instanceof Zl)&&(b=!0,y>0)){var C=u.children[y-1];this.checkLastLetterSpace=C.text.substr(-1),this.checkLastLetterSpaceDot=C.text.substr(-2)}if(!(w instanceof md))if(m===w&&(m=void 0,y=f,f=-1,v=!0),s>=g+w.length)g+=w.length;else{var x=0;s>g&&(x=s-g);var I=h-g,k=w.length;if(I>k&&(I=k),y+=this.changeCaseInline(w,t,x,I,r,o,b),h<=g+k)break;g+=k}}}var F=n.paragraph;this.documentHelper.layout.reLayoutParagraph(e,d,0),e.equals(F)||this.changeCaseNextBlock(e,i,n,r,o)},e.prototype.changeCaseInline=function(e,t,i,n,r,o,s){if(e instanceof Zl){if(0!==i||n!==e.length)return this.changeCaseInlineInternal(e,t,i,n,r,o,s);this.changeCaseInlineInternal(e,t,i,n,r,o,s)}return 0},e.prototype.addRemovedTextNodes=function(e,t){if(e instanceof Zl&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){var i=this.editorHistory.currentBaseHistoryInfo.removedNodes[0];(0,a.isNullOrUndefined)(i)&&((i=new Zl).text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i)),i.text+=t,i.isWidthUpdated=!1}},e.prototype.changeCaseInlineInternal=function(e,t,i,n,r,o,s){var l,d=0,h=!1,c=e.line.children.indexOf(e),p=e.paragraph,u=p.childWidgets.indexOf(e.line);if(e.isWidthUpdated=!1,i>0){var g=e.text.substr(i,n-i);if(this.addRemovedTextNodes(e,g),(l=new Zl).characterFormat.copyFormat(e.characterFormat),l.line=e.line,"CapitalizeEachWord"===r)h=" "===e.text.substr(i-1,1);if("SentenceCase"===r)h=". "===e.text.substr(i-2,2);l.characterFormat.allCaps="Uppercase"===r&&!o,l.text=this.getChangeCaseText(g,r,o,h),l.isRightToLeft=e.isRightToLeft,c++,e.line.children.splice(c,0,l),d++}n<e.length&&((l=new Zl).characterFormat.copyFormat(e.characterFormat),l.text=e.text.substring(n),l.line=e.line,l.isRightToLeft=e.isRightToLeft,c++,e.line.children.splice(c,0,l),d++);var m=e;if(0===i){var f=m.text.substr(0,n);if(this.addRemovedTextNodes(e,f),"SentenceCase"===r){if(". "===this.checkLastLetterSpaceDot)h=!0;else if(0===u&&""===this.checkLastLetterSpaceDot){if(s)h=p.childWidgets[0].children[0]===m;else h=!0}this.checkLastLetterSpaceDot=m.text.substr(-2)}else if("CapitalizeEachWord"==r){if(s)h=0===t.getIndexInInline(e)||" "===this.checkLastLetterSpace;else if(m.previousElement instanceof Bd||m.previousElement instanceof td||m.previousElement instanceof _l){var v=(0,a.isNullOrUndefined)(m.previousElement.previousElement)?void 0:m.previousElement.previousElement.text;h=!(!(0,a.isNullOrUndefined)(v)&&!Pa.endsWith(v))}else h=!0;this.checkLastLetterSpace=m.text.charAt(m.length-1)}m.characterFormat.allCaps="Uppercase"===r&&!o,m.text=this.getChangeCaseText(f,r,o,h)}else{var y=m.text.substr(0,i);m.text=y}return d},e.prototype.changeCaseNextBlock=function(e,t,i,n,r){e=this.getNextBlockForChangeCase(e,t,i,n,r),(0,a.isNullOrUndefined)(e)||(e instanceof Rl?this.changeCaseParagraph(e,this.documentHelper.selection,t,i,n,r):this.changeCaseForTable(0,e,this.documentHelper.selection,t,i,n,r))},e.prototype.getNextBlockForChangeCase=function(e,t,i,n,r){var o=e.getSplitWidgets();return e=o[o.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e)},e.prototype.getChangeCaseText=function(e,t,i,n){if(i){if(!(0,a.isNullOrUndefined)(this.removedTextNodes)&&this.removedTextNodes.length>0){var r=this.removedTextNodes[0],o=r.text.substr(0,e.length);r.text=r.text.substr(o.length,r.length-o.length),e=o,""===r.text&&this.removedTextNodes.splice(0,1)}}else switch(t){case"SentenceCase":e=this.sentencecase(e,n);break;case"Uppercase":e=e.toUpperCase();break;case"Lowercase":e=e.toLowerCase();break;case"CapitalizeEachWord":e=this.capitalizeFirst(e,n);break;case"ToggleCase":e=this.togglecase(e)}return e},e.prototype.capitalizeFirst=function(e,t){if(/\b\w+'\w+\b/g.test(e)){e.split(/[^a-zA-Z0-9'\-]+/).toString();return e.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")}for(var i=e.split(/[^\w]+/g).map((function(e,i){return 0===i?t?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})),n=e.split(/\w+/).filter(Boolean),r=[],o=0;o<Math.max(i.length,n.length);o++)i[o]&&r.push(i[o]),n[o]&&r.push(n[o]);return r.join("")},e.prototype.sentencecase=function(e,t){return e.split(". ").map((function(e,i){return 0===i?t?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join(". ")},e.prototype.togglecase=function(e){return e.split("").map((function(e){return e===e.toLowerCase()?e.toUpperCase():e.toLowerCase()})).join("")},e.prototype.changeCaseForTable=function(e,t,i,n,r,o,s){t=t.combineWidget(this.owner.viewer);for(var a=e;a<t.childWidgets.length;a++){for(var l=t.childWidgets[a],d=0;d<l.childWidgets.length;d++)this.changeCaseForSelectedCell(l.childWidgets[d],i,o,s);if(r.paragraph.isInsideTable&&i.containsRow(l,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.changeCaseNextBlock(t,n,r,o,s)},e.prototype.changeCaseForSelectedCell=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof Rl?this.changeCaseForSelectedPara(o,t,i,n):this.changeCaseForSelTable(o,t,i,n)}},e.prototype.changeCaseForSelectedPara=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s="",l=0;l<o.children.length;l++){var d=o.children[l];d.characterFormat.allCaps="Uppercase"===i&&!n;var h=!1;!(0,a.isNullOrUndefined)(d)&&d instanceof Zl&&(this.addRemovedTextNodes(d,d.text),"CapitalizeEachWord"===i?(h=0===l||" "===s,s=d.text.substr(d.length-1,1)):"SentenceCase"===i&&(h=". "===d.text.substr(d.length-2,2)||0===l),d.text=this.getChangeCaseText(d.text,i,n,h),d.isWidthUpdated=!1)}},e.prototype.changeCaseForSelTable=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.changeCaseForSelectedCell(o.childWidgets[s],t,i,n)},e.prototype.changeCaseParaFormatInCell=function(e,t,i,n,r){var o=this.documentHelper.selection;if(i.paragraph.isInsideTable){var s=o.getContainerCellOf(e,i.paragraph.associatedCell);if(s.ownerTable.contains(i.paragraph.associatedCell)){var a=o.getSelectedCell(e,s),l=o.getSelectedCell(i.paragraph.associatedCell,s);o.containsCell(s,i.paragraph.associatedCell)?o.isCellSelected(s,t,i)?this.changeCaseParaForCellInternal(s,o,n,r):a===s?this.changeCaseParagraph(t.paragraph,o,t,i,n,r):this.changeCaseParaForRow(a.ownerRow,o,t,i,n,r):this.changeCaseParaForTableCell(s.ownerTable,s,l,n,r)}else this.changeCaseParaForRow(s.ownerRow,o,t,i,n,r)}else{var d=o.getContainerCell(e);this.changeCaseParaForRow(d.ownerRow,o,t,i,n,r)}},e.prototype.changeCaseParaForTableCell=function(e,t,i,n,r){var o=this.documentHelper.selection,s=o.getCellLeft(t.ownerRow,t),a=s+t.cellFormat.cellWidth,l=o.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(s,a,l,d);s=h.start,a=h.end;for(var c=e.childWidgets.indexOf(i.ownerRow),p=e.childWidgets.indexOf(t.ownerRow);p<=c;p++)for(var u=e.childWidgets[p],g=0;g<u.childWidgets.length;g++){var m=o.getCellLeft(u,u.childWidgets[g]);Math.round(s)<=Math.round(m)&&Math.round(m)<Math.round(a)&&this.changeCaseParaForCellInternal(u.childWidgets[g],o,n,r)}},e.prototype.changeCaseParaForCellInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];o instanceof Rl?this.changeCaseForSelectedPara(o,t,i,n):this.changeCaseParaFormatTableInternal(o,t,i,n)}},e.prototype.changeCaseParaFormatTableInternal=function(e,t,i,n){for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++)this.changeCaseParaForCellInternal(o.childWidgets[s],t,i,n)},e.prototype.changeCaseParaForRow=function(e,t,i,n,r,o){for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.changeCaseParaForCellInternal(a.childWidgets[l],t,r,o);if(n.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,n.paragraph.associatedCell))return}this.changeCaseNextBlock(e.ownerTable,i,n,r,o)},e.prototype.toggleAllCaps=function(){if(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("allCaps");this.selection.characterFormat.allCaps=e}},e.prototype.toggleChangeCase=function(){var e=["Uppercase","Lowercase","CapitalizeEachWord"];return this.casingIndex++,this.casingIndex>=e.length&&(this.casingIndex=0),e[this.casingIndex]},e.prototype.getCurrentSelectionValue=function(e){var t=!1;if("bold"===e||"italic"===e){var i=this.getSelectedCharacterFormat();"bold"===e&&(t=!i.bold),"italic"===e&&(t=!i.italic)}return t},e.prototype.getSelectedCharacterFormat=function(){var e=0,t=this.selection.start;this.selection.isForward||(t=this.selection.end);var i=t.currentWidget,n=i.getInline(t.offset,e),r=n.element;e=n.index;var o=i.paragraph.characterFormat;if(!(0,a.isNullOrUndefined)(r))if(this.selection.isEmpty&&"List"===this.selection.contextType){var s=this.selection.getListLevel(this.selection.start.paragraph);s.characterFormat.uniqueCharacterFormat&&(o=s.characterFormat)}else o=this.selection.isEmpty||e!==r.length?r.characterFormat:(0,a.isNullOrUndefined)(r.nextNode)?i.paragraph.characterFormat:r.nextNode.characterFormat;return o},e.prototype.toggleUnderline=function(e){(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&this.updateProperty(1,e)},e.prototype.toggleStrikethrough=function(e){if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var t=void 0;t=(0,a.isNullOrUndefined)(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=t}},e.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(e.fontSize>=72&&e.fontSize<80)return 80;if(e.fontSize>=80)return e.fontSize+10;for(var n=0;n<i.length;n++)if(e.fontSize<i[n])return i[n]}else if("string"==typeof t&&"decrement"===t&&e.fontSize>1){if(e.fontSize<=8)return e.fontSize-1;if(e.fontSize>72&&e.fontSize<=80)return 72;if(e.fontSize>80)return e.fontSize-10;for(n=0;n<i.length;n++)if(e.fontSize<=i[n])return i[n-1]}return e.fontSize},e.prototype.applyCharFormatInline=function(e,t,i,n,r,o,s){return 0===i&&n===e.length?(this.applyCharFormatValue(e.characterFormat,r,o,s),0):e instanceof Zl?this.formatInline(e,t,i,n,r,o,s):0},e.prototype.formatInline=function(e,t,i,n,r,o,s){var l,d=0,h=e,c=e.line.children.indexOf(h),p=(e.paragraph,0);return i>0&&(p+=1,(l=new Zl).characterFormat.copyFormat(e.characterFormat),(0,a.isNullOrUndefined)(e.contentControlProperties)||(l.contentControlProperties=e.contentControlProperties),l.line=e.line,l.text=e.text.substr(i,n-i),l.isRightToLeft=e.isRightToLeft,this.applyCharFormatValue(l.characterFormat,r,o,s),c++,h.line.children.splice(c,0,l),d++,this.updateRevisionForFormattedContent(e,l,p)),n<h.length&&(p+=1,(l=new Zl).characterFormat.copyFormat(e.characterFormat),(0,a.isNullOrUndefined)(e.contentControlProperties)||(l.contentControlProperties=e.contentControlProperties),l.text=h.text.substring(n),l.line=e.line,l.isRightToLeft=e.isRightToLeft,c++,h.line.children.splice(c,0,l),d++,this.updateRevisionForFormattedContent(e,l,p)),0===i?(e.text=e.text.substr(0,n),this.applyCharFormatValue(e.characterFormat,r,o,s)):e.text=e.text.substr(0,i),d},e.prototype.updateRevisionForFormattedContent=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n],o=r.range.indexOf(e)+i;t.revisions.splice(0,0,r),r.range.splice(o,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},e.prototype.applyCharFormatCell=function(e,t,i,n,r,o,s){if(n.paragraph.isInsideTable){var a=t.getContainerCellOf(e,n.paragraph.associatedCell);if(a.ownerTable.contains(n.paragraph.associatedCell)){var l=t.getSelectedCell(e,a),d=t.getSelectedCell(n.paragraph.associatedCell,a);return t.containsCell(a,n.paragraph.associatedCell)?t.isCellSelected(a,i,n)?(o=this.getCharacterFormatValueOfCell(e,t,o,r),void this.applyCharFormatForSelectedCell(a,t,r,o,s)):l===a?this.applyCharFormat(i.paragraph,t,i,n,r,o,s):this.applyCharFormatRow(l.ownerRow,t,i,n,r,o,s):void this.applyCharFormatForTableCell(a.ownerTable,t,a,d,r,o,s)}return this.applyCharFormatRow(a.ownerRow,t,i,n,r,o,s)}var h=t.getContainerCell(e);return this.applyCharFormatRow(h.ownerRow,t,i,n,r,o,s)},e.prototype.applyCharFormatForSelectedCell=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof Rl?this.applyCharFormatForSelectedPara(s,t,i,n,r):this.applyCharFormatForSelTable(s,t,i,n,r)}},e.prototype.applyCharFormatRow=function(e,t,i,n,r,o,s){return o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,r),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,n,r,o,s)},e.prototype.applyCharFormatForTable=function(e,t,i,n,r,o,s,a){t=t.combineWidget(this.owner.viewer);for(var l=e;l<t.childWidgets.length;l++){for(var d=t.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyCharFormatForSelectedCell(d.childWidgets[h],i,o,s,a);if(r.paragraph.isInsideTable&&i.containsRow(d,r.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}return this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,n,r,o,s,a)},e.prototype.applyCharFormatForSelTable=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyCharFormatForSelectedCell(s.childWidgets[a],t,i,n,r)},e.prototype.applyCharFormatForTableCell=function(e,t,i,n,r,o,s){var a=t.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,d=t.getCellLeft(n.ownerRow,n),h=d+n.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(n.ownerRow),u=!1,g=e.childWidgets.indexOf(i.ownerRow);g<=p;g++)for(var m=e.childWidgets[g],f=0;f<m.childWidgets.length;f++){var v=t.getCellLeft(m,m.childWidgets[f]);Pa.round(a,2)<=Pa.round(v,2)&&Pa.round(v,2)<Pa.round(l,2)&&(u||(o=this.getCharacterFormatValueOfCell(m.childWidgets[f],t,o,r),u=!0),this.applyCharFormatForSelectedCell(m.childWidgets[f],t,r,o,s))}},e.prototype.updateSelectedCellsInTable=function(e,t,i,n){var r=this.documentHelper.selection;return e>i&&(e=i),t<n&&(t=n),e>r.upDownSelectionLength&&(e=r.upDownSelectionLength),t<r.upDownSelectionLength&&(t=r.upDownSelectionLength),{start:e,end:t}},e.prototype.getCharacterFormatValueOfCell=function(e,t,i,n){if("boolean"==typeof i||void 0===i&&("bold"===n||"italic"===n)){var r=t.getFirstParagraph(e),o=r.characterFormat;r.childWidgets.length>0&&r.childWidgets[0].children.length>0&&(o=r.childWidgets[0].children[0].characterFormat),i=!o.getPropertyValue(n)}return i},e.prototype.applyCharFormatValueInternal=function(e,t,i,n){this.applyCharFormatValue(t,i,n,!1)},e.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},e.prototype.applyCharFormatValue=function(e,t,i,n){if(n&&"fontSize"===t&&(i=this.updateFontSize(e,i)),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof ka)this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?(this.copyInlineCharacterFormat(i,e),this.owner.enableCollaborativeEditing&&e.ownerBase instanceof ql&&this.editorHistory.currentBaseHistoryInfo.buildCharacterFormatOperation(e.ownerBase,e)):e.copyFormat(i);else{if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&e.ownerBase instanceof ql){var r=e.ownerBase,o=r.previousNode;if((0,a.isNullOrUndefined)(o)){var s=r.paragraph.previousWidget;if(!(0,a.isNullOrUndefined)(s)&&!s.isEmpty()){var l=s.lastChild;o=l.children[l.children.length-1]}}for(;!((0,a.isNullOrUndefined)(o)||o instanceof Zl);)o=o.previousNode;if(!(0,a.isNullOrUndefined)(o)&&o.revisions.length>0){var d=o.revisions[o.revisions.length-1];"fontColor"===t&&0!==r.revisions.length||this.isRevisionAlreadyIn(r,d)||(r.revisions.push(d),d.range.push(r),this.owner.trackChangesPane.updateCurrentTrackChanges(d))}else{d=r.revisions[r.revisions.length-1];if(("fontColor"!==t||0===r.revisions.length)&&!(0,a.isNullOrUndefined)(d)&&d.range.length>0){r.revisions.splice(r.revisions.length-1,1);var h=d.range.indexOf(r);d.range.splice(h,1),this.owner.trackChangesPane.updateCurrentTrackChanges(d)}"fontColor"===t&&0!==r.revisions.length||this.insertRevision(r,"Insertion")}}if((0,a.isNullOrUndefined)(i)&&(0,a.isNullOrUndefined)(t))return e.clearFormat(),void((0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=e[t]));"bold"===t?(this.isRTLFormat(e)&&(e.boldBidi=e.bold==e.boldBidi?i:!i),e.bold=i):"italic"===t?(this.isRTLFormat(e)&&(e.italicBidi=e.italic==e.italicBidi?i:!i),e.italic=i):"fontColor"===t?e.fontColor=i:"fontFamily"===t?(e.fontFamily=i,e.fontFamilyAscii=i,e.fontFamilyFarEast=i,e.fontFamilyNonFarEast=i,e.fontFamilyBidi=i):"fontSize"===t?(e.fontSize=i,this.isRTLFormat(e)&&(e.fontSizeBidi=i)):"highlightColor"===t?e.highlightColor=i:"baselineAlignment"===t?e.baselineAlignment=i:"strikethrough"===t?e.strikethrough=i:"underline"===t?e.underline=i:"styleName"===t?e.baseCharStyle=i:"allCaps"===t&&(e.allCaps=i),"fontColor"===t&&this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=e.fontColor)}},e.prototype.isRTLFormat=function(e){return e.bidi||e.complexScript||!(0,a.isNullOrUndefined)(e.ownerBase)&&e.ownerBase instanceof Zl&&this.documentHelper.textHelper.getRtlLanguage(e.ownerBase.text).isRtl},e.prototype.updateStyleObject=function(e){var t=new La,i=this.owner.parser.keywordIndex;this.owner.parser.keywordIndex=1;var n=this.owner.editor.isRemoteAction;this.owner.editor.isRemoteAction=!0,this.owner.parser.parseStyles(e,t);for(var r=0;r<t.length;r++){var o=t.getItem(r),s=this.owner.documentHelper.styles.findByName(o.name);if((0,a.isNullOrUndefined)(e[oe[1]])||(this.owner.parser.parseAbstractList(e,this.owner.documentHelper.abstractLists),(0,a.isNullOrUndefined)(e[re[1]])||this.owner.parser.parseList(e,this.owner.documentHelper.lists)),(0,a.isNullOrUndefined)(s)){if(this.owner.editorHistory.isRedoing){l=o instanceof Wa?o.paragraphFormat.listFormat.listId:-1;(d=this.documentHelper.owner.getStyleObject(o,l)).isNew=!0,this.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(d)}this.owner.documentHelper.styles.push(o)}else{if(this.owner.editorHistoryModule&&(this.owner.editorHistoryModule.isUndoing||this.owner.editorHistoryModule.isRedoing)&&0===r&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"ModifyStyle"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action){var l=s instanceof Wa?s.paragraphFormat.listFormat.listId:-1,d=this.owner.getStyleObject(s,l);(0,a.isNullOrUndefined)(e.isNew)||(d.isNew=e.isNew),this.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(d)}e.isNew&&this.owner.editorHistoryModule.isUndoing?this.owner.documentHelper.styles.remove(s):this.owner.updateStyle(s,o)}}this.owner.editor.isRemoteAction=n,t.length>0&&(this.owner.isShiftingEnabled=!0,this.owner.editorModule.layoutWholeDocument(),this.owner.isShiftingEnabled=!1),this.owner.parser.keywordIndex=i},e.prototype.onImageFormat=function(e,t,i,n){var r=new hc(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(r),this.editorHistory.currentBaseHistoryInfo.insertedText=o.Image,this.editorHistory.currentBaseHistoryInfo.insertedData={width:Pa.convertPixelToPoint(t),height:Pa.convertPixelToPoint(i),alternativeText:n}),this.setOffsetValue(this.selection),e.width=t,e.height=i,e.alternateText=n,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.documentHelper.owner.imageResizerModule&&!this.isRemoteAction&&this.documentHelper.owner.imageResizerModule.positionImageResizer(e)},e.prototype.toggleTextAlignment=function(e){this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||((0,a.isNullOrUndefined)(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):"Left"===e?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},e.prototype.setPreviousBlockToLayout=function(){var e=this.documentHelper.selection.start;this.documentHelper.selection.isForward||(e=this.documentHelper.selection.end);var t=e.paragraph;if(t.paragraphFormat.keepWithNext){var i=t.bodyWidget;if(!(0,a.isNullOrUndefined)(i)&&i instanceof Ol&&i.page){var n=i.page.previousPage;n&&(this.previousBlockToLayout=n.bodyWidgets[0].lastChild)}}},e.prototype.applyParagraphBorders=function(e,t,i){var n=new fa;switch(e){case"color":n.color=i;break;case"lineWidth":n.lineWidth=i;break;case"lineStyle":n.lineStyle=i;break;case"shadow":n.shadow=i;break;case"space":n.space=i}this.onApplyParagraphFormat(t,n,!1,!1)},e.prototype.applyRulerMarkerValues=function(e,t,i){var n=Pa.convertPixelToPoint(i-t)/this.owner.zoomFactor;if("firstLineIndent"===e){var r=this.owner.selectionModule.start.paragraph.paragraphFormat.firstLineIndent;this.onApplyParagraphFormat(e,r+n,!1,!1)}else if("hangingIndent"===e){r=this.owner.selectionModule.start.paragraph.paragraphFormat.firstLineIndent;this.onApplyParagraphFormat("firstLineIndent",r-n,!1,!1);var o=this.owner.selectionModule.start.paragraph.paragraphFormat.leftIndent+r;r-=n,this.onApplyParagraphFormat("leftIndent",o-r,!1,!1,!0)}else if("leftIndent"===e){r=this.owner.selectionModule.start.paragraph.paragraphFormat.leftIndent;this.onApplyParagraphFormat(e,r+n,!1,!1)}else if("rightIndent"===e){r=this.owner.selectionModule.start.paragraph.paragraphFormat.rightIndent;this.onApplyParagraphFormat(e,r+n,!1,!1)}},e.prototype.onApplyParagraphFormat=function(e,t,i,n,r){var o=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!o||!(0,a.isNullOrUndefined)(this.selection)&&this.selection.checkContentControlLocked(!0))){this.setPreviousBlockToLayout();var s="bidi"===e?"ParagraphBidi":e[0].toUpperCase()+e.slice(1);this.documentHelper.owner.isShiftingEnabled=!0;var l=this.documentHelper.selection,d=l.start.paragraph,h=!1;if(l.isForward||(d=l.end.paragraph),"leftIndent"==e&&(h=this.isFirstParaForList(l,d)),t<=0&&"leftIndent"==e&&!r){var c=Pa.convertPointToPixel(t);if(d.x+c<this.viewer.clientArea.x&&!d.paragraphFormat.bidi)return void(this.documentHelper.owner.isShiftingEnabled=!1)}if(this.initHistory(s),(!this.owner.isReadOnlyMode||o)&&this.owner.isDocumentLoaded)if("leftIndent"!==e||(0,a.isNullOrUndefined)(l.paragraphFormat.listId)||-1===l.paragraphFormat.listId||!i){if(!(t instanceof Oa&&"styleName"==e&&l.isEmpty)&&l.isEmpty){this.setOffsetValue(l),l.paragraphFormat.bidi&&("listFormat"===e||-1!==l.paragraphFormat.listId)||(this.documentHelper.layout.isBidiReLayout=!0),i&&"leftIndent"===e&&(t=this.getIndentIncrementValue(l.start.paragraph,t));var p=l.start.paragraph;this.documentHelper.layout;p=p.combineWidget(this.owner.viewer),this.applyParaFormatProperty(p,e,t,i),this.isMeasureParaWidth=!0,this.layoutItemBlock(p,!1),this.isMeasureParaWidth=!1}else"ParagraphBidi"!==s&&this.setOffsetValue(l),this.updateSelectionParagraphFormatting(e,t,i);this.reLayout(l)}else h?this.updateListLevelIndent(t,d):this.updateListLevel(t>0)}},e.prototype.updateListLevelIndent=function(e,t){var i,n=this.documentHelper.getListById(t.paragraphFormat.listFormat.listId),r=this.documentHelper.getAbstractListById(n.abstractListId),o=void 0;if((0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(o=this.editorHistory.currentBaseHistoryInfo.action),this.initHistory("List"),e<0&&r.levels[0].paragraphFormat.leftIndent+e<=0&&(e=18-r.levels[0].paragraphFormat.leftIndent),0!=e){for(var s=0;s<r.levels.length;s++)this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForList(r.levels[s]),r.levels[s].paragraphFormat.leftIndent+=e;(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(0,a.isNullOrUndefined)(o)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=((i={})[o.toString().charAt(0).toLowerCase()+o.toString().slice(1)]=e,i.isFirstParaForList=!0,i)),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1}},e.prototype.isFirstParaForList=function(e,t){var i=!1;if(!(0,a.isNullOrUndefined)(e.paragraphFormat.listId)&&-1!==e.paragraphFormat.listId&&0===t.paragraphFormat.listFormat.listLevelNumber){var n=this.updateWholeListItems(t,!0,e.paragraphFormat.listId);(0,a.isNullOrUndefined)(n)&&(i=!0)}return i},e.prototype.updateListLevel=function(e){var t,i=this.documentHelper,n=(this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat,this.documentHelper.selection.start.paragraph.paragraphFormat),r=i.getListById(n.listFormat.listId);i.layout.getListLevel(r,n.listFormat.listLevelNumber);t=e?n.listFormat.listLevelNumber+1:n.listFormat.listLevelNumber-1;var o=i.layout.getListLevel(r,t);(0,a.isNullOrUndefined)(o)||(this.onApplyListInternal(r,t),i.selection.start.updatePhysicalPosition(!0),i.selection.end.updatePhysicalPosition(!0),i.selection.updateCaretPosition())},e.prototype.onApplyListInternal=function(e,t){var i=new ya;!(0,a.isNullOrUndefined)(e)&&t>=0&&t<9&&(i.listId=e.listId,i.listLevelNumber=t),this.onApplyParagraphFormat("listFormat",i,!1,!1)},e.prototype.updateSelectionParagraphFormatting=function(e,t,i){var n=this.documentHelper.selection;"leftIndent"===e&&i&&(t=!(0,a.isNullOrUndefined)(n.start)&&n.start.isExistBefore(n.end)?this.getIndentIncrementValue(n.start.paragraph,t):this.getIndentIncrementValue(n.end.paragraph,t)),this.updateParagraphFormatInternal(e,t,i)},e.prototype.getIndentIncrementValue=function(e,t){var i=e.paragraphFormat.leftIndent;if(i<0){if(t<0||i+t>=0)return-i;var n=-this.getIndentIncrementValueInternal(-i,-t);return n%t==0?n:n+t}return this.getIndentIncrementValueInternal(i,t)},e.prototype.getIndentIncrementValueInternal=function(e,t){var i=Math.abs(t);if(0===e||0===i)return t>0?i:0;var n=100*Math.round(e)%(100*Math.round(i))/100,r=(Math.round(e)-n)/Math.round(i)*i;return t>0&&(r+=i),r-e==0?t:r-e},e.prototype.updateParagraphFormatInternal=function(e,t,i){switch((0,a.isNullOrUndefined)(e)&&(e="ParagraphFormat"),e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"spaceAfterAuto":this.updateParagraphFormat("spaceAfterAuto",t,!1);break;case"spaceBeforeAuto":this.updateParagraphFormat("spaceBeforeAuto",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,i);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"borders":case"topBorder":case"bottomBorder":case"leftBorder":case"rightBorder":case"horizontalBorder":case"verticalBorder":this.updateParagraphFormat(e,t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"bidi":var n=-1!==this.selection.paragraphFormat.listId;n||(this.documentHelper.layout.isBidiReLayout=!0),this.updateParagraphFormat("bidi",t,!1),n||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1);break;case"tabStop":this.updateParagraphFormat("tabStop",t,!1)}},e.prototype.updateParagraphFormat=function(e,t,i){var n=this.documentHelper.selection,r=n.start,o=n.end;n.isForward||(r=n.end,o=n.start),this.applyParaFormatSelectedContent(r,o,e,t,i)},e.prototype.applyParaFormatSelectedContent=function(e,t,i,n,r){var o=this.documentHelper.selection;if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell===t.paragraph.associatedCell&&!o.isCellSelected(e.paragraph.associatedCell,e,t)){if(!(0,a.isNullOrUndefined)(n)&&!this.selection.isEmpty&&"styleName"===i&&this.applyCharacterStyle(e.paragraph,e,t,i,n,r))return;this.applyParaFormat(e.paragraph,e,t,i,n,r)}else{var s;e.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(o)&&this.updateHistoryPosition(e,!0),s=e.paragraph.associatedCell,this.applyParaFormatInCell(s,e,t,i,n,r);var l=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}},e.prototype.applyParaFormatProperty=function(e,t,i,n){var r=e.paragraphFormat;if(n&&"leftIndent"===t&&(i=r.leftIndent+i),"listFormat"===t&&i instanceof ya){var o=i;o.hasValue("listLevelNumber")||(this.isAutoList?(o.listLevelNumber=this.listLevelNumber,this.listLevelNumber=0,this.isAutoList=!1):o.listLevelNumber=r.listFormat.listLevelNumber)}if(this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(r,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof ba&&((0,a.isNullOrUndefined)(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||this.isRemoteAction?this.copyParagraphFormat(i,r):r.copyFormat(i):"listFormat"===t&&(r.listFormat=i.listFormat,r.listFormat.ownerBase=r,r.copyFormat(i)),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.owner.enableCollaborativeEditing&&this.editorHistory.isUndoing&&this.editorHistory.currentBaseHistoryInfo.getParagraohFormatOperation(e,r)),(0,a.isNullOrUndefined)(i))return r.clearFormat(),void this.documentHelper.layout.reLayoutParagraph(r.ownerBase,0,0);if("afterSpacing"===t)r.afterSpacing=i;else if("beforeSpacing"===t)r.beforeSpacing=i;else if("leftIndent"===t)r.leftIndent=i;else if("lineSpacingType"===t)r.lineSpacingType=i;else if("lineSpacing"===t)r.lineSpacing=i;else if("rightIndent"===t)r.rightIndent=i;else if("firstLineIndent"===t)r.firstLineIndent=i;else if("textAlignment"===t){var s=i;!r.bidi||this.editorHistory.isUndoing||this.editorHistory.isRedoing||("Left"===s?s="Right":"Right"===s&&(s="Left")),r.textAlignment=s}else if("outlineLevel"===t)r.outlineLevel=i;else if("topBorder"===t)this.applyBorder(r.borders.top,i);else if("bottomBorder"===t)this.applyBorder(r.borders.bottom,i);else if("leftBorder"===t)this.applyBorder(r.borders.left,i);else if("rightBorder"===t)this.applyBorder(r.borders.right,i);else if("horizontalBorder"===t)this.applyBorder(r.borders.horizontal,i);else if("verticalBorder"===t)this.applyBorder(r.borders.vertical,i);else if("borders"===t)r.borders.copyFormat(i);else if("styleName"===t)"string"==typeof i&&(i=this.documentHelper.styles.findByName(i)),r.applyStyle(i);else{if("listFormat"===t)return i instanceof ba&&(i=i.listFormat),r.listFormat.copyFormat(i),this.documentHelper.layout.clearListElementBox(r.ownerBase),r.listFormat.listId>=0&&r.clearIndent(),void this.layoutItemBlock(r.ownerBase,!1);if("bidi"===t)r.bidi=i;else if("keepWithNext"===t)r.keepWithNext=i;else if("keepLinesTogether"===t)r.keepLinesTogether=i;else if("widowControl"===t)r.widowControl=i;else if("contextualSpacing"===t)r.contextualSpacing=i;else if("spaceAfterAuto"===t)r.spaceAfterAuto=i;else if("spaceBeforeAuto"===t)r.spaceBeforeAuto=i;else if("tabStop"===t){var l=this.editorHistory.isUndoing||this.editorHistory.isRedoing;this.updateTabStopCollection(e,i,l)}}},e.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,t.listFormat.ownerBase=t,t.baseStyle=e.baseStyle},e.prototype.copyFromListLevelParagraphFormat=function(e,t){(0,a.isNullOrUndefined)(t.leftIndent)||(e.leftIndent=t.leftIndent),(0,a.isNullOrUndefined)(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent)},e.prototype.applyContinueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},e.prototype.continueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),(0,a.isNullOrUndefined)(e)||this.applyContinueNumberingInternal(e)},e.prototype.applyContinueNumberingInternal=function(e,t){var i=e.start.paragraph,n=this.getContinueNumberingInfo(i);(0,a.isNullOrUndefined)(t)&&(t=this.getParagraphFormat(i,n.listLevelNumber,n.listPattern)),t=(0,a.isNullOrUndefined)(t)?i.paragraphFormat:t,(0,a.isNullOrUndefined)(n.currentList)||(this.changeListId(n.currentList,i,t,n.listLevelNumber,n.listPattern),this.reLayout(e,!1),this.owner.enableAutoFocus&&this.documentHelper.updateFocus())},e.prototype.getContinueNumberingInfo=function(e){var t=void 0,i=0,n="None";(0,a.isNullOrUndefined)(e.paragraphFormat)||(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber);var r=this.documentHelper;if(0!==i&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(r.getAbstractListById(t.abstractListId))&&!(0,a.isNullOrUndefined)(r.getAbstractListById(t.abstractListId).levels[i])){var o=this.documentHelper.layout.getListLevel(t,i);(0,a.isNullOrUndefined)(o)||(n=o.listLevelPattern)}return{currentList:t,listLevelNumber:i,listPattern:n}},e.prototype.revertContinueNumbering=function(e,t){var i=e.start.paragraph,n=this.getContinueNumberingInfo(i);this.changeListId(n.currentList,i,t,n.listLevelNumber,n.listPattern),this.reLayout(e,!1),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},e.prototype.changeListId=function(e,t,i,n,r){if(!(0,a.isNullOrUndefined)(t)){if(t instanceof Rl&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var o=this.editorHistory.currentBaseHistoryInfo;(0,a.isNullOrUndefined)(o)||(i=o.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,i),o.insertedFormat=i)}n===t.paragraphFormat.listFormat.listLevelNumber?t.paragraphFormat.copyFormat(i):t.paragraphFormat.listFormat.listId=i.listFormat.listId,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeListId(e,t.nextRenderedWidget,i,n,r)}},e.prototype.getParagraphFormat=function(e,t,i){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof Rl)return(0,a.isNullOrUndefined)(e.previousRenderedWidget.paragraphFormat.listFormat)||-1===e.previousRenderedWidget.paragraphFormat.listFormat.listId?this.getParagraphFormat(e.previousRenderedWidget,t,i):t===e.previousRenderedWidget.paragraphFormat.listFormat.listLevelNumber?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,t,i)},e.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},e.prototype.restartNumbering=function(){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering");var e=this.documentHelper.selection;(0,a.isNullOrUndefined)(e)||this.restartListAt(e)},e.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},e.prototype.restartListAt=function(e){if(e.paragraphFormat.getList()){var t=e.paragraphFormat.getList(),i=t.clone();i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1,this.documentHelper.lists.push(i);var n=t.abstractList.clone();n.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1,i.abstractListId=n.abstractListId,i.nsid=n.nsid,i.abstractList=n,this.documentHelper.abstractLists.push(n),this.restartListAtInternal(e,i.listId,i.nsid)}},e.prototype.restartListAtInternal=function(e,t,i){var n=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(n.currentList,e.start.paragraph,t,i),this.reLayout(e,!1),this.documentHelper.updateFocus()},e.prototype.changeRestartNumbering=function(e,t,i,n){if(!(0,a.isNullOrUndefined)(t)){if(t instanceof Rl&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var r=this.editorHistory.currentBaseHistoryInfo;(0,a.isNullOrUndefined)(r)||(i=r.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,i),r.insertedFormat={listId:i,nsid:n})}t.paragraphFormat.listFormat.listId=i,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeRestartNumbering(e,t.nextRenderedWidget,i,n)}},e.prototype.applyParaFormat=function(e,t,i,n,r,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.owner.viewer),this.applyParaFormatProperty(e,n,r,o),this.isMeasureParaWidth=!0,this.layoutItemBlock(e,!1),this.isMeasureParaWidth=!1,this.getOffsetValue(this.selection),e.equals(i.paragraph)||this.getNextParagraphForFormatting(e,t,i,n,r,o)},e.prototype.applyCharacterStyle=function(e,t,i,n,r,o){var s=e.getSplitWidgets(),a=i.owner.selectionModule,l=i.currentWidget;if(!(0===t.offset&&(a.isParagraphLastLine(l)&&i.currentWidget===l&&i.offset===a.getLineLength(l)+1||i.isAtParagraphEnd))&&(i.paragraph===e||-1!==s.indexOf(i.paragraph))&&("Paragraph"===r.type&&r.link instanceof Oa||"Character"===r.type)){var d="Character"===r.type?r:r.link;return this.updateSelectionCharacterFormatting(n,d,o),!0}return!1},e.prototype.applyParaFormatInCell=function(e,t,i,n,r,o){var s=this.documentHelper.selection;if(i.paragraph.isInsideTable){var a=s.getContainerCellOf(e,i.paragraph.associatedCell);if(a.ownerTable.contains(i.paragraph.associatedCell)){var l=s.getSelectedCell(e,a),d=s.getSelectedCell(i.paragraph.associatedCell,a);s.containsCell(a,i.paragraph.associatedCell)?s.isCellSelected(a,t,i)?(r=this.getParaFormatValueInCell(a,n,r),this.applyParaFormatCellInternal(a,n,r,o)):l===a?this.applyParaFormat(t.paragraph,t,i,n,r,o):this.applyParagraphFormatRow(l.ownerRow,t,i,n,r,o):this.applyParaFormatTableCell(a.ownerTable,a,d,n,r,o)}else this.applyParagraphFormatRow(a.ownerRow,t,i,n,r,o)}else{var h=s.getContainerCell(e);this.applyParagraphFormatRow(h.ownerRow,t,i,n,r,o)}},e.prototype.applyParaFormatCellInternal=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof Rl?("listFormat"===t&&i instanceof ya&&r&&s.paragraphFormat.listFormat.hasValue("listLevelNumber")&&i.listLevelNumber<s.paragraphFormat.listFormat.listLevelNumber&&(i.listLevelNumber=s.paragraphFormat.listFormat.listLevelNumber),this.isMeasureParaWidth=!0,this.applyParaFormatProperty(s,t,i,n),this.isMeasureParaWidth=!1):this.applyParagraphFormatTableInternal(s,t,i,n,r)}},e.prototype.getParaFormatValueInCell=function(e,t,i){"boolean"==typeof i&&(i=!this.documentHelper.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t));return i},e.prototype.applyParagraphFormatRow=function(e,t,i,n,r,o){r=this.getParaFormatValueInCell(e.childWidgets[0],n,r);for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.applyParaFormatCellInternal(a.childWidgets[l],n,r,o);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,n,r,o)},e.prototype.applyParaFormatTableCell=function(e,t,i,n,r,o){var s=this.documentHelper.selection,a=s.getCellLeft(t.ownerRow,t),l=a+t.cellFormat.cellWidth,d=s.getCellLeft(i.ownerRow,i),h=d+i.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(i.ownerRow),u=!1,g=e.childWidgets.indexOf(t.ownerRow);g<=p;g++)for(var m=e.childWidgets[g],f=0;f<m.childWidgets.length;f++){var v=s.getCellLeft(m,m.childWidgets[f]);Math.round(a)<=Math.round(v)&&Math.round(v)<Math.round(l)&&(u||(r=this.getParaFormatValueInCell(m.childWidgets[f],n,r),u=!0),this.applyParaFormatCellInternal(m.childWidgets[f],n,r,o))}},e.prototype.applyParaFormatTable=function(e,t,i,n,r,o,s){e=e.combineWidget(this.owner.viewer);for(var a=this.documentHelper.selection,l=0;l<e.childWidgets.length;l++){for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyParaFormatCellInternal(d.childWidgets[h],n,r,o,s);if(i.paragraph.isInsideTable&&a.containsRow(d,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,n,r,o)},e.prototype.getNextParagraphForFormatting=function(e,t,i,n,r,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),(0,a.isNullOrUndefined)(e)||(e instanceof Rl?("listFormat"===n&&r instanceof ya&&e.paragraphFormat.listFormat.hasValue("listLevelNumber")&&r.listLevelNumber<e.paragraphFormat.listFormat.listLevelNumber&&(r.listLevelNumber=e.paragraphFormat.listFormat.listLevelNumber),this.applyParaFormat(e,t,i,n,r,o)):this.applyParaFormatTable(e,t,i,n,r,o,!0))},e.prototype.applyParagraphFormatTableInternal=function(e,t,i,n,r){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyParaFormatCellInternal(s.childWidgets[a],t,i,n,r)},e.prototype.onApplyColumnFormat=function(e,t){if(!this.restrictFormatting){this.initHistory("SectionFormat");var i=this.documentHelper.selection;i.owner.isShiftingEnabled=!0;var n,r,o=i.start,s=i.end;i.isForward||(o=i.end,s=i.start),this.documentHelper.clearContent();for(var a=o.paragraph.bodyWidget.sectionIndex,l=s.paragraph.bodyWidget.sectionIndex,d=!1,h=0;h<this.documentHelper.pages.length;h++)this.documentHelper.pages[h].bodyWidgets[0].index===a?n=h:d=!0;for(h=n;h<this.documentHelper.pages.length;h++){var c=this.documentHelper.pages[h].bodyWidgets[0];if(r=h,c.index!==a&&!(c.index>=a&&c.index<=l)){r=h-1;break}}d&&"differentOddAndEvenPages"==e&&o.paragraph.isInHeaderFooter&&(n=0,r=this.documentHelper.pages.length-1);var p=!0,u=0;for(h=n;h<=r;h++)u===this.documentHelper.pages[h].bodyWidgets[0].index||p||(p=!0),this.applyPropertyValueForSection(this.documentHelper.pages[h].bodyWidgets[0].sectionFormat,e,t,p),u=this.documentHelper.pages[h].bodyWidgets[0].index,p=!1;this.layoutWholeDocument(),this.fireContentChange()}},e.prototype.onApplySectionFormat=function(e,t){if(!this.restrictFormatting){if((0,a.isNullOrUndefined)(e))this.initHistory("SectionFormat");else{var i=e[0].toUpperCase()+e.slice(1);this.initHistory(i)}this.updateSectionFormat(e,t)}},e.prototype.removeInlineHeaderFooterWidget=function(e,t,i,n){if(0!=e){var r=this.documentHelper.headersFooters[e],o=this.viewer.getHeaderFooter(t),s=this.selection.start.paragraph.containerWidget.sectionFormat.cloneFormat();if(!(0,a.isNullOrUndefined)(n)){if(!(0,a.isNullOrUndefined)(i)){var l=i[0].toUpperCase()+i.slice(1);this.initHistory(l),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.insertedFormat=n);var d=this.selection.getParagraphInfo(this.selection.start);this.selection.editPosition=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString()),this.checkInsertPosition(this.selection)&&this.setPositionForHistory(this.selection.editPosition)}if(n)r&&!(0,a.isNullOrUndefined)(r[o])&&(s.removedHeaderFooters.push(r[o]),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(s,i,n),delete r[o]);else{var h=this.viewer.getCurrentHeaderFooter(t,e);if(!(0,a.isNullOrUndefined)(h)&&(0,a.isNullOrUndefined)(r[o])){var c=h.clone();r[o]=c,s.removedHeaderFooters.push(c),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(s,i,n)}}this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.fireContentChange()}}},e.prototype.updateHeaderFooters=function(e,t,i,n){var r=this.documentHelper.headersFooters[i],o=this.viewer.getHeaderFooter(n.headerFooterType),s=r[o];(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&((0,a.isNullOrUndefined)(s)?this.documentHelper.headersFooters[i][o]=n:(0,a.isNullOrUndefined)(s)||delete r[o]),this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.layoutWholeDocument()},e.prototype.updateSectionFormat=function(e,t){if(1===this.documentHelper.selection.startPage&&"differentFirstPage"===e){var i=void 0;i=this.documentHelper.selection.start.paragraph.containerWidget instanceof Vl?this.getFirstChildOfTable(this.documentHelper.selection.start.paragraph.containerWidget):this.documentHelper.selection.start.paragraph.containerWidget.childWidgets[0];var n=this.selection.getHierarchicalIndex(i,"0");this.documentHelper.selection.select(n,n)}var r=this.documentHelper.selection;r.owner.isShiftingEnabled=!0;var o,s,l=r.start,d=r.end;r.isForward||(l=r.end,d=r.start),this.documentHelper.clearContent();for(var h=l.paragraph.bodyWidget.sectionIndex,c=d.paragraph.bodyWidget.sectionIndex,p=!1,u=!1,g=0;g<this.documentHelper.pages.length;g++){for(var m=0;m<this.documentHelper.pages[g].bodyWidgets.length;m++)if(this.documentHelper.pages[g].bodyWidgets[m].index===h){if(o=g,r.isForward){u=!0;break}}else p=!0;if(u)break}for(g=o;g<this.documentHelper.pages.length;g++)for(m=0;m<this.documentHelper.pages[g].bodyWidgets.length;m++){var f=this.documentHelper.pages[g].bodyWidgets[m];f.index!==h?f.index>=h&&f.index<=c&&(s=g):s=g}p&&"differentOddAndEvenPages"==e&&l.paragraph.isInHeaderFooter&&(o=0,s=this.documentHelper.pages.length-1);var v=!0,y=0;for(g=o;g<=s;g++)for(m=0;m<this.documentHelper.pages[g].bodyWidgets.length;m++)if(this.documentHelper.pages[g].bodyWidgets[m].index>=h&&this.documentHelper.pages[g].bodyWidgets[m].index<=c||!r.isForward&&this.documentHelper.pages[g].bodyWidgets[m].index<=h&&this.documentHelper.pages[g].bodyWidgets[m].index>=c){y===this.documentHelper.pages[g].bodyWidgets[m].index||v||(v=!0),this.applyPropertyValueForSection(this.documentHelper.pages[g].bodyWidgets[m].sectionFormat,e,t,v),y=this.documentHelper.pages[g].bodyWidgets[m].index,v=!1;var w=this.documentHelper.pages[g].bodyWidgets[m];(0,a.isNullOrUndefined)(w.nextWidget)||w.sectionFormat.pageHeight===w.nextWidget.sectionFormat.pageHeight&&w.sectionFormat.pageWidth===w.nextWidget.sectionFormat.pageWidth||"NoBreak"!==w.nextWidget.sectionFormat.breakCode||(w.nextWidget.sectionFormat.breakCode="NewPage",w=this.documentHelper.layout.getBodyWidget(w.nextWidget,!1),(0,a.isNullOrUndefined)(w.nextWidget)||(w.nextWidget.sectionFormat.breakCode="NewPage"))}this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.fireContentChange()},e.prototype.getFirstChildOfTable=function(e){return e.ownerTable.childWidgets[0].childWidgets[0].childWidgets[0]},e.prototype.onApplyTableFormat=function(e,t,i){if(!this.restrictFormatting){var n=this.getTableFormatAction(e);this.viewer.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection;(0,a.isNullOrUndefined)(i)&&(i=r.start.paragraph.associatedCell.ownerTable),i=i.combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(n),this.applyTablePropertyValue(e,t,i)):this.updateSelectionTableFormat(this.selection,n,t),i.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(i),this.reLayout(r,!1)}},e.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";case"title":return"TableTitle";case"description":return"TableDescription";default:return"DefaultCellSpacing"}},e.prototype.onApplyTableRowFormat=function(e,t){if(!this.restrictFormatting){var i=this.getRowAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection;if(n.isEmpty){this.initHistory(i);n.start.paragraph.associatedCell.ownerRow.ownerTable;this.applyRowPropertyValue(n,e,t,n.start.paragraph.associatedCell.ownerRow)}else this.updateSelectionTableFormat(this.selection,i,t);this.reLayout(n,!1)}},e.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},e.prototype.onApplyTableCellFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableCellAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var n=this.documentHelper.selection,r=n.start.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer),n.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(n,e,t,n.start.paragraph.associatedCell.cellFormat),r.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(r)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(n,!1)}},e.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},e.prototype.applyPropertyValueForSection=function(e,t,i,n){n&&this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&("columns"===t&&(e.numberOfColumns=i.length),i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),(0,a.isNullOrUndefined)(i)||(i instanceof ga?(0,a.isNullOrUndefined)(t)&&e.copyFormat(i,this.editorHistory):"pageHeight"===t?e.pageHeight=i:"pageWidth"===t?e.pageWidth=i:"leftMargin"===t?e.leftMargin=i:"rightMargin"===t?e.rightMargin=i:"topMargin"===t?e.topMargin=i:"bottomMargin"===t?e.bottomMargin=i:"differentFirstPage"===t?e.differentFirstPage=i:"differentOddAndEvenPages"===t?e.differentOddAndEvenPages=i:"headerDistance"===t?e.headerDistance=i:"footerDistance"===t?e.footerDistance=i:"pageStartingNumber"===t?e.pageStartingNumber=i:"restartPageNumbering"===t?e.restartPageNumbering=i:"endnoteNumberFormat"===t?e.endnoteNumberFormat=i:"footNoteNumberFormat"===t?e.footNoteNumberFormat=i:"restartIndexForEndnotes"===t?e.restartIndexForEndnotes=i:"restartIndexForFootnotes"===t?e.restartIndexForFootnotes=i:"initialFootNoteNumber"===t?e.initialFootNoteNumber=i:"initialEndNoteNumber"===t?e.initialEndNoteNumber=i:"numberOfColumns"==t?e.numberOfColumns=i:"equalWidth"==t?e.equalWidth=i:"lineBetweenColumns"==t?e.lineBetweenColumns=i:"columns"==t&&(e.columns=i))},e.prototype.layoutWholeDocument=function(e,t){this.documentHelper.layout.isInitialLoad=!0,this.documentHelper.layout.isLayoutWhole=!0;var i=this.documentHelper.selection.start,n=this.documentHelper.selection.end;i.isExistAfter(n)&&(i=this.documentHelper.selection.end.clone(),n=this.documentHelper.selection.start.clone()),"Continuous"==this.owner.layoutType&&(this.documentHelper.selection.isinEndnote||this.documentHelper.selection.isinFootnote)&&(this.documentHelper.selection.footnoteReferenceElement(i,n),i=n);var r=this.selection.getParagraphInfo(i),o=this.selection.getParagraphInfo(n),s=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),a=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];var l=this.combineSection();t||this.documentHelper.clearContent(),this.documentHelper.layout.layoutItems(l,!0),this.documentHelper.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(i,s),this.setPositionForCurrentIndex(n,a),this.documentHelper.selection.selectPosition(i,n),this.reLayout(this.documentHelper.selection,void 0,e),this.documentHelper.layout.isLayoutWhole=!1,this.documentHelper.layout.isInitialLoad=!1},e.prototype.combineSection=function(){var e=[],t=this.documentHelper.pages[0].bodyWidgets[0];this.documentHelper.removeEmptyPages(!0);do{t=this.combineSectionChild(t,e,!1)}while(t);for(var i=0;i<this.documentHelper.pages.length;i++)this.documentHelper.pages[i].destroy(),i--;return e},e.prototype.combineFollowingSection=function(){var e=[],t=this.documentHelper.selection.start.paragraph.bodyWidget.getSplitWidgets()[0];if(t.childWidgets[0]instanceof Rl)this.updateWholeListItems(t.childWidgets[0]);else{var i=this.documentHelper.getFirstParagraphInFirstCell(t.childWidgets[0]);this.viewer.owner.editorModule.updateWholeListItems(i)}var n=this.documentHelper.pages.indexOf(t.page),r=0===t.indexInOwner?n:n+1;do{t=this.combineSectionChild(t,e,!1)}while(t);for(var o=r;o<this.documentHelper.pages.length;o++)this.documentHelper.pages[o].destroy(),o--;for(var s=n;s<this.documentHelper.pages.length;s++)for(var a=0;a<this.documentHelper.pages[s].bodyWidgets.length;a++)0===this.documentHelper.pages[s].bodyWidgets[a].childWidgets.length&&(this.documentHelper.pages[s].bodyWidgets.splice(a,1),a--);return e},e.prototype.combineSectionChild=function(e,t,i){var n=e,r=new Ol,o=!1;r.sectionFormat=e.sectionFormat,r.index=n.index;do{o=!1,n=e,e.lastChild&&e.lastChild.combineWidget(this.owner.viewer),e=e.nextRenderedWidget;for(var s=0;s<n.childWidgets.length;s++){var a=n.childWidgets[s];a instanceof Al?this.documentHelper.layout.clearTableWidget(a,!0,!0,!0):(a.x=0,a.y=0,a.width=0,a.height=0),r.childWidgets.push(a),n.childWidgets.splice(s,1),s--,a.containerWidget=r}for(var l=0;l<n.page.bodyWidgets.length;l++){if(0!==n.page.bodyWidgets[l].childWidgets.length){o=!1;break}o=!0}o&&i&&n.page.destroy()}while(e&&n.index===e.index);return t.push(r),e},e.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"bidi",i);break;case"TableTitle":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"title",i);break;case"TableDescription":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"description",i)}},e.prototype.updateTableFormat=function(e,t,i){var n=e.start;e.end;e.isForward||(n=e.end,e.start),this.initHistoryPosition(e,n),this.applyTablePropertyValue(t,i,n.paragraph.associatedCell.ownerTable),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(n.paragraph.associatedCell.ownerTable)},e.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var n=e.start;e.end;e.isForward||(n=e.end,e.start),this.initHistoryPosition(e,n),this.updateFormatForCell(e,t,i)},e.prototype.updateRowFormat=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start),this.initHistoryPosition(e,n),this.applyRowFormat(n.paragraph.associatedCell.ownerRow,n,r,t,i)},e.prototype.initHistoryPosition=function(e,t){this.documentHelper.owner.editorHistoryModule&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&((0,a.isNullOrUndefined)(t)?(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},e.prototype.startSelectionReLayouting=function(e,t,i,n){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var r=i.paragraph.associatedCell.ownerTable;r.isInsideTable;)r=r.associatedCell.ownerTable;this.reLayoutSelectionOfTable(r,t,i,n)}else this.reLayoutSelection(e,t,i,n)},e.prototype.reLayoutSelectionOfTable=function(e,t,i,n){var r=!1;if(this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!(0,a.isNullOrUndefined)(n.paragraph.associatedCell)&&e.contains(n.paragraph.associatedCell))return!0;var o=t.getNextRenderedBlock(e);return(0,a.isNullOrUndefined)(o)||(r=this.reLayoutSelectionOfBlock(o,t,i,n)),r},e.prototype.reLayoutSelection=function(e,t,i,n){if(i.paragraph===e){i.offset,t.getParagraphLength(e);var r=0,o=0,s=e.getInline(i.offset,r),l=s.element;r=s.index,(0,a.isNullOrUndefined)(l)||(r!==l.length||(0,a.isNullOrUndefined)(l.nextNode)||(l=l.nextNode),o=l.line.children.indexOf(l));var d=0;i.currentWidget.paragraph===e&&(d=e.childWidgets.indexOf(i.currentWidget),o=i.currentWidget.children.indexOf(l)),l instanceof Zl&&!l.line&&o>0?this.documentHelper.layout.reLayoutParagraph(e,d,o-1):this.documentHelper.layout.reLayoutParagraph(e,d,o)}else this.documentHelper.layout.reLayoutParagraph(e,0,0);if(n.paragraph===e)return!0;var h=t.getNextRenderedBlock(e);return!(0,a.isNullOrUndefined)(h)&&this.reLayoutSelectionOfBlock(h,t,i,n)},e.prototype.reLayoutSelectionOfBlock=function(e,t,i,n){return e instanceof Rl?this.reLayoutSelection(e,t,i,n):void 0},e.prototype.layoutItemBlock=function(e,t){var i=void 0;if(e.containerWidget instanceof Wl||e.containerWidget instanceof cd)!(0,a.isNullOrUndefined)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(i=(e=e.combineWidget(this.viewer)).containerWidget,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,i,e,!1));else if(e.containerWidget instanceof Vl){var n=e.containerWidget;n=this.documentHelper.selection.getContainerCell(n),!(0,a.isNullOrUndefined)(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(e)}},e.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},e.prototype.removeSelectedContentInternal=function(e,t,i){var n=t,r=i;if(t.isExistBefore(i)||(n=i,r=t),n.paragraph===r.paragraph&&n.paragraph.childWidgets.indexOf(n.currentWidget)===n.paragraph.childWidgets.length-1&&n.offset===e.getParagraphLength(n.paragraph)&&n.offset+1===r.offset)return e.owner.isShiftingEnabled=!0,e.selectContent(n,!0),!0;var o=this.selection.getParagraphInfo(n);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());var s=n.clone(),a=s.paragraph.containerWidget,l=s.currentWidget.isFirstLine(),d=this.checkMultipleSectionSelected(s,r),h=this.removeSelectedContent(r.paragraph,e,n,r),c=new ac(e.owner);if(d&&"DefaultPaste"==this.selection.currentPasteAction&&l&&s.offset<1){var p=s.paragraph,u=new Rl,g=new zl(u);g.paragraph=u,u.containerWidget=a,u.childWidgets.push(g),a.childWidgets.push(u),u.index=p.index,u.x=s.location.x,u.y=s.location.y}return this.setPositionForCurrentIndex(c,e.editPosition),e.selectContent(c,!0),h},e.prototype.checkMultipleSectionSelected=function(e,t){return this.getBodyWidgetIndex(e)!=this.getBodyWidgetIndex(t)},e.prototype.getBodyWidgetIndex=function(e){var t=e.hierarchicalPosition,i=t.indexOf(";"),n=t.substring(0,i);return i=(t=t.substring(i).replace(";","")).indexOf(";"),n=t.substring(0,i),parseInt(n,10)},e.prototype.removeSelectedContent=function(e,t,i,n){return!(n.paragraph.isInsideTable&&n.paragraph!==this.documentHelper.getLastParagraphInLastCell(n.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==n.paragraph.associatedCell.ownerTable.index))&&(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,n,2),!0)},e.prototype.deleteSelectedContent=function(e,t,i,n,r,o){var s=n.offset===this.selection.getLineLength(n.currentWidget)+1;if(i.isAtParagraphStart&&(s||n.isAtParagraphEnd)){var l=i.currentWidget.getInline(i.offset,0).element,d=n.currentWidget.getInline(n.offset,0).element;if(l instanceof id&&d instanceof id&&l.reference===d){i.offset+=1,n.offset-=s?2:1;var h=this.selection.getParagraphInfo(i);t.editPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.updateSelection()}}var c=0,p=i.currentWidget.getInline(i.offset,c);p.element;if(c=p.index,c=0,(p=n.currentWidget.getInline(n.offset,c)).element,c=p.index,n.paragraph===e)if(n.paragraph.isInsideTable&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell&&!i.paragraph.associatedCell.equals(n.paragraph.associatedCell)||t.isCellSelected(n.paragraph.associatedCell,i,n)&&o))n.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(n.paragraph.associatedCell,t,i,n,r,o);else{var u=void 0;if(this.owner.viewer instanceof kl&&e.bodyWidget.sectionFormat.numberOfColumns>1&&e===e.bodyWidget.lastChild&&!(0,a.isNullOrUndefined)(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.index!==e.bodyWidget.nextRenderedWidget.index&&e.bodyWidget.page===e.bodyWidget.nextRenderedWidget.page&&(u=e.nextRenderedWidget),this.deletePara(e,i,n,r),this.delBlockContinue&&this.delBlock){if(this.delSection){var g=e.bodyWidget instanceof Ol?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,g,r),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0}this.owner.viewer instanceof kl&&void 0!==u&&(this.documentHelper.blockToShift=u)}else this.deleteSelectedContent(n.paragraph,t,i,n,r)},e.prototype.mergeCells=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.owner.isDocumentLoaded&&((0,a.isNullOrUndefined)(this.documentHelper)||this.selection.isEmpty||this.mergeSelectedCellsInTable())},e.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var t=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer);this.selection.selectTable();var i=[];this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(i=this.checkAndRemoveComments(),this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0));var n=!0;if(!this.skipTracking()){for(var r=0,s=0;s<t.childWidgets.length;s++){var l=t.childWidgets[s];1===l.rowFormat.revisions.length&&"Insertion"===l.rowFormat.revisions[0].revisionType&&l.rowFormat.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)&&(this.isRemoveRevision=!0,this.unlinkRangeFromRevision(l.rowFormat,!0),this.isRemoveRevision=!1,0===l.rowFormat.revisions[0].range.length&&l.rowFormat.revisions.splice(0,1),r++)}r===t.childWidgets.length&&(n=!1)}var d=this.getParagraphForSelection(t);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Table,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t.clone())),this.owner.enableTrackChanges&&n)for(s=0;s<t.childWidgets.length;s++){if(0===s){var h=t.childWidgets[0];d=this.selection.getFirstParagraph(h)}this.trackRowDeletion(t.childWidgets[s])}else this.removeBlock(t);this.selection.selectParagraphInternal(d,!0),(this.checkIsNotRedoing()||(0,a.isNullOrUndefined)(this.editorHistory))&&(this.reLayout(this.selection),this.updateHistoryForComments(i))}}},e.prototype.deleteColumn=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl)if(this.owner.enableTrackChanges){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),this.alertDialog=el.DialogUtility.alert({title:e.getConstant("UnTrack"),content:e.getConstant("Merge Track"),showCloseIcon:!0,okButton:{text:"Ok",click:this.onDeleteColumnConfirmed.bind(this)},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}),this.alertDialog.enableRtl=this.owner.enableRtl}else this.onDeleteColumnConfirmed()},e.prototype.onDeleteColumnConfirmed=function(){var e=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(e.paragraph.isInsideTable){var t=this.selection.start.clone(),i=this.selection.end.clone();this.selection.selectColumn();var n=[];this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(n=this.checkAndRemoveComments(),this.selection.start.setPositionInternal(t),this.selection.end.setPositionInternal(i),this.initHistory("DeleteColumn")),this.selection.start.setPositionInternal(t),this.selection.end.setPositionInternal(i);var r=this.getOwnerCell(this.selection.isForward),o=this.getOwnerCell(!this.selection.isForward),s=r.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(s);var l=void 0;if(o.nextWidget){var d=o.nextWidget;l=this.selection.getFirstParagraph(d)}else if(r.previousWidget){var h=r.previousWidget;l=this.selection.getFirstParagraph(h)}(0,a.isNullOrUndefined)(l)&&(l=this.getParagraphForSelection(s));var c=s.getColumnCellsForSelection(r,o);this.onDeleteColumn(s,c),0===s.childWidgets.length?(l=this.getParagraphForSelection(s),this.removeBlock(s),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),s.destroy()):this.updateTable(s),this.selection.selectParagraphInternal(l,!0),((0,a.isNullOrUndefined)(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(n)),(0,a.isNullOrUndefined)(this.alertDialog)||(this.alertDialog.close(),this.alertDialog=void 0)}},e.prototype.onDeleteColumn=function(e,t){for(var i=0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(1===r.childWidgets.length)t.indexOf(r.childWidgets[0])>=0&&(this.removeFieldInWidget(r.childWidgets[0],!0),e.childWidgets.splice(e.childWidgets.indexOf(r),1),r.destroy(),i+=1,n--);else{for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];t.indexOf(s)>=0&&(this.removeFieldInWidget(s,!0),r.childWidgets.splice(o,1),s.destroy(),o--)}0===r.childWidgets.length&&(e.childWidgets.splice(e.childWidgets.indexOf(r),1),r.destroy(),i+=1,n--)}}return i},e.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end,t=(this.selection.isForward?this.selection.end:this.selection.start,this.selection.getParagraphInfo(e)),i=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());if(e.paragraph.isInsideTable){var n=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward);this.selection.selectRow();var s=[];this.checkIsNotRedoing()&&(s=this.checkAndRemoveComments(),this.initHistory("DeleteRow")),this.selection.owner.isShiftingEnabled=!0;var l=n.ownerTable.combineWidget(this.owner.viewer),d=this.getOwnerRow(!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(l);var h=void 0;if(d.nextWidget){var c=d.nextWidget.childWidgets[0];h=this.selection.getFirstParagraph(c)}if((0,a.isNullOrUndefined)(h)&&(h=this.getParagraphForSelection(l)),e=e.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(d,!0,!1):this.removeRow(d);else{var p=this.selection.getContainerCellOf(n,r);if(p.ownerTable.contains(r))if(n=this.selection.getSelectedCell(n,p),r=this.selection.getSelectedCell(r,p),this.selection.containsCell(p,r))d=n.ownerRow,this.owner.enableTrackChanges?((0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.editorHistory.currentBaseHistoryInfo.insertedText=o.Row),this.trackRowDeletion(d,!0,!1)):this.removeRow(d);else{d=n.ownerRow;var u=r.ownerRow;if(h=void 0,u.nextWidget){c=u.nextWidget.childWidgets[0];h=this.selection.getFirstParagraph(c)}(0,a.isNullOrUndefined)(h)&&(h=this.getParagraphForSelection(l));for(var g=0;g<l.childWidgets.length;g++){var m=l.childWidgets[g];if(m.rowIndex>=d.rowIndex&&m.rowIndex<=u.rowIndex)if(this.owner.enableTrackChanges&&this.checkIsNotRedoing())this.trackRowDeletion(m,!0,!1);else{this.removeFieldInBlock(m,!0);for(var f=m.previousRenderedWidget;!(0,a.isNullOrUndefined)(f);){for(var v=0;v<f.childWidgets.length;v++){var y=f.childWidgets[v];m.rowIndex<y.ownerRow.rowIndex+y.cellFormat.rowSpan&&y.cellFormat.rowSpan--}f=f.previousRenderedWidget}for(var w=0;w<m.childWidgets.length;w++){y=m.childWidgets[w];var b=m.nextRenderedWidget;if(!(0,a.isNullOrUndefined)(b)&&b.rowIndex<y.ownerRow.rowIndex+y.cellFormat.rowSpan){y.cellFormat.rowSpan--;var C=this.createColumn(this.selection.getLastParagraph(y));C.cellFormat.copyFormat(y.cellFormat),C.index=y.index,C.rowIndex=y.rowIndex,C.columnIndex=y.columnIndex,C.containerWidget=b,C.margin=y.margin.clone(),C.leftBorderWidth=y.leftBorderWidth,C.rightBorderWidth=y.rightBorderWidth,b.childWidgets.splice(C.columnIndex,0,C)}m.childWidgets.splice(w,1),w--}m.destroy(),g--}}0===l.childWidgets.length?(this.removeBlock(l),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),l.destroy()):this.updateTable(l)}}if(!this.owner.enableTrackChanges||(0,a.isNullOrUndefined)(l.childWidgets))this.selection.selectParagraphInternal(h,!0);else{var x=this.selection.getTextPosBasedOnLogicalIndex(i);this.selection.selectContent(x,!0)}((0,a.isNullOrUndefined)(this.editorHistory)||this.checkIsNotRedoing())&&(this.reLayout(this.selection,!0),this.updateHistoryForComments(s))}}},e.prototype.trackRowDeletion=function(e,t,i,n){var r=e.rowFormat;if(!(0,a.isNullOrUndefined)(r)){var o=!0;if(r.revisions.length>0){var s=this.retrieveRevisionInOder(r);if("Insertion"===s.revisionType){if(this.isRevisionMatched(r,void 0))return(0,a.isNullOrUndefined)(t)||t?this.removeRow(e):this.removeRevisionsInRow(e),!0}else"Deletion"===s.revisionType&&(this.unlinkWholeRangeInRevision(r,s),o=!(!this.owner.enableTrackChanges||this.skipTracking()))}o&&(((0,a.isNullOrUndefined)(i)||i)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(r,"Deletion"));for(var l=0;l<e.childWidgets.length;l++)for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++)if(d.childWidgets[h]instanceof Al)this.trackInnerTable(d.childWidgets[h],t,i);else{var c=d.childWidgets[h];if(this.skipTableElements=!0,o&&!this.skipTracking()&&0!==n)this.insertRevisionForBlock(c,"Deletion",void 0,void 0,!0,void 0,!0)&&h--;this.skipTableElements=!1}}return!1},e.prototype.trackInnerTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.trackRowDeletion(e.childWidgets[n],t,i)},e.prototype.returnDeleteRevision=function(e){for(var t=0;t<e.length;t++)if("Deletion"===e[t].revisionType)return e[t]},e.prototype.removeRow=function(e){var t=e.ownerTable;e.rowFormat.revisions.length>0&&this.removeRevisionsInRow(e),1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(this.removeFieldInBlock(e,!0),t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},e.prototype.updateTable=function(e,t){t||(e=e.combineWidget(this.viewer)),e.updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)},e.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget?e.nextWidget:e.nextRenderedWidget,n=e.previousWidget?e.previousWidget:e.previousRenderedWidget;return i?t=i instanceof Rl?i:this.documentHelper.getFirstParagraphInFirstCell(i):n&&(t=n instanceof Rl?n:this.documentHelper.getLastParagraphInLastCell(n)),t},e.prototype.deletePara=function(e,t,i,n){e=e.combineWidget(this.owner.viewer);var r,o=this.documentHelper.selection,s=o.getStartOffset(e),l=o.getStartOffset(i.paragraph),d=s,h=0,c=!1,p=this.selection.getLineLength(e.lastChild),u=e,g=e.bodyWidget instanceof Ol?e.bodyWidget:void 0,m=void 0,f=void 0,v=this.combineLastBlock,y=!1;e.isInsideTable&&t.paragraph.isInsideTable&&(y=t.paragraph!==e),e===t.paragraph?(d=t.offset,m=t.currentWidget,r=d,d+1===this.documentHelper.selection.getLineLength(e.lastChild)&&(0,a.isNullOrUndefined)(e.nextWidget)&&d++,!i.paragraph.isInsideTable||this.owner.enableTrackChanges&&!this.skipTracking()||(c=this.isEndInAdjacentTable(e,i.paragraph)),c||(c=this.combineLastBlock),this.combineLastBlock=!1):m=e.firstChild,e!==t.paragraph&&o.isSkipLayouting&&(o.isSkipLayouting=!1),e===i.paragraph?(f=i.currentWidget,h=i.offset):(f=e.lastChild,h=this.documentHelper.selection.getLineLength(e.lastChild));var w=(0,a.isNullOrUndefined)(e.previousRenderedWidget)||t.paragraph===e?void 0:e.previousRenderedWidget.combineWidget(this.documentHelper.viewer);if(this.owner.enableTrackChanges&&!(0,a.isNullOrUndefined)(w)&&w instanceof Al&&e.isEmpty()&&(0,a.isNullOrUndefined)(e.nextRenderedWidget))return this.delBlockContinue=!0,void(this.delBlock=w);(d>s&&t.currentWidget===e.lastChild&&d===p&&(e===i.paragraph&&i.offset===d+1||e.nextRenderedWidget===i.paragraph&&i.offset===l)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&w&&w.isPageBreak()&&(0===d&&!t.currentWidget.isFirstLine||d>0)||t.paragraph!==i.paragraph&&2===n&&t.paragraph===e&&t.paragraph.nextWidget===i.paragraph&&!this.owner.enableTrackChanges||!(e.nextRenderedWidget instanceof Al)&&!(0,a.isNullOrUndefined)(this.editorHistory)&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&("Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&i.paragraph!=e&&d>=s||("Accept Change"===this.editorHistory.currentBaseHistoryInfo.action||"Accept"===this.editorHistory.currentBaseHistoryInfo.isAcceptOrReject&&this.editorHistory.isRedoing)&&t.currentWidget.isLastLine()&&(t.currentWidget==i.currentWidget&&t.offset+1>=i.paragraph.getLength()||t.currentWidget!==i.currentWidget&&t.paragraph===e)))&&(c=!0),r+1===this.documentHelper.selection.getLineLength(e.lastChild)&&(0,a.isNullOrUndefined)(e.nextWidget)&&d--;var b=i.clone();b.offset=b.offset-1;var C=!1;!this.editorHistory||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&"InsertTextParaReplace"!==this.editorHistory.currentBaseHistoryInfo.action||i.paragraph!==e||h!==o.getLineLength(e.lastChild)+1||(C=!0);var x=t.paragraph===e&&t.isAtParagraphStart&&b.isAtParagraphEnd&&this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action;x&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace",i.paragraph!==e&&this.owner.enableTrackChanges&&2===n&&(x=!1));var I=t.paragraph===e;if(i.paragraph===e&&i.currentWidget!==e.lastChild||i.currentWidget===e.lastChild&&i.offset<=o.getLineLength(e.lastChild)||x){if((i.currentWidget.isFirstLine()&&i.offset>s||!i.currentWidget.isFirstLine()||x)&&this.removeInlines(e,m,d,f,h,n),(0,a.isNullOrUndefined)(w)||I||x)this.delBlockContinue=!1,this.delBlock=void 0;else this.delBlockContinue=!0,this.delBlock=w,(D=w.bodyWidget instanceof Ol?w.bodyWidget:void 0)&&!g.equals(D)&&g.index!==D.index?this.delSection=D:this.delSection=void 0}else{if(t.paragraph===e&&(t.currentWidget!==e.firstChild||t.currentWidget===e.firstChild&&d>s)){if(this.delBlockContinue=!1,this.delBlock=void 0,4===n)return;if(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action)this.addRemovedNodes(e.characterFormat.cloneFormat()),e.characterFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.characterFormat,!0),e.characterFormat.revisions=[];else if(this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action)if(c)u=this.splitParagraph(e,e.firstChild,0,m,d,!0,void 0,y),this.deleteParagraphMark(u,o,n,!0),this.addRemovedNodes(e);else{if(t.currentWidget===e.lastChild&&d===p+1&&d--,t.paragraph!==i.paragraph&&d!==e.getLength()){var k=new Rl;k.childWidgets=void 0,this.addRemovedNodes(k),this.handleDeleteParaMark(e,void 0)}else{(L=e==this.getLastParaForBodywidgetCollection(e))||this.handleDeleteParaMark(e,void 0)}if(this.removeInlines(e,m,d,f,h,n),d!==p){var F=e.lastChild;if(F.children.length>0){var P=F.children[F.children.length-1];this.combineElementRevision(P.revisions,e.characterFormat.revisions)}e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.lastChild.children[e.lastChild.children.length-1])}else this.combineRevisionWithValidElement(e)}else if(t.currentWidget.isFirstLine()||e.lastChild!==i.currentWidget||c){!(0,a.isNullOrUndefined)(this.editorHistory)&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&"Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&i.paragraph!=e&&d>=s&&c&&(v=!0),u=this.splitParagraph(e,e.firstChild,0,m,d,!0,!0,y),(0,a.isNullOrUndefined)(u)||(0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.deletaRevisionIDs(u.characterFormat);var S=!1;i.paragraph.isEmpty()||!c||this.editorHistory&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action||(S=!0),this.insertParagraphPaste(e,u,t,i,c,n,v,S),this.removeRevisionForBlock(e,void 0,!1,!0),!(0,a.isNullOrUndefined)(this.owner.editorHistory)&&!(0,a.isNullOrUndefined)(this.owner.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.owner.editorHistory.currentBaseHistoryInfo.action&&this.owner.editorHistory.historyInfoStack.length>0&&"DragAndDropContent"===this.owner.editorHistory.historyInfoStack[0].action?(this.addRemovedNodes(e.clone()),this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0),this.removeCommentsInBlock(e)):this.addRemovedNodes(e),v=!1}else this.removeInlines(e,m,d,f,h,n);return}(!this.owner.enableTrackChanges||this.skipTracking())&&i.paragraph===e&&i.paragraph.isInsideTable&&(t.currentWidget.isFirstLine()&&t.offset>o.getStartOffset(t.paragraph)||!t.currentWidget.isFirstLine())&&i.offset>=o.getLineLength(i.paragraph.lastChild)&&i.paragraph.nextRenderedWidget&&(this.combineLastBlock=!0);var T=void 0,H=e.previousWidget,E=H instanceof Rl?H:void 0,N=e.nextRenderedWidget;if(n<4){var W=!1;if(e==this.getLastParaForBodywidgetCollection(e)&&e===t.paragraph&&!e.isInsideTable&&!(0,a.isNullOrUndefined)(e.containerWidget)&&(0,a.isNullOrUndefined)(e.containerWidget.containerWidget)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"Delete"!==this.editorHistory.currentBaseHistoryInfo.action&&"Enter"!==this.editorHistory.currentBaseHistoryInfo.action&&(W=!0),this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.length,this.insertRevisionForBlock(e,"Deletion",void 0,void 0,void 0,C,void 0);e.characterFormat.revisions;if(e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.firstChild.children[0]),"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&!this.isInsertingTOC){if(e===i.paragraph&&e.containerWidget&&!e.isEmpty()||(0,a.isNullOrUndefined)(t.paragraph.containerWidget)&&!(0,a.isNullOrUndefined)(i.paragraph.containerWidget)&&!i.paragraph.isEmpty()){var O=this.selection.getParagraphInfo(i);this.selection.editPosition=this.selection.getHierarchicalIndex(O.paragraph,O.offset.toString())}if(e===t.paragraph){var B=this.selection.getParagraph({index:this.selection.editPosition});if((0,a.isNullOrUndefined)(B.paragraph)){O=this.selection.getParagraphInfo(i);this.selection.editPosition=this.selection.getHierarchicalIndex(O.paragraph,O.offset.toString())}}}if(t.paragraph!==e&&!(0,a.isNullOrUndefined)(w))return this.delBlockContinue=!0,void(this.delBlock=w)}else{T=this.checkAndInsertBlock(e,t,i,n,E),this.removeRevisionForBlock(e,void 0,!1,!0);var L=e==this.getLastParaForBodywidgetCollection(e);(0,a.isNullOrUndefined)(T)&&L||(W=!1);var D,R=!1;if((this.owner.enableTrackChanges||W)&&(L||C)){for(var M=e.childWidgets.length-1;M>-1;M--){var A=e.childWidgets[M];this.removeContent(A,0,this.documentHelper.selection.getLineLength(A),void 0,!1)}R=!0}else{var U=this.selection.getNextParagraphBlock(e);L||e.isInsideTable||(0,a.isNullOrUndefined)(U)||e.bodyWidget.sectionIndex===U.bodyWidget.sectionIndex||(this.deleteSection(o,e.bodyWidget,U.bodyWidget,n),I=!0),this.addRemovedNodes(e.clone())}if(!(0,a.isNullOrUndefined)(w)&&!I&&!x)if(this.delBlock=w,(D=w.bodyWidget instanceof Ol?w.bodyWidget:void 0)&&g.index!==D.index){var V=e.bodyWidget instanceof Ol?e.bodyWidget:void 0;this.deleteSection(o,D,V,n)}R||this.removeBlock(e,void 0,void 0,y)}if(this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),(0,a.isNullOrUndefined)(T)){if(e===t.paragraph&&((0,a.isNullOrUndefined)(N)||!(0,a.isNullOrUndefined)(N)&&!(0,a.isNullOrUndefined)(N.bodyWidget)&&!(0,a.isNullOrUndefined)(g)&&g.index!==N.bodyWidget.index)&&!(0,a.isNullOrUndefined)(E)){z=void 0;W?(z=this.selection.getStartOffset(e),o.editPosition=this.selection.getHierarchicalIndex(e,z.toString())):(z=this.selection.getParagraphLength(E),o.editPosition=this.selection.getHierarchicalIndex(E,z.toString())),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(o.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=o.editPosition)}}else{o.editPosition=this.selection.getHierarchicalIndex(T,"0");var z=o.getParagraphLength(T)+1;this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(T,z.toString()))}}t.paragraph===e||(0,a.isNullOrUndefined)(w)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=w)}this.insertParagraphPaste(e,u,t,i,c,n,v)},e.prototype.deletaRevisionIDs=function(e){if(e.removedIds.length>0)for(;e.removedIds.length>0;)e.removedIds.splice(0,1)},e.prototype.deleteSection=function(e,t,i,n){if(n<4){if(this.owner.enableCollaborativeEditing){var r=void 0,o=void 0,s=this.owner.documentHelper.headersFooters[t.sectionIndex][0];(0,a.isNullOrUndefined)(s)||(r={paragraph:s.firstChild,offset:0},o=this.owner.selectionModule.getPositionInfoForHeaderFooter(r,{position:0,done:!1}),this.editorHistory.currentBaseHistoryInfo.headerFooterStart=o.position);var l=Object.keys(this.owner.documentHelper.headersFooters[t.sectionIndex]).length;if(l>0&&(s=this.owner.documentHelper.headersFooters[t.sectionIndex][(l-1).toString()],!(0,a.isNullOrUndefined)(s))){var d=this.owner.selectionModule.getParagraphLength(s.lastChild);r={paragraph:s.lastChild,offset:d+1},o=this.owner.selectionModule.getPositionInfoForHeaderFooter(r,{position:0,done:!1}),this.editorHistory.currentBaseHistoryInfo.headerFooterEnd=o.position}}this.combineSectionInternal(e,t,i)}n>2&&t.sectionFormat.copyFormat(i.sectionFormat)},e.prototype.combineSectionInternal=function(e,t,i){var n=t.getSplitWidgets()[0],r=[],o=n.y;this.combineSectionChild(n,r,!0);var s=(n=r[0]).lastChild.index;this.updateBlockIndex(s+1,i.firstChild);var a=0,l=i;l.y=o;for(var d=0;d<n.childWidgets.length;d++){var h=n.childWidgets.splice(d,1)[0];l.childWidgets.splice(a,0,h),h.containerWidget=l,this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.bodyWidget,h,!1),l=(h=h.getSplitWidgets().pop()).containerWidget,a=h.indexInOwner+1,d--}if(n.sectionIndex>0&&this.documentHelper.headersFooters[n.sectionIndex]){n.removedHeaderFooters=[];var c=this.documentHelper.headersFooters.splice(n.sectionIndex,1)[0],p=Object.keys(c);for(d=0;d<p.length;d++){var u=c[p[d]];this.removeFieldInWidget(u),this.removeFieldInWidget(u,!1,!0),u.page=void 0}n.removedHeaderFooters.push(c)}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(n),this.documentHelper.removeEmptyPages(),!this.editorHistory||!this.editorHistory.isUndoing||this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endRevisionLogicalIndex||this.editorHistory.currentBaseHistoryInfo.lastElementRevision)||(i.sectionFormat=t.sectionFormat);var g=i.page;do{this.documentHelper.layout.layoutHeaderFooter(g.bodyWidgets[0],this.viewer,g),g=g.nextPage}while(g)},e.prototype.checkAndInsertBlock=function(e,t,i,n,r){if(e instanceof Rl&&e===t.paragraph||e instanceof Al){var o=void 0;if((0,a.isNullOrUndefined)(e.nextRenderedWidget)&&((0,a.isNullOrUndefined)(r)||r.nextRenderedWidget instanceof Al)){if(o=new Rl,1===n&&e instanceof Rl&&!(0,a.isNullOrUndefined)(e.paragraphFormat.baseStyle)&&"Normal"===e.paragraphFormat.baseStyle.name){if(o.characterFormat.copyFormat(e.characterFormat),(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&0!==o.characterFormat.removedIds.length)for(;o.characterFormat.removedIds.length>0;)o.characterFormat.removedIds.splice(0,1);o.paragraphFormat.copyFormat(e.paragraphFormat)}if(o.index=e.index+1,o.containerWidget=e.containerWidget,e instanceof Rl){o.paragraphFormat.lineSpacing=e.paragraphFormat.lineSpacing,o.paragraphFormat.lineSpacingType=e.paragraphFormat.lineSpacingType;var s=this.documentHelper.styles.findByName("Normal");(0,a.isNullOrUndefined)(s)||(o.paragraphFormat.baseStyle=new Wa,o.paragraphFormat.baseStyle.copyStyle(s))}this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1),e.containerWidget instanceof Nl&&e.containerWidget.childWidgets.push(o)}return o}},e.prototype.splitParagraph=function(e,t,i,n,r,o,s,l){var d=new Rl;d.paragraphFormat=new ba(d),d.characterFormat=new ka(d),d.paragraphFormat.copyFormat(e.paragraphFormat),d.characterFormat.copyFormat(e.characterFormat),d.characterFormat.removedIds=[];var h=new zl(d);d.childWidgets.push(h);var c=e.index,p=e.indexInOwner;if(this.moveInlines(e,d,0,i,t,r,n,o),e.containerWidget.childWidgets[p]){for(var u=[],g=e.containerWidget.childWidgets[p],m=0;m<g.childWidgets.length;m++)for(var f=g.childWidgets[m],v=0;v<f.children.length;v++){var y=f.children[v];y instanceof Yl?this.removeFootnote(y):y instanceof td&&o&&(!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||y instanceof td&&u.push(y),y instanceof td&&this.documentHelper.bookmarks.containsKey(y.name)&&(this.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:y.name}),this.documentHelper.bookmarks.remove(y.name)))}for(m=u.length-1;m>=0;m--)this.removedBookmarkElements.push(u[m])}return e.containerWidget.childWidgets.splice(p,0,d),d.index=c,d.containerWidget=e.containerWidget,this.updateNextBlocksIndex(d,!0),o&&this.removeBlock(e,void 0,s,l),this.documentHelper.layout.layoutBodyWidgetCollection(c,d.containerWidget,d,!1),d},e.prototype.removeCommentsInBlock=function(e){if(e instanceof Al)for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];this.removeCommentsInBlock(s)}else this.removeCommentInPara(e)},e.prototype.removeCommentInPara=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)this.removeCommentsInline(i.children[n])},e.prototype.removeCommentsInline=function(e){e instanceof Bd&&(1===e.commentType||e.removeCommentMark())},e.prototype.removeBlock=function(e,t,i,n){var r,o;i||(this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0),this.removeFieldInBlock(e,void 0,void 0,!0),this.removeCommentsInBlock(e)),e.isInsideTable?(o=e.associatedCell,r=e.associatedCell.childWidgets.indexOf(e),e.associatedCell.childWidgets,this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(r,1),e.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,o,e,!1,void 0,n)):(o=e.containerWidget,this.checkAndRemoveRevisionFromBlock(e,!0),r=o.childWidgets.indexOf(e),o.childWidgets,this.updateNextBlocksIndex(e,!1),o.childWidgets.splice(r,1),e.containerWidget=void 0,o.height-=e.height,!(0,a.isNullOrUndefined)(o.containerWidget)&&o.containerWidget instanceof Dl&&(o.containerWidget.height-=e.height),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,o,e,!1,t,n))},e.prototype.checkAndRemoveRevisionFromBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n=void 0;if(this.isPasteRevertAction()||(n=this.skipTracking()),e.childWidgets[i]instanceof Ul&&!n){var r=e.childWidgets[i];this.removeDeletedCellRevision(r,t)}if(e.childWidgets[i]instanceof zl)for(var o=e.childWidgets[i],s=0;s<o.children.length;s++){var a=o.children[s];a instanceof Yl&&!this.selection.isEmpty&&this.removeFootnote(a)}}},e.prototype.removePrevParaMarkRevision=function(e,t,i){if(t=!(0,a.isNullOrUndefined)(t)&&t,this.owner.enableTrackChanges||0!=e.characterFormat.revisions.length){var n=-1,r=void 0,o=e;if(t||(0,a.isNullOrUndefined)(o.previousRenderedWidget)||(o=o.previousRenderedWidget),o.characterFormat.revisions.length>0&&(n=(r=o.characterFormat.revisions[o.characterFormat.revisions.length-1]).range.indexOf(o.characterFormat)),n>=0&&!(0,a.isNullOrUndefined)(r))r.range[n]instanceof ka&&(r.range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r),o.characterFormat&&o.characterFormat.revisions.indexOf(r)>-1&&(i&&e.characterFormat.removedIds.push(r.revisionID),o.characterFormat.revisions.splice(o.characterFormat.revisions.indexOf(r),1)),0==r.range.length&&this.owner.revisionsInternal.remove(r))}},e.prototype.isPasteRevertAction=function(){return!((0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.toCheckForTrack=function(e){if(this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof Al&&e.childWidgets.length>0){var t=e.childWidgets[0].rowFormat;if(t.revisions.length>0&&"Insertion"!==t.revisions[0].revisionType&&t.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===t.revisions.length)return!0}return!1},e.prototype.removeFootnote=function(e,t){if(e.paragraph.bodyWidget.page.footnoteWidget){for(var i=e.paragraph.bodyWidget.page.footnoteWidget,n=0;n<i.bodyWidgets.length;n++)if(e===i.bodyWidgets[n].footNoteReference){if(i.height-=i.bodyWidgets[n].childWidgets[0].height,this.owner.enableTrackChanges)for(var r=0;r<i.bodyWidgets[n].childWidgets.length;r++)this.removeRevisionForBlock(i.bodyWidgets[n].childWidgets[r],void 0,!1,!0);i.bodyWidgets.splice(n,1),n--,this.isFootnoteElementRemoved=!0}0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(e),1),this.updateFootNoteIndex()},e.prototype.removeEndnote=function(e,t){var i=this.documentHelper.pages.length,n=this.documentHelper.pages[i-1].bodyWidgets[0];if(n.page.endnoteWidget){for(var r=n.page.endnoteWidget,o=0;o<r.bodyWidgets.length;o++)if(e===r.bodyWidgets[o].footNoteReference){if(r.height-=r.bodyWidgets[o].childWidgets[0].height,this.owner.enableTrackChanges)for(var s=0;s<r.bodyWidgets[o].childWidgets.length;s++)this.removeRevisionForBlock(r.bodyWidgets[o].childWidgets[s],void 0,!1,!0);r.bodyWidgets.splice(o,1),this.isEndnoteElementRemoved=!0,o--}0===r.bodyWidgets.length&&(n.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(e),1),this.updateEndNoteIndex()},e.prototype.removeAutoShape=function(e){var t=e.line.paragraph.floatingElements.indexOf(e),i=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);i>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(i,1),e.line.paragraph.floatingElements.splice(t,1)},e.prototype.removeField=function(e,t,i,n){if(n)for(var r=this.documentHelper.editRanges.keys,o=0;o<r.length;o++){for(var s=this.documentHelper.editRanges.get(r[o]),l=0;l<s.length;l++){(f=s[l]).line.paragraph===e&&(s.splice(l,1),l--)}0===s.length&&(this.documentHelper.editRanges.remove(r[o]),o--)}else{var d=this.documentHelper.fields;if(t?d=this.documentHelper.bookmarks.keys:i&&(d=this.documentHelper.contentControlCollection),e.floatingElements.length>0)for(var h=0;h<e.floatingElements.length;h++){var c=e.floatingElements[h];if(c instanceof hd&&c.textFrame&&c.textFrame.childWidgets.length>0)for(o=0;o<c.textFrame.childWidgets.length;o++){var p=c.textFrame.childWidgets[o];this.removeFieldInBlock(p,t,i)}this.removeAutoShape(c),h--}for(o=0;o<d.length;o++){if((f=t?this.documentHelper.bookmarks.get(d[o]):d[o]).line.paragraph===e||f instanceof td&&!(0,a.isNullOrUndefined)(f.reference)&&f.reference.line.paragraph===e){if(t){if(this.documentHelper.bookmarks.remove(d[o]),f.line.children.splice(f.indexInOwner,1),!(0,a.isNullOrUndefined)(f.line.paragraph.associatedCell))(u=f.line.paragraph.associatedCell).isRenderBookmarkStart?u.isRenderBookmarkStart=!1:u.isRenderBookmarkEnd=!1;var u,g=f.reference;if(g&&g.line.children.splice(g.indexInOwner,1),g&&!(0,a.isNullOrUndefined)(g.line.paragraph.associatedCell))(u=g.line.paragraph.associatedCell).isRenderBookmarkStart?u.isRenderBookmarkStart=!1:u.isRenderBookmarkEnd=!1}else i?this.documentHelper.contentControlCollection.splice(o,1):(this.documentHelper.fields.splice(o,1),-1!==this.documentHelper.formFields.indexOf(f)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(f),1));o--}}}if(this.documentHelper.footnoteCollection.length>0)for(o=0;o<this.documentHelper.footnoteCollection.length;o++){if((f=this.documentHelper.footnoteCollection[o]).line.paragraph===e){if(f.paragraph.bodyWidget.page.footnoteWidget){var m=f.paragraph.bodyWidget.page.footnoteWidget;for(l=0;l<m.bodyWidgets.length;l++)f===m.bodyWidgets[l].footNoteReference&&(m.height-=m.bodyWidgets[l].height,m.bodyWidgets.splice(l,1),l--);0===m.bodyWidgets.length&&(f.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(o,1),o--}}if(this.documentHelper.endnoteCollection.length>0)for(o=0;o<this.documentHelper.endnoteCollection.length;o++){var f;if((f=this.documentHelper.endnoteCollection[o]).line.paragraph===e){if(f.paragraph.bodyWidget.page.endnoteWidget){var v=f.paragraph.bodyWidget.page.endnoteWidget;for(l=0;l<v.bodyWidgets.length;l++)f===v.bodyWidgets[l].footNoteReference&&(v.height-=v.bodyWidgets[l].height,v.bodyWidgets.splice(l,1),l--);0===v.bodyWidgets.length&&(f.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(o,1),o--}}},e.prototype.getTabsInSelection=function(){var e=[],t=this.owner.selectionModule,i=[];if(0===t.selectedWidgets.keys.length)return t.start.paragraph.paragraphFormat.getUpdatedTabs();if(t.start.paragraph===t.end.paragraph)return t.start.paragraph.paragraphFormat.getUpdatedTabs();t.start.paragraph!==t.end.paragraph&&(i=this.owner.selectionModule.getParagraphsInSelection());for(var n=i.length>0?i[0]:void 0,r=(0,a.isNullOrUndefined)(n)?[]:n.paragraphFormat.getUpdatedTabs(),o=!0,s=0;s<r.length;s++)e.push(r[s]);for(var l=1;l<i.length;l++){var d=i[l].paragraphFormat.getUpdatedTabs(),h=[];o=!0;for(var c=0;c<e.length;c++){for(s=0;s<d.length;s++)if(d[s].equals(e[c])){o=!1;break}o&&h.push(e[c])}for(c=0;c<h.length;c++)e.splice(e.indexOf(h[c]),1)}return e},e.prototype.updateTabStopCollection=function(e,t,i){var n=e.paragraphFormat.tabs;if(i){e.paragraphFormat.tabs=[];for(var r=0;r<t.length;r++)e.paragraphFormat.tabs.push(t[r])}else for(r=0;r<t.length;r++){for(var o=t[r],s=-1,a=0;a<n.length;a++){var l=n[a];if(o.position===l.position){s=a;break}if(o.position<l.position)break}s>=0?this.modifyTabStop(n[s],o):this.addTabStopToCollection(n,o)}},e.prototype.modifyTabStop=function(e,t){e.deletePosition=t.deletePosition,e.tabJustification=t.tabJustification,e.tabLeader=t.tabLeader},e.prototype.removeTabStops=function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i].paragraphFormat.tabs,r=0;r<t.length;r++)for(var o=t[r],s=0;s<n.length;s++)if(n[s].equals(o)){n.splice(s,1);break}},e.prototype.addTabStopToCollection=function(e,t,i){for(var n=-1,r=0;r<e.length;r++){if(e[r].position>t.position){n=r;break}}return n=-1===n?e.length:n,i||e.splice(n,0,t.clone()),n},e.prototype.addRemovedNodes=function(e,t){e instanceof Bd&&0===e.commentType&&e.commentMark&&e.removeCommentMark(),e instanceof id&&(0===e.type?this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(e),1):this.updatePropertiesToBlock(e.reference)),e instanceof _l&&0===e.fieldType&&(-1!==this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(e),1),-1!==this.documentHelper.formFields.indexOf(e)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(e),1)),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)?t?this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(0,0,e):this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},e.prototype.deleteBlock=function(e,t,i,n,r){if(e instanceof Rl){if(this.deletePara(e,i,n,r),this.delBlockContinue&&this.delBlock){if(this.delSection){var o=e.bodyWidget instanceof Ol?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,o,r),this.delSection=void 0}-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteTableBlock(e,t,i,n,r),(0,a.isNullOrUndefined)(e.childWidgets)||!this.owner.enableTrackChanges||this.skipTracking()||this.documentHelper.layout.reLayoutTable(e)},e.prototype.deleteTableCell=function(e,t,i,n,r,o){var s=!(i.paragraph.isInsideTable&&e.ownerTable.contains(i.paragraph.associatedCell)),l=e.ownerTable.previousRenderedWidget;if(i.paragraph.isInsideTable){var d=t.getContainerCellOf(e,i.paragraph.associatedCell);if(d.ownerTable.contains(i.paragraph.associatedCell)){var h=t.getSelectedCell(e,d);t.getSelectedCell(i.paragraph.associatedCell,d);if(t.containsCell(d,i.paragraph.associatedCell))if(t.isCellSelected(d,i,n))if(this.updateEditPosition(d,t),1===r||o)this.deleteCellsInTable(e.ownerRow.ownerTable,t,i,n,r);else{var c=this.deleteCell(d,t,r,!0);!c&&2!==r&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:c&&this.documentHelper.layout.reLayoutTable(d.ownerRow.ownerTable)}else if(h===d){if(this.deletePara(n.paragraph,i,n,r),this.delBlockContinue&&this.delBlock){if(this.delSection){var p=n.paragraph,u=p.bodyWidget instanceof Ol?p.bodyWidget:void 0;this.deleteSection(t,this.delSection,u,r),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,n,r),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteContainer(h,t,i,n,r);else 2===r?this.deleteCell(e,t,2,!1):(s=!1,this.deleteCellsInTable(d.ownerTable,t,i,n,r))}else this.deleteContainer(d,t,i,n,r)}else{var g=t.getContainerCell(e);(0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing?this.deleteContainer(g,t,i,n,r):(this.deleteTableBlock(g.ownerTable,t,i,n,r),s=!1)}if(s){l.bodyWidget instanceof Ol&&l.bodyWidget;(0,a.isNullOrUndefined)(l)||this.deleteBlock(l,t,i,n,r)}},e.prototype.deleteCellsInTable=function(e,t,i,n,r,o){var s=this,l="Delete",d=!1,h=i.paragraph.associatedCell,c=n.paragraph.associatedCell;(0,a.isNullOrUndefined)(o)||(c=o);var p=this.documentHelper.layout.getParentTable(h),u=this.documentHelper.layout.getParentCell(h),g=this.documentHelper.layout.getParentCell(c);(0,a.isNullOrUndefined)(o)&&i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&this.selection.isCellSelected(u,i,n)&&(h=u,c=g);var m=h.columnIndex,f=c.columnIndex+c.cellFormat.columnSpan-1,v=h.rowIndex,y=c.rowIndex,w=this.isWholeRowSelected(h.ownerRow,m,f);if(this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){if(l=this.editorHistory.currentBaseHistoryInfo.action,d="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||(0,a.isNullOrUndefined)(h.ownerRow.previousWidget)&&(0,a.isNullOrUndefined)(c.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(e,e===p),this.editorHistory.isRedoing&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)for(var b=0;b<e.childWidgets.length;b++){var C=e.childWidgets[b];C.index>=v&&C.index<=y&&w&&this.trackRowDeletion(C,!1)}if("RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=d?"DeleteCells":"ClearCells",t.owner.isLayoutEnabled=!1}if(this.owner.enableTrackChanges&&!this.skipTracking()){var x=!1;if(w)this.onConfirmedTableCellsDeletion(e,t,v,y,m,f,d,r,w,l);else if(1===r){var I=new a.L10n("documenteditor",this.owner.defaultLocale),k=I.getConstant("UnTrack"),F=I.getConstant("Merge Track");I.setLocale(this.owner.locale),this.alertDialog=el.DialogUtility.alert({title:k,content:F,showCloseIcon:!0,okButton:{text:"Ok",click:function(){x=!0,s.onConfirmedTableCellsDeletion(e,t,v,y,m,f,d,r,w,l)}},closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"},close:function(){x||(s.documentHelper.layout.reLayoutTable(e),s.viewer.updateScrollBars())}}),this.alertDialog.enableRtl=this.owner.enableRtl}else this.trackDeletedContentInTableCell(e,t,i,n,r,v,y,m,f)}else this.onConfirmedTableCellsDeletion(e,t,v,y,m,f,d,r,w,l)},e.prototype.removeDeletedCellRevision=function(e,t){e.rowFormat.revisions.length>0&&t&&this.unlinkRangeFromRevision(e.rowFormat,!0);for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if(!(0,a.isNullOrUndefined)(o)&&o instanceof Rl){for(var s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];if(!(0,a.isNullOrUndefined)(l.children))for(var d=0;d<l.children.length;d++){var h=l.children[d];h.revisions.length>0&&this.unlinkRangeFromRevision(h,!0)}}this.unlinkRangeFromRevision(o.characterFormat,!0)}else if(!(0,a.isNullOrUndefined)(o)&&o instanceof Al)for(var c=0;c<o.childWidgets.length;c++){var p=o.childWidgets[c];this.removeDeletedCellRevision(p,!0)}}},e.prototype.removeDeletedShapeRevision=function(e){var t=e.textFrame;if(!(0,a.isNullOrUndefined)(t))for(var i=0;i<t.childWidgets.length;i++){var n=t.childWidgets[i];if(!(0,a.isNullOrUndefined)(n)&&n instanceof Rl){for(var r=0;r<n.childWidgets.length;r++){var o=n.childWidgets[r];if(!(0,a.isNullOrUndefined)(o.children))for(var s=0;s<o.children.length;s++){var l=o.children[s];l.revisions.length>0&&this.unlinkRangeFromRevision(l,!0)}}this.unlinkRangeFromRevision(n.characterFormat,!0)}}},e.prototype.insertShape=function(e,t){var i=this.getShape(e,t);this.owner.documentHelper.selection.start.currentWidget.children.push(i),this.reLayout(this.owner.documentHelper.selection),this.documentHelper.currentPage.bodyWidgets[0].floatingElements.push(i)},e.prototype.getShape=function(e,t){var i=(new hd).clone();i.shapeId=parseInt(Date.now().toString().slice(0,10),10),i.name=e+" "+(this.documentHelper.currentPage.bodyWidgets[0].floatingElements.length+1),t=(0,a.isNullOrUndefined)(t)?{}:t,i.x=(0,a.isNullOrUndefined)(t.x)?50:t.x,i.y=(0,a.isNullOrUndefined)(t.x)?50:t.y,i.autoShapeType=e,"UpDownArrow"===e?(i.height=(0,a.isNullOrUndefined)(t.height)?140:t.height,i.width=(0,a.isNullOrUndefined)(t.width)?96:t.width):"LeftRightArrow"===e||"LeftRightArrowCallout"===e?(i.height=(0,a.isNullOrUndefined)(t.height)?80:t.height,i.width=(0,a.isNullOrUndefined)(t.width)?140:t.width):(i.height=(0,a.isNullOrUndefined)(t.height)?96:t.height,i.width=(0,a.isNullOrUndefined)(t.width)?96:t.width),i.visible=!!(0,a.isNullOrUndefined)(t.visible)||t.visible,i.widthScale=(0,a.isNullOrUndefined)(t.widthScale)?100:t.widthScale,i.heightScale=(0,a.isNullOrUndefined)(t.heightScale)?100:t.heightScale,i.verticalPosition=(0,a.isNullOrUndefined)(t.verticalPosition)?i.y:t.verticalPosition,i.verticalOrigin=(0,a.isNullOrUndefined)(t.verticalOrigin)?"Paragraph":t.verticalOrigin,i.verticalAlignment=(0,a.isNullOrUndefined)(t.verticalAlignment)?"None":t.verticalAlignment,i.verticalRelativePercent=-34028235e31,i.horizontalPosition=(0,a.isNullOrUndefined)(t.horizontalPosition)?i.x:t.horizontalPosition,i.horizontalRelativePercent=-34028235e31,i.heightRelativePercent=-34028235e31,i.widthRelativePercent=0,i.horizontalOrigin=(0,a.isNullOrUndefined)(t.horizontalOrigin)?"Column":t.horizontalOrigin,i.horizontalAlignment=(0,a.isNullOrUndefined)(t.horizontalAlignment)?"None":t.horizontalAlignment,i.zOrderPosition=251659264,i.allowOverlap=!!(0,a.isNullOrUndefined)(t.allowOverLap)||t.allowOverLap,i.textWrappingStyle=(0,a.isNullOrUndefined)(t.textWrappingStyle)?"InFrontOfText":t.textWrappingStyle,i.textWrappingType=(0,a.isNullOrUndefined)(t.textWrappingType)?"Both":t.textWrappingType,i.isBelowText=!(0,a.isNullOrUndefined)(t.isBelowText)&&t.isBelowText,i.distanceBottom=(0,a.isNullOrUndefined)(t.distanceBottom)?0:t.distanceBottom,i.distanceTop=(0,a.isNullOrUndefined)(t.distanceTop)?0:t.distanceTop,i.distanceLeft=(0,a.isNullOrUndefined)(t.distanceLeft)?12:t.distanceLeft,i.distanceRight=(0,a.isNullOrUndefined)(t.distanceRight)?12:t.distanceRight,i.isHorizontalRule=!(0,a.isNullOrUndefined)(t.isHorizontalRule)&&t.isHorizontalRule,i.layoutInCell=!!(0,a.isNullOrUndefined)(t.layoutInCell)||t.layoutInCell,i.lockAnchor=!(0,a.isNullOrUndefined)(t.lockAnchor)&&t.lockAnchor;var n=new cd;n.textVerticalAlignment="Arc"===e||"CurvedConnector"===e||"ElbowConnector"===e?"Top":"Middle",n.marginLeft=10,n.marginRight=10,n.marginTop=5,n.marginBottom=5,i.textFrame=n,n.containerShape=i;var r=new ud;"Arc"===e||"CurvedConnector"===e||"ElbowConnector"===e||"DoubleBracket"===e||"DoubleBrace"===e||"RightBrace"===e||"LeftBrace"===e||"RightBracket"===e||"LeftBracket"===e?(r.color=(0,a.isNullOrUndefined)(t.fillColor)?"#FFFFFFFF":t.fillColor,r.fill=!!(0,a.isNullOrUndefined)(t.fill)||t.fill):(r.fill=!!(0,a.isNullOrUndefined)(t.fill)||t.fill,r.color=(0,a.isNullOrUndefined)(t.fillColor)?"#156082FF":t.fillColor),i.fillFormat=r;var o=new pd;return o.lineFormatType=(0,a.isNullOrUndefined)(t.lineFormatType)?"Solid":t.lineFormatType,o.dashStyle=(0,a.isNullOrUndefined)(t.dashStyle)?"Solid":t.dashStyle,o.line=!!(0,a.isNullOrUndefined)(t.line)||t.line,"Arc"===e||"CurvedConnector"===e||"ElbowConnector"===e||"DoubleBracket"===e||"DoubleBrace"===e||"RightBrace"===e||"LeftBrace"===e||"RightBracket"===e||"LeftBracket"===e?(o.color=(0,a.isNullOrUndefined)(t.lineColor)?"#156082FF":t.lineColor,o.weight=(0,a.isNullOrUndefined)(t.lineWeight)?.5:t.lineWeight):(o.color=(0,a.isNullOrUndefined)(t.lineColor)?"#042433FF":t.lineColor,o.weight=(0,a.isNullOrUndefined)(t.lineWeight)?1:t.lineWeight),i.lineFormat=o,i.line=this.owner.documentHelper.selection.start.currentWidget,i},e.prototype.trackDeletedContentInTableCell=function(e,t,i,n,r,o,s,l,d){var h,c,p;this.selection.hasMergedCells()?(c=this.selection.getCellFromSelectionInTable(0),p=this.selection.getCellFromSelectionInTable(1)):(c=this.selection.getCellFromSelection(0),p=this.selection.getCellFromSelection(1));var u=this.selection.getActualOffset(c,0),g=this.selection.getActualOffset(p,1),m=[],f=!1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&m.push.apply(m,this.editorHistory.currentBaseHistoryInfo.removedNodes);for(var v=0;v<e.childWidgets.length;v++){var y=e.childWidgets[v];if(y.index>=o&&y.index<=s)for(var w=0;w<y.childWidgets.length;w++){var b=y.childWidgets[w];if(b.columnIndex>=l&&b.columnIndex<=d)for(var C=y.childWidgets[w],x=C.childWidgets.length,I=0;I<C.childWidgets.length;I++){var k=C.childWidgets[I];if(k instanceof Rl){var F=k;this.insertRevisionForBlock(F,"Deletion",void 0,void 0,void 0,void 0,!0),x!==C.childWidgets.length&&(I--,x=C.childWidgets.length,f=!0),F.isEmpty()?this.combineRevisionWithBlocks(F):this.combineRevisionWithBlocks(F.lastChild.children[F.lastChild.children.length-1])}else for(var P=k,S=0;S<P.childWidgets.length;S++){var T=this.trackRowDeletion(P.childWidgets[S],void 0,!1);if((0,a.isNullOrUndefined)(P.childWidgets)){I--;break}P.childWidgets.length>0&&T&&S--}}}}this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.removedNodes.length=0,(h=this.editorHistory.currentBaseHistoryInfo.removedNodes).push.apply(h,m),this.editorHistory.currentBaseHistoryInfo.isRevisionEndInAnotherCell=!0,this.editorHistory.currentBaseHistoryInfo.selectionStart=u,this.editorHistory.currentBaseHistoryInfo.insertPosition=u,this.editorHistory.currentBaseHistoryInfo.selectionEnd=g,this.editorHistory.currentBaseHistoryInfo.endPosition=g,f&&(g=this.selection.getActualOffset(p,1),this.editorHistory.currentBaseHistoryInfo.selectionEnd=g,this.editorHistory.currentBaseHistoryInfo.endPosition=g,this.selection.editPosition=u))},e.prototype.onConfirmedTableCellsDeletion=function(e,t,i,n,r,o,s,l,d,h){for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c],u=!1;if(p.index>=i&&p.index<=n&&(this.owner.enableTrackChanges&&!this.skipTracking()&&d?(u=this.trackRowDeletion(p,!1,void 0,l))&&this.onConfirmedCellDeletion(p,t,i,n,r,o,s,l,d):this.onConfirmedCellDeletion(p,t,i,n,r,o,s,l,d)),u||0===p.childWidgets.length){for(var g=e.childWidgets[c],m=g.previousRenderedWidget;!(0,a.isNullOrUndefined)(m);){for(var f=0;f<m.childWidgets.length;f++){var v=m.childWidgets[f];g.rowIndex<v.ownerRow.rowIndex+v.cellFormat.rowSpan&&v.cellFormat.rowSpan--}m=m.previousRenderedWidget}this.updateNextBlocksIndex(g,!1),e.childWidgets.splice(c,1),c--,n--}}if(t.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(e,"0"),this.setActionInternal(t,h),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)),!(0,a.isNullOrUndefined)(this.alertDialog)){var y=t.getTextPosBasedOnLogicalIndex(t.editPosition);t.selectContent(y,!0),this.reLayout(t),this.alertDialog.close(),this.alertDialog=void 0}},e.prototype.onConfirmedCellDeletion=function(e,t,i,n,r,o,s,l,d){var h=!1;this.removeDeletedCellRevision(e,d);for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c];if(p.columnIndex>=r&&p.columnIndex<=o)if(h||(this.updateEditPosition(p,t),h=!0),s){var u=e.childWidgets[c];this.updateNextBlocksIndex(u,!1);for(var g=0;g<u.childWidgets.length;g++)for(var m=u.childWidgets[g],f=0;f<m.childWidgets.length;f++){var v=m.childWidgets[f];if(v instanceof zl)for(var y=v,w=0;w<y.children.length;w++){var b=y.children[w];b instanceof Yl&&this.removeFootnote(b)}}var C=e.nextRenderedWidget;if(!(0,a.isNullOrUndefined)(C)&&C.rowIndex<u.ownerRow.rowIndex+u.cellFormat.rowSpan){u.cellFormat.rowSpan--;var x=this.createColumn(this.selection.getLastParagraph(u));x.cellFormat.copyFormat(u.cellFormat),x.index=u.index,x.rowIndex=u.rowIndex,x.columnIndex=u.columnIndex,x.containerWidget=C,x.margin=u.margin.clone(),x.leftBorderWidth=u.leftBorderWidth,x.rightBorderWidth=u.rightBorderWidth,C.childWidgets.splice(x.columnIndex,0,x)}e.childWidgets.splice(c,1),c--}else l<4&&this.deleteCell(p,t,l,!1)}},e.prototype.removeRevisionForRow=function(e){e.rowFormat.revisions.length>0&&this.skipTracking()&&(this.unlinkRangeFromRevision(e.rowFormat,!0),this.addRemovedRevisionInfo(e.rowFormat,void 0))},e.prototype.removeRevisionsInRow=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){var i=e.rowFormat.revisions[t];this.unlinkWholeRangeInRevision(e.rowFormat,i)}},e.prototype.removeRevisionForCell=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i]instanceof Rl)for(var n=e.childWidgets[i],r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=0;s<o.children.length;s++){var l=o.children[s];!(0,a.isNullOrUndefined)(l)&&l.revisions.length>0&&(this.unlinkRangeFromRevision(l,t),this.addRemovedRevisionInfo(l,void 0))}else e.childWidgets[i]instanceof Al&&this.removeRevisionForInnerTable(e.childWidgets[i])},e.prototype.removeRevisionForInnerTable=function(e){if(e.childWidgets.length>0)for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];(0,a.isNullOrUndefined)(i)||this.removeRevisionForRow(i)}},e.prototype.removeRevisionForBlock=function(e,t,i,n){if(e.characterFormat.revisions.length>0&&!i&&(n&&this.addRemovedRevisionInfo(e.characterFormat,void 0,!1),(0,a.isNullOrUndefined)(t)?this.unlinkRangeFromRevision(e.characterFormat,!0):this.unlinkRangeByRevision(e.characterFormat,t),e.characterFormat.revisions=[]),!(0,a.isNullOrUndefined)(e))for(var r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.children.length;s++){var l=o.children[s];if(l instanceof Yl){var d=l.nextValidNodeForTracking;"Footnote"===d.footnoteType?this.removeFootnote(d):this.removeEndnote(d)}!(0,a.isNullOrUndefined)(l)&&l.revisions.length>0&&(n&&this.addRemovedRevisionInfo(l,void 0,!1),(0,a.isNullOrUndefined)(t)?this.unlinkRangeFromRevision(l,!0):this.unlinkRangeByRevision(l,t),l.revisions=[])}},e.prototype.unlinkRangeByRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];if(n.author===t.author&&n.revisionType===t.revisionType){e.revisions.splice(e.revisions.indexOf(t),1);var r=t.range.indexOf(e);t.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t)}}},e.prototype.isWholeRowSelected=function(e,t,i){var n=t+i;return 0===t&&e.childWidgets.length-1===n},e.prototype.deleteCell=function(e,t,i,n){var r=e.childWidgets[0];if(1===e.childWidgets.length&&r instanceof Rl&&r.isEmpty())return!1;for(var o=e.childWidgets.length-1,s=e.childWidgets.length-1;s>-1;s--)if(r=e.childWidgets[s],i<4){if(r instanceof Rl&&s===o){var a=r;if(this.checkClearCells(t))a.isEmpty()||this.removeInlines(a,a.firstChild,0,a.lastChild,a.lastChild.getEndOffset(),i);else for(var l=a.childWidgets.length-1;l>=0;l--){for(var d=a.childWidgets[l],h=d.children.length-1;h>=0;h--){var c=d.children[h];c instanceof Yl?this.removeFootnote(c):c instanceof td&&0===c.bookmarkType&&this.documentHelper.bookmarks.containsKey(c.name)&&this.documentHelper.bookmarks.remove(c.name),this.unLinkFieldCharacter(c),d.children.splice(h,1)}a.childWidgets.length>1&&a.childWidgets.splice(l,1)}continue}this.removeBlock(r),this.checkClearCells(t)&&(this.addRemovedNodes(r),1===e.childWidgets.length&&(t.editPosition=this.selection.getHierarchicalIndex(e.childWidgets[0],"0"),this.updateHistoryPosition(t.editPosition,!0)))}return!0},e.prototype.paragrapghBookmarkCollection=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++){var r=this.documentHelper.bookmarks.get(i.keys[n]);r.paragraph===e&&t.push(r)}return t},e.prototype.deleteContainer=function(e,t,i,n,r){var o=e.ownerTable;if(t.containsRow(o.lastChild,n.paragraph.associatedCell)&&!this.owner.enableTrackChanges)this.deleteContent(o,t,r);else if(this.toCheckForTrack(o)){this.cloneTableToHistoryInfo(o);for(var s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];if(this.trackRowDeletion(l),n.paragraph.isInsideTable&&t.containsRow(l,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}}else if(o.childWidgets.length>0){var d=o.childWidgets[o.childWidgets.length-1];if(t.containsRow(d,n.paragraph.associatedCell))if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(o);for(var h=0;h<o.childWidgets.length;h++)this.trackRowDeletion(o.childWidgets[h],!1);(0,a.isNullOrUndefined)(o.childWidgets)||(0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(o)}else this.deleteContent(o,t,r);else for(var c=0;c<o.childWidgets.length;c++){var p=o.childWidgets[c];if(r<4&&(this.updateNextBlocksIndex(p,!1),o.childWidgets.splice(c,1),this.addRemovedNodes(p),c--),n.paragraph.isInsideTable&&t.containsRow(p,n.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}}},e.prototype.deleteTableBlock=function(e,t,i,n,r){if(e=e.combineWidget(this.owner.viewer),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)){var o=e.previousRenderedWidget,s=this.checkAndInsertBlock(e,i,n,r,o instanceof Rl?o:void 0);if(t.containsRow(e.firstChild,i.paragraph.associatedCell))if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(var l=0;l<e.childWidgets.length;l++){if(this.trackRowDeletion(e.childWidgets[l])&&l--,(0,a.isNullOrUndefined)(e.childWidgets))break}(0,a.isNullOrUndefined)(e.childWidgets)||(0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,r);else if(this.owner.enableTrackChanges){if((0,a.isNullOrUndefined)(n.paragraph.associatedCell)&&!n.paragraph.isInsideTable){var d=e.lastChild.lastChild;this.deleteCellsInTable(e,t,i,n,r,d)}}else{var h=this.splitTable(e,i.paragraph.associatedCell.ownerRow);this.deleteContent(e,t,r),this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.containerWidget,h,!1)}(0,a.isNullOrUndefined)(s)||(t.editPosition=this.selection.getHierarchicalIndex(s,"0"),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition))}else{var c=e.previousRenderedWidget;if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(l=0;l<e.childWidgets.length;l++){if(this.trackRowDeletion(e.childWidgets[l])&&l--,(0,a.isNullOrUndefined)(e.childWidgets))break}(0,a.isNullOrUndefined)(e.childWidgets)||(0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,r);(0,a.isNullOrUndefined)(c)||this.deleteBlock(c,t,i,n,r)}},e.prototype.splitTable=function(e,t){var i=new Al;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r===t)break;i.childWidgets.push(r),r.containerWidget=i,e.childWidgets.splice(n,1),n--}var o=e.getIndex();return e.containerWidget.childWidgets.splice(o,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},e.prototype.updateEditPosition=function(e,t){var i=this.documentHelper.getFirstParagraphInCell(e);t.editPosition=this.selection.getHierarchicalIndex(i,"0")},e.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},e.prototype.setActionInternal=function(e,t){this.documentHelper.owner.enableHistoryMode&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},e.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},e.prototype.isEndInAdjacentTable=function(e,t){var i=this.selection.getHierarchicalIndex(e,""),n=this.selection.getHierarchicalIndex(t,""),r=i.split(";"),o=n.split(";");return r.length<o.length},e.prototype.cloneTableToHistoryInfo=function(e,t){if(this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){var i=e.clone();return i.index=e.index,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i),(this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===e||t)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),i}},e.prototype.insertParagraphPaste=function(e,t,i,n,r,o,s,l){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var d=this.selection.getNextParagraphBlock(t);if(d&&i.offset>0&&d===n.paragraph&&e===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var h=0;this.removeBlock(t),this.documentHelper.layout.clearListElementBox(d),this.documentHelper.layout.clearListElementBox(t);for(var c=0;c<t.childWidgets.length;c++){var p=t.childWidgets[c];d.childWidgets.splice(h,0,p),t.childWidgets.splice(c,1),c--,h++,p.paragraph=d}this.documentHelper.layout.reLayoutParagraph(d,0,0),r=!1;var u=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(d,u)}}r&&this.deleteParagraphMark(t,this.selection,o,!1,s,l)},e.prototype.removeInlines=function(e,t,i,n,r,o){var s=!1;this.documentHelper.layout.clearListElementBox(e);e.childWidgets.indexOf(t);var l=this.selection.start.clone(),d=this.selection.end.clone(),h=this.selection.getElementInfo(l.currentWidget,0!==l.offset&&this.selection.isForward?l.offset+1:l.offset),c=this.selection.getElementInfo(d.currentWidget,0===d.offset||this.selection.isForward?d.offset:d.offset+1);if(h.element instanceof _l&&2!==h.element.fieldType&&!(c.element instanceof _l)||c.element instanceof _l&&2!==c.element.fieldType&&!(h.element instanceof _l))if(this.selection.isForward){if(h.element instanceof _l&&0===h.element.fieldType&&!(0,a.isNullOrUndefined)(h.element.fieldEnd)){var p=h.element.fieldEnd.line.getOffset(h.element.fieldEnd,1);(m=new ac(this.owner)).setPositionParagraph(h.element.fieldEnd.line,p),d.isExistBefore(m)&&h.element.fieldSeparator&&(this.selection.start.setPositionParagraph(h.element.fieldSeparator.line,h.element.fieldSeparator.line.getOffset(h.element.fieldSeparator,1)),i=this.selection.start.offset,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.startOffset,this.selection.editPosition=this.owner.selection.startOffset))}else if(c.element instanceof _l&&1===c.element.fieldType&&!(0,a.isNullOrUndefined)(c.element.fieldBegin)){var u=c.element.fieldBegin.line.getOffset(c.element.fieldBegin,0);(g=new ac(this.owner)).setPositionParagraph(c.element.fieldBegin.line,u),l.isExistAfter(g)&&(this.selection.end.setPositionParagraph(c.element.line,c.element.line.getOffset(c.element,0)),r=this.selection.end.offset,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset))}}else if(h.element instanceof _l&&1===h.element.fieldType&&!(0,a.isNullOrUndefined)(h.element.fieldBegin)){var g;u=h.element.fieldBegin.line.getOffset(h.element.fieldBegin,0);(g=new ac(this.owner)).setPositionParagraph(h.element.fieldBegin.line,u),d.isExistAfter(g)&&(this.selection.start.setPositionParagraph(h.element.line,h.element.line.getOffset(h.element,0)),r=this.selection.start.offset,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.endOffset,this.selection.editPosition=this.owner.selection.endOffset))}else if(c.element instanceof _l&&0===c.element.fieldType&&c.element.fieldSeparator&&!(0,a.isNullOrUndefined)(c.element.fieldEnd)){var m;p=c.element.fieldEnd.line.getOffset(c.element.fieldEnd,1);(m=new ac(this.owner)).setPositionParagraph(c.element.fieldEnd.line,p),l.isExistBefore(m)&&(this.selection.end.setPositionParagraph(c.element.fieldSeparator.line,c.element.fieldSeparator.line.getOffset(c.element.fieldSeparator,1)),i=this.selection.end.offset,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.endOffset,this.selection.editPosition=this.owner.selection.endOffset))}var f=this.selection.getElementInfo(l.currentWidget,this.selection.isForward?l.offset:l.offset+1),v=this.selection.getElementInfo(d.currentWidget,this.selection.isForward?d.offset+1:d.offset),y=!(0,a.isNullOrUndefined)(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing);this.selection.isExcludeBookmarkStartEnd||y||this.isInsertingText||this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action||(0,a.isNullOrUndefined)(f)||(0,a.isNullOrUndefined)(v)||!f.element||!v.element||!(f.element instanceof td)||!(v.element instanceof td)||f.element.name!==v.element.name||!(0,a.isNullOrUndefined)(f.element.nextElement)&&!(0,a.isNullOrUndefined)(v.element.previousElement)&&f.element.nextElement instanceof td&&v.element.previousElement instanceof td&&f.element.nextElement.name===v.element.previousElement.name||!(0,a.isNullOrUndefined)(f.element.nextElement)&&!(0,a.isNullOrUndefined)(v.element.previousElement)&&f.element.nextElement instanceof _l&&v.element.previousElement instanceof _l||(this.selection.isForward?(this.selection.start.setPositionParagraph(f.element.line,f.element.line.getOffset(f.element,0)),this.selection.end.setPositionParagraph(v.element.line,v.element.line.getOffset(v.element,1)),i=this.selection.start.offset,r=this.selection.end.offset,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.startOffset,this.selection.editPosition=this.owner.selection.startOffset)):(this.selection.start.setPositionParagraph(f.element.line,f.element.line.getOffset(f.element,1)),this.selection.end.setPositionParagraph(v.element.line,v.element.line.getOffset(v.element,0)),i=this.selection.end.offset,r=this.selection.start.offset,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selection.startOffset,this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selection.endOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selection.endOffset,this.selection.editPosition=this.owner.selection.endOffset)));for(var w=this.selection.editPosition,b=this.selection.getParagraphInfo(this.selection.start),C=this.selection.getParagraphInfo(this.selection.end),x=this.selection.getHierarchicalIndex(b.paragraph,b.offset.toString()),I=this.selection.getHierarchicalIndex(C.paragraph,C.offset.toString()),k=e.childWidgets.length-1;k>=0;k--){var F=e.childWidgets[k];if(t===F&&n===F){this.removeContent(F,i,r,o),s=!0;break}if(n===F)e.isLayouted=!1,s=!0,this.removeContent(F,0,r,o);else{if(t===F){this.removeContent(F,i,this.documentHelper.selection.getLineLength(F),o);break}s&&this.removeContent(F,0,this.documentHelper.selection.getLineLength(F),o)}}if(this.owner.enableTrackChanges&&!this.skipTracking()&&(this.selection.start.setPositionInternal(l),this.selection.end.setPositionInternal(d),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=w),s){if(e.isLayouted=!0,this.removeEmptyLine(e),this.documentHelper.layout.reLayoutParagraph(e,0,0),-1===this.selection.start.currentWidget.indexInOwner&&this.owner.enableTrackChanges&&!this.skipTracking()){var P=this.selection.getTextPosBasedOnLogicalIndex(x);this.selection.start.setPositionInternal(P)}if(-1===this.selection.end.currentWidget.indexInOwner&&this.owner.enableTrackChanges&&!this.skipTracking()){var S=this.selection.getTextPosBasedOnLogicalIndex(I);this.selection.end.setPositionInternal(S)}}},e.prototype.skipTracking=function(){return!((0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!((0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.canHandleDeletion=function(){return!((0,a.isNullOrUndefined)(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.deleteCommentInSelection=function(e){var t=this.editorHistory.currentBaseHistoryInfo;!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.currentHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.initComplexHistory("DeleteCommentInline"),this.deleteCommentInternal(e),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing||this.editorHistory.currentHistoryInfo.addModifiedAction(t),this.selection.editPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=this.selection.editPosition,this.editorHistory.currentBaseHistoryInfo=t)},e.prototype.removeContent=function(e,t,i,n,r){for(var o=this.selection.getLineLength(e),s=void 0,l=0,d=void 0,h=e.children.length-1;h>=0;h--){var c=e.children[h];if(this.owner.enableTrackChanges&&c instanceof Zl&&""===c.text)e.children.splice(h,1);else{if(c.isWidthUpdated=!1,(0,a.isNullOrUndefined)(n)||2!==n&&1!==n)for(var p=0;p<e.children.length;p++){var u=e.children[p];if(u instanceof Zl){var g=u.text;g.length+l>t&&!(l>t)&&(s=g[t-l-1],(0,a.isNullOrUndefined)(s)&&t-l==0&&(s=d)),g.length+l>i&&(" "===g[i-l]&&0===t||" "===s&&" "===g[i-l])&&(i+=1),d=g[g.length-1]}l+=u.length}if(i<=o-c.length)o-=c.length;else{var m=c.length;o>i&&o-m<i&&(m=i-(o-c.length));var f=0;if(o-c.length<t&&(f=t-(o-c.length)),o>i&&(o-=c.length-m),0===f&&m===c.length){if((!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||c instanceof td&&this.removedBookmarkElements.push(c),c instanceof td&&this.documentHelper.bookmarks.containsKey(c.name)&&(this.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:c.name}),this.documentHelper.bookmarks.remove(c.name))),(c instanceof gd&&"Inline"!==c.textWrappingStyle||c instanceof hd)&&this.removeAutoShape(c),this.skipFieldDeleteTracking&&c.revisions.length>0){var v=c;v instanceof _l&&(1!==v.fieldType&&2!==v.fieldType||(v=v.fieldBegin),this.clearFieldElementRevisions(v,c.revisions))}if(this.canHandleDeletion()||this.owner.enableTrackChanges&&!this.skipTracking()&&!this.skipFieldDeleteTracking)this.skipTableElements||this.skipFootNoteDeleteTracking||r||(c instanceof Bd?this.addRemovedNodes(c):this.addRemovedNodes(c.clone())),this.handleDeleteTracking(c,t,i,h,r);else{c instanceof Yl&&(c.isLayout=!1),this.unLinkFieldCharacter(c),this.unlinkRangeFromRevision(c,!0),this.addRemovedRevisionInfo(c,void 0),r||this.addRemovedNodes(c),c instanceof vd?(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||this.removedEditRangeStartElements.push(c),-1!=c.columnFirst&&-1!=c.columnLast&&this.removeEditRangeFromCollection(c)):c instanceof fd?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||this.removedEditRangeEndElements.push(c):c instanceof id&&!this.isInsertingTOC&&this.removedContentControlElements.push(c);var y=c.previousNode;e.children.splice(h,1),(0,a.isNullOrUndefined)(y)||this.combineElementRevisionToPrevNxt(y),!(0,a.isNullOrUndefined)(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(h,1)}}else if(c instanceof Zl){var w=this.handleDeleteTracking(c,f,m);(0,a.isNullOrUndefined)(w)||this.skipTableElements||(c.revisions.length>0&&this.addRemovedRevisionInfo(c,w),this.addRemovedNodes(w))}if((!this.owner.enableTrackChanges||this.editorHistory.isUndoing)&&c instanceof Yl&&("Footnote"===c.footnoteType?this.removeFootnote(c):this.removeEndnote(c)),t>=o-(m-f))break;o-=m-f,this.documentHelper.layout.clearListElementBox(e.paragraph)}}}},e.prototype.deleteCommentWidgetInline=function(e){},e.prototype.clearFieldElementRevisions=function(e,t){for(var i=t,n=0;n<i.length;n++)for(var r=i[n],o=0;o<r.range.length;o++)if(r.range[o]===e)for(var s=o;s<r.range.length;s){if(r.range[o]instanceof _l&&1===r.range[o].fieldType&&r.range[o].fieldBegin===e){r.removeRangeRevisionForItem(r.range[o]),0===r.range.length&&this.owner.revisions.remove(r);break}r.removeRangeRevisionForItem(r.range[o])}},e.prototype.addRemovedRevisionInfo=function(e,t,i){for(var n=0;n<e.revisions.length;n++){var r=e.revisions[n].revisionID;(0,a.isNullOrUndefined)(t)?e.removedIds.push(r):t.removedIds.push(r)}(0,a.isNullOrUndefined)(t)&&((0,a.isNullOrUndefined)(i)||i)&&(e.revisions=[])},e.prototype.removeEmptyLine=function(e){if(e.childWidgets.length>1)for(var t=0;t<e.childWidgets.length;t++){0===e.childWidgets[t].children.length&&e.childWidgets.length>1&&(e.childWidgets.splice(t,1),t--)}},e.prototype.cloneListLevel=function(e){var t=new Va(void 0);return this.copyListLevel(t,e),t},e.prototype.copyListLevel=function(e,t){(0,a.isNullOrUndefined)(t.paragraphFormat)||(e.paragraphFormat=new ba(e),e.paragraphFormat.copyFormat(t.paragraphFormat)),(0,a.isNullOrUndefined)(t.characterFormat)||(e.characterFormat=new ka(e),e.characterFormat.copyFormat(t.characterFormat)),(0,a.isNullOrUndefined)(t.followCharacter)||(e.followCharacter=t.followCharacter),(0,a.isNullOrUndefined)(t.listLevelPattern)||(e.listLevelPattern=t.listLevelPattern),(0,a.isNullOrUndefined)(t.numberFormat)||(e.numberFormat=t.numberFormat),(0,a.isNullOrUndefined)(t.restartLevel)||(e.restartLevel=t.restartLevel),(0,a.isNullOrUndefined)(t.startAt)||(e.startAt=t.startAt)},e.prototype.cloneLevelOverride=function(e){var t=new Ua;return(0,a.isNullOrUndefined)(e.startAt)||(t.startAt=e.startAt),(0,a.isNullOrUndefined)(e.overrideListLevel)||(t.overrideListLevel=e.overrideListLevel),(0,a.isNullOrUndefined)(e.levelNumber)||(t.levelNumber=e.levelNumber),t},e.prototype.updateListParagraphs=function(){this.documentHelper.listParagraphs=[];for(var e=0;e<this.documentHelper.pages.length;e++)for(var t=this.documentHelper.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},e.prototype.updateListParagraphsInBlock=function(e){if(e instanceof Rl)(0,a.isNullOrUndefined)(e.paragraphFormat)||(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat)||(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat.listId)||(e.paragraphFormat.listFormat.listId>=0&&e.paragraphFormat.clearIndent(),(0,a.isNullOrUndefined)(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(e));else if(e instanceof Al)for(var t=0;t<e.childWidgets.length;t++)for(var i=0;i<e.childWidgets[t].childWidgets.length;i++)for(var n=e.childWidgets[t].childWidgets[i],r=0;r<n.childWidgets.length;r++)this.updateListParagraphsInBlock(n.childWidgets[r])},e.prototype.onApplyList=function(e){var t=this.documentHelper.selection;this.setOffsetValue(this.documentHelper.selection),this.initHistory("ListFormat");var i=new ya;(0,a.isNullOrUndefined)(e)||(i.listId=e.listId,i.nsid=e.nsid),this.documentHelper.owner.isShiftingEnabled=!0,t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",i,!1),this.isMeasureParaWidth=!0,this.layoutItemBlock(t.start.paragraph,!1),this.isMeasureParaWidth=!1):this.updateSelectionParagraphFormatting("listFormat",i,!1),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1,this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.applyBulletOrNumbering=function(e,t,i){var n=this.documentHelper.selection,r=n.paragraphFormat.getList(),o=!1,s=n.start;n.isForward||(s=n.end);var l=s.paragraph;if((0,a.isNullOrUndefined)(r)){for(;!(0,a.isNullOrUndefined)(l.previousWidget)&&l.previousWidget instanceof Rl&&l.previousWidget.isEmpty()&&-1===l.previousWidget.paragraphFormat.listFormat.listId;)l=l.previousWidget;if(l.previousWidget&&l.previousWidget instanceof Rl&&-1!==l.previousWidget.paragraphFormat.listFormat.listId){for(var d=!1;!(0,a.isNullOrUndefined)(l.previousWidget)&&l.previousWidget instanceof Rl&&-1!==l.previousWidget.paragraphFormat.listFormat.listId&&s.paragraph.paragraphFormat.firstLineIndent<Math.abs(l.previousWidget.paragraphFormat.firstLineIndent);)l=l.previousWidget,d=!0;d||(l=l.previousWidget),r=this.documentHelper.getListById(l.paragraphFormat.listFormat.listId),o=!0}if(!o){for(;!(0,a.isNullOrUndefined)(l.nextWidget)&&l.nextWidget instanceof Rl&&l.nextWidget.isEmpty()&&-1===l.nextWidget.paragraphFormat.listFormat.listId;)l=l.nextWidget;l.nextWidget&&l.nextWidget instanceof Rl&&-1!==l.nextWidget.paragraphFormat.listFormat.listId&&(l=l.nextWidget,r=this.documentHelper.getListById(l.paragraphFormat.listFormat.listId),o=!0)}}var h=void 0,c=-1,p=void 0,u=!1;if(-1===l.paragraphFormat.listFormat.listId||(0,a.isNullOrUndefined)(l.paragraphFormat.listFormat.listLevel)||(this.listNumberFormat=l.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=l.paragraphFormat.listFormat.listLevel.listLevelPattern,(0,a.isNullOrUndefined)(l.previousWidget)&&l.paragraphFormat.listFormat.listLevelNumber>0?this.listLevelNumber=this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listLevelNumber:this.listLevelNumber=l.paragraphFormat.listFormat.listLevelNumber),!(0,a.isNullOrUndefined)(r)){c=(0,a.isNullOrUndefined)(l.previousWidget)&&l.paragraphFormat.listFormat.listLevelNumber>0?this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listLevelNumber:l.paragraphFormat.listFormat.listLevelNumber;var g=this.documentHelper.getListById(l.paragraphFormat.listFormat.listId);if(h=this.documentHelper.layout.getListLevel(g,c),c>0&&(p=this.documentHelper.layout.getListLevel(g,0),u=!(0,a.isNullOrUndefined)(p)&&c>0&&n.start.isInSameListParagraph(n.end)),(m=g.abstractList)||(m=this.documentHelper.getAbstractListById(r.abstractListId)),0===m.levels.length&&(h=this.documentHelper.layout.getListLevel(g,l.paragraphFormat.listFormat.listLevelNumber)),o){if("Bullet"!==t&&h.listLevelPattern===t&&(h.numberFormat===e||-1!==h.numberFormat.indexOf(e)))return n.paragraphFormat.listId=r.listId,n.paragraphFormat.listLevelNumber=c,void n.paragraphFormat.setList(r);h=m.levels[0]}}if((0,a.isNullOrUndefined)(r)||!(0,a.isNullOrUndefined)(r)&&0===c&&(h.listLevelPattern!==t||h.numberFormat!==e||h.characterFormat.fontFamily!==i&&"Bullet"===h.listLevelPattern)){o=!1,r=new zh,this.documentHelper.lists.length>0?r.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:r.listId=0;var m=new Aa;if(this.documentHelper.abstractLists.length>0?m.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:m.abstractListId=0,r.nsid=m.nsid,r.abstractListId=m.abstractListId,r.abstractList=m,this.documentHelper.abstractLists.push(m),"bullet"===e||"multiLevel"===e||"numbering"===e)this.addListLevels(m,e,n);else(f=new Va(m)).listLevelPattern=t,f.numberFormat=e,"Bullet"!==t?f.startAt=1:f.characterFormat.fontFamily=i,f.paragraphFormat.leftIndent=36,f.paragraphFormat.firstLineIndent=-18,m.levels.push(f),n.paragraphFormat.listLevelNumber=0;n.paragraphFormat.setList(r)}else if(!u||(0,a.isNullOrUndefined)(r)||o)!(0,a.isNullOrUndefined)(r)&&o?n.paragraphFormat.setList(r):n.paragraphFormat.setList(void 0);else{g=this.documentHelper.getListById(l.paragraphFormat.listFormat.listId);var f=this.documentHelper.layout.getListLevel(g,c);if("Bullet"===t)f.numberFormat=e,f.characterFormat.fontFamily=i,f.listLevelPattern=t;else{f.listLevelPattern=t,f.characterFormat.fontFamily=i,f.startAt=1;var v=f.numberFormat.substring(f.numberFormat.length-1);f.numberFormat.length!==e.length&&c>0?f.numberFormat=e:e.substring(e.length-1)!==f.numberFormat.substring(f.numberFormat.length-1)&&(f.numberFormat=f.numberFormat.replace(v,e.substring(e.length-1)))}n.paragraphFormat.setList(g)}},e.prototype.addListLevels=function(e,t,i){for(var n=[String.fromCharCode(61558),String.fromCharCode(61656),String.fromCharCode(61607),String.fromCharCode(61623),String.fromCharCode(61608)],r=e.levels.length;r<9;r++){var o=new Va(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=n[r<5?r%5:r%5+1],o.characterFormat.fontFamily=r<3||5===r?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var s=0;s<r+1;s++)o.numberFormat+="%"+(s+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(r+1).toString()+")",o.listLevelPattern=r%3==0?"Number":r%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=r}o.paragraphFormat.leftIndent=0===r?36:36*r,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=r}},e.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak"),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.onEnter("PageBreak"),this.isSkipOperationsBuild=!1,this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility()}},e.prototype.insertColumnBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("ColumnBreak");var e=this.documentHelper.selection.start.paragraph;if(this.viewer instanceof kl&&e.bodyWidget.sectionFormat.columns.length>1){var t=this.documentHelper.layout.getBodyWidget(e.bodyWidget,!1);(0,a.isNullOrUndefined)(t.nextRenderedWidget)||t.page!==t.nextRenderedWidget.page||this.documentHelper.layout.combineMultiColumn(t)}this.onEnter("ColumnBreak"),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility()}},e.prototype.onEnter=function(e){this.handledEnter=!0;var t,i=this.documentHelper.selection,n=!1;((0,a.isNullOrUndefined)(i.start.paragraph.paragraphFormat.baseStyle)||"Normal"===i.start.paragraph.paragraphFormat.baseStyle.name||"Normal (Web)"===i.start.paragraph.paragraphFormat.baseStyle.name)&&((t=new Ac(void 0)).cloneFormat(this.selection.characterFormat),i.start.paragraph.lastChild.children[i.start.paragraph.lastChild.children.length-1]instanceof Yl&&(t.baselineAlignment="Normal"));if(i.isEmpty&&i.start.paragraph.isInsideTable&&(i.start.paragraph.associatedCell.ownerTable.isInsideTable||1===i.startPage)&&0===i.start.paragraph.associatedCell.ownerTable.index&&0===i.start.paragraph.associatedCell.columnIndex&&0===i.start.paragraph.associatedCell.rowIndex&&0===i.start.paragraph.index&&0===i.start.offset&&(n=!0),!this.isXmlMapped){if(i.isEmpty){var r=i.getHyperlinkField();if(!(0,a.isNullOrUndefined)(r))return void i.fireRequestNavigate(r);if((b=i.start.paragraph).isEmpty()&&-1!==b.paragraphFormat.listFormat.listId&&!n)return void this.onApplyListInternal(this.documentHelper.getListById(b.paragraphFormat.listFormat.listId),b.paragraphFormat.listFormat.listLevelNumber-1)}var o=this.checkAndRemoveComments();this.initHistory("Enter");var s=!0;if(i.isEmpty||i.isImageSelected||(s=this.removeSelectedContents(i)),s){if(i.isImageSelected&&!i.isForward){var l=i.start;i.start=i.end,i.end=l}i.owner.isShiftingEnabled=!0,this.updateInsertPosition();var d=this.selection.getParagraphInfo(i.start),h=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString()),c=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!0);if(this.splitParagraphInternal(i,i.start.paragraph,i.start.currentWidget,i.start.offset,c,n),this.setPositionForCurrentIndex(i.start,h),!(0,a.isNullOrUndefined)(e)&&("PageBreak"===e||"ColumnBreak"===e)){var p=i.start.paragraph,u=new Rl;u.characterFormat.copyFormat(p.characterFormat),u.paragraphFormat.copyFormat(p.paragraphFormat);var g=new Zl;switch(e){case"PageBreak":g.text="\f";break;case"ColumnBreak":g.text=String.fromCharCode(14)}var m=new zl(u);if(m.children.push(g),g.line=m,u.childWidgets.push(m),this.owner.enableTrackChanges&&p.characterFormat.revisions.length>0){var f=this.retrieveRevisionInOder(p.characterFormat);f.range.push(u.characterFormat),u.characterFormat.revisions.push(f),this.owner.trackChangesPane.updateCurrentTrackChanges(f),u.characterFormat.removedIds=[]}this.insertParagraph(u,!0),i.selectParagraphInternal(u,!0)}var v=i.start.paragraph.nextWidget;(0,a.isNullOrUndefined)(v)&&(v=i.getNextRenderedBlock(i.start.paragraph)),i.selectParagraphInternal(n?i.start.paragraph:v,!0),n||this.updateEndPosition(),!(0,a.isNullOrUndefined)(e)&&this.editorHistory&&this.owner.editorHistoryModule.updateHistory(),this.reLayout(i);var y=this.selection.start.paragraph.containerWidget.firstChild;if(!(0,a.isNullOrUndefined)(y)){y.isChangeDetected=!1;for(var w=y.nextRenderedWidget;this.owner.isSpellCheck&&!(0,a.isNullOrUndefined)(w);)(y=w).isChangeDetected=!1,w=y.nextRenderedWidget}var b=i.start.paragraph.previousWidget;!(0,a.isNullOrUndefined)(b)&&!b.isEmpty()&&b.lastChild.children[b.lastChild.children.length-1]instanceof Zl&&this.checkAndConvertToHyperlink(i,!0,b)}(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(i.start.paragraph)||!i.start.paragraph.isEmpty()||n||(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(t),this.selection.isRetrieveFormatting=!1),this.documentHelper.layout.islayoutFootnote=!1,this.updateHistoryForComments(o),this.handledEnter=!1}},e.prototype.combineRevisionWithValidElement=function(e){var t;if(e.isEmpty()){var i=e.previousRenderedWidget;!(0,a.isNullOrUndefined)(i)&&i instanceof Rl&&(t=i.characterFormat)}else{var n=e.lastChild;if(n.children.length>0){for(var r=n.children[n.children.length-1];r instanceof td||r instanceof Bd||r instanceof md;)r=r.previousElement;t=r}}if(!(0,a.isNullOrUndefined)(t)&&t.revisions.length>0&&this.compareElementRevision(t,e.characterFormat)){var o=e.characterFormat.revisions[e.characterFormat.revisions.length-1];if(this.compareElementRevision(t,e.characterFormat))o!==(l=t.revisions[t.revisions.length-1])&&(this.clearAndUpdateRevisons(o.range,l,l.range.indexOf(t)+1),this.owner.revisions.remove(o))}var s=this.getPreviousValidElement(e);if(!(0,a.isNullOrUndefined)(s)&&s.revisions.length>0){var l,d=s.revisions[s.revisions.length-1];if(this.compareElementRevision(e.characterFormat,s))if(this.compareElementRevision(e.characterFormat,s))d!==(l=e.characterFormat.revisions[e.characterFormat.revisions.length-1])&&(this.clearAndUpdateRevisons(l.range,d,0,!0),this.owner.revisions.remove(l))}},e.prototype.getPreviousValidElement=function(e){var t=e.nextRenderedWidget;if(t instanceof Rl)if(t.isEmpty()){if(!(0,a.isNullOrUndefined)(t)&&t instanceof Rl)return t.characterFormat}else{var i=t.firstChild;if(i.children.length>0){for(var n=i.children[0];n instanceof td||n instanceof Bd||n instanceof md;)n=n.nextElement;return n}}},e.prototype.splitParagraphInternal=function(e,t,i,n,r,o){var s=0,l=t.index,d=t,h=!1;for(d.isChangeDetected=0===n;this.owner.isSpellCheck&&!(0,a.isNullOrUndefined)(d.nextRenderedWidget);)(d=d.nextRenderedWidget).isChangeDetected=!0;var c,p=new Rl,u=new zl(p);if(p.childWidgets.push(u),p.paragraphFormat.ownerBase=p,i!==t.lastChild||n!==e.getLineLength(i)||t.isContainsShapeAlone()){if(p.paragraphFormat.copyFormat(t.paragraphFormat),p.characterFormat.copyFormat(r),!(n>0)&&i.isFirstLine()||t.isContainsShapeAlone()){var g=t.previousRenderedWidget,m=!1;if(!(0,a.isNullOrUndefined)(g)&&g instanceof Rl&&(m=g.characterFormat.revisions.length>0),this.owner.enableTrackChanges)if(m)this.checkToMatchEmptyParaMark(t,p)||this.insertParaRevision(t);else{y=t.firstChild.children[0].previousValidNodeForTracking;(0,a.isNullOrUndefined)(y)||this.checkParaMarkMatchedWithElement(y,p.characterFormat,!0,"Insertion")?(0,a.isNullOrUndefined)(y)&&(s++,l++):this.insertParaRevision(p)}}else t=t.combineWidget(this.owner.viewer),this.moveInlines(t,p,0,0,t.firstChild,n,i),this.owner.enableTrackChanges&&this.insertParaRevision(p,t.firstChild);t=t.getSplitWidgets()[0]}else{if(o||(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof Wa?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(p.paragraphFormat.copyFormat(t.paragraphFormat),p.characterFormat.copyFormat(t.characterFormat)):p.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(p.paragraphFormat.copyFormat(t.paragraphFormat),p.characterFormat.copyFormat(t.characterFormat)),t.lastChild.children.length>0&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat)),this.handledEnter&&this.selection.isEmpty&&this.selection.start.isAtParagraphEnd&&t.characterFormat.revisions.length>0&&(h=!0,p.characterFormat.removedIds=[]),this.owner.enableTrackChanges){var f=t.lastChild;if(!(0,a.isNullOrUndefined)(f)&&f.children.length>0){var v=f.children[f.children.length-1].previousValidNodeForTracking,y=this.getPreviousValidElement(t);if(t.characterFormat.revisions.length>0&&y&&y.revisions.length>0)if(h){var w=this.compareElementRevision(t.characterFormat,y),b=this.isRevisionMatched(t.characterFormat,"Insertion")&&this.isRevisionMatched(y,"Insertion");!(0,a.isNullOrUndefined)(v)&&b&&this.checkParaMarkMatchedWithElement(v,t.characterFormat,!1,"Insertion"),y&&y.revisions.length>0&&!b&&w&&(this.insertRevision(p.characterFormat,"Insertion"),this.updateRevisionForSpittedTextElement(t.characterFormat,y),p.characterFormat&&(h=!1))}else this.insertParaRevision(t);else(0,a.isNullOrUndefined)(v)||this.checkParaMarkMatchedWithElement(v,t.characterFormat,!1,"Insertion")||(h?this.checkToCombineRevisionWithPrevPara(t,"Insertion",p)||this.insertParaRevision(p):this.insertParaRevision(t))}}s++,l++}o?(s=0,l=0,(c=t.associatedCell.ownerTable.containerWidget).childWidgets.splice(0,0,p),p.containerWidget=c,p.index=0,this.updateNextBlocksIndex(p,!0),this.owner.selectionModule.start.setPositionParagraph(p.firstChild,0),this.owner.selectionModule.end.setPositionParagraph(p.firstChild,1),(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.selectionStart=this.owner.selectionModule.startOffset,this.editorHistory.currentBaseHistoryInfo.selectionEnd=this.owner.selectionModule.startOffset,this.editorHistory.currentBaseHistoryInfo.insertPosition=this.owner.selectionModule.startOffset,this.editorHistory.currentBaseHistoryInfo.endPosition=this.owner.selectionModule.endOffset)):(s+=t.getIndex(),(c=t.containerWidget).childWidgets.splice(s,0,p),p.containerWidget=c,p.index=l,this.updateNextBlocksIndex(p,!0));if(!(0,a.isNullOrUndefined)(c.containerWidget)&&c.containerWidget instanceof Dl||c instanceof Vl&&!(0,a.isNullOrUndefined)(c.bodyWidget)&&c.bodyWidget.containerWidget instanceof Dl){var C=this.documentHelper.textHelper.getParagraphMarkSize(p.characterFormat).Height;c instanceof Vl?(c.bodyWidget.height+=C,c.bodyWidget.containerWidget.height+=C):(c.containerWidget.height+=C,c.height+=C)}if(this.owner.enableTrackChanges&&0===p.characterFormat.revisions.length){var x=void 0;0!==t.characterFormat.revisions.length||o?(h||o)&&(x=p):x=t,(0,a.isNullOrUndefined)(x)||this.checkToMatchEmptyParaMark(x)||this.insertParaRevision(x)}this.documentHelper.layout.layoutBodyWidgetCollection(l,c,p,!1)},e.prototype.insertParaRevision=function(e,t){if(this.owner.enableTrackChanges&&(0,a.isNullOrUndefined)(t)&&!this.isRevisionMatched(e.characterFormat,"Insertion")&&(e.characterFormat.revisions=[],this.insertRevision(e.characterFormat,"Insertion")),!(0,a.isNullOrUndefined)(t)){if(t.paragraph.isInsideTable)return void this.insertRevision(e.characterFormat,"Insertion");this.applyRevisionForParaMark(e,t,"Insertion",!0)}},e.prototype.applyRevisionForParaMark=function(e,t,i,n){var r=t?t.children[0]:void 0;(0,a.isNullOrUndefined)(r)||(r=r.nextValidNodeForTracking);var o=e.lastChild,s=0===o.children.length?void 0:o.children[o.children.length-1].previousValidNodeForTracking,l=!1,d=e.characterFormat.revisions.length;if((0,a.isNullOrUndefined)(s)||(l=this.checkParaMarkMatchedWithElement(s,e.characterFormat,!1,i)),!(0,a.isNullOrUndefined)(r))if(e.characterFormat.revisions.length>d){if(this.isRevisionMatched(r,i))for(var h=e.characterFormat.revisions[0],c=this.getMatchedRevisionsToCombine(r.revisions,i),p=0;p<c.length;p++)c[p]!==h&&(l=!0,this.clearAndUpdateRevisons(c[p].range,h,h.range.indexOf(e.characterFormat)+1))}else l=this.checkParaMarkMatchedWithElement(r,e.characterFormat,!0,i);!l&&(this.owner.enableTrackChanges||!(0,a.isNullOrUndefined)(t)&&t.paragraph.characterFormat.revisions.length>0)&&(this.insertRevision(e.characterFormat,i),n&&s.revisions.length>0&&!(0,a.isNullOrUndefined)(r)&&r.revisions.length>0&&this.updateRevisionForSpittedTextElement(s,r))},e.prototype.checkParaMarkMatchedWithElement=function(e,t,i,n){var r=this.getMatchedRevisionsToCombine(e.revisions,n);return r.length>0&&(this.mapMatchedRevisions(r,e,t,i),!0)},e.prototype.checkToMatchEmptyParaMark=function(e,t){var i=e.previousRenderedWidget;if(!(0,a.isNullOrUndefined)(i)&&i instanceof Rl&&i.characterFormat.revisions.length>0){var n=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,"Insertion");if(n.length>0)return(0,a.isNullOrUndefined)(t)?this.mapMatchedRevisions(n,i.characterFormat,e.characterFormat,!1):this.mapMatchedRevisions(n,i.characterFormat,t.characterFormat,!1),!0}return!1},e.prototype.checkToMatchEmptyParaMarkBack=function(e){var t=e.nextRenderedWidget,i=t.childWidgets[0],n=i.children[0];if(!(0,a.isNullOrUndefined)(t)&&t instanceof Rl&&t.characterFormat.revisions.length>0){if((r=this.getMatchedRevisionsToCombine(t.characterFormat.revisions,"Deletion")).length>0)return null!=t&&null!=i&&null!=n&&1==n.revisions.length?(this.mapMatchedRevisions(r,n,e.characterFormat,!0),!0):(this.mapMatchedRevisions(r,t.characterFormat,e.characterFormat,!0),!0)}else if(null!=n&&1==n.revisions.length){var r;if((r=this.getMatchedRevisionsToCombine(n.revisions,"Deletion")).length>0)return this.mapMatchedRevisions(r,n,e.characterFormat,!0),!0}return!1},e.prototype.updateNextBlocksIndex=function(e,t){var i=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof Ol&&!(e.containerWidget.containerWidget instanceof Dl))if(e.containerWidget.page.bodyWidgets.length>1&&e.containerWidget.sectionFormat.numberOfColumns>1)for(var n=e.containerWidget.indexInOwner,r=this.documentHelper.pages.indexOf(e.containerWidget.page);r<this.documentHelper.pages.length;r++){for(var o=this.documentHelper.pages[r],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].indexInOwner===n){for(var l=i;l<o.bodyWidgets[s].childWidgets.length;l++){var d=o.bodyWidgets[s].childWidgets[l];this.updateIndex(d,t)}i=0,(0,a.isNullOrUndefined)(o.bodyWidgets[s].nextRenderedWidget)||o.bodyWidgets[s].nextRenderedWidget.sectionIndex!==o.bodyWidgets[s].sectionIndex||n++}n!==e.containerWidget.indexInOwner&&!(0,a.isNullOrUndefined)(o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget)&&o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget.sectionFormat.columns.length>1&&(n=0)}else if(e.containerWidget.page.bodyWidgets.length>1){var h=e.containerWidget.index;for(r=this.documentHelper.pages.indexOf(e.containerWidget.page);r<this.documentHelper.pages.length;r++)for(o=this.documentHelper.pages[r],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].index===h){for(l=i;l<o.bodyWidgets[s].childWidgets.length;l++){d=o.bodyWidgets[s].childWidgets[l];this.updateIndex(d,t)}i=0}}else for(h=e.containerWidget.index,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){if((o=this.documentHelper.pages[s]).bodyWidgets[0].index!==h)return;for(l=i;l<o.bodyWidgets[0].childWidgets.length;l++){d=o.bodyWidgets[0].childWidgets[l];this.updateIndex(d,t)}i=0}else if(e.containerWidget instanceof Vl)for(var c=e.containerWidget.getSplitWidgets(),p=c.indexOf(e.containerWidget),u=p;u<c.length;u++){for(var g=c[u].childWidgets,m=i;m<g.length;m++)this.updateIndex(g[m],t);p=0,i=0}else if(e.containerWidget instanceof Ul)for(r=i;r<e.containerWidget.childWidgets.length;r++){var f=e.containerWidget.childWidgets[r];f.rowIndex===e.containerWidget.index&&this.updateIndex(f,t)}else if(e.containerWidget instanceof Al)for(r=i;r<e.containerWidget.childWidgets.length;r++){var v=e.containerWidget.childWidgets[r];this.updateIndex(v,t);for(s=0;s<v.childWidgets.length;s++)v.childWidgets[s].rowIndex=v.index}else if(e.containerWidget instanceof Bl||e.containerWidget instanceof cd||!(0,a.isNullOrUndefined)(e.containerWidget)&&e.containerWidget.containerWidget instanceof Dl)for(r=i;r<e.containerWidget.childWidgets.length;r++){var y=e.containerWidget.childWidgets[r];this.updateIndex(y,t)}},e.prototype.updateIndex=function(e,t){t?e.index++:e.index--},e.prototype.updateEndPosition=function(){var e=this.documentHelper.selection;this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},e.prototype.checkAndRemoveComments=function(e,t){var i=this.selection;if(i.isEmpty||this.owner.enableTrackChanges&&!t||e)return[];var n=!1,r=this.getSelectedComments();if(r.commentEndInfo.length>0||r.commentStartInfo.length>0){n||(n=!0,this.initComplexHistory("RemoveComment"));var o=this.selection.start,s=this.selection.end;this.selection.isForward||(o=this.selection.end,s=this.selection.start);for(var l=this.selection.getParagraphInfo(o),d=this.selection.getParagraphInfo(s),h=0;h<r.commentEndInfo.length;h++){var c=r.commentEndInfo[h].comment,p=c.commentStart,u=c.commentEnd,g=this.selection.getParagraphInfoInternal(p.line,p.line.getOffset(p,0)),m=this.selection.getParagraphInfoInternal(u.line,u.line.getOffset(u,0));if(d.paragraph===m.paragraph){if(c.replyComments.length>0)for(var f=0;f<c.replyComments.length;f++){var v=c.replyComments[f];(0,a.isNullOrUndefined)(v.commentEnd)||d.offset--}d.offset--}if(l.paragraph===g.paragraph){var y=g.offset<l.offset;if(c.replyComments.length>0)for(f=0;f<c.replyComments.length;f++){v=c.replyComments[f];if(!(0,a.isNullOrUndefined)(v.commentStart))this.selection.getParagraphInfoInternal(v.commentStart.line,v.commentStart.line.getOffset(v.commentStart,0)).offset<l.offset&&l.offset--,d.paragraph===g.paragraph&&d.offset--}y&&l.offset--,d.paragraph===g.paragraph&&d.offset--}this.deleteCommentInternal(c)}if(r.commentStartInfo.length>0)for(var w=0;w<r.commentStartInfo.length;w++)r.commentStartInfo[w].line.paragraph.equals(d.paragraph)&&d.offset--,this.removeInline(r.commentStartInfo[w]);var b=i.getLineInfoBasedOnParagraph(l.paragraph,l.offset);i.start.setPositionFromLine(b.line,b.offset);var C=i.getLineInfoBasedOnParagraph(d.paragraph,d.offset);i.end.setPositionFromLine(C.line,C.offset)}return r.commentStartInfo},e.prototype.updateHistoryForComments=function(e){if(this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"RemoveComment"===this.editorHistory.currentHistoryInfo.action){if(!(0,a.isNullOrUndefined)(e))for(var t=0;t<e.length;t++)this.initInsertInline(e[t],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}},e.prototype.onBackSpace=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(this.documentHelper.triggerSpellCheck=!0,!e.isEmpty&&e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleBackspace(e,!1);else{var t=this.checkAndRemoveComments();this.initHistory("BackSpace");var i=this.deleteSelectedContents(e,!0);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.isSkipOperationsBuild=!(0,a.isNullOrUndefined)(this.alertDialog),this.reLayout(e),this.isSkipOperationsBuild=!1,this.insertSpaceInFormField())),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)){for(var n=0;n<t.length;n++)this.initInsertInline(t[n],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1)}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},e.prototype.insertRemoveBookMarkElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=0;i<this.removedBookmarkElements.length;i++){var n=this.removedBookmarkElements[i];if(0===n.bookmarkType){var r=n;if(r&&r.reference&&-1!==this.removedBookmarkElements.indexOf(r.reference)){var o=this.removedBookmarkElements.indexOf(r.reference),s=this.removedBookmarkElements.indexOf(r);this.removedBookmarkElements.splice(o,1),this.removedBookmarkElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(r.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedContentControlElements.length&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}else{var a=n;if(a&&a.reference&&-1!==this.removedBookmarkElements.indexOf(a.reference)){o=this.removedBookmarkElements.indexOf(a.reference),s=this.removedBookmarkElements.indexOf(a);this.removedBookmarkElements.splice(o,1),this.removedBookmarkElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(a.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedContentControlElements.length&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedBookmarkElements=[],t},e.prototype.insertRemoveContentControlElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=0;i<this.removedContentControlElements.length;i++){var n=this.removedContentControlElements[i];if(0===n.type){var r=n;if(r&&r.reference&&-1!==this.removedContentControlElements.indexOf(r.reference)){var o=this.removedContentControlElements.indexOf(r.reference),s=this.removedContentControlElements.indexOf(r);this.removedContentControlElements.splice(o,1),this.removedContentControlElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(r.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedContentControlElements.length-1&&0===this.removedBookmarkElements.length&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}else{var a=n;if(a&&a.reference&&-1!==this.removedContentControlElements.indexOf(a.reference)){o=this.removedContentControlElements.indexOf(a.reference),s=this.removedContentControlElements.indexOf(a);this.removedContentControlElements.splice(o,1),this.removedContentControlElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(a.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedContentControlElements.length-1&&0===this.removedBookmarkElements.length&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedContentControlElements=[],t},e.prototype.insertRemovedEditRangeEndElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=this.removedEditRangeEndElements.length-1;i>=0;i--){var n=this.removedEditRangeEndElements[i];if(n&&-1!==this.removedEditRangeStartElements.indexOf(n.editRangeStart)){var r=this.removedEditRangeEndElements.indexOf(n),o=this.removedEditRangeStartElements.indexOf(n.editRangeStart);this.removedEditRangeEndElements.splice(r,1),this.removedEditRangeStartElements.splice(o,1),i--}else{this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0);var s=this.selection.start.paragraph.getInline(this.selection.start.offset,0);s.element.editRangeStart.editRangeEnd=s.element,this.editorHistory.currentHistoryInfo&&0===i&&0===this.removedContentControlElements.length&&0===this.removedEditRangeStartElements.length&&0===this.removedBookmarkElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedEditRangeEndElements=[],t},e.prototype.insertRemovedEditRangeStartElements=function(e){var t=!1;if(!this.isRemoteAction)for(var i=0;i<this.removedEditRangeStartElements.length;i++){var n=this.removedEditRangeStartElements[i];if(n&&-1!==this.removedEditRangeEndElements.indexOf(n.editRangeEnd)){var r=this.removedEditRangeEndElements.indexOf(n.editRangeEnd),o=this.removedEditRangeStartElements.indexOf(n);this.removedEditRangeEndElements.splice(r,1),this.removedEditRangeStartElements.splice(o,1),i--}else{this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0);var s=this.selection.start.paragraph.getInline(this.selection.start.offset,0);s.element.editRangeEnd.editRangeStart=s.element,this.editorHistory.currentHistoryInfo&&i===this.removedEditRangeStartElements.length-1&&0===this.removedContentControlElements.length&&0===this.removedBookmarkElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedEditRangeStartElements=[],t},e.prototype.deleteSelectedContents=function(e,t,i){var n=this.deleteSelectedContentInternal(e,t,e.start,e.end,i),r=e.getTextPosBasedOnLogicalIndex(e.editPosition);return e.selectContent(r,!0),n},e.prototype.removeWholeElement=function(e){this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.getSelectedComments=function(){for(var e=this.documentHelper.comments,t=[],i=[],n=0;n<e.length;n++){var r=e[n],o=r.commentEnd,s=r.commentStart;if(!(0,a.isNullOrUndefined)(o)&&this.selection.isElementInSelection(o,!0))t.push(o);else if(!(0,a.isNullOrUndefined)(s)&&this.selection.isElementInSelection(s,!1)){i.push(s);for(var l=0;l<r.replyComments.length;l++)r.replyComments[l].commentStart&&i.push(r.replyComments[l].commentStart)}}return{commentStartInfo:i,commentEndInfo:t}},e.prototype.singleBackspace=function(e,t){var i=this.editorHistory;if(i&&!t&&!i.canRedo()&&i.canUndo()){var n=i.undoStack[i.undoStack.length-1],r=this.selection.getParagraphInfo(e.start),o=this.selection.getParagraphInfo(e.end);if("AutoFormatHyperlink"===n.action&&n.insertPosition===this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())&&n.endPosition===this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()))return void i.undo()}for(var s,l=!1,d=e.start.paragraph,h=e.start.currentWidget,c=e.start.offset,p=0,u=h.getInline(c,p),g=u.element,m=!1,f=c,v=!1;g instanceof Bd;){var y=g;if(g=g.previousNode,(0,a.isNullOrUndefined)(g)&&(g=s),(0,a.isNullOrUndefined)(g)||0!=g.commentType?g instanceof md&&(g=void 0):s=g.previousNode,g&&(f=g.length),!(0!==y.commentType||!(0,a.isNullOrUndefined)(g)&&g instanceof Bd)){(0,a.isNullOrUndefined)(g)?(g=y,f=0):f=g.length,v=!0;break}1===y.commentType&&(m||(this.initComplexHistory("RemoveComment"),m=!0),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.deleteCommentInternal(y.comment),this.isSkipOperationsBuild=!1,v=!0)}if(v)if((0,a.isNullOrUndefined)(g)){var w=d.childWidgets[0];e.start.setPositionParagraph(w,0),e.end.setPositionParagraph(w,0)}else d=g.line.paragraph,c=g.line.getOffset(g,f),e.start.setPositionParagraph(g.line,c),e.end.setPositionParagraph(g.line,c);if(g instanceof id){var b=this.selection.currentContentControl;if(this.selection.selectContentControlInternal(b),!(0,a.isNullOrUndefined)(b)&&1===g.type&&b.contentControlProperties.lockContentControl||(0,a.isNullOrUndefined)(g.nextElement)){if(!this.selection.isEmpty)return;this.onBackSpace()}if(!(0,a.isNullOrUndefined)(b)&&0===g.type&&g.nextElement!==b.reference||!(0,a.isNullOrUndefined)(b)&&0===g.type&&(b.contentControlProperties.lockContentControl||this.documentHelper.isFormFillProtectedMode)&&g.nextElement===b.reference)return}if(this.selection.isInlineFormFillMode()){if(g instanceof _l&&2===g.fieldType)return;if(1===this.getFieldResultText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}p=u.index,g instanceof Zl&&(g.ignoreOnceItems=[]),g instanceof Zl&&(g.ignoreOnceItems=[]);if(g instanceof _l&&2===g.fieldType&&Pa.isLinkedFieldCharacter(g)){var C=g.fieldBegin,x=g.fieldEnd;return C.nextNode instanceof td&&C.nextNode.reference&&(x=C.nextNode.reference),e.start.setPositionParagraph(C.line,C.line.getOffset(C,0)),e.end.setPositionParagraph(x.line,x.line.getOffset(x,0)+1),void e.fireSelectionChanged(!0)}if(!this.owner.enableTrackChanges&&g instanceof Yl&&("Footnote"===g.footnoteType?this.removeFootnote(g):this.removeEndnote(g)),g&&(g instanceof id||g.previousNode instanceof id)&&(g instanceof id&&g.previousNode&&!(g.previousElement instanceof md)&&(d=(g=g.previousNode).line.paragraph,c=g.line.getOffset(g,g.length)),g&&1===g.length&&g.nextNode instanceof id&&g.previousNode instanceof id&&!this.documentHelper.isFormFillProtectedMode)){var I=g.previousNode;x=g.nextNode;if(!I.contentControlProperties.lockContentControl)return e.start.setPositionParagraph(I.line,I.line.getOffset(I,0)),e.end.setPositionParagraph(x.line,x.line.getOffset(x,0)+1),void this.removeWholeElement(e)}if(g instanceof _l&&1===g.fieldType&&!this.selection.isInlineFormFillMode()){var k=e.getPreviousValidElement(g);if(k instanceof _l&&0!==k.fieldType){if(d=(g=k.fieldBegin).line.paragraph,c=g.line.getOffset(g,0),g.nextNode instanceof td&&g.nextNode.reference){var F=g.nextNode.reference;e.start.setPositionParagraph(F.line,F.line.getOffset(F,1))}return e.end.setPositionParagraph(g.line,c),void e.fireSelectionChanged(!0)}k!==g&&(d=(g=k).line.paragraph,c=g.line.getOffset(g,g.length))}if(g instanceof vd||g instanceof fd){if(g.nextNode instanceof fd&&g.editRangeEnd===g.nextNode||g.previousNode instanceof vd&&g.editRangeStart===g.previousNode)return;if(g instanceof vd&&!(g.previousNode instanceof fd))return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(g instanceof vd||g instanceof fd))return;if(g instanceof fd)do{if((0,a.isNullOrUndefined)(g.previousNode))break;d=(g=g.previousNode).line.paragraph,c=g.line.getOffset(g,g.length)}while(g instanceof fd);if(1===g.length&&g.nextNode instanceof fd&&g.previousNode instanceof vd){var P=g.previousNode;x=g.nextNode;return e.start.setPositionParagraph(P.line,P.line.getOffset(P,0)),e.end.setPositionParagraph(x.line,x.line.getOffset(x,0)+1),void this.removeWholeElement(e)}}if(g&&(g instanceof td||g.previousNode instanceof td)){if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(g.previousNode&&g.previousNode instanceof vd||g.previousNode instanceof fd))return;if(g instanceof td)if(g.previousNode){if((g=g.previousNode)instanceof _l&&!this.selection.isInlineFormFillMode()){if(d=(g=g.fieldBegin).line.paragraph,c=g.line.getOffset(g,0),g.nextNode instanceof td&&g.nextNode.reference){var S=g.nextNode.reference;e.start.setPositionParagraph(S.line,S.line.getOffset(S,1))}return e.end.setPositionParagraph(g.line,c),void e.fireSelectionChanged(!0)}d=g.line.paragraph,c=g.line.getOffset(g,g.length),e.start.setPositionFromLine(g.line,c),e.end.setPositionInternal(e.start)}else if(1===g.bookmarkType){if(d.previousRenderedWidget instanceof Rl){var T=(O=d.previousRenderedWidget).lastChild;return e.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),e.end.setPositionParagraph(T,T.getEndOffset()),void this.removeWholeElement(e)}}else{if(!(g.paragraph.previousWidget instanceof Rl))return;e.start.setPositionFromLine(g.line,0),e.end.setPositionInternal(e.start),c=0}else if(g.nextNode instanceof td&&g instanceof td&&0===g.bookmarkType&&g.reference===g.nextNode)return void this.deleteBookmark(g.name);if(1===g.length&&g.nextNode instanceof td&&g.previousNode instanceof td){C=g.previousNode,x=g.nextNode;return e.start.setPositionParagraph(C.line,C.line.getOffset(C,0)),e.end.setPositionParagraph(x.line,x.line.getOffset(x,0)+1),void this.removeWholeElement(e)}}if(t||this.initHistory("BackSpace"),c===e.getStartOffset(d)&&e.start.currentWidget.isFirstLine()){if(d.paragraphFormat.listFormat&&-1!==d.paragraphFormat.listFormat.listId)return void(!(0,a.isNullOrUndefined)(this.editorHistory)&&!(0,a.isNullOrUndefined)(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0&&"ListFormat"===this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].action?this.onApplyListInternal(this.documentHelper.getListById(d.paragraphFormat.listFormat.listId),d.paragraphFormat.listFormat.listLevelNumber-1):this.onApplyList(void 0));if(0!==d.paragraphFormat.firstLineIndent)return this.onApplyParagraphFormat("firstLineIndent",0,!1,!1),void(0!==d.paragraphFormat.leftIndent&&this.onApplyParagraphFormat("leftIndent",0,!1,!1));if(0!==d.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!d.paragraphFormat.bidi&&"Left"!==d.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(d.previousRenderedWidget instanceof Rl){e.owner.isShiftingEnabled=!0;var H=d.previousRenderedWidget;if(this.owner.enableTrackChanges&&null!=d.previousRenderedWidget&&0==d.previousRenderedWidget.characterFormat.revisions.length){var E=H.characterFormat.cloneFormat();if(this.checkToMatchEmptyParaMarkBack(H)){N=this.documentHelper.selection.getLineLength(H.lastChild),W=H.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(H,W,0),e.selects(H.childWidgets[W],N,!0),this.addRemovedNodes(E)}else{this.insertRevision(H.characterFormat,"Deletion");var N=this.documentHelper.selection.getLineLength(H.lastChild),W=H.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(H,W,0),e.selects(H.childWidgets[W],N,!0),this.addRemovedNodes(E)}}else if(H.isEmpty()&&!this.owner.enableTrackChanges)if(this.removePrevParaMarkRevision(d),d!==d.bodyWidget.lastChild||H.bodyWidget.index===d.bodyWidget.index){this.removeBlock(H),this.addRemovedNodes(H);var O=d.previousRenderedWidget;(!(0,a.isNullOrUndefined)(O)&&O instanceof Rl&&O.isEmpty()&&O.bodyWidget.index!==d.bodyWidget.index||H.isSectionBreak)&&e.moveToPreviousCharacter()}else{N=this.documentHelper.selection.getLineLength(H.lastChild),W=H.childWidgets.length-1;e.selects(H.childWidgets[W],N,!0)}else if(this.owner.enableTrackChanges&&null!=H.characterFormat.revisions&&"Deletion"==H.characterFormat.revisions[0].revisionType){N=this.documentHelper.selection.getLineLength(H.lastChild),W=H.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(H,W,0),e.selects(H.childWidgets[W],N,!0),this.addRemovedNodes(d)}else if(this.owner.enableTrackChanges&&null!=H.characterFormat.revisions&&e.start.isAtParagraphStart&&H.isEmpty())this.addRemovedRevisionInfo(H.characterFormat,void 0,!1),this.addRemovedNodes(H),this.removePrevParaMarkRevision(d),this.removeBlock(H,!1,!0);else{var B=!1;if(!(d===d.bodyWidget.lastChild&&H.bodyWidget.index!==d.bodyWidget.index||"NoBreak"===d.bodyWidget.sectionFormat.breakCode&&d===d.bodyWidget.firstChild)){if(d.characterFormat.revisions.length>0&&H.characterFormat.revisions.length>0&&"Insertion"==d.characterFormat.revisions[0].revisionType)this.addRemovedRevisionInfo(d.characterFormat,void 0,!1),this.removePrevParaMarkRevision(d,!0);else{this.removePrevParaMarkRevision(d,!1,!0);for(var L=0;L<d.characterFormat.revisions.length;L++){var D=d.characterFormat.revisions[L];if(-1!==D.range.indexOf(d.characterFormat)){var R=D.range.indexOf(d.characterFormat);D.range.splice(R,1,H.characterFormat)}H.characterFormat.revisions.push(D)}}this.removeBlock(d,!1,!0),B=!0}N=this.documentHelper.selection.getLineLength(H.lastChild),W=H.childWidgets.length-1,w=void 0;if(!d.isEmpty()&&B)for(L=0;L<d.childWidgets.length;L++){w=d.childWidgets[L],H.childWidgets.push(w);for(var M=0;M<w.children.length;M++){if(w.children[M]instanceof Yl)if(-1===(R=this.documentHelper.footnoteCollection.indexOf(w.children[M]))){w.children[M].isLayout=!1;var A=parseInt(w.children[M].text);this.documentHelper.footnoteCollection.splice(A-1,0,w.children[M])}}d.childWidgets.splice(L,1),L--,w.paragraph=H}this.documentHelper.layout.reLayoutParagraph(H,W,0),e.selects(H.childWidgets[W],N,!0),B&&this.addRemovedNodes(d)}if(this.setPositionForHistory(),this.documentHelper.layout.getFootNoteWidgetsOf(d).length>0){var U=this.documentHelper.layout,V=d.bodyWidget;U.layoutfootNote(V.page.footnoteWidget)}this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var z=this.selection.getParagraphInfo(e.start),q=(w=e.start.currentWidget,c-1);q<0&&(w=w.previousLine,q=this.documentHelper.selection.getLineLength(w)+q),this.removeAtOffset(w,e,q);b=this.selection.currentContentControl;!(0,a.isNullOrUndefined)(b)&&b.contentControlProperties.isTemporary&&this.removeContentControl(),this.setPositionParagraph(z.paragraph,z.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():(this.reLayout(e),l&&(this.owner.editorHistoryModule.undoStack[this.owner.editorHistoryModule.undoStack.length-2].modifiedActions.push(this.owner.editorHistoryModule.undoStack[this.owner.editorHistoryModule.undoStack.length-1]),this.owner.editorHistoryModule.undoStack.splice(this.owner.editorHistoryModule.undoStack.length-1,1),l=!1))}m&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory())},e.prototype.setPositionForHistory=function(e){var t=this.documentHelper.selection;this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&((0,a.isNullOrUndefined)(e)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},e.prototype.removeAtOffset=function(e,t,i){for(var n=0,r=e.paragraph.childWidgets.indexOf(e),o=e.children.length,s=0;s<o;s++){var a=e.children[s];if(!(a instanceof md)){if(this.removeCharacter(a,i,n,e,r,s))break;n+=a.length}}},e.prototype.removeCharacter=function(e,t,i,n,r,o,s){var l=!1;if(e instanceof td&&e.reference&&e.line!==e.reference.line&&!(n.children[o]instanceof td))return(0,a.isNullOrUndefined)(e.line.previousLine)?(0,a.isNullOrUndefined)(e.line.paragraph.previousRenderedWidget)?(0,a.isNullOrUndefined)(e.line.paragraph.nextRenderedWidget)||(e.line.paragraph.nextRenderedWidget.firstChild.children.splice(e.line.paragraph.nextRenderedWidget.firstChild.children.length,0,e),e.line=e.line.paragraph.nextRenderedWidget.firstChild):(e.line.paragraph.previousRenderedWidget.lastChild.children.splice(e.line.paragraph.previousRenderedWidget.lastChild.children.length,0,e),e.line=e.line.paragraph.previousRenderedWidget.lastChild):(e.line.previousLine.children.splice(e.line.previousLine.children.length,0,e),e.line=e.line.previousLine),n.children.splice(o,1),!(0,a.isNullOrUndefined)(n.layoutedElements)&&n.layoutedElements.length>0&&n.layoutedElements.splice(o,1),!0;if(t<i+e.length){var d=t-i;if(e.ischangeDetected=!0,this.owner.isSpellCheck){var h=e.nextElement,c=e.previousElement;this.owner.spellCheckerModule.removeErrorsFromCollection({element:e,text:e.text}),!(0,a.isNullOrUndefined)(h)&&h instanceof Zl&&(h.ischangeDetected=!0,this.owner.spellCheckerModule.removeErrorsFromCollection({element:h,text:h.text})),!(0,a.isNullOrUndefined)(c)&&c instanceof Zl&&(c.ischangeDetected=!0,this.owner.spellCheckerModule.removeErrorsFromCollection({element:c,text:c.text})),e.canTrigger||(this.documentHelper.triggerSpellCheck=!1)}if(t===i&&1===e.length)this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(e.clone()),this.handleDeleteTracking(e,d,1,o)):(this.unLinkFieldCharacter(e),this.unlinkRangeFromRevision(e,!0),this.addRemovedRevisionInfo(e,void 0),this.addRemovedNodes(e),this.owner.enableTrackChanges&&this.editorHistory.isRedoing&&e instanceof Yl&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e)),n.children.splice(o,1),!(0,a.isNullOrUndefined)(n.layoutedElements)&&n.layoutedElements.length>0&&(n.layoutedElements.splice(o,1),0===n.layoutedElements.length&&(n.layoutedElements=void 0))),this.documentHelper.layout.reLayoutParagraph(n.paragraph,r,o,void 0,s);else{var p=this.handleDeleteTracking(e,d,1);this.documentHelper.layout.reLayoutParagraph(n.paragraph,r,o,void 0,s),(0,a.isNullOrUndefined)(p)||(e.revisions.length>0&&this.addRemovedRevisionInfo(e,p),this.addRemovedNodes(p))}e instanceof vd&&(this.selection.skipEditRangeRetrieval=!0,this.removeUserRestrictionsInternal(e,void 0,!0),this.selection.updateEditRangeCollection(),this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1),e instanceof td&&0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&this.documentHelper.bookmarks.remove(e.name),l=!0}return l},e.prototype.removeCharacterInLine=function(e,t,i){var n=new Zl;if(e instanceof Zl){e.isWidthUpdated=!1,n.characterFormat.copyFormat(e.characterFormat);var r=1===i?1:i-t;n.text=e.text.substr(t,r);var o=e.text;e.text=o.substring(0,t)+o.substring(t+r,o.length),e.contentControlProperties&&(n.contentControlProperties=e.contentControlProperties.clone())}return n},e.prototype.removeRevisionsInformation=function(e,t,i,n){var r=e.previousElement;"Insertion"===this.retrieveRevisionInOder(r).revisionType&&this.isRevisionMatched(r,void 0)&&e.line.children.splice(n,1)},e.prototype.handleDeleteTracking=function(e,t,i,n,r,o,s){var l=this.owner.enableTrackChanges,d=(!(0,a.isNullOrUndefined)(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),void 0);if(this.canHandleDeletion()||l&&(!this.skipTracking()||e.paragraph.isInsideTable&&!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.isRedoing&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)){if(e instanceof td||e instanceof Bd||e instanceof vd||e instanceof fd){if(e instanceof td&&e.previousElement instanceof _l&&e.previousElement.formFieldData)e.previousElement.revisions.length>0&&this.removeRevisionsInformation(e,t,i,n);else if(l&&e instanceof td)this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e);else if(e instanceof Bd){for(var h=!1,c=0;c<this.owner.documentHelper.comments.length;c++)e.commentId===this.owner.documentHelper.comments[c].commentId&&(h=!0);h||e.line.children.splice(e.indexInOwner,1)}else e.line.children.splice(e.indexInOwner,1);return}var p=!1;if(this.owner.editorHistoryModule&&(p=!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),e.revisions.length>0){var u=this.retrieveRevisionInOder(e),g=this.owner.revisions.changes.indexOf(u);if(!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule)&&!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&!r){var m=(0,a.isNullOrUndefined)(n)?t:0,f=(0,a.isNullOrUndefined)(n)?1===i?1:i-t:e.length;this.owner.editorHistoryModule.currentBaseHistoryInfo.recordInsertRevisionDeletetion(e,m,f)}if("Insertion"===u.revisionType)if(this.isRevisionMatched(e,void 0)){if((0,a.isNullOrUndefined)(n)){d=this.removeCharacterInLine(e,t,i);var v=e.revisions[0];(0,a.isNullOrUndefined)(v)||this.owner.trackChangesPane.updateCurrentTrackChanges(v)}else{var y=u.range.indexOf(e);u.range.splice(y,1),this.owner.trackChangesPane.updateCurrentTrackChanges(u),0===u.range.length&&this.owner.revisionsInternal.remove(u),this.unLinkFieldCharacter(e),e.line.children.splice(n,1),!(0,a.isNullOrUndefined)(e.line.layoutedElements)&&e.line.layoutedElements.length>0&&-1!==e.line.layoutedElements.indexOf(e)&&e.line.layoutedElements.splice(n,1),0===e.line.children.length&&(e.line.layoutedElements=void 0)}e instanceof Yl&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e))}else if((0,a.isNullOrUndefined)(n)){var w=this.removeCharacterInLine(e,t,i),b=e.revisions[0];if((0,a.isNullOrUndefined)(b)||this.owner.trackChangesPane.updateCurrentTrackChanges(b),0===t){var C=e.previousElement;this.handleDeletionForInsertRevision(C,e,w,i,t,!0)}else if(e.length!==t)for(c=e.revisions.length-1;c>=0;c--){var x=e.revisions[c],I=x.range.indexOf(e),k=new Zl;k.characterFormat.copyFormat(e.characterFormat),k.line=e.line,k.text=e.text.substr(t),k.revisions.splice(0,0,x),x.range.splice(I+1,0,k),w.revisions.splice(0,0,x),w.line=e.line,w.isWidthUpdated=!1,x.range.splice(I+1,0,w),this.owner.trackChangesPane.updateCurrentTrackChanges(x),e.text=e.text.substr(0,t),e.isWidthUpdated=!1;var F=e.indexInOwner;e.line.children.splice(F+1,0,k),e.line.children.splice(F+1,0,w),this.addRemovedNodes(w.clone()),this.insertRevision(w,"Deletion"),this.updateLastElementRevision(w)}else if(e.length===t){var P=e.nextElement;this.handleDeletionForInsertRevision(P,e,w,i,t,!1)}else 1===i?p||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,i),this.addRemovedNodes(w.clone()),this.insertInlineInternal(w,"Deletion")}else this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e);else if("Deletion"===u.revisionType){if(-1!==g&&u.author!==this.owner.currentUser&&u.range.length>0){var S=u.range,T=S[0]instanceof ka||S[0]instanceof Ca?0:S[0].line.getOffset(S[0],0),H=!1,E=void 0;if(0===t&&i>=this.selection.getLineLength(e.line)||t+1===i&&e instanceof Zl&&1===e.length)S.splice(S.indexOf(e),1),this.owner.trackChangesPane.updateCurrentTrackChanges(u),e.revisions.splice(e.revisions.indexOf(u),1),!(0,a.isNullOrUndefined)(e.nextNode)&&e.nextNode.revisions.length>0&&(E=this.getMatchedRevisionsToCombine(e.nextNode.revisions,"Deletion")),E&&0===E.length&&e.previousNode instanceof Zl&&e.previousNode.revisions.length>0&&this.updateRevisionForSpittedTextElement(e.previousNode,void 0),this.checkToCombineRevisionsInSides(e,"Deletion")?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,"Deletion"),H=!0,this.updateLastElementRevision(e)),H&&e.line.getOffset(e,0)===T&&-1!==this.owner.revisions.changes.indexOf(u)&&0===u.range.length&&this.owner.revisions.changes.splice(g,1);else if(1!==i){this.handleDeleteBySplitting(e,t,i);var N=this.selection.start.currentWidget.getInline(this.selection.start.offset,0).element;N&&(e=N),e.revisions.length>0&&e.nextNode instanceof ql&&e.nextNode.revisions.length>0&&this.combineElementRevision(e.revisions,e.nextNode.revisions)}}if(1===i)p?(this.selection.start.moveNextPosition(),this.selection.end.setPositionInternal(this.selection.start)):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start));else if(this.isRevisionMatched(e,"Deletion"))this.updateCursorForInsertRevision(e,t,i);else{var W=u.range.indexOf(e);e.line.getOffset(e,e.length)>=i&&u.range.length>W+1?(this.updateRevisionForSpittedTextElement(e,u.range[W+1]),u.range.splice(u.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"),this.owner.trackChangesPane.updateCurrentTrackChanges(u)):1===u.range.length||0===t?(this.handleDeleteBySplitting(e,t,i),W>0&&1!==u.range.length&&(this.updateRevisionForSpittedTextElement(u.range[W-1],u.range[W]),(u=this.retrieveRevisionInOder(e)).range.splice(u.range.indexOf(e),1))):(u.range.splice(u.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"))}this.updateLastElementRevision(e)}}else(0,a.isNullOrUndefined)(n)?this.handleDeleteBySplitting(e,t,i):(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.skipFootNoteDeleteTracking||this.updateLastElementRevision(e))}else{d=this.removeCharacterInLine(e,t,i);u=e.revisions[0];(0,a.isNullOrUndefined)(u)||this.owner.trackChangesPane.updateCurrentTrackChanges(u)}return d},e.prototype.toCombineOrInsertRevision=function(e,t){this.checkToCombineRevisionsInSides(e,t)?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,t),this.updateLastElementRevision(e))},e.prototype.updateLastElementRevision=function(e){this.skipTableElements||!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.skipReplace||!(0,a.isNullOrUndefined)(this.owner.searchModule)&&this.owner.searchModule.isRepalceTracking||((0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=e),e.isMarkedForRevision=!0)},e.prototype.updateEndRevisionIndex=function(){if(!(0,a.isNullOrUndefined)(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0)for(var e=this.editorHistory.undoStack.length-1;e>=0;e--){var t=this.editorHistory.undoStack[e];if(t.lastElementRevision&&(0,a.isNullOrUndefined)(t.endRevisionLogicalIndex)){t.updateEndRevisionInfo();break}}},e.prototype.retrieveRevisionInOder=function(e){if(1===e.revisions.length)return e.revisions[0];for(var t=0;t<e.revisions.length;t++)if("Deletion"===e.revisions[t].revisionType)return e.revisions[t];return e.revisions[e.revisions.length-1]},e.prototype.handleDeletionForInsertRevision=function(e,t,i,n,r,o){if(!(0,a.isNullOrUndefined)(e)&&0===t.revisions.length&&this.isRevisionMatched(e,"Deletion"))this.addRemovedNodes(i.clone()),this.insertTextInline(e,this.selection,i.text,0);else{var s=t.revisions[t.revisions.length-1],l=s.range.indexOf(t);s.range.splice(o?l:l+1,0,i),this.owner.trackChangesPane.updateCurrentTrackChanges(s),i.revisions.splice(0,0,s);var d=!1;this.owner.editorHistoryModule&&(d=!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action),1===n&&this.selection.isEmpty?d||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(t,r,n),this.addRemovedNodes(i.clone()),this.insertInlineInternal(i,"Deletion")}},e.prototype.handleDeleteBySplitting=function(e,t,i){var n=!1;if(this.owner.editorHistoryModule&&(n=!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action),1===i&&this.selection.isEmpty){var r=e.line.getOffset(e,0);if(r>0){var o=new ac(this.owner);o.setPositionForLineWidget(e.line,r+t),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(this.selection.start)}else n||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start))}else this.updateCursorForInsertRevision(e,t,i);var s=!1;if(e.revisions.length>0&&e.length-1===t){if(!(0,a.isNullOrUndefined)(e.nextNode)&&e.nextNode.revisions.length>0&&!(0,a.isNullOrUndefined)(e.nextNode)&&e.nextNode.revisions.length>0){var l=this.getMatchedRevisionsToCombine(e.nextNode.revisions,"Deletion");(0,a.isNullOrUndefined)(l)||0!==l.length||(s=!0)}}else if(e.revisions.length>0){l=this.getMatchedRevisionsToCombine(e.revisions,"Deletion");(0,a.isNullOrUndefined)(l)||0!==l.length||(s=!0)}var d=this.removeCharacterInLine(e,t,i),h=e.revisions[0];(0,a.isNullOrUndefined)(h)||this.owner.trackChangesPane.updateCurrentTrackChanges(h),e.revisions.length>0&&(d.removedIds=xa.cloneRevisions(e.revisions)),this.addRemovedNodes(d.clone()),""!==d.text||this.owner.enableTrackChanges&&!this.skipTracking()?""!==d.text&&this.insertTextInternal(d.text,!1,"Deletion",!1,s):this.deleteParagraphMark(e.paragraph,this.selection,0,!0)},e.prototype.updateCursorForInsertRevision=function(e,t,i){var n=e.line.getOffset(e,0);n>0&&(t=n+t,i=n+i);var r=new ac(this.owner);r.setPositionFromLine(e.line,t);var o=new ac(this.owner);o.setPositionFromLine(e.line,i),r.isExistBefore(o)?(this.selection.end.setPositionInternal(r),this.selection.start.setPositionInternal(r)):(this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(o))},e.prototype.checkToCombineRevisionsInSides=function(e,t){var i,n=e.previousNode,r=e.nextNode,o=!1;(0,a.isNullOrUndefined)(n)||(n instanceof td||(n=n.previousValidNodeForTracking),(0,a.isNullOrUndefined)(n)||(i=this.getMatchedRevisionsToCombine(n.revisions,t)).length>0&&(this.mapMatchedRevisions(i,n,e,!1),o=!0));(0,a.isNullOrUndefined)(r)||(r instanceof td||(r=r.nextValidNodeForTracking),(0,a.isNullOrUndefined)(r)||(i=this.getMatchedRevisionsToCombine(r.revisions,t)).length>0&&(o?this.combineElementRevision(e.revisions,r.revisions):this.mapMatchedRevisions(i,r,e,!0),o=!0));return o},e.prototype.delete=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(!e.isEmpty&&e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleDelete(e,!1);else{var t=this.checkAndRemoveComments();this.initHistory("Delete");var i=void 0;i=e.isForward?e.end:e.start;var n=this.selection.getParagraphInfo(i);this.deleteSelectedContentInternal(e,!1,e.start,e.end);var r=new ac(e.owner),o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());if(!this.owner.enableTrackChanges||this.skipTracking()||this.isInsertingTOC||-1===n.paragraph.indexInOwner||(e.editPosition=o),this.setPositionForCurrentIndex(r,e.editPosition),e.selectContent(r,!0),this.reLayout(e),this.insertSpaceInFormField(),this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentHistoryInfo)&&"RemoveComment"===this.editorHistory.currentHistoryInfo.action){for(var s=0;s<t.length;s++)this.initInsertInline(t[s],!1);this.editorHistory.currentHistoryInfo.endPosition=this.selection.startOffset,this.editorHistory.updateComplexHistory()}}this.removeEditRange=!1,this.documentHelper.layout.islayoutFootnote=!1,this.updateXmlMappedContentControl()},e.prototype.deleteEditElement=function(e){this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new ac(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)},e.prototype.removeContentControlMark=function(e,t){return!e.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},e.prototype.singleDelete=function(e,t){var i=e.start.currentWidget,n=e.start.paragraph,r=e.start.offset,o=0,s=i.getInline(e.start.offset,o),l=s.element;if(this.selection.isInlineFormFillMode()){if(l instanceof _l&&1===l.fieldType)return;var d=this.getFieldResultText();if(l instanceof Zl||(l=l.nextElement),1===d.length&&l instanceof Zl)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(l instanceof _l&&1===l.fieldType)return}if(o=s.index,n.paragraphFormat.listFormat&&-1!==n.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===e.contextType)this.onApplyList(void 0);else{if(!(0,a.isNullOrUndefined)(l)&&o===l.length&&!(0,a.isNullOrUndefined)(l.nextNode)){if((l=l.nextNode)instanceof _l&&1===l.fieldType&&!(0,a.isNullOrUndefined)(l.fieldBegin.formFieldData))return;if(l instanceof Yl)return;o=0}for(var h=l instanceof Bd;l instanceof Bd;){if(!l.nextNode){o=1;break}l=l.nextNode,o=0}if(h&&(n=l.line.paragraph,r=l.line.getOffset(l,o),e.start.setPositionParagraph(l.line,r),e.end.setPositionParagraph(l.line,r)),!this.owner.enableTrackChanges&&l instanceof Yl&&("Footnote"===l.footnoteType?this.removeFootnote(l):this.removeEndnote(l)),!(0,a.isNullOrUndefined)(l)){var c=void 0,p=this.documentHelper.getNextValidElement(l);if(p instanceof ql&&(c=p),!(0,a.isNullOrUndefined)(c)&&c instanceof _l&&0===c.fieldType){if(n=(l=c.fieldEnd).line.paragraph,r=l.line.getOffset(l,1),e.end.setPositionParagraph(l.line,r),l.nextNode instanceof td){var u=l.nextNode;e.end.setPositionParagraph(u.line,u.line.getOffset(u,1))}return void e.fireSelectionChanged(!0)}l!==c&&(n=(l=c).line.paragraph,r=l.line.getOffset(l,0),l instanceof _l&&1===l.fieldType&&r++)}if(l instanceof vd||l instanceof fd){if(l.nextNode instanceof fd&&l.editRangeEnd===l.nextNode||l.previousNode instanceof vd&&l.editRangeStart===l.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(l instanceof vd||l instanceof fd)return}else l instanceof vd?(r=(l=l.nextNode).line.getOffset(l,0),n=l.line.paragraph):l instanceof fd&&r++;if(1===l.length&&l.nextNode instanceof fd&&l.previousNode instanceof vd){var g=l.previousNode,m=l.nextNode;return e.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),e.end.setPositionParagraph(m.line,m.line.getOffset(m,0)+1),void this.deleteEditElement(e)}}if(l&&(l instanceof id||l.nextNode instanceof id)){if(l instanceof id&&l.nextNode)return n=(l=l.nextNode).line.paragraph,r=l.line.getOffset(l,0),e.start.setPositionParagraph(l.line,r),void e.end.setPositionParagraph(l.line,r);if(l&&1===l.length&&l.nextNode instanceof id&&l.previousNode instanceof id&&this.removeContentControlMark(l.previousNode,l.nextNode))return;if(l instanceof id&&l.previousNode instanceof id&&l.previousNode.reference===l&&!this.documentHelper.isFormFillProtectedMode&&this.removeContentControlMark(l.previousNode,l))return}if(l&&(l instanceof td&&0===l.bookmarkType||l.nextNode instanceof td)){if(l.nextNode&&l instanceof td&&(n=(l=l.nextNode).line.paragraph,r=l.line.getOffset(l,0),e.start.setPositionParagraph(l.line,r),e.end.setPositionParagraph(l.line,r)),1===l.length&&l.nextNode instanceof td&&l.previousNode instanceof td){var f=l.previousNode,v=l.nextNode;return e.start.setPositionParagraph(f.line,f.line.getOffset(f,0)),e.end.setPositionParagraph(v.line,v.line.getOffset(v,0)+1),void this.deleteEditElement(e)}l instanceof td&&(r=l.line.getOffset(l,1))}if(e.start.currentWidget.isLastLine()&&r>=this.documentHelper.selection.getLineLength(e.start.currentWidget)){if(n.isInsideTable&&(0,a.isNullOrUndefined)(n.nextWidget))return;var y=void 0,w=void 0,b=e.getNextParagraphBlock(n);if((0,a.isNullOrUndefined)(b)){if(r>0)return;if(n.previousWidget instanceof Rl&&(y=n.previousWidget),n.previousWidget instanceof Dl)return;if(n.previousWidget instanceof Al)return;if((0,a.isNullOrUndefined)(y)||n.isEmpty()&&y.characterFormat.revisions.length>0)return}if(t||this.initHistory("Delete"),n.isEndsWithPageBreak||n.isEndsWithColumnBreak){var C=n.lastChild,x=C.children[C.children.length-1];this.selection.start.setPositionForSelection(C,x,0,this.selection.start.location)}var I=this.selection.getParagraphInfo(e.start);if(e.editPosition=this.selection.getHierarchicalIndex(I.paragraph,I.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,n.isEmpty()){this.removePrevParaMarkRevision(n,!0);var k=e.getNextParagraphBlock(n);if(!(0,a.isNullOrUndefined)(k)&&k instanceof Rl&&k.bodyWidget.index!==n.bodyWidget.index&&(this.deleteSection(e,n.bodyWidget,k.bodyWidget,0),this.editorHistory.currentBaseHistoryInfo.type="SectionBreak"),this.removeBlock(n,!1,!0),this.addRemovedNodes(n),(0,a.isNullOrUndefined)(b))if((0,a.isNullOrUndefined)(y)){var F=e.getParagraphLength(w)+1;this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(w,F.toString()))}else e.selectParagraphInternal(y,!1),this.setPositionForHistory();else e.selectParagraphInternal(b,!0)}else if(this.owner.enableTrackChanges&&n.nextRenderedWidget instanceof Rl){var P=n.nextRenderedWidget,S=P.childWidgets.length-1;n=n.combineWidget(this.owner.viewer);var T=this.splitParagraph(n,n.firstChild,0,e.start.currentWidget,e.start.offset,!0);null!=n&&0!=n.characterFormat.revisions.length&&"Insertion"==n.characterFormat.revisions[0].revisionType?(this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(T,e,0),this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)):(this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(T,e,0,!0),this.addRemovedNodes(n.characterFormat),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selects(P.childWidgets[S],0,!0))}else{n=n.combineWidget(this.owner.viewer);T=this.splitParagraph(n,n.firstChild,0,e.start.currentWidget,e.start.offset,!0);this.removePrevParaMarkRevision(n,!0),this.deleteParagraphMark(T,e,0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"SectionBreak"===this.editorHistory.currentBaseHistoryInfo.type&&this.addRemovedNodes(n),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)}this.reLayout(e)}else{var H=s.element;if(H instanceof id){var E=this.selection.currentContentControl;if(this.selection.selectContentControlInternal(E),!(0,a.isNullOrUndefined)(E)&&1===H.type&&E.contentControlProperties.lockContentControl&&(0,a.isNullOrUndefined)(H.nextElement)){if(!this.selection.isEmpty)return;this.delete()}if(!(0,a.isNullOrUndefined)(E)&&0===H.type&&H.nextElement!==E.reference||!(0,a.isNullOrUndefined)(E)&&0===H.type&&E.contentControlProperties.lockContentControl&&H.nextElement===E.reference)return}else this.singleDeleteInternal(e,t,n)}e.start.currentWidget.getInline(e.start.offset+1,0).element instanceof td&&(e.start.offset++,e.end.offset++)}},e.prototype.singleDeleteInternal=function(e,t,i){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var n=this.selection.getParagraphInfo(e.start),r=e.start.currentWidget,o=e.start.offset,s=e.getLineLength(e.start.currentWidget);o>=s&&(r=r.nextLine,o-=s),this.removeAtOffset(r,e,o),this.owner.enableTrackChanges&&!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&s!==e.getLineLength(e.start.currentWidget)?this.setPositionParagraph(n.paragraph,n.offset,!1):this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(n.paragraph,n.offset+1,!1):this.setPositionParagraph(n.paragraph,n.offset,!1),t?this.fireContentChange():this.reLayout(e)},e.prototype.deleteParagraphMark=function(e,t,i,n,r,o){if(!(0,a.isNullOrUndefined)(e.containerWidget)){e=e.combineWidget(this.owner.viewer);var s=t.getNextParagraphBlock(e);if(!(e.isInsideTable&&(0,a.isNullOrUndefined)(e.nextWidget)||(0,a.isNullOrUndefined)(s))){e.containerWidget instanceof Ol&&e.containerWidget;var l=void 0;if(l=t.getNextRenderedBlock(e)instanceof Al?t.getNextRenderedBlock(e):void 0,s.isInsideTable&&!(0,a.isNullOrUndefined)(l)&&l.contains(s.associatedCell)){if(i<4){var d=0;this.removeBlock(e),this.documentHelper.layout.clearListElementBox(s),this.documentHelper.layout.clearListElementBox(e);for(var h=e.childWidgets.length-1;h>=0;h--)for(var c=e.childWidgets[h],p=c.children.length-1;p>=0;p--){var u=c.children[p];d+=u.length,s.firstChild.children.unshift(u),u.line=s.firstChild}this.documentHelper.layout.reLayoutParagraph(s,0,0),d>0&&(t.editPosition=this.selection.getHierarchicalIndex(s,d.toString()))}}else if(i<4){e.childWidgets.length;var g=s.getSplitWidgets();if(s=s.combineWidget(this.owner.viewer),this.documentHelper.layout.clearListElementBox(s),this.documentHelper.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,s),!(!(0,a.isNullOrUndefined)(n)&&n)||this.handleDeleteParaMark(e,g[0])){var m=e.childWidgets.length-1;for(e.childWidgets[m].children.length,h=0;h<s.childWidgets.length;h++){var f=s.childWidgets[h];if(s.characterFormat.revisions.length>0){for(var v=0;v<s.characterFormat.revisions.length;v++){if(-1!==s.characterFormat.revisions[v].range.indexOf(s.characterFormat)){var y=s.characterFormat.revisions[v].range.indexOf(s.characterFormat);s.characterFormat.revisions[v].range.splice(y,1),s.characterFormat.revisions[v].range.splice(y,0,e.characterFormat)}e.characterFormat.revisions.push(s.characterFormat.revisions[v])}s.characterFormat.revisions=[]}s.childWidgets.splice(h,1),e.childWidgets.push(f),f.paragraph=e,h--}for(h=0;h<s.floatingElements.length;h++){var w=s.floatingElements[h];s.floatingElements.splice(h,1),e.floatingElements.push(w),h--}s.bodyWidget.index!==e.bodyWidget.index&&(this.deleteSection(t,e.bodyWidget,s.bodyWidget,i),this.editorHistory.currentBaseHistoryInfo.type="SectionBreak"),0===s.childWidgets.length&&s.childWidgets.push(new zl(s)),this.documentHelper.layout.reLayoutParagraph(e,0,0),this.removeBlock(s),this.editorHistory&&"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&(o||this.addRemovedNodes(s,r))}}}}},e.prototype.handleDeleteParaMark=function(e,t){if(!this.owner.enableTrackChanges&&e.characterFormat.revisions.length>0)for(var i=0;i<e.characterFormat.revisions.length;i++){var n=e.characterFormat.revisions[i],r=n.range.indexOf(e.characterFormat);return n.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n),0===n.range.length&&this.owner.revisions.remove(n),!0}if(this.owner.enableTrackChanges){var o=!1,s=!1;if(e.characterFormat.revisions.length>0){var l=this.retrieveRevisionByType(e.characterFormat,"Deletion");if(!(0,a.isNullOrUndefined)(l)&&this.isRevisionMatched(l,"Deletion")){var d=e.characterFormat.revisions.indexOf(l);e.characterFormat.revisions.splice(d,1),l.range.splice(l.range.indexOf(e.characterFormat),1),this.owner.trackChangesPane.updateCurrentTrackChanges(l),0===l.range.length&&this.owner.revisions.remove(l),t=e.nextRenderedWidget instanceof Rl?e.nextRenderedWidget:void 0,this.applyRevisionForParaMark(e,t?t.firstChild:void 0,"Deletion",!1),s=!0,o=!1}var h=this.retrieveRevisionByType(e.characterFormat,"Insertion");if(!(0,a.isNullOrUndefined)(h)&&this.isRevisionMatched(e.characterFormat,"Insertion")){r=h.range.indexOf(e.characterFormat);h.range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(h),0===h.range.length&&this.owner.revisions.remove(h),o=!0}return!!o||(s||this.applyRevisionForParaMark(e,t?t.firstChild:void 0,"Deletion",!1),!1)}return this.applyRevisionForParaMark(e,t?t.firstChild:void 0,"Deletion",!1),!1}return!0},e.prototype.insertDeleteParaMarkRevision=function(e,t){var i=e.lastChild,n=i.children.length>0?i.children[i.children.length-1].previousValidNodeForTracking:void 0;if(!(0,a.isNullOrUndefined)(n)){var r=this.getMatchedRevisionsToCombine(n.revisions,"Deletion");r.length>0&&this.mapMatchedRevisions(r,n,e.characterFormat,!1)}t.firstChild.children[0].nextValidNodeForTracking},e.prototype.retrieveRevisionByType=function(e,t){for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionType===t)return e.revisions[i]},e.prototype.combineRevisionOnDeleteParaMark=function(e,t,i){var n=e.childWidgets[t].children[i],r=n.nextNode;r=r.nextValidNodeForTracking,n=n.nextValidNodeForTracking,r.revisions.length>0&&n.revisions.length>0&&this.combineElementRevisions(n,r)},e.prototype.updateEditPositionOnMerge=function(e,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(e,this.documentHelper.selection.getLineLength(e.lastChild).toString()))},e.prototype.checkEndPosition=function(e){return this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.endPosition)},e.prototype.checkInsertPosition=function(e){return this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo.insertPosition)},e.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},e.prototype.deleteSelectedContentInternal=function(e,t,i,n,r){var o=i,s=n;i.isExistBefore(n)||(o=n,s=i);var l=this.selection.getParagraphInfo(o);e.editPosition=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString());var d=!1;if(t&&o.isInSameParagraph(s)){if(o.offset<s.offset&&o.offset===e.getParagraphLength(s.paragraph))d=e.getNextRenderedBlock(o.paragraph)instanceof Al,(0,a.isNullOrUndefined)(this.editorHistory)||(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||"Accept All"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject All"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||(d=!1);!(1===s.offset&&s.offset>e.getParagraphLength(s.paragraph))||s.paragraph.isInsideTable&&(0,a.isNullOrUndefined)(s.paragraph.nextWidget)||(t=!1)}if(!d){e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition);var h=t?1:0;this.deleteSelectedContent(s.paragraph,e,o,s,h,r)}return d},e.prototype.initHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},e.prototype.initComplexHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,e)},e.prototype.insertPicture=function(e,t,i,n,r){var o=this,s=new gd(!0);if(s.width=t,s.height=i,(0,a.isNullOrUndefined)(n)&&""==n||(s.alternateText=n),s.textWrappingStyle="Inline",".svg"===Pa.formatClippedString(e).extension)s.metaFileImageString=e,s.isMetaFile=!0,this.generateFallBackImage(e,t,i,s,r),this.owner.enableCollaborativeEditing||(this.documentHelper.addBase64StringInCollection(s),s.element.src=this.documentHelper.getImageString(s),this.insertPictureInternal(s,r));else if(!(0,a.isNullOrUndefined)(this.documentHelper)){s.imageString=e,s.element.crossOrigin="Anonymous",this.documentHelper.addBase64StringInCollection(s);var l=this.documentHelper.getImageString(s);if(!(0,a.isNullOrUndefined)(l)&&(Pa.startsWith(l,"http://")||Pa.startsWith(l,"https://"))){new URL(l);this.viewer.documentHelper.getBase64(e,t,i).then((function(e){(0,a.isNullOrUndefined)(o.viewer)||(0,a.isNullOrUndefined)(o.viewer.documentHelper)||(o.viewer.documentHelper.images.get(parseInt(s.imageString))[1]=e,s.element.src=e)}))}s.element.src=l,this.insertPictureInternal(s,r)}},e.prototype.generateFallBackImage=function(e,t,i,n,r){var o=this,s=new Image;s.onload=function(){o.isImageInsert&&o.owner.enableCollaborativeEditing&&(o.isRemoteAction=!0);var e=Math.max(1,window.devicePixelRatio||1),a=document.createElement("canvas");a.width=t*e,a.height=i*e;var l=a.getContext("2d");l.scale(e,e),l.drawImage(s,0,0,t,i),o.owner.enableCollaborativeEditing&&(o.documentHelper.addBase64StringInCollection(n),n.element.src=o.documentHelper.getImageString(n),o.insertPictureInternal(n,r,o.isRemoteAction),o.isImageInsert=!1,o.isRemoteAction=!1),o.viewer.documentHelper.images.get(parseInt(n.imageString))[1]=a.toDataURL("image/png",1)},s.src=e,this.isRemoteAction&&this.insertInlineInSelection(this.selection,n)},e.prototype.insertPictureInternal=function(e,t,i){var n=this.documentHelper.selection,r=this.checkAndRemoveComments();if(this.initHistory("InsertInline"),t&&this.fitImageToPage(n,e),this.owner.enableCollaborativeEditing){var s=void 0,a=void 0;e.isMetaFile?(s=this.documentHelper.images.get(parseInt(e.imageString))[1].toString(),a=this.documentHelper.images.get(parseInt(e.metaFileImageString))[0].toString()):s=this.documentHelper.images.get(parseInt(e.imageString)).toString();var l={imageString:s,height:Pa.convertPixelToPoint(e.height),width:Pa.convertPixelToPoint(e.width),metaString:a,alternativeText:e.alternateText};this.editorHistory.currentBaseHistoryInfo.insertedData=l,this.editorHistory.currentBaseHistoryInfo.insertedText=o.Image}i||this.insertInlineInSelection(n,e),this.reLayout(n),this.updateHistoryForComments(r)},e.prototype.fitImageToPage=function(e,t){var i=e.start.paragraph.bodyWidget,n=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin,r=0;if(i instanceof Ol&&i.sectionFormat.columns.length>1){var o=i.columnIndex;r=i.sectionFormat.columns[o].width}else r=Pa.convertPointToPixel(i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin);t.width>r&&(t.height=t.height*r/t.width,t.width=r),t.height>n&&(t.width=t.width*n/t.height,t.height=n)},e.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&this.owner.enableCollaborativeEditing&&(this.editorHistory.currentBaseHistoryInfo.insertedElement=t,t instanceof Bd?this.editorHistory.currentBaseHistoryInfo.insertedText=0==t.commentType?o.Marker_Start:o.Marker_End:t instanceof Yl?(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t))):(t instanceof td||t instanceof vd||t instanceof fd||t instanceof _l||t instanceof Zl&&0==t.removedIds.length)&&(this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t,this.editorHistory.isUndoing)),t instanceof _l&&0===t.fieldType&&(this.editorHistory.currentBaseHistoryInfo.fieldBegin=t))),this.updateInsertPosition(),this.insertInlineInternal(t),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.onPortrait=function(){var e=new ga,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t>i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.onLandscape=function(){var e=new ga,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.copyValues=function(){var e=new ga;return e.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,e.topMargin=this.documentHelper.selection.sectionFormat.topMargin,e.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,e.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,e.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,e.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,e.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,e.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,e},e.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},e.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,n=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===e?i<n?(t.pageWidth=612,t.pageHeight=792):(t.pageWidth=792,t.pageHeight=612):"tabloid"===e?i<n?(t.pageWidth=792,t.pageHeight=1224):(t.pageWidth=1224,t.pageHeight=792):"legal"===e?i<n?(t.pageWidth=612,t.pageHeight=1008):(t.pageWidth=1008,t.pageHeight=612):"statement"===e?i<n?(t.pageWidth=396,t.pageHeight=612):(t.pageWidth=612,t.pageHeight=396):"executive"===e?i<n?(t.pageWidth=522,t.pageHeight=756):(t.pageWidth=756,t.pageHeight=522):"a3"===e?i<n?(t.pageWidth=841.9,t.pageHeight=1190.55):(t.pageWidth=1190.55,t.pageHeight=841.9):"a4"===e?i<n?(t.pageWidth=595.3,t.pageHeight=841.9):(t.pageWidth=841.9,t.pageHeight=595.3):"a5"===e?i<n?(t.pageWidth=419.55,t.pageHeight=595.3):(t.pageWidth=595.3,t.pageHeight=419.55):"b4"===e?i<n?(t.pageWidth=728.5,t.pageHeight=1031.8):(t.pageWidth=1031.8,t.pageHeight=728.5):"b5"===e&&(i<n?(t.pageWidth=515.9,t.pageHeight=728.5):(t.pageWidth=728.5,t.pageHeight=515.9)),this.onApplySectionFormat(void 0,t)},e.prototype.updateListItemsTillEnd=function(e,t){var i=e.getSplitWidgets(),n=i[i.length-1].nextRenderedWidget;if(!(0,a.isNullOrUndefined)(n))for(var r=t?this.documentHelper.selection.getNextRenderedBlock(e):e;!(0,a.isNullOrUndefined)(r)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(r),r=r.getSplitWidgets().pop().nextRenderedWidget},e.prototype.updateWholeListItems=function(e,t,i){this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];e.bodyWidget.index;for(var n,r=0;r<this.documentHelper.pages.length;r++){for(var o=this.documentHelper.pages[r],s=0;s<o.bodyWidgets.length&&(n=this.getNextBlockForList(o.bodyWidgets[s].firstChild),(0,a.isNullOrUndefined)(n));s++);if(!(0,a.isNullOrUndefined)(n))break}do{if(!n)break;var l=null;if(t&&(l={paragraph:null,listId:i}),this.updateListItems(n,e,l)){if(!(0,a.isNullOrUndefined)(l))return l.paragraph==e?null:l.paragraph;break}n=n.getSplitWidgets().pop().nextRenderedWidget,(0,a.isNullOrUndefined)(n)||(n=this.getNextBlockForList(n))}while(n);return null},e.prototype.getNextBlockForList=function(e){if(e instanceof Rl&&this.documentHelper.layout.isFirstElementWithPageBreak(e)){var t=e.nextRenderedWidget;if(!(0,a.isNullOrUndefined)(t)&&t.equals(e))return t}return e},e.prototype.updateListItems=function(e,t,i){return e instanceof Rl?this.updateListItemsForPara(e,t,i):this.updateListItemsForTable(e,t,i)},e.prototype.updateListItemsForTable=function(e,t,i){if((0,a.isNullOrUndefined)(i)&&t instanceof Al&&e.equals(t))return!0;var n=e.firstChild;do{if(this.updateListItemsForRow(n,t,i))return!0;n=n.getSplitWidgets().pop().nextRenderedWidget}while(n);return!1},e.prototype.updateListItemsForRow=function(e,t,i){var n=e.firstChild;do{var r=this.updateListItemsForCell(n,t,i);if(!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(i.paragraph))return!0;if(r)return!0;n=n.nextRenderedWidget}while(n);return!1},e.prototype.updateListItemsForCell=function(e,t,i){if(0===e.childWidgets.length)return!1;var n=e.firstChild;do{var r=this.updateListItems(n,t,i);if(!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(i.paragraph))return!0;if(r)return!0;n=n.getSplitWidgets().pop().nextRenderedWidget}while(n);return!1},e.prototype.updateRenderedListItems=function(e){e instanceof Rl?(e.isEndsWithColumnBreak&&(e=e.nextRenderedWidget),this.updateRenderedListItemsForPara(e)):this.updateRenderedListItemsForTable(e)},e.prototype.updateRenderedListItemsForTable=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForRow=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length){var t=e.firstChild;do{this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)}},e.prototype.updateListItemsForPara=function(e,t,i){if(e.equals(t))return(0,a.isNullOrUndefined)(i)||(i.paragraph=e),!0;var n=void 0,r=0;if(!(0,a.isNullOrUndefined)(e.paragraphFormat)&&!(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat)){if(!(0,a.isNullOrUndefined)(i)&&e.paragraphFormat.listFormat.listId===i.listId)return i.paragraph=e,!0;n=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),r=e.paragraphFormat.listFormat.listLevelNumber}if(!(0,a.isNullOrUndefined)(n)&&!(0,a.isNullOrUndefined)(this.documentHelper.getAbstractListById(n.abstractListId))&&!(0,a.isNullOrUndefined)(this.documentHelper.getAbstractListById(n.abstractListId).levels[r])){var o=this.documentHelper.layout.getListLevel(n,r);this.updateListNumber(o,e,!1)}return!1},e.prototype.updateRenderedListItemsForPara=function(e){if(!(0,a.isNullOrUndefined)(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))){var t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber;if(!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId))&&!(0,a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])){var n=this.documentHelper.layout.getListLevel(t,i);this.updateListNumber(n,e,!0)}}},e.prototype.updateListNumber=function(e,t,i){var n,r=void 0;if(t.childWidgets.length>0){var o=t.childWidgets[0];o.children.length>0&&(r=o.children[0])}if(!(0,a.isNullOrUndefined)(r)&&r.nextElement instanceof md&&(n=r.width+r.nextElement.width),!(0,a.isNullOrUndefined)(r)&&r instanceof md){var s=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat);if(i){var l=r.width;if(r.text=s,this.documentHelper.isIosDevice||this.documentHelper.isLinuxOS){var d=r.text;(d=d===String.fromCharCode(61623)?String.fromCharCode(9679):d===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):d)!==r.text&&(r.text=d)}var h=this.documentHelper.textHelper.getTextSize(r,r.characterFormat);h>l&&(r.width=h),this.documentHelper.textHelper.updateTextSize(r,t),!(0,a.isNullOrUndefined)(n)&&r.width<n&&(r.nextElement.width=n-r.width)}}},e.prototype.getOffsetValue=function(e){if(this.startParagraph){var t=e.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset);e.start.setPositionFromLine(t.line,t.offset)}if(e.start.updatePhysicalPosition(!0),e.isEmpty)e.end.setPositionInternal(e.start);else{if(this.endParagraph){t=e.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset);e.end.setPositionFromLine(t.line,t.offset)}e.end.updatePhysicalPosition(!0)}},e.prototype.setPositionParagraph=function(e,t,i){var n=this.documentHelper.selection,r=n.getLineInfoBasedOnParagraph(e,t);n.start.setPositionFromLine(r.line,r.offset),n.end.setPositionInternal(n.start),i||n.fireSelectionChanged(!0)},e.prototype.setPositionForCurrentIndex=function(e,t){var i=this.selection.getParagraph({index:t}),n=this.selection.getLineInfoBasedOnParagraph(i.paragraph,i.offset);e.setPositionForLineWidget(n.line,n.offset)},e.prototype.insertPageNumber=function(e){var t="PAGE "+(e=(0,a.isNullOrUndefined)(e)?"":" \\*"+e)+" \\* MERGEFORMAT";this.createFields(t)},e.prototype.insertPageCount=function(e){var t="NUMPAGES "+(e=(0,a.isNullOrUndefined)(e)?"":" *"+e)+" * MERGEFORMAT";this.createFields(t)},e.prototype.createFields=function(e){var t=new Rl,i=new zl(t),n=new _l(0);i.children.push(n);var r=new $l;r.fieldBegin=n,r.text="1";var o=new Zl;o.text=e,i.children.push(o);var s=new _l(2);s.fieldBegin=n,n.fieldSeparator=s,i.children.push(s),i.children.push(r);var a=new _l(1);a.fieldBegin=n,a.fieldSeparator=s,s.fieldEnd=a,n.fieldEnd=a,i.children.push(a),n.line=i,t.childWidgets.push(i),this.documentHelper.fields.push(n);var l=new Ol;l.sectionFormat=new ga(l),l.childWidgets.push(t),this.pasteContentsInternal([l],!1)},e.prototype.insertBookmark=function(e,t){if(!(0,a.isNullOrUndefined)(this.owner.optionsPaneModule)&&this.owner.optionsPaneModule.isBuildHeading||!this.selection.isPlainContentControl()){var i=!1;if(this.documentHelper.bookmarks.containsKey(e)){var n=this.documentHelper.bookmarks.get(e);if(i=!0,this.initComplexHistory("InsertBookmark"),this.documentHelper.owner.editorModule.isRemoteAction=!0,this.deleteBookmark(e),this.documentHelper.owner.editorModule.isRemoteAction=!1,(0,a.isNullOrUndefined)(n.reference)||(0,a.isNullOrUndefined)(n.reference.paragraph.associatedCell)){if(!(0,a.isNullOrUndefined)(n.properties)){var r;o=parseInt(n.properties.columnFirst),l=(r=n.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(r.rowIndex,o);!(0,a.isNullOrUndefined)(l)&&l.isRenderBookmarkStart&&(l.isRenderBookmarkStart=!1)}}else if((r=n.reference.paragraph.associatedCell.ownerRow).isRenderBookmarkEnd&&(r.isRenderBookmarkEnd=!1),!(0,a.isNullOrUndefined)(n.properties)){var o=parseInt(n.properties.columnFirst),s=n.paragraph.associatedCell.ownerRow,l=s.getCellUsingColumnIndex(s.rowIndex,o);(0,a.isNullOrUndefined)(l)||(l.isRenderBookmarkStart=!1);for(var d=parseInt(n.properties.columnLast),h=n.reference.paragraph.associatedCell.ownerRow,c=void 0,p=d;(0,a.isNullOrUndefined)(c)&&p>-1;)c=h.getCell(h.rowIndex,p),(0,a.isNullOrUndefined)(c)&&p--;c.isRenderBookmarkEnd&&(c.isRenderBookmarkEnd=!1)}}var u=this.createBookmarkElements(e),g=u[0],m=u[1];if(g.properties=this.selection.getBookmarkProperties(g),m.properties=this.selection.getBookmarkProperties(m),this.owner.isShiftingEnabled=!0,i||this.initComplexHistory("InsertBookmark"),this.insertElements([m],[g],!0,t),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.bookmarks.add(e,g),(0,a.isNullOrUndefined)(g.properties)){this.selection.start.setPositionForSelection(g.line,g,1,this.selection.start.location);var f=0;(0,a.isNullOrUndefined)(m.properties)||m.properties.isAfterParagraphMark&&(this.selection.start.setPositionForSelection(g.line,g,0,this.selection.start.location),f=2),this.selection.end.setPositionForSelection(m.line,m,f,this.selection.end.location);var v=this.documentHelper.blockToShift;if(!(0,a.isNullOrUndefined)(v)&&this.viewer instanceof kl&&v.bodyWidget.sectionFormat.columns.length>1){var y=this.documentHelper.layout.getBodyWidget(v.bodyWidget,!1);(0,a.isNullOrUndefined)(y.nextRenderedWidget)||"NoBreak"!==y.nextRenderedWidget.sectionFormat.breakCode||y.page!==y.nextRenderedWidget.page||this.reLayout(this.selection)}this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0)}else this.selection.selectBookmarkInTable(g),this.documentHelper.owner.isShiftingEnabled=!1;this.fireContentChange(),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars()}},e.prototype.createBookmarkElements=function(e){var t=new td(0);t.name=e;var i=new td(1);return i.name=e,t.reference=i,i.reference=t,[t,i]},e.prototype.deleteBookmark=function(e){var t=this.documentHelper.bookmarks.get(e);if(t instanceof td){var i=t.reference,n=this.selection.start.clone(),r=this.selection.end.clone();this.selection.isForward||(n=this.selection.end.clone(),r=this.selection.start.clone());var s=this.selection.getElementInfo(n.currentWidget,n.offset),l=!1,d=void 0,h=void 0;s.element!==t&&s.element.nextElement===t&&(h=this.selection.getElementInfo(n.currentWidget,n.offset),s=this.selection.getElementInfo(n.currentWidget,n.offset+1),n.offset+=1),s.element===t&&(l=!0,d=this.selection.getElementInfo(n.currentWidget,0===n.offset?n.offset+2:n.offset+1));var c=this.selection.getElementInfo(r.currentWidget,r.offset);c.element===i&&(c=this.selection.getElementInfo(r.currentWidget,r.offset-1)),this.selection.start.setPositionParagraph(t.line,t.line.getOffset(t,t.length)),this.selection.end.setPositionParagraph(i.line,i.line.getOffset(i,i.length)-1),this.initHistory("DeleteBookmark"),this.selection.selectPosition(n,r),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start,this.editorHistory.currentBaseHistoryInfo.markerData.push({bookmarkName:e}),this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(t)),this.deleteBookmarkInternal(t),this.editorHistory&&this.editorHistory.updateHistory(),l&&!(0,a.isNullOrUndefined)(d)&&d.element!==t&&d.element!==i?(this.selection.start.setPositionParagraph(d.element.line,d.element.line.getOffset(d.element,d.index)-1),l=!0):l=!1,c.element!==t&&c.element!==i&&this.selection.end.setPositionParagraph(c.element.line,c.element.line.getOffset(c.element,c.index)),c.element!==t||(0,a.isNullOrUndefined)(d)||d.element!==i||(l||(0,a.isNullOrUndefined)(h)?(0,a.isNullOrUndefined)(h)&&d.element===i&&(n.offset=0===n.offset?n.offset:n.offset-1,this.selection.selectPosition(n,n)):(this.selection.start.setPositionParagraph(h.element.line,h.element.line.getOffset(h.element,h.index)),this.selection.selectPosition(this.selection.start,this.selection.start)))}this.fireContentChange(),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars()},e.prototype.deleteBookmarkInternal=function(e){var t=e.previousNode;if(t instanceof _l&&0===t.fieldType&&!(0,a.isNullOrUndefined)(t.formFieldData)&&(t.formFieldData.name=""),(0,a.isNullOrUndefined)(e.properties)){if(this.documentHelper.selection.isRenderBookmarkAtEnd(e))if(!(0,a.isNullOrUndefined)(e.reference)&&!(0,a.isNullOrUndefined)(e.reference.paragraph.associatedCell))(i=e.reference.paragraph.associatedCell.ownerRow).isRenderBookmarkEnd&&(i.isRenderBookmarkEnd=!1)}else{var i,n=parseInt(e.properties.columnFirst),r=(i=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(i.rowIndex,n);(0,a.isNullOrUndefined)(r)||(r.isRenderBookmarkStart=!1);var o=parseInt(e.properties.columnLast);if(!(0,a.isNullOrUndefined)(e.reference)&&!(0,a.isNullOrUndefined)(e.reference.paragraph.associatedCell)){for(var s=e.reference.paragraph.associatedCell.ownerRow,l=void 0,d=o;(0,a.isNullOrUndefined)(l)&&d>-1;)l=s.getCell(s.rowIndex,d),(0,a.isNullOrUndefined)(l)&&d--;l.isRenderBookmarkEnd&&(l.isRenderBookmarkEnd=!1)}}this.documentHelper.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),(0,a.isNullOrUndefined)(e.reference)||e.reference.line.children.splice(e.reference.indexInOwner,1);var h=e.line.paragraph;if(e.line.paragraph.isInHeaderFooter){var c=void 0;h.containerWidget instanceof Vl?c=h.containerWidget.getContainerTable().containerWidget:h.containerWidget instanceof Bl&&(c=h.containerWidget),this.updateHeaderFooterWidget(c)}},e.prototype.getSelectionInfo=function(e){var t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start),i.offset===this.selection.getLineLength(i.currentWidget)+1&&this.selection.isParagraphLastLine(i.currentWidget)||this.owner.documentHelper.isDragging||(i.offset+=1);var n=this.selection.getParagraphInfo(t),r=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());n=this.selection.getParagraphInfo(i);var o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),s=this.selection.selectedWidgets.keys;if((0,a.isNullOrUndefined)(e)||1!=e||this.selection.hasMergedCells()){if(s[0]instanceof Vl&&t.paragraph.isInsideTable){var l=this.selection.getCellFromSelectionInTable(0);!(0,a.isNullOrUndefined)(l)&&l instanceof Vl&&(r=this.selection.getActualOffset(l,0))}if(s[s.length-1]instanceof Vl&&i.paragraph.isInsideTable){var d=this.selection.getCellFromSelectionInTable(1);!(0,a.isNullOrUndefined)(d)&&d instanceof Vl&&(o=this.selection.getActualOffset(d,1))}}else{if(t.paragraph.isInsideTable){var h=this.selection.getCellFromSelection(0);!(0,a.isNullOrUndefined)(h)&&h instanceof Vl&&(r=this.selection.getActualOffset(h,0))}if(i.paragraph.isInsideTable){var c=this.selection.getCellFromSelection(1);!(0,a.isNullOrUndefined)(c)&&c instanceof Vl&&(o=this.selection.getActualOffset(c,1))}}return{start:r,end:o}},e.prototype.insertElements=function(e,t,i,n){var r=this.getSelectionInfo(i);i&&((0,a.isNullOrUndefined)(t[0].properties)||0!=t[0].bookmarkType||(r=this.owner.selection.updateSelectionInfo(r))),(0,a.isNullOrUndefined)(t)||(this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(r.start),t,void 0,n),this.owner.isSpellCheck&&i&&t[0].previousElement&&t[0].previousElement instanceof Zl&&(t[0].previousElement.ischangeDetected=!0)),(0,a.isNullOrUndefined)(e)||(this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(r.end),e,void 0,n),this.owner.isSpellCheck&&i&&e[0].reference.line!==e[0].line&&e[0].previousElement&&e[0].previousElement instanceof Zl&&(e[0].previousElement.ischangeDetected=!0))},e.prototype.insertElementsInternal=function(e,t,i,n){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&((t[0]instanceof td&&this.editorHistory||t[0]instanceof vd||t[0]instanceof fd||t[0]instanceof id)&&this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(t[0])),t[0]instanceof Zl&&(this.editorHistory.currentBaseHistoryInfo.insertedText=t[0].text,this.setCharFormatForCollaborativeEditing(t[0].characterFormat))),this.updateInsertPosition();var r=0,o=this.selection.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var s=this.selection.start.paragraph;s.childWidgets[0].children.push(t[0]),t[0].line=s.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(s,0,0),this.setPositionParagraph(o.paragraph,o.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(e,e)}else{var l=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,r),d=l.element;r=l.index;var h=t[0];this.insertElementInternal(d,h,r,void 0,!0,n);for(var c=h.indexInOwner,p=h,u=1;u<t.length;u++)p=t[u],h.line.children.splice(c+u,0,p);e.setPositionForSelection(p.line,p,p.length,this.selection.start.location),this.selection.selectPosition(e,e)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},e.prototype.getMarkerData=function(e,t,i,n){var r={};if(this.editorHistory.currentBaseHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing)if(e instanceof td){var s="",l="",d=void 0,h=void 0,c=void 0,p=void 0;0==e.bookmarkType?(this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start),(0,a.isNullOrUndefined)(e.properties)||(s=e.properties.columnFirst,l=e.properties.columnLast)):(this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_End),(0,a.isNullOrUndefined)(e.properties)||(d=e.properties.isAfterParagraphMark,h=e.properties.isAfterTableMark,c=e.properties.isAfterRowMark,p=e.properties.isAfterCellMark)),r={bookmarkName:e.name,type:"Bookmark",skipOperation:t,columnFirst:s,columnLast:l,isAfterParagraphMark:d,isAfterTableMark:h,isAfterRowMark:c,isAfterCellMark:p}}else if(e instanceof vd||e instanceof fd){var u=void 0;e instanceof vd?(u=e,this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start)):(u=e.editRangeStart,this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_End)),r={user:""===u.user?u.group:u.user,type:"EditRange",editRangeId:u.editRangeId,skipOperation:t,columnFirst:(0,a.isNullOrUndefined)(u.columnFirst)?void 0:u.columnFirst.toString(),columnLast:(0,a.isNullOrUndefined)(u.columnLast)?void 0:u.columnLast.toString()}}else e instanceof _l?(0==e.fieldType?this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start:2==e.fieldType?this.editorHistory.currentBaseHistoryInfo.insertedText=o.Field_Separator:this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_End,r={type:"Field"}):e instanceof Yl?r={type:e.footnoteType}:e instanceof Zl?this.editorHistory.currentBaseHistoryInfo.insertedText=e.text:e instanceof id&&(r={type:"ContentControl",text:e.contentControlWidgetType},0==e.type?((0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_Start),r.contentControlProperties=JSON.stringify(this.getContentControlPropObject(e.contentControlProperties))):(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedText=o.Marker_End));return(0,a.isNullOrUndefined)(i)||(r=this.getRevisionMarkerData(r,i,t,n)),r},e.prototype.getRevisionMarkerData=function(e,t,i,n){return(0,a.isNullOrUndefined)(e)&&(e={}),e.revisionId=t.revisionID,e.revisionType=t.revisionType,e.author=t.author,e.date=t.date,e.skipOperation=i,e.isAcceptOrReject=n,e},e.prototype.getCommentElementBox=function(e){var t=e.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];return t.length>2&&""!==t[2]?i.replyComments[parseInt(t[2],10)]:i},e.prototype.getBlock=function(e){var t=this.selection.getBodyWidget(e);return this.getBlockInternal(t,e)},e.prototype.getBlockInternal=function(e,t){if(""!==t.index&&!(0,a.isNullOrUndefined)(t)){var i=t.index.indexOf(";"),n=t.index.substring(0,i);t.index=t.index.substring(i).replace(";","");var r=e;i=parseInt(n,10);var o=this.selection.getBlockByIndex(e,i);if(!o)return{node:r,position:t};var s=o;if(!(t.index.indexOf(";")>=0))return{node:s,position:t};if(s instanceof Rl)return t.index.indexOf(";")>=0&&(t.index="0"),{node:s,position:t};if(s instanceof Nl){var l=this.getBlockInternal(s,t);return{node:(0,a.isNullOrUndefined)(l)?void 0:l.node,position:(0,a.isNullOrUndefined)(l)?void 0:l.position}}return{node:r,position:t}}},e.prototype.updateHistoryPosition=function(e,t){if(this.editorHistory&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)){var i=void 0;if(e instanceof ac){var n=this.selection.getParagraphInfo(e);i=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}else i=e;t?this.editorHistory.currentBaseHistoryInfo.insertPosition=i:this.editorHistory.currentBaseHistoryInfo.endPosition=i}},e.prototype.applyBorders=function(e){this.initHistory("Borders");var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start,n=t.paragraph.associatedCell.ownerTable;if(n=n.combineWidget(this.owner.viewer),this.editorHistory)this.cloneTableToHistoryInfo(n);t.paragraph.associatedCell;var r,o=i.paragraph.associatedCell,s=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if((0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(this.editorHistory.currentBaseHistoryInfo.insertedFormat=t.paragraph.associatedCell.cellFormat.borders),this.documentHelper.selection.isTableSelected())"TopBorder"!==e.type&&"OutsideBorders"!==e.type&&"AllBorders"!==e.type||n.tableFormat.borders.top.copyFormat(s),"BottomBorder"!==e.type&&"OutsideBorders"!==e.type&&"AllBorders"!==e.type||n.tableFormat.borders.bottom.copyFormat(s),"LeftBorder"!==e.type&&"OutsideBorders"!==e.type&&"AllBorders"!==e.type||n.tableFormat.borders.left.copyFormat(s),"RightBorder"!==e.type&&"OutsideBorders"!==e.type&&"AllBorders"!==e.type||n.tableFormat.borders.right.copyFormat(s),"InsideHorizontalBorder"!==e.type&&"AllBorders"!==e.type&&"InsideBorders"!==e.type||n.tableFormat.borders.horizontal.copyFormat(s),"InsideVerticalBorder"!==e.type&&"AllBorders"!==e.type&&"InsideBorders"!==e.type||n.tableFormat.borders.vertical.copyFormat(s);else{if(this.selection.isEmpty)"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"LeftBorder"!==e.type||o.cellFormat.borders.left.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"TopBorder"!==e.type||o.cellFormat.borders.top.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"RightBorder"!==e.type||o.cellFormat.borders.right.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"BottomBorder"!==e.type||o.cellFormat.borders.bottom.copyFormat(s),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type||o.cellFormat.borders.vertical.copyFormat(s),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideHorizontalBorder"!==e.type||o.cellFormat.borders.horizontal.copyFormat(s),"NoBorder"===e.type&&this.clearAllBorderValues(o.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var l=this.getTopBorderCellsOnSelection(),d=0;d<l.length;d++)l[d].cellFormat.borders.top.copyFormat(s);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(l=this.getLeftBorderCellsOnSelection(),d=0;d<l.length;d++)l[d].cellFormat.borders.left.copyFormat(s);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(l=this.getRightBorderCellsOnSelection(),d=0;d<l.length;d++)l[d].cellFormat.borders.right.copyFormat(s);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(l=this.getBottomBorderCellsOnSelection(),d=0;d<l.length;d++)l[d].cellFormat.borders.bottom.copyFormat(s)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type){r=this.getAdjacentCellToApplyBottomBorder();for(d=0;d<r.length;d++){var h=r[d];"NoBorder"===e.type?h.cellFormat.borders.top.copyFormat(this.clearBorder()):h.cellFormat.borders.top.copyFormat(s)}}if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type){r=this.getAdjacentCellToApplyRightBorder();for(d=0;d<r.length;d++){h=r[d];"NoBorder"===e.type?h.cellFormat.borders.left.copyFormat(this.clearBorder()):h.cellFormat.borders.left.copyFormat(s)}}"AllBorders"!==e.type&&"NoBorder"!==e.type||this.applyAllBorders(s,e.type),"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type&&"InsideHorizontalBorder"!==e.type&&"NoBorder"!==e.type||this.applyInsideBorders(s,e.type,n)}this.updateGridForTableDialog(n,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},e.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),n=0;n<i.length;n++)"NoBorder"===t?(i[n].cellFormat.borders.left.copyFormat(this.clearBorder()),i[n].cellFormat.borders.right.copyFormat(this.clearBorder()),i[n].cellFormat.borders.top.copyFormat(this.clearBorder()),i[n].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[n].cellFormat.borders.left.copyFormat(e),i[n].cellFormat.borders.right.copyFormat(e),i[n].cellFormat.borders.top.copyFormat(e),i[n].cellFormat.borders.bottom.copyFormat(e))},e.prototype.applyInsideBorders=function(e,t,i){for(var n=this.selection.getSelectedCells(),r=0;r<n.length;r++){var o=n[r],s=o.ownerRow===n[n.length-1].ownerRow,a=o.columnIndex+o.cellFormat.columnSpan-1===n[n.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(a||"InsideHorizontalBorder"===t||o.cellFormat.borders.right.copyFormat(e),s||"InsideVerticalBorder"===t||o.cellFormat.borders.bottom.copyFormat(e)),!s&&"InsideVerticalBorder"!==t){var l=o.ownerRow.rowIndex+o.cellFormat.rowSpan,d=i.childWidgets[l];if(d)for(var h=this.getAdjacentBottomBorderOnEmptyCells(d,o,!0),c=0;c<h.length;c++)"NoBorder"===t?h[c].cellFormat.borders.top.copyFormat(this.clearBorder()):h[c].cellFormat.borders.top.copyFormat(e)}if(!a&&"InsideHorizontalBorder"!==t)for(var p=this.getSelectedCellsNextWidgets(o,i),u=0;u<p.length;u++)"NoBorder"===t?p[u].cellFormat.borders.left.copyFormat(this.clearBorder()):p[u].cellFormat.borders.left.copyFormat(e)}},e.prototype.getTopBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=[],i=this.selection.getSelectedCells(),n=0;n<i.length;n++)i[n].ownerRow===e.ownerRow&&t.push(i[n]);return t},e.prototype.getLeftBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],n=0;n<t.length;n++)t[n].columnIndex===e.columnIndex&&i.push(t[n]);return i},e.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},e.prototype.getBottomBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],n=0;n<t.length;n++)t[n].ownerRow===e.ownerRow&&i.push(t[n]);return i},e.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},e.prototype.clearBorder=function(){var e=new fa;return e.lineStyle="Cleared",e},e.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=t.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer);var r=t.paragraph.associatedCell,o=i.paragraph.associatedCell,s=o.ownerRow.rowIndex+o.cellFormat.rowSpan,a=n.childWidgets[s];if(a)if(o.cellFormat.columnSpan>1)for(var l=o.columnIndex;l<o.columnIndex+o.cellFormat.columnSpan;l++)a.childWidgets[l]&&e.push(a.childWidgets[l]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(a,o),!this.selection.isEmpty)for(l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l].columnIndex;d>=r.columnIndex&&d<=o.columnIndex&&a.childWidgets[l]&&e.push(a.childWidgets[l])}return e},e.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var n=[];if(t.cellFormat.columnSpan>1)for(var r=t.columnIndex;r<t.columnIndex;r++)n.push(e.childWidgets[r]);else if(this.selection.isEmpty||i)for(r=0;r<e.childWidgets.length;r++)e.childWidgets[r].columnIndex===t.columnIndex&&n.push(e.childWidgets[r]);return n},e.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var n=t.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer);t.paragraph.associatedCell,i.paragraph.associatedCell;if(this.selection.isEmpty){var r=t.paragraph.associatedCell;e=this.getSelectedCellsNextWidgets(r,n)}else for(var o=this.getRightBorderCellsOnSelection(),s=0;s<o.length;s++){var a=o[s];e=e.concat(this.getSelectedCellsNextWidgets(a,n))}return e},e.prototype.getSelectedCellsNextWidgets=function(e,t){var i=[];if(!(0,a.isNullOrUndefined)(e.nextWidget)&&(i.push(e.nextWidget),e.cellFormat.rowSpan>1))for(var n=e.ownerRow.rowIndex+e.cellFormat.rowSpan,r=e.ownerRow.rowIndex+1;r<n;r++){var o=t.childWidgets[r];if(o)for(var s=0;s<o.childWidgets.length;s++)o.childWidgets[s].columnIndex===e.nextWidget.columnIndex&&i.push(o.childWidgets[s])}return i},e.prototype.getBorder=function(e,t,i){var n=new fa;return n.color=e||"#000000",n.lineWidth=t||1,n.lineStyle=i||"Single",n},e.prototype.applyBordersInternal=function(e,t){(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e.top)||this.applyBorder(e.top,t.top),(0,a.isNullOrUndefined)(e.bottom)||this.applyBorder(e.bottom,t.bottom),(0,a.isNullOrUndefined)(e.left)||this.applyBorder(e.left,t.left),(0,a.isNullOrUndefined)(e.right)||this.applyBorder(e.right,t.right),(0,a.isNullOrUndefined)(e.horizontal)||this.applyBorder(e.horizontal,t.horizontal),(0,a.isNullOrUndefined)(e.vertical)||this.applyBorder(e.vertical,t.vertical),(0,a.isNullOrUndefined)(e.diagonalUp)||this.applyBorder(e.diagonalUp,t.diagonalUp),(0,a.isNullOrUndefined)(e.diagonalDown)||this.applyBorder(e.diagonalDown,t.diagonalDown))},e.prototype.applyShading=function(e,t){(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(t.backgroundColor)||e.backgroundColor===t.backgroundColor||(e.backgroundColor=t.backgroundColor),(0,a.isNullOrUndefined)(t.foregroundColor)||e.foregroundColor===t.foregroundColor||(e.foregroundColor=t.foregroundColor),(0,a.isNullOrUndefined)(t.textureStyle)||e.textureStyle===t.textureStyle||(e.textureStyle=t.textureStyle))},e.prototype.applyBorder=function(e,t){(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(t)||((0,a.isNullOrUndefined)(t.color)||e.color===t.color||(e.color=t.color),(0,a.isNullOrUndefined)(t.lineStyle)||e.lineStyle===t.lineStyle||(e.lineStyle=t.lineStyle),(0,a.isNullOrUndefined)(t.lineWidth)||e.lineWidth===t.lineWidth||(e.lineWidth=t.lineWidth),(0,a.isNullOrUndefined)(t.shadow)||e.shadow===t.shadow||(e.shadow=t.shadow),(0,a.isNullOrUndefined)(t.space)||e.space===t.space||(e.space=t.space))},e.prototype.onTableFormat=function(e,t,i){if(!(0,a.isNullOrUndefined)(this.selection.tableFormat)){if((0,a.isNullOrUndefined)(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat"),(0,a.isNullOrUndefined)(i)&&(i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer)),t)for(var n=0;n<i.childWidgets.length;n++)for(var r=i.childWidgets[n],o=0;o<r.childWidgets.length;o++){r.childWidgets[o].cellFormat.shading.copyFormat(e.shading)}this.applyTableFormat(i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(void 0,i,e)},e.prototype.applyTablePropertyValue=function(e,t,i){var n=i.tableFormat;!(0,a.isNullOrUndefined)(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&(t=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(n,e,t),this.editorHistory.currentBaseHistoryInfo.insertedFormat=t),t instanceof Ra?(0,a.isNullOrUndefined)(e)&&this.handleTableFormat(n,t):("preferredWidth"===e?n.preferredWidth=t:"leftIndent"===e?n.leftIndent=t:"tableAlignment"===e?n.tableAlignment=t:"cellSpacing"===e?n.cellSpacing=t:"leftMargin"===e?n.leftMargin=t:"rightMargin"===e?n.rightMargin=t:"topMargin"===e?n.topMargin=t:"bottomMargin"===e?n.bottomMargin=t:"preferredWidthType"===e?n.preferredWidthType=t:"bidi"===e?n.bidi=t:"title"===e?n.title=t:"description"===e&&(n.description=t),"shading"===e?n.shading=t:"borders"===e&&(n.borders=t))},e.prototype.handleTableFormat=function(e,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&((0,a.isNullOrUndefined)(e.borders)||this.applyBordersInternal(e.borders,t.borders),(0,a.isNullOrUndefined)(e.shading)||this.applyShading(e.shading,t.shading)),this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==e.bidi&&(e.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(e.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==e.tableAlignment&&(e.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==e.leftIndent&&(e.leftIndent=t.leftIndent)),this.updateGridForTableDialog(e.ownerBase,!1),t.title!==e.title&&(e.title=t.title),t.description!==e.description&&(e.description=t.description)},e.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.isGridUpdated=!1),this.documentHelper.layout.reLayoutTable(e)},e.prototype.onRowFormat=function(e){if(!(0,a.isNullOrUndefined)(this.selection)&&!(0,a.isNullOrUndefined)(e)){this.editorHistory.initializeHistory("RowFormat"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start;t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyRowFormat=function(e,t,i,n,r){if(this.applyRowPropertyValue(this.documentHelper.selection,n,r,e),i.paragraph.associatedCell.ownerRow!==e){var o=e.nextWidget;(0,a.isNullOrUndefined)(o)||this.applyRowFormat(o,t,i,n,r)}},e.prototype.applyRowPropertyValue=function(e,t,i,n){var r=n.rowFormat;(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(r,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof Ca?(0,a.isNullOrUndefined)(t)&&this.handleRowFormat(i,r):("heightType"===t?r.heightType=i:"height"===t?r.height=i:"isHeader"===t?r.isHeader=i:"allowBreakAcrossPages"===t&&(r.allowBreakAcrossPages=i),(0,a.isNullOrUndefined)(n.ownerTable)||this.layoutItemBlock(n.ownerTable,!0))},e.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},e.prototype.onCellFormat=function(e){(0,a.isNullOrUndefined)(this.selection)||(0,a.isNullOrUndefined)(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},e.prototype.onParaFormat=function(e){(0,a.isNullOrUndefined)(this.selection)||(0,a.isNullOrUndefined)(e)||(this.editorHistory.initializeHistory("ParagraphFormat"),this.updateParagraphFormat(void 0,e,!1),this.reLayout(this.selection,!1))},e.prototype.updateCellMargins=function(e,t){var i=e.start,n=e.end;e.isForward||(i=e.end,n=e.start),this.initHistoryPosition(e,i),this.documentHelper.owner.cellOptionsDialogModule.applyCellMarginValue(i.paragraph.associatedCell.ownerRow,i,n,t)},e.prototype.updateFormatForCell=function(e,t,i){var n=e.start,r=e.end;e.isForward||(n=e.end,r=e.start);for(var o,s=n.paragraph.associatedCell,a=r.paragraph.associatedCell,l=s.ownerTable.combineWidget(this.owner.viewer),d=s.columnIndex;d<=a.columnIndex;d++){o=this.getSelectedCellInColumn(s.ownerTable,s.ownerRow.rowIndex,d,a.ownerRow.rowIndex);for(var h=0;h<o.length;h++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,o[h].cellFormat)}this.updateGridForTableDialog(l,!1)},e.prototype.getSelectedCellInColumn=function(e,t,i,n){for(var r=[],o=t;o<=n;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)s.childWidgets[a].columnIndex===i&&r.push(s.childWidgets[a]);return r},e.prototype.getColumnCells=function(e,t,i){for(var n=[],r=0;r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];i?a.columnIndex+a.cellFormat.columnSpan===t&&n.push(a):a.columnIndex===t&&n.push(a)}return n},e.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:Pa.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:Pa.convertPixelToPoint(this.documentHelper.layout.getTableWidth(e))},e.prototype.applyCellPropertyValue=function(e,t,i,n){if((0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(n,t,i),this.editorHistory.currentBaseHistoryInfo.insertedFormat=i),i instanceof Ma)return(0,a.isNullOrUndefined)(t)&&this.handleCellFormat(i,n),i;"leftMargin"===t?n.leftMargin=i:"topMargin"===t?n.topMargin=i:"rightMargin"===t?n.rightMargin=i:"bottomMargin"===t?n.bottomMargin=i:"preferredWidth"===t?(n.preferredWidth=i,n.cellWidth=i):"cellWidth"===t?n.cellWidth=i:"columnSpan"===t?n.columnSpan=i:"rowSpan"===t?n.rowSpan=i:"preferredWidthType"===t?n.preferredWidthType=i:"verticalAlignment"===t&&(n.verticalAlignment=i),"shading"===t?n.shading=i:"borders"===t&&(n.borders=i)},e.prototype.handleCellFormat=function(e,t){(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(t)||(this.isBordersAndShadingDialog?((0,a.isNullOrUndefined)(e.borders)||this.applyBordersInternal(t.borders,e.borders),(0,a.isNullOrUndefined)(e.shading)||this.applyShading(t.shading,e.shading)):(e.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(t.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(t.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&t.verticalAlignment!==e.verticalAlignment&&(t.verticalAlignment=e.verticalAlignment)))},e.prototype.destroy=function(){this.tableResize&&(this.tableResize.destroy(),this.tableResize=void 0),this.previousCharFormat&&(this.previousCharFormat.destroy(),this.previousCharFormat=void 0),this.previousParaFormat&&(this.previousParaFormat.destroy(),this.previousParaFormat=void 0),this.alertDialog&&this.alertDialog.destroy(),this.alertDialog=void 0,this.base64&&this.base64.destroy(),this.base64=void 0,this.endParagraph=void 0,this.copiedData=void 0,this.copiedTextContent=void 0,this.listNumberFormat=void 0,this.nodes=[],this.removedTextNodes=[],this.removedBookmarkElements=[],this.editStartRangeCollection=[],this.documentHelper=void 0,this.editRangeID=void 0,this.isCellFormatApplied=void 0,this.removedContentControlElements=[]},e.prototype.updateToc=function(e){if((0,a.isNullOrUndefined)(e)&&(e=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(e)){var t=this.selection.getFieldCode(e);-1!==t.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,e)))}},e.prototype.getTocSettings=function(e,t){var i={includePageNumber:!0,rightAlign:!0};if("toc \\mergeformat"===e.toLowerCase())i.startLevel=1,i.endLevel=3;else for(var n=e.split("\\"),r=0;r<n.length;r++){var o=n[r];if(0!==o.length)switch(o[0]){case"o":if((0,a.isNullOrUndefined)(o.match(/\d+/g)))i.startLevel=1,i.endLevel=9;else{var s=o.match(/\d+/g).map(Number);i.startLevel=s[0],i.endLevel=s[1]}break;case"h":i.includeHyperlink=!0;break;case"n":i.includePageNumber=!1;break;case"p":i.rightAlign=!1;break;case"u":i.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(i,o)}}var l=t.paragraph.paragraphFormat.getUpdatedTabs();return l.length>0&&(i.tabLeader=l[l.length-1].tabLeader),i.rightAlign&&(0,a.isNullOrUndefined)(i.tabLeader)&&(i.tabLeader="Dot"),i},e.prototype.decodeTSwitch=function(e,t){e.levelSettings={};for(var i=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),n=0;n<i.length;n++)e.levelSettings[i[n]]=parseInt(i[n+1],10),n++},e.prototype.insertTableOfContents=function(e){if(!this.selection.isPlainContentControl()){this.isInsertingTOC=!0;var t=this.checkAndRemoveComments();this.initComplexHistory("TOC"),(0,a.isNullOrUndefined)(e)&&((e={}).startLevel=1,e.endLevel=3,e.includeHyperlink=!0,e.includeOutlineLevels=!0,e.includePageNumber=!0,e.rightAlign=!0,e.tabLeader="Dot");var i,n=void 0;if("TableOfContents"===this.selection.contextType&&(n=this.selection.getTocFieldInternal()),n instanceof _l){this.selection.start.setPositionForSelection(n.line,n,0,this.selection.start.location);var r=2,o=n.fieldEnd.paragraph,s=o.nextWidget;(o===o.bodyWidget.lastChild||s instanceof Rl&&s.isSectionBreak)&&r--,this.selection.end.setPositionForSelection(n.fieldEnd.line,n.fieldEnd,r,this.selection.end.location),this.delete()}i=this.constructTocFieldCode(e);var l=this.selection.start.isAtParagraphStart,d=this.selection.getParagraphInfo(this.selection.start),h=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString()),c=this.buildToc(this.validateTocSettings(e),i,!0,l);if(c.length>0){var p=new Rl,u=new zl(p);p.childWidgets.push(u);var g=0;l||(g=1);var m=c[g].childWidgets[0].children[0];this.appendEndField(m,u),c.push(p),this.appendEmptyPara(c)}else{var f=new a.L10n("documenteditor",this.owner.defaultLocale);f.setLocale(this.owner.locale),el.DialogUtility.alert({title:f.getConstant("No Headings"),content:f.getConstant("Add Headings"),showCloseIcon:!0,closeOnEscape:!0,position:{X:"center",Y:"center"},animationSettings:{effect:"Zoom"}}).enableRtl=this.owner.enableRtl}this.setPositionForCurrentIndex(this.selection.start,h),this.selection.end.setPositionInternal(this.selection.start);var v=new Ol;v.sectionFormat=new ga(v),v.childWidgets=c,this.pasteContentsInternal([v],!1),this.updatePageRef(),this.isInsertingTOC=!1,this.editorHistory&&(this.editorHistory.updateComplexHistory(),this.updateHistoryForComments(t)),0===c.length&&(this.owner.editorHistoryModule.undo(),this.owner.editorHistoryModule.redoStack.pop())}},e.prototype.appendEmptyPara=function(e){var t=new Rl,i=new zl(t);t.childWidgets.push(i),e.push(t)},e.prototype.constructTocFieldCode=function(e){var t="TOC";(0,a.isNullOrUndefined)(e.startLevel)||0===e.startLevel||(0,a.isNullOrUndefined)(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u");var i=this.constructTSwitch(e);return i.length>6&&(t+=i),t},e.prototype.constructTSwitch=function(e){var t="";if(!(0,a.isNullOrUndefined)(e.levelSettings))for(var i=0,n=Object.keys(e.levelSettings);i<n.length;i++){var r=n[i];t=t+r+","+e.levelSettings[r].toString()+","}return t=' \\t "'+(t=t.slice(0,-1))+'"'},e.prototype.appendEndField=function(e,t){var i=new _l(1);if(i.fieldSeparator=e.fieldSeparator,e.fieldSeparator.fieldEnd=i,i.fieldBegin=e,i.fieldBegin.fieldEnd=i,i.line=t,e.revisions.length>0){var n=e.revisions[e.revisions.length-1];n.range.push(i),this.owner.trackChangesPane.updateCurrentTrackChanges(n),i.revisions.push(n)}t.children.push(i)},e.prototype.validateTocSettings=function(e){return((0,a.isNullOrUndefined)(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),((0,a.isNullOrUndefined)(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),(0,a.isNullOrUndefined)(e.includeHyperlink)&&(e.includeHyperlink=!1),(0,a.isNullOrUndefined)(e.includePageNumber)&&(e.includePageNumber=!1),(0,a.isNullOrUndefined)(e.rightAlign)&&(e.rightAlign=!1),(0,a.isNullOrUndefined)(e.levelSettings)&&(e.levelSettings={}),e},e.prototype.buildToc=function(e,t,i,n,r){var o=this.documentHelper.pages[0].bodyWidgets[0],s=[];this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e);var l=this.selection.start.paragraph.bodyWidget.sectionFormat,d=o.childWidgets[0];for(!(0,a.isNullOrUndefined)(this.owner.optionsPaneModule)&&this.owner.optionsPaneModule.isHeadingTab&&(this.owner.optionsPaneModule.isBuildHeading=!0);void 0!==d;){if(d instanceof Rl&&(!r||!d.isInsideTable)&&(this.isHeadingStyle(d)||e.includeOutlineLevels&&this.isOutlineLevelStyle(d))){var h=this.insertTocBookmark(d,r);(0,a.isNullOrUndefined)(h)||(this.createTOCWidgets(d,s,t,h,e,i,n,l,r),i=!1)}d=this.selection.getNextParagraphBlock(d.getSplitWidgets().pop())}return this.tocStyles={},!(0,a.isNullOrUndefined)(this.owner.optionsPaneModule)&&this.owner.optionsPaneModule.isHeadingTab&&(this.owner.optionsPaneModule.isBuildHeading=!1),s},e.prototype.createOutlineLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Level"+t.toString();(0,a.isNullOrUndefined)(this.tocStyles[i])&&(this.tocStyles[i]=t)}},e.prototype.createHeadingLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Heading "+t.toString();(0,a.isNullOrUndefined)(this.tocStyles[i])&&(this.tocStyles[i]=t)}if(!(0,a.isNullOrUndefined)(e.levelSettings))for(var n=0,r=Object.keys(e.levelSettings);n<r.length;n++){var o=r[n];this.tocStyles[o]=e.levelSettings[o]}},e.prototype.isHeadingStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&!(0,a.isNullOrUndefined)(this.tocStyles[t.name])},e.prototype.isOutlineLevelStyle=function(e){var t=e.paragraphFormat.outlineLevel;return!(0,a.isNullOrUndefined)(this.tocStyles[t])},e.prototype.createTocFieldElement=function(e,t,i){var n=new _l(0);n.hasFieldEnd=!0,n.line=e,e.children.push(n);var r=new Zl;r.text=t,r.line=e,e.children.push(r);var o=new _l(2);return o.fieldBegin=n,o.fieldBegin.fieldSeparator=o,o.line=e,e.children.push(o),n},e.prototype.createTOCWidgets=function(e,t,i,n,r,o,s,l,d){var h=void 0,c=void 0,p=void 0,u=!1;if(1!==t.length||3!==t[0].childWidgets[0].children.length||(0,a.isNullOrUndefined)(o)||o){c=new Rl;var g=void 0,m=e.paragraphFormat.baseStyle.name;g=r.includeOutlineLevels&&(0,a.isNullOrUndefined)(this.tocStyles[m])?e.paragraphFormat.outlineLevel:m;var f="TOC "+this.tocStyles[g],v="Heading "+this.tocStyles[g],y=void 0;if(d?(y=this.documentHelper.styles.findByName(v,"Paragraph"),(0,a.isNullOrUndefined)(y)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(v)),this.documentHelper.styles,!0),y=this.documentHelper.styles.findByName(v,"Paragraph"))):(y=this.documentHelper.styles.findByName(f,"Paragraph"),(0,a.isNullOrUndefined)(y)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(f)),this.documentHelper.styles,!0),y=this.documentHelper.styles.findByName(f,"Paragraph"))),c.paragraphFormat.applyStyle(y),r.rightAlign&&r.includePageNumber){var w=new wa;w.position=l.pageWidth-(l.leftMargin+l.rightMargin),w.tabLeader=r.tabLeader,w.deletePosition=0,w.tabJustification="Right",c.paragraphFormat.tabs.push(w)}p=new zl(c),c.childWidgets.push(p)}else p=t[0].childWidgets[0];void 0!==o&&o&&((0,a.isNullOrUndefined)(s)||s||(this.appendEmptyPara(t),u=!0),this.createTocFieldElement(p,i));for(var b="",C=!1,x=e;x instanceof Rl;){for(var I=0;I<x.childWidgets.length;I++)for(var k=x.childWidgets[I],F=0;F<k.children.length;F++){var P=k.children[F];if(!P.isPageBreak&&!P.isColumnBreak)if(P instanceof _l||P instanceof td||C)P instanceof _l&&(0===P.fieldType?C=!0:2===P.fieldType&&(C=!1));else if(P instanceof Zl||P instanceof md){var S=P.text;-1!==S.indexOf("\t")&&(S=S.replace(new RegExp("\t","g")," ")),b+=S}}x=x.nextSplitWidget}if(""!==b){if(r.includeHyperlink&&void 0!==n)h=this.insertTocHyperlink(p,n,b,e);else{var T=new Zl;T.text=b,T.line=p,p.children.push(T)}if(r.includePageNumber&&void 0!==n){if(r.rightAlign){var H=new ed;H.text="\t",H.line=p,p.children.push(H)}var E=this.insertTocPageNumber(n,p,r.rightAlign,e);this.appendEndField(E,p)}r.includeHyperlink&&void 0!==h&&this.appendEndField(h,p)}if(!(0,a.isNullOrUndefined)(c)&&(""!==b||o)&&(t.push(c),!d&&this.owner.enableTrackChanges&&!(0,a.isNullOrUndefined)(c)))if(1===t.length||u)this.insertRevisionForBlock(c,"Insertion",!0);else{var N=this.owner.revisionsInternal.changes[0];this.insertRevisionForBlock(c,"Insertion",!0,N)}},e.prototype.insertTocHyperlink=function(e,t,i,n){var r=' HYPERLINK \\l "'+t+'" ',o=this.createTocFieldElement(e,r,!0),s=new Zl;s.text=i;var a=n.paragraphFormat.baseStyle.name;if(this.documentHelper.styles.findByName(a,"Paragraph").characterFormat.isEqualTocFormat(n.characterFormat)){var l=this.documentHelper.styles.findByName("Normal","Paragraph");s.characterFormat.copyTocFormat(l.characterFormat)}else s.characterFormat.copyTocFormat(n.characterFormat);return s.line=e,e.children.push(s),o},e.prototype.getPageNumber=function(e){return e.bodyWidget.sectionFormat.restartPageNumbering?e.bodyWidget.page.currentPageNum:this.documentHelper.pages.indexOf(e.bodyWidget.page)+1},e.prototype.insertTocPageNumber=function(e,t,i,n){var r=" PAGEREF"+e+" \\h ",o=this.createTocFieldElement(t,r,!0),s=this.getPageNumber(n).toString(),a=new $l;return a.fieldBegin=o,i||(s=" "+s),a.text=s,a.line=t,t.children.push(a),this.pageRefFields[e]=a,o},e.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var i=t[e];if(this.documentHelper.bookmarks.containsKey(i)){var n=this.documentHelper.bookmarks.get(i),r=this.getPageNumber(n.paragraph).toString(),o=this.pageRefFields[i];if(r!==o.text){o.isWidthUpdated=!1,o.text=r;var s=o.paragraph,l=s.childWidgets.indexOf(o.line),d=o.line.children.indexOf(o);(0,a.isNullOrUndefined)(s.containerWidget)||this.documentHelper.layout.reLayoutParagraph(s,l,d)}}}},e.prototype.insertTocBookmark=function(e,t){var i=void 0;if(e.childWidgets.length>0){var n=e.getSplitWidgets(),r=n[0],o=n.pop(),s=r.childWidgets[0],l=o.childWidgets[o.childWidgets.length-1];if(void 0!==s&&void 0!==l){var d=s.children[0];if(d instanceof md||d instanceof Bd)do{d=d.nextNode}while(d instanceof md||d instanceof Bd);if(!(0,a.isNullOrUndefined)(d)&&d instanceof td&&0===d.bookmarkType&&d.name.toLowerCase().match("^_toc"))return d.name;var h=l.children[l.children.length-1];void 0===d||void 0===h||this.isRemoteAction||(this.selection.start.setPositionForSelection(s,d,0,this.selection.start.location),this.selection.end.setPositionForSelection(l,h,h.length,this.selection.end.location),i=this.generateBookmarkName(),this.insertBookmark(i,t))}}return i},e.prototype.generateBookmarkName=function(){var e="";do{this.tocBookmarkId++;for(var t=10-this.tocBookmarkId.toString().length,i="";t-1>0;)i="0"+i,t--;e="_Toc"+i+this.tocBookmarkId}while(this.documentHelper.bookmarks.containsKey(e));return e},e.prototype.onCellContentAlignment=function(e,t){this.owner.isShiftingEnabled=!0;var i=this.owner.selectionModule;if(i.isEmpty&&i.start.paragraph.isInsideTable){this.owner.editorHistoryModule&&this.owner.editorHistoryModule.initComplexHistory(i,"MultiSelection"),i.selectTableCell(),this.initHistory("CellContentVerticalAlignment");var n=i.start.paragraph.associatedCell.cellFormat;this.applyCellPropertyValue(i,"verticalAlignment",e,n),this.reLayout(i,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selectionModule,!1),this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateComplexHistory()}else this.owner.editorHistoryModule&&this.owner.editorHistoryModule.initComplexHistory(i,"MultiSelection"),(0,a.isNullOrUndefined)(i.getTable(i.start,i.end))||(this.updateSelectionTableFormat(i,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selectionModule,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(i,!1)),this.owner.editorHistoryModule&&this.owner.editorHistoryModule.updateComplexHistory()},e.prototype.insertEditRangeElement=function(e){if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0;var t=this.documentHelper.selection;this.selection.start,this.selection.end;if(this.selection.isForward||(this.selection.end,this.selection.start),t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&t.start.paragraph.associatedCell.ownerTable.contains(t.end.paragraph.associatedCell)){var i=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward);if(i.rowIndex===n.rowIndex){for(var r=i.ownerRow.childWidgets.indexOf(i),o=i.ownerRow.childWidgets.indexOf(n),s=[],a=[],l=r;l<=o;l++){var d=this.addEditElement(e);l==r&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=d),d.columnFirst=l,d.columnLast=l,d.line=t.start.currentWidget;var h=d.editRangeEnd;h.line=t.end.currentWidget,s.push(d),a.push(h),this.insertElements(void 0,[d])}for(var c=this.selection.getLastParagraph(n).lastChild,p=0;p<a.length;p++)a[p].line=c,0==p&&(this.selection.start.setPositionParagraph(c,this.selection.getLineLength(c)),this.selection.end.setPositionParagraph(c,this.selection.getLineLength(c))),this.insertElements(void 0,[a[p]]);this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var u=s[0].line.getOffset(s[0],1);this.selection.start.setPositionParagraph(s[0].line,u),u=a[0].line.getOffset(a[0],1),this.selection.end.setPositionParagraph(a[0].line,u),this.selection.fireSelectionChanged(!0),this.fireContentChange()}else{this.insertEditRangeInsideTable(i,n,e),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var g=this.documentHelper.getFirstParagraphInCell(i).childWidgets[0],m=this.selection.getLastParagraph(n).childWidgets[0];u=g.getOffset(g.children[0],1);this.selection.start.setPositionParagraph(g,u),u=m.getOffset(m.children[0],1),this.selection.end.setPositionParagraph(m,u),this.selection.fireSelectionChanged(!0),this.fireContentChange()}}else this.addRestrictEditingForSelectedArea(e);this.selection.skipEditRangeRetrieval=!1}},e.prototype.insertEditRangeInsideTable=function(e,t,i){var n=e.ownerTable.combineWidget(this.owner.viewer),r=n.childWidgets.indexOf(t.ownerRow),o=n.childWidgets.indexOf(e.ownerRow),s=this.selection.getCellLeft(e.ownerRow,e),a=s+e.cellFormat.cellWidth,l=this.selection.getCellLeft(t.ownerRow,t),d=l+t.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(s,a,l,d);s=h.start,a=h.end;for(var c=[],p=o;p<=r;p++){for(var u=(n=e.ownerTable.combineWidget(this.owner.viewer)).childWidgets[p],g=-1,m=-1,f=0;f<u.childWidgets.length;f++){var v=u.childWidgets[f],y=this.selection.getCellLeft(u,v);this.checkCellWithInSelection(s,a,y)&&(-1===g&&(g=f),m=f)}for(var w=[],b=g;b<=m;b++){var C=void 0,x=void 0,I=void 0;b>=g&&b<=m&&(C=u.childWidgets[g],I=(x=this.documentHelper.getFirstParagraphInCell(C)).childWidgets[0]);var k=this.addEditElement(i);b===g&&(this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=k),this.selection.start.setPositionParagraph(I,this.selection.getStartOffset(x)),this.selection.end.setPositionParagraph(I,this.selection.getStartOffset(x))),k.columnFirst=b,k.columnLast=b,k.line=I,this.insertElements(void 0,[k]);var F=k.editRangeEnd;if(w.push(F),c.length>0&&b===m){for(var P=0;P<c.length;P++)c[P].line=k.line,this.insertElements(void 0,[c[P]]);c=[]}}if(c=w,p===r&&c.length>0){var S=u.childWidgets[m],T=this.selection.getLastParagraph(S).lastChild;for(P=0;P<c.length;P++)c[P].line=T,0==P&&(this.selection.start.setPositionParagraph(T,this.selection.getLineLength(T)),this.selection.end.setPositionParagraph(T,this.selection.getLineLength(T))),this.insertElements(void 0,[c[P]])}}},e.prototype.addRestrictEditingForSelectedArea=function(e){var t=this.addEditElement(e),i=t.editRangeEnd;this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=t),this.owner.isShiftingEnabled=!0,this.insertElements([i],[t]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var n=t.line.getOffset(t,1);this.selection.start.setPositionParagraph(t.line,n),n=i.line.getOffset(i,1),this.selection.end.setPositionParagraph(i.line,n);var r=this.documentHelper.blockToShift;if(!(0,a.isNullOrUndefined)(r)&&this.viewer instanceof kl&&r.bodyWidget.sectionFormat.columns.length>1){var o=this.documentHelper.layout.getBodyWidget(r.bodyWidget,!1);(0,a.isNullOrUndefined)(o.nextRenderedWidget)||"NoBreak"!==o.nextRenderedWidget.sectionFormat.breakCode||o.page!==o.nextRenderedWidget.page||this.reLayout(this.selection)}this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0),this.fireContentChange()},e.prototype.addEditElement=function(e,t){var i=new vd;"everyone"===e.toLocaleLowerCase()?i.group=e:i.user=e;var n=new fd;if(n.editRangeStart=i,i.editRangeEnd=n,t)i.editRangeId=t,n.editRangeId=t;else{var r=this.getEditRangeID(9);i.editRangeId=r,n.editRangeId=r}return this.editStartRangeCollection.push(i),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],i},e.prototype.getEditRangeID=function(e){var t=Math.pow(10,e-1),i=Math.pow(10,e)-1,n=Math.floor(Math.random()*(i-t+1))+t;return this.editRangeID.includes(n)?this.getEditRangeID(e):(this.editRangeID.push(n),n)},e.prototype.protect=function(e){this.documentHelper.isDocumentProtected=!0,this.documentHelper.protectionType=e,this.selection.highlightEditRegion(),this.editorHistory&&this.editorHistory.destroy()},e.prototype.addEditCollectionToDocument=function(){for(var e=0;e<this.editStartRangeCollection.length;e++){var t=this.editStartRangeCollection[e],i=""===t.user?t.group:t.user;if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(i))this.documentHelper.editRanges.get(i).push(t);else{var n=[];n.push(t),this.documentHelper.editRanges.add(i,n)}}this.selection.updateEditRangeCollection()},e.prototype.updateRangeCollection=function(e,t){if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(t))-1===this.documentHelper.editRanges.get(t).indexOf(e)&&this.documentHelper.editRanges.get(t).push(e);else{var i=[];i.push(e),this.documentHelper.editRanges.add(t,i)}},e.prototype.removeUserRestrictions=function(e){if(this.selection.checkSelectionIsAtEditRegion()||this.selection.isEditRangeCellSelected()){this.selection.skipEditRangeRetrieval=!0;var t=this.selection.getEditRangeStartElement();this.selection.skipEditRangeRetrieval=!0;var i=this.selection.start,n=this.selection.end;if(this.selection.isForward||(i=this.selection.end,n=this.selection.start),!this.selection.isEmpty&&i.paragraph.isInsideTable&&n.paragraph.isInsideTable&&this.selection.isCellSelected(i.paragraph.associatedCell,i,n)){var r=i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),o=n.paragraph.associatedCell;r.contains(o)&&this.removeEditRangeElementsOnTable(e)}else this.removeEditRangeElements(t,e);this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1}},e.prototype.removeEditRangeElements=function(e,t){this.initHistory("RemoveEditRange"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.markerData.push(this.getMarkerData(e)),this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(e),this.editorHistory.updateHistory()),e.user!==t&&e.group!==t||this.removeUserRestrictionsInternal(e,t),this.selection.updateEditRangeCollection()},e.prototype.removeEditRangeElementsOnTable=function(e){var t=this.selection.selectedWidgets.keys;if(t){this.initComplexHistory("RemoveEditRange");for(var i=0;i<t.length;i++)if(t[i]instanceof Vl){var n=t[i],r=n.containerWidget.editRangeID.values;if(r.length>0){for(var o=void 0,s=0,a=r;s<a.length;s++){var l=a[s];l.columnFirst==n.index&&l.columnLast==n.index&&(o=l)}if(o){var d=o.editRangeEnd;this.selection.start.setPositionParagraph(o.line,o.line.getOffset(o,o.length)),this.selection.end.setPositionParagraph(d.line,d.line.getOffset(d,d.length)-1),o.user!==e&&o.group!==e||this.removeEditRangeElements(o,e)}}}this.editorHistory&&this.editorHistory.updateComplexHistoryInternal()}},e.prototype.removeUserRestrictionsInternal=function(e,t,i){var n=t;(0,a.isNullOrUndefined)(t)&&(n=""===e.user?e.group:e.user);var r=this.documentHelper.editRanges.get(n).indexOf(e);this.documentHelper.editRanges.get(n).splice(r,1),0===this.documentHelper.editRanges.get(n).length&&this.documentHelper.editRanges.remove(n),-1!=e.columnFirst&&-1!=e.columnLast&&this.removeEditRangeFromCollection(e),e.removeEditRangeMark(),i||(e.editRangeEnd.line.children.splice(e.editRangeEnd.indexInOwner,1),e.line.children.splice(e.indexInOwner,1))},e.prototype.removeEditRangeFromCollection=function(e){var t=e.paragraph.associatedCell.ownerRow;if(t.editRangeID.containsKey(e.editRangeId)){var i=t.getCellUsingColumnIndex(t.rowIndex,e.columnFirst);(0,a.isNullOrUndefined)(i)||i.isRenderEditRangeStart&&i.isRenderEditRangeEnd&&(i.isRenderEditRangeEnd=!1,i.isRenderEditRangeStart=!1,t.editRangeID.remove(e.editRangeId))}else for(var n=e.paragraph.associatedCell.ownerTable,r=t.rowIndex-1;r>=0;r--){var o=n.childWidgets[r];if(o.editRangeID.containsKey(e.editRangeId)){var s=o.getCellUsingColumnIndex(o.rowIndex,e.columnFirst);if(!(0,a.isNullOrUndefined)(s)&&s.isRenderEditRangeStart&&s.isRenderEditRangeEnd){s.isRenderEditRangeEnd=!1,s.isRenderEditRangeStart=!1,o.editRangeID.remove(e.editRangeId);break}}}},e.prototype.removeAllEditRestrictions=function(){this.selection.skipEditRangeRetrieval=!0;for(var e=this.selection.start,t=this.selection.end,i=[],n=this.documentHelper.editRanges.keys,r=0;r<n.length;r++){i=this.documentHelper.editRanges.get(n[r]);for(var o=0;o<i.length;o++)i[o].editRangeEnd.line.children.splice(i[o].editRangeEnd.indexInOwner,1),i[o].line.children.splice(i[o].indexInOwner,1)}this.documentHelper.editRanges.clear(),this.selection.updateEditRangeCollection(),this.selection.start.setPositionInternal(e),this.selection.end.setPositionInternal(t),this.selection.editRegionHighlighters.clear(),this.owner.viewer.updateScrollBars(),this.selection.fireSelectionChanged(!1),this.selection.skipEditRangeRetrieval=!1},e.prototype.insertFormField=function(e){if(!((0,a.isNullOrUndefined)(this.selection.start)||this.owner.enableHeaderAndFooter||this.selection.isPlainContentControl())){this.initHistory("InsertHyperlink");var t=!0;this.selection.isEmpty||(t=this.removeSelectedContents(this.selection)),t&&this.insertFormFieldInternal(e)}},e.prototype.insertFormFieldInternal=function(e){this.updateInsertPosition();var t=[],i=this.getCharacterFormat(this.selection),n=new ka(void 0);n.copyFormat(i);var r=new _l(0);r.formFieldData=this.getFormFieldData(e),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.formFieldType=e,this.editorHistory.currentBaseHistoryInfo.fieldBegin=r),r.characterFormat.copyFormat(n),t.push(r);var o=new td(0);o.characterFormat.copyFormat(n),r.formFieldData.name=this.getBookmarkName(e,"Insert",this.formFieldCounter),o.name=r.formFieldData.name,t.push(o);var s=new Zl;s.text=this.getFormFieldCode(e),t.push(s);var a=new _l(2);t.push(a);var l=new Zl;l.characterFormat.copyFormat(n),"CheckBox"===e?(l.text=String.fromCharCode(9744),this.documentHelper.layout.setCheckBoxFontSize(r.formFieldData,l.characterFormat)):l.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),t.push(l);var d=new _l(1);d.characterFormat.copyFormat(n),t.push(d),r.fieldSeparator=d.fieldSeparator=a,r.fieldEnd=a.fieldEnd=d,a.fieldBegin=d.fieldBegin=r;var h=new td(1);h.characterFormat.copyFormat(n),h.name=r.formFieldData.name,h.reference=o,o.reference=h,t.push(h),this.documentHelper.layout.isInsertFormField=!0,this.insertElement(t),this.documentHelper.layout.isInsertFormField=!1;this.selection.start.paragraph;d.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(r)&&this.documentHelper.fields.push(r),this.addFormFieldWidget(r);var c=h.line.getOffset(h,1);this.selection.selects(h.line,c,!0),this.updateEndPosition(),this.reLayout(this.selection,!0)},e.prototype.addFormFieldWidget=function(e){if(-1===this.documentHelper.formFields.indexOf(e)){var t=!1;if(this.documentHelper.formFields.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.formFields.length;n++){var r=this.selection.getElementPosition(this.documentHelper.formFields[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.formFields.splice(n,0,e);break}}t||this.documentHelper.formFields.push(e)}},e.prototype.getFormFieldData=function(e){switch(e){case"Text":return new Gl;case"CheckBox":return new Kl;case"DropDown":return new Xl}},e.prototype.setFormField=function(e,t){var i,n;(0,a.isNullOrUndefined)(t.format)?(0,a.isNullOrUndefined)(t.sizeType)?(0,a.isNullOrUndefined)(t.dropdownItems)||(i="DropDown",n=new Xl):(i="CheckBox",n=new Kl):(i="Text",n=new Gl),(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(n)||(n.name=(0,a.isNullOrUndefined)(t.name)?e.formFieldData.name:t.name,n.copyFieldInfo(t),this.editFormField(i,n))},e.prototype.editFormField=function(e,t){var i,n,r=this.selection.getCurrentFormField();if((0,a.isNullOrUndefined)(r)||(0,a.isNullOrUndefined)(r.formFieldData))return!1;this.initComplexHistory("FormField"),""!==t.name&&(r.formFieldData.name!==t.name&&this.documentHelper.bookmarks.containsKey(t.name)&&this.deleteBookmark(t.name),(i=new td(0)).name=t.name,(n=new td(1)).name=t.name,i.reference=n,n.reference=i),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=(0,a.isNullOrUndefined)(this.editorHistory)||this.editorHistory&&(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo);var o=r.characterFormat.cloneFormat(),s=new ka;s.copyFormat(o);var l=r.fieldSeparator.nextElement.characterFormat.cloneFormat(),d=r.line.getOffset(r,0);this.selection.start.setPositionParagraph(r.line,d);var h=r.fieldEnd;r.nextNode&&r.nextNode instanceof td&&(h=r.nextNode.reference),d=h.line.getOffset(h,1),this.selection.end.setPositionParagraph(h.line,d),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition();var c=[],p=new _l(0);p.formFieldData=t,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.formFieldType=e,this.editorHistory.currentBaseHistoryInfo.fieldBegin=p),c.push(p),p.characterFormat.copyFormat(s),(0,a.isNullOrUndefined)(i)||c.push(i);var u=new Zl;u.text=this.getFormFieldCode(e),c.push(u);var g=new _l(2);g.characterFormat.copyFormat(s),c.push(g),(u=new Zl).characterFormat.copyFormat(l),u.text=this.getDefaultText(t),"CheckBox"===e?(u.characterFormat.copyFormat(p.characterFormat),"Exactly"===t.sizeType&&(u.characterFormat.fontSize=1.35*t.size)):t instanceof Gl&&""!==t.defaultValue&&("Text"===t.type?u.text=Pa.formatText(t.format,t.defaultValue):"Number"===t.type?u.text=Pa.formatNumber(t.format,t.defaultValue):u.text=Pa.formatDate(t.format,t.defaultValue)),c.push(u);var m=new _l(1);m.characterFormat.copyFormat(s),c.push(m);var f=m;(0,a.isNullOrUndefined)(n)||(f=n,c.push(n)),p.fieldSeparator=m.fieldSeparator=g,p.fieldEnd=g.fieldEnd=m,g.fieldBegin=m.fieldBegin=p,this.documentHelper.layout.isInsertFormField=!0,this.insertElement(c),this.documentHelper.layout.isInsertFormField=!1;this.selection.start.paragraph;m.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(p)&&this.documentHelper.fields.push(p),this.addFormFieldWidget(p);var v=f.line.getOffset(f,1);return this.selection.selects(f.line,v,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.editorHistory.updateComplexHistory(),this.isSkipOperationsBuild=!1),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.getDefaultText=function(e){var t="";return e instanceof Kl?t=e.defaultValue?String.fromCharCode(9745):String.fromCharCode(9744):e instanceof Xl?t=e.dropdownItems.length>0?e.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):e instanceof Gl&&(t=""!==e.defaultValue?e.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},e.prototype.getFormFieldCode=function(e){switch(e){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},e.prototype.toggleCheckBoxFormField=function(e,t,i){var n=e.formFieldData;if(n instanceof Kl&&n.enabled){if(this.initHistory("UpdateFormField"),this.editorHistory){var r=void 0;n instanceof Kl&&(r=n.checked),this.editorHistory.currentBaseHistoryInfo.fieldBegin=e,this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,r),this.editorHistory.updateHistory()}n.checked=t?i:!n.checked;var o=e.fieldSeparator.nextNode;n.checked?o.text=String.fromCharCode(9745):o.text=String.fromCharCode(9744),o.isWidthUpdated=!1,this.owner.documentHelper.layout.reLayoutParagraph(e.line.paragraph,0,0),this.reLayout(this.selection,!1)}},e.prototype.toggleContentControlCheckBox=function(e,t){(0,a.isNullOrUndefined)(this.editorHistory)||this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.selection.selectContentInternal(e),this.initHistory("UpdateContentControl")),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.setContentControlCheckBox(e,t);var i=e.nextNode;(i instanceof vd||i instanceof fd)&&(i=i.nextNode),i instanceof Zl||(0,a.isNullOrUndefined)(this.selection)||(i=this.selection.getNextTextElement(i)),i.isWidthUpdated=!1;var n=t?e.contentControlProperties.checkedState:e.contentControlProperties.uncheckedState;(0,a.isNullOrUndefined)(n.font)||(0,a.isNullOrUndefined)(n.value)?i.text=String.fromCharCode(t?9746:9744):(i.characterFormat.fontFamily=n.font,i.characterFormat.fontFamilyAscii=n.font,i.characterFormat.fontFamilyFarEast=n.font,i.characterFormat.fontFamilyNonFarEast=n.font,i.text=n.value),e.contentControlProperties.isChecked=t,this.reLayout(this.selection,!0)},e.prototype.updateFormField=function(e,t,i){var n=e.formFieldData;n&&this.updateFormFieldInternal(e,n,t,i)},e.prototype.updateContentControl=function(e,t,i){if("RichText"===e.contentControlProperties.type||"Text"===e.contentControlProperties.type||"Date"===e.contentControlProperties.type||"Picture"===e.contentControlProperties.type)this.updateContentControlResult(e,t,i);else if("CheckBox"===e.contentControlProperties.type)this.toggleContentControlCheckBox(e,"true"===t&&!i);else if("ComboBox"===e.contentControlProperties.type||"DropDownList"===e.contentControlProperties.type){var n=new rd;if(i){var r=new a.L10n("documenteditor",this.owner.defaultLocale);n.displayText=r.getConstant("Choose an item"),n.value=r.getConstant("Choose an item")}else n.displayText=t,n.value=t;e.contentControlProperties.contentControlListItems.push(n),this.dropDownChange(e,n.displayText)}},e.prototype.updateContentControlResult=function(e,t,i){if(this.selection.selectContentControlInternal(e),"Picture"===e.contentControlProperties.type)i&&(t=""),this.insertImageAsync(t);else{if(i||(0,a.isNullOrUndefined)(t)||""===t){var n=new a.L10n("documenteditor",this.owner.defaultLocale);n.setLocale(this.owner.locale),t="Date"===e.contentControlProperties.type?n.getConstant("Default Date Picker"):n.getConstant("Default Content Control Text")}if("RichText"===e.contentControlProperties.type){try{"object"!=typeof t&&(t=JSON.parse(t))}catch(e){var r={sections:[{blocks:[{inlines:[{text:t}]}]}]};t=JSON.stringify(r)}this.paste(t),this.updatePropertiesToBlock(e,!0)}else this.insertText(t)}},e.prototype.getContentControlPropObject=function(e){return(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.documentHelper.owner.sfdtExportModule.contentControlProperty(e,1)},e.prototype.assignContentControl=function(e,t){this.owner.parser&&this.owner.parser.parseContentControlProperties(t,e,1)},e.prototype.updateFormFieldInternal=function(e,t,i,n){if(t instanceof Gl){""===i&&(i=n?this.getDefaultText(t):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5));var r=i;"Text"===t.type&&""!==t.format&&(r=Pa.formatText(t.format,i)),this.updateFormFieldResult(e,r)}else if(t instanceof Xl){var o=t.dropdownItems[i];t.selectedIndex=i,this.updateFormFieldResult(e,o)}var s=e.fieldEnd.line.getOffset(e.fieldEnd,1),a=new ac(this.owner);a.setPositionParagraph(e.fieldEnd.line,s),this.documentHelper.selection.selectRange(a,a),this.reLayout(this.selection,!1)},e.prototype.updateFormFieldResult=function(e,t){this.selection.selectFieldInternal(e,!1,!0),this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.insertText(t),this.isSkipOperationsBuild=!1},e.prototype.checkBookmarkAvailability=function(e,t){for(var i=this.documentHelper.bookmarks,n=0;n<i.length;n++)if(i.containsKey(e))return!1;return!0},e.prototype.getBookmarkName=function(e,t,i){for(var n,r=!1;!1===r;)n=e+i,r=this.checkBookmarkAvailability(n,t),i+=1;return n},e.prototype.applyFormTextFormat=function(e){if(!(0,a.isNullOrUndefined)(e)){var t=this.getFieldResultText(e),i=t;t=Pa.formatText(e.formFieldData.format,t),null!=e.fieldSeparator&&this.applyTextFormatInternal(e,t),this.initHistory("FormTextFormat"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,i),this.editorHistory.updateHistory())}},e.prototype.insertSpaceInFormField=function(){if(this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()){var e=this.getFieldResultText();0!==e.length&&"\r"!==e||(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField()))}},e.prototype.getFieldResultText=function(e){(0,a.isNullOrUndefined)(e)&&(e=this.selection.getCurrentFormField());var t=this.selection.startOffset,i=this.selection.endOffset;this.selection.isModifyingSelectionInternally=!0,this.selection.selectFieldInternal(e,!1,!0);var n=this.selection.getText(!1);return this.selection.select(t,i),this.selection.isModifyingSelectionInternally=!1,n},e.prototype.contentControlDropDownChange=function(){var e=this.documentHelper.selection.currentContentControl;(0,a.isNullOrUndefined)(e)||("ComboBox"==e.contentControlProperties.type||"DropDownList"==e.contentControlProperties.type?this.documentHelper.contentDropDown.showPopUp(e):"Date"==e.contentControlProperties.type&&this.documentHelper.owner.dateContentDialogModule.show())},e.prototype.applyTextFormatInternal=function(e,t){var i=e.fieldSeparator.nextElement,n=0;t=t.replace(/\r/g,"");do{if(!(0,a.isNullOrUndefined)(i)&&i instanceof Zl&&(i.text=t.slice(n,n+i.text.length),n+=i.length),(0,a.isNullOrUndefined)(i.nextElement))if((0,a.isNullOrUndefined)(i.line.nextLine)){this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0);var r=i.paragraph.nextRenderedWidget;if((0,a.isNullOrUndefined)(r))break;for(r instanceof Al&&(r=this.documentHelper.getFirstParagraphBlock(r));r.isEmpty();)r=r.nextRenderedWidget;i=r.childWidgets[0].children[0]}else i=i.line.nextLine.children[0];else i=i.nextElement}while(!(i instanceof _l&&1===i.fieldType&&i.fieldBegin.formFieldData instanceof Gl));this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0),this.selection.isFormatUpdated=!0,this.reLayout(this.selection,!1),this.selection.isFormatUpdated=!1},e.prototype.constructCommentInitial=function(e){for(var t=e.split(" "),i="",n=0;n<t.length;n++)t[n].length>0&&""!==t[n]&&(i+=t[n][0]);return i},e.prototype.insertFootnote=function(){if(!(this.selection.isinFootnote||this.selection.isinEndnote||this.selection.isPlainContentControl())){this.isFootNoteInsert=!0,this.isFootNote=!0;var e=new Yl;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Footnote",e.text="s";var t=new Rl,i=new zl(t),n=new _d;t.paragraphFormat.afterSpacing=0,n.characterFormat.baselineAlignment="Superscript",n.line=i,n.text="?",i.children.push(n);var r,o=new Zl;if(o.text=" ",o.line=i,i.children.push(o),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e),e.paragraph.bodyWidget.page.footnoteWidget)for(var s=0;s<e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets.length;s++)e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[s].footNoteReference===e&&(r=e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[s].childWidgets[0]);this.selection.start.setPositionForLineWidget(r.childWidgets[0],o.line.getOffset(o,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateFootNoteIndex(),this.reLayout(this.selection,!1),this.documentHelper.layout.isLayoutWhole=!0,this.isSkipOperationsBuild=!0,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.documentHelper.layout.isLayoutWhole=!1,this.separator("footnote"),this.continuationSeparator("footnote"),this.isFootNote=!1,this.isFootNoteInsert=!1}},e.prototype.updateFootnoteCollection=function(e){if(-1===this.documentHelper.footnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.footnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.footnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.footnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.footnoteCollection.splice(n,0,e);break}}t||this.documentHelper.footnoteCollection.push(e)}},e.prototype.insertEndnote=function(){if(!(this.selection.isinFootnote||this.selection.isinEndnote||this.selection.isPlainContentControl())){this.documentHelper.layout.isEndnoteContentChanged=!0;var e=new Yl;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Endnote",e.text="s";var t=new Rl,i=new zl(t),n=new _d;t.paragraphFormat.afterSpacing=0,n.characterFormat.baselineAlignment="Superscript",n.line=i,n.text="?",i.children.push(n);var r=new Zl;r.text=" ",r.line=i,i.children.push(r),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e);var o,s=this.documentHelper.pages.length,a=this.documentHelper.pages[s-1].bodyWidgets[0];if(a.page.endnoteWidget)for(var l=0;l<a.page.endnoteWidget.bodyWidgets.length;l++)a.page.endnoteWidget.bodyWidgets[l].footNoteReference===e&&(o=a.page.endnoteWidget.bodyWidgets[l].childWidgets[0]);this.selection.start.setPositionForLineWidget(o.childWidgets[0],n.line.getOffset(r,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateEndNoteIndex(),this.reLayout(this.selection,!1),this.documentHelper.layout.isLayoutWhole=!0,this.isSkipOperationsBuild=this.owner.enableCollaborativeEditing,this.layoutWholeDocument(),this.isSkipOperationsBuild=!1,this.documentHelper.layout.isLayoutWhole=!1,this.owner.documentHelper.blockToShift=void 0,this.separator("endnote"),this.continuationSeparator("endnote"),this.documentHelper.layout.isEndnoteContentChanged=!1}},e.prototype.updateEndnoteCollection=function(e){if(-1===this.documentHelper.endnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.endnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,n=0;n<this.documentHelper.endnoteCollection.length;n++){var r=this.selection.getElementPosition(this.documentHelper.endnoteCollection[n]).startPosition;if(i.isExistBefore(r)){t=!0,this.documentHelper.endnoteCollection.splice(n,0,e);break}}t||this.documentHelper.endnoteCollection.push(e);var o=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var s,a=!1,l=void 0,d=this.documentHelper.endnoteCollection.indexOf(e),h=1,c=void 0,p=this.documentHelper.pages[o-1].bodyWidgets[0];if(p.page.endnoteWidget)for(var u=0;u<p.page.endnoteWidget.bodyWidgets.length;u++){var g=this.documentHelper.endnoteCollection.indexOf(p.page.endnoteWidget.bodyWidgets[u].footNoteReference);if(g>d&&g-d==1){h=u,a=!0;break}}if(s=e,p.page.endnoteWidget instanceof Dl&&"Endnote"===p.page.endnoteWidget.footNoteType)l=p.page.endnoteWidget;else{c=!0,(l=new Dl).footNoteType="Endnote",l.page=p.page;var m=new Rl;m.characterFormat=new ka,m.paragraphFormat=new ba,m.index=0;var f=new zl(m);m.childWidgets.push(f),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+18)}var v=s.bodyWidget;for(u=0;u<s.bodyWidget.childWidgets.length;u++){var y=s.bodyWidget.childWidgets[u];this.documentHelper.layout.isLayoutWhole?y.containerWidget=void 0:(y.containerWidget=v,v.page=p.page,v.sectionFormat=l.sectionFormat,y.containerWidget.containerWidget=l),a?l.bodyWidgets.splice(h,0,v):l.bodyWidgets.push(v)}h++,c&&(p.page.endnoteWidget=l),l.height+=0}}},e.prototype.updateEndNoteIndex=function(){for(var e=this.documentHelper.endnoteCollection,t=0;t<e.length;t++){var i=this.documentHelper.layout.getFootEndNote(e[t].paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,t+1);if(""!=i){if(e[t].text=i,void 0!==e[t].revisions)for(var n=0;n<e[t].revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(e[t].revisions[n]),n++;var r=e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0];if(!(0,a.isNullOrUndefined)(r)&&((r instanceof _d||Pa.checkTextFormat(r.text))&&(r.text=i,r.width=e[t].bodyWidget.footNoteReference.width),null!=r.revisions))for(n=0;n<r.revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(r.revisions[n]),n++}}},e.prototype.separator=function(e){var t=new Rl,i=new zl(t),n=new Zl;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(3),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===e&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},e.prototype.continuationSeparator=function(e){var t=new Rl,i=new zl(t),n=new Zl;n.characterFormat.fontColor="#00000000",n.line=i,n.text=String.fromCharCode(4),i.children.push(n),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===e&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},e.prototype.updateFootNoteIndex=function(){for(var e=this.documentHelper.footnoteCollection,t=0;t<e.length;t++){var i=this.documentHelper.layout.getFootEndNote(e[t].paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,t+1);if(""!=i){if(e[t].text=i,void 0!==e[t].revisions)for(var n=0;n<e[t].revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(e[t].revisions[n]),n++;var r=e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0];if(!(0,a.isNullOrUndefined)(r)&&r instanceof _d&&(r.text=i,r.width=e[t].bodyWidget.footNoteReference.width,null!=r.revisions))for(n=0;n<r.revisions.length;)this.owner.trackChangesPane.updateCurrentTrackChanges(r.revisions[n]),n++}}},e.prototype.setCharFormatForCollaborativeEditing=function(e){if(!(0,a.isNullOrUndefined)(this.editorHistory)&&!(0,a.isNullOrUndefined)(this.editorHistory.currentBaseHistoryInfo)&&this.owner.enableCollaborativeEditing){var t={};Pa.writeCharacterFormat(t,!0,e,void 0,!0),this.editorHistory.currentBaseHistoryInfo.type="CharacterFormat",this.editorHistory.currentBaseHistoryInfo.format=JSON.stringify(t)}},e.prototype.clear=function(){this.pageRefFields&&(this.pageRefFields={})},e}(),Sc=function(){function e(e,t){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new l,this.documentHelper=t,this.imageResizerPoints=new Tc,(0,a.isNullOrUndefined)(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(e.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShapeResize",{get:function(){return this.currentImageElementBox instanceof hd},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ImageResizer"},e.prototype.setImageResizerPositions=function(e,t,i,n){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=n+"px",this.owner.viewer instanceof Fl?this.imageResizerDivElement.style.width=i-e-this.documentHelper.scrollbarWidth+"px":this.imageResizerDivElement.style.width=i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},e.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},e.prototype.positionImageResizer=function(e){var t;this.selectedImageWidget.clear(),(0,a.isNullOrUndefined)(this.documentHelper.currentPage)||(t=this.imageResizerDivElement),(0,a.isNullOrUndefined)(t)||t.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(t,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px",this.currentImageElementBox=e;var i,n,r=e.line;e instanceof gd&&"Inline"!==e.textWrappingStyle?(i=e.y,n=e.x):(i=this.documentHelper.selection.getTop(r)+e.margin.top,n=this.documentHelper.selection.getLeftInternal(r,e,0));var o=this.documentHelper.selection.getPage(r.paragraph);this.currentPage=o;(0,a.isNullOrUndefined)(t)||(this.owner.viewer instanceof Fl&&(this.imageResizerDivElement.style.width=o.boundingRectangle.width-o.boundingRectangle.x-n-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",this.owner.viewer instanceof Fl?t.style.width=o.boundingRectangle.width-this.documentHelper.scrollbarWidth-o.boundingRectangle.x-n+"px":t.style.width=o.boundingRectangle.width+"px",t.style.height=o.boundingRectangle.height+"px",t.style.left=o.boundingRectangle.x+"px",t.style.top=o.boundingRectangle.y+"px",t.style.borderWidth="0px",t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.position="absolute");var s,l=this.documentHelper.getPageWidth(o);s=parseFloat(this.imageResizerDivElement.style.width),this.documentHelper.visibleBounds.width,this.documentHelper.zoomFactor,l<s&&this.documentHelper.zoomFactor;var d=this.imageResizerDivElement,h=parseFloat(d.style.width),c=parseFloat(d.style.height),p=parseFloat(this.imageResizerDiv.style.width),u=parseFloat(this.imageResizerDiv.style.height),g=(this.resizeMarkSize-1)/2,m=p+2*g,f=u+2*g;if(m>(h-n)*this.documentHelper.zoomFactor+g&&(m=(h-n)*this.documentHelper.zoomFactor),f>(c-i)*this.documentHelper.zoomFactor+g&&(f=(c-i)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",f=this.documentHelper.render.getScaledValue(e.height),m=this.documentHelper.render.getScaledValue(e.width),e instanceof gd?(n=this.documentHelper.render.getScaledValue(n),i=this.documentHelper.render.getScaledValue(i)):(n=e.x*this.documentHelper.zoomFactor,i=e.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(n,i,m,f,this),this.owner.selectionModule.isInShape?this.resizeContainerDiv.style.borderStyle="dashed":this.resizeContainerDiv.style.borderStyle="solid",!this.selectedImageWidget.containsKey(r)){var v=new Hc(e.height,e.width);this.selectedImageWidget.add(r,v)}},e.prototype.showImageResizer=function(){(0,a.isNullOrUndefined)(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),(0,a.isNullOrUndefined)(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),(0,a.isNullOrUndefined)(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),(0,a.isNullOrUndefined)(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),(0,a.isNullOrUndefined)(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),(0,a.isNullOrUndefined)(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),(0,a.isNullOrUndefined)(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),(0,a.isNullOrUndefined)(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),(0,a.isNullOrUndefined)(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),(0,a.isNullOrUndefined)(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},e.prototype.hideImageResizer=function(){(0,a.isNullOrUndefined)(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),(0,a.isNullOrUndefined)(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),(0,a.isNullOrUndefined)(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),(0,a.isNullOrUndefined)(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},e.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},e.prototype.setImageResizerPosition=function(e,t,i,n,r){r.resizeContainerDiv.style.width=i+"px",r.resizeContainerDiv.style.height=n+"px",r.resizeContainerDiv.style.left=e+"px",r.resizeContainerDiv.style.top=t+"px",r.topRightRect.style.left=e+i-5+"px",r.topRightRect.style.top=t-4+"px",r.topLeftRect.style.left=e-5+"px",r.topLeftRect.style.top=t-4+"px",r.topMiddleRect.style.left=parseFloat(r.topLeftRect.style.left)+i/2-4+"px",r.topMiddleRect.style.top=t-4+"px",r.bottomRightRect.style.left=r.topRightRect.style.left,r.bottomRightRect.style.top=parseFloat(r.topRightRect.style.top)+n+"px",r.bottomLeftRect.style.left=r.topLeftRect.style.left,r.bottomLeftRect.style.top=parseFloat(r.topLeftRect.style.top)+n+"px",r.bottomMiddleRect.style.left=r.topMiddleRect.style.left,r.bottomMiddleRect.style.top=parseFloat(r.topMiddleRect.style.top)+n+"px",r.rightMiddleRect.style.left=e+i-4+"px",r.rightMiddleRect.style.top=parseFloat(r.topRightRect.style.top)+n/2+"px",r.leftMiddleRect.style.left=r.topLeftRect.style.left,r.leftMiddleRect.style.top=parseFloat(r.topLeftRect.style.top)+n/2+"px",r.topRightRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-8+"px",r.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topLeftRectParent.style.left=this.documentHelper.isTouchInput?e-15+"px":e-8+"px",r.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.topMiddleRectParent.style.left=parseFloat(r.topLeftRectParent.style.left)+i/2-4+"px",r.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",r.bottomRightRectParent.style.left=r.topRightRectParent.style.left,r.bottomRightRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n+"px",r.bottomLeftRectParent.style.left=r.topLeftRectParent.style.left,r.bottomLeftRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n+"px",r.bottomMiddleRectParent.style.left=r.topMiddleRectParent.style.left,r.bottomMiddleRectParent.style.top=parseFloat(r.topMiddleRectParent.style.top)+n+"px",r.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-7+"px",r.rightMiddleRectParent.style.top=parseFloat(r.topRightRectParent.style.top)+n/2+"px",r.leftMiddleRectParent.style.left=r.topLeftRectParent.style.left,r.leftMiddleRectParent.style.top=parseFloat(r.topLeftRectParent.style.top)+n/2+"px",this.setImageResizingPoints(r),this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},e.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},e.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},e.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},e.prototype.handleImageResizing=function(e,t,i){var n;t/=this.documentHelper.zoomFactor,i/=this.documentHelper.zoomFactor,this.leftValue=(0,a.isNullOrUndefined)(this.leftValue)?t:this.leftValue,this.topValue=(0,a.isNullOrUndefined)(this.topValue)?i:this.topValue;var r=this.selectedResizeElement.id.split("_"),o=r[r.length-1];switch(o){case"TopRightRectParent":t=(n=this.topRightResizing(e)).left,i=n.top;break;case"TopLeftRectParent":t=-(n=this.topLeftResizing(e)).left,i=-n.top;break;case"TopMiddleRectParent":t=0,i=this.topMiddleResizing(e);break;case"BottomRightRectParent":t=(n=this.bottomRightResizing(e)).left,i=n.top;break;case"BottomLeftRectParent":t=-(n=this.bottomLeftResizing(e)).left,i=-n.top;break;case"BottomMiddleRectParent":i=e.y-i,t=0;break;case"RightMiddleRectParent":t=e.x-t,i=0;break;case"LeftMiddleRectParent":t=this.leftMiddleResizing(e),i=0}if(0!==t||0!==i){var s=this.currentImageElementBox.line.paragraph,l=this.currentImageElementBox;if(!(0,a.isNullOrUndefined)(s)&&s.isInsideTable){var d=s.containerWidget;if(!(0,a.isNullOrUndefined)(d)){var h=d.containerWidget,c=Pa.convertPointToPixel(l.height),p=h.height-c;i>0&&h.y+p+c+i>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}}if(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),!(0,a.isNullOrUndefined)(this.currentImageElementBox)){var u=this.currentImageElementBox.width+t>10?this.currentImageElementBox.width+t:10,g=this.currentImageElementBox.height+i>10?this.currentImageElementBox.height+i:10;"BottomRightRectParent"!==o&&"TopRightRectParent"!==o&&"BottomLeftRectParent"!==o&&"TopLeftRectParent"!==o||(g=this.currentImageElementBox.height/this.currentImageElementBox.width*u,u=this.currentImageElementBox.width/this.currentImageElementBox.height*g),this.currentImageElementBox.width=u,this.currentImageElementBox.height=g;this.currentImageElementBox.line.paragraph;this.positionImageResizer(this.currentImageElementBox)}this.isImageResizing=!0}},e.prototype.handleImageResizingOnMouse=function(e){if(!(0,a.isNullOrUndefined)(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left),i=parseFloat(this.selectedResizeElement.style.top),n=new Sa(e.offsetX,e.offsetY),r=this.viewer.findFocusedPage(n,!0);this.handleImageResizing(r,t,i)}},e.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof kl&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-e.y/this.topValue,this.topValue=e.y,0===this.topValue&&(t=-1)),t},e.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-e.x/this.leftValue,this.leftValue=e.x),t},e.prototype.topRightResizing=function(e){return this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.topLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomRightResizing=function(e){return this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.getOuterResizingPoint=function(e){var t,i;return t=e.x-this.leftValue,this.leftValue=e.x,i=e.y-this.topValue,this.topValue=e.y,{left:t,top:i}},e.prototype.getInnerResizingPoint=function(e){var t,i;return t=-(this.leftValue-e.x),this.leftValue=e.x,i=-(this.topValue-e.y),this.topValue=e.y,{left:t,top:i}},e.prototype.handleImageResizingOnTouch=function(e){if(!(0,a.isNullOrUndefined)(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left)+24,i=parseFloat(this.selectedResizeElement.style.top)+24,n=e.touches,r=new Sa(n[0].clientX,n[0].clientY),o=this.viewer.findFocusedPage(r,!0);if((0,a.isNullOrUndefined)(this.currentImageElementBox)||(0,a.isNullOrUndefined)(this.currentImageElementBox))return;this.handleImageResizing(o,t,i)}},e.prototype.getImagePoint=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new Sa(t,i);var n=this.imageResizerPoints,r="",o=void 0,s=n.bottomMiddleRectParent,l=n.bottomRightRectParent,d=n.bottomLeftRectParent,h=n.topMiddleRectParent,c=n.topRightRectParent,p=n.topLeftRectParent,u=n.rightMiddleRectParent,g=n.leftMiddleRectParent;return(0,a.isNullOrUndefined)(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+15&&e.y>s.y&&e.y<=s.y+15?(o=this.bottomMiddleRectParent,r="s-resize"):e.x>l.x&&e.x<=l.x+15&&e.y>l.y&&e.y<=l.y+15?(o=this.bottomRightRectParent,r="se-resize"):e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(o=this.bottomLeftRectParent,r="sw-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(o=this.topMiddleRectParent,r="n-resize"):e.x>c.x&&e.x<=c.x+15&&e.y>c.y&&e.y<=c.y+15?(o=this.topRightRectParent,r="ne-resize"):e.x>p.x&&e.x<=p.x+15&&e.y>p.y&&e.y<=p.y+15?(o=this.topLeftRectParent,r="nw-resize"):e.x>g.x&&e.x<=g.x+15&&e.y>g.y&&e.y<=g.y+15?(o=this.leftMiddleRectParent,r="w-resize"):e.x>u.x&&e.x<=u.x+15&&e.y>u.y&&e.y<=u.y+15?(o=this.rightMiddleRectParent,r="e-resize"):!(0,a.isNullOrUndefined)(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(r="move")),{selectedElement:o,resizePosition:r}},e.prototype.applyPropertiesForMouse=function(){(0,a.isNullOrUndefined)(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},e.prototype.getImagePointOnTouch=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new Sa(t,i);var n=this.imageResizerPoints,r="",o=void 0,s=n.bottomMiddleRectParent,l=n.bottomRightRectParent,d=n.bottomLeftRectParent,h=n.topMiddleRectParent,c=n.topRightRectParent,p=n.topLeftRectParent,u=n.rightMiddleRectParent,g=n.leftMiddleRectParent;return(0,a.isNullOrUndefined)(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+25&&e.y>s.y&&e.y<=s.y+25?(o=this.bottomMiddleRectParent,r="s-resize"):e.x>l.x&&e.x<=l.x+25&&e.y>l.y&&e.y<=l.y+25?(o=this.bottomRightRectParent,r="se-resize"):e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(o=this.bottomLeftRectParent,r="sw-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(o=this.topMiddleRectParent,r="n-resize"):e.x>c.x&&e.x<=c.x+25&&e.y>c.y&&e.y<=c.y+25?(o=this.topRightRectParent,r="ne-resize"):e.x>p.x&&e.x<=p.x+25&&e.y>p.y&&e.y<=p.y+25?(o=this.topLeftRectParent,r="nw-resize"):e.x>g.x&&e.x<=g.x+25&&e.y>g.y&&e.y<=g.y+25?(o=this.leftMiddleRectParent,r="w-resize"):e.x>u.x&&e.x<=u.x+25&&e.y>u.y&&e.y<=u.y+25?(o=this.rightMiddleRectParent,r="e-resize"):!(0,a.isNullOrUndefined)(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(r="move")),{selectedElement:o,resizePosition:r}},e.prototype.applyPropertiesForTouch=function(){(0,a.isNullOrUndefined)(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},e.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selectionModule),this.documentHelper.layout.layoutBodyWidgetCollection(this.currentImageElementBox.line.paragraph.index,this.currentImageElementBox.line.paragraph.containerWidget,this.currentImageElementBox.line.paragraph,!1),this.updateHistoryForImageResizer(),this.owner.editorModule.reLayout(this.owner.selectionModule,!0),this.viewer.updateScrollBars()},e.prototype.initHistoryForImageResizer=function(e){!(0,a.isNullOrUndefined)(this.owner)&&(0,a.isNullOrUndefined)(this.baseHistoryInfo)&&(this.baseHistoryInfo=new wc(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new hc(e)))},e.prototype.updateHistoryForImageResizer=function(){if(!(0,a.isNullOrUndefined)(this.owner)&&!(0,a.isNullOrUndefined)(this.baseHistoryInfo)){var e=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():(this.baseHistoryInfo.insertedText=o.Image,this.baseHistoryInfo.insertedData={width:Pa.convertPixelToPoint(this.currentImageElementBox.width),height:Pa.convertPixelToPoint(this.currentImageElementBox.height),alternativeText:this.currentImageElementBox.alternateText},this.owner.editorHistoryModule.recordChanges(this.baseHistoryInfo)),this.baseHistoryInfo=void 0}},e.prototype.updateImageResizerPosition=function(){if(!(0,a.isNullOrUndefined)(this.currentImageElementBox)){var e,t=(this.currentImageElementBox,this.currentImageElementBox),i=t.line,n=void 0,r=void 0,o=void 0;this.currentImageElementBox instanceof gd?(e=this.documentHelper.selection.getTop(i)+t.margin.top,n=this.documentHelper.selection.getLeftInternal(i,t,0),r=e*this.documentHelper.zoomFactor,o=n*this.documentHelper.zoomFactor):(o=t.x*this.documentHelper.zoomFactor,r=t.y*this.documentHelper.zoomFactor);var s=this.documentHelper.render.getScaledValue(t.height,2),l=this.documentHelper.render.getScaledValue(t.width,1);this.setImageResizerPosition(o,r,l,s,this)}},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),(0,a.isNullOrUndefined)(this.topLeftRect)||(this.topLeftRect.innerHTML=""),(0,a.isNullOrUndefined)(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),(0,a.isNullOrUndefined)(this.topRightRect)||(this.topRightRect.innerHTML=""),(0,a.isNullOrUndefined)(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),(0,a.isNullOrUndefined)(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),(0,a.isNullOrUndefined)(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),(0,a.isNullOrUndefined)(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),(0,a.isNullOrUndefined)(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),(0,a.isNullOrUndefined)(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),(0,a.isNullOrUndefined)(this.selectedImageWidget)||this.selectedImageWidget.destroy(),(0,a.isNullOrUndefined)(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML="",(0,a.isNullOrUndefined)(this.imageResizerDivElement.parentElement)||this.imageResizerDivElement.parentElement.removeChild(this.imageResizerDivElement)),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.imageResizerPoints=void 0,this.resizeMarkSizeIn=void 0,this.currentPage=void 0,this.documentHelper=void 0,this.owner=void 0},e}(),Tc=function(){this.resizeContainerDiv=new Sa(0,0),this.topLeftRectParent=new Sa(0,0),this.topMiddleRectParent=new Sa(0,0),this.topRightRectParent=new Sa(0,0),this.bottomLeftRectParent=new Sa(0,0),this.bottomMiddleRectParent=new Sa(0,0),this.bottomRightRectParent=new Sa(0,0),this.leftMiddleRectParent=new Sa(0,0),this.rightMiddleRectParent=new Sa(0,0)},Hc=function(){function e(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e}(),Ec=function(){function e(e){this.version=0,this.owner=e}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collaborativeEditingSettings",{get:function(){return this.owner.documentEditorSettings.collaborativeEditingSettings},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CollaborativeEditing"},e.prototype.updateAction=function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var i=e[parseInt(t.toString(),10)];switch(i.action){case"LockContent":this.transFormLockRegion(i),this.lockRegion(i.selectionInfo.start,i.selectionInfo.end,i.author);break;case"SaveContent":this.version=i.version,this.updateRegion(i.author,i.data);break;case"UnlockContent":this.version=i.version,this.updateRegion(i.author,i.data),this.removeEditRange(i.author)}}},e.prototype.transFormLockRegion=function(e){var t=e.selectionInfo.previousLockInfo;if(!(0,a.isNullOrUndefined)(t)){var i=t.author,n=0,r=0;if(this.documentHelper.editRanges.containsKey(i)){var o=this.documentHelper.editRanges.get(i);if(o.length>0){var s=this.selection.getPosition(o[0]),l=this.selection.getHierarchicalIndexByPosition(s.endPosition).split(";"),d=t.end.split(";");n=parseInt(l[0],10)-parseInt(d[0],10),r=parseInt(l[1],10)-parseInt(d[1],10),e.selectionInfo.start.split(";")[0]===t.end.split(";")[0]?(e.selectionInfo.start=this.tranformPosition(e.selectionInfo.start,n,r),e.selectionInfo.end=this.tranformPosition(e.selectionInfo.end,n,r)):(e.selectionInfo.start=this.tranformPosition(e.selectionInfo.start,n,0),e.selectionInfo.end=this.tranformPosition(e.selectionInfo.end,n,0))}}}},e.prototype.lockContent=function(e){var t=this;if(this.canLock()){var i=this.owner.selectionModule.start,n=this.owner.selectionModule.end;if(this.owner.selectionModule.isForward||(i=this.owner.selectionModule.end,n=this.owner.selectionModule.start),i.paragraph.isInsideTable){var r=this.owner.documentHelper.layout.getParentTable(i.paragraph),o=this.owner.documentHelper.getFirstParagraphBlock(r);i.setPosition(o.childWidgets[0],!0)}else i.paragraphStartInternal(this.owner.selectionModule,!1);if(n.paragraph.isInsideTable){r=this.owner.documentHelper.layout.getParentTable(n.paragraph);var s=this.owner.documentHelper.getLastParagraphBlock(r),l=s.lastChild.getEndOffset();n.setPositionParagraph(s.lastChild,l)}else n.moveToParagraphEndInternal(this.owner.selectionModule,!1);var d=this.owner.selectionModule.getHierarchicalIndexByPosition(i),h=this.owner.selectionModule.getHierarchicalIndexByPosition(n),p={start:d,end:h,roomName:this.owner.documentEditorSettings.collaborativeEditingSettings.roomName,author:(0,a.isNullOrUndefined)(e)?this.owner.currentUser:e,version:this.version},u=this.selection.getParagraphInfo(i),g=this.selection.getParagraphInfo(n);this.owner.selectionModule.select(d,h);var m=new c;m.url=this.owner.serviceUrl+this.owner.serverActionSettings.canLock,m.contentType="application/json;charset=UTF-8",m.onSuccess=function(e){t.successHandler(e,p,u,g)},m.onFailure=this.failureHandler.bind(this),m.onError=this.failureHandler.bind(this),m.customHeaders=this.owner.headers,m.send(p)}},e.prototype.canLock=function(){var e=this.documentHelper.editRanges;if(e.containsKey(this.owner.currentUser))return!1;for(var t=e.keys,i=0;i<t.length;i++){var n=e.get(t[parseInt(i.toString(),10)]);if(!(0,a.isNullOrUndefined)(n)&&n.length>0&&this.isSelectionInEditableRange(n[0]))return!1}return!0},e.prototype.getPreviousLockedRegion=function(){var e=this.documentHelper.editRanges;if(!e.containsKey(this.owner.currentUser)){for(var t,i=e.keys,n=0;n<i.length;n++){var r=e.get(i[parseInt(n.toString(),10)])[0],o=this.selection.getPosition(r).startPosition;o.isExistBefore(this.selection.start)&&((0,a.isNullOrUndefined)(t)||o.isExistAfter(this.selection.getPosition(t).startPosition))&&(t=r)}return t}},e.prototype.unlockContent=function(e){if(this.documentHelper.editRanges.containsKey(e)){this.saveTimer&&clearTimeout(this.saveTimer);var t=JSON.stringify(this.serializeEditableRegion(e)),i={action:"UnlockContent",author:e,version:this.version,data:t,selectionInfo:{start:"",end:"",roomName:this.collaborativeEditingSettings.roomName,author:this.owner.currentUser,version:this.version},roomName:this.collaborativeEditingSettings.roomName};this.removeEditRange(e),this.owner.editorHistoryModule.clearHistory(),this.owner.fireContentChange(),this.owner.trigger(R,i)}},e.prototype.removeEditRange=function(e){this.documentHelper.editRanges.containsKey(e)&&(this.updateLockRegion(e,!1),this.owner.editorModule.removeUserRestrictionsInternal(this.documentHelper.editRanges.get(e)[0]),this.documentHelper.clearContent(),this.selection.updateEditRangeCollection(),this.documentHelper.owner.viewer.updateScrollBars())},e.prototype.saveContent=function(){var e=this;this.saveTimer&&clearTimeout(this.saveTimer);var t=this.collaborativeEditingSettings.saveTimeout;(0,a.isNullOrUndefined)(t)&&(t=3e3),this.saveTimer=Number(setTimeout((function(){e.saveContentInternal()}),t))},e.prototype.saveContentInternal=function(){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){var e=this.documentHelper.editRanges.get(this.owner.currentUser)[0],t=this.selection.getPosition(e),i={action:"SaveContent",author:this.owner.currentUser,version:this.version,data:JSON.stringify(this.serializeEditableRegion(this.owner.currentUser)),selectionInfo:{start:this.selection.getHierarchicalIndexByPosition(t.startPosition),end:this.selection.getHierarchicalIndexByPosition(t.endPosition),roomName:this.collaborativeEditingSettings.roomName,author:this.owner.currentUser,version:this.version},roomName:this.collaborativeEditingSettings.roomName};this.owner.trigger(R,i)}},e.prototype.serializeEditableRegion=function(e){var t=this.documentHelper.editRanges.get(e)[0],i=t.editRangeEnd,n=new ac(this.owner);n.setPosition(t.line,!0);var r=new ac(this.owner);r.setPosition(i.line,!1),this.owner.sfdtExportModule.isPartialExport=!0;var o=this.owner.sfdtExportModule.write(0,n.currentWidget,n.offset,r.currentWidget,r.offset,!1);return this.owner.sfdtExportModule.isPartialExport=!1,o},e.prototype.successHandler=function(e,t,i,n){if(JSON.parse(e.data).canLock){t.start=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),t.end=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());var r=this.getPreviousLockedRegion();if(r){var o=this.selection.getPosition(r);t.previousLockInfo={start:this.selection.getHierarchicalIndexByPosition(o.startPosition),end:this.selection.getHierarchicalIndexByPosition(o.endPosition),author:r.user,roomName:"",version:0}}var s={action:"LockContent",selectionInfo:t,author:this.owner.currentUser,version:this.version,data:"",roomName:this.collaborativeEditingSettings.roomName};this.owner.trigger(R,s)}else{var l=new a.L10n("documenteditor",this.owner.defaultLocale);l.setLocale(this.owner.locale),el.DialogUtility.alert({content:l.getConstant("Already locked"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.owner.enableRtl}},e.prototype.failureHandler=function(){var e=new a.L10n("documenteditor",this.owner.defaultLocale);e.setLocale(this.owner.locale),el.DialogUtility.alert({content:e.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"Center",Y:"Center"}}).enableRtl=this.owner.enableRtl},e.prototype.lockRegion=function(e,t,i){var n=this.selection.getTextPosBasedOnLogicalIndex(e),r=this.selection.getTextPosBasedOnLogicalIndex(t);this.lockRegionInternal(n,r,i)},e.prototype.lockRegionInternal=function(e,t,i){var n=this.owner.editorModule.addEditElement(i),r=n.editRangeEnd;this.insertElements(e,t,[r],[n]),this.updateLockInfo(n.paragraph,r.paragraph,i,!0),this.owner.viewer.updateScrollBars()},e.prototype.insertElements=function(e,t,i,n){var r=e.paragraph.equals(t.paragraph);(0,a.isNullOrUndefined)(n)||this.insertElementsInternal(e,n),(0,a.isNullOrUndefined)(i)||this.insertElementsInternal(t,i),this.documentHelper.layout.reLayoutParagraph(n[0].paragraph,0,0),r||this.documentHelper.layout.reLayoutParagraph(i[0].paragraph,0,0)},e.prototype.insertElementsInternal=function(e,t){var i=0;if(e.paragraph.isEmpty()){var n=e.paragraph;n.childWidgets[0].children.push(t[0]),t[0].line=n.childWidgets[0]}else{var r=e.currentWidget.getInline(e.offset,i),o=r.element;i=r.index;var s=t[0];this.insertElementInternal(o,s,i);for(var a=s.indexInOwner,l=s,d=1;d<t.length;d++)l=t[parseInt(d.toString(),10)],s.line.children.splice(a+d,0,l)}},e.prototype.insertElementInternal=function(e,t,i){var n=e.line,r=n.paragraph,o=e.indexInOwner,s=r.paragraphFormat.bidi&&e.isRightToLeft;i===e.length?(s||o++,n.children.splice(o,0,t)):0===i&&((0,a.isNullOrUndefined)(e.previousNode)?(n.children.splice(0,0,t),o=0):n.children.splice(o,0,t)),t.line=e.line},e.prototype.setEditableRegion=function(){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){var e=this.documentHelper.editRanges.get(this.owner.currentUser)[0],t=this.getParentBlock(e.paragraph);this.lockStart=this.owner.selectionModule.getHierarchicalIndex(t,"0").split(";")}},e.prototype.isSelectionInEditableRange=function(e){var t;if(!(0,a.isNullOrUndefined)(this.owner.selectionModule)){var i=this.owner.selectionModule.start,n=this.owner.selectionModule.end;this.owner.selectionModule.isForward||(i=(t=[n,i])[0],n=t[1]);var r=this.owner.selectionModule.getPosition(e);if((i.isExistAfter(r.startPosition)||i.isAtSamePosition(r.startPosition))&&(n.isExistBefore(r.endPosition)||n.isAtSamePosition(r.endPosition))||(r.startPosition.isExistAfter(i)||r.startPosition.isAtSamePosition(i))&&(r.endPosition.isExistBefore(n)||r.endPosition.isAtSamePosition(n))||r.startPosition.isExistAfter(i)&&r.startPosition.isExistBefore(n)&&(n.isExistAfter(r.endPosition)||n.isExistBefore(r.endPosition))||r.endPosition.isExistBefore(n)&&r.endPosition.isExistAfter(i)&&(i.isExistBefore(r.startPosition)||i.isExistAfter(r.startPosition)))return!0}return!1},e.prototype.updateRegion=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){var i=this.documentHelper.editRanges.get(e);1===i.length&&(this.documentHelper.editRanges.remove(e),i[0].removeEditRangeMark()),this.setEditableRegion();var n=i[0],r=n.editRangeEnd,o=this.getParentBlock(n.paragraph),s=this.getParentBlock(r.paragraph),l=this.isSelectionInEditableRange(n),d=void 0,h=void 0;this.owner.editorModule.isRemoveRevision=!0,l||(d=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.start),h=this.owner.selectionModule.getParagraphInfo(this.owner.selectionModule.end));for(var c=[];s!==o;){var p=s.combineWidget(this.owner.viewer);(s=p.previousRenderedWidget).bodyWidget.index!==p.bodyWidget.index&&c.push(p.bodyWidget);var u=p.containerWidget.childWidgets[p.indexInOwner];this.removeDuplicateCollection(u),p.containerWidget.removeChild(p.indexInOwner)}if(!(0,a.isNullOrUndefined)(o)){var g=o.index,m=o.containerWidget;c.push(m);var f=o.containerWidget.childWidgets.indexOf(o);u=m.childWidgets[f];m.removeChild(f),this.removeDuplicateCollection(u);var v=[],y=[],w=[];if(this.owner.editorModule.isPasteListUpdated=!1,this.owner.editorModule.getBlocks(JSON.parse(t),!1,y,v,w),c.length!==y.length){if(1===c.length){var b=c[0];c.unshift(this.owner.editorModule.splitBodyWidget(b,y[y.length-2].sectionFormat,b.childWidgets[f-1]))}if(c.length<y.length)for(var C=1;C<y.length-1;C++){var x=new Dd(this.owner.documentHelper);b=new Ol;x.bodyWidgets.push(b),b.page=x,c.splice(C,0,b),b.index=c[C-1].index,b.sectionFormat=new ga(b),b.sectionFormat.copyFormat(y[C].sectionFormat);var I=c[C-1].page.index;if(this.documentHelper.insertPage(I,x),this.owner.editorModule.updateSectionIndex(c[C-1].sectionFormat,c[C-1],!0),c.length===y.length)break}}for(var k=0;k<c.length;k++){var F=c[k],P=0,S=0;k===c.length-1&&(P=g,S=f);for(var T=y[k].childWidgets,H=0;H<T.length;H++)T[H].containerWidget=F,T[H].index=P,F.childWidgets.splice(S,0,T[H]),S++,P++;(s=T[T.length-1]).nextRenderedWidget&&s.nextRenderedWidget.index!==s.index&&this.updateNextBlocksIndex(s,!0),this.documentHelper.layout.layoutBodyWidgetCollection(T[0].index,F,void 0,!1)}for(var E=0;E<v.length;E++){var N=v[E];if(this.owner.editorModule.addCommentWidget(N,!1,this.owner.showComments,!1),N.replyComments.length>0)for(k=0;k<N.replyComments.length;k++)this.owner.commentReviewPane.addReply(N.replyComments[k],!1,!1)}w.length>0&&this.updateRevisionCollection(w),this.owner.trackChangesPane.updateTrackChanges();var W=this.documentHelper.editRanges.get(e);if(l){if(W.length>0){var O=this.selection.getPosition(W[0]);this.selection.selectPosition(O.endPosition,O.endPosition)}}else this.tranformSelection(d,h);this.tranformHistoryPosition(),this.selection.updateEditRangeCollection(),this.updateLockRegion(e),this.documentHelper.removeEmptyPages(),this.owner.viewer.updateScrollBars(),this.owner.editorModule.isRemoveRevision=!1}}},e.prototype.updateRevisionCollection=function(e){var t=0,i=this.getRevisionTextPosition(e[0]),n=!1;if(this.owner.revisionsInternal.changes.length>0&&!(0,a.isNullOrUndefined)(i))for(var r=0;r<this.owner.revisionsInternal.changes.length;r++){if(this.getRevisionTextPosition(this.owner.revisionsInternal.changes[r]).isExistAfter(i)){t=r,n=!0;break}}for(var o=0;o<e.length;o++)n?(this.owner.revisionsInternal.changes.splice(t,0,e[o]),t++):this.owner.revisionsInternal.changes.push(e[o])},e.prototype.getRevisionTextPosition=function(e){if(e.range.length>0){var t=e.range[0];if(t instanceof ql)return this.selection.getElementPosition(t).startPosition;if(t instanceof Ca){var i=t.ownerBase.firstChild.firstChild;if(i.bodyWidget)return this.selection.getTextPosBasedOnLogicalIndex(this.selection.getHierarchicalIndex(i,"0"))}else if(t instanceof ka){var n=t.ownerBase;if(n.lastChild.paragraph.bodyWidget){var r=n.getLength(),o=new ac(this.owner);return o.setPositionParagraph(n.lastChild,r),o}}}},e.prototype.tranformSelection=function(e,t){this.documentHelper.skipScrollToPosition=!0;var i=this.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),n=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());this.selection.select(i,n)},e.prototype.tranformHistoryPosition=function(){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){var e=this.documentHelper.editRanges.get(this.owner.currentUser)[0],t=this.getParentBlock(e.paragraph),i=this.selection.getHierarchicalIndex(t,"0").split(";");if(!(0,a.isNullOrUndefined)(this.lockStart)&&this.lockStart.length>1){var n=parseInt(i[0],10)-parseInt(this.lockStart[0],10),r=parseInt(i[1],10)-parseInt(this.lockStart[1],10);this.transformHistory(n,r)}}},e.prototype.transformHistory=function(e,t){if(this.owner.enableEditorHistory){var i=this.owner.editorHistoryModule.undoStack;if(!(0,a.isNullOrUndefined)(i))for(var n=0;n<i.length;n++)this.transformBaseHistoryInfo(i[n],e,t);var r=this.owner.editorHistoryModule.redoStack;if(!(0,a.isNullOrUndefined)(r))for(n=0;n<r.length;n++)this.transformBaseHistoryInfo(r[n],e,t)}},e.prototype.transformBaseHistoryInfo=function(e,t,i){if(e.endPosition&&(e.endPosition=this.tranformPosition(e.endPosition,t,i)),e.insertPosition&&(e.insertPosition=this.tranformPosition(e.insertPosition,t,i)),e.selectionStart&&(e.selectionStart=this.tranformPosition(e.selectionStart,t,i)),e.selectionEnd&&(e.selectionEnd=this.tranformPosition(e.selectionEnd,t,i)),e instanceof Cc)for(var n=e.modifiedActions,r=0;r<n.length;r++)this.transformBaseHistoryInfo(n[r],t,i)},e.prototype.tranformPosition=function(e,t,i){var n=e.split(";");return n[0]=(parseInt(n[0],10)+t).toString(),n[1]=(parseInt(n[1],10)+i).toString(),n.join(";")},e.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e.combineWidget(this.owner.viewer)},e.prototype.removeDuplicateCollection=function(e){if(this.removeFieldInBlock(e,!1,!1),this.removeFieldInBlock(e,!0,!1),this.removeFieldInBlock(e,!1,!0),e instanceof Al){for(var t=0;t<e.childWidgets.length;t++)if(e.childWidgets[t]instanceof Ul){var i=e.childWidgets[t];this.owner.editorModule.removeDeletedCellRevision(i)}}else this.owner.editorModule.removeRevisionForBlock(e,void 0,!1,!1)},e.prototype.removeFieldInBlock=function(e,t,i){e instanceof Al?this.removeFieldTable(e,t,i):(this.owner.editorModule.removeField(e,t,i),this.removeComment(e))},e.prototype.removeFieldTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.removeFieldInBlock(s.childWidgets[a],t,i)},e.prototype.removeComment=function(e){if(this.documentHelper.comments.length>0)for(var t=0;t<this.documentHelper.comments.length;t++){var i=this.documentHelper.comments[t];i.commentStart.line.paragraph===e&&(this.documentHelper.comments.splice(t,1),this.owner.commentReviewPane.deleteComment(i),t--)}},e.prototype.updateNextBlocksIndex=function(e,t){var i=e.getSplitWidgets().pop().nextRenderedWidget,n=1;i.bodyWidget.index===e.bodyWidget.index&&(n=e.index-i.index+1);var r=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof Ol)for(var o=e.containerWidget.index,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){var a=this.documentHelper.pages[s];if(a.bodyWidgets[0].index!==o)return;for(var l=r;l<a.bodyWidgets[0].childWidgets.length;l++){a.bodyWidgets[0].childWidgets[l].index+=n}r=0}},e.prototype.updateLockRegion=function(e,t){if((0,a.isNullOrUndefined)(e)&&(e=this.owner.currentUser),t=!!(0,a.isNullOrUndefined)(t)||t,this.documentHelper.editRanges.containsKey(e)){var i=this.documentHelper.editRanges.get(e);if(1===i.length&&!(0,a.isNullOrUndefined)(i[0].editRangeEnd)){var n=i[0];this.updateLockInfo(n.paragraph,n.editRangeEnd.paragraph,e,t)}}},e.prototype.updateLockInfo=function(e,t,i,n){e.isInsideTable&&(e=this.documentHelper.layout.getParentTable(e)),t.isInsideTable&&(t=this.documentHelper.layout.getParentTable(t));do{if(n?(e.lockedBy=i,e.locked=n):(e.lockedBy=void 0,e.locked=n),e===t)break;if(e=e.nextRenderedWidget,(0,a.isNullOrUndefined)(e))break}while(e)},e.prototype.pullAction=function(){var e=this;if(this.owner){var t=new c;t.url=this.owner.serviceUrl+this.owner.serverActionSettings.getPendingActions,t.contentType="application/json;charset=UTF-8",t.onSuccess=function(t){"string"==typeof t&&(t=JSON.parse(t)),e.updateAction(JSON.parse(t.data)),(0,el.hideSpinner)(e.owner.element)},t.onFailure=this.failureHandler.bind(this),t.onError=this.failureHandler.bind(this),t.customHeaders=this.owner.headers,(0,el.showSpinner)(this.owner.element),t.send({roomName:this.collaborativeEditingSettings.roomName,version:this.version})}},e.prototype.destroy=function(){this.owner=void 0},e}(),Nc=function(){function e(e,t){var i=this;this.isXmlPaneShow=!1,this.isAddedDocumentXml=!1,this.contextMenuInstance=void 0,this.DropDownListData=[{ID:"Choose",Value:"Choose an XML file"},{ID:"Add",Value:"(Add new part...)"}],this.hierarchicalData=[],this.field={dataSource:this.hierarchicalData,id:"id",text:"displayText",hasChildren:"hasChild",value:"displayValue",parentID:"pid",tooltip:"tooltip"},this.handleFileSelect=function(){var e=document.createElement("input");e.type="file",e.accept=".xml",e.onchange=function(e){var t=e.target;if(t.files&&t.files.length>0){var n=t.files[0];i.onFileSelect(n)}},e.click()},this.onClose=function(){i.showXmlProperties(!1),i.documentHelper.owner.selectionModule.closeXmlPane(),i.documentHelper.owner.documentEditorSettings.showNavigationPane=!1,i.documentHelper.updateFocus(),i.destroyInternal()},this.documentHelper=e,this.isRtl=t}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"XmlPane"},e.prototype.enableDisableElements=function(e){e?(0,a.classList)(this.element,[],["e-de-overlay"]):(0,a.classList)(this.element,["e-de-overlay"],[])},e.prototype.initializeXmlMapping=function(){var e=this,t=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale,this.documentHelper.owner.locale),i="xml_mapping_properties";this.element=(0,a.createElement)("div",{id:this.documentHelper.owner.element.id+i,className:"e-de-op"});var n=this.createDivTemplate("_header_footer",this.element,"padding-bottom:0");(0,a.classList)(n,["e-de-cntr-pane-padding"],[]),n.style.paddingLeft="0px";var r,o=(0,a.createElement)("label",{className:"e-de-prop-header-label"});o.innerHTML=t.getConstant("XML Mapping"),r=this.isRtl?"float:left;":"float:right;";var s=(0,a.createElement)("span",{id:"_header_footer_close",className:"e-de-ctnr-close e-de-close-icon e-icons",styles:"display:inline-block;cursor:pointer;"+r});s.addEventListener("click",(function(){e.onClose()})),n.appendChild(o),n.appendChild(s);var l=this.createDivTemplate(i+"_xml",this.element);(0,a.classList)(l,["e-de-cntr-pane-padding"],[]),l.style.paddingLeft="0px",l.style.paddingRight="5px",l.style.width="275px";var d=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"});d.innerHTML=t.getConstant("Custom XML Part"),l.appendChild(d);var h=this.createDivTemplate(i+"_xmlDiv",l),c=this.createDivTemplate(i+"_firstPageDiv",h);(0,a.classList)(c,["e-de-hdr-ftr-frst-div"],[]);var p=(0,a.createElement)("input",{id:i+"_firstPageDiv_dropdownlist",className:"e-de-prop-sub-label"});p.type="text",p.tabIndex=1,c.appendChild(p),this.positionLabelDiv=(0,a.createElement)("div",{id:i+"_positionLabelDiv",className:"e-de-scrollbar-hide",styles:"width:270px;height:310px;list-style:none;padding-right:5px;overflow:auto;"}),this.element.appendChild(this.positionLabelDiv);var u=(0,a.createElement)("div",{id:"tree",className:"e-de-scrollbar-hide",styles:"width:270px;height:310px;list-style:none;padding-right:5px;overflow:auto;"}),g=document.createElement("ul");g.contentEditable="false",g.style.width="auto",g.className="e-list-parent e-ul",g.style.paddingLeft="0px",g.id="e-de-pane-contextmenu-list",g.style.listStyle="none",g.style.margin="0px",g.style.maxHeight="auto",g.oncontextmenu=this.disableBrowserContextmenu,this.treeviewObject=new ua.TreeView({fields:this.field,cssClass:"e-de-custom-treeview"}),this.treeviewObject.appendTo(u),this.positionLabelDiv.appendChild(u),this.positionLabelDiv.appendChild(g),this.documentHelper.owner.editor.dictionaryObject[this.documentHelper.owner.editor.dictionaryObjectIndexIncrement++]={ID:"Default",Data:this.hierarchicalData},this.documentHelper.owner.editor.xmlData&&0===this.documentHelper.owner.editor.xmlData.length&&(this.documentHelper.owner.editor.xmlData=this.hierarchicalData)},e.prototype.initializeContextMenu=function(){var e={target:"#tree",items:[{text:"Insert Content control",id:"Insert",items:[{text:"Plain Text",id:"PlainText"},{text:"Picture",id:"Picture"},{text:"CheckBox",id:"CheckBox"},{text:"Combo Box",id:"ComboBox"},{text:"Dropdown List",id:"DropdownList"},{text:"Date Picker",id:"DatePicker"}]},{text:"Map to selected content control",id:"MapToSelectedContentControl"}],select:this.handleContextMenuItem.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this)};this.contextMenuInstance=new ua.ContextMenu(e,"#e-de-pane-contextmenu-list")},e.prototype.intializeDropDownList=function(){this.dropDownListObject=new al.DropDownList({dataSource:this.DropDownListData,fields:{text:"Value",value:"ID"},text:this.DropDownListData[0].Value,select:this.handleDropDownList.bind(this)}),this.dropDownListObject.appendTo("#xml_mapping_properties_firstPageDiv_dropdownlist")},e.prototype.handleDropDownList=function(e){for(var t,i=e.item.innerText,n=0;n<this.DropDownListData.length;n++)this.dropDownListObject.dataSource[n].Value==i&&(t=this.dropDownListObject.dataSource[n].ID);if("(Add new part...)"===i)this.documentHelper.owner.prefixMappings=" ",this.handleFileSelect();else if(/(no namespace)/.test(i)){this.documentHelper.owner.prefixMappings=" ";for(n=0;n<this.documentHelper.owner.editor.dictionaryObject.length;n++)t===this.documentHelper.owner.editor.dictionaryObject[n].ID&&this.handleTreeviewObject(n)}else if("Choose an XML file"===i)this.documentHelper.owner.prefixMappings=" ",this.handleTreeviewObject(0);else{this.documentHelper.owner.prefixMappings=i;for(n=0;n<this.documentHelper.owner.editor.dictionaryObject.length;n++)t===this.documentHelper.owner.editor.dictionaryObject[n].ID&&this.handleTreeviewObject(n)}},e.prototype.handleTreeviewObject=function(e){this.treeviewObject.fields.dataSource=this.documentHelper.owner.editor.dictionaryObject[e].Data,this.treeviewObject.dataBind(),this.documentHelper.owner.editor.xmlData=this.documentHelper.owner.editor.dictionaryObject[e].Data},e.prototype.contextMenuBeforeOpen=function(e){var t=this.documentHelper.owner.selection.currentContentControl,i=this.documentHelper.owner.getImageContentControl(),n=this.treeviewObject.selectedNodes;this.treeviewObject.getNode(n[0]).hasChildren&&(e.cancel=!0),(0,a.isNullOrUndefined)(this.contextMenuInstance)||((0,a.isNullOrUndefined)(t)&&(0,a.isNullOrUndefined)(i)?this.contextMenuInstance.enableItems(["Map to selected content control"],!1):this.contextMenuInstance.enableItems(["Map to selected content control"],!0))},e.prototype.handleContextMenuItem=function(e){var t=e.element.id;switch(t){case"RichText":case"PlainText":case"Picture":case"ComboBox":case"DropdownList":case"CheckBox":case"DatePicker":this.applyContentControl(t);break;case"MapToSelectedContentControl":var i=this.documentHelper.owner.selection.currentContentControl,n=this.documentHelper.owner.getImageContentControl();(0,a.isNullOrUndefined)(i)&&(0,a.isNullOrUndefined)(n)||(this.documentHelper.owner.isXmlMapCC=!0,this.documentHelper.owner.isXmlMapCC&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.editor.xmlData.length)&&this.documentHelper.owner.editor.xmlData.length>0&&this.getXmlPath(),this.documentHelper.owner.selection.selectContentInternal(i),"CheckBox"!==i.contentControlProperties.type&&this.insertContent(i))}},e.prototype.disableBrowserContextmenu=function(){return!1},e.prototype.applyContentControl=function(e){var t=this;this.documentHelper.owner.isXmlMapCC=!0,this.documentHelper.owner.isXmlMapCC&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.editor.xmlData.length)&&this.documentHelper.owner.editor.xmlData.length>0&&this.getXmlPath();var i=this.documentHelper.owner.selection.currentContentControl,n=this.documentHelper.owner.getImageContentControl();if((0,a.isNullOrUndefined)(i)&&(0,a.isNullOrUndefined)(n))switch(e){case"PlainText":this.documentHelper.owner.editor.insertContentControl("Text"),this.insertContent();break;case"RichText":this.documentHelper.owner.editor.insertContentControl("RichText"),this.insertContent();break;case"Picture":this.documentHelper.owner.showDialog("PictureContentControl");break;case"ComboBox":this.documentHelper.owner.editor.insertContentControl("ComboBox"),this.insertContent();break;case"DropdownList":this.documentHelper.owner.editor.insertContentControl("DropDownList"),this.insertContent();break;case"CheckBox":this.documentHelper.owner.editor.insertContentControl("CheckBox");break;case"DatePicker":this.documentHelper.owner.editor.insertContentControl("Date"),this.insertContent()}else{var r=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);r.setLocale(this.documentHelper.owner.locale),this.alertDialog=el.DialogUtility.alert({title:r.getConstant("Information"),content:r.getConstant("Discard Content Control"),okButton:{text:r.getConstant("Ok")},showCloseIcon:!0,closeOnEscape:!0,animationSettings:{effect:"Zoom"},position:{X:"center",Y:"center"},close:function(){t.closeDialogUtils.bind(t)}})}},e.prototype.insertContent=function(e){for(var t=this.treeviewObject.selectedNodes.toString(),i=1;i<this.documentHelper.owner.editor.xmlData.length;i++){if(t==this.documentHelper.owner.editor.xmlData[i].id.toString()&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.editor.xmlData[i].displayValue)){var n=this.documentHelper.owner.editor.xmlData[i].displayValue.toString();if(e)this.documentHelper.owner.editor.getResultContentControlText(e)!==n&&(this.documentHelper.owner.editor.insertText(n),this.documentHelper.owner.editor.addXmlProperties(e.contentControlProperties,this.documentHelper.owner.xPathString));else this.documentHelper.owner.editor.insertText(n)}}this.documentHelper.owner.isXmlMapCC=!1},e.prototype.updateContent=function(e,t){if(e===String.fromCharCode(9744)||e===String.fromCharCode(9746))this.updateCheckBoxContentControl(e,t);else{this.documentHelper.owner.xmlPaneModule.isXmlPaneShow&&this.updateXMLData(e);for(var i=this.documentHelper.selection.start.clone(),n=this.documentHelper.selection.end.clone(),r=0;r<this.documentHelper.contentControlCollection.length;r++){var o=this.documentHelper.contentControlCollection[r];if(o.contentControlProperties.xmlMapping&&o.contentControlProperties.xmlMapping.xPath===t&&"CheckBox"!==o.contentControlProperties.type)this.documentHelper.owner.editor.getResultContentControlText(o)!==e&&this.updateContentControl(o,e)}this.documentHelper.selection.selectRange(i,n)}},e.prototype.updateContentControl=function(e,t){this.documentHelper.selection.selectContentControlInternal(e),this.documentHelper.owner.editor.insertText(t)},e.prototype.updateCheckBoxContentControl=function(e,t){var i;e===String.fromCharCode(9746)?i="true":e===String.fromCharCode(9744)&&(i="false"),this.documentHelper.owner.xmlPaneModule.isXmlPaneShow&&this.updateXMLData(e);for(var n=this.documentHelper.selection.start.clone(),r=this.documentHelper.selection.end.clone(),o=0;o<this.documentHelper.contentControlCollection.length;o++){var s=this.documentHelper.contentControlCollection[o];s.contentControlProperties.xmlMapping&&s.contentControlProperties.xmlMapping.xPath===t&&"CheckBox"!==s.contentControlProperties.type?this.updateContentControl(s,i):s.contentControlProperties.xmlMapping&&s.contentControlProperties.xmlMapping.xPath===t&&"CheckBox"===s.contentControlProperties.type&&this.updateContentControl(s,e)}this.documentHelper.selection.selectRange(n,r)},e.prototype.updateXMLData=function(e){for(var t=this.treeviewObject.selectedNodes.toString(),i=1;i<this.documentHelper.owner.editor.xmlData.length;i++){t===this.documentHelper.owner.editor.xmlData[i].id.toString()&&((0,a.isNullOrUndefined)(this.documentHelper.owner.editor.xmlData[i].displayValue)||(this.documentHelper.owner.editor.xmlData[i].displayValue=e))}},e.prototype.getXmlPath=function(){for(var e=this.treeviewObject.selectedNodes.toString(),t="",i=Number(e)-1,n=this.documentHelper.owner.editor.xmlData.length-1;n>=0;n--)(0,a.isNullOrUndefined)(this.documentHelper.owner.editor.xmlData[i])||this.documentHelper.owner.editor.xmlData[i].pid!=this.documentHelper.owner.editor.xmlData[n].id.toString()||(t="\\"+this.documentHelper.owner.editor.xmlData[n].displayText+"[1]\\"+t,i=n);var r=Number(e)-1;this.documentHelper.owner.editor.xmlData[r]&&(t=t+this.documentHelper.owner.editor.xmlData[r].displayText.toString()+"[1]",this.documentHelper.owner.xPathString=t)},e.prototype.closeDialogUtils=function(){this.alertDialog.close(),this.alertDialog=void 0},e.prototype.createDivTemplate=function(e,t,i){var n;return n=i?(0,a.createElement)("div",{id:e,styles:i}):(0,a.createElement)("div",{id:e}),t.appendChild(n),n},e.prototype.onFileSelect=function(e){var t=this,i=new FileReader;i.onload=function(){var e=i.result;t.addDataFromCustomXML(e)},i.readAsText(e)},e.prototype.addDataFromCustomXML=function(e){this.documentHelper.owner.editor.getPrefixMapping(e);var t=this.documentHelper.owner.editor.parseXml(e),i=this.documentHelper.owner.editor.objectToArray(t);this.documentHelper.owner.editor.setXmlData(t,i),this.addingNewFileToDropDownList()},e.prototype.addingNewFileToDropDownList=function(){1==this.documentHelper.owner.editor.XMLFilesNameSpaceCount&&null==this.documentHelper.owner.prefixMappings?(this.DropDownListData.splice(this.DropDownListData.length-1,0,{ID:"(no namespace)_"+this.documentHelper.owner.editor.XMLFilesCount,Value:"(no namespace)"}),this.documentHelper.owner.editor.XMLFilesNameSpaceCount++):this.documentHelper.owner.editor.XMLFilesNameSpaceCount>1&&null==this.documentHelper.owner.prefixMappings?(this.DropDownListData.splice(this.DropDownListData.length-1,0,{ID:"(no namespace)_"+this.documentHelper.owner.editor.XMLFilesCount,Value:"(no namespace) ("+this.documentHelper.owner.editor.XMLFilesNameSpaceCount+")"}),this.documentHelper.owner.editor.XMLFilesNameSpaceCount++):this.documentHelper.owner.prefixMappings&&this.DropDownListData.splice(this.DropDownListData.length-1,0,{ID:"(no namespace)_"+this.documentHelper.owner.editor.XMLFilesCount,Value:this.documentHelper.owner.prefixMappings}),this.dropDownListObject.dataSource=this.DropDownListData,this.dropDownListObject.refresh(),this.dropDownListObject.value=this.DropDownListData[0].ID,this.dropDownListObject.text=this.DropDownListData[0].Value,this.documentHelper.owner.editor.XMLFilesCount++},e.prototype.showXmlProperties=function(t){if(this.isXmlPaneShow=t,t){if(this.localeValue=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localeValue.setLocale(this.documentHelper.owner.locale),!(0,a.isNullOrUndefined)(e)){this.initializeXmlMapping();this.documentHelper.owner.enableRtl?"display:inline-flex;direction:rtl;":"display:inline-flex;",this.documentHelper.optionsPaneContainer.insertBefore(this.documentHelper.owner.xmlPaneModule.element,this.documentHelper.viewerContainer),this.documentHelper.owner.isXmlPaneTool=!0}if(this.documentHelper.owner.resize(),t&&!this.contextMenuInstance&&(this.initializeContextMenu(),this.intializeDropDownList(),!this.isAddedDocumentXml)){this.isAddedDocumentXml=!0;for(var i=0;i<this.documentHelper.customXmlData.length;i++){var n=this.documentHelper.customXmlData.keys[i],r=this.documentHelper.customXmlData.get(n);(0,a.isNullOrUndefined)(r)||this.addDataFromCustomXML(r)}}this.documentHelper.updateViewerSize()}else this.documentHelper.updateViewerSize(),(0,a.isNullOrUndefined)(this.element)||"none"!==this.element.style.display&&(this.element.style.display="none"),this.destroyInternal(),this.documentHelper.owner.isXmlPaneTool=!1,this.documentHelper.owner.triggerResize()},e.prototype.clear=function(){if(this.DropDownListData.length>2)for(var e=0;e<this.DropDownListData.length;e++){var t=this.DropDownListData[e].ID;"Choose"!==t&&"Add"!==t&&(this.DropDownListData.splice(e,1),e--)}this.isAddedDocumentXml=!1},e.prototype.destroyInternal=function(){this.treeviewObject&&(this.treeviewObject.destroy(),this.treeviewObject=void 0),this.contextMenuInstance&&(this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0),this.positionLabelDiv&&(this.positionLabelDiv.innerHTML="",this.positionLabelDiv=void 0),this.dropDownListObject&&(this.dropDownListObject.destroy(),this.dropDownListObject=void 0),this.element&&(this.element.innerHTML="",this.element.parentElement&&this.element.parentElement.removeChild(this.element)),this.element=void 0},e.prototype.destroy=function(){this.treeviewObject&&(this.treeviewObject.destroy(),this.treeviewObject=void 0),this.contextMenuInstance&&(this.contextMenuInstance.destroy(),this.contextMenuInstance=void 0),this.positionLabelDiv&&(this.positionLabelDiv.innerHTML="",this.positionLabelDiv=void 0),this.dropDownListObject&&(this.dropDownListObject.destroy(),this.dropDownListObject=void 0),this.element&&(this.element.innerHTML="",this.element.parentElement&&this.element.parentElement.removeChild(this.element)),this.element=void 0,this.documentHelper=void 0},e}(),Wc=function(){function e(e){this.wordBefore="\\b",this.wordAfter="\\b",this.owner=e,this.documentHelper=this.owner.documentHelper}return e.prototype.find=function(e,t){var i=this.findNext(e,t,"0;0;0");if(!(0,a.isNullOrUndefined)(i)){var n={source:this.documentHelper.owner};this.documentHelper.owner.trigger(A,n)}return i},e.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;return this.findDocument(n,e,!0,t,i),n.length,n.currentSearchResult},e.prototype.stringToRegex=function(e,t){if(e.indexOf("\\")>-1&&(e=e.split("\\").join("\\\\")),e.indexOf("(")>-1||e.indexOf(")")>-1||e.indexOf(".")>-1||e.indexOf("[")>-1||e.indexOf("]")>-1||e.indexOf("$")>-1||e.indexOf("{")>-1||e.indexOf("}")>-1||e.indexOf("*")>-1||e.indexOf("|")>-1||e.indexOf("^")>-1||e.indexOf("?")>-1||e.indexOf("+")>-1){for(var i="",n=0;n<e.length;n++)"("===e[parseInt(n.toString(),10)]||")"===e[parseInt(n.toString(),10)]||"."===e[parseInt(n.toString(),10)]||"["===e[parseInt(n.toString(),10)]||"]"===e[parseInt(n.toString(),10)]||"$"===e[parseInt(n.toString(),10)]||"{"===e[parseInt(n.toString(),10)]||"}"===e[parseInt(n.toString(),10)]||"*"===e[parseInt(n.toString(),10)]||"|"===e[parseInt(n.toString(),10)]||"^"===e[parseInt(n.toString(),10)]||"?"===e[parseInt(n.toString(),10)]||"+"===e[parseInt(n.toString(),10)]?i+="\\"+e[parseInt(n.toString(),10)]:i+=e[parseInt(n.toString(),10)];e=i}return"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(e=this.wordBefore+e+this.wordAfter),RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},e.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,i=e.toString();return 0===i.length||i===t},e.prototype.findAll=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;if(this.findDocument(n,e,!1,t,i),n.length>0&&n.currentIndex<0&&(n.currentIndex=0),!(0,a.isNullOrUndefined)(n.currentSearchResult)){var r={source:this.documentHelper.owner};return this.documentHelper.owner.trigger(A,r),n}},e.prototype.getElementInfo=function(e,t,i,n,r,o,s,d,h){for(var c=e,p="",u=new l,g=0;;){if(e instanceof Zl&&!(0,a.isNullOrUndefined)(e.text)&&""!==e.text)u.add(e,h?p.length+g:p.length),g=0,p+=e===c?e.text.substring(t):e.text;else if(e instanceof _l){var m=e;(0,a.isNullOrUndefined)(m.fieldEnd)||(e=(0,a.isNullOrUndefined)(m.fieldSeparator)?m.fieldEnd:m.fieldSeparator)}else e instanceof hd&&!(0,a.isNullOrUndefined)(e.textFrame)&&e.textFrame.childWidgets.length>0&&this.findInlineText(e.textFrame,n,r,o,s,d);if(e instanceof Zl||e instanceof md||(g+=e.length),!(0,a.isNullOrUndefined)(e)&&(0,a.isNullOrUndefined)(e.nextNode)){var f=e.paragraph.nextSplitWidget;if(!h&&!(0,a.isNullOrUndefined)(f)&&f!==e.paragraph&&f.childWidgets.length>0&&f.childWidgets[0]instanceof zl&&f.childWidgets[0].children.length>0){e=f.childWidgets[0].children[0];continue}break}if(!(0,a.isNullOrUndefined)(e))if((0,a.isNullOrUndefined)(i)||i)e=e.nextNode;else{var v=e.line.children,y=e.line.children.length;if(!(v.indexOf(e)<y-1)){e=void 0;break}e=e.nextNode}}return{elementsWithOffset:u,fullText:p.toString()}},e.prototype.updateMatchedTextLocation=function(e,t,i,n,r,o,s,l){for(var d=0;d<e.length;d++){var h=e[parseInt(d.toString(),10)],c=void 0;if((0,a.isNullOrUndefined)(l)||!(h.index<l)){for(var p=t.addResult(),u=i.keys,g=!1,m=0;m<u.length;m++){var f=u[parseInt(m.toString(),10)],v=i.get(f),y=f.length;if(f===r&&(y-=n),(0,a.isNullOrUndefined)(p.start)&&h.index<v+y){var w=h.index-v;f===r&&(w+=n);var b=f.line.getOffset(f,w);p.start=this.getTextPosition(f.line,b.toString()),p.start.location=this.owner.selectionModule.getPhysicalPositionInternal(f.line,b,!0),p.start.setPositionParagraph(f.line,b),p.startOffset=this.owner.selectionModule.getHierarchicalIndexByPosition(p.start)}if(h.index+h[0].length<=v+y){w=h.index+h[0].length-v;if(f===r&&(w+=n),((0,a.isNullOrUndefined)(this.owner.searchModule.textSearchResults)||0===this.owner.searchModule.textSearchResults.length)&&" "!==f.text.charAt(f.text.length-1)&&!(0,a.isNullOrUndefined)(f.nextElement)&&(f.nextElement instanceof td||f.nextElement instanceof Bd)){for(var C=f.nextElement;C&&!((C=C.nextElement)instanceof Zl););if(C&&C instanceof Zl&&" "!==C.text.charAt(0)){g=!0;continue}}((0,a.isNullOrUndefined)(this.owner.searchModule.textSearchResults)||0===this.owner.searchModule.textSearchResults.length)&&f.previousElement&&(f.previousElement instanceof td||f.previousElement instanceof Bd)&&(g=!0);b=0;b=g?f.line.getOffset(f,0)+f.length:f.line.getOffset(f,w),p.end=this.getTextPosition(f.line,b.toString()),p.end.location=this.owner.selectionModule.getPhysicalPositionInternal(f.line,b,!0),p.end.setPositionParagraph(f.line,b),p.endOffset=this.owner.selectionModule.getHierarchicalIndexByPosition(p.end),c=!0;break}}if(o){t.currentIndex=0;break}if(t.currentIndex<0&&!(0,a.isNullOrUndefined)(s)&&(s.isExistBefore(p.start)||s.isAtSamePosition(p.start))&&(t.currentIndex=t.indexOf(p)),!(0,a.isNullOrUndefined)(l)&&c)break}}},e.prototype.findDocument=function(e,t,i,n,r){if(!this.isPatternEmpty(t)){void 0===n&&(n="None");var o,s=void 0,l=void 0;if(void 0!==r&&(l=this.owner.selectionModule.end),void 0!==r&&i&&void 0!==l&&void 0!==l.paragraph&&l.paragraph instanceof Rl){var d=0,h=l.currentWidget.getInline(this.owner.selectionModule.start.offset,d);if(s=h.element,d=h.index,!(0,a.isNullOrUndefined)(s)){var c=void 0;for(c=this.findInline(s,t,n,d,i,e,l);0===e.length&&!(0,a.isNullOrUndefined)(c);){for(;!(0,a.isNullOrUndefined)(c)&&0===c.childWidgets.length;)c=this.owner.selectionModule.getNextParagraph(c.containerWidget);if((0,a.isNullOrUndefined)(c))break;var p=c.childWidgets[0];if(s=p.children[0]instanceof md?p.children[2]instanceof Zl?p.children[2]:void 0:p.children[0],(0,a.isNullOrUndefined)(s))break;c=this.findInline(s,t,n,0,i,e,l)}if(e.length>0)return}}for(o=this.documentHelper.pages[0].bodyWidgets[0];!(0,a.isNullOrUndefined)(o)&&0===o.childWidgets.length;)o=o.nextWidget;if(!(0,a.isNullOrUndefined)(o)&&0!==o.childWidgets.length){this.findInlineText(o,t,n,i,e,l);for(var u=this.documentHelper.headersFooters,g=0;g<u.length;g++){var m=u[parseInt(g.toString(),10)];if(m)for(var f in m)if(Object.prototype.hasOwnProperty.call(m,f)){var v=m[parseInt(f.toString(),10)];(0,a.isNullOrUndefined)(v)||(0,a.isNullOrUndefined)(v.page)||this.findInlineText(v,t,n,i,e,l)}}var y=this.documentHelper.endnoteCollection;for(g=0;g<y.length;g++){var w=y[parseInt(g.toString(),10)];w&&((0,a.isNullOrUndefined)(w)||(0,a.isNullOrUndefined)(w.bodyWidget.page)||this.findInlineText(w.bodyWidget,t,n,i,e,l))}var b=this.documentHelper.footnoteCollection;for(g=0;g<b.length;g++){var C=b[parseInt(g.toString(),10)];C&&((0,a.isNullOrUndefined)(C)||(0,a.isNullOrUndefined)(C.bodyWidget.page)||this.findInlineText(C.bodyWidget,t,n,i,e,l))}i&&!(0,a.isNullOrUndefined)(e)&&e.length}}},e.prototype.findInlineText=function(e,t,i,n,r,o){for(var s=this.owner.documentHelper.getFirstParagraphBlock(e.childWidgets[0]);!(0,a.isNullOrUndefined)(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selectionModule.getNextParagraphBlock(s);for(;!(0,a.isNullOrUndefined)(s)&&s.childWidgets.length>0;){var l=s.childWidgets[0].children[0];if((0,a.isNullOrUndefined)(l))break;for(this.findInline(l,t,i,0,n,r,o),s=this.owner.selectionModule.getNextParagraphBlock(s);!(0,a.isNullOrUndefined)(s)&&(1===s.childWidgets.length&&0===s.childWidgets[0].children.length||!(0,a.isNullOrUndefined)(s.previousSplitWidget));)s=this.owner.selectionModule.getNextParagraphBlock(s)}n&&!(0,a.isNullOrUndefined)(r)&&r.length},e.prototype.findInline=function(e,t,i,n,r,o,s){for(var l,d=e,h=this.getElementInfo(e,n,void 0,t,i,r,o,s),c=h.fullText,p=[],u=h.elementsWithOffset;!(0,a.isNullOrUndefined)(l=t.exec(c));)p.push(l);if(this.updateMatchedTextLocation(p,o,u,n,d,r,s),!r)return this.owner.selectionModule.getNextParagraphBlock(e.line.paragraph)},e.prototype.getTextPosition=function(e,t){var i=new ac(this.owner),n=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(n),i},e}(),Oc=function(){function e(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0}),e}(),Bc=function(){function e(e){this.startIn=void 0,this.endIn=void 0,this.startOffset=void 0,this.endOffset=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){var e=this.documentHelper.selection.getTextPosBasedOnLogicalIndex(this.startOffset),t=this.documentHelper.selection.getTextPosBasedOnLogicalIndex(this.endOffset);return this.documentHelper.selection.getTextInternal(e,t,!1)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.start=void 0,this.end=void 0,this.startOffset=void 0,this.endOffset=void 0},e}(),Lc=function(){function e(e){this.currentIndex=-1,this.owner=e}return Object.defineProperty(e.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),e.prototype.addResult=function(){var e=new Bc(this.owner);return(0,a.isNullOrUndefined)(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},e.prototype.clearResults=function(){if(this.currentIndex=-1,!(0,a.isNullOrUndefined)(this.innerList))for(var e=this.innerList.length-1;e>=0;e--)this.innerList[parseInt(e.toString(),10)].destroy(),this.innerList.splice(e,1)},e.prototype.indexOf=function(e){return(0,a.isNullOrUndefined)(this.innerList)?-1:this.innerList.indexOf(e)},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.innerList)||this.clearResults(),this.innerList=void 0},e}(),Dc=function(){function e(e){this.searchModule=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate())},enumerable:!0,configurable:!0}),e.prototype.getTextSearchResultsOffset=function(){for(var e,t=[],i=0;i<this.searchModule.textSearchResults.innerList.length;i++)e=this.getOffset(this.searchModule.textSearchResults.innerList[parseInt(i.toString(),10)]),t.push(e);return t},e.prototype.getOffset=function(e){var t=e.start,i=e.end,n=this.searchModule.documentHelper.owner.selectionModule.getParagraphInfo(t),r=this.searchModule.documentHelper.owner.selectionModule.getHierarchicalIndex(n.paragraph,n.offset.toString());return n=this.searchModule.documentHelper.owner.selectionModule.getParagraphInfo(i),{startOffset:r,endOffset:this.searchModule.documentHelper.owner.selectionModule.getHierarchicalIndex(n.paragraph,n.offset.toString())}},e.prototype.getModuleName=function(){return"SearchResults"},e.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},e.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},e.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},e.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()},e}(),Rc=function(){function e(e){this.searchHighlighters=void 0,this.owner=e,this.searchHighlighters=new l,this.textSearch=new Wc(this.owner),this.textSearchResults=new Lc(this.owner),this.searchResultsInternal=new Dc(this)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Search"},e.prototype.find=function(e,t){(0,a.isNullOrUndefined)(t)&&(t="None");var i=this.textSearch.find(e,t);(0,a.isNullOrUndefined)(i)||this.navigate(i)},e.prototype.findAll=function(e,t){if(!(0,a.isNullOrUndefined)(e||""===e)){(0,a.isNullOrUndefined)(t)&&(t="None");var i=this.textSearch.findAll(e,t);!(0,a.isNullOrUndefined)(i)&&i.length>0&&(this.navigate(i.innerList[i.currentIndex]),this.highlight(i))}},e.prototype.replace=function(e,t,i){if((0,a.isNullOrUndefined)(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl||(0,a.isNullOrUndefined)(i))return 0;(0,a.isNullOrUndefined)(this.viewer)||this.clearSearchHighlight(),this.navigate(t);var n=this.documentHelper.selection.start;if(this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget){this.documentHelper.selection.end.currentWidget.getInline(this.owner.selectionModule.start.offset,0).element.revisions.length>0&&(this.isRepalceTracking=!0)}if(i.indexOf(t)<0)return 0;this.owner.editorModule.insertTextInternal(e,!0);var r=t.end,o=new ac(this.viewer.owner);if(0===r.currentWidget.children.length){var s=r.currentWidget.paragraph.childWidgets[0];o.setPositionParagraph(s,n.offset-e.length)}else o.setPositionParagraph(r.currentWidget,n.offset-e.length);this.documentHelper.selection.selectRange(n,o);var l={source:this.viewer.owner};return this.viewer.owner.trigger(A,l),1},e.prototype.replaceInternal=function(e,t){if(""!==e&&!(0,a.isNullOrUndefined)(e)){(0,a.isNullOrUndefined)(t)&&(t="None");var i=this.textSearchResults.currentSearchResult.text,n=this.viewer.owner.searchModule.textSearch.stringToRegex(i,t),r=this.owner.selectionModule.end.getHierarchicalIndexInternal(),o=this.textSearchResults.currentSearchResult;(0,a.isNullOrUndefined)(o)&&(o=this.viewer.owner.searchModule.textSearch.findNext(n,t,r)),(0,a.isNullOrUndefined)(o)||(this.navigate(o),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.replace(e,o,this.textSearchResults),r=this.owner.selectionModule.end.getHierarchicalIndexInternal(),(o=this.textSearch.findNext(i,t,r))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.navigate(o)))}},e.prototype.replaceAll=function(e,t){if(this.documentHelper.layout.isReplacingAll=!0,(0,a.isNullOrUndefined)(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||(0,a.isNullOrUndefined)(t))return 0;this.owner.editorHistoryModule&&this.owner.editorHistoryModule.initComplexHistory(this.owner.selectionModule,"ReplaceAll");var i=t.length;this.viewer.owner.isLayoutEnabled=!1;for(var n=t.innerList[0].text,r=i-1;r>=0;r--){var o=t.innerList[parseInt(r.toString(),10)];if(0===o.start.currentWidget.children.length)r=(t=this.textSearch.findAll(n)).length;else{if(this.navigate(o),this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl)continue;var s=!0;if(r>0)t.innerList[r-1].start.paragraph.equals(o.start.paragraph)&&(s=!1);this.owner.editorModule.insertTextInternal(e,!0,void 0,s),o.destroy()}}return this.owner.editorHistoryModule&&!(0,a.isNullOrUndefined)(this.owner.editorHistoryModule.currentHistoryInfo)?this.owner.editorHistoryModule.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),this.documentHelper.layout.isReplacingAll=!1,i},e.prototype.replaceAllInternal=function(e,t){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(t)&&(t="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},e.prototype.navigate=function(e){if(e){var t=e.startOffset,i=e.endOffset;(0,a.isNullOrUndefined)(this.owner)||(0,a.isNullOrUndefined)(this.owner.selectionModule)||(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(i)||(this.owner.selectionModule.select(t,i),this.documentHelper.updateFocus())}},e.prototype.highlight=function(e){this.searchHighlighters=new l;for(var t=0;t<e.innerList.length;t++){var i=e.innerList[parseInt(t.toString(),10)];this.highlightResult(i)}this.viewer.renderVisiblePages()},e.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},e.prototype.highlightSearchResult=function(e,t,i){var n=0,r=0,o=null,s=null,l=this.documentHelper.selection.getStartLineWidget(e,t,o,n);n=l.index;var d=(o=l.element)?o.line:e.childWidgets[0],h=this.documentHelper.selection.getEndLineWidget(i,s,r);r=h.index;var c=(s=h.element)?s.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],p=this.documentHelper.selection.getTop(d),u=this.documentHelper.selection.getLeftInternal(d,o,n);if((0,a.isNullOrUndefined)(d)||d!==c){if(!(0,a.isNullOrUndefined)(d)){e!==d.paragraph&&(e=d.paragraph);y=this.documentHelper.selection.getWidth(d,!0)-(u-d.paragraph.x);if(e.bidi||o instanceof Zl&&o.isRightToLeft){f=0;var g=this.documentHelper.selection.getElementsForward(d,o,s,e.bidi);if(g)for(x=!1,b=0;b<g.length;b++){I=(C=g[b])instanceof Zl?C.length:1;f=this.documentHelper.selection.getLeftInternal(d,C,I),x=!1,u=C===o?this.documentHelper.selection.getLeftInternal(d,C,n):this.documentHelper.selection.getLeftInternal(d,C,0),C instanceof Zl&&(x=C.isRightToLeft),y=Math.abs(f-u),this.createHighlightBorder(d,y,x?f:u,p)}}else this.createHighlightBorder(d,y,u,p);var m=d.paragraph.childWidgets.indexOf(d);for(b=0;b<e.childWidgets.length;b++){if(e===d.paragraph&&(m+=1),this.highlightSearchResultParaWidget(e,m,c,s,r),e===c.paragraph)return;m=0,e=c.paragraph,b--}}}else{var f=this.documentHelper.selection.getLeftInternal(c,s,r),v=!1;s instanceof Zl&&(v=s.isRightToLeft);var y=0;if(y=Math.abs(f-u),!v&&o instanceof Zl&&(v=o.isRightToLeft),v||e.bidi){var w=this.documentHelper.selection.getElementsForward(d,o,s,e.bidi);if(w&&w.length>1)for(var b=0;b<w.length;b++){var C,x=!1,I=(C=w[b])instanceof Zl?C.length:1;C===o?(u=this.documentHelper.selection.getLeftInternal(d,C,n),f=this.documentHelper.selection.getLeftInternal(d,C,I)):C===s?(u=this.documentHelper.selection.getLeftInternal(d,C,0),f=this.documentHelper.selection.getLeftInternal(d,C,r)):(u=this.documentHelper.selection.getLeftInternal(d,C,0),f=this.documentHelper.selection.getLeftInternal(d,C,I)),C instanceof Zl&&(x=C.isRightToLeft),y=Math.abs(f-u),this.createHighlightBorder(d,y,x?f:u,p)}else this.createHighlightBorder(d,y,v?f:u,p)}else this.createHighlightBorder(d,y,u,p)}},e.prototype.createHighlightBorder=function(e,t,i,n){var r=this.addSearchHighlightBorder(e),o=this.viewer.owner.selectionModule.getPage(e.paragraph);o.boundingRectangle.y,o.boundingRectangle.x;r.left=Math.ceil(i),n=Math.ceil(n),r.width=Math.floor(t);Math.floor(e.height),this.documentHelper.containerContext},e.prototype.addSearchHighlightBorder=function(e){var t=void 0,i=this.searchHighlighters;i.containsKey(e)?t=i.get(e):(t=[],i.add(e,t));var n=new Oc(0,0);return t.push(n),n},e.prototype.highlightSearchResultParaWidget=function(e,t,i,n,r){for(var o=0,s=0,a=!1,l=t;l<e.childWidgets.length;l++){var d=e.childWidgets[l];l===t&&(o=this.documentHelper.selection.getTop(d));var h=this.documentHelper.selection.getLeft(d);if(n instanceof Zl&&(a=n.isRightToLeft),d===i){var c=0;if(a||e.bidi){for(var p=this.documentHelper.selection.getElementsBackward(d,n,n,e.bidi),u=0;u<p.length;u++){var g=p[u],m=!1;if(h=this.documentHelper.selection.getLeftInternal(d,g,0),g===n)c=this.documentHelper.selection.getLeftInternal(d,g,r);else{var f=g instanceof Zl?g.length:1;c=this.documentHelper.selection.getLeftInternal(d,g,f)}g instanceof Zl&&(m=g.isRightToLeft),s=Math.abs(c-h),this.createHighlightBorder(d,s,m?c:h,o)}return}return c=this.documentHelper.selection.getLeftInternal(i,n,r),s=Math.abs(c-h),void this.createHighlightBorder(d,s,a?c:h,o)}s=this.documentHelper.selection.getWidth(d,!0)-(h-e.x),this.createHighlightBorder(d,s,h,o),o+=d.height}},e.prototype.addSearchResultItems=function(e){(0,a.isNullOrUndefined)(e)||""===e||((0,a.isNullOrUndefined)(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},e.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.addFindResultViewForSearch(i)}},e.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var t=void 0,i=0,n=e.start.currentWidget.getInline(e.start.offset,i),r=n.element;i=n.index;var o="",s=0;if(r instanceof _l){var a=this.owner.selectionModule.getRenderedInline(r,i);a.element.nextNode instanceof Zl?(r=a.element.nextNode,i=a.index):(r=a.element,i=a.index)}var l=this.owner.selectionModule.getElementBoxInternal(r,i),d=l.element;if(i=l.index,null!=d){d instanceof Zl&&i>0&&(o=d.text.substring(0,i));var h=d.line.children.indexOf(d);for(s=o.lastIndexOf(" ");s<0&&h>0&&d.line.children[h-1]instanceof Zl;)o=d.line.children[h-1].text+o,h--,s=o.lastIndexOf(" ")}var c=o.lastIndexOf("\v");c>0?o=o.substring(0,c):(s=o.lastIndexOf(" "))<0?o:o.substring(s+1),e.text;var p=0,u=e.end.currentWidget.getInline(e.end.offset,p),g=u.element;if(p=u.index,t="",null!=l&&(d=(l=this.owner.selectionModule.getElementBoxInternal(g,p)).element,p=l.index),null!=d){d instanceof Zl&&p<d.length&&(t=d.text.substring(p));for(h=d.line.children.indexOf(d);h+1<d.line.children.length&&d.line.children[h+1]instanceof Zl||d.line.children[h+1]instanceof _l;)d.line.children[h+1]instanceof _l?h+=2:(t+=d.line.children[h+1].text,h+=1)}s=t.lastIndexOf(" "),t="\v"===t?t="":t;var m="",f="",v=e.start.paragraph.containerWidget,y=v instanceof Bl?v.headerFooterType:"";-1!=y.indexOf("Header")?m='<span class="e-de-header-footer-list">Header: </span>':-1!=y.indexOf("Footer")&&(f='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",m='<span class="e-de-header-footer-list">Footer: </span>'),f='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",this.addSearchResultItems(f)}},e.prototype.clearSearchHighlight=function(){(0,a.isNullOrUndefined)(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);var e={source:this.viewer.owner};this.viewer.owner.trigger(A,e)},e.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy(),this.textSearchResults=void 0,this.owner=void 0},e}(),Mc=function(){function e(e){var t=this;this.isOptionsPaneShow=!1,this.findOption="None",this.matchCase=void 0,this.wholeWord=void 0,this.searchText="Navigation",this.resultsText="Results",this.messageDivText="No matches",this.replaceButtonText="Replace",this.replaceAllButtonText="Replace All",this.focusedIndex=-1,this.focusedElement=[],this.isOptionsPane=!0,this.replacePaneText="Replace",this.findPaneText="Find",this.headingPaneText="Heading",this.matchDivReplaceText="No matches",this.isHeadingTab=!1,this.isBuildHeading=!1,this.tabInstance=void 0,this.isReplace=!1,this.isUpdateHeading=!1,this.searchOptionChange=function(){t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight();var e=t.searchInput.value;if(""!==e){var i=t.documentHelper.owner.searchModule.textSearch.stringToRegex(e,t.findOption),n=t.documentHelper.selection.end.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(i,t.findOption,n),null!=t.results&&t.results.length>0?t.navigateSearchResult(!1):(t.viewer.renderVisiblePages(),t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="")}},this.onEnableDisableReplaceButton=function(){0!==t.searchInput.value.length?(t.replaceButton.disabled=!1,t.replaceAllButton.disabled=!1):(t.replaceButton.disabled=!0,t.replaceAllButton.disabled=!0),!(0,a.isNullOrUndefined)(t.searchInput.value)&&t.searchInput.value.match(/[!\@\#$%\^&*\(\)_\-+\=\[\]\{\};:"\|,.<>\/?`~\s\\؟°÷×،؛]/)&&""!==t.searchInput.value?(t.wholeWord.checked=!1,t.wholeWord.disabled=!0):t.wholeWord.disabled=!1},this.onKeyDownOnOptionPane=function(e){if(9===e.keyCode){e.preventDefault();var i=void 0;i=e.shiftKey?0===t.focusedIndex||(0,a.isNullOrUndefined)(t.focusedIndex)?t.focusedElement.length-1:t.focusedIndex-1:t.focusedElement.length-1===t.focusedIndex||(0,a.isNullOrUndefined)(t.focusedIndex)?0:t.focusedIndex+1,(o=t.focusedElement[i]).focus(),o instanceof HTMLInputElement&&o.select(),t.focusedIndex=i,o instanceof HTMLLIElement&&t.scrollToPosition(o)}else if(13===e.keyCode){if(t.hideMatchDiv(),e.target!==t.searchInput&&e.target!==t.closeButton)if(e.preventDefault(),-1!==(r=t.focusedElement.indexOf(e.target))){var n=t.focusedElement[r];n.click(),n.focus(),t.focusedIndex=r}}else if((40===e.keyCode||38===e.keyCode)&&"none"!==t.resultsListBlock.style.display){var r=void 0,o=void 0;40===e.keyCode?t.focusedIndex>7?t.focusedIndex+1<t.focusedElement.length&&((o=t.focusedElement[t.focusedIndex+1]).focus(),t.focusedIndex=t.focusedIndex+1):(r=t.focusedElement.length-t.resultsListBlock.children.length+t.results.currentIndex+1)<t.focusedElement.length&&((o=t.focusedElement[r]).focus(),t.focusedIndex=r):t.focusedIndex>6&&(r=t.focusedIndex-1,(o=t.focusedElement[r]).focus(),t.focusedIndex=r)}},this.onReplaceButtonClick=function(){t.optionsPane;var e=t.searchInput.value,i=t.replaceWith.value,n=t.documentHelper.owner.searchModule.textSearchResults;if(""!==e&&!(0,a.isNullOrUndefined)(e)&&null!=t.documentHelper.owner.selectionModule){var r=t.documentHelper.owner.selectionModule.text;if(t.documentHelper.owner.selectionModule.isEmpty||(t.documentHelper.owner.selectionModule.isForward?t.documentHelper.owner.selectionModule.selectContent(t.documentHelper.owner.selectionModule.start,!0):t.documentHelper.owner.selectionModule.selectContent(t.documentHelper.owner.selectionModule.end,!0)),(0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(n.currentSearchResult))t.documentHelper.owner.searchModule.findAll(e,t.findOption),t.messageDiv.style.display="block",t.messageDiv.innerHTML=t.localeValue.getConstant(t.matchDivReplaceText);else{var o=n.currentSearchResult;if(t.documentHelper.owner.searchModule.navigate(o),o.text===r){var s=(0,a.isNullOrUndefined)(i)?"":i;t.documentHelper.owner.searchModule.replace(s,o,n);var l=t.documentHelper.owner.searchModule.textSearch.stringToRegex(e,t.findOption),d=t.documentHelper.selection.end.getHierarchicalIndexInternal();t.results=t.documentHelper.owner.searchModule.textSearch.findAll(l,t.findOption,d),(0,a.isNullOrUndefined)(t.results)||(0,a.isNullOrUndefined)(t.results.currentSearchResult)?(t.messageDiv.style.display="block",t.messageDiv.innerHTML=t.localeValue.getConstant(t.matchDivReplaceText)):t.documentHelper.owner.searchModule.navigate(t.results.currentSearchResult),t.documentHelper.owner.findResultsList=[],!(0,a.isNullOrUndefined)(t.results)&&t.results.innerList.length>0?t.navigateSearchResult(!0):t.resultsListBlock.innerHTML=""}else t.documentHelper.owner.searchModule.findAll(e,t.findOption)}}},this.onReplaceAllButtonClick=function(){t.replaceAll(),t.resultsListBlock.style.display="none",t.messageDiv.innerHTML="",t.documentHelper.updateFocus()},this.searchIconClickInternal=function(){var e=document.getElementById(t.documentHelper.owner.containerId+"_option_search_text_box"),i=e.value;if(""!==i){if(t.hideMatchDiv(),t.searchIcon.classList.contains("e-de-op-search-close-icon"))return t.searchIcon.classList.add("e-de-op-search-icon"),t.searchIcon.classList.remove("e-de-op-search-close-icon"),e.value="",t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.matchDiv.style.display="none",t.occurrenceDiv.style.display="none",t.onEnableDisableReplaceButton(),t.clearFocusElement(),t.resultsListBlock.innerHTML="",t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight(),void t.viewer.renderVisiblePages();t.searchIcon.classList.contains("e-de-op-search-icon")&&i.length>=1&&(t.searchIcon.classList.add("e-de-op-search-close-icon"),t.searchIcon.classList.remove("e-de-op-search-icon"),t.onEnableDisableReplaceButton()),t.clearSearchResultItems(),t.documentHelper.owner.searchModule.clearSearchHighlight();var n=t.documentHelper.owner.searchModule.textSearch.stringToRegex(i,t.findOption),r=t.documentHelper.selection.end.getHierarchicalIndexInternal();if(t.results=t.documentHelper.owner.searchModule.textSearch.findAll(n,t.findOption,r),null!=t.results&&t.results.length>0){var o=t.results.innerList[t.results.currentIndex].start,s=t.results.innerList[t.results.currentIndex].end;t.documentHelper.scrollToPosition(o,s,!0),t.navigateSearchResult(!1),t.getMessageDivHeight();t.isOptionsPane;var a=t.optionsPane.offsetHeight-t.findTab.offsetHeight;t.resultsListBlock.style.height=a+"px"}else t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="block",t.resultsListBlock.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML=""}},this.navigateNextResultButtonClick=function(){if(null!=document.getElementById(t.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(t.documentHelper.owner.containerId+"_list_box_container").style.display){var e=t.documentHelper.owner.selectionModule.end,i=void 0,n=0;e.isExistAfter(t.results.currentSearchResult.start)&&(n=t.results.currentIndex);for(var r=n;r<t.results.length;r++){var o=t.results.innerList[r];if(e.isExistBefore(o.start)||e.isAtSamePosition(o.start)){i=o,t.results.currentIndex=r;break}}(0,a.isNullOrUndefined)(i)&&(t.results.currentIndex=0,i=t.results.innerList[0]),t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(t.results.currentIndex+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.updateListItems(i),t.focusedIndex=t.focusedElement.indexOf(t.navigateToNextResult)}},this.navigatePreviousResultButtonClick=function(){if(null!=document.getElementById(t.documentHelper.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(t.documentHelper.owner.containerId+"_list_box_container").style.display){var e=void 0,i=t.documentHelper.owner.selectionModule.start,n=t.results.currentIndex;i.isExistAfter(t.results.currentSearchResult.start)&&(n=t.results.length-1);for(var r=n;r>=0;r--){var o=t.results.innerList[r];if(i.isExistAfter(o.start)||t.documentHelper.owner.selectionModule.end.isAtSamePosition(o.start)){e=o,t.results.currentIndex=r;break}}(0,a.isNullOrUndefined)(e)&&(t.results.currentIndex=t.results.length-1,e=t.results.innerList[t.results.currentIndex]),t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(t.results.currentIndex+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.updateListItems(e),t.focusedIndex=t.focusedElement.indexOf(t.navigateToPreviousResult)}},this.onKeyDown=function(e){var i=e.which||e.keyCode;13===i&&9!==e.keyCode&&40!==e.keyCode?(e.preventDefault(),t.findDiv.style.height="",t.onKeyDownInternal()):8===i&&0===t.searchInput.value.length?t.resultContainer.style.display="block":9!==e.keyCode&&40!==e.keyCode&&27!==e.keyCode?(t.documentHelper.owner.searchModule.clearSearchHighlight(),t.clearSearchResultItems(),t.viewer.renderVisiblePages(),t.resultsListBlock.style.display="none",t.messageDiv.innerHTML=t.localeValue.getConstant("No matches"),t.resultContainer.style.display="none",t.clearFocusElement(),t.resultsListBlock.innerHTML="",t.searchIcon.classList.contains("e-de-op-search-close-icon")&&(t.searchIcon.classList.add("e-de-op-search-icon"),t.searchIcon.classList.remove("e-de-op-search-close-icon"))):27===i&&27===e.keyCode&&(t.showHideOptionsPane(!1),t.documentHelper.owner.documentEditorSettings.showNavigationPane=!1,t.documentHelper.updateFocus())},this.close=function(){t.clearFocusElement(),t.showHideOptionsPane(!1),t.documentHelper.owner.documentEditorSettings.showNavigationPane=!1,t.resultsListBlock.innerHTML="",t.focusedIndex=1,t.isOptionsPane=!0,t.documentHelper.updateFocus()},this.resultListBlockClick=function(e){for(var i,n=e.target,r=t.resultsListBlock.children,o=0,s=0;s<r.length;s++){var a=r[s];a.classList.contains("e-de-search-result-hglt")&&(a.classList.remove("e-de-search-result-hglt"),a.children[0].classList.remove("e-de-op-search-word-text"),a.classList.add("e-de-search-result-item"))}for(s=0;s<r.length;s++)n===r[s]&&(o=s,(i=r[s]).classList.contains("e-de-search-result-item")&&(i.classList.remove("e-de-search-result-item"),i.classList.add("e-de-search-result-hglt"),i.children[0].classList.add("e-de-op-search-word-text"),t.focusedIndex=t.focusedElement.indexOf(i)));var l=t.results.innerList[o];t.results.currentIndex=o,t.messageDiv.innerHTML=t.localeValue.getConstant("Result")+" "+(o+1)+" "+t.localeValue.getConstant("of")+" "+t.resultsListBlock.children.length,t.documentHelper.owner.searchModule.navigate(l),t.documentHelper.owner.searchModule.highlight(t.results),i&&i.focus()},this.documentHelper=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"OptionsPane"},e.prototype.initOptionsPane=function(e,t){this.viewer;this.localeValue=e,this.optionsPane=(0,a.createElement)("div",{className:"e-de-op",styles:"display:none;"}),this.optionsPane.addEventListener("keydown",this.onKeyDownOnOptionPane),this.findTab=(0,a.createElement)("div",{id:this.documentHelper.owner.containerId+"_findTabDiv",className:"e-de-op-tab"}),this.optionsPane.appendChild(this.findTab),this.searchDiv=(0,a.createElement)("div",{className:"e-de-op-header",innerHTML:e.getConstant(this.searchText)}),this.findTab.appendChild(this.searchDiv),this.closeButton=(0,a.createElement)("button",{className:"e-de-op-close-button e-de-close-icon e-de-op-icon-btn e-btn e-flat e-icon-btn",id:"close",attrs:{type:"button"}}),this.closeButton.setAttribute("aria-label",e.getConstant("Close")),this.findTab.appendChild(this.closeButton);var i=(0,a.createElement)("span",{className:"e-de-op-close-icon e-de-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(i),this.focusedElement.push(this.closeButton),this.tabDiv=(0,a.createElement)("div"),this.findTab.appendChild(this.tabDiv),this.findTabButton=(0,a.createElement)("div",{innerHTML:e.getConstant(this.findPaneText)}),this.replaceTabButton=(0,a.createElement)("div",{innerHTML:e.getConstant(this.replacePaneText)}),this.headingTabButton=(0,a.createElement)("div",{innerHTML:e.getConstant(this.headingPaneText)});var n,r=[{header:{text:this.headingTabButton}},{header:{text:this.findTabButton}},{header:{text:this.replaceTabButton}}];this.tabInstance=new ua.Tab({items:r,enableRtl:t,selected:this.selectedTabItem.bind(this)}),this.tabInstance.isStringTemplate=!0,this.tabInstance.appendTo(this.tabDiv),this.findTabContentDiv=(0,a.createElement)("div",{className:"e-de-search-tab-content",styles:"display:none;"}),this.findTab.appendChild(this.findTabContentDiv),this.searchTextBoxContainer=(0,a.createElement)("div",{className:"e-input-group e-de-op-input-group"}),this.findTabContentDiv.appendChild(this.searchTextBoxContainer),this.searchInput=(0,a.createElement)("input",{className:"e-input e-de-search-input",id:this.documentHelper.owner.containerId+"_option_search_text_box",attrs:{placeholder:e.getConstant("Search for")}}),this.searchTextBoxContainer.appendChild(this.searchInput),this.searchIcon=(0,a.createElement)("span",{className:"e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon",id:this.documentHelper.owner.containerId+"_search-icon"}),this.searchIcon.tabIndex=0,this.searchTextBoxContainer.appendChild(this.searchIcon),this.focusedElement.push(this.searchIcon),this.navigateToPreviousResult=(0,a.createElement)("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon"}),this.navigateToPreviousResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult),this.focusedElement.push(this.navigateToPreviousResult),this.navigateToNextResult=(0,a.createElement)("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon"}),this.navigateToNextResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToNextResult),this.focusedElement.push(this.navigateToNextResult),this.checkboxDiv=(0,a.createElement)("div",{className:"e-de-op-more-less",styles:"display:none"}),this.matchInput=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_matchCase"}),this.checkboxDiv.appendChild(this.matchInput),this.matchCase=new tl.CheckBox({label:e.getConstant("Match case"),enableRtl:t,checked:!1,change:this.matchChange.bind(this)}),this.matchCase.appendTo(this.matchInput),this.focusedElement.push(this.matchInput),this.matchInput.tabIndex=0,n=t?"_e-de-rtl":"_e-de-ltr",this.wholeInput=(0,a.createElement)("input",{attrs:{type:"checkbox"},id:this.documentHelper.owner.containerId+"_wholeWord"+n}),this.checkboxDiv.appendChild(this.wholeInput),this.wholeWord=new tl.CheckBox({label:e.getConstant("Whole words"),enableRtl:t,checked:!1,change:this.wholeWordsChange.bind(this)}),this.wholeWord.appendTo(this.wholeInput),this.focusedElement.push(this.wholeInput),this.wholeInput.tabIndex=0,this.findTab.appendChild(this.checkboxDiv),this.replaceTabContentDiv=(0,a.createElement)("div",{className:"e-de-op-replacetabcontentdiv",styles:"display:none;"}),this.findTab.appendChild(this.replaceTabContentDiv),this.createReplacePane(t),this.resultContainer=(0,a.createElement)("div",{styles:"width:85%;display:none;",className:"e-de-op-result-container"}),this.findTab.appendChild(this.resultContainer),this.messageDiv=(0,a.createElement)("div",{className:this.documentHelper.owner.containerId+"_messageDiv e-de-op-msg",innerHTML:this.localeValue.getConstant(this.messageDivText),id:this.documentHelper.owner.containerId+"_search_status"}),this.resultContainer.appendChild(this.messageDiv);var o=(0,a.createElement)("div",{id:this.documentHelper.owner.containerId+"_resultDiv"});this.optionsPane.appendChild(o),this.findDiv=(0,a.createElement)("div",{className:"findDiv",styles:"display:none;"}),o.appendChild(this.findDiv),this.resultsListBlock=(0,a.createElement)("div",{id:this.documentHelper.owner.containerId+"_list_box_container",styles:"display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;",className:"e-de-result-list-block"}),this.findDiv.appendChild(this.resultsListBlock),this.treeviewDiv=(0,a.createElement)("div",{className:"e-de-scrollbar-hide",styles:"height:375px;overflow:auto;padding-top:5px",id:this.documentHelper.owner.containerId+"_treeDiv"}),this.initHeadingTab(),this.onWireEvents(),t&&(this.optionsPane.classList.add("e-de-rtl"),this.closeButton.classList.add("e-de-rtl"),this.searchDiv.classList.add("e-de-rtl"))},e.prototype.updateHeadingTab=function(){(0,a.isNullOrUndefined)(this.treeviewDiv)||(this.isUpdateHeading=!0,this.treeviewDiv.innerHTML="",this.data=this.dataForTreeview(),this.initHeadingTab(),this.isUpdateHeading=!1)},e.prototype.initHeadingTab=function(){var e=(0,a.createElement)("div",{id:"tree"});!(0,a.isNullOrUndefined)(this.data)&&this.data.length>0?(this.treeviewObject=new ua.TreeView({fields:{dataSource:this.data,id:"id",text:"name",parentID:"pid",hasChildren:"hasChild",tooltip:"tooltipText"},nodeClicked:this.nodeClick.bind(this),cssClass:"e-de-custom-treeview",nodeTemplate:(0,a.initializeCSPTemplate)((function(e){return this.customTemplate(e)}),this)}),(0,a.isNullOrUndefined)(this.treeviewDiv)||(this.treeviewDiv.innerHTML="",this.treeviewObject.appendTo(e),this.treeviewDiv.appendChild(e),(0,a.isNullOrUndefined)(this.findTab)||this.findTab.appendChild(this.treeviewDiv))):(0,a.isNullOrUndefined)(this.treeviewDiv)||(this.treeviewDiv.innerHTML=this.localeValue.getConstant("No Headings"),this.findTab.appendChild(this.treeviewDiv))},e.prototype.customTemplate=function(e){var t=document.createElement("span");return t.innerText=e.name,t.outerHTML},e.prototype.nodeClick=function(e){var t=this.treeviewObject.selectedNodes[0];(0,a.isNullOrUndefined)(t)||this.documentHelper.selection.navigateBookmark(this.data[t-1].hyperlink.toString(),!0)},e.prototype.dataForTreeview=function(){this.data=[];var e=this.createDataSourceForTreeview();this.documentHelper.blockToShift=void 0;var t=[];if(!(0,a.isNullOrUndefined)(this.treeviewDiv)){var i=1;if(!(0,a.isNullOrUndefined)(e)&&e.length>0)for(var n=0;n<e.length;n++){var r=null;if("Level1"!==e[n].paragraphFormat.outlineLevel&&n>0){var o=n-1;if(e[n].paragraphFormat.outlineLevel===e[n-1].paragraphFormat.outlineLevel)r=t[o].pid;else if(Number(e[n].paragraphFormat.outlineLevel.substr(5,1))>Number(e[o].paragraphFormat.outlineLevel.substr(5,1)))r=t[o].id,t[o].hasChild=!0,t[o].expanded=!0;else for(o--;o>0;){if(Number(e[n].paragraphFormat.outlineLevel.substr(5,1))>Number(e[o].paragraphFormat.outlineLevel.substr(5,1))){r=t[o].id,t[o].hasChild=!0,t[o].expanded=!0;break}if(Number(e[n].paragraphFormat.outlineLevel.substr(5,1))===Number(e[o].paragraphFormat.outlineLevel.substr(5,1))){r=t[o].pid;break}o--}}var s=e[n].childWidgets[0],l=void 0,d=void 0,h=void 0;if((0,a.isNullOrUndefined)(s.children[3]))l=s.children[0].text,d=s.children[0].text,h="Toc00000000"+i,i++;else d=s.children[3].text,l=s.children[3].text,h=s.children[1].text;var c={pid:r,id:n+1,name:l,hyperlink:h.length>15?h.substring(15,h.length-2):h,tooltipText:d};t.push(c)}}return t},e.prototype.createDataSourceForTreeview=function(){var e={startLevel:1,endLevel:9,includeOutlineLevels:!0,includeHyperlink:!0},t=this.documentHelper.selection.start.clone(),i=this.documentHelper.selection.end.clone();this.documentHelper.owner.editor.initComplexHistory("TOC");var n;n=this.constructHeadingFieldCode(e);var r=this.documentHelper.owner.editorModule.buildToc(this.validateHeadingSettings(e),n,!1,!0,!0);return this.documentHelper.owner.editorHistory&&(this.documentHelper.owner.editorHistory.updateComplexHistory(),this.documentHelper.owner.editorHistory.undoStack.length>1&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.editorHistory.undoStack[this.documentHelper.owner.editorHistory.undoStack.length-1].modifiedActions)&&this.documentHelper.owner.editorHistory.undoStack.pop()),this.documentHelper.selection.selectPosition(t,i),r},e.prototype.validateHeadingSettings=function(e){return((0,a.isNullOrUndefined)(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),((0,a.isNullOrUndefined)(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),(0,a.isNullOrUndefined)(e.includeHyperlink)&&(e.includeHyperlink=!1),(0,a.isNullOrUndefined)(e.includePageNumber)&&(e.includePageNumber=!1),(0,a.isNullOrUndefined)(e.rightAlign)&&(e.rightAlign=!1),(0,a.isNullOrUndefined)(e.levelSettings)&&(e.levelSettings={}),e},e.prototype.constructHeadingFieldCode=function(e){var t="TOC";(0,a.isNullOrUndefined)(e.startLevel)||0===e.startLevel||(0,a.isNullOrUndefined)(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u");var i=this.constructTSwitch(e);return i.length>6&&(t+=i),t},e.prototype.constructTSwitch=function(e){var t="";if(!(0,a.isNullOrUndefined)(e.levelSettings))for(var i=0,n=Object.keys(e.levelSettings);i<n.length;i++){var r=n[i];t=t+r+","+e.levelSettings[r].toString()+","}return t=' \\t "'+(t=t.slice(0,-1))+'"'},e.prototype.createReplacePane=function(e){var t,i;this.replaceDiv=(0,a.createElement)("div"),this.replaceTabContentDiv.appendChild(this.replaceDiv),this.replaceWith=(0,a.createElement)("input",{className:"e-de-op-replacewith e-input",attrs:{placeholder:this.localeValue.getConstant("Replace with")}}),this.replaceDiv.appendChild(this.replaceWith),e?(t="text-align:left",i="margin-left:10px"):(t="text-align:right",i="margin-right:10px");var n=(0,a.createElement)("div",{styles:t,className:"e-de-op-dlg-footer"});this.replaceDiv.appendChild(n),this.replaceButton=(0,a.createElement)("button",{className:"e-control e-btn e-flat e-replace",styles:i,innerHTML:this.localeValue.getConstant(this.replaceButtonText),attrs:{type:"button"}}),n.appendChild(this.replaceButton),this.replaceButton.setAttribute("aria-label",this.localeValue.getConstant(this.replaceButtonText)),this.replaceAllButton=(0,a.createElement)("button",{className:"e-control e-btn e-flat e-replaceall",innerHTML:this.localeValue.getConstant(this.replaceAllButtonText),attrs:{type:"button"}}),n.appendChild(this.replaceAllButton),this.replaceAllButton.setAttribute("aria-label",this.localeValue.getConstant(this.replaceAllButtonText)),this.matchDiv=(0,a.createElement)("div",{styles:"display:none;padding-top:10px;"}),this.replaceDiv.appendChild(this.matchDiv);var r=(0,a.createElement)("div",{className:"e-de-op-search-replacediv"});this.replaceDiv.appendChild(r),this.occurrenceDiv=(0,a.createElement)("div",{styles:"display:none;"}),this.replaceDiv.appendChild(this.occurrenceDiv)},e.prototype.selectedTabItem=function(e){var t=this.findTab.getElementsByClassName("e-content").item(0);if(e.previousIndex!==e.selectedIndex){var i=t.children[0],n=t.children[1],r=i.firstElementChild;r&&(r.parentElement&&r.parentElement.removeChild(r),n.appendChild(r))}var o=t.children[0];(0,a.isNullOrUndefined)(o)||(0===e.selectedIndex?(this.isOptionsPane=!1,this.isHeadingTab=!0,this.onHeadingPane()):1===e.selectedIndex?(this.isHeadingTab=!1,this.isOptionsPane=!0,this.onFindPane()):(this.isHeadingTab=!1,this.isOptionsPane=!1,this.onReplacePane()))},e.prototype.navigateSearchResult=function(e){e&&this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(this.results),this.documentHelper.owner.searchModule.addFindResultView(this.results),this.resultsListBlock.style.display="block",this.resultContainer.style.display="block";for(var t=this.documentHelper.owner.findResultsList,i="",n=0;n<t.length;n++)i+=t[n];var r=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=r+"px",this.clearFocusElement(),this.resultsListBlock.innerHTML=i;for(n=0;n<this.resultsListBlock.children.length;n++)this.focusedElement.push(this.resultsListBlock.children[n]);var o=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(o+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var s=this.resultsListBlock.children[o];s.classList.contains("e-de-search-result-item")&&(s.classList.remove("e-de-search-result-item"),s.classList.add("e-de-search-result-hglt"),s.children[0].classList.add("e-de-op-search-word-text"),this.scrollToPosition(s))},e.prototype.wholeWordsChange=function(){this.matchInput.checked&&this.wholeInput.checked?this.findOption="CaseSensitiveWholeWord":this.matchInput.checked&&!this.wholeInput.checked?this.findOption="CaseSensitive":!this.matchInput.checked&&this.wholeInput.checked?this.findOption="WholeWord":this.findOption="None",this.searchOptionChange()},e.prototype.matchChange=function(){this.matchInput.checked&&this.wholeInput.checked?this.findOption="CaseSensitiveWholeWord":!this.matchInput.checked&&this.wholeInput.checked?this.findOption="WholeWord":this.matchInput.checked&&!this.wholeInput.checked?this.findOption="CaseSensitive":this.findOption="None";var e=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=e+"px",this.searchOptionChange()},e.prototype.onWireEvents=function(){this.searchIcon.addEventListener("click",this.searchIconClickInternal),this.navigateToNextResult.addEventListener("click",this.navigateNextResultButtonClick),this.navigateToPreviousResult.addEventListener("click",this.navigatePreviousResultButtonClick),this.searchInput.addEventListener("keydown",this.onKeyDown),this.searchInput.addEventListener("keyup",this.onEnableDisableReplaceButton),this.resultsListBlock.addEventListener("click",this.resultListBlockClick),this.closeButton.addEventListener("click",this.close),this.replaceButton.addEventListener("click",this.onReplaceButtonClick),this.replaceAllButton.addEventListener("click",this.onReplaceAllButtonClick)},e.prototype.onKeyDownInternal=function(){var e=document.getElementById(this.documentHelper.owner.containerId+"_option_search_text_box");if(!(0,a.isNullOrUndefined)(e)){e.blur();var t=e.value;if(""!==t){t.length>=1&&this.searchIcon.classList.contains("e-de-op-search-icon")&&(this.searchIcon.classList.add("e-de-op-search-close-icon"),this.searchIcon.classList.remove("e-de-op-search-icon"));this.isOptionsPane;this.clearSearchResultItems(),this.documentHelper.owner.searchModule.clearSearchHighlight();var i=this.documentHelper.owner.searchModule.textSearch.stringToRegex(t,this.findOption),n=this.documentHelper.selection.end.getHierarchicalIndexInternal();this.results=this.documentHelper.owner.searchModule.textSearch.findAll(i,this.findOption,n);var r=this.results;if((0,a.isNullOrUndefined)(r)&&this.viewer.renderVisiblePages(),null!=r&&r.length>0){-1===this.focusedElement.indexOf(this.navigateToPreviousResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToPreviousResult),-1===this.focusedElement.indexOf(this.navigateToNextResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToNextResult),this.documentHelper.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.documentHelper.owner.searchModule.highlight(r),this.documentHelper.owner.searchModule.addFindResultView(r),this.resultContainer.style.display="block",this.resultsListBlock.style.display="block";var o=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=o+"px";var s=this.documentHelper.owner.findResultsList,l="";this.clearFocusElement(),this.resultsListBlock.innerHTML="";for(var d=0;d<s.length;d++)l+=s[d];this.resultsListBlock.innerHTML=l;for(d=0;d<this.resultsListBlock.children.length;d++)this.focusedElement.push(this.resultsListBlock.children[d]);this.resultsListBlock.children;var h=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(h+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var c=this.resultsListBlock.children[h];c.classList.contains("e-de-search-result-item")&&(c.classList.remove("e-de-search-result-item"),c.classList.add("e-de-search-result-hglt"),c.children[0].classList.add("e-de-op-search-word-text")),this.navigateToNextResult.focus(),this.focusedIndex=this.focusedElement.indexOf(this.navigateToNextResult),this.getMessageDivHeight()}else this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"),this.resultContainer.style.display="block",this.resultsListBlock.style.display="none",this.clearFocusElement(),this.resultsListBlock.innerHTML=""}}},e.prototype.onHeadingPane=function(){this.updateHeadingTab(),this.treeviewDiv.style.display="block",this.refreshHeadingPaneHeight(),this.messageDiv.classList.remove("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"),this.replaceDiv.style.display="none",this.occurrenceDiv.style.display="none",this.findDiv.style.display="none",this.findTabContentDiv.style.display="none",this.checkboxDiv.style.display="none",this.resultContainer.style.display="none"},e.prototype.refreshHeadingPaneHeight=function(){if(!(0,a.isNullOrUndefined)(this.optionsPane)&&!(0,a.isNullOrUndefined)(this.searchDiv)&&!(0,a.isNullOrUndefined)(this.tabDiv)){var e=window.getComputedStyle(this.searchDiv),t=parseFloat(e.marginBottom),i=this.optionsPane.offsetHeight-(t+this.searchDiv.offsetHeight+this.tabDiv.offsetHeight);this.treeviewDiv.style.height=i+"px"}},e.prototype.onFindPane=function(){this.replaceDiv.style.display="none",this.occurrenceDiv.style.display="none",this.treeviewDiv.style.display="none",this.findDiv.style.display="block",this.findTabContentDiv.style.display="block",this.checkboxDiv.style.display="block",this.resultContainer.style.display="block",(0,a.isNullOrUndefined)(this.results)||0!==this.results.length||(this.resultsListBlock.innerHTML="",this.resultsListBlock.style.display="none",this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"));this.isOptionsPane;var e=this.optionsPane.offsetHeight-(this.findTab.offsetHeight-this.replaceTabContentDiv.offsetHeight);this.resultsListBlock.style.height=e+"px",this.replaceTabContentDiv.style.display="none",this.findDiv.style.display="block",this.messageDiv.style.display="block",this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput),this.focusedIndex=1,this.searchInput.select(),this.getMessageDivHeight()},e.prototype.getMessageDivHeight=function(){!this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-msg")?(this.messageDiv.classList.add("e-de-op-replace-messagediv"),this.messageDiv.classList.remove("e-de-op-msg")):this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-replace-messagediv")&&(this.messageDiv.classList.add("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"))},e.prototype.onReplacePane=function(){this.findDiv.style.display="block",this.replaceDiv.style.display="block",this.replaceTabContentDiv.style.display="block",this.findDiv.style.display="block",this.treeviewDiv.style.display="none",this.findTabContentDiv.style.display="block",this.checkboxDiv.style.display="block",this.resultContainer.style.display="block";this.isOptionsPane;var e=this.optionsPane.offsetHeight-this.findTab.offsetHeight;this.resultsListBlock.style.height=e+"px",this.isOptionsPane=!1,0!==this.searchInput.value.length?(this.replaceButton.disabled=!1,this.replaceAllButton.disabled=!1):(this.replaceButton.disabled=!0,this.replaceAllButton.disabled=!0),this.focusedElement=[],this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.focusedIndex=1,""===this.searchInput.value?this.searchInput.select():this.replaceWith.select(),this.getMessageDivHeight()},e.prototype.replaceAll=function(){this.optionsPane;var e=this.searchInput.value,t=this.replaceWith.value;if(""!==e&&!(0,a.isNullOrUndefined)(e)){var i=this.documentHelper.owner.searchModule.textSearch.stringToRegex(e,this.findOption),n=this.documentHelper.selection.end.getHierarchicalIndexInternal(),r=this.documentHelper.owner.searchModule.textSearch.findAll(i,this.findOption,n),o=(0,a.isNullOrUndefined)(t)?"":t,s=(0,a.isNullOrUndefined)(r)?0:r.length;this.documentHelper.owner.searchModule.replaceAll(o,r),this.documentHelper.layout.isReplacingAll=!1,this.matchDiv.style.display="block",this.matchDiv.innerHTML=this.localeValue.getConstant("All Done")+"!",this.occurrenceDiv.style.display="block",this.occurrenceDiv.innerHTML=this.localeValue.getConstant("We replaced all")+" "+s+" "+this.localeValue.getConstant("instances")+" "+this.localeValue.getConstant("of")+' "'+e+'" '+this.localeValue.getConstant("with")+' "'+t+'" '}},e.prototype.hideMatchDiv=function(){this.matchDiv.style.display="none",this.occurrenceDiv.style.display="none"},e.prototype.updateListItems=function(e){for(var t=this.resultsListBlock.getElementsByClassName("e-de-search-result-hglt"),i=0;i<t.length;i++){var n=t[i];(0,a.classList)(n,["e-de-search-result-item"],["e-de-search-result-hglt"]),(0,a.classList)(n.children[0],[],["e-de-op-search-word-text"])}var r=this.resultsListBlock.children[this.results.currentIndex];(0,a.classList)(r,["e-de-search-result-hglt"],["e-de-search-result-item"]),(0,a.classList)(r.children[0],["e-de-op-search-word-text"],[]),this.scrollToPosition(r),this.documentHelper.owner.searchModule.navigate(e),this.documentHelper.owner.searchModule.highlight(this.results)},e.prototype.scrollToPosition=function(e){var t,i=e.getBoundingClientRect();i.top>0?(t=i.top-e.parentElement.getBoundingClientRect().top,e.parentElement.offsetHeight-t<=e.offsetHeight?(Math.ceil(t+e.offsetHeight)===e.parentElement.scrollHeight&&(e.parentElement.scrollTop=t),e.parentElement.scrollTop=e.parentElement.scrollTop+e.parentElement.offsetHeight/100*30):t<0&&(e.parentElement.scrollTop=e.parentElement.scrollTop-e.parentElement.offsetHeight/100*30)):e.parentElement.scrollTop=0},e.prototype.clearFocusElement=function(){for(var e=0;e<this.resultsListBlock.children.length;e++){var t=this.focusedElement.indexOf(this.resultsListBlock.children[e]);-1!==t&&this.focusedElement.splice(t,1)}this.focusedIndex=1},e.prototype.showHideOptionsPane=function(e){if(!(0,a.isNullOrUndefined)(this.documentHelper.owner.selectionModule)){if(this.documentHelper.owner.fireOptionPaneChange(e),e){if(this.localeValue=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale),this.localeValue.setLocale(this.documentHelper.owner.locale),(0,a.isNullOrUndefined)(this.optionsPane)){this.initOptionsPane(this.localeValue,this.documentHelper.owner.enableRtl);var t=void 0;t=this.documentHelper.owner.enableRtl?"display:inline-flex;direction:rtl;":"display:inline-flex;",this.documentHelper.optionsPaneContainer.setAttribute("style",t),this.documentHelper.optionsPaneContainer.insertBefore(this.documentHelper.owner.optionsPaneModule.optionsPane,this.documentHelper.viewerContainer)}this.optionsPane.style.display="block",this.documentHelper.owner.isReadOnlyMode?this.tabInstance.hideTab(2):this.tabInstance.hideTab(2,!1),this.isReplace&&!this.documentHelper.owner.isReadOnlyMode?(this.tabInstance.select(2),this.isReplace=!1,this.isOptionsPane=!1):this.tabInstance.select(1);var i=document.getElementById(this.documentHelper.owner.containerId+"_treeDiv");(0,a.isNullOrUndefined)(i)||(i.innerHTML=""),this.searchDiv.innerHTML=this.localeValue.getConstant(this.searchText),this.isOptionsPaneShow=!0;var n=document.getElementById(this.documentHelper.owner.getDocumentEditorElement().id+"_option_search_text_box"),r=this.documentHelper.owner.selectionModule.text;if(!(0,a.isNullOrUndefined)(r)){var o=Pa.indexOfAny(r,["\v","\r"]);r=o<0?r:r.substring(0,o)}n.value=r,n.select(),!(0,a.isNullOrUndefined)(n.value)&&n.value.match(/[!\@\#$%\^&*\(\)_\-+\=\[\]\{\};:"\|,.<>\/?`~\s\\؟°÷×،؛]/)&&""!==n.value?(this.wholeInput.checked=!1,this.wholeWord.disabled=!0):this.wholeWord.disabled=!1,this.messageDiv.innerHTML="",this.searchIcon.classList.contains("e-de-op-search-close-icon")&&(this.searchIcon.classList.add("e-de-op-search-icon"),this.searchIcon.classList.remove("e-de-op-search-close-icon")),this.documentHelper.selection.caret.style.display="none",this.focusedIndex=1,this.focusedElement=[],this.isOptionsPane?this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput):this.focusedElement.push(this.closeButton,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.documentHelper.updateViewerSize()}else{if(!(0,a.isNullOrUndefined)(this.optionsPane)){this.clearSearchResultItems(),(0,a.isNullOrUndefined)(this.documentHelper.owner.searchModule)||this.documentHelper.owner.searchModule.clearSearchHighlight(),this.isOptionsPaneShow=!1;var s=document.getElementById(this.documentHelper.owner.containerId+"_list_box_container"),l=document.getElementById(this.documentHelper.owner.containerId+"_search_status");(0,a.isNullOrUndefined)(s)||(0,a.isNullOrUndefined)(l)||(s.style.display="none",this.clearFocusElement(),s.innerHTML="",l.innerHTML=this.localeValue.getConstant("No matches"));i=document.getElementById(this.documentHelper.owner.containerId+"_treeDiv");(0,a.isNullOrUndefined)(i)||(i.innerHTML="")}this.documentHelper.updateViewerSize(),(0,a.isNullOrUndefined)(this.optionsPane)||"none"!==this.optionsPane.style.display&&(this.documentHelper.selection.updateCaretPosition(),this.optionsPane.style.display="none"),this.documentHelper.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.owner.enableAutoFocus&&(this.documentHelper.selection.caret.style.display="block")}this.documentHelper.owner.triggerResize()}},e.prototype.clearSearchResultItems=function(){(0,a.isNullOrUndefined)(this.documentHelper.owner.findResultsList)||(this.documentHelper.owner.findResultsList=[])},e.prototype.destroy=function(){this.optionsPane&&(this.optionsPane.innerHTML="",this.optionsPane=void 0),this.resultsListBlock&&(this.resultsListBlock.innerHTML="",this.resultsListBlock=void 0),this.messageDiv&&(this.messageDiv.innerHTML="",this.messageDiv=void 0),this.resultContainer&&(this.resultContainer.innerHTML=""),this.resultContainer=void 0,this.searchInput&&(this.searchInput.value="",this.searchInput=void 0),this.searchDiv&&(this.searchDiv.innerHTML="",this.searchDiv=void 0),this.searchTextBoxContainer&&(this.searchTextBoxContainer.innerHTML="",this.searchTextBoxContainer=void 0),this.replaceWith&&(this.replaceWith.innerHTML="",this.replaceWith=void 0),this.findDiv&&(this.findDiv.innerHTML="",this.findDiv=void 0),this.treeviewDiv&&(this.treeviewDiv.innerHTML="",this.treeviewDiv=void 0),this.replaceButton&&(this.replaceButton.innerHTML="",this.replaceButton=void 0),this.replaceAllButton&&(this.replaceAllButton.innerHTML="",this.replaceAllButton=void 0),this.matchInput&&(this.matchInput.innerHTML="",this.matchCase=void 0),this.wholeInput&&(this.wholeInput.innerHTML="",this.wholeWord=void 0),(0,a.isNullOrUndefined)(this.results)||this.results.destroy(),this.focusedElement&&(this.focusedElement=[]),this.focusedElement=void 0,this.destroyInternal(),this.documentHelper=void 0},e.prototype.destroyInternal=function(){this.searchText&&(this.searchText=void 0),this.resultsText&&(this.resultsText=void 0),this.messageDivText&&(this.messageDivText=void 0),this.replaceButtonText&&(this.replaceButtonText=void 0),this.replaceAllButtonText&&(this.replaceAllButtonText=void 0),this.tabDiv&&(this.tabDiv=void 0)},e}(),Ac=function(){function e(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.scriptType=t.English,this.fontColorIn=void 0,this.allCapsIn=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.complexScript=void 0,this.fontSizeBidi=0,this.bidi=void 0,this.bdo=void 0,this.selection=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedFontFamily",{get:function(){return this.renderedFontFamilyIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=this.renderedFontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e===this.highlightColorIn&&"NoColor"!==e||(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(e){e!==this.allCapsIn&&(this.allCapsIn=e,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":return this.fontSize>=1?this.fontSize:void 0;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},e.prototype.notifyPropertyChanged=function(e){if(((0,a.isNullOrUndefined)(this.selection)||!(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)||this.selection.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(this.selection)&&!(0,a.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);(0,a.isNullOrUndefined)(t)||this.selection.owner.editorModule.onApplyCharacterFormat(e,t)}},e.prototype.copyFormat=function(e,t){this.styleName=(0,a.isNullOrUndefined)(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.renderedFontFamilyIn=t,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.fontSizeBidi=e.fontSizeBidi,this.allCaps=e.allCaps,this.complexScript=e.complexScript},e.prototype.combineFormat=function(e,t){(0,a.isNullOrUndefined)(this.bold)||this.bold===e.bold||(this.bold=void 0),(0,a.isNullOrUndefined)(this.italic)||this.italic===e.italic||(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),(0,a.isNullOrUndefined)(this.renderedFontFamily)||this.renderedFontFamily===t||(this.renderedFontFamilyIn=void 0),(0,a.isNullOrUndefined)(this.fontFamily)||this.fontFamily===e.fontFamily||(this.fontFamily=void 0),(0,a.isNullOrUndefined)(this.highlightColor)||this.highlightColor===e.highlightColor||(this.highlightColor=void 0),(0,a.isNullOrUndefined)(this.baselineAlignment)||this.baselineAlignment===e.baselineAlignment||(this.baselineAlignment=void 0),(0,a.isNullOrUndefined)(this.fontColor)||this.fontColor===e.fontColor||(this.fontColor=void 0),(0,a.isNullOrUndefined)(this.underline)||this.underline===e.underline||(this.underline=void 0),(0,a.isNullOrUndefined)(this.strikethrough)||this.strikethrough===e.strikethrough||(this.strikethrough=void 0),(0,a.isNullOrUndefined)(this.boldBidi)||this.boldBidi===e.boldBidi||(this.boldBidi=void 0),(0,a.isNullOrUndefined)(this.italicBidi)||this.italicBidi===e.italicBidi||(this.italicBidi=void 0),0!==this.fontSizeBidi&&this.fontSizeBidi!==e.fontSizeBidi&&(this.fontSizeBidi=0),(0,a.isNullOrUndefined)(this.fontFamilyBidi)||this.fontFamilyBidi===e.fontFamilyBidi||(this.fontFamilyBidi=void 0),(0,a.isNullOrUndefined)(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),(0,a.isNullOrUndefined)(this.bdo)||this.bdo===e.bdo||(this.bdo=void 0),(0,a.isNullOrUndefined)(this.allCaps)||this.allCaps===e.allCaps||(this.allCaps=void 0),(0,a.isNullOrUndefined)(this.complexScript)||this.complexScript===e.complexScript||(this.complexScript=void 0)},e.prototype.canRetrieveNextCharacterFormat=function(){return!((0,a.isNullOrUndefined)(this.bold)&&(0,a.isNullOrUndefined)(this.italic)&&0===this.fontSize&&(0,a.isNullOrUndefined)(this.fontFamily)&&(0,a.isNullOrUndefined)(this.highlightColor)&&(0,a.isNullOrUndefined)(this.baselineAlignment)&&(0,a.isNullOrUndefined)(this.fontColor)&&(0,a.isNullOrUndefined)(this.underline)&&(0,a.isNullOrUndefined)(this.strikethrough)&&(0,a.isNullOrUndefined)(this.boldBidi)&&(0,a.isNullOrUndefined)(this.italicBidi)&&0===this.fontSizeBidi&&(0,a.isNullOrUndefined)(this.fontFamilyBidi)&&(0,a.isNullOrUndefined)(this.bdo)&&(0,a.isNullOrUndefined)(this.allCaps))},e.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontSizeBidi=e.fontSizeBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.allCaps=e.allCaps,this.complexScript=e.complexScript},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor&&this.allCaps===e.allCaps},e.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0,this.complexScript=void 0},e.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0,this.complexScript=void 0},e}(),Uc=function(){function e(e,t,i){this.colorIn=void 0,this.lineStyleIn=void 0,this.lineWidthIn=void 0,this.shadowIn=void 0,this.spaceIn=void 0,this.borderType=t,this.ownerBase=i,this.selection=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.colorIn},set:function(e){e!==this.colorIn&&(this.colorIn=e,this.notifyPropertyChanged("color"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.lineStyleIn},set:function(e){e!==this.lineStyleIn&&(this.lineStyleIn=e,this.notifyPropertyChanged("lineStyle"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.lineWidthIn},set:function(e){e!==this.lineWidthIn&&(this.lineWidthIn=e,this.notifyPropertyChanged("lineWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.shadowIn},set:function(e){e!==this.shadowIn&&(this.shadowIn=e,this.notifyPropertyChanged("shadow"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e,this.notifyPropertyChanged("space"))},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space},e.prototype.combineFormat=function(e){(0,a.isNullOrUndefined)(this.color)||this.color===e.color||(this.color=void 0),(0,a.isNullOrUndefined)(this.lineStyle)||this.lineStyle===e.lineStyle||(this.lineStyle=void 0),(0,a.isNullOrUndefined)(this.lineWidth)||this.lineWidth===e.lineWidth||(this.lineWidth=void 0),(0,a.isNullOrUndefined)(this.shadow)||this.shadow===e.shadow||(this.shadow=void 0),(0,a.isNullOrUndefined)(this.space)||this.space===e.space||(this.space=void 0)},e.prototype.getPropertyValue=function(e){switch(e){case"color":return this.color;case"lineStyle":return this.lineStyle;case"lineWidth":return this.lineWidth;case"space":return this.space;case"shadow":return this.shadow}},e.prototype.notifyPropertyChanged=function(e){if(((0,a.isNullOrUndefined)(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(this.selection)&&!(0,a.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule,i=this.getPropertyValue(e);(0,a.isNullOrUndefined)(i)||t.applyParagraphBorders(e,this.borderType,i)}},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.colorIn)||(this.colorIn=void 0),(0,a.isNullOrUndefined)(this.lineStyleIn)||(this.lineStyleIn=void 0),(0,a.isNullOrUndefined)(this.lineWidthIn)||(this.lineWidthIn=void 0),(0,a.isNullOrUndefined)(this.spaceIn)||(this.spaceIn=void 0),(0,a.isNullOrUndefined)(this.shadowIn)||(this.shadowIn=void 0)},e}(),Vc=function(){function e(e,t){this.ownerBase=void 0,this.ownerBase=t,this.selection=e,this.topIn=new Uc(this.selection,"topBorder",this),this.bottomIn=new Uc(this.selection,"bottomBorder",this),this.rightIn=new Uc(this.selection,"rightBorder",this),this.leftIn=new Uc(this.selection,"leftBorder",this),this.horizontalIn=new Uc(this.selection,"horizontalBorder",this),this.verticalIn=new Uc(this.selection,"verticalBorder",this)}return Object.defineProperty(e.prototype,"top",{get:function(){return this.topIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.horizontalIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.verticalIn},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.top.copyFormat(e.top),this.bottom.copyFormat(e.bottom),this.left.copyFormat(e.left),this.right.copyFormat(e.right),this.horizontal.copyFormat(e.horizontal),this.vertical.copyFormat(e.vertical)},e.prototype.combineFormat=function(e){this.top.combineFormat(e.top),this.bottom.combineFormat(e.bottom),this.left.combineFormat(e.left),this.right.combineFormat(e.right),this.vertical.combineFormat(e.vertical),this.horizontal.combineFormat(e.horizontal)},e.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.topIn)||(this.topIn.destroy(),this.topIn=void 0),(0,a.isNullOrUndefined)(this.topIn)||(this.bottomIn.destroy(),this.bottomIn=void 0),(0,a.isNullOrUndefined)(this.leftIn)||(this.leftIn.destroy(),this.leftIn=void 0),(0,a.isNullOrUndefined)(this.rightIn)||(this.rightIn.destroy(),this.rightIn=void 0),(0,a.isNullOrUndefined)(this.horizontalIn)||(this.horizontalIn.destroy(),this.horizontalIn=void 0),(0,a.isNullOrUndefined)(this.verticalIn)||(this.verticalIn.destroy(),this.verticalIn=void 0)},e}(),zc=function(){function e(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.spaceAfterAutoIn=void 0,this.spaceBeforeAutoIn=void 0,this.textAlignmentIn=void 0,this.outlineLevelIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.bidiIn=void 0,this.keepWithNextIn=void 0,this.keepLinesTogetherIn=void 0,this.widowControlIn=void 0,this.contextualSpacingIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.documentHelper=t,this.bordersIn=new Vc(this.selection,this)}return Object.defineProperty(e.prototype,"borders",{get:function(){return this.bordersIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.outlineLevelIn},set:function(e){e!==this.outlineLevelIn&&(this.outlineLevelIn=e,this.notifyPropertyChanged("outlineLevel"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.spaceAfterAutoIn},set:function(e){e!==this.spaceAfterAutoIn&&(this.spaceAfterAutoIn=e,this.notifyPropertyChanged("spaceAfterAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.spaceBeforeAutoIn},set:function(e){e!==this.spaceBeforeAutoIn&&(this.spaceBeforeAutoIn=e,this.notifyPropertyChanged("spaceBeforeAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(e){this.keepWithNextIn=e,this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(e){this.keepLinesTogetherIn=e,this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(e){this.widowControlIn=e,this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(e){this.contextualSpacingIn=e,this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),e.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(e.prototype,"listText",{get:function(){var e=void 0,t=this.documentHelper.getListById(this.listId);if(t instanceof zh&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof Va)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var n=0;n<9;n++){var r="%"+(n+1);if(e.indexOf(r)>-1){n===this.listLevelNumberIn||t.getListLevel(n);var o=this.selection.getListTextElementBox(this.selection.start.paragraph);e=o?o.text:""}}}}return e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"spaceAfterAuto":return this.spaceAfterAuto;case"spaceBeforeAuto":return this.spaceBeforeAuto;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"contextualSpacing":return this.contextualSpacing;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;case"outlineLevel":return this.outlineLevel;default:return}},e.prototype.notifyPropertyChanged=function(e){if(((0,a.isNullOrUndefined)(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(this.selection)&&!(0,a.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule;if("lineSpacing"===e||"lineSpacingType"===e){var i=this.selection.owner.editorHistoryModule;if((!i||!i.isUndoing&&!i.isRedoing)&&this.validateLineSpacing()){if(this.selection.owner.editorHistoryModule.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===e){this.lineSpacingTypeIn="Multiple";var n=this.getPropertyValue("lineSpacingType");t.onApplyParagraphFormat("lineSpacingType",n,!1,!1),t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1)}else t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1);return void this.selection.owner.editorHistoryModule.updateComplexHistory()}}var r=this.getPropertyValue(e);if(!("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||r>=-1056&&r<1056))return;"listLevelNumber"===e?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(e,r,"textAlignment"===e,!1)}},e.prototype.copyFormat=function(e){this.styleName=(0,a.isNullOrUndefined)(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.spaceAfterAuto=e.spaceAfterAuto,this.spaceBeforeAuto=e.spaceBeforeAuto,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,this.outlineLevel=e.outlineLevel,this.bidi=e.bidi,this.keepLinesTogether=e.keepLinesTogether,this.keepWithNext=e.keepWithNext,this.widowControl=e.widowControl,this.contextualSpacing=e.contextualSpacing,this.borders.copyFormat(e.borders),(0,a.isNullOrUndefined)(e.listFormat)||(0,a.isNullOrUndefined)(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},e.prototype.copyToFormat=function(e){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),(0,a.isNullOrUndefined)(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),(0,a.isNullOrUndefined)(this.spaceAfterAuto)||(e.spaceAfterAuto=this.spaceAfterAuto),(0,a.isNullOrUndefined)(this.spaceBeforeAuto)||(e.spaceBeforeAuto=this.spaceBeforeAuto),(0,a.isNullOrUndefined)(this.leftIndent)||(e.leftIndent=this.leftIndent),(0,a.isNullOrUndefined)(this.rightIndent)||(e.rightIndent=this.rightIndent),(0,a.isNullOrUndefined)(this.textAlignment)||(e.textAlignment=this.textAlignment),(0,a.isNullOrUndefined)(this.outlineLevel)||(e.outlineLevel=this.outlineLevel),(0,a.isNullOrUndefined)(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),(0,a.isNullOrUndefined)(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),(0,a.isNullOrUndefined)(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent),(0,a.isNullOrUndefined)(this.bidi)||(e.bidi=this.bidi),(0,a.isNullOrUndefined)(this.keepWithNext)||(e.keepWithNext=this.keepWithNext),(0,a.isNullOrUndefined)(this.keepLinesTogether)||(e.keepLinesTogether=this.keepLinesTogether),(0,a.isNullOrUndefined)(this.widowControl)||(e.widowControl=this.widowControl),(0,a.isNullOrUndefined)(this.contextualSpacing)||(e.contextualSpacing=this.contextualSpacing))},e.prototype.combineFormat=function(e){(0,a.isNullOrUndefined)(this.leftIndent)||this.leftIndent===e.leftIndent||(this.leftIndent=void 0),(0,a.isNullOrUndefined)(this.rightIndent)||this.rightIndent===e.rightIndent||(this.rightIndent=void 0),(0,a.isNullOrUndefined)(this.firstLineIndent)||this.firstLineIndent===e.firstLineIndent||(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),(0,a.isNullOrUndefined)(this.spaceAfterAuto)||this.spaceAfterAuto===e.spaceAfterAuto||(this.spaceAfterAuto=void 0),(0,a.isNullOrUndefined)(this.spaceBeforeAuto)||this.spaceBeforeAuto===e.spaceBeforeAuto||(this.spaceBeforeAuto=void 0),(0,a.isNullOrUndefined)(this.lineSpacingType)||this.lineSpacingType===e.lineSpacingType||(this.lineSpacingType=void 0),(0,a.isNullOrUndefined)(this.textAlignment)||this.textAlignment===e.textAlignment||(this.textAlignment=void 0),(0,a.isNullOrUndefined)(this.outlineLevel)||this.outlineLevel===e.outlineLevel||(this.outlineLevel=void 0),this.listLevelNumber>=0&&!(0,a.isNullOrUndefined)(this.listId)&&((0,a.isNullOrUndefined)(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),((0,a.isNullOrUndefined)(e.listFormat)||(0,a.isNullOrUndefined)(e.listFormat.listId)||!(0,a.isNullOrUndefined)(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0),(0,a.isNullOrUndefined)(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),(0,a.isNullOrUndefined)(this.keepLinesTogether)||this.keepLinesTogether===e.keepLinesTogether||(this.keepLinesTogether=void 0),(0,a.isNullOrUndefined)(this.keepWithNext)||this.keepWithNext===e.keepWithNext||(this.keepWithNext=void 0),(0,a.isNullOrUndefined)(this.widowControl)||this.widowControl===e.widowControl||(this.widowControl=void 0),(0,a.isNullOrUndefined)(this.contextualSpacing)||this.contextualSpacing===e.contextualSpacing||(this.contextualSpacing=void 0),!(0,a.isNullOrUndefined)(this.styleName)&&e.baseStyle&&this.styleName!==e.baseStyle.name&&(this.styleName=void 0),this.borders.combineFormat(e.borders)},e.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.spaceAfterAuto=void 0,this.spaceBeforeAuto=void 0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0},e.prototype.getList=function(){var e=this.documentHelper.getListById(this.listId);if(!(0,a.isNullOrUndefined)(e)){var t=new zh,i=new Aa,n=this.documentHelper.getAbstractListById(e.abstractListId),r=this.selection.owner.editorModule;if((0,a.isNullOrUndefined)(n))i.levels.push(new Va(i));else for(var o=0;o<n.levels.length;o++){var s=r.cloneListLevel(n.levels[o]);i.levels.push(s),s.ownerBase=i}if(!(0,a.isNullOrUndefined)(e.levelOverrides))for(o=0;o<e.levelOverrides.length;o++){var l=r.cloneLevelOverride(e.levelOverrides[o]);t.levelOverrides.push(l)}return t.abstractList=i,t.abstractListId=i.abstractListId,t.sourceListId=e.listId,t}},e.prototype.setList=function(e,t){if(!(this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||!(0,a.isNullOrUndefined)(this.selection)&&this.selection.checkContentControlLocked(!0))){var i=this.documentHelper.getListById(this.listId),n=void 0,r=e?this.documentHelper.getAbstractListById(e.abstractListId):void 0;if((0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(r)||e.sourceListId!==i.listId)(0,a.isNullOrUndefined)(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,(0,a.isNullOrUndefined)(r)||-1!==this.documentHelper.abstractLists.indexOf(r)||this.documentHelper.abstractLists.push(r),-1===this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e));else{var o=this.documentHelper.owner.editorHistoryModule;this.documentHelper.layout.getListLevel(i,1);this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),o&&(n=o.updateListChangesInHistory(r,i)),this.documentHelper.owner.editorModule.updateListParagraphs(),o&&o.applyListChanges(this.selection,n),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],t&&this.documentHelper.layout.clearInvalidList(e),this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),o&&o.currentBaseHistoryInfo&&(o.currentBaseHistoryInfo.modifiedProperties.length>0&&o.currentBaseHistoryInfo.updateSelection(),o.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()}}},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.spaceBeforeAutoIn=void 0,this.spaceAfterAutoIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.documentHelper=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0,(0,a.isNullOrUndefined)(this.bordersIn)||(this.bordersIn.destroy(),this.bordersIn=void 0)},e}(),qc=function(){function e(e){this.linkToPreviousIn=!0,this.selection=e}return Object.defineProperty(e.prototype,"linkToPrevious",{get:function(){return this.linkToPreviousIn},set:function(e){this.linkToPreviousIn=e,this.notifyPropertyChanged("linkToPrevious")},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(((0,a.isNullOrUndefined)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyvalue(e);if(!(0,a.isNullOrUndefined)(i)){var n=t.start.paragraph.bodyWidget,r=n.sectionIndex,o=n.headerFooterType;t.owner.editorModule.removeInlineHeaderFooterWidget(r,o,e,i)}}},e.prototype.getPropertyvalue=function(e){if("linkToPrevious"==e&&!(0,a.isNullOrUndefined)(this.linkToPrevious))return this.linkToPrevious},e}(),_c=function(){function e(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.bidi=void 0,this.selection=e,this.firstPageHeaderIn=new qc(e),this.firstPageFooterIn=new qc(e),this.oddPageHeaderIn=new qc(e),this.oddPageFooterIn=new qc(e),this.evenPageHeaderIn=new qc(e),this.evenPageFooterIn=new qc(e)}return Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageHeader",{get:function(){return this.firstPageHeaderIn},set:function(e){this.firstPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageFooter",{get:function(){return this.firstPageFooterIn},set:function(e){this.firstPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageHeader",{get:function(){return this.oddPageHeaderIn},set:function(e){this.oddPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageFooter",{get:function(){return this.oddPageFooterIn},set:function(e){this.oddPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageHeader",{get:function(){return this.evenPageHeaderIn},set:function(e){this.evenPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageFooter",{get:function(){return this.evenPageFooterIn},set:function(e){this.evenPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(e){this.pageStartingNumberIn=e,this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(e){this.restartPageNumberingIn=e,this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(e){this.endnoteNumberFormatIn=e,this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(e){this.footNoteNumberFormatIn=e,this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(e){this.initialFootNoteNumberIn=e,this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(e){this.initialEndNoteNumberIn=e,this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(e){this.restartIndexForFootnotesIn=e,this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(e){this.restartIndexForEndnotesIn=e,this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return 0==this.columns.length?1:this.columns.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.equalWidthIn},set:function(e){this.equalWidthIn=e,this.notifyPropertyChanged("equalWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.lineBetweenColumnsIn},set:function(e){this.lineBetweenColumnsIn=e,this.notifyPropertyChanged("lineBetweenColumns")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.columnsIn},set:function(e){this.columnsIn=e;var t=this.selection;((0,a.isNullOrUndefined)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&((0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(t.start)||t.isRetrieveFormatting||this.selection.owner.editorModule.onApplyColumnFormat("columns",e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.breakCodeIn},set:function(e){this.breakCodeIn=e,this.notifyPropertyChanged("breakCode")},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages,this.bidi=e.bidi,this.pageStartingNumber=e.pageStartingNumber,this.restartPageNumbering=e.restartPageNumbering,this.endnoteNumberFormat=e.endnoteNumberFormat,this.footNoteNumberFormat=e.footNoteNumberFormat,this.restartIndexForEndnotes=e.restartIndexForEndnotes,this.restartIndexForFootnotes=e.restartIndexForFootnotes,this.initialEndNoteNumber=e.initialEndNoteNumber,this.initialFootNoteNumber=e.initialFootNoteNumber,this.equalWidth=e.equalWidth,this.lineBetweenColumns=e.lineBetweenColumns,this.columns=[];for(var t=0,i=e.columns;t<i.length;t++){var n=i[t],r=new Zc(this.selection);r.width=Pa.convertPixelToPoint(n.width),r.space=Pa.convertPixelToPoint(n.space),this.columns.push(r)}if(this.breakCode=e.breakCode,this.selection.owner.enableHeaderAndFooter){var o=this.selection.documentHelper.headersFooters,s=this.selection.start.paragraph.containerWidget,l=s.sectionIndex,d=s.headerFooterType,h=!1;if(0==l)this.oddPageHeader.linkToPrevious=!1,this.oddPageFooter.linkToPrevious=!1,this.evenPageHeader.linkToPrevious=!1,this.evenPageFooter.linkToPrevious=!1,this.firstPageHeader.linkToPrevious=!1,this.firstPageFooter.linkToPrevious=!1;else if(o[l]){var c=this.selection.viewer.getHeaderFooter(d),p=o[l][c];if((0,a.isNullOrUndefined)(p)&&(h=!0),!(0,a.isNullOrUndefined)(p)||h)switch(d){case"OddHeader":this.oddPageHeader.linkToPrevious=!!h;break;case"OddFooter":this.oddPageFooter.linkToPrevious=!!h;break;case"EvenHeader":this.evenPageHeader.linkToPrevious=!!h;break;case"EvenFooter":this.evenPageFooter.linkToPrevious=!!h;break;case"FirstPageHeader":this.firstPageHeader.linkToPrevious=!!h;break;case"FirstPageFooter":this.firstPageFooter.linkToPrevious=!!h}}}},e.prototype.applyColumnFormat=function(){},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(((0,a.isNullOrUndefined)(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyvalue(e);(0,a.isNullOrUndefined)(i)||t.owner.editorModule.onApplySectionFormat(e,i)}},e.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":return this.pageHeight>0?this.pageHeight:void 0;case"pageWidth":return this.pageWidth>0?this.pageWidth:void 0;case"leftMargin":return this.leftMargin>=0?this.leftMargin:void 0;case"rightMargin":return this.rightMargin>=0?this.rightMargin:void 0;case"topMargin":return this.topMargin>=0?this.topMargin:void 0;case"bottomMargin":return this.bottomMargin>=0?this.bottomMargin:void 0;case"differentFirstPage":return(0,a.isNullOrUndefined)(this.differentFirstPage)?void 0:this.differentFirstPage;case"differentOddAndEvenPages":return(0,a.isNullOrUndefined)(this.differentOddAndEvenPages)?void 0:this.differentOddAndEvenPages;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":return(0,a.isNullOrUndefined)(this.pageStartingNumber)?void 0:this.pageStartingNumber;case"restartPageNumbering":return(0,a.isNullOrUndefined)(this.restartPageNumbering)?void 0:this.restartPageNumbering;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;case"equalWidth":return this.equalWidthIn;case"lineBetweenColumns":return this.lineBetweenColumnsIn;case"columns":return this.columnsIn;case"breakCode":return this.breakCodeIn;default:return}},e.prototype.combineFormat=function(e){this.pageHeight>0&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),this.pageWidth>0&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),this.leftMargin>-1&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),this.topMargin>-1&&this.topMargin!==e.topMargin&&(this.topMargin=-1),this.rightMargin>-1&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),this.bottomMargin>-1&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),(0,a.isNullOrUndefined)(this.differentFirstPage)||this.differentFirstPage===e.differentFirstPage||(this.differentFirstPage=void 0),(0,a.isNullOrUndefined)(this.pageStartingNumber)||this.pageStartingNumber===e.pageStartingNumber||(this.pageStartingNumber=void 0),(0,a.isNullOrUndefined)(this.restartPageNumbering)||this.restartPageNumbering===e.restartPageNumbering||(this.restartPageNumbering=void 0),(0,a.isNullOrUndefined)(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===e.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0),(0,a.isNullOrUndefined)(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),(0,a.isNullOrUndefined)(this.endnoteNumberFormat)||this.endnoteNumberFormat===e.endnoteNumberFormat||(this.endnoteNumberFormat=void 0),(0,a.isNullOrUndefined)(this.restartIndexForEndnotes)||this.restartIndexForEndnotes===e.restartIndexForEndnotes||(this.restartIndexForEndnotes=void 0),(0,a.isNullOrUndefined)(this.restartIndexForFootnotes)||this.restartIndexForFootnotes===e.restartIndexForFootnotes||(this.restartIndexForFootnotes=void 0),(0,a.isNullOrUndefined)(this.footNoteNumberFormat)||this.footNoteNumberFormat===e.footNoteNumberFormat||(this.footNoteNumberFormat=void 0),(0,a.isNullOrUndefined)(this.initialFootNoteNumber)||this.initialFootNoteNumber===e.initialFootNoteNumber||(this.initialFootNoteNumber=void 0),(0,a.isNullOrUndefined)(this.initialEndNoteNumber)||this.initialEndNoteNumber===e.initialEndNoteNumber||(this.initialEndNoteNumber=void 0)},e.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0,this.bidi=void 0,this.pageStartingNumber=void 0,this.restartPageNumbering=void 0,this.endnoteNumberFormat=void 0,this.footNoteNumberFormat=void 0,this.restartIndexForFootnotes=void 0,this.restartIndexForEndnotes=void 0,this.initialFootNoteNumber=1,this.initialEndNoteNumber=1},e.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0,this.bidi=void 0,this.pageStartingNumberIn=void 0,this.restartPageNumberingIn=void 0,this.endnoteNumberFormatIn=void 0,this.footNoteNumberFormatIn=void 0,this.restartIndexForFootnotesIn=void 0,this.restartIndexForEndnotesIn=void 0,this.initialEndNoteNumber=void 0,this.initialFootNoteNumber=void 0,this.firstPageHeaderIn=void 0,this.firstPageFooterIn=void 0,this.oddPageHeaderIn=void 0,this.oddPageFooterIn=void 0,this.evenPageHeaderIn=void 0,this.evenPageFooterIn=void 0},e}(),jc=function(){function e(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.bidiIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.titleIn},set:function(e){(0,a.isNullOrUndefined)(this.table)||(this.titleIn=e,this.notifyPropertyChanged("title"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.descriptionIn},set:function(e){(0,a.isNullOrUndefined)(this.table)||(this.descriptionIn=e,this.notifyPropertyChanged("description"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new Da;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;case"title":return this.title;case"description":return this.description;default:return}},e.prototype.notifyPropertyChanged=function(e){if(((0,a.isNullOrUndefined)(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(this.selection)&&!(0,a.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);"background"===e&&(e="shading"),(0,a.isNullOrUndefined)(t)||this.selection.owner.editorModule.onApplyTableFormat(e,t)}},e.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.title=e.title,this.description=e.description},e.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0,this.bidi=void 0},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0,this.bidi=void 0},e}(),Gc=function(){function e(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(!(0,a.isNullOrUndefined)(t)){if((t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting)return;if(!(0,a.isNullOrUndefined)(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.getPropertyValue(e);"background"===e&&(e="shading"),(0,a.isNullOrUndefined)(i)||this.selection.owner.editorModule.onApplyTableCellFormat(e,i)}}},e.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new Da;return t.backgroundColor=this.background,t;default:return}},e.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,e.shading.hasValue("foregroundColor")&&"TextureNone"!==e.shading.textureStyle&&(this.background=e.shading.foregroundColor),this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},e.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},e.prototype.combineFormat=function(e){(0,a.isNullOrUndefined)(this.leftMargin)||this.leftMargin===e.leftMargin||(this.leftMargin=void 0),(0,a.isNullOrUndefined)(this.topMargin)||this.topMargin===e.topMargin||(this.topMargin=void 0),(0,a.isNullOrUndefined)(this.rightMargin)||this.rightMargin===e.rightMargin||(this.rightMargin=void 0),(0,a.isNullOrUndefined)(this.bottomMargin)||this.bottomMargin===e.bottomMargin||(this.bottomMargin=void 0),(0,a.isNullOrUndefined)(this.background)||this.background===e.shading.backgroundColor||(this.background=void 0),(0,a.isNullOrUndefined)(this.verticalAlignment)||this.verticalAlignment===e.verticalAlignment||(this.verticalAlignment=void 0),(0,a.isNullOrUndefined)(this.preferredWidth)||this.preferredWidth===e.preferredWidth||(this.preferredWidth=void 0),(0,a.isNullOrUndefined)(this.preferredWidthType)||this.preferredWidthType===e.preferredWidthType||(this.preferredWidthType=void 0)},e.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},e.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0},e}(),Kc=function(){function e(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(((0,a.isNullOrUndefined)(t)||!t.isCleared&&!t.owner.isReadOnlyMode&&t.owner.isDocumentLoaded&&!t.owner.isPastingContent||t.isRetrieveFormatting)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyValue(e);(0,a.isNullOrUndefined)(i)||t.owner.editorModule.onApplyTableRowFormat(e,i)}},e.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},e.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},e.prototype.combineFormat=function(e){(0,a.isNullOrUndefined)(this.height)||this.height===e.height||(this.height=void 0),(0,a.isNullOrUndefined)(this.heightType)||this.heightType===e.heightType||(this.heightType=void 0),(0,a.isNullOrUndefined)(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===e.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0),(0,a.isNullOrUndefined)(this.isHeader)||this.isHeader===e.isHeader||(this.isHeader=void 0)},e.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0},e}(),Xc=function(){function e(e){this.selection=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alternateText",{get:function(){return this.image?this.image.alternateText:null},set:function(e){e!==this.alternateText&&(this.image.alternateText=e)},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){this.updateImageFormat(e,t,this.alternateText)},e.prototype.applyImageAlternativeText=function(e){this.updateImageFormat(this.width,this.height,e)},e.prototype.updateImageFormat=function(e,t,i){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t,i)},e.prototype.copyImageFormat=function(e){this.image=e},e.prototype.clearImageFormat=function(){this.image=void 0},e}(),Zc=function(){function e(e){this.widthIn=0,this.spaceIn=0,this.selection=e}return e.prototype.copyFormat=function(e){this.width=e.width,this.space=e.space},Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){e!==this.widthIn&&(this.widthIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"space":return this.space;case"width":return this.width;default:return}},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;(0,a.isNullOrUndefined)(t)||this.selection.owner.editorModule.onApplyColumnFormat("columns",this.selection.sectionFormat.columns)},e.prototype.clearFormat=function(){this.widthIn=0,this.spaceIn=0},e.prototype.destroy=function(){this.widthIn=void 0,this.spaceIn=void 0},e}(),Jc=function(){function e(){this.document=void 0,this.prevListLevel=void 0,this.isOrdered=void 0,this.keywordIndex=void 0,this.fieldCheck=0}return e.prototype.writeHtml=function(e,t){this.keywordIndex=t?1:0,this.document=e;var i="";e.hasOwnProperty(na[this.keywordIndex])&&this.serializeImages(e[na[this.keywordIndex]]);for(var n=0;n<e[ee[this.keywordIndex]].length;n++)i+=this.serializeSection(e[ee[this.keywordIndex]][n]);return i},e.prototype.serializeImages=function(e){for(var t in this.images=new l,e)if(Array.isArray(e[""+t]))this.images.add(parseInt(t),e[""+t]);else{var i=[];i.push(e[""+t]),this.images.add(parseInt(t),i)}},e.prototype.serializeSection=function(e){for(var t="",i=void 0,n=[],r=0;r<e[Go[this.keywordIndex]].length;r++){var o=e[Go[this.keywordIndex]][r];o.hasOwnProperty(Qr[this.keywordIndex])?(t+=this.serializeParagraph(o,n),i=this.getListLevel(o)):o.hasOwnProperty(Go[this.keywordIndex])?t+=this.serializeSection(o):(t+=this.closeList(),t+=this.serializeTable(o))}if(n.length>0&&((0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(this.prevListLevel)||this.prevListLevel[rs[this.keywordIndex]]===i[rs[this.keywordIndex]]&&this.prevListLevel[ne[this.keywordIndex]][gt[this.keywordIndex]]===i[ne[this.keywordIndex]][gt[this.keywordIndex]]))for(;n.length>0;)t+=this.closeList(),n.pop();return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},e.prototype.serializeParagraph=function(e,t){var i="",n=!1,r=!1,o=void 0,s=0;(0,a.isNullOrUndefined)(this.prevListLevel)||(r=!0);var l=[],d=void 0;if((0,a.isNullOrUndefined)(e[ne[this.keywordIndex]][kt[this.keywordIndex]])||(d=this.getListLevel(e),r||(this.prevListLevel=d),this.prevListLevel!==d&&(r=!1),(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(d)||(0,a.isNullOrUndefined)(this.prevListLevel)||!(this.prevListLevel[rs[this.keywordIndex]]<d[rs[this.keywordIndex]]&&this.prevListLevel!==d||this.prevListLevel[ne[this.keywordIndex]][gt[this.keywordIndex]]!==d[ne[this.keywordIndex]][gt[this.keywordIndex]])||(t.push(t.length),o=this.prevListLevel[rs[this.keywordIndex]],s=this.prevListLevel[ne[this.keywordIndex]][gt[this.keywordIndex]]),this.prevListLevel=d),!(0,a.isNullOrUndefined)(t)&&t.length>0&&((0,a.isNullOrUndefined)(d)||(0,a.isNullOrUndefined)(this.prevListLevel)||this.prevListLevel[rs[this.keywordIndex]]===o&&this.prevListLevel[ne[this.keywordIndex]][gt[this.keywordIndex]]===s))for(;t.length>0;)i+=this.closeList(),t.pop();return r||t&&0!==t.length||(i+=this.closeList()),(0,a.isNullOrUndefined)(d)||(n=!0),n&&!r&&(i+=this.getHtmlList(d,e[ne[this.keywordIndex]][kt[this.keywordIndex]][ut[this.keywordIndex]])),l.push('style="'+this.serializeParagraphStyle(e,"",n)+';white-space:pre"'),n?i+=this.createAttributesTag("li",l):(this.prevListLevel=void 0,this.isOrdered=void 0,i+=this.createAttributesTag(this.getStyleName(e[ne[this.keywordIndex]][Je[this.keywordIndex]]),l)),0===e[Qr[this.keywordIndex]].length?i+="<span />":i=this.serializeInlines(e,i),n?(i+=this.endTag("li")).indexOf("<ul")>-1?this.isOrdered=!1:i.indexOf("<ol")>-1&&(this.isOrdered=!0):i+=this.endTag(this.getStyleName(e[ne[this.keywordIndex]][Je[this.keywordIndex]])),i},e.prototype.closeList=function(){var e="";return(0,a.isNullOrUndefined)(this.isOrdered)||(e=this.isOrdered?this.endTag("ol"):this.endTag("ul"),this.isOrdered=void 0),e},e.prototype.getListLevel=function(e){for(var t=void 0,i=void 0,n=0;n<this.document[re[this.keywordIndex]].length;n++)if(this.document[re[this.keywordIndex]][n][ht[this.keywordIndex]]===e[ne[this.keywordIndex]][kt[this.keywordIndex]][ht[this.keywordIndex]]){i=this.document[re[this.keywordIndex]][n];break}if(i)for(var r=0;r<this.document[oe[this.keywordIndex]].length;r++)if(this.document[oe[this.keywordIndex]][r][ls[this.keywordIndex]]===i[ls[this.keywordIndex]]){var o=e[ne[this.keywordIndex]][kt[this.keywordIndex]][ut[this.keywordIndex]];t=this.document[oe[this.keywordIndex]][r][hs[this.keywordIndex]][o];break}return t},e.prototype.getHtmlList=function(e,t){var i="";if(e[ts[this.keywordIndex]]===(1==this.keywordIndex?10:"Bullet")){switch(i+='<ul type="',t){case 0:default:i+="disc",e[ie[this.keywordIndex]][Ze[this.keywordIndex]]="Symbol";break;case 1:i+="circle",e[ie[this.keywordIndex]][Ze[this.keywordIndex]]="Symbol";break;case 2:i+="square",e[ie[this.keywordIndex]][Ze[this.keywordIndex]]="Wingdings"}i+='">'}else{switch(i+='<ol type="',e[ts[this.keywordIndex]]){case"UpRoman":case 2:i+="I";break;case"LowRoman":case 3:i+="i";break;case"UpLetter":case 4:i+="A";break;case"LowLetter":case 5:i+="a";break;default:i+="1"}i+='" start="'+e[ns[this.keywordIndex]].toString()+'">'}return i},e.prototype.serializeInlines=function(e,t){for(var i=void 0,n=0,r=0;e[Qr[this.keywordIndex]].length>n;)if((i=e[Qr[this.keywordIndex]][n]).hasOwnProperty(Dn[this.keywordIndex])&&"\t"===i[Dn[this.keywordIndex]])r++,n++;else{if(r>0&&((o=[]).push('style="mso-tab-count:'+r.toString()+'"'),t+=this.createAttributesTag("span",o)+this.endTag("span"),r=0),i.hasOwnProperty(lr[this.keywordIndex]))t+=this.serializeImageContainer(i);else if(i.hasOwnProperty(Cr[this.keywordIndex]))if(0===i[Cr[this.keywordIndex]]){var o,s=e[Qr[this.keywordIndex]][n+1];if((0,a.isNullOrUndefined)(s[Dn[this.keywordIndex]])&&(s=e[Qr[this.keywordIndex]][n+2]),(0,a.isNullOrUndefined)(s)||(0,a.isNullOrUndefined)(s[Dn[this.keywordIndex]])||!(s[Dn[this.keywordIndex]].indexOf("TOC")>=0||s[Dn[this.keywordIndex]].indexOf("HYPERLINK")>=0))this.fieldCheck=void 0;else this.fieldCheck=1,(o=[]).push('style="'+this.serializeInlineStyle(i[ie[this.keywordIndex]])+'"'),t+=this.createAttributesTag("a",o)}else 2===i[Cr[this.keywordIndex]]?(0,a.isNullOrUndefined)(this.fieldCheck)?this.fieldCheck=0:this.fieldCheck=2:((0,a.isNullOrUndefined)(this.fieldCheck)||0===this.fieldCheck||(t+=this.endTag("a")),this.fieldCheck=0);else if(i.hasOwnProperty($r[this.keywordIndex]))t+=this.serializeContentInlines(i,t);else{var l=(0,a.isNullOrUndefined)(i[Dn[this.keywordIndex]])?"":i[Dn[this.keywordIndex]];if(i.hasOwnProperty(fs[this.keywordIndex]))switch(i[fs[this.keywordIndex]]){case 0:t+="<a name="+i[We[this.keywordIndex]]+">";break;case 1:t+="</a>"}if(0===this.fieldCheck&&(t+=this.serializeSpan(l,i[ie[this.keywordIndex]])),1===this.fieldCheck)t+=' href= "'+l.replace(/"/g,"").replace("HYPERLINK","").trim(),t+='"',t+=">";2===this.fieldCheck&&(t+=this.serializeSpan(l,i[ie[this.keywordIndex]]))}n++}return t},e.prototype.serializeContentInlines=function(e,t){return t=this.serializeInlines(e,t)},e.prototype.serializeSpan=function(e,t){var i="";if(-1!==e.indexOf("\v"))return(i+="<br>").toString();if(-1!==e.indexOf("\f"))return(i+='<br style = "page-break-after:always;"/>').toString();var n=[];return this.serializeInlineStyle(t),n.push('style="'+this.serializeInlineStyle(t)+'"'),i+=this.createAttributesTag("span",n),i+=this.decodeHtmlNames(e.toString()),(i+=this.endTag("span")).toString()},e.prototype.getStyleName=function(e){switch(e){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"p"}},e.prototype.serializeImageContainer=function(e){var t="",i=[];this.serializeInlineStyle(e[ie[this.keywordIndex]]);var n="";(0,a.isNullOrUndefined)(e[lr[this.keywordIndex]])||(n=this.images.get(parseInt(e[lr[this.keywordIndex]]))[Pa.parseBoolValue(e[pr[this.keywordIndex]])?1:0]);var r=Pa.convertPointToPixel(e[zn[this.keywordIndex]]),o=Pa.convertPointToPixel(e[qn[this.keywordIndex]]);return i.push('width="'+r.toString()+'"'),i.push('height="'+o.toString()+'"'),i.push('src="'+n+'"'),t+=this.createAttributesTag("img",i),(t+=this.endTag("img")).toString()},e.prototype.serializeCell=function(e,t){var i="",n=[],r="";if(n=[],!(0,a.isNullOrUndefined)(e[So[this.keywordIndex]])){if((0,a.isNullOrUndefined)(e[So[this.keywordIndex]][wi[this.keywordIndex]][Fi[this.keywordIndex]])||"empty"===e[So[this.keywordIndex]][wi[this.keywordIndex]][Fi[this.keywordIndex]]||n.push('bgcolor="'+Pa.getColor(e[So[this.keywordIndex]][wi[this.keywordIndex]][Fi[this.keywordIndex]])+'"'),!(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][ni[this.keywordIndex]])&&e[So[this.keywordIndex]][ni[this.keywordIndex]]>1&&n.push('colspan="'+e[So[this.keywordIndex]][ni[this.keywordIndex]].toString()+'"'),!(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][ri[this.keywordIndex]])&&e[So[this.keywordIndex]][ri[this.keywordIndex]]>1&&n.push('rowspan="'+e[So[this.keywordIndex]][ri[this.keywordIndex]].toString()+'"'),!(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][ii[this.keywordIndex]])&&0!==e[So[this.keywordIndex]][ii[this.keywordIndex]]){var o=Pa.convertPointToPixel(e[So[this.keywordIndex]][ii[this.keywordIndex]]);n.push('width="'+o.toString()+'"')}var s=(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][oi[this.keywordIndex]])?"top":this.convertVerticalAlignment(e[So[this.keywordIndex]][oi[this.keywordIndex]]);n.push('valign="'+s+'"'),(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][Mt[this.keywordIndex]])||0===e[So[this.keywordIndex]][Mt[this.keywordIndex]]||(r+="padding-left:"+e[So[this.keywordIndex]][Mt[this.keywordIndex]].toString()+"pt;"),(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][At[this.keywordIndex]])||0===e[So[this.keywordIndex]][At[this.keywordIndex]]||(r+="padding-right:"+e[So[this.keywordIndex]][At[this.keywordIndex]].toString()+"pt;"),(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][Ut[this.keywordIndex]])||0===e[So[this.keywordIndex]][Ut[this.keywordIndex]]||(r+="padding-top:"+e[So[this.keywordIndex]][Ut[this.keywordIndex]].toString()+"pt;"),(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][Vt[this.keywordIndex]])||0===e[So[this.keywordIndex]][Vt[this.keywordIndex]]||(r+="padding-bottom:"+e[So[this.keywordIndex]][Vt[this.keywordIndex]].toString()+"pt;"),(0,a.isNullOrUndefined)(e[So[this.keywordIndex]][Et[this.keywordIndex]])||(r+=this.serializeCellBordersStyle(e[So[this.keywordIndex]][Et[this.keywordIndex]],t))}0!==r.length&&n.push('style="'+r+'"'),i+=this.createAttributesTag("td",n);for(var l=0;l<e[Go[this.keywordIndex]].length;l++){var d=e[Go[this.keywordIndex]][l];d.hasOwnProperty(Eo[this.keywordIndex])?i+=this.serializeTable(d):d.hasOwnProperty(Go[this.keywordIndex])?i+=this.serializeSection(d):i+=this.serializeParagraph(d)}return i+=this.endTag("td")},e.prototype.convertVerticalAlignment=function(e){switch(e){case"Center":case 1:return"middle";case"Bottom":case 2:return"bottom";default:return"top"}},e.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e[Eo[this.keywordIndex]].length;i++)t+=this.serializeRow(e[Eo[this.keywordIndex]][i]);return t+=this.createTableEndTag()},e.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e[Ho[this.keywordIndex]].length;i++)t+=this.serializeCell(e[Ho[this.keywordIndex]][i],e);return t},e.prototype.serializeParagraphStyle=function(e,t,i,n){var r="";(0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=n),e[Qr[this.keywordIndex]].length>0&&(r+=this.serializeCharacterFormat(e[ie[this.keywordIndex]]));var o=!1;return 0==e[Qr[this.keywordIndex]].length&&(o=!0),r+=this.serializeCharacterFormat(e[ie[this.keywordIndex]],o),r+=this.serializeParagraphFormat(e[ne[this.keywordIndex]],i)},e.prototype.serializeInlineStyle=function(e){return this.serializeCharacterFormat(e)},e.prototype.serializeTableBorderStyle=function(e){var t="",i={};return i=e[fr[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(i)&&Pa.parseBoolValue(i[Ti[this.keywordIndex]])&&(t+="border-left-style:none;"):(i[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[or[this.keywordIndex]])?"#000000":i[or[this.keywordIndex]],i[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[Bi[this.keywordIndex]])?.5:i[Bi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"left")),i=e[ur[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(i)&&Pa.parseBoolValue(i[Ti[this.keywordIndex]])&&(t+="border-top-style:none;"):(i[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[or[this.keywordIndex]])?"#000000":i[or[this.keywordIndex]],i[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[Bi[this.keywordIndex]])?.5:i[Bi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"top")),i=e[mr[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(i)&&Pa.parseBoolValue(i[Ti[this.keywordIndex]])&&(t+="border-right-style:none;"):(i[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[or[this.keywordIndex]])?"#000000":i[or[this.keywordIndex]],i[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[Bi[this.keywordIndex]])?.5:i[Bi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"right")),i=e[gr[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(i)&&Pa.parseBoolValue(i[Ti[this.keywordIndex]])&&(t+="border-bottom-style:none;"):(i[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[or[this.keywordIndex]])?"#000000":i[or[this.keywordIndex]],i[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(i[Bi[this.keywordIndex]])?.5:i[Bi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"bottom")),t},e.prototype.serializeCellBordersStyle=function(e,t){var i="",n={};return n=e[fr[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(n)&&Pa.parseBoolValue(n[Ti[this.keywordIndex]])?i+="border-left-style:none;":(0,a.isNullOrUndefined)(t[To[this.keywordIndex]][Et[this.keywordIndex]][fr[this.keywordIndex]])||(n=t[To[this.keywordIndex]][Et[this.keywordIndex]][fr[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"left"))):(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"left")),n=e[ur[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(n)&&Pa.parseBoolValue(n[Ti[this.keywordIndex]])?i+="border-top-style:none;":(0,a.isNullOrUndefined)(t[To[this.keywordIndex]][Et[this.keywordIndex]][ur[this.keywordIndex]])||(n=t[To[this.keywordIndex]][Et[this.keywordIndex]][ur[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"top"))):(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"top")),n=e[mr[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(n)&&Pa.parseBoolValue(n[Ti[this.keywordIndex]])?i+="border-right-style:none;":(0,a.isNullOrUndefined)(t[To[this.keywordIndex]][Et[this.keywordIndex]][mr[this.keywordIndex]])||(n=t[To[this.keywordIndex]][Et[this.keywordIndex]][mr[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"right"))):(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"right")),n=e[gr[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!(0,a.isNullOrUndefined)(n)&&Pa.parseBoolValue(n[Ti[this.keywordIndex]])?i+="border-bottom-style:none;":(0,a.isNullOrUndefined)(t[To[this.keywordIndex]][Et[this.keywordIndex]][gr[this.keywordIndex]])||(n=t[To[this.keywordIndex]][Et[this.keywordIndex]][gr[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||n[Oi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"bottom"))):(n[or[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[or[this.keywordIndex]])?"#000000":n[or[this.keywordIndex]],n[Bi[this.keywordIndex]]=(0,a.isNullOrUndefined)(n[Bi[this.keywordIndex]])?.5:n[Bi[this.keywordIndex]],i+=this.serializeBorderStyle(n,"bottom")),i},e.prototype.serializeBorderStyle=function(e,t){var i="";return i+="border-"+t+"-style:"+this.convertBorderLineStyle(e[Oi[this.keywordIndex]]),i+=";",e[Bi[this.keywordIndex]]>0&&(i+="border-"+t+"-width:"+e[Bi[this.keywordIndex]].toString()+"pt;"),(0,a.isNullOrUndefined)(e[or[this.keywordIndex]])||(i+="border-"+t+"-color:"+Pa.getColor(e[or[this.keywordIndex]])+";"),i},e.prototype.convertBorderLineStyle=function(e){switch(e){case"Single":case 0:case"SingleWavy":case 18:case"DashDotStroked":case 20:default:return"solid";case"None":case 1:return"none";case"Dot":case 2:return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":case 3:case 4:case 5:case 6:return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case"DoubleWavy":case 19:return"double";case"Emboss3D":case 21:return"ridge";case"Engrave3D":case 22:return"groove";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset"}},e.prototype.serializeCharacterFormat=function(e,t){if(!(0,a.isNullOrUndefined)(e[$s[this.keywordIndex]]))return this.serializeCharacterFormat(e[$s[this.keywordIndex]],t);var i,n="";return n+="font-weight",n+=":",n+=Pa.parseBoolValue(e[Ae[this.keywordIndex]])?"bold":"normal",n+=";",n+="font-style",n+=":",Pa.parseBoolValue(e[Ue[this.keywordIndex]])?n+="italic":n+="normal",n+=";",n+=this.serializeTextDecoration(e),e[_e[this.keywordIndex]]!==(1==this.keywordIndex?1:"Superscript")&&e[_e[this.keywordIndex]]!==(1==this.keywordIndex?2:"Subscript")||(n+="vertical-align",n+=":",n+=e[_e[this.keywordIndex]]===(1==this.keywordIndex?1:"Superscript")?"super":"sub",n+=";"),(0,a.isNullOrUndefined)(e[Ge[this.keywordIndex]])||e[Ge[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||t||(n+="background-color",n+=":",n+=1==this.keywordIndex?this.getHighlightColorCode(e[Ge[this.keywordIndex]]):Pa.getHighlightColorCode(e.highlightColor.toString()),n+=";"),i=e[Xe[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||(n+="color",n+=":",n+=Pa.getColor(i),n+=";"),!(0,a.isNullOrUndefined)(e[rt[this.keywordIndex]])&&Pa.parseBoolValue(e[rt[this.keywordIndex]])&&(n+="text-transform",n+=":",n+="uppercase",n+=";"),i=e[Ke[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||(n+="font-size",n+=":",n+=i.toString(),n+="pt",n+=";"),i=e[Ze[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||(n+="font-family",n+=":",n+=i.toString(),n+=";"),i=e[ct[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||(n+="letter-spacing",n+=":",n+=i.toString(),n+="pt",n+=";"),i=e[pt[this.keywordIndex]],(0,a.isNullOrUndefined)(i)||(n+="transform:scaleX(",n+=(i/100).toString(),n+=")",n+=";"),n.toString()},e.prototype.serializeTextDecoration=function(e){var t="";return e[je[this.keywordIndex]]!==(1==this.keywordIndex?1:"SingleStrike")&&e[je[this.keywordIndex]]!==(1==this.keywordIndex?2:"DoubleStrike")||(t+="line-through "),(0,a.isNullOrUndefined)(e[Ve[this.keywordIndex]])||e[Ve[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||(t+="underline"),t.length>1&&(t="text-decoration:"+t+";"),t},e.prototype.serializeParagraphFormat=function(e,t,i){if((0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=i),!(0,a.isNullOrUndefined)(e[$s[this.keywordIndex]]))return this.serializeParagraphFormat(e[$s[this.keywordIndex]],t);var n,r="";if(n=this.getTextAlignment(e[vt[this.keywordIndex]]),(0,a.isNullOrUndefined)(n)||(r+="text-align:"+n.toLowerCase()+";"),n=e[wt[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||(r+="margin-top:"+n.toString()+"pt; "),n=e[mt[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||(r+="margin-right:"+n.toString()+"pt; "),n=e[yt[this.keywordIndex]],(0,a.isNullOrUndefined)(n)||(r+="margin-bottom:"+n.toString()+"pt; "),n=e[gt[this.keywordIndex]],t&&(n=0),(0,a.isNullOrUndefined)(n)||(r+="margin-left:"+n.toString()+"pt; "),n=e[ft[this.keywordIndex]],t&&(n=0),(0,a.isNullOrUndefined)(n)||0===n||(r+="text-indent:"+n.toString()+"pt;"),!(0,a.isNullOrUndefined)(e[Nt[this.keywordIndex]])&&e[Nt[this.keywordIndex]].length>0&&(r+=this.serializeTabs(e[Nt[this.keywordIndex]])),n=e[xt[this.keywordIndex]],!(0,a.isNullOrUndefined)(n)){var o=e[It[this.keywordIndex]],s=o===(1==this.keywordIndex?0:"Multiple"),l=o===(1==this.keywordIndex?0:"AtLeast");1==n&&s?r+="line-height:normal;":s?r+="line-height:"+(100*Math.abs(n)).toString()+"%;":(!l||n>=12)&&(r+="line-height:"+n.toString()+"pt;")}return r.toString()},e.prototype.serializeTabs=function(e){for(var t="tab-stops:",i=0;i<e.length;i++){var n=e[i];if(n.hasOwnProperty(ys[this.keywordIndex])){var r=this.getTabJustification(n[ys[this.keywordIndex]]);""!==r&&(t+=r+" ")}if(n.hasOwnProperty(xs[this.keywordIndex])){var o=this.getTabLeader(n[xs[this.keywordIndex]]);""!==o&&(t+=o+" ")}n.hasOwnProperty(ws[this.keywordIndex])&&(t+=n[ws[this.keywordIndex]].toString()+"pt"),i!==e.length-1&&(t+=" ")}return t+=";"},e.prototype.getTabLeader=function(e){switch(e){case"Dot":case 2:return"dotted";case"Hyphen":case 3:return"dashed";case"Underscore":case 4:return"heavy";default:return""}},e.prototype.getTabJustification=function(e){switch(e){case"Bar":case 1:return"bar";case"Center":case 2:return"center";case"Decimal":case 3:return"decimal";case"Right":case 5:return"right";default:return""}},e.prototype.createAttributesTag=function(e,t){var i="";i+="<",i+=e;for(var n=0;n<t.length;n++)i+=" ",i+=t[n];return"a"!==e&&(i+=">"),i},e.prototype.createTag=function(e){var t="";return t+="<",t+=e,t+=">"},e.prototype.endTag=function(e){var t="";return t+="<",t+="/",t+=e,t+=">"},e.prototype.createTableStartTag=function(e){var t="",i="",n=[];return(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]])||((0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]][wi[this.keywordIndex]])||(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]][wi[this.keywordIndex]][Fi[this.keywordIndex]])||"empty"===e[Lo[this.keywordIndex]][wi[this.keywordIndex]][Fi[this.keywordIndex]]||n.push('bgcolor="'+Pa.getColor(e[Lo[this.keywordIndex]][wi[this.keywordIndex]][Fi[this.keywordIndex]])+'"'),!(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]][yi[this.keywordIndex]])&&e[Lo[this.keywordIndex]][yi[this.keywordIndex]]>0?n.push('cellspacing="'+(72*e[Lo[this.keywordIndex]][yi[this.keywordIndex]]/96*2).toString()+'"'):i+="border-collapse:collapse;",n.push('cellpadding="0"'),(0,a.isNullOrUndefined)(e[no[this.keywordIndex]])||n.push('title="'+e[no[this.keywordIndex]]+'"'),(0,a.isNullOrUndefined)(e[No[this.keywordIndex]])||n.push('summary="'+e[No[this.keywordIndex]]+'"'),(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]][gt[this.keywordIndex]])||0===e[Lo[this.keywordIndex]][gt[this.keywordIndex]]||e[Lo[this.keywordIndex]][bi[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")||(i+="margin-left:"+e[Lo[this.keywordIndex]][gt[this.keywordIndex]].toString()+"pt;"),(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]])||(i+=this.serializeTableWidth(e[Lo[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]][Et[this.keywordIndex]])||(i+=this.serializeTableBorderStyle(e[Lo[this.keywordIndex]][Et[this.keywordIndex]]))),0!==i.length&&n.push('style="',i.toString()+'"'),t+this.createAttributesTag("table",n)},e.prototype.serializeTableWidth=function(e){var t="";switch(e[xi[this.keywordIndex]]){case"Percent":case 1:t+="width: "+e[Ci[this.keywordIndex]].toString()+"%;";break;case"Point":case 2:t+="width: "+e[Ci[this.keywordIndex]].toString()+"pt;";break;case"Auto":case 0:t+="width: auto;"}return t},e.prototype.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case 1:t="#ffff00";break;case 2:t="#00ff00";break;case 3:t="#00ffff";break;case 4:t="#ff00ff";break;case 5:t="#0000ff";break;case 6:t="#ff0000";break;case 7:t="#000080";break;case 8:t="#008080";break;case 9:t="#008000";break;case 10:t="#800080";break;case 11:t="#800000";break;case 12:t="#808000";break;case 13:t="#808080";break;case 14:t="#c0c0c0";break;case 15:t="#000000"}return t},e.prototype.getTextAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return"Left"}},e.prototype.createTableEndTag=function(){var e="";return e+=this.endTag("table")},e.prototype.createRowStartTag=function(e){var t="",i=[];if(Pa.parseBoolValue(e[To[this.keywordIndex]][ai[this.keywordIndex]])&&(t+=this.createTag("thead")),!(0,a.isNullOrUndefined)(e[To[this.keywordIndex]][qn[this.keywordIndex]])&&e[To[this.keywordIndex]][qn[this.keywordIndex]]>0){var n=Pa.convertPointToPixel(e[To[this.keywordIndex]][qn[this.keywordIndex]]);i.push('height="'+n+'"')}return t+this.createAttributesTag("tr",i)},e.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),Pa.parseBoolValue(e[To[this.keywordIndex]][ai[this.keywordIndex]])&&(t+=this.endTag("thead")),t},e.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";var t=(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(" "),i="";if(t.length>0){i=t[0];for(var n=0;n<t.length-1;n++)i+=" "+t[n+1]}return i},e}(),Yc=function(){function t(e){var t=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.isExcludeBookmarkStartEnd=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.isSelectCurrentWord=!1,this.isSelectionisInCC=!1,this.skipFormatRetrieval=!1,this.isModifyingSelectionInternally=!1,this.isMoveDownOrMoveUp=!1,this.isSelectBookmark=!1,this.isHighlightContentControlEditRegionIn=!0,this.htmlContent=void 0,this.sfdtContent=void 0,this.isEndOffset=!1,this.isViewPasteOptions=!1,this.skipEditRangeRetrieval=!1,this.selectedWidgets=void 0,this.isHighlightEditRegionIn=!1,this.isHighlightFormFields=!1,this.isHightlightEditRegionInternal=!1,this.isCurrentUser=!1,this.isHighlightNext=!1,this.isWebLayout=!1,this.contentControlHighlighters=void 0,this.editRegionHighlighters=void 0,this.contentControleditRegionHighlighters=void 0,this.formFieldHighlighters=void 0,this.isSelectList=!1,this.previousSelectedFormField=void 0,this.previousSelectedContentControl=void 0,this.currentContentControl=void 0,this.isFormatUpdated=!1,this.isCellPrevSelected=!1,this.currentFormField=void 0,this.contentControls=[],this.isHomeEnd=!1,this.pasteOptions=function(e){var i=new a.L10n("documenteditor",t.owner.defaultLocale);i.setLocale(t.owner.locale),e.item.text===i.getConstant("Keep source formatting")?t.owner.editorModule.applyPasteOptions("KeepSourceFormatting"):e.item.text===i.getConstant("Match destination formatting")?t.owner.editorModule.applyPasteOptions("MergeWithExistingFormatting"):e.item.text===i.getConstant("NestTable")?t.owner.editorModule.applyTablePasteOptions("NestTable"):e.item.text===i.getConstant("InsertAsRows")?t.owner.editorModule.applyTablePasteOptions("InsertAsRows"):e.item.text===i.getConstant("InsertAsColumns")?t.owner.editorModule.applyTablePasteOptions("InsertAsColumns"):e.item.text===i.getConstant("OverwriteCells")?t.owner.editorModule.applyTablePasteOptions("OverwriteCells"):t.owner.editorModule.applyPasteOptions("KeepTextOnly")},this.hideCaret=function(){(0,a.isNullOrUndefined)(t.caret)||(t.caret.style.display="none")},this.owner=e,this.documentHelper=this.owner.documentHelper,this.start=new ac(this.owner),this.end=new ac(this.owner),this.selectedWidgets=new l,this.characterFormatIn=new Ac(this),this.paragraphFormatIn=new zc(this,this.documentHelper),this.sectionFormatIn=new _c(this),this.rowFormatIn=new Kc(this),this.cellFormatIn=new Gc(this),this.tableFormatIn=new jc(this),this.imageFormatInternal=new Xc(this),this.editRangeCollection=[],this.editRegionHighlighters=new l,this.contentControleditRegionHighlighters=new l,this.formFieldHighlighters=new l}return Object.defineProperty(t.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(e){this.isHighlightEditRegionIn=e,this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHighlightContentControlEditRegion",{get:function(){return this.isHighlightContentControlEditRegionIn},set:function(e){this.isHighlightContentControlEditRegionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"htmlWriter",{get:function(){return(0,a.isNullOrUndefined)(this.htmlWriterIn)&&(this.htmlWriterIn=new Jc),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){if(!(0,a.isNullOrUndefined)(this.owner)&&!(0,a.isNullOrUndefined)(this.viewer))return(0,a.isNullOrUndefined)(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||(0,a.isNullOrUndefined)(this.viewer)||this.viewer instanceof Fl||(0,a.isNullOrUndefined)(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||(0,a.isNullOrUndefined)(this.viewer)||this.viewer instanceof Fl||(0,a.isNullOrUndefined)(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isinFootnote",{get:function(){return this.isFootNoteParagraph(this.start.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isinEndnote",{get:function(){return this.isEndNoteParagraph(this.start.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return!!(0,a.isNullOrUndefined)(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInShape",{get:function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof cd)return!0;e&&(e=e.containerWidget)}while(e);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sfdt",{get:function(){return this.owner.editorModule&&!this.isEmpty?JSON.stringify(this.writeSfdt()):void 0},enumerable:!0,configurable:!0}),t.prototype.getBookmarks=function(e){return this.getSelBookmarks(e)},Object.defineProperty(t.prototype,"isCleared",{get:function(){return(0,a.isNullOrUndefined)(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInField",{get:function(){return!(0,a.isNullOrUndefined)(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),t.prototype.getFieldInfo=function(){var e=this.getHyperlinkField(!0);if(!(0,a.isNullOrUndefined)(e))return{code:this.getFieldCode(e),result:this.owner.editorModule.getFieldResultText(e)}},t.prototype.isFootNoteParagraph=function(e){var t=this.getContainerWidget(e);return t instanceof Dl&&"Footnote"===t.footNoteType},t.prototype.isEndNoteParagraph=function(e){var t=this.getContainerWidget(e);return t instanceof Dl&&"Endnote"===t.footNoteType},t.prototype.isFootEndNoteParagraph=function(e){return!!this.isFootNoteParagraph(e)||!!this.isEndNoteParagraph(e)},t.prototype.getSelBookmarks=function(e){var t,i,n=[],r=this.documentHelper.bookmarks,o=this.start,s=this.end;this.isForward||(o=this.end,s=this.start);for(var l=!1,d=this.getSelectedCells(),h=0;h<r.length;h++)if(e||!e&&0!==r.keys[h].indexOf("_")){if(i=(t=r.get(r.keys[h])).reference,(0,a.isNullOrUndefined)(i))continue;var c=this.getElementPosition(t).startPosition,p=this.getElementPosition(i,!0).startPosition;if(c.paragraph.isInsideTable||p.paragraph.isInsideTable)if(d.length>0){if(d.indexOf(c.paragraph.associatedCell)>=0||d.indexOf(p.paragraph.associatedCell)>=0)l=!0;else if(l=!1,d.indexOf(c.paragraph.associatedCell)<0||d.indexOf(p.paragraph.associatedCell)<0){var u=s.paragraph.isInsideTable&&s.paragraph.associatedCell,g=p.paragraph.associatedCell;u&&g&&u.ownerTable.equals(g.ownerTable)&&u.ownerTable&&d.indexOf(this.getCellInTable(u.ownerTable,g))}}else l=!1;else l=!1;((o.isExistAfter(c)||o.isAtSamePosition(c))&&(s.isExistBefore(p)||s.isAtSamePosition(p))||(c.isExistAfter(o)||c.isAtSamePosition(o))&&(p.isExistBefore(s)||p.isAtSamePosition(s))||c.isExistAfter(o)&&c.isExistBefore(s)&&(s.isExistAfter(p)||s.isExistBefore(p))||p.isExistBefore(s)&&p.isExistAfter(o)&&(o.isExistBefore(c)||o.isExistAfter(c))||l)&&n.push(t.name)}return n},Object.defineProperty(t.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),t.prototype.getModuleName=function(){return"Selection"},t.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new kl(this.owner),this.owner.editorModule.layoutWholeDocument())},t.prototype.goToHeader=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},t.prototype.goToFooter=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},t.prototype.closeHeaderFooter=function(){this.disableHeaderFooter(),this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},t.prototype.closeXmlPane=function(){this.disableXml(),this.owner.enableXMLPane=!1,this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},t.prototype.goToPage=function(e){if(this.owner.scrollToPage(e),e>=1&&e<=this.owner.documentHelper.pages.length){var t=this.owner.documentHelper.pages[e-1];this.updateTextPositionForBlockContainer(t.bodyWidgets[0])}},t.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},t.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},t.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},t.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},t.prototype.select=function(e,t){if("string"==typeof e){var i=this.getTextPosBasedOnLogicalIndex(e),n=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,n)}else{var r=new Sa(e.x,e.y),o=this.viewer.findFocusedPage(r,!0);e.extend?this.moveTextPosition(o,this.end):this.documentHelper.updateTextPositionForSelection(o,1)}},t.prototype.selectByHierarchicalIndex=function(e,t){var i=this.getTextPosBasedOnLogicalIndex(e),n=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,n)},t.prototype.selectField=function(e){!this.isInField&&(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e)&&(e=this.getHyperlinkField(!0)),this.selectFieldInternal(e))},t.prototype.selectContentControlInternal=function(e){if(e){var t=e.line.getOffset(e,1),i=new ac(this.owner),n=e.reference;i.setPositionParagraph(e.line,t);var r=n.line.getOffset(n,0),o=new ac(this.owner);o.setPositionParagraph(n.line,r),this.documentHelper.selection.selectRange(i,o)}},t.prototype.selectFieldInternal=function(e,t,i){if(e){var n=this.documentHelper.isFormFillProtectedMode||i,r=e.fieldEnd;n&&(e=e.fieldSeparator);var o=e.line.getOffset(e,n?1:0),s=new ac(this.owner);s.setPositionParagraph(e.line,o),e.nextNode instanceof td&&!n&&e.nextElement.reference&&(r=e.nextElement.reference);var a=r.line.getOffset(r,n?0:1),l=new ac(this.owner);l.setPositionParagraph(r.line,a),this.documentHelper.selection.selectRange(s,l),i||this.triggerFormFillEvent(t)}},t.prototype.selectContentInternal=function(e){if(e){var t=e.reference,i=e.line.getOffset(e,0),n=new ac(this.owner);n.setPositionParagraph(e.line,i);var r=t.line.getOffset(t,0),o=new ac(this.owner);o.setPositionParagraph(t.line,r),n.offset++,o.offset,this.documentHelper.selection.selectRange(n,o)}},t.prototype.selectShape=function(e){if(e){var t=e.line.getOffset(e,0),i=new ac(this.owner);i.setPositionParagraph(e.line,t);var n=e.line.getOffset(e,1),r=new ac(this.owner);r.setPositionParagraph(e.line,n),this.documentHelper.selection.selectRange(i,r)}},t.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},t.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},t.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},t.prototype.toggleUnderline=function(e){this.owner.editorModule&&this.owner.editorModule.toggleUnderline(e)},t.prototype.toggleStrikethrough=function(e){this.owner.editorModule&&this.owner.editorModule.toggleStrikethrough(e)},t.prototype.toggleHighlightColor=function(e){this.owner.editorModule&&this.owner.editorModule.toggleHighlightColor(e)},t.prototype.toggleSubscript=function(){this.owner.editorModule&&this.owner.editorModule.toggleSubscript()},t.prototype.toggleSuperscript=function(){this.owner.editorModule&&this.owner.editorModule.toggleSuperscript()},t.prototype.toggleTextAlignment=function(e){this.owner.editorModule&&this.owner.editorModule.toggleTextAlignment(e)},t.prototype.increaseIndent=function(){this.owner.editorModule&&this.owner.editorModule.increaseIndent()},t.prototype.decreaseIndent=function(){this.owner.editorModule&&this.owner.editorModule.decreaseIndent()},t.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},t.prototype.fireRequestNavigate=function(e){var t=this.getFieldCode(e);if(0!==t.toLowerCase().indexOf("ref ")||t.match("\\h")){var i=new dc(e,this),n={isHandled:!1,navigationLink:i.navigationLink,linkType:i.linkType,localReference:i.localReference,source:this.owner};this.owner.trigger(D,n),n.isHandled||this.documentHelper.selection.navigateBookmark(i.localReference,!0)}},t.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),t=this.getLinkText(e,!0);this.copyToClipboard(t)},t.prototype.isHideSelection=function(e){var t=e.bodyWidget,i=t.sectionFormat,n=i.pageHeight-i.footerDistance,r=t.page.boundingRectangle.height/100*40;return this.contextType.indexOf("Footer")>=0&&e.y+e.height>Pa.convertPointToPixel(n)||this.contextType.indexOf("Header")>=0&&e.y+e.height>r},t.prototype.highlightSelection=function(e,t){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape(),this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition(),e&&this.documentHelper.scrollToPosition(this.start,this.end,void 0,t)},t.prototype.createHighlightBorder=function(e,t,i,n,r,o){t<0&&(t=0);var s=e.paragraph,l=[];if(s.floatingElements.length>0)for(var d=0;d<s.floatingElements.length;d++){var h=s.floatingElements[d];if(h.line===e){var c=this.start,p=this.end;this.isForward||(c=this.end,p=this.start);var u=h.line.getOffset(h,0);(c.currentWidget!==e&&p.currentWidget!==e||c.currentWidget===e&&c.offset<=u&&(p.currentWidget===e&&p.offset>=u+1||p.currentWidget!==e)||c.currentWidget!==e&&p.currentWidget===e&&p.offset>=u)&&l.push(h)}}var g=this.getPage(e.paragraph),m=(e.height,this.selectedWidgets),f=void 0,v=void 0;if(this.isHighlightContentControlEditRegion&&!(0,a.isNullOrUndefined)(o))return 0===t&&(t=this.documentHelper.textHelper.getParagraphMarkSize(s.characterFormat).Width),void this.addContentControlEditRegionHighlight(e,i,t,o);if(this.isHightlightEditRegionInternal)this.addEditRegionHighlight(e,i,t);else if(this.isHighlightFormFields)this.addFormFieldHighlight(e,i,t);else{if(m.containsKey(e))m.get(e)instanceof lc?(f=m.get(e),r&&(m.remove(e),v=[],m.add(e,v))):v=m.get(e);else if(r)v=[],m.add(e,v);else{var y=this.getWrapPosition(e,s);if(y.length>0){var w=this.splitSelectionHighlightPosition(i,t,y);if(w.length>0)return w[0].floatingItems=l,m.add(e,w),void this.renderHighlight(g,e,w,n,l);(f=new lc(i,t)).floatingItems=l,m.add(e,f)}else(f=new lc(i,t)).floatingItems=l,m.add(e,f)}void 0===f&&((f=new lc(i,t)).floatingItems=l,m.add(e,f)),this.renderHighlight(g,e,[f],n,l),r&&v.push(f)}},t.prototype.renderHighlight=function(e,t,i,n,r){var o=this.owner.documentHelper,s=this.getPageTop(e),a=e.boundingRectangle.x,l=t.height;if(this.viewer.containerTop<=s||s<this.viewer.containerTop+o.selectionCanvas.height){var d=o.zoomFactor;this.clipSelection(e,s);for(var h=0;h<i.length;h++){var c=i[h],p=c.left,u=c.width;this.documentHelper.isComposingIME?this.renderDashLine(o.selectionContext,e,t,a+p*d-this.viewer.containerLeft,n,u*d,l):(this.documentHelper.selectionContext.fillStyle="gray",o.selectionContext.globalAlpha=.4,o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+n*d-this.viewer.containerTop,u*d,l*d))}if(r.length>0)for(var g=0;g<r.length;g++){p=r[g].x;var m=r[g].y,f=r[g].width,v=r[g].height;o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+m*d-this.viewer.containerTop,f*d,v*d)}o.selectionContext.restore()}},t.prototype.getWrapPosition=function(e,t){var i=t.bodyWidget;if(!(0,a.isNullOrUndefined)(i)&&i.floatingElements.length>0&&e.children.length>0){for(var n=this.getLeftInternal(e,e.children[0],0),r=0,o=[],s=!1,l=0;l<e.children.length;l++){var d=e.children[l];if(!(d instanceof dd&&"Inline"!==d.textWrappingStyle)){if(d.padding.left>0){1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x,n=t.x);var h={};h.start=n+r,h.end=0,s&&(h.end=n+r+d.padding.left),o.push(h)}r+=d.padding.left+d.width,d instanceof Zl&&(s=!0)}}return 1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x),o}return[]},t.prototype.splitSelectionHighlightPosition=function(e,t,i){for(var n=[],r=0;r<i.length;r++){var o=i[r];e<o.start&&e+t<o.end||e>o.end||(e<o.start&&e+t>o.end?(n.push(new lc(e,o.start-e)),t=e+t-o.end,e=o.end):e===o.start&&(t<o.end?(t=e+t-o.end,e=o.end):(e+=o.end,t-=o.end)),r===i.length-1&&n.push(new lc(e,t)))}return n},t.prototype.addEditRegionHighlight=function(e,t,i){var n=void 0,r=this.editRegionHighlighters;r.containsKey(e)?n=r.get(e):(n=[],r.add(e,n));var o=new lc(t,i);return this.isCurrentUser&&(o.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),n.push(o),o},t.prototype.addContentControlEditRegionHighlight=function(e,t,i,n){var r=this.contentControleditRegionHighlighters,o=[];r.containsKey(n)||r.add(n,new l),r.get(n).add(e,o);var s=new lc(t,i);o.push(s)},t.prototype.addFormFieldHighlight=function(e,t,i){var n=void 0,r=this.formFieldHighlighters;r.containsKey(e)?n=r.get(e):(n=[],r.add(e,n));var o=new lc(t,i);n.push(o)},t.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,n=e.x-e.margin.left+e.leftBorderWidth,r=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,s=e.height,a=this.getPageTop(t),l=t.boundingRectangle.x,d=this.documentHelper.isPageInVisibleBound(t,a),h=this.selectedWidgets;if(this.isHightlightEditRegionInternal||this.isHighlightFormFields||(h.containsKey(e)&&h.get(e)instanceof lc?(i=h.get(e),d&&this.documentHelper.selectionContext.clearRect(l+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,a+o*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,s*this.documentHelper.zoomFactor)):(i=new lc(n,r),h.containsKey(e)&&h.remove(h.get(e)),h.add(e,i))),d){this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4;var c=this.documentHelper.zoomFactor;this.clipSelection(t,a),this.documentHelper.selectionContext.fillRect(l+n*c-this.viewer.containerLeft,a+o*c-this.viewer.containerTop,r*c,s*c),this.documentHelper.selectionContext.restore()}},t.prototype.clipSelection=function(e,t){var i,n,r=this.owner.documentHelper;this.viewer instanceof Fl&&this.documentHelper.zoomFactor<1?(i=e.boundingRectangle.width/this.documentHelper.zoomFactor,n=e.boundingRectangle.height/this.documentHelper.zoomFactor):(i=e.boundingRectangle.width*this.documentHelper.zoomFactor,n=e.boundingRectangle.height*this.documentHelper.zoomFactor);var o=e.boundingRectangle.x;r.selectionContext.beginPath(),r.selectionContext.save(),r.selectionContext.rect(o-this.viewer.containerLeft,t-this.viewer.containerTop,i,n),r.selectionContext.clip()},t.prototype.addSelectionHighlight=function(e,t,i,n){if(this.selectedWidgets.containsKey(t)){var r=this.documentHelper.render.getScaledValue(t.height),o=this.selectedWidgets.get(t),s=void 0;if(o instanceof lc?(s=[]).push(o):s=o,!(0,a.isNullOrUndefined)(s))for(var l=0;l<s.length;l++){var d=s[l],h=this.documentHelper.render.getScaledValue(s[l].width),c=this.documentHelper.render.getScaledValue(s[l].left,1);if((0,a.isNullOrUndefined)(n)&&(n=this.owner.selectionModule.getPage(t.paragraph)),this.owner.selectionModule.clipSelection(n,this.owner.selectionModule.getPageTop(n)),this.documentHelper.isComposingIME)this.renderDashLine(e,n,t,c,i,h,r);else if(e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(c,this.documentHelper.render.getScaledValue(i,2),h,r),d.floatingItems&&d.floatingItems.length>0)for(var p=0;p<d.floatingItems.length;p++){var u=d.floatingItems[p];h=this.documentHelper.render.getScaledValue(u.width),c=this.documentHelper.render.getScaledValue(u.x,1);var g=this.documentHelper.render.getScaledValue(u.y,2);e.fillRect(c,g,h,this.documentHelper.render.getScaledValue(u.height))}e.restore()}}},t.prototype.renderDashLine=function(e,t,i,n,r,o,s){var a=this.characterFormat.fontColor,l=a?Pa.getColor(a):"#000000";e.globalAlpha=1;var d=this.owner.editorModule.copyInsertFormat(new ka,!1),h=this.documentHelper.textHelper.getHeight(d),c=this.getPageTop(t),p=h.Height-h.BaselineOffset;r=this.documentHelper.render.getUnderlineYPosition(i)+r+4-p,this.documentHelper.render.renderDashLine(e,n,c-this.viewer.containerTop+r*this.documentHelper.zoomFactor,o,l,!0)},t.prototype.addSelectionHighlightTable=function(e,t,i){if(this.selectedWidgets.containsKey(t)){var n=this.selectedWidgets.get(t),r=void 0;if(n instanceof lc?(r=[]).push(n):r=n,!(0,a.isNullOrUndefined)(r))for(var o=0;o<r.length;o++){var s=this.documentHelper.render.getScaledValue(r[o].left,1),l=this.documentHelper.render.getScaledValue(t.y,2),d=this.documentHelper.render.getScaledValue(r[o].width),h=this.documentHelper.render.getScaledValue(t.height);e.fillStyle="gray",(0,a.isNullOrUndefined)(i)&&(i=this.owner.selectionModule.getPage(t)),this.owner.selectionModule.clipSelection(i,this.owner.selectionModule.getPageTop(i)),e.fillRect(s,l,d,h),e.restore()}}},t.prototype.removeSelectionHighlight=function(e){var t=0,i=0,n=0,r=0,o=void 0;if(e instanceof zl){var s=e,l=s.paragraph;if(o=(0,a.isNullOrUndefined)(l)?void 0:this.getPage(s.paragraph),(0,a.isNullOrUndefined)(o))return;i=this.getTop(s),r=s.height}else if(e instanceof Vl){if(o=(0,a.isNullOrUndefined)(e)?void 0:this.getPage(e),(0,a.isNullOrUndefined)(o))return;i=e.y,r=e.height}if(!(0,a.isNullOrUndefined)(o)){var d=this.selectedWidgets.get(e),h=void 0;if(d instanceof lc?(h=[]).push(d):h=d,!(0,a.isNullOrUndefined)(h))for(var c=0;c<h.length;c++){n=h[c].width,t=h[c].left;var p=o.boundingRectangle,u=this.documentHelper.pages.indexOf(o),g=this.viewer.pageGap,m=(p.y-g*(u+1))*this.documentHelper.zoomFactor+g*(u+1),f=p.x,v=this.documentHelper.zoomFactor;(this.viewer.containerTop<=m||m<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(f+t*v-this.viewer.containerLeft-.5,m+i*v-this.viewer.containerTop-.5,n*v+.5,r*v+.5)}}},t.prototype.selectCurrentWord=function(e){this.isSelectCurrentWord=!0;var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,e||!1),this.selectRange(t,i),this.isSelectCurrentWord=!1},t.prototype.selectParagraph=function(){(0,a.isNullOrUndefined)(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.selectLine=function(){(0,a.isNullOrUndefined)(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},t.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},t.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},t.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},t.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},t.prototype.moveToNextLine=function(){this.moveDown()},t.prototype.moveToPreviousLine=function(){this.moveUp()},t.prototype.moveToNextCharacter=function(){this.handleRightKey()},t.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},t.prototype.selectCurrentWordRange=function(e,t,i){if(!(0,a.isNullOrUndefined)(e)){if(e.offset>0){var n=e.clone(),r=0,o=e.currentWidget.getInline(e.offset,r),s=o.element;r=o.index,!(0,a.isNullOrUndefined)(s)&&s instanceof _l&&1===s.fieldType?e.offset>2&&(!(0,a.isNullOrUndefined)(s.fieldSeparator)||(0,a.isNullOrUndefined)(s.fieldBegin))?(n.setPositionParagraph(n.currentWidget,e.offset-2),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset-1||e.moveToWordStartInternal(2)):e.offset>3&&(0,a.isNullOrUndefined)(s.fieldSeparator)&&(n.setPositionParagraph(n.currentWidget,e.offset-3),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2)):(n.setPositionParagraph(n.currentWidget,e.offset-1),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2))}t.moveToWordEndInternal(2,i)}},t.prototype.extendToParagraphStart=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToParagraphEnd=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.moveNextPosition=function(){if(!(0,a.isNullOrUndefined)(this.start)&&(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,e))}},t.prototype.moveToNextParagraph=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.nextFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t+1];(0,a.isNullOrUndefined)(i)&&(i=e);for(var n=this.start.clone(),r=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,l=1;l<s.bodyWidgets.length;l++){s.bodyWidgets[l].footNoteReference===i&&(n.setPositionParagraph(s.bodyWidgets[l].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))}}},t.prototype.previousFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t-1];(0,a.isNullOrUndefined)(i)&&(i=e);for(var n=this.start.clone(),r=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,l=1;l<s.bodyWidgets.length;l++){s.bodyWidgets[l].footNoteReference===i&&(n.setPositionParagraph(s.bodyWidgets[l].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))}}},t.prototype.nextEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),i=this.documentHelper.endnoteCollection[t+1];(0,a.isNullOrUndefined)(i)&&(i=e);for(var n=this.start.clone(),r=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++){o.bodyWidgets[s].footNoteReference===i&&(n.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))}}},t.prototype.previousEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=this.documentHelper.endnoteCollection.indexOf(e),i=this.documentHelper.endnoteCollection[t-1];(0,a.isNullOrUndefined)(i)&&(i=e);for(var n=this.start.clone(),r=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++){o.bodyWidgets[s].footNoteReference===i&&(n.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),r.setPositionInternal(n),this.selectRange(n,r))}}},t.prototype.movePreviousPosition=function(){if(!(0,a.isNullOrUndefined)(this.start)&&(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,e))}},t.prototype.moveToPreviousParagraph=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToPreviousLine=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},t.prototype.extendToLineEnd=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToLineStart=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},t.prototype.moveUp=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!1);else if(!(0,a.isNullOrUndefined)(this.start)){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns,i=this.start.currentWidget.paragraph.bodyWidget.index;this.start.moveUp(this,this.upDownSelectionLength),t=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1;var n=this.start.currentWidget.paragraph.bodyWidget.columnIndex;if(t)if(e===n||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else do{if((0,a.isNullOrUndefined)(this.start.currentWidget.paragraph.previousRenderedWidget)||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)break;if(i!==this.start.currentWidget.paragraph.bodyWidget.index&&this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1&&e>this.start.currentWidget.paragraph.bodyWidget.columnIndex)break;this.start.moveUp(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.columnIndex);this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},t.prototype.moveDown=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!0);else if(!(0,a.isNullOrUndefined)(this.start)){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.index,i=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1;this.start.moveDown(this,this.upDownSelectionLength);var n=this.start.currentWidget.paragraph.bodyWidget.columnIndex;if(i)if(e===n||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else do{if((0,a.isNullOrUndefined)(this.start.currentWidget.paragraph.nextRenderedWidget)||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)break;if(t!==this.start.currentWidget.paragraph.bodyWidget.index&&this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1&&this.documentHelper.layout.getBodyWidget(this.start.currentWidget.paragraph.bodyWidget,!1)===this.start.currentWidget.paragraph.bodyWidget)break;this.start.moveDown(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.columnIndex);this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},t.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},t.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},t.prototype.getFirstBlockInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];if(t.childWidgets.length>0){var i=t.childWidgets[0];if(0===i.childWidgets.length)return;return i.childWidgets[0]}}},t.prototype.getFirstCellInRegion=function(e,t,i,n){var r=this.getCellLeft(e,t),o=r+t.cellFormat.cellWidth,s=!0;if(r<=i&&i<o)for(var l=0;l<e.childWidgets.length;l++){var d=this.getCellLeft(e,e.childWidgets[l]);if(Pa.round(r,2)<=Pa.round(d,2)&&Pa.round(d,2)<Pa.round(o,2))return s=!1,e.childWidgets[l]}else for(var h=0;h<e.childWidgets.length;h++){var c=this.getCellLeft(e,e.childWidgets[h]);if(c<=i&&c+e.childWidgets[h].cellFormat.cellWidth>i)return s=!1,e.childWidgets[h]}if(s){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&n){var p=e.previousRenderedWidget;return this.getFirstCellInRegion(p,t,i,n)}if(!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&!n)return this.getFirstCellInRegion(e.nextRenderedWidget,t,i,n)}return e.childWidgets[0]},t.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;var t=e.firstChild;return this.documentHelper.getFirstParagraphBlock(t)},t.prototype.getLastBlockInLastCell=function(e){if(e.childWidgets.length>0){for(var t=e.childWidgets[e.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];0===i.childWidgets.length&&!(0,a.isNullOrUndefined)(i.previousSplitWidget);)i=i.previousSplitWidget;return i.childWidgets[i.childWidgets.length-1]}},t.prototype.moveToLineStart=function(){(0,a.isNullOrUndefined)(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},t.prototype.moveToLineEnd=function(){(0,a.isNullOrUndefined)(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},t.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1)},t.prototype.moveTextPosition=function(e,t,i){if(!(0,a.isNullOrUndefined)(this.start)){var n=this.documentHelper.getLineWidgetInternal(e,!0);(0,a.isNullOrUndefined)(n)||this.updateTextPositionWidget(n,e,t,!0),this.upDownSelectionLength=t.location.x;var r=this.start.getHierarchicalIndexInternal(),o=this.end.getHierarchicalIndexInternal();r===o||i||(ac.isForwardSelection(r,o)?t.validateForwardFieldSelection(r,o):t.validateBackwardFieldSelection(r,o)),this.fireSelectionChanged(!0)}},t.prototype.getDocumentStart=function(){var e=this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(e,!0)},t.prototype.getDocumentEnd=function(){for(var e=void 0,t=this.owner.documentStart,i=this.documentHelper.pages[this.documentHelper.pages.length-1];i.previousPage&&1===i.bodyWidgets.length&&0===i.bodyWidgets[0].childWidgets.length;)i=i.previousPage;if(!(0,a.isNullOrUndefined)(t)&&i.bodyWidgets[i.bodyWidgets.length-1].childWidgets.length>0){var n=void 0,r=i.bodyWidgets[i.bodyWidgets.length-1].childWidgets,o=r[r.length-1];o instanceof Ll&&(n=o),e=this.setPositionForBlock(n,!1)}return e},t.prototype.handleControlEndKey=function(){this.isHomeEnd=!0;var e=void 0;(0,a.isNullOrUndefined)(this.owner.documentEnd)||(e=this.owner.documentEnd),(0,a.isNullOrUndefined)(e)||this.owner.selectionModule.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleControlHomeKey=function(){this.isHomeEnd=!0;var e=void 0;(0,a.isNullOrUndefined)(this.owner.documentStart)||(e=this.owner.documentStart),(0,a.isNullOrUndefined)(e)||this.owner.selectionModule.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0),this.checkForCursorVisibility()},t.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0),this.checkForCursorVisibility()},t.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},t.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},t.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},t.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},t.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},t.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},t.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1),this.checkForCursorVisibility()},t.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},t.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1),this.checkForCursorVisibility()},t.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},t.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},t.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.handleEndKey=function(){this.isHomeEnd=!0,this.moveToLineEnd(),this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleHomeKey=function(){this.isHomeEnd=!0,this.moveToLineStart(),this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},t.prototype.handleShiftEndKey=function(){this.isHomeEnd=!0,this.extendToLineEnd(),this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleShiftHomeKey=function(){this.isHomeEnd=!0,this.extendToLineStart(),this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleControlShiftEndKey=function(){this.isHomeEnd=!0;var e=void 0;(0,a.isNullOrUndefined)(this.owner.documentEnd)||(e=this.owner.documentEnd),(0,a.isNullOrUndefined)(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0)),this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleControlShiftHomeKey=function(){this.isHomeEnd=!0;var e=void 0;(0,a.isNullOrUndefined)(this.owner.documentStart)||(e=this.owner.documentStart),(0,a.isNullOrUndefined)(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility(),this.isHomeEnd=!1},t.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editorModule.toggleCheckBoxFormField(this.getCurrentFormField())},t.prototype.handleTabKey=function(e,t){var i=this.start;this.isForward||(i=this.end);var n=!1,r=!1;if(!(0,a.isNullOrUndefined)(i)){if(0!==i.offset&&(this.isForward||0!==this.end.offset)||-1!=i.paragraph.paragraphFormat.listFormat.listId||(i.currentWidget.isFirstLine()&&(n=!0),r=!0),this.start.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||t))this.owner.documentHelper.isDocumentProtected||"FormFieldsOnly"===this.documentHelper.protectionType||(t?this.selectPreviousCell():this.selectNextCell());else if(!e&&!t||(0,a.isNullOrUndefined)(i)||i.offset!==this.getStartOffset(i.paragraph)||(0,a.isNullOrUndefined)(i.paragraph.paragraphFormat)||(0,a.isNullOrUndefined)(i.paragraph.paragraphFormat.listFormat)||-1===i.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode)this.owner.isReadOnlyMode||this.documentHelper.isFormFillProtectedMode||(n&&i.paragraph.paragraphFormat.firstLineIndent<this.documentHelper.defaultTabWidth?this.documentHelper.owner.editorModule.onApplyParagraphFormat("firstLineIndent",this.documentHelper.defaultTabWidth,!0,!1):r?t?this.owner.editorModule.decreaseIndent():Pa.convertPointToPixel(i.paragraph.paragraphFormat.firstLineIndent+i.paragraph.paragraphFormat.leftIndent)<this.documentHelper.viewer.clientArea.width&&this.owner.editorModule.increaseIndent():this.owner.editorModule.handleTextInput("\t"));else{var o=this.documentHelper.selection,s=i.paragraph;o.isForward||(s=o.end.paragraph),this.owner.editorModule.isFirstParaForList(o,s)?t?this.owner.editorModule.updateListLevelIndent(-this.documentHelper.defaultTabWidth,s):this.owner.editorModule.updateListLevelIndent(this.documentHelper.defaultTabWidth,s):this.owner.editorModule.updateListLevel(!t)}"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.formFields.length>0&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility()}},t.prototype.handlePageUpPageDownKey=function(e,t){var i=this,n=this.end.location.x,r=this.end.location.y,o=this.end.paragraph.bodyWidget.page,s=this.getPageTop(o),a=this.documentHelper.viewerContainer.scrollTop;r=r*this.documentHelper.zoomFactor+(s-a),n=n*this.documentHelper.zoomFactor+o.boundingRectangle.x,e?this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height:this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height;var l=!1;a===this.documentHelper.viewerContainer.scrollTop&&(l=!0),t&&(this.documentHelper.skipScrollToPosition=!0),setTimeout((function(){if(l)if(t){var o=void 0;o=e?i.getDocumentEnd():i.getDocumentStart(),i.end.setPositionForLineWidget(o.currentWidget,o.offset),i.fireSelectionChanged(!0)}else e?i.moveToDocumentEnd():i.moveToDocumentStart();else i.select({x:n,y:r,extend:t})}),0)},t.prototype.getFormFieldInFormFillMode=function(){for(var e,t=this.owner.selectionModule.start,i=this.documentHelper.formFields.length-1;i>=0;i--)if(this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistBefore(t)){e=this.documentHelper.formFields[i];break}0===i&&(e=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return e},t.prototype.selectPrevNextFormField=function(e,t){if(this.documentHelper.isFormFillProtectedMode){t||(t=this.getCurrentFormField());var i=this.documentHelper.formFields.indexOf(t);if(-1!==i)if(e)for(var n=i;;n++){if(n===this.documentHelper.formFields.length-1?n=0:n+=1,this.documentHelper.formFields[n].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[n],!0);break}n-=1}else for(n=i;;n--){if(0===n?n=this.documentHelper.formFields.length-1:n-=1,this.documentHelper.formFields[n].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[n],!0);break}n+=1}}},t.prototype.navigateToNextFormField=function(){for(var e,t=this.owner.selectionModule.end,i=0;i<this.documentHelper.formFields.length;i++)if(e=this.documentHelper.formFields[i],this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistAfter(t)){e.formFieldData instanceof Gl&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[i]):this.selectFieldInternal(this.documentHelper.formFields[i]);break}i===this.documentHelper.formFields.length-1&&((e=this.documentHelper.formFields[0]).formFieldData instanceof Gl&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},t.prototype.selectTextElementStartOfField=function(e){var t=e.fieldSeparator.nextElement;if(t){for(;!(t instanceof Zl);)t=t.nextElement;var i=e.line.getOffset(t,0),n=this.getPhysicalPositionInternal(e.line,i,!1);this.selectInternal(e.line,t,0,n)}},t.prototype.triggerFormFillEvent=function(e){var t,i,n=this.previousSelectedFormField,r=this.currentFormField;r!==n&&n&&n.formFieldData instanceof Gl&&"Text"===n.formFieldData.type&&(""===n.formFieldData.format||this.isFormatUpdated||(this.owner.editorModule.applyFormTextFormat(n),(0,a.isNullOrUndefined)(this.previousSelectedFormField)||(n=this.previousSelectedFormField)),t={fieldName:n.formFieldData.name,value:this.owner.editorModule.getFieldResultText(n)},this.owner.trigger(C,t)),r!==n&&r&&(r.formFieldData instanceof Gl&&"Text"===r.formFieldData.type&&null==e||(r.formFieldData instanceof Gl&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode||r.formFieldData instanceof Kl)&&e)&&(i={fieldName:r.formFieldData.name,value:this.owner.editorModule.getFieldResultText(r)},this.owner.trigger(x,i))},t.prototype.triggerContentControlFillEvent=function(){var e=this.currentContentControl,t=this.previousSelectedContentControl;if(!(0,a.isNullOrUndefined)(t)&&t.contentControlProperties){var i={Text:this.owner.editor.getResultContentControlText(t)};if(this.owner.trigger(H,i),!(0,a.isNullOrUndefined)(t.contentControlProperties.xmlMapping)){var n=t.contentControlProperties.xmlMapping.xPath;this.owner.xmlPaneModule.updateContent(i.Text,n)}}if(!(0,a.isNullOrUndefined)(e)&&e.contentControlProperties){i={Text:this.owner.editor.getResultContentControlText(e)};this.owner.trigger(T,i)}},t.prototype.selectPreviousCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if((0,a.isNullOrUndefined)(e.previousWidget)){if(!(0,a.isNullOrUndefined)(t.previousRenderedWidget)){var i=void 0;t.previousRenderedWidget instanceof Ul&&(i=t.previousRenderedWidget),this.selectTableCellInternal(i.childWidgets[i.childWidgets.length-1],!0)}}else{var n=void 0;e.previousWidget instanceof Vl&&(n=e.previousWidget),this.selectTableCellInternal(n,!0)}},t.prototype.selectNextCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if((0,a.isNullOrUndefined)(e.nextWidget))if((0,a.isNullOrUndefined)(t.nextRenderedWidget)&&!this.owner.isReadOnlyMode)this.owner.editorModule.insertRow(!1);else{var i=void 0;t.nextRenderedWidget instanceof Ul&&(i=t.nextRenderedWidget),this.selectTableCellInternal(i.childWidgets[0],!0)}else{var n=void 0;e.nextRenderedWidget instanceof Vl&&(n=e.nextRenderedWidget),this.selectTableCellInternal(n,!0)}},t.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),n=this.getLastParagraph(e);if(i===n&&n.isEmpty())this.selectParagraphInternal(n,!0);else{var r=n.childWidgets[0];this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(r,r.getEndOffset()),this.fireSelectionChanged(!0)}},t.prototype.selectTableInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell).ownerTable,n=this.documentHelper.getFirstParagraphBlock(i),r=this.documentHelper.getLastParagraphBlock(i),o=r.lastChild.getEndOffset();this.start.setPosition(n.childWidgets[0],!0),this.end.setPositionParagraph(r.lastChild,o+1)}this.selectPosition(this.start,this.end)},t.prototype.getTableRevision=function(){var e=this.start.clone(),t=this.end.clone();if(this.isForward||(e=this.end.clone(),t=this.start.clone()),!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell).ownerTable,n=this.documentHelper.getFirstParagraphBlock(i),r=this.documentHelper.getLastParagraphBlock(i),o=r.lastChild.getEndOffset();e.setPosition(n.childWidgets[0],!0),t.setPositionParagraph(r.lastChild,o+1)}var s=this.getAbsolutePositionFromRelativePosition(e),l=this.getAbsolutePositionFromRelativePosition(t);return Math.abs(l-s)},t.prototype.selectColumnInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell);if(i.ownerTable.contains(t.paragraph.associatedCell)){var n=this.getSelectedCell(e.paragraph.associatedCell,i),r=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){n.ownerRow;var o=i.ownerTable.getColumnCellsForSelection(i,i);if(o.length>0){var s=this.getFirstParagraph(o[0]),l=this.getLastParagraph(o[o.length-1]);this.start.setPosition(s.firstChild,!0);var d=l.lastChild;this.end.setPositionParagraph(d,d.getEndOffset()+1)}}else{var h=i.ownerTable.getColumnCellsForSelection(n,n),c=i.ownerTable.getColumnCellsForSelection(r,r);if(h.length>0&&c.length>0){s=this.getFirstParagraph(h[0]),l=this.getLastParagraph(c[c.length-1]);this.start.setPosition(s.firstChild,!0);d=l.lastChild;this.end.setPositionParagraph(d,d.getEndOffset()+1)}}}}this.selectPosition(this.start,this.end)},t.prototype.selectTableRow=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.getTable(e,t))){var i=void 0;if((i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell)).ownerTable.contains(t.paragraph.associatedCell)){var n=this.getSelectedCell(e.paragraph.associatedCell,i),r=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){var o=n.ownerRow,s=this.getFirstParagraph(o.childWidgets[0]),l=this.getLastParagraph(o.childWidgets[o.childWidgets.length-1]);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(l.lastChild,l.lastChild.getEndOffset()+1)}else{s=this.getFirstParagraph(n.ownerRow.childWidgets[0]),l=void 0;l=this.getLastParagraph(r.ownerRow.childWidgets[r.ownerRow.childWidgets.length-1]),this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(l.lastChild,l.lastChild.getEndOffset()+1)}}}this.selectPosition(this.start,this.end)},t.prototype.selectTableCell=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!(0,a.isNullOrUndefined)(this.getTable(e,t))){if(this.isEmpty){if(e.paragraph.isInsideTable&&!(0,a.isNullOrUndefined)(e.paragraph.associatedCell))(n=this.getFirstParagraph(e.paragraph.associatedCell))===(r=this.getLastParagraph(t.paragraph.associatedCell))?(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(r.lastChild,r.lastChild.getEndOffset()+1)):(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(r.lastChild,r.lastChild.getEndOffset()+1))}else{var i=this.getContainerCell(e.paragraph.associatedCell);if(this.containsCell(i,e.paragraph.associatedCell)&&this.containsCell(i,t.paragraph.associatedCell)){var n=this.getFirstParagraph(i),r=this.getLastParagraph(i);(0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(r)||(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(r.lastChild,r.lastChild.getEndOffset()+1))}}this.selectPosition(this.start,this.end)}},t.prototype.selectAll=function(){var e,t;this.documentHelper.skipScrollToPosition=!0;var i=this.getContainerWidget(this.start.paragraph);if(this.owner.enableHeaderAndFooter){var n=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(n.firstChild,!0),t=this.setPositionForBlock(n.lastChild,!1)}else if(this.isInShape){var r=this.getCurrentTextFrame();e=this.setPositionForBlock(r.firstChild,!0),t=this.setPositionForBlock(r.lastChild,!1)}else if(i instanceof Dl&&"Footnote"===i.footNoteType){var o=void 0,s=void 0,l=this.documentHelper.pages.length;for(o=0;o<=l-1;o++)if(!(0,a.isNullOrUndefined)(this.documentHelper.pages[o].footnoteWidget)){e=this.setPositionForBlock(this.documentHelper.pages[o].footnoteWidget.bodyWidgets[0].firstChild,!0);break}for(s=l-1;s>=0;s--)if(!(0,a.isNullOrUndefined)(this.documentHelper.pages[s].footnoteWidget)){var d=this.documentHelper.pages[s].footnoteWidget.bodyWidgets.length,h=this.documentHelper.pages[s].footnoteWidget.bodyWidgets[d-1].childWidgets.length;t=this.setPositionForBlock(this.documentHelper.pages[s].footnoteWidget.bodyWidgets[d-1].childWidgets[h-1],!1);break}}else if(i instanceof Dl&&"Endnote"===i.footNoteType){var c=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(c.bodyWidgets[0].firstChild,!0),t=this.setPositionForBlock(c.bodyWidgets[c.bodyWidgets.length-1].firstChild,!1)}else e=this.owner.documentStart,t=this.owner.documentEnd;(0,a.isNullOrUndefined)(e)||(this.start.setPositionInternal(e),this.end.setPositionParagraph(t.currentWidget,t.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendBackward=function(){(0,a.isNullOrUndefined)(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendForward=function(){(0,a.isNullOrUndefined)(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},t.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},t.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},t.prototype.extendToWordStartInternal=function(e){(0,a.isNullOrUndefined)(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):e&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(e?0:1,!1):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToWordEndInternal=function(e){(0,a.isNullOrUndefined)(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():e&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(e?0:1):this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToNextLine=function(){(0,a.isNullOrUndefined)(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},t.prototype.getTextPosition=function(e){var t=new ac(this.owner);return t.setPositionForCurrentIndex(e),t},t.prototype.getText=function(e){if(!((0,a.isNullOrUndefined)(this.start)||(0,a.isNullOrUndefined)(this.end)||(0,a.isNullOrUndefined)(this.start.paragraph)||(0,a.isNullOrUndefined)(this.end.paragraph))){var t=this.start,i=this.end;return t.isAtSamePosition(i)?"":this.getTextInternal(t,i,e)}},t.prototype.getTextInternal=function(e,t,i){if(e.isExistAfter(t)){var n=t;t=e,e=n}var r=e,o=t;if(!((0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(e.paragraph)||(0,a.isNullOrUndefined)(t.paragraph))){var s=0,l=0,d=e.offset,h=t.offset,c=e.currentWidget.getInline(d,s);s=c.index;var p=c.element;if(p instanceof _l&&!(0,a.isNullOrUndefined)(p.fieldEnd)){var u=this.getRenderedInline(p,s);p=u.element,s=u.index}var g=t.currentWidget.getInline(h,l),m=g.element;l=g.index;var f="";if(p instanceof gd&&i&&0===s?f=ql.objectCharacter:p instanceof Zl&&(f=(0,a.isNullOrUndefined)(p.text)||""===p.text||p.text.length<s?f:p.text.substring(s)),r.paragraph===o.paragraph)p instanceof ql&&(p===m&&p instanceof Zl?f=f.length<l-s?f:f.substring(0,l-s):p.nextNode instanceof ql&&(f+=this.getTextInline(p.nextNode,o.paragraph,m,l,i)));else if(p instanceof ql&&p.nextNode instanceof ql)f+=this.getTextInline(p.nextNode,o.paragraph,m,l,i);else{var v=this.documentHelper.selection.getNextParagraphBlock(r.paragraph);for(f+="\r";!(0,a.isNullOrUndefined)(v)&&v.isEmpty();){if(f+="\r",v===o.paragraph)return f;v=this.documentHelper.selection.getNextParagraphBlock(v)}(0,a.isNullOrUndefined)(v)||v.isEmpty()||(f+=this.getTextInline(v.childWidgets[0].children[0],o.paragraph,m,l,i))}return h===o.currentWidget.getEndOffset()+1&&(f+="\r"),f}},t.prototype.getHierarchicalIndex=function(e,t){var i;if(e){if(e instanceof Bl){var n=-1!==e.headerFooterType.indexOf("Header")?"H":"F",r=e.page.index.toString();i=e.page.sectionIndex+";"+n+";"+r+";"+t}else{if(e instanceof Ol&&!(0,a.isNullOrUndefined)(e.containerWidget)&&e.containerWidget instanceof Dl)i=e.containerWidget.bodyWidgets.indexOf(e)+";"+t;else i=e.index+";"+t}if(e instanceof cd)return i="S;"+e.containerShape.line.getOffset(e.containerShape,1)+";"+t,this.getHierarchicalIndex(e.containerShape.paragraph,i);if(e instanceof Dl){n="Footnote"===e.footNoteType?"FN":"EN",r=e.page.index.toString();i=e.page.sectionIndex+";"+n+";"+r+";"+t}if(e.containerWidget)return e instanceof Vl&&e.rowIndex!==e.containerWidget.index&&(i=e.rowIndex+";"+i,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,i)}return i},t.prototype.getHierarchicalIndexByPosition=function(e){var t=this.getParagraphInfo(e);return this.getHierarchicalIndex(t.paragraph,t.offset.toString())},t.prototype.getTextPosBasedOnLogicalIndex=function(e){var t=new ac(this.owner),i=this.getParagraph({index:e}),n=this.getLineInfoBasedOnParagraph(i.paragraph,i.offset);return t.setPositionForLineWidget(n.line,n.offset),t},t.prototype.getLineInfoBasedOnParagraph=function(e,t){var i=this.getParagraphLength(e),n=e.nextSplitWidget;for(t>i+1&&(0,a.isNullOrUndefined)(n)&&(t=i);t>i&&n instanceof Rl;)t-=i,e=n,i=this.getParagraphLength(e),n=e.nextSplitWidget;return this.getLineInfo(e,t)},t.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},t.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n=parseInt(i,10);return t=parseInt(i,10),t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):"FN"===i||"EN"===i?this.getFootNoteWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(n,t))},t.prototype.getFootNoteWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n="FN"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var r=this.documentHelper.pages[t];return t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),n?r.footnoteWidget.bodyWidgets[t]:r.endnoteWidget.bodyWidgets[t]},t.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var n="H"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var r,o=this.documentHelper.pages[t];return r=n?o.headerWidget:o.footerWidget,(0,a.isNullOrUndefined)(r)||(r.page=o),r},t.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.documentHelper.pages.length;i++)for(var n=0;n<this.documentHelper.pages[i].bodyWidgets.length;n++){var r=this.documentHelper.pages[i].bodyWidgets[n];if(r.index===e&&r.childWidgets.length>0&&r.firstChild.index<=t&&r.lastChild.index>=t)return r;if(r.index>e)break}},t.prototype.getParagraphInternal=function(e,t,i){if(!(0,a.isNullOrUndefined)(t.index)){e instanceof Ul&&(0,a.isNullOrUndefined)(i)&&(i=t.index);var n=t.index.indexOf(";"),r="0";n>=0&&(r=t.index.substring(0,n),t.index=t.index.substring(n).replace(";","")),n=parseInt(r,10),e instanceof Ul&&n>=e.childWidgets.length&&(t.index="0;0",n=e.childWidgets.length-1);var o=this.getBlockByIndex(e,n,t);if(!(0,a.isNullOrUndefined)(i)&&(0,a.isNullOrUndefined)(o)&&e instanceof Vl&&e.containerWidget&&(0,a.isNullOrUndefined)(e.getSplitWidgets().pop().nextRenderedWidget)&&(n=i.indexOf(";"),n=parseInt(i.substring(0,n),10)-1,t.index=i.substring(i.indexOf(";")).replace(";",""),n>=0&&(o=this.getBlockByIndex(e.containerWidget,n)),i=void 0),o){if("S"===(r=t.index.substring(0,1))){t.index=t.index.substring(1).replace(";","");var s=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var l=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var d=o.getInline(parseInt(s),0).element;o=d.textFrame.childWidgets[l]}var h=o;if(h instanceof Rl)return t.index.indexOf(";")>0&&(t.index="0"),h;if(h instanceof Nl)return t.index.indexOf(";")>0?this.getParagraphInternal(h,t,i):h instanceof Al?this.documentHelper.getFirstParagraphInFirstCell(h):void 0}else if(e){var c=e.getSplitWidgets().pop().nextRenderedWidget;if(c instanceof Nl)return t.index="0",c instanceof Al?this.documentHelper.getFirstParagraphInFirstCell(c):c}}},t.prototype.getBlockByIndex=function(e,t,i){var n;if(e){for(var r=0;r<e.childWidgets.length;r++)if(e.childWidgets[r].index===t){n=e.childWidgets[r];break}if(!(0,a.isNullOrUndefined)(n)&&n instanceof Ul&&n.nextSplitWidget&&this.documentHelper.layout.isVerticalMergedCellContinue(n)){var o=i.index,s=o.indexOf(";"),l=o.substring(0,s);o=o.substring(s).replace(";","");var d=this.getBlockByIndex(n,parseInt(l,10));s=o.indexOf(";");var h=o.substring(0,s);if(d&&d instanceof Vl&&d.childWidgets.length>0&&d.lastChild.index<parseInt(h,10)){var c=this.getBlockByIndex(n,parseInt(l,10)-1);if(c&&c instanceof Vl&&c.childWidgets.length>0&&c.lastChild.index<parseInt(h,10))return this.getBlockByIndex(e.nextSplitWidget,t,i)}}if(!(n||e instanceof Bl))return this.getBlockByIndex(e.nextSplitWidget,t,i)}return n},t.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},t.prototype.getCellFromSelection=function(e){var t,i=this.getSelectedCells();if(!this.hasMergedCells()){if(0==e&&i.length>0){if(!(this.selectedWidgets.keys[0]instanceof Vl))return;for(var n=(t=i[0]).rowIndex,r=t.columnIndex,o=t.ownerTable.index,s=0;s<i.length;s++){(a=i[s]).rowIndex<n&&(n=a.rowIndex),a.columnIndex<r&&(r=a.columnIndex),a.ownerTable.index<o&&(o=a.ownerTable.index)}for(s=0;s<i.length;s++){n==(a=i[s]).rowIndex&&r==a.columnIndex&&o==a.ownerTable.index&&(t=a)}}else if(1==e&&i.length>0){if(!(this.selectedWidgets.keys[this.selectedWidgets.length-1]instanceof Vl))return;for(n=(t=i[i.length-1]).rowIndex,r=t.columnIndex,o=t.ownerTable.index,s=i.length-1;s>=0;s--){(a=i[s]).rowIndex>n&&(n=a.rowIndex),a.columnIndex>r&&(r=a.columnIndex),a.ownerTable.index>o&&(o=a.ownerTable.index)}for(s=0;s<i.length;s++){var a;n==(a=i[s]).rowIndex&&r==a.columnIndex&&o==a.ownerTable.index&&(t=a)}}return t instanceof Vl?t:void 0}},t.prototype.getCellFromSelectionInTable=function(e){for(var t,i,n,r=this.getSelectedCells(),o=this.getCellBoundsInfo(),s=[],l=[],d=0;d<r.length;d++){var h=r[d];s.push(h.rowIndex),l.push(h.columnIndex)}if(s.sort(),l.sort(),1==e){i=o.row.rowLast,n=o.column.colLast;for(var c=!1;!c&&(0,a.isNullOrUndefined)(t);){for(d=0;d<r.length;d++){var p=r[d];if(p.rowIndex==i&&p.columnIndex==n){c=!0,t=p;break}}c||(i-=1)}}else if(0==e){i=o.row.rowFirst,n=o.column.colFirst;for(c=!1;!c&&(0,a.isNullOrUndefined)(t);){for(d=0;d<r.length;d++){var u=r[d];if(u.rowIndex==i&&u.columnIndex==n){c=!0,t=u;break}}c||(n+=1)}}return t},t.prototype.getActualOffset=function(e,t){var i;if(0==t){var n=this.getFirstParagraph(e);i=this.getHierarchicalIndex(n,this.getStartOffset(n).toString())}else if(1==t){var r=(n=this.getLastParagraph(e)).lastChild,o=this.getParagraphLength(n,r)+this.getLineLength(r)+1;i=this.getHierarchicalIndex(n,o.toString())}return i},t.prototype.getBookmarkProperties=function(e){var t=this.selectedWidgets.keys;if(0==e.bookmarkType){if(!(t[0]instanceof Vl))return;var i=this.getCellBoundsInfo();if(!(0,a.isNullOrUndefined)(i))return{columnFirst:i.column.colFirst.toString(),columnLast:i.column.colLast.toString()}}if(1==e.bookmarkType){if(t[t.length-1]instanceof Vl)return;var n={};this.isParagraphMarkSelected()&&this.end.paragraph.isInsideTable&&(n.isAfterParagraphMark=!0);var r=e.reference,o=this.getSelectedCells();if(r&&!(0,a.isNullOrUndefined)(r.properties)&&1==o.length&&this.isCellSelected(o[0],this.start,this.end)&&(n.isAfterCellMark=!0,delete n.isAfterParagraphMark),this.isTableSelected()&&(n.isAfterTableMark=!0),this.isRowSelected()&&(n.isAfterRowMark=!0),!(0,a.isNullOrUndefined)(n.isAfterParagraphMark)||!(0,a.isNullOrUndefined)(n.isAfterCellMark))return n}},t.prototype.isParagraphMarkSelected=function(){var e,t=this.isForward?this.end:this.start,i=t.currentWidget;i instanceof zl&&(e=i.paragraph);var n=this.getParagraphLength(e),r=this.getHierarchicalIndexByPosition(t).split(";");return parseInt(r[r.length-1])>n},t.prototype.isRowSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),(0,a.isNullOrUndefined)(e.paragraph.associatedCell)||(0,a.isNullOrUndefined)(t.paragraph.associatedCell))return!1;var i,n,r,o=t.paragraph.associatedCell.ownerRow.getSplitWidgets();if(o[0].childWidgets.length>0){if(0===(n=o[0].childWidgets[0]).childWidgets.length)return;i=n.childWidgets[0]}for(var s=o[o.length-1],l=s.childWidgets[s.childWidgets.length-1];0===l.childWidgets.length&&!(0,a.isNullOrUndefined)(l.previousSplitWidget);)l=l.previousSplitWidget;return r=l.childWidgets[l.childWidgets.length-1],n.equals(i.associatedCell)&&t.paragraph.associatedCell.equals(r.associatedCell)&&(!i.associatedCell.equals(r.associatedCell)||0===e.offset&&t.offset===this.getLineLength(r.lastChild)+1)},t.prototype.getCellBoundsInfo=function(){var e=this.getSelectedCells();if(e.length>0){for(var t=e[0].columnIndex,i=e[e.length-1].columnIndex,n=e[0].rowIndex,r=e[e.length-1].rowIndex,o=0;o<e.length;o++){var s=e[o];s.columnIndex<t&&(t=s.columnIndex),s.columnIndex>i&&(i=s.columnIndex),s.rowIndex<n&&(n=s.rowIndex),s.rowIndex>r&&(r=s.rowIndex)}return{column:{colFirst:t,colLast:i},row:{rowFirst:n,rowLast:r}}}},t.prototype.hasMergedCells=function(){for(var e=this.getSelectedCells(),t=0;t<e.length;t++){var i=e[t];if(i.cellFormat.rowSpan>1||i.cellFormat.columnSpan>1)return!0}return!1},t.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,n=this.getParagraphLength(i,e)+t,r=i.previousSplitWidget;r instanceof Rl;)i=r,n+=this.documentHelper.selection.getParagraphLength(i),r=i.previousSplitWidget;return{paragraph:i,offset:n}},t.prototype.getListTextElementBox=function(e){if(!(0,a.isNullOrUndefined)(e)){var t;if(!e.isEmpty()){var i=e.childWidgets[0];i.children.length>1&&i.children[0]instanceof md&&(t=i.children[0])}return t}},t.prototype.getListLevel=function(e){var t=void 0,i=0;if((0,a.isNullOrUndefined)(e.paragraphFormat)||(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber),!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId))&&!(0,a.isNullOrUndefined)(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,i)},t.prototype.getTextInline=function(e,t,i,n,r){var o="";do{if(e===i){if(e instanceof Zl){var s=e;(0,a.isNullOrUndefined)(s.text)||""===s.text||(s.text.length<n?o+=s.text:o+=s.text.substring(0,n))}else e instanceof gd&&r&&n===e.length&&(o+=ql.objectCharacter);return o}if(e instanceof Zl?o+=e.text:e instanceof gd&&r?o+=ql.objectCharacter:e instanceof _l&&!(0,a.isNullOrUndefined)(e.fieldEnd)&&(e=(0,a.isNullOrUndefined)(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),(0,a.isNullOrUndefined)(e.nextNode))break;e=e.nextNode}while(!(0,a.isNullOrUndefined)(e));if(t===e.line.paragraph)return o;for(var l=this.documentHelper.selection.getNextParagraphBlock(e.line.paragraph);!(0,a.isNullOrUndefined)(l)&&l.isEmpty();){if(o+="\r",l===t)return o;l=this.documentHelper.selection.getNextParagraphBlock(l)}if(!(0,a.isNullOrUndefined)(l)&&!l.isEmpty()){var d=l.childWidgets[0];(0,a.isNullOrUndefined)(l.previousSplitWidget)&&(o+="\r"),o+=this.getTextInline(d.children[0],t,i,n,r)}return o},t.prototype.getFieldCode=function(e,t){var i="";if(!((0,a.isNullOrUndefined)(e)||e.fieldEnd instanceof _l))return i;var n=e.paragraph,r=e.fieldEnd.paragraph;e.fieldSeparator instanceof _l&&(r=e.fieldSeparator.paragraph);var o=e.line.indexInOwner,s=e.indexInOwner;do{if(i+=this.getFieldCodeInternal(n,o,s),n===r)break;n=this.getNextParagraphBlock(n),o=0,s=0}while(n instanceof Rl);return t?i:i.trim()},t.prototype.getFieldCodeInternal=function(e,t,i){for(var n="",r=t;r<e.childWidgets.length;r++){for(var o=e.childWidgets[r],s=i;s<o.children.length;s++){var a=o.children[s];if(a instanceof Zl&&(n+=a.text),a instanceof _l&&(2===a.fieldType||1===a.fieldType))return n}i=0}return n},t.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(this.isEmpty||this.isForward||(e=this.end.paragraph);e instanceof Rl&&e.childWidgets.length>0;){var t=e.firstChild;if(t.children.length>0){var i=t.children[0],n=i.nextNode;if(i instanceof _l&&0===i.fieldType&&n instanceof Zl&&0===n.text.trim().toLowerCase().indexOf("toc"))return i}e=e.previousRenderedWidget}},t.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof Ol){var t=e.nextRenderedWidget.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}},t.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof Ol){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}},t.prototype.getNextStartInline=function(e,t){var i=0,n=e.getInline(t,i),r=n.element;if(i=n.index,!(0,a.isNullOrUndefined)(r)&&i===r.length&&r.nextNode instanceof _l||r instanceof hd){var o=this.documentHelper.getNextValidElement(r.nextNode);o instanceof _l&&0===o.fieldType&&(r=o)}return r},t.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof Zl?e.previousNode:e.previousNode instanceof _l&&Pa.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:(0,a.isNullOrUndefined)(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},t.prototype.getNextTextInline=function(e){return e.nextNode instanceof Zl?e.nextNode:e.nextNode instanceof _l&&Pa.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:(0,a.isNullOrUndefined)(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},t.prototype.getContainerTable=function(e){if(e.isInsideTable&&(e=e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable),e instanceof Al)return e},t.prototype.isElementInSelection=function(e,t){var i=e.line.getOffset(e,t?0:1),n=new ac(this.owner);n.setPositionParagraph(e.line,i);var r=this.start,o=this.end;return this.isForward||(r=this.end,o=this.start),(n.isExistAfter(r)||n.isAtSamePosition(r))&&(n.isExistBefore(o)||n.isAtSamePosition(o))},t.prototype.isSelectionInsideElement=function(e){if(this.isEmpty){var t=e.line.getOffset(e,0),i=new ac(this.owner);i.setPositionParagraph(e.line,t);var n=e.line.getOffset(e,e.length),r=new ac(this.owner);return r.setPositionParagraph(e.line,n),(this.start.isExistAfter(i)||this.start.isAtSamePosition(i))&&(this.start.isExistBefore(r)||this.start.isAtSamePosition(r))}return!1},t.prototype.isExistBefore=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var n=t.associatedCell;if(i===n)return i.childWidgets.indexOf(e)<i.childWidgets.indexOf(t);if(i.ownerRow===n.ownerRow)return i.cellIndex<n.cellIndex;if(i.ownerTable===n.ownerTable)return i.ownerRow.rowIndex<n.ownerRow.rowIndex;var r=this.getContainerCellOf(i,n);return r.ownerTable.contains(n)?(i=this.getSelectedCell(i,r),n=this.getSelectedCell(n,r),i===r?this.isExistBefore(e,n.ownerTable):n===r?this.isExistBefore(i.ownerTable,t):r.ownerRow===n.ownerRow?r.cellIndex<n.cellIndex:r.ownerTable===n.ownerTable?r.ownerRow.rowIndex<n.ownerRow.rowIndex:this.isExistBefore(i.ownerTable,n.ownerTable)):this.isExistBefore(r.ownerTable,this.getContainerTable(n.ownerTable))}var o=this.getContainerTable(e);return this.isExistBefore(o,t)}if(t.isInsideTable){o=this.getContainerTable(t);return this.isExistBefore(e,o)}if(e.containerWidget===t.containerWidget)return e.index<t.index;if(e.containerWidget instanceof Ol&&t.containerWidget instanceof Ol){var s=this.documentHelper.pages.indexOf(e.containerWidget.page),a=this.documentHelper.pages.indexOf(t.containerWidget.page);return s===a?e.containerWidget.indexInOwner<t.containerWidget.indexInOwner:s===a&&e.containerWidget.containerWidget instanceof Dl&&t.containerWidget.containerWidget instanceof Dl?this.documentHelper.pages[s].footnoteWidget.bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[a].footnoteWidget.bodyWidgets.indexOf(t.containerWidget):s===a&&e.containerWidget.index!==t.containerWidget.index?this.documentHelper.pages[s].bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[a].bodyWidgets.indexOf(t.containerWidget):s<a}return!1},t.prototype.isExistAfter=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var n=t.associatedCell;if(i===n)return i.childWidgets.indexOf(e)>i.childWidgets.indexOf(t);if(i.ownerRow===n.ownerRow)return i.cellIndex>n.cellIndex;if(i.ownerTable===n.ownerTable)return i.ownerRow.rowIndex>n.ownerRow.rowIndex;var r=this.getContainerCellOf(i,n);return r.ownerTable.contains(n)?(i=this.getSelectedCell(i,r),n=this.getSelectedCell(n,r),i===r?this.isExistAfter(e,n.ownerTable):n===r?this.isExistAfter(i.ownerTable,t):r.ownerRow===n.ownerRow?r.cellIndex>n.cellIndex:r.ownerTable===n.ownerTable?r.ownerRow.rowIndex>n.ownerRow.rowIndex:this.isExistAfter(i.ownerTable,n.ownerTable)):this.isExistAfter(r.ownerTable,this.getContainerTable(n.ownerTable))}var o=this.getContainerTable(e);return this.isExistAfter(o,t)}if(t.isInsideTable){o=this.getContainerTable(t);return this.isExistAfter(e,o)}return e.containerWidget===t.containerWidget?e.index>t.index:(e.containerWidget instanceof Ol&&t.containerWidget instanceof Ol||e.containerWidget instanceof Dl&&t.containerWidget instanceof Dl)&&this.documentHelper.pages.indexOf(e.containerWidget.page)>this.documentHelper.pages.indexOf(t.containerWidget.page)},t.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<=t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,n=t.line.paragraph;if(i.containerWidget===n.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<n.associatedCell.childWidgets.indexOf(n);if(!(i.containerWidget instanceof Bl))return i.containerWidget.childWidgets.indexOf(i)<n.containerWidget.childWidgets.indexOf(n)}return this.isExistBefore(i,n)},t.prototype.isExistAfterInline=function(e,t,i){if(e.line===t.line){var n=this.documentHelper.selection;return i?e.line.children.indexOf(e)>=t.line.children.indexOf(t):e===t&&n.start.offset!==n.end.offset?e.line.children.indexOf(e)===t.line.children.indexOf(t):e.line.children.indexOf(e)>t.line.children.indexOf(t)}if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var r=e.line.paragraph,o=t.line.paragraph;if(r.containerWidget===o.containerWidget){if(r.isInsideTable)return r.associatedCell.childWidgets.indexOf(r)>o.associatedCell.childWidgets.indexOf(o);if(!(r.containerWidget instanceof Bl))return r.containerWidget.childWidgets.indexOf(r)>o.containerWidget.childWidgets.indexOf(o)}return this.isExistAfter(r,o)},t.prototype.getNextRenderedBlock=function(e){return(0,a.isNullOrUndefined)(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},t.prototype.getPreviousRenderedBlock=function(e){return(0,a.isNullOrUndefined)(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},t.prototype.getNextParagraphBlock=function(e){if(e.nextRenderedWidget instanceof Rl)return e.nextRenderedWidget;if(e.nextRenderedWidget instanceof Al)return this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget);if(e.containerWidget instanceof Vl)return this.getNextParagraphCell(e.containerWidget);if(e.containerWidget instanceof Ol){e.containerWidget;return this.getNextParagraph(e.containerWidget)}return e.containerWidget instanceof Bl&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},t.prototype.getFirstBlockInNextHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Header"))t=i.page.footerWidget.firstChild;else{if(!i.page.nextPage)return;var n=i.page.nextPage,r=n.headerWidget;r.page=n,n.footerWidget&&(n.footerWidget.page=n),t=r.firstChild}return t instanceof Rl?t:this.getFirstBlockInFirstCell(t)},t.prototype.getLastBlockInPreviousHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Footer"))t=i.page.headerWidget.lastChild;else{if(!i.page.previousPage)return;var n=i.page.previousPage,r=n.footerWidget;r.page=n,n.headerWidget&&(n.headerWidget.page=n),t=r.lastChild}return t instanceof Rl?t:this.getFirstBlockInFirstCell(t)},t.prototype.getPreviousParagraphBlock=function(e,t){return e.previousRenderedWidget instanceof Rl?e.previousRenderedWidget:e.previousRenderedWidget instanceof Al?this.documentHelper.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof Vl?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof Ol?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof Bl&&this.isMoveDownOrMoveUp&&!t?this.getLastBlockInPreviousHeaderFooter(e):void 0},t.prototype.hasValidInline=function(e,t,i){for(var n=e.childWidgets.indexOf(t.line);n<e.childWidgets.length;n++)for(var r=0;r<e.childWidgets[n].children.length;r++){var o=e.childWidgets[n].children[r];if(0!==o.length){if(o===i)return!1;if(o instanceof Zl||o instanceof gd||o instanceof _l&&Pa.isLinkedFieldCharacter(o))return!0}}return!1},t.prototype.getParagraphLength=function(e,t,i,n){var r=0;if(!(0,a.isNullOrUndefined)(e))for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(t instanceof zl&&t===s){i&&(r+=this.getLineLength(s,i,n));break}r+=this.getLineLength(s,void 0,n)}return r},t.prototype.getLineLength=function(e,t,i){for(var n=0,r=e.paragraph.bidi,o=r?e.children.length-1:0;r?o>-1:o<e.children.length;r?o--:o++){var s=e.children[o];if(!(s instanceof md)){if(i)if(s instanceof hd)for(var a=0;a<s.textFrame.childWidgets.length;a++){var l=s.textFrame.childWidgets[a];n+=this.getParagraphLength(l)+1}else if(s instanceof Yl)for(a=0;a<s.bodyWidget.childWidgets.length;a++){l=s.bodyWidget.childWidgets[a];n+=this.getParagraphLength(l)+1}if(t&&t.element instanceof ql&&t.element===s){n+=t.index;break}n+=s.length}}return n},t.prototype.getLineInfo=function(e,t){for(var i=void 0,n=0,r=e.childWidgets.length,o=0;o<r&&(i=e.childWidgets[o],!(t<=(n=this.getLineLength(i))||o===r-1));o++)t-=n;return{line:i,offset:t}},t.prototype.getElementInfo=function(e,t){for(var i=void 0,n=0;n<e.children.length;n++)if(!((i=e.children[n])instanceof md)){if(!(t>i.length)||t===i.length+1&&(0,a.isNullOrUndefined)(i.nextNode))break;t-=i.length}return{element:i,index:t}},t.prototype.getStartOffset=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];return this.getStartLineOffset(t)}return 0},t.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var n=e.children[i];if(0!==n.length){if(n instanceof Zl||n instanceof gd||n instanceof td||n instanceof hd||n instanceof vd||n instanceof fd||n instanceof Bd||n instanceof _l&&Pa.isLinkedFieldCharacter(n)||n instanceof id)return t;n instanceof md||(t+=n.length)}}return t},t.prototype.getPreviousSelectionCell=function(e){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)){if(this.isForward){var t=e.previousRenderedWidget.childWidgets;return(i=t[t.length-1])instanceof Rl?i:this.getPreviousParagraphSelection(i.childWidgets[i.childWidgets.length-1])}var i;return(i=e.previousRenderedWidget.childWidgets[0])instanceof Rl?i:this.documentHelper.getFirstParagraphInLastRow(i)}return this.getPreviousSelectionRow(e.ownerRow)},t.prototype.getPreviousSelectionRow=function(e){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)){if(this.isForward)return this.getPreviousParagraphSelection(e.previousRenderedWidget);var t=e.previousRenderedWidget.childWidgets[0].childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}return this.getPreviousSelectionBlock(e.ownerTable)},t.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof Rl?e.nextRenderedWidget:e.nextRenderedWidget instanceof Al?this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof Vl?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof Ol?this.getNextSelection(e.containerWidget):void 0},t.prototype.getNextSelectionCell=function(e){if(!(0,a.isNullOrUndefined)(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(t)}return(t=e.nextRenderedWidget.childWidgets[0])instanceof Rl?t:this.getNextParagraphSelection(t.childWidgets[0])}return this.getNextSelectionRow(e.ownerRow)},t.prototype.getNextSelectionRow=function(e){if(!(0,a.isNullOrUndefined)(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}return this.getNextParagraphSelection(e.nextRenderedWidget)}return this.getNextSelectionBlock(e.ownerTable)},t.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof Ol){var t=e.nextRenderedWidget.childWidgets[0];return t instanceof Rl?t:this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},t.prototype.getNextParagraphSelection=function(e){var t=e.childWidgets[0];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getFirstCellInRegion(e,i,this.upDownSelectionLength,!1)}var n=t.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(n)},t.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof Rl?e.previousRenderedWidget:e.previousRenderedWidget instanceof Al?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.documentHelper.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof Vl?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof Ol?this.getPreviousSelection(e.containerWidget):void 0},t.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof Ol){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];if(i instanceof Rl)return i;if(this.isForward){var n=i;return this.getPreviousParagraphSelection(n.childWidgets[n.childWidgets.length-1])}return this.documentHelper.getFirstParagraphInLastRow(i)}},t.prototype.getPreviousParagraphSelection=function(e){var t=e.childWidgets[e.childWidgets.length-1];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getLastCellInRegion(e,i,this.upDownSelectionLength,!0)}var n=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(n)},t.prototype.getLastCellInRegion=function(e,t,i,n){var r=this.getCellLeft(e,t),o=r+t.cellFormat.cellWidth,s=!0;if(r<=i&&i<o)for(var l=e.childWidgets.length-1;l>=0;l--){var d=this.getCellLeft(e,e.childWidgets[l]);if(Pa.round(r,2)<=Pa.round(d,2)&&Pa.round(d,2)<Pa.round(o,2))return s=!1,e.childWidgets[l]}else for(l=e.childWidgets.length-1;l>=0;l--){if((d=this.getCellLeft(e,e.childWidgets[l]))<=i&&d+e.childWidgets[l].width>i)return s=!1,e.childWidgets[l]}if(s){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&n)return this.getLastCellInRegion(e.previousRenderedWidget,t,i,n);if(!(0,a.isNullOrUndefined)(e.nextRenderedWidget)&&!n)return this.getLastCellInRegion(e.nextRenderedWidget,t,i,n)}return e.childWidgets[e.childWidgets.length-1]},t.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},t.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,n=0,r=(e.paragraphFormat.bidi,0);r<e.childWidgets.length;r++)for(var o=e.childWidgets[r],s=0;s<o.children.length;s++){var a=o.children[s];if(!(0===a.length||a instanceof md)){if(t<=n+a.length)return t-1===n?i:t-1;(a instanceof Zl||a instanceof id||a instanceof gd||a instanceof Bd||a instanceof td||a instanceof _l&&Pa.isLinkedFieldCharacter(a))&&(i=n+a.length),n+=a.length}}return t-1===n?i:t-1},t.prototype.getNextValidOffset=function(e,t){for(var i=0,n=0;n<e.children.length;n++){var r=e.children[n];if(!(0===r.length||r instanceof md)){if(t<i+r.length&&(r instanceof Zl||r instanceof id||r instanceof gd||r instanceof _l&&Pa.isLinkedFieldCharacter(r)))return(t>i?t:i)+1;if(t===i+r.length&&r instanceof _l&&1===r.fieldType&&r.previousNode instanceof gd)return t;i+=r.length}}return t},t.prototype.getParagraphMarkSize=function(e,t,i){var n=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),r=n.BaselineOffset,o=n.Height,s=r;if(e instanceof Rl){if(e.childWidgets.length>0)e.childWidgets[0];var a=this.documentHelper.layout.getLineSpacing(e,o),l=this.documentHelper.layout.getBeforeSpacing(e);t=s-r,i=o-s-(n.Height-r);var d=e.paragraphFormat.lineSpacingType;"Multiple"===d?a>o?i+=a-o:t+=a-o:("Exactly"===d||a>t+n.Height+i)&&(t+=a-(t+n.Height+i)),t+=l,i+=this.documentHelper.layout.getAfterSpacing(e)}return{width:n.Width,height:n.Height,topMargin:t,bottomMargin:i}},t.prototype.getPhysicalPositionInternal=function(e,t,i){if(e.paragraph.isEmpty()){var n=e.paragraph,r=n.x;if(n.childWidgets.length>0){var o=n.childWidgets[0];r=this.getLeft(o)}var s=this.getParagraphMarkSize(e.paragraph,0,0);return(t>0||0===t&&n.isEmpty()&&n.bidi)&&(r+=s.width),new Sa(r,n.y+s.topMargin)}var a=0,l=e.getInline(t,a,e.paragraph.bidi),d=l.element;return a=l.index,this.getPhysicalPositionInline(d,a,i)},t.prototype.highlightSelectedContent=function(e,t){if(e.paragraph.isInsideTable&&(!t.paragraph.isInsideTable||!e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||!this.documentHelper.isSelectionChangedOnMouseMoved&&this.isCellSelected(e.paragraph.associatedCell,e,t)||this.isCellPrevSelected))this.highlightCell(e.paragraph.associatedCell,this,e,t),this.isCellPrevSelected=!0;else{var i=void 0,n=0;if(!this.owner.isReadOnlyMode&&e.paragraph===t.paragraph)if(e.offset+1===t.offset){var r=t.currentWidget.getInline(t.offset,n);if(i=r.element,n=r.index,i instanceof gd||i instanceof hd)e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}else{var o=0,s=e.currentWidget.getInline(e.offset,o),l=s.element;(o=s.index)===l.length&&(l=this.getNextRenderedElementBox(l,o));var d=t.currentWidget.getInline(t.offset,o),h=d.element;if(o=d.index,l instanceof _l&&h instanceof _l&&!(0,a.isNullOrUndefined)(l.fieldSeparator)){var c=l.fieldSeparator.nextNode;c instanceof gd&&c.nextNode===h&&(i=c)}}if(!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(i instanceof gd||i instanceof hd)){var p=this.getElementBoxInternal(i,n),u=p.element;n=p.index,this.owner.enableImageResizerMode&&!this.owner.editorModule.isRemoteAction&&(this.owner.imageResizerModule.positionImageResizer(u),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")}else e.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&t.paragraph.equals(this.getLastParagraph(t.paragraph.associatedCell))&&this.getParagraphLength(t.paragraph)+1==t.offset&&t.offset--,this.highlight(e.paragraph,e,t),this.isHighlightNext&&(this.hightLightNextParagraph===e.paragraph&&this.highlightNextBlock(this.hightLightNextParagraph,e,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);this.isInShape&&this.showResizerForShape()}},t.prototype.showResizerForShape=function(){var e=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(e),this.owner.imageResizerModule.showImageResizer()},t.prototype.highlight=function(e,t,i,n){var r=0,o=0,s=void 0,l=void 0,d=void 0,h=void 0,c=this.getStartLineWidget(e,t,s,r);s=c.element,d=(0,a.isNullOrUndefined)(s)?e.childWidgets[0]:s.line,r=c.index;var p=this.getEndLineWidget(i,l,o);h=(l=p.element)?l.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],o=p.index;var u=0,g=0;if((0,a.isNullOrUndefined)(d)||(u=this.getTop(d),g=this.getLeftInternal(d,s,r)),(0,a.isNullOrUndefined)(d)||d!==h){if(!(0,a.isNullOrUndefined)(d)){d.paragraph.x;e!==d.paragraph&&(e=d.paragraph);y=this.getWidth(d,!0)-(g-d.paragraph.x);if(e.bidi||s instanceof Zl&&s.isRightToLeft){v=0;var m=this.getElementsForward(d,s,l,e.bidi);if(m){for(I=!1,C=0;C<m.length;C++){I=!1,g=(x=m[C])===s?this.getLeftInternal(d,x,r):this.getLeftInternal(d,x,0);k=x instanceof Zl?x.length:1;v=this.getLeftInternal(d,x,k),x instanceof Zl&&(I=x.isRightToLeft),y=Math.abs(v-g),this.createHighlightBorder(d,y,I?v:g,u,!0,n)}if(d.isLastLine()){F=m[m.length-1].line.paragraph.characterFormat,P=this.documentHelper.textHelper.getParagraphMarkSize(F).Width;g=e.bidi?this.getLineStartLeft(d)-P:I?d.paragraph.x+this.getWidth(d,!1):v,this.createHighlightBorder(d,P,g,u,!0,n)}}else this.createHighlightBorder(d,y,g,u,!1,n)}else this.createHighlightBorder(d,y,g,u,!1,n);var f=d.paragraph.childWidgets.indexOf(d);if(this.highlightParagraph(e,f+1,h,l,o,n),-1!==e.childWidgets.indexOf(i.currentWidget))return}if(this.isHideSelection(e))return void(this.isHighlightNext=!1);this.isHighlightNext=!0,this.hightLightNextParagraph=e}else{var v=this.getLeftInternal(h,l,o),y=0,w=!1;if(l instanceof Zl&&(w=l.isRightToLeft),!w&&s instanceof Zl&&(w=s.isRightToLeft),y=Math.abs(v-g),w||e.bidi){var b=this.getElementsForward(d,s,l,e.bidi);if(b&&b.length>1)for(var C=0;C<b.length;C++){var x,I=!1,k=(x=b[C])instanceof Zl?x.length:1;if(x===s?(g=this.getLeftInternal(d,x,r),v=this.getLeftInternal(d,x,k)):x===l?(g=this.getLeftInternal(d,x,0),v=this.getLeftInternal(d,x,o)):(g=this.getLeftInternal(d,x,0),v=this.getLeftInternal(d,x,k)),x instanceof Zl&&(I=x.isRightToLeft),y=Math.abs(v-g),x===l&&x instanceof Zl&&o>x.length){var F=x.line.paragraph.characterFormat,P=this.documentHelper.textHelper.getParagraphMarkSize(F).Width;if(e.bidi&&!I){y-=P,this.createHighlightBorder(d,y,g,u,!0,n),g=this.getLineStartLeft(d)-P,this.createHighlightBorder(d,P,g,u,!0,n);continue}}this.createHighlightBorder(d,y,I?v:g,u,!0,n)}else if(l instanceof Zl&&o>l.length){var F=l.line.paragraph.characterFormat,P=this.documentHelper.textHelper.getParagraphMarkSize(F).Width;!e.bidi&&w?(v+=P,y-=P,this.createHighlightBorder(d,y,v,u,!0,n),v+=l.width,this.createHighlightBorder(d,P,v,u,!0,n)):e.bidi&&!w?(y-=P,this.createHighlightBorder(d,y,g,u,!0,n),g=this.getLineStartLeft(d)-P,this.createHighlightBorder(d,P,g,u,!0,n)):this.createHighlightBorder(d,y,w?v:g,u,!1,n)}else this.createHighlightBorder(d,y,w?v:g,u,!1,n)}else this.createHighlightBorder(d,y,e.bidi?v:g,u,!1,n)}},t.prototype.highlightNextBlock=function(e,t,i){var n=e.nextRenderedWidget;(0,a.isNullOrUndefined)(n)||(n instanceof Rl?(this.isHighlightNext=!1,this.highlight(n,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(n,t,i))},t.prototype.getStartLineWidget=function(e,t,i,n){var r=e===t.paragraph?t.offset:this.getStartOffset(e),o=void 0;if(i=(o=e===t.paragraph?t.currentWidget.getInline(r,n):e.firstChild.getInline(r,n)).element,n=o.index,i instanceof _l){var s=this.getRenderedInline(i,n);i=s.element,n=s.index}return r===this.getParagraphLength(t.paragraph)+1&&n++,{index:n,element:i}},t.prototype.getEndLineWidget=function(e,t,i){var n=e.currentWidget.getInline(e.offset,i);if(t=n.element,i=n.index,t instanceof _l){var r=this.getRenderedInline(t,i);t=r.element,i=r.index}return e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},t.prototype.getLineWidgetInternal=function(e,t,i){var n=void 0;if(0===e.children.length&&e instanceof zl)n=e;else{var r=0,o=e.getInline(t,r),s=o.element;r=o.index,n=s instanceof ql?s.line:this.getLineWidgetInternalInline(s,r,i)}return n},t.prototype.getLineWidgetParagraph=function(e,t){var i=void 0;if(0===t.children.length)i=t;else{var n=0,r=t.getInline(e,n),o=r.element;n=r.index,i=this.getLineWidget(o,n)}return i},t.prototype.highlightCells=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;n>o&&(n=o),r<s&&(r=s),n>this.upDownSelectionLength&&(n=this.upDownSelectionLength),r<this.upDownSelectionLength&&(r=this.upDownSelectionLength);var a=e.getSplitWidgets(),l=a.indexOf(t.ownerRow.ownerTable),d=a.indexOf(i.ownerRow.ownerTable);if(l===d)for(var h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)this.highlightRow(e.childWidgets[c],n,r);else{var p=0,u=0;for(c=l;c<=d;c++){e=a[c],p=c===l?e.childWidgets.indexOf(t.ownerRow):0,u=c===d?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1;for(var g=p;g<=u;g++)this.highlightRow(e.childWidgets[g],n,r)}}},t.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)||this.highlightNextBlock(e,t,i)},t.prototype.getCellLeft=function(e,t){var i=0;return i+=t.x-t.margin.left},t.prototype.getNextParagraphRow=function(e){if(!(0,a.isNullOrUndefined)(e.nextRenderedWidget)){var t=e.nextRenderedWidget.childWidgets[0],i=t.childWidgets[0];return(0,a.isNullOrUndefined)(i)?this.getNextParagraphCell(t):this.documentHelper.getFirstParagraphBlock(i)}return this.getNextParagraphBlock(e.ownerTable)},t.prototype.getPreviousParagraphRow=function(e){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)){var t=e.previousRenderedWidget.lastChild,i=t.lastChild?t.lastChild:t.previousSplitWidget.lastChild;return this.documentHelper.getLastParagraphBlock(i)}return this.getPreviousParagraphBlock(e.ownerTable)},t.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},t.prototype.highlightRow=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){var r=this.getCellLeft(e,e.childWidgets[n]);Pa.round(t,2)<=Pa.round(r,2)&&Pa.round(r,2)<Pa.round(i,2)&&this.highlightCellWidget(e.childWidgets[n])}},t.prototype.highlightInternal=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.highlightCellWidget(e.childWidgets[n]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof Ul&&this.highlightInternal(e.nextRenderedWidget,t,i)},t.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&e.nextSplitWidget.childWidgets.length>0;)e=e.nextSplitWidget;var t;return t=e.childWidgets.length>0?e.lastChild:e.previousSplitWidget.lastChild,this.documentHelper.getLastParagraphBlock(t)},t.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},t.prototype.isCellSelected=function(e,t,i){var n=this.getLastParagraph(e);return n===i.paragraph&&i.offset===this.getParagraphLength(n)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},t.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},t.prototype.getSelectedCell=function(e,t){if(e.ownerTable.equals(t.ownerTable))return e;for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},t.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof Vl&&e.push(i)}return e},t.prototype.getLevelFormatNumber=function(){var e="%";return e=e+((this.paragraphFormat.listLevelNumber<=0?0:this.paragraphFormat.listLevelNumber)+1)+"."},t.prototype.getNextParagraphCell=function(e){if(e.nextRenderedWidget&&e.nextRenderedWidget instanceof Vl){if(e.ownerRow.index===e.nextRenderedWidget.rowIndex){(e=e.nextRenderedWidget).getSplitWidgets()[0]instanceof Vl&&(e=e.getSplitWidgets()[0]);var t=e.firstChild;return t?this.documentHelper.getFirstParagraphBlock(t):this.getNextParagraphCell(e)}return e=e.nextRenderedWidget,this.getNextParagraphCell(e)}return e.nextSplitWidget&&0===e.nextSplitWidget.childWidgets.length&&(e=e.getSplitWidgets().pop()),this.getNextParagraphRow(e.containerWidget)},t.prototype.getPreviousParagraphCell=function(e){if(!(0,a.isNullOrUndefined)(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof Vl){var t=(e=e.previousRenderedWidget).lastChild;return this.documentHelper.getLastParagraphBlock(t)}return this.getPreviousParagraphRow(e.ownerRow)},t.prototype.getContainerCell=function(e){for(;!(0,a.isNullOrUndefined)(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},t.prototype.highlightCell=function(e,t,i,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),s=this.getSelectedCell(n.paragraph.associatedCell,r);if(this.containsCell(r,n.paragraph.associatedCell))this.isCellSelected(r,i,n)?this.highlightCellWidget(r):o===r?(this.highlight(i.paragraph,i,n),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,i,n),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(o,i,n);else if(this.highlightCellWidget(r),r.ownerRow.equals(s.ownerRow))for(o=r;!(0,a.isNullOrUndefined)(o.nextRenderedWidget)&&(o=o.nextRenderedWidget,this.highlightCellWidget(o),o!==s););else this.highlightCells(r.ownerTable,r,s)}else this.highlightContainer(r,i,n)}else{var l=this.getContainerCell(e);this.highlightContainer(l,i,n)}},t.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable.getSplitWidgets().pop(),t,i)},t.prototype.getPreviousValidElement=function(e){var t=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return e;for(;e instanceof _l;)Pa.isLinkedFieldCharacter(e)&&(e instanceof _l&&0===e.fieldType?t=e:e instanceof _l&&1===e.fieldType?(t=e,(0,a.isNullOrUndefined)(e.fieldSeparator)&&(t=e=e.fieldBegin)):t=e=e.fieldBegin),e=e.previousNode;return(0,a.isNullOrUndefined)(t)?e:t},t.prototype.validateTextPosition=function(e,t){var i=e.nextNode;if(e.length===t&&(i instanceof _l||!(e instanceof gd)&&(i instanceof td||i instanceof Bd))){var n=this.documentHelper.getNextValidElement(e.nextNode);(n instanceof _l&&1===n.fieldType||n instanceof td&&1===n.bookmarkType||n instanceof Bd&&1===n.commentType)&&(e=n,t=this.documentHelper.isFormFillProtectedMode?0:1)}else if(0===t&&e.previousNode instanceof _l){t=(e=this.getPreviousValidElement(e.previousNode))instanceof _l?0:e.length,e instanceof _l&&1===e.fieldType&&t++}return{element:e,index:t}},t.prototype.getPhysicalPositionInline=function(e,t,i){var n=void 0;n=this.getElementBox(e,t,i).element;var r=void 0;if((0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(n.line)){if(!(e instanceof _l&&1===e.fieldType))return e instanceof _l||e instanceof td||e instanceof Bd||e instanceof id?this.getFieldCharacterPosition(e):new Sa(0,0);n=e}var o,s=n.margin,l=0;if(n instanceof Zl&&"\v"===n.text&&(0,a.isNullOrUndefined)(e.nextNode)&&!this.owner.editorModule.handledEnter?(r=this.getNextLineWidget(n.line.paragraph,n),t=0):r=n.line,l=this.getTop(r),n instanceof gd&&"Inline"===n.textWrappingStyle){var d=n.line.paragraph.characterFormat,h=this.getPreviousTextElement(e);if((0,a.isNullOrUndefined)(h)){var c=this.getNextTextElement(e);(0,a.isNullOrUndefined)(c)||(d=c.characterFormat)}else d=h.characterFormat;var p=this.documentHelper.textHelper.getHeight(d);n.margin.top+n.height-p.BaselineOffset>0&&(l+=n.margin.top+n.height-p.BaselineOffset)}else n instanceof _l||(l+=s.top>0?s.top:0);return o=(0,a.isNullOrUndefined)(n)||(0,a.isNullOrUndefined)(r)?0:this.getLeftInternal(r,n,t),new Sa(o,l)},t.prototype.getFieldCharacterPosition=function(e){var t=this.documentHelper.getNextValidElementForField(e);if((0,a.isNullOrUndefined)(t)){var i=e.line.paragraph;return this.getEndPosition(i)}return this.getPhysicalPositionInline(t,0,!0)},t.prototype.isRenderBookmarkAtEnd=function(e){var t;if((t=1==e.bookmarkType?e.reference:e)&&(0,a.isNullOrUndefined)(t.properties)){var i=t.reference?t.reference.paragraph.associatedCell:void 0;if((0,a.isNullOrUndefined)(i))return!1;var n=t.reference?t.reference.paragraph.associatedCell.ownerRow:void 0,r=n?n.childWidgets[n.childWidgets.length-1]:void 0;return!(0,a.isNullOrUndefined)(r)&&!(i!=r||1===e.bookmarkType&&!(0,a.isNullOrUndefined)(e.line)&&e.line.children.indexOf(e)!==e.line.children.length-1)}return!1},t.prototype.getEndPosition=function(e){var t=e.x,i=e.y,n=void 0;e.childWidgets.length>0&&(n=e.childWidgets[e.childWidgets.length-1],e.paragraphFormat.bidi?t=this.getLeft(n):t+=this.getWidth(n,!1)),(0,a.isNullOrUndefined)(n)||(i=this.getTop(n));var r=this.getParagraphMarkSize(e,0,0);return new Sa(t,i+r.topMargin)},t.prototype.getElementBox=function(e,t,i){var n=void 0;return e instanceof _l||e instanceof td||e instanceof Bd||e instanceof id||(n=e),{element:n,index:t}},t.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof Zl?e.previousNode:(0,a.isNullOrUndefined)(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},t.prototype.getNextTextElement=function(e){return e.nextNode instanceof Zl?e.nextNode:(0,a.isNullOrUndefined)(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},t.prototype.getNextRenderedElementBox=function(e,t){if(e instanceof _l){if(0===(n=e).fieldType&&n===(e=this.getRenderedField(n)))return n;t=1}for(;!(0,a.isNullOrUndefined)(e)&&t===e.length&&e.nextNode instanceof _l;){var i=this.documentHelper.getNextValidElement(e.nextNode);if(i instanceof _l&&0===i.fieldType){var n=i;if(e=this.getRenderedField(n),!(0,a.isNullOrUndefined)(e)&&n===e)return n;t=1}else e=i}return e},t.prototype.getElementBoxInternal=function(e,t){return{element:e,index:t}},t.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},t.prototype.getLineWidgetInternalInline=function(e,t,i){var n=this.getElementBox(e,t,i),r=n.element;if(t=n.index,!(0,a.isNullOrUndefined)(r))return i&&r instanceof Zl&&"\v"===r.text&&1===t?this.getNextLineWidget(r.line.paragraph,r):r.line;var o=e,s=this.documentHelper.getNextValidElementForField(o);if((0,a.isNullOrUndefined)(s)){var l=void 0,d=o.line.paragraph;return d.childWidgets.length>0&&(l=d.childWidgets[d.childWidgets.length-1]),l}return this.getLineWidget(s,0)},t.prototype.getNextLineWidget=function(e,t){var i=void 0,n=e;if(n.childWidgets.length>0){var r=n.childWidgets.indexOf(t.line);r===n.childWidgets.length-1?(n=e,r=-1):r>n.childWidgets.length-1?(n=this.getNextParagraphBlock(e),r=-1):r<0&&(r=(n=e).childWidgets.indexOf(t.line)),i=n.childWidgets[r+1]}return i},t.prototype.getCaretHeight=function(e,t,i,n,r,o){var s=this.getElementBox(e,t,!1).element,l=e;if((0,a.isNullOrUndefined)(s))return l instanceof _l?this.getFieldCharacterHeight(l,i,n,r,o):{height:this.documentHelper.textHelper.getHeight(i).Height,topMargin:r,isItalic:o};var d=s.margin,h=s.height,c=0;if(s instanceof gd){var p=this.getPreviousTextElement(e),u=this.getNextTextElement(e);if((0,a.isNullOrUndefined)(p)&&(0,a.isNullOrUndefined)(u)){var g=0,m=0,f=e.line.paragraph,v=this.getParagraphMarkSize(f,g,m);g=v.topMargin,m=v.bottomMargin,c=v.height,o=f.characterFormat.italic,n||(c+=this.documentHelper.layout.getAfterSpacing(f))}else{if((0,a.isNullOrUndefined)(p))return o=u.characterFormat.italic,this.getCaretHeight(u,0,u.characterFormat,n,r,o);if((0,a.isNullOrUndefined)(u)||!(s instanceof gd))return o=p.characterFormat.italic,this.getCaretHeight(p,p.length,p.characterFormat,n,r,o);var y=this.documentHelper.textHelper.getHeight(s.characterFormat),w=y.Height,b=y.BaselineOffset;c=s.margin.top<0&&b>s.margin.top+s.height?s.margin.top+s.height+w-b:w,n||(c+=s.margin.bottom)}}else{var C=this.characterFormat.baselineAlignment,x=h;"Normal"!==C&&n&&(x/=1.5,"Subscript"===C&&(r=h-x)),c=(d.top<0?d.top:0)+x,n||(c+=d.bottom)}if(!n)return{height:c,topMargin:r,isItalic:o};var I=this.documentHelper.textHelper.getHeight(i).Height;return I>c&&(I=c),{height:I,topMargin:r,isItalic:o}},t.prototype.getFieldCharacterHeight=function(e,t,i,n,r){var o=this.documentHelper.getNextValidElementForField(e);if((0,a.isNullOrUndefined)(o)){var s=e.line.paragraph,l=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,d=0,h=0,c=this.getParagraphMarkSize(s,d,h),p=c.height;return d=c.topMargin,h=c.bottomMargin,i?(l>p&&(l=p),{height:l,topMargin:n,isItalic:r}):{height:p+=h,topMargin:n,isItalic:r}}return this.getCaretHeight(o,0,t,i,n,r)},t.prototype.getRenderedInline=function(e,t){if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return{element:e,index:t};for(var i=this.getPreviousValidElement(e);i instanceof _l;)(i=this.getPreviousTextElement(i))instanceof _l&&(i=i.previousNode);if(!(0,a.isNullOrUndefined)(i))return{element:i,index:t=i.length};t=0;var n=this.getNextRenderedElementBox(e,0);if(n instanceof _l&&0===n.fieldType)for(n=(n=n.fieldSeparator).nextNode;n instanceof _l;)n instanceof _l&&0===n.fieldType&&Pa.isLinkedFieldCharacter(n)&&(n=(0,a.isNullOrUndefined)(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator),n=n.nextNode;return{element:n,index:t}},t.prototype.getRenderedField=function(e){var t=e;if((0,a.isNullOrUndefined)(e.fieldSeparator))t=e.fieldEnd;else{var i=(t=e.fieldSeparator).line.paragraph;if(i!==e.fieldEnd.line.paragraph||this.hasValidInline(i,t,e.fieldEnd))return t;t=e.fieldEnd}return t},t.prototype.isLastRenderedInline=function(e,t){for(;t===e.length&&e.nextNode instanceof _l;){var i=this.documentHelper.getNextValidElement(e.nextNode);if(t=0,i instanceof _l&&0===i.fieldType&&(e=i),e instanceof _l&&0===e.fieldType&&!(0,a.isNullOrUndefined)(e.fieldEnd)){var n=e;if((0,a.isNullOrUndefined)(n.fieldSeparator))e=n.fieldEnd,t=1;else{var r=(e=n.fieldSeparator).line.paragraph;if(t=1,r!==n.fieldEnd.line.paragraph||this.hasValidInline(r,e,n.fieldEnd))break;e=n.fieldEnd}}}return t===e.length&&(0,a.isNullOrUndefined)(e.nextNode)},t.prototype.getPage=function(e){var t=void 0;if(e.containerWidget instanceof cd){var i=e.containerWidget.containerShape;i.line&&(t=this.getPage(i.line.paragraph))}else if(e.containerWidget instanceof Wl){e.containerWidget;t=e.containerWidget.page}else(0,a.isNullOrUndefined)(e.containerWidget)||(t=this.getPage(e.containerWidget));return t},t.prototype.clearSelectionHighlightInSelectedWidgets=function(){var e=!1,t=this.selectedWidgets.keys;if(!this.viewer.documentHelper.isDragStarted){for(var i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;this.selectedWidgets.clear()}return e},t.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof zl?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof Vl?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof Nl&&this.clearChildSelectionHighlight(e.childWidgets[t])},t.prototype.getLineWidgetBodyWidget=function(e,t,i){i=!!(0,a.isNullOrUndefined)(i)||i;var n=e;if(n instanceof Wl)for(var r=0;r<n.floatingElements.length;r++){var o=n.floatingElements[r];if(o instanceof Al){var s=o.getTableCellWidth();if(t.x<=o.x+s&&t.x>=o.x&&t.y<=o.y+o.height&&t.y>=o.y)return this.getLineWidgetTableWidget(o,t)}else if(o instanceof dd&&"Behind"!==o.textWrappingStyle&&o.x<=t.x&&o.x+o.width>=t.x&&o.y<=t.y&&o.y+o.height>=t.y)return o.line}if(e instanceof Dl)for(var l=void 0,d=!1,h=0;h<e.bodyWidgets.length;h++)if(e.sectionFormat.columns.length<=1)for(var c=0;c<e.bodyWidgets[h].childWidgets.length;c++){if((u=e.bodyWidgets[h].childWidgets[c])instanceof Nl&&u.y<=t.y&&u.y+u.height>=t.y)return u instanceof Rl?this.getLineWidgetParaWidget(u,t):this.getLineWidgetTableWidget(u,t)}else{var p=e.bodyWidgets[h];if(p.firstChild.x+p.sectionFormat.columns[p.columnIndex].width>=t.x&&p.firstChild.x<=t.x&&p.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(p)>=t.y||p.firstChild.x+p.sectionFormat.columns[p.columnIndex].width<t.x&&p.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(p)>=t.y?l=p:e.x>t.x&&p.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(p)>=t.y&&!d&&(l=p,d=!0),h===e.bodyWidgets.length-1&&!(0,a.isNullOrUndefined)(l))for(c=0;c<l.childWidgets.length;c++){var u;if((u=l.childWidgets[c])instanceof Nl&&u.y<=t.y&&u.y+u.height>=t.y)return u instanceof Rl?this.getLineWidgetParaWidget(u,t):this.getLineWidgetTableWidget(u,t)}}for(var g=0;g<e.childWidgets.length;g++){if((y=e.childWidgets[g])instanceof Dl)return y[g];if(y instanceof Nl&&y.y<=t.y&&y.y+y.height>=t.y){if(y instanceof Rl)return this.getLineWidgetParaWidget(y,t);var m=y;if(m.wrapTextAround)continue;return this.getLineWidgetTableWidget(m,t)}}var f=void 0;if(i&&e.childWidgets.length>0){var v=e.childWidgets[0];if(v instanceof Nl&&v.y<=t.y)if(e.childWidgets[e.childWidgets.length-1]instanceof Rl)for(g=0;g<e.childWidgets.length;g++)f=this.getLineWidgetParaWidget(e.childWidgets[g],t);else for(g=0;g<e.childWidgets.length;g++)f=this.getLineWidgetTableWidget(e.childWidgets[g],t);else{var y=void 0;v instanceof Nl&&(y=v),(0,a.isNullOrUndefined)(y)||(f=y instanceof Rl?this.getLineWidgetParaWidget(v,t):this.getLineWidgetTableWidget(v,t))}}return f},t.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,n=e.y,r=0;r<i.length;r++){var o=i[r];n+=o.marginTop;var s=o.height;if(o.nextLine&&o.nextLine.marginTop>0&&(s+=o.nextLine.marginTop),n<=t.y&&n+s>=t.y)return o;n+=o.height}var a=void 0;return i.length>0&&(a=e.y<=t.y?i[i.length-1]:i[0]),a},t.prototype.highlightParagraph=function(e,t,i,n,r,o){var s=0,a=0,l=!1,d=n;e.paragraphFormat.bidi&&i.children.indexOf(n)>0&&(d=i.children[0]);for(var h=t;h<e.childWidgets.length;h++){var c=e.childWidgets[h];h===t?s=this.getTop(c):s+=c.marginTop,n instanceof Zl&&(l=n.isRightToLeft);var p=this.getLeft(c);if(c===i){var u=0;if(l||e.bidi){for(var g=this.getElementsBackward(c,d,n,e.bidi),m=0;m<g.length;m++){var f=g[m],v=!1;if(f===n)u=this.getLeftInternal(c,f,f.length);else{var y=f instanceof Zl?f.length:1;u=this.getLeftInternal(c,f,y)}if(p=this.getLeftInternal(c,f,0),f instanceof Zl&&(v=f.isRightToLeft),a=Math.abs(u-p),f===n&&f instanceof Zl&&r>f.length){var w=this.documentHelper.textHelper.getParagraphMarkSize(f.line.paragraph.characterFormat).Width;if(!e.bidi&&v)u+=w;else if(e.bidi&&!v){a-=w,this.createHighlightBorder(c,a,p,s,!0,o),p=this.getLineStartLeft(c)-w,this.createHighlightBorder(c,w,p,s,!0,o);continue}}this.createHighlightBorder(c,a,v?u:p,s,!0,o)}return}return u=this.getLeftInternal(i,n,r,!0),a=Math.abs(u-p),void this.createHighlightBorder(c,a,l?u:p,s,!1,o)}a=this.getWidth(c,!0)-(p-e.x),e.bidi&&c.isLastLine()&&(p-=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Width),this.createHighlightBorder(c,a,p,s,!1,o),s+=c.height}},t.prototype.getLineWidgetTableWidget=function(e,t){for(var i=void 0,n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r instanceof Ul&&r.y<=t.y){if("Exactly"===r.rowFormat.heightType&&r.y+Pa.convertPointToPixel(r.rowFormat.height)<t.y)continue;i=this.getLineWidgetRowWidget(r,t);var o=void 0;!(0,a.isNullOrUndefined)(i)&&i.paragraph.containerWidget instanceof Vl&&(o=i.paragraph.containerWidget);var s=0,l=0;if(!(0,a.isNullOrUndefined)(o)){var d=o.ownerRow.containerWidget;s=Pa.convertPointToPixel(d.tableFormat.cellSpacing),l=o.cellFormat.rowSpan}var h=0,c=0,p=0,u=0;if(s>0){h=0===o.cellIndex?s:s/2,c=o.cellIndex===o.ownerRow.childWidgets.length-1?s:s/2;var g=void 0;o.containerWidget instanceof Ul&&(g=o.containerWidget);d=void 0;o.containerWidget.containerWidget instanceof Al&&(d=o.containerWidget.containerWidget),(0,a.isNullOrUndefined)(g)||(0,a.isNullOrUndefined)(d)||(p=0===o.ownerRow.rowIndex?s:s/2,u=o.ownerRow.rowIndex+l===o.ownerTable.childWidgets.length?s:s/2)}if(!(0,a.isNullOrUndefined)(i)&&i.paragraph.x<=t.x&&i.paragraph.x+i.width>=t.x&&i.paragraph.y<=t.y&&this.getTop(i)+i.height>=t.y||!(0,a.isNullOrUndefined)(o)&&o.x-o.margin.left-h<=t.x&&o.x+o.width+o.margin.right+c>=t.x&&o.y-o.margin.top-p<=t.y&&o.y+o.height+o.margin.bottom+u>=t.y)break}}return i},t.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var n,r=0,o=0;if((n=Pa.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))>0&&(r=0===e.childWidgets[i].columnIndex?n:n/2,o=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?n:n/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-r<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+o>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var s=void 0;return e.childWidgets.length>0&&(s=e.childWidgets[0].x<=t.x?this.getLineWidgetCellWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetCellWidget(e.childWidgets[0],t)),s},t.prototype.getFirstBlock=function(e){if(e.childWidgets.length>0)return e.childWidgets[0]},t.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)e=t[i],this.clearChildSelectionHighlight(e),this.createHighlightBorderInsideTable(e)},t.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},t.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof Rl?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var n=void 0;return e.childWidgets.length>0&&e.childWidgets[0].y-e.margin.top<=t.y&&(n=e.childWidgets[e.childWidgets.length-1]instanceof Rl?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t)),n},t.prototype.updateTextPosition=function(e,t){var i=t,n=void 0,r=0,o=!1;if(this.owner.enableHeaderAndFooter){var s=this.start.paragraph.bodyWidget;-1!=s.headerFooterType.indexOf("Header")?this.comparePageWidthAndMargins(s.page.headerWidget,s.page):this.comparePageWidthAndMargins(s.page.footerWidget,s.page)}var l=this.updateTextPositionIn(e,n,r,t,!1);(0,a.isNullOrUndefined)(l)||(n=l.element,r=l.index,i=l.caretPosition,o=l.isImageSelected,this.isImageSelected=o),o?(this.selectInternal(e,n,r,i),0===r?this.extendForward():this.extendBackward()):((0,a.isNullOrUndefined)(this.owner.imageResizerModule)||this.owner.imageResizerModule.selectedImageWidget.clear(),this.selectInternal(e,n,r,i))},t.prototype.updateTextPositionIn=function(e,t,i,n,r){var o=!1,s=this.getTop(e),l=e.paragraph.x,d=this.getFirstElement(e,l),h=d.element,c=!1,p=!1;l=d.left;var u=e.renderedElements;if((0,a.isNullOrUndefined)(h)){var g=0,m=0,f=this.getParagraphMarkSize(e.paragraph,g,m);g=f.topMargin,m=f.bottomMargin,(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<l+f.width)&&r&&n.x>l+f.width/2?(l+=f.width,u.length>0&&(i=(t=u[u.length-1]).length),i++):e.paragraph.isEmpty()&&e.paragraph.bidi&&(l+=f.width),n=new Sa(l,g>0?s+g:s)}else if(!(0,a.isNullOrUndefined)(h)){if(n.x>l+h.margin.left||h instanceof dd&&"Inline"!==h.textWrappingStyle){var v=!1;e.paragraph.floatingElements.length>0&&(v=this.documentHelper.checkPointIsInLine(e,n));for(var y=u.indexOf(h);y<u.length;y++)if((h=u[y])instanceof dd&&"Inline"!==h.textWrappingStyle){if(this.documentHelper.isInShapeBorder(h,n)&&!this.documentHelper.isSelectionChangedOnMouseMoved&&!v){l=h.x,s=h.y;break}}else{var w=!1;if((h instanceof md||h instanceof Zl)&&(w=h.line.paragraph.paragraphFormat.bidi),n.x<l+h.margin.left+h.width+h.padding.left||y===u.length-1||u[y+1]instanceof md&&w)break;l+=h.margin.left+h.width+h.padding.left}if(h instanceof Zl&&(c=h.isRightToLeft,p=h.line.paragraph.paragraphFormat.bidi),n.x>l+h.margin.left+h.width+h.padding.left&&!(h instanceof hd))i=h instanceof Zl?h.length:1,c&&p&&(i=0),(h instanceof Zl&&"\v"!==h.text&&"\f"!==h.text&&h.text!==String.fromCharCode(14)||r)&&(l+=h.margin.left+h.width+h.padding.left);else if(h instanceof Zl){h instanceof Zl&&c&&(l+=h.width+h.padding.left);var b=0;b=c?l+h.margin.left-n.x:n.x-l-h.margin.left-h.padding.left,l+=h.margin.left+h.padding.left;var C=0,x=0;for(y=1;y<=h.length;y++){var I=0;if(b<(I=y===h.length?h.width+h.padding.left:this.documentHelper.textHelper.getWidth(h.text.substr(0,y),h.characterFormat,h.scriptType))||y===h.length){if(b-C>(I-C)/2)c?l-=I:l+=I,x=y;else if(c?l-=C:l+=C,x=y-1,1===y&&h!==u[0]&&!(u[0]instanceof dd&&"Inline"!==u[0].textWrappingStyle)){var k=u.indexOf(h);u[k-1]instanceof md||c||((h=u[k-1])instanceof dd&&"Inline"!==h.textWrappingStyle&&0==x&&!(0,a.isNullOrUndefined)(h.previousElement)&&(h=u[u.indexOf(h)-1]),x=h instanceof Zl?h.length:1)}break}C=I}i=x}else if(o=h instanceof gd||h instanceof hd,n.x-l-h.margin.left>h.width/2)i=1,l+=h.margin.left+h.width+h.padding.left;else if(h!==u[0]&&!o){k=u.indexOf(h);u[k-1]instanceof md||(i=(h=u[k-1])instanceof Zl?h.length:1)}h instanceof Zl&&("\v"===h.text||"\f"===h.text||h.text===String.fromCharCode(14))&&(i=0)}else c=h.isRightToLeft,p=h.line.paragraph.paragraphFormat.bidi,i=h instanceof Zl&&(p||c)&&n.x<l+h.margin.left+h.width+h.padding.left?this.getTextLength(h.line,h)+h.length:this.getTextLength(h.line,h),l+=h.margin.left;if(h instanceof Zl)s+=h.margin.top>0?h.margin.top:0;else{var F=this.documentHelper.textHelper.getHeight(h.characterFormat),P=h.height;h instanceof td&&!this.documentHelper.layout.hasValidElement(h.line.paragraph)&&(P=F.Height),s+=h.margin.top+P-F.BaselineOffset}(t=h)instanceof _l&&2===t.fieldType&&!(0,a.isNullOrUndefined)(t.fieldBegin)&&(t=t.fieldBegin,i=0),t instanceof fd&&(i=0),this.isMoveDownOrMoveUp&&h instanceof id&&(i=0===h.type?i+1:i-1),!(0,a.isNullOrUndefined)(t.previousElement)&&t.previousElement instanceof dd&&"Inline"!==t.previousElement.textWrappingStyle&&0==i&&(t=t.previousElement);var S=this.validateTextPosition(t,i);t=S.element,i=S.index;var T=(0,a.isNullOrUndefined)(t.nextNode)&&i===t.length,H=t.line.isEndsWithLineBreak&&t instanceof Zl&&"\v"===t.text;if(r&&t.nextNode instanceof _l&&i===t.length&&(T=this.isLastRenderedInline(t,i)),r&&T||H){I=0;if(T)I=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat),(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<l+I)&&n.x>l+I/2&&(l+=I,i=t.length+1);else H&&(l+=I=h.width+h.padding.left)}n=new Sa(l,s)}return{element:t,index:i,caretPosition:n,isImageSelected:o}},t.prototype.checkAllFloatingElements=function(e,t){var i,n,r=!1,o=!1;if(!(0,a.isNullOrUndefined)(e)){i=e.paragraph.bodyWidget,r=!1,o=!1;for(var s=0;s<i.floatingElements.length;s++)if(!(i.floatingElements[s]instanceof Al)&&(n=i.floatingElements[s],t.x<n.x+n.margin.left+n.width&&t.x>n.x&&t.y<n.y+n.margin.top+n.height&&t.y>n.y)){r=!0,this.documentHelper.isInShapeBorder(n,t)&&(o=!0);break}}return{element:n,caretPosition:t,isShapeSelected:r,isInShapeBorder:o}},t.prototype.getTextLength=function(e,t){var i=0,n=e.renderedElements,r=n.indexOf(t);n.length>0&&n[0]instanceof md&&(n[1]instanceof md?r-=2:r-=1);for(var o=1;o<r;o++)i+=n[o].length;return i},t.prototype.getLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!i.bidi&&"Right"!==i.textAlignment&&(t+=Pa.convertPointToPixel(i.firstLineIndent));for(var n=e.renderedElements,r=0;r<n.length;r++){var o=n[r];if(!(o instanceof md)||i.bidi){t+=o.margin.left;break}0===r?(t+=o.margin.left+o.width,o.padding&&(t+=o.padding.left)):t+=o.width}return t},t.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),n=0;n<i;n++){var r=e.paragraph.childWidgets[n];t=t+r.height+r.marginTop}return t+=e.marginTop},t.prototype.getFirstElement=function(e,t){var i=0;this.isParagraphFirstLine(e)&&!e.paragraph.paragraphFormat.bidi&&(i=Pa.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),t+=i;for(var n=void 0,r=e.renderedElements,o=0;o<r.length&&(n=r[o])instanceof md;o++)e.paragraph.paragraphFormat.bidi?(t+=n.margin.left,n=void 0):(t+=n.margin.left+n.width+n.padding.left,n=void 0);return{element:n,left:t}},t.prototype.getIndexInInline=function(e){var t=0;if(e instanceof Zl)for(var i=e.line.children.indexOf(e),n=0;n<i;n++){var r=e.line.children[n];r instanceof _l||r instanceof md||(t+=r.length)}return t},t.prototype.isParagraphFirstLine=function(e){return!(!(0,a.isNullOrUndefined)(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},t.prototype.isParagraphLastLine=function(e){return!(!(0,a.isNullOrUndefined)(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},t.prototype.getWidth=function(e,t){var i=0,n=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!n.bidi&&(i+=Pa.convertPointToPixel(n.firstLineIndent));for(var r=0;r<e.children.length;r++){var o=e.children[r];o instanceof dd&&"Inline"!==o.textWrappingStyle||(i+=o.margin.left+o.width+o.padding.left)}return t&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&(0,a.isNullOrUndefined)(e.paragraph.nextSplitWidget)&&(i+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),i},t.prototype.getLeftInternal=function(t,i,n,r){var o=t.paragraph.x,s=t.paragraph.paragraphFormat;this.isParagraphFirstLine(t)&&!s.bidi&&(o+=Pa.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent));var l=t.renderedElements,d=l.indexOf(i);(1===l.length&&l[0]instanceof md||2===l.length&&l[0]instanceof md&&l[1]instanceof md)&&(d=l.length);for(var h=!1,c=0;c<d;c++){var p=l[c];p instanceof _l&&2===p.fieldType&&(h=!1),h||(p instanceof dd&&"Inline"!==p.textWrappingStyle||(1===c&&p instanceof md?(o+=p.width,p.padding&&p.padding.left&&(o+=p.padding.left)):o+=p instanceof ed&&i===p?p.margin.left:p.margin.left+p.width+p.padding.left,p instanceof _l&&0===p.fieldType&&(h=!0)))}var u=!1,g=t.paragraph.bidi;(0,a.isNullOrUndefined)(i)||(u=i.characterRange===e.RightToLeft,g=i.line.paragraph.paragraphFormat.bidi,o=0===n&&r?o+i.margin.left:o+i.margin.left+i.padding.left,i instanceof dd&&!(0,a.isNullOrUndefined)(i.nextElement)&&(o+=i.nextElement.margin.left+i.nextElement.padding.left),(u||1===this.documentHelper.moveCaretPosition&&!u&&g)&&(o+=i.width));var m=0;if(i instanceof Zl){if(0!==this.documentHelper.moveCaretPosition&&(g||u))return(u&&g&&2===this.documentHelper.moveCaretPosition||u&&!g&&1===this.documentHelper.moveCaretPosition)&&(o-=i.width),this.documentHelper.moveCaretPosition=0,o;n!==i.length||u?n>i.length?(m=this.documentHelper.textHelper.getParagraphMarkWidth(i.line.paragraph.characterFormat),u?o-=i.width+m:o+=i.width+m):(m=n===i.length&&u&&"Justify"===s.textAlignment?i.width:this.documentHelper.textHelper.getWidth(i.text.substr(0,n),i.characterFormat,i.scriptType),u?o-=m:o+=m):o+=i.width,this.documentHelper.moveCaretPosition=0}else if(n>0)if((0,a.isNullOrUndefined)(i)||i instanceof md)o+=this.documentHelper.textHelper.getParagraphMarkWidth(t.paragraph.characterFormat);else if(i instanceof dd&&"Inline"!==i.textWrappingStyle||(o+=i.width),2===n){var f=i.line.paragraph;o+=this.documentHelper.textHelper.getParagraphMarkWidth(f.characterFormat)}return o},t.prototype.getLineStartLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;return this.isParagraphFirstLine(e)&&!i.bidi&&(t+=Pa.convertPointToPixel(i.firstLineIndent)),e.children.length>0&&(t+=e.children[0].margin.left),t},t.prototype.updateTextPositionWidget=function(e,t,i,n){var r,o=t,s=void 0,a=0;s=(r=this.updateTextPositionIn(e,s,a,o,n)).element,a=r.index,o=r.caretPosition,i.setPositionForSelection(e,s,a,o)},t.prototype.clearSelectionHighlightLineWidget=function(e){!(0,a.isNullOrUndefined)(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},t.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=e.children.length,n=0;n<i&&(t=e.children[n])instanceof md;n++)t=void 0;return t},t.prototype.selectRange=function(e,t,i){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0,!0,i)},t.prototype.selectParagraphInternal=function(e,t){var i;if(!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(e.firstChild))if(i=e.firstChild,t)this.start.setPosition(i,t);else{var n=i.getEndOffset();this.start.setPositionParagraph(i,n)}this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},t.prototype.setPositionForBlock=function(e,t){var i;if(e instanceof Al&&(e=t?this.documentHelper.getFirstParagraphInFirstCell(e):this.documentHelper.getLastParagraphInLastCell(e)),e instanceof Rl)if(i=new ac(this.owner),t)i.setPosition(e.firstChild,!0);else{var n=e.lastChild;i.setPositionParagraph(n,n.getEndOffset())}return i},t.prototype.selectContent=function(e,t){if((0,a.isNullOrUndefined)(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},t.prototype.selectInternal=function(e,t,i,n){this.start.setPositionForSelection(e,t,i,n),this.end.setPositionInternal(this.start),this.upDownSelectionLength=n.x,this.fireSelectionChanged(!0)},t.prototype.selects=function(e,t,i){this.documentHelper.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},t.prototype.selectPosition=function(e,t){if((0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(t))throw new Error("TextPosition cannot be undefined");if((0,a.isNullOrUndefined)(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if((0,a.isNullOrUndefined)(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(t)?this.selectRange(e,e):(e.isExistBefore(t)?t.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,t))},t.prototype.fireSelectionChanged=function(e,t,i){this.isSelectBookmark||(this.isExcludeBookmarkStartEnd=!1),this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),this.isModifyingSelectionInternally||(this.documentHelper.formFields.length>0&&!this.owner.editor.isRemoteAction?this.currentFormField=this.getCurrentFormField():this.currentFormField=void 0,!(0,a.isNullOrUndefined)(this.previousSelectedFormField)&&(0,a.isNullOrUndefined)(this.previousSelectedFormField.fieldSeparator)&&(this.previousSelectedFormField=this.currentFormField),e&&(this.previousSelectedContentControl=this.currentContentControl),this.documentHelper.contentControlCollection.length>0?this.currentContentControl=this.owner.editor.getContentControl():this.currentContentControl=void 0,this.skipFormatRetrieval||!(0,a.isNullOrUndefined)(this.owner.optionsPaneModule)&&this.owner.optionsPaneModule.isBuildHeading||this.retrieveCurrentFormatProperties(),this.updateContentControlHighlightSelection(),this.documentHelper.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0,i),this.documentHelper.restrictEditingPane.isShowRestrictPane&&!this.skipEditRangeRetrieval&&this.documentHelper.restrictEditingPane.updateUserInformation(),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.triggerSpellCheckWhenSelectionChanges(),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.isFormFillProtectedMode&&e&&(this.triggerFormFillEvent(t),this.previousSelectedFormField=this.currentFormField),this.owner.rulerHelper&&this.owner.documentEditorSettings&&this.owner.documentEditorSettings.showRuler&&!this.owner.isReadOnlyMode&&this.owner.rulerHelper.updateRuler(this.owner,!1))},t.prototype.updateContentControlHighlightSelection=function(){if(this.contentControleditRegionHighlighters.clear(),this.isHighlightContentControlEditRegion&&(this.documentHelper.contentControlCollection.length>0&&((0,a.isNullOrUndefined)(this.owner.optionsPaneModule)||!this.owner.optionsPaneModule.isBuildHeading)?this.contentControls=this.owner.editor.getContentControls():this.contentControls=[],this.contentControls&&this.contentControls.length>0))for(var e=0;e<this.contentControls.length;e++)this.highlightContentControlEditRegionInternal(this.contentControls[parseInt(e.toString(),10)])},t.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isRetrieveFormatting=!1,this.setCurrentContextType()},t.prototype.triggerSpellCheckWhenSelectionChanges=function(){this.documentHelper.isSpellCheckPending&&this.documentHelper.owner.isSpellCheck&&!this.documentHelper.isTextInput&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0,this.viewer.updateScrollBars(),this.documentHelper.isSpellCheckPending=!1,this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1)},t.prototype.retrieveImageFormat=function(e,t){var i;if(e.currentWidget===t.currentWidget&&e.offset+1===t.offset){var n=t.currentWidget.getInline(t.offset,0);i=n.element;n.index;if(i instanceof gd)e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}i instanceof gd?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},t.prototype.getPreviousContextType=function(e){var t=this.start;if(t.offset>0){var i=t.currentWidget.getInline(t.offset,0).element;return i=e?i.previousElement:t.currentWidget.getInline(t.offset-1,0).element,this.getContextElement(i)}},t.prototype.getNextContextType=function(e){var t=this.start,i=t.currentWidget.getInline(t.offset,0).element;return i=e&&i.nextElement?i.nextElement:t.currentWidget.getInline(t.offset+1,0).element,this.getContextElement(i)},t.prototype.getContextElement=function(e){return e instanceof Zl?"Text":e instanceof _l||e instanceof $l?"Field":e instanceof td?"Bookmark":e instanceof gd?"Image":e instanceof hd?"Shape":e instanceof Ld||e instanceof Bd?"Comment":e instanceof md?"List":e instanceof vd||e instanceof fd?"EditRange":void 0},t.prototype.getContentControlPositions=function(e){var t=e.line.getOffset(e,1),i=new ac(this.owner);i.setPositionParagraph(e.line,t);var n=e.reference,r=n.line.getOffset(n,0),o=new ac(this.owner);return o.setPositionParagraph(n.line,r),{startPosition:i,endPosition:o}},t.prototype.getContentControlInfo=function(){var e=this.currentContentControl;if(!(0,a.isNullOrUndefined)(e)){var t="";if("Text"===e.contentControlProperties.type){var i=this.getContentControlPositions(e);t=this.documentHelper.selection.getTextInternal(i.startPosition,i.endPosition,!1)}else if("RichText"===e.contentControlProperties.type){e.contentControlProperties.type="BuildingBlockGallery";i=this.getContentControlPositions(e);var n=(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)?{}:this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,i.startPosition.currentWidget,i.startPosition.offset,i.endPosition.currentWidget,i.endPosition.offset,!1,!0);t=JSON.stringify(n),e.contentControlProperties.type="RichText"}else if("CheckBox"===e.contentControlProperties.type)t=e.contentControlProperties.isChecked?"true":"false";else if("ComboBox"===e.contentControlProperties.type||"DropDownList"===e.contentControlProperties.type||"Date"===e.contentControlProperties.type)for(var r=e;r!==e.reference;)r instanceof Zl&&(t+=r.text),r=r.nextNode;else"Picture"===e.contentControlProperties.type&&e.nextNode instanceof gd&&(t=this.documentHelper.getImageString(e.nextNode));return{title:e.contentControlProperties.title,tag:e.contentControlProperties.tag,value:t,canDelete:e.contentControlProperties.lockContentControl,canEdit:e.contentControlProperties.lockContents,type:e.contentControlProperties.type}}},t.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,t=!(0,a.isNullOrUndefined)(this.tableFormat)&&!(0,a.isNullOrUndefined)(this.tableFormat.table),i=this.start.paragraph.paragraphFormat.baseStyle;if(i instanceof Wa&&0===i.name.toLowerCase().indexOf("toc")){var n=this.getTocFieldInternal();if(!(0,a.isNullOrUndefined)(n))return void(this.contextTypeInternal="TableOfContents")}var r=this.getCurrentRevision();if(!(0,a.isNullOrUndefined)(r)&&this.owner.showRevisions&&this.owner.isUpdateTrackChanges?(this.owner.trackChangesPane.currentSelectedRevision=r[0],(0,a.isNullOrUndefined)(this.owner.documentHelper.currentSelectedComment)&&this.owner.commentReviewPane.selectReviewTab("Changes"),this.owner.notify("reviewPane",{comment:this.owner.showComments,changes:!0,isUserClosed:!1})):(0,a.isNullOrUndefined)(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter){var o=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header");this.contextTypeInternal=t?e?o?"HeaderTableImage":"FooterTableImage":o?"HeaderTableText":"FooterTableText":e?o?"HeaderImage":"FooterImage":o?"HeaderText":"FooterText"}else this.contextTypeInternal=t?e?"TableImage":"TableText":e?"Image":"Text";if(!(0,a.isNullOrUndefined)(this.owner.editor)&&!(0,a.isNullOrUndefined)(this.owner.editor.documentHelper)&&this.owner.editor.documentHelper.contentControlCollection&&this.owner.editor.documentHelper.contentControlCollection.length>0){var s=this.currentContentControl,l=this.owner.getImageContentControl();if(!(0,a.isNullOrUndefined)(s)||!(0,a.isNullOrUndefined)(l))switch(s?s.contentControlProperties.type:l.contentControlProperties.type){case"RichText":this.contextTypeInternal="RichTextContentControl";break;case"Text":this.contextTypeInternal="PlainTextContentControl";break;case"Picture":this.contextTypeInternal="PictureContentControl";break;case"ComboBox":this.contextTypeInternal="ComboBoxContentControl";break;case"DropDownList":this.contextTypeInternal="DropDownListContentControl";break;case"CheckBox":this.contextTypeInternal="CheckBoxContentControl";break;case"Date":this.contextTypeInternal="DatePickerContentControl"}}},t.prototype.addItemRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var n=e.revisions[i];this.selectRevision(n),t?n.accept():n.reject()}},t.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},t.prototype.getCurrentRevision=function(){var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=!1;this.owner.enableTrackChanges&&this.owner.editorHistoryModule&&this.owner.editorHistoryModule.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistoryModule.currentBaseHistoryInfo.action&&(i=!0);var n,r,o=(i&&this.getLineLength(e.currentWidget)>=e.offset+1?e.currentWidget.getInline(e.offset+1,0):e.currentWidget.getInline(e.offset,0)).element,s=e.paragraph;if(n=i&&this.getLineLength(e.currentWidget)>=e.offset+2?e.currentWidget.getInline(e.offset+2,0).element:e.currentWidget.getInline(e.offset+1,0).element,o&&o===n){var l=o.line.getOffset(o,o.length);if((r=new ac(this.owner)).setPositionParagraph(o.line,l),t.offset===r.offset&&!(0,a.isNullOrUndefined)(o.nextElement))return}if(!(0,a.isNullOrUndefined)(o)&&o.revisions.length>0)return o.revisions;if(s.isInsideTable){var d=s.associatedCell;if(!(0,a.isNullOrUndefined)(d.ownerRow)&&d.ownerRow.rowFormat.revisions.length>0)return d.ownerRow.rowFormat.revisions}return t.offset>t.paragraph.getLength()&&t.paragraph.characterFormat.revisions.length>0?t.paragraph.characterFormat.revisions:void 0},t.prototype.processLineRevisions=function(e,t){for(var i=0;i<e.children.length;i++){var n=e.children[i];n.revisions.length>0&&this.addItemRevisions(n,t)}},t.prototype.handleAcceptReject=function(e){if(this.isEmpty){var t=this.start.currentWidget.getInline(this.start.offset+1,0).element,i=this.start.paragraph;if(!(0,a.isNullOrUndefined)(t)&&t.revisions.length>0&&this.addItemRevisions(t,e),i.isInsideTable){var n=i.associatedCell;if((0,a.isNullOrUndefined)(n)){if(!i.isEmpty())for(var r=0;r<n.childWidgets.length;r++)for(var o=n.childWidgets[r],s=void 0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];this.processLineRevisions(l,e)}}else n.ownerRow.rowFormat.revisions.length>0&&this.addItemRevisions(n.ownerRow.rowFormat,e)}}else{var d=this.getselectedRevisionElements();for(r=0;r<d.length;r++)this.acceptReject(d[r],e)}},t.prototype.acceptReject=function(e,t){this.selectRevision(e),t?e.accept():e.reject()},t.prototype.getselectedRevisionElements=function(){var e=[],t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);for(var n=0;n<this.selectedWidgets.length;n++){var r=this.selectedWidgets.keys[n];if(r instanceof zl)e=this.getSelectedLineRevisions(r,t,i,e);else if(r instanceof Vl){r.ownerRow.rowFormat.revisions.length>0&&(e=this.addRevisionsCollec(r.ownerRow.rowFormat.revisions,e));for(var o=0;o<r.childWidgets.length;o++)for(var s=r.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a];e=this.getSelectedLineRevisions(l,t,i,e)}}}return e},t.prototype.getSelectedLineRevisions=function(e,t,i,n){e.paragraph.characterFormat.revisions.length>0&&(n=this.addRevisionsCollec(e.paragraph.characterFormat.revisions,n));for(var r=0;r<e.children.length;r++){var o=e.children[r],s=o.line.getOffset(o,0),a=new ac(this.owner);a.setPositionParagraph(o.line,s),s=o.line.getOffset(o,o.length);var l=new ac(this.owner);l.setPositionParagraph(o.line,s),(l.isExistAfter(t)&&l.isExistBefore(i)||a.isExistAfter(t)&&a.isExistBefore(i)||a.isAtSamePosition(t)||t.isExistAfter(a)&&i.isExistBefore(l))&&o.revisions.length>0&&(n=this.addRevisionsCollec(o.revisions,n))}return n},t.prototype.addRevisionsCollec=function(e,t){for(var i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},t.prototype.retrieveTableFormat=function(e,t){var i=this.getTable(e,t);(0,a.isNullOrUndefined)(i)?this.tableFormat.clearFormat():(this.tableFormat.table=i,this.tableFormat.copyFormat(i.tableFormat),this.retrieveCellFormat(e,t),this.retrieveRowFormat(e,t))},t.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},t.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},t.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var n=!1,r=0;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(o===t.paragraph.associatedCell.ownerRow&&(n=!0),n)for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.isCellSelected(a,t,i)&&this.cellFormat.combineFormat(a.cellFormat),a===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(a.cellFormat)}}},t.prototype.getRowFormat=function(e,t,i){var n=t.paragraph.associatedCell.ownerRow;if(n!==i.paragraph.associatedCell.ownerRow)for(var r=e.childWidgets.indexOf(n)+1;r<e.childWidgets.length;r++){var o=e.childWidgets[r];if(this.rowFormat.combineFormat(o.rowFormat),o===i.paragraph.associatedCell.ownerRow)return}},t.prototype.getTable=function(e,t){if(!(0,a.isNullOrUndefined)(e.paragraph.associatedCell)&&!(0,a.isNullOrUndefined)(t.paragraph.associatedCell)){var i=e.paragraph.associatedCell.ownerTable,n=e.paragraph.associatedCell.ownerTable;if(i===n)return i;if(i.contains(e.paragraph.associatedCell))return i;if(n.contains(e.paragraph.associatedCell))return n;if(!i.isInsideTable||!n.isInsideTable)return;do{if((i=i.associatedCell.ownerTable)===n||i.contains(n.associatedCell))return i;if(n.contains(i.associatedCell))return n}while(!(0,a.isNullOrUndefined)(i.associatedCell))}},t.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof cd)t=e.containerWidget.containerShape.line.paragraph.bodyWidget;else if(e.containerWidget instanceof Wl)t=!(0,a.isNullOrUndefined)(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof Dl?e.containerWidget.containerWidget:e.containerWidget;else for(t=e.containerWidget;!(t instanceof Wl);)t instanceof cd&&(t=t.containerShape.line.paragraph),t=t.containerWidget;return t},t.prototype.retrieveSectionFormat=function(e,t){var i=this.getContainerWidget(e.paragraph),n=this.getContainerWidget(t.paragraph);if(!(0,a.isNullOrUndefined)(i)){this.sectionFormat.copyFormat(i.sectionFormat);for(var r=this.documentHelper.pages.indexOf(i.page),o=this.documentHelper.pages.indexOf(n.page),s=r+1;s<=o;s++)this.sectionFormat.combineFormat(this.documentHelper.pages[s].bodyWidgets[0].sectionFormat)}},t.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},t.prototype.getParagraphFormatForSelection=function(e,t,i,n){if(!i.paragraph.isInsideTable||n.paragraph.isInsideTable&&i.paragraph.associatedCell===n.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,n)){if(this.getParagraphFormatInternalInParagraph(e,i,n),n.paragraph===e)return;var r=this.getNextRenderedBlock(e);(0,a.isNullOrUndefined)(r)||this.getParagraphFormatInternalInBlock(r,i,n)}else this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,n)},t.prototype.getParagraphsInSelection=function(){var e=this.owner.selectionModule,t=e.selectedWidgets.keys,i=[];if(e.isEmpty||e.start.paragraph===e.end.paragraph)return[e.start.paragraph];for(var n=0;n<t.length;n++){var r=t[n];-1===i.indexOf(r.paragraph)&&i.push(r.paragraph)}return i},t.prototype.getParagraphFormatInternalInParagraph=function(e,t,i){t.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},t.prototype.getParagraphFormatInternalInBlock=function(e,t,i){if(e instanceof Rl){if(this.getParagraphFormatInternalInParagraph(e,t,i),i.paragraph===e)return;var n=this.getNextRenderedBlock(e);(0,a.isNullOrUndefined)(n)||this.getParagraphFormatInternalInBlock(n,t,i)}else this.getParagraphFormatInternalInTable(e,t,i)},t.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(s,t,i)},t.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},t.prototype.getParagraphFormatInBlock=function(e){e instanceof Rl?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},t.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.childWidgets.length;n++)this.getParagraphFormatInCell(i.childWidgets[n])},t.prototype.getParagraphFormatInParagraph=function(e){this.start.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},t.prototype.getParagraphFormatInternalInCell=function(e,t,i){if(i.paragraph.isInsideTable){var n=this.getContainerCellOf(e,i.paragraph.associatedCell);if(n.ownerTable.contains(i.paragraph.associatedCell)){var r=this.getSelectedCell(e,n),o=this.getSelectedCell(i.paragraph.associatedCell,n);if(this.containsCell(n,i.paragraph.associatedCell))if(this.isCellSelected(n,t,i))this.getParagraphFormatInCell(n);else if(r===n){if(this.getParagraphFormatInternalInParagraph(t.paragraph,t,i),i.paragraph===t.paragraph)return;var s=this.getNextRenderedBlock(t.paragraph);(0,a.isNullOrUndefined)(s)||this.getParagraphFormatInternalInBlock(s,t,i)}else this.getParagraphFormatInRow(r.ownerRow,t,i);else this.getParaFormatForCell(n.ownerTable,n,o)}else this.getParagraphFormatInRow(n.ownerRow,t,i)}else{var l=this.getContainerCell(e);this.getParagraphFormatInRow(l.ownerRow,t,i)}},t.prototype.getParaFormatForCell=function(e,t,i){var n=this.getCellLeft(t.ownerRow,t),r=n+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;n>o&&(n=o),r<s&&(r=s),n>this.upDownSelectionLength&&(n=this.upDownSelectionLength),n<this.upDownSelectionLength&&(n=this.upDownSelectionLength);for(var a=e.childWidgets.indexOf(i.ownerRow),l=e.childWidgets.indexOf(t.ownerRow);l<=a;l++)for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h],p=this.getCellLeft(d,c);Pa.round(n,2)<=Pa.round(p,2)&&Pa.round(p,2)<Pa.round(r,2)&&this.getParagraphFormatInCell(c)}},t.prototype.getParagraphFormatInRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getParagraphFormatInCell(r.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(s,t,i)},t.prototype.retrieveCharacterFormat=function(e,t){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph.isEmpty()&&this.characterFormat.copyFormat(e.paragraph.characterFormat,this.documentHelper.textHelper.getFontNameToRender(0,e.paragraph.characterFormat)),e.paragraph!==t.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==t.offset){var i=e.paragraph;if(e.paragraph===t.paragraph&&this.isSelectList){var n=this.getListLevel(e.paragraph);n&&n.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(n.characterFormat)}else{for(e.offset!==this.getParagraphLength(i)||this.isEmpty||(i=this.getNextParagraphBlock(i));!(0,a.isNullOrUndefined)(i)&&i!==t.paragraph&&i.isEmpty();)i=this.getNextParagraphBlock(i);var r=i===e.paragraph?e.offset:0;if(!(0,a.isNullOrUndefined)(i)&&!i.isEmpty()){var o=new ac(this.owner),s=e.currentWidget.getInline(r,0),l=this.getPhysicalPositionInternal(e.currentWidget,r,!0);o.setPositionForSelection(e.currentWidget,s.element,s.index,l),this.getCharacterFormatForSelection(i,this,o,t)}}}},t.prototype.getCharacterFormatForSelection=function(e,t,i,n){i.paragraph instanceof Rl&&i.paragraph.isInsideTable&&(!n.paragraph.isInsideTable||i.paragraph.associatedCell!==n.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,n))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,n):this.getCharacterFormat(e,i,n)},t.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var n=e.rowIndex;n<e.ownerTable.childWidgets.length;n++){for(var r=e.ownerTable.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(s,t,i)},t.prototype.getCharacterFormatInTableCell=function(e,t,i,n){if(n.paragraph.isInsideTable){var r=this.getContainerCellOf(e,n.paragraph.associatedCell);if(r.ownerTable.contains(n.paragraph.associatedCell)){var o=this.getSelectedCell(e,r),s=this.getSelectedCell(n.paragraph.associatedCell,r);this.containsCell(r,n.paragraph.associatedCell)?this.isCellSelected(r,i,n)?this.getCharacterFormatForSelectionCell(r,i,n):o===r?this.getCharacterFormat(i.paragraph,i,n):this.getCharacterFormatForTableRow(o.ownerRow,i,n):this.getCharacterFormatInternalInTable(r.ownerTable,r,s,i,n)}else this.getCharacterFormatForTableRow(r.ownerRow,i,n)}else{var a=this.getContainerCell(e);this.getCharacterFormatForTableRow(a.ownerRow,i,n)}},t.prototype.getCharacterFormatInternalInTable=function(e,t,i,n,r){var o=this.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,a=this.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth;o>a&&(o=a),s<l&&(s=l),o>this.upDownSelectionLength&&(o=this.upDownSelectionLength),s<this.upDownSelectionLength&&(s=this.upDownSelectionLength);for(var d=e.childWidgets.indexOf(i.ownerRow),h=e.childWidgets.indexOf(t.ownerRow);h<=d;h++)for(var c=e.childWidgets[h],p=0;p<c.childWidgets.length;p++){var u=c.childWidgets[p],g=this.getCellLeft(c,u);Pa.round(o,2)<=Pa.round(g,2)&&Pa.round(g,2)<Pa.round(s,2)&&this.getCharacterFormatForSelectionCell(u,n,r)}},t.prototype.getCharacterFormat=function(e,t,i){if((e===t.paragraph||e===i.paragraph||e.isEmpty()||(this.getCharacterFormatInternal(e,this),this.characterFormat.canRetrieveNextCharacterFormat()))&&(i.paragraph!==e||t.paragraph===e||0!==i.offset)){var n=0,r=this.getParagraphLength(e);if(e===t.paragraph)if(n=t.offset,this.setCharacterFormat(e,t,i,r))return;var o=-1!==e.childWidgets.indexOf(t.currentWidget)?e.childWidgets.indexOf(t.currentWidget):0,s=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):e.childWidgets.length-1,l=i.offset;e!==i.paragraph&&(l=r);for(var d=o;d<=s;d++){var h=e.childWidgets[d];d!==o&&(n=this.getStartLineOffset(h)),l=h===i.currentWidget?i.offset:this.getLineLength(h);for(var c=0,p=0;p<h.children.length;p++){var u=h.children[p];if(!(u instanceof md))if(n>=c+u.length)c+=u.length;else if(u instanceof _l&&0===u.fieldType&&Pa.isLinkedFieldCharacter(u)){var g=(0,a.isNullOrUndefined)(u.fieldEnd)?u.fieldBegin:u.fieldEnd;p--;do{this.characterFormat.combineFormat(u.characterFormat),c+=u.length,u=u.nextNode,d++,p++}while(!(0,a.isNullOrUndefined)(u)&&u!==g)}else{if((u instanceof Zl||u instanceof _l)&&this.characterFormat.combineFormat(u.characterFormat,this.documentHelper.textHelper.getFontNameToRender(u.scriptType,u.characterFormat)),(0,a.isNullOrUndefined)(u)||l<=c+u.length)break;c+=u.length}}}if(i.paragraph!==e){var m=this.getNextRenderedBlock(e);(0,a.isNullOrUndefined)(m)||this.getCharacterFormatForBlock(m,t,i)}}},t.prototype.setCharacterFormat=function(e,t,i,n){var r=0,o=t.offset,s=t.currentWidget.getInline(o,r);r=s.index;var l=s.element;if((0,a.isNullOrUndefined)(l)){t.paragraph.childWidgets.indexOf(t.currentWidget);if(t.currentWidget.previousLine)return l=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(l.characterFormat,this.documentHelper.textHelper.getFontNameToRender(l.scriptType,l.characterFormat)),!0}if(o<n){if(this.isEmpty){if(l instanceof Zl||l instanceof _l&&(0===l.fieldType||1===l.fieldType)){var d=this.getPreviousTextElement(l);0===o&&d&&(l=d),this.characterFormat.copyFormat(l.characterFormat,this.documentHelper.textHelper.getFontNameToRender(l.scriptType,l.characterFormat))}else if((0,a.isNullOrUndefined)(this.getPreviousTextElement(l)))if((0,a.isNullOrUndefined)(this.getNextTextElement(l)))this.characterFormat.copyFormat(e.characterFormat);else{h=this.getNextTextElement(l);this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,l.characterFormat))}else{var h=this.getPreviousTextElement(l);this.characterFormat.copyFormat(h.characterFormat,this.documentHelper.textHelper.getFontNameToRender(h.scriptType,l.characterFormat))}return!0}r!==l.length||(0,a.isNullOrUndefined)(l.nextNode)?l instanceof Zl?this.characterFormat.copyFormat(l.characterFormat,this.documentHelper.textHelper.getFontNameToRender(l.scriptType,l.characterFormat)):l instanceof _l&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(l)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(l),this.documentHelper.textHelper.getFontNameToRender(l.scriptType,l.characterFormat))}else if(n===i.offset)return l instanceof Zl||l instanceof _l?this.characterFormat.copyFormat(l.characterFormat,this.documentHelper.textHelper.getFontNameToRender(l.scriptType,l.characterFormat)):(0,a.isNullOrUndefined)(l)?this.characterFormat.copyFormat(e.characterFormat):(l=this.getPreviousTextElement(l),(0,a.isNullOrUndefined)(l)||this.characterFormat.copyFormat(l.characterFormat,this.documentHelper.textHelper.getFontNameToRender(l.scriptType,l.characterFormat))),!0;return!1},t.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof Rl?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},t.prototype.getCharacterFormatInTable=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++){for(var r=e.childWidgets[n],o=0;o<r.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(r.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(r,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);(0,a.isNullOrUndefined)(s)||this.getCharacterFormatForBlock(s,t,i)},t.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var n=0;n<e.childWidgets.length;n++)this.getCharacterFormatForBlock(e.childWidgets[n],t,i)},t.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var n=e.childWidgets[i],r=0;r<n.children.length;r++){var o=n.children[r];o instanceof gd||o instanceof _l||o instanceof md||t.characterFormat.combineFormat(o.characterFormat)}},t.prototype.getNextValidCharacterFormat=function(e){var t=this.getNextTextElement(e);if((0,a.isNullOrUndefined)(t))return e.characterFormat;var i=void 0;return t instanceof _l&&0===i.fieldType&&(i=t),(0,a.isNullOrUndefined)(i)?t.characterFormat:this.getNextValidCharacterFormatOfField(i)},t.prototype.getNextValidCharacterFormatOfField=function(e){var t=e;Pa.isLinkedFieldCharacter(e)&&(t=(0,a.isNullOrUndefined)(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator);var i=void 0;return(0,a.isNullOrUndefined)(t.nextNode)||(i=this.documentHelper.getNextValidElement(t.nextNode)),(0,a.isNullOrUndefined)(i)?t.characterFormat:i.characterFormat},t.prototype.checkCursorIsInSelection=function(e,t){if((0,a.isNullOrUndefined)(this.start)||this.isEmpty||(0,a.isNullOrUndefined)(e))return!1;var i=!1;do{if(this.selectedWidgets.containsKey(e)){var n=void 0;e instanceof zl?(n=this.owner.selectionModule.getTop(e),this.owner.selectionModule.getLeft(e)):(n=e.y,e.x);var r=this.selectedWidgets.get(e);if(r instanceof lc)i=r.left<=t.x&&n<=t.y&&n+e.height>=t.y&&r.left+r.width>=t.x;else for(var o=r,s=0;s<o.length&&!(o[s]instanceof lc&&(i=o[s].left<=t.x&&n<=t.y&&n+e.height>=t.y&&o[s].left+o[s].width>=t.x));s++);}e=e instanceof zl?e.paragraph:e.containerWidget}while(!(0,a.isNullOrUndefined)(e)&&!i);return i},t.prototype.copySelectionParagraphFormat=function(){var e=new ba;return this.paragraphFormat.copyToFormat(e),e},t.prototype.getHyperlinkDisplayText=function(e,t,i,n,r){var o=e;if(o!==i.line.paragraph)return{displayText:"<<Selection in Document>>",isNestedField:n=!0,format:r};for(var s="",l=o.childWidgets.indexOf(t.line),d=o.childWidgets[l].children.indexOf(t),h=l;h<o.childWidgets.length;h++){var c=o.childWidgets[h];h!==l&&(d=-1);for(var p=d+1;p<c.children.length;p++){var u=c.children[p];if(u===i)return{displayText:s,isNestedField:n,format:r};if(u instanceof Zl)s+=u.text,r=u.characterFormat;else{if(!(u instanceof _l))return{displayText:"<<Selection in Document>>",isNestedField:n=!0,format:r};u instanceof _l&&0===u.fieldType&&!(0,a.isNullOrUndefined)(u.fieldEnd)&&(d=(0,a.isNullOrUndefined)(u.fieldSeparator)?c.children.indexOf(u.fieldEnd):c.children.indexOf(u.fieldSeparator))}}}return{displayText:s,isNestedField:n,format:r}},t.prototype.navigateHyperLinkOnEvent=function(e,t){var i=this,n=this.documentHelper.getLineWidget(e);if(!(0,a.isNullOrUndefined)(n)){var r=this.getHyperLinkFieldInCurrentSelection(n,e);(0,a.isNullOrUndefined)(r)||(this.documentHelper.updateTextPositionForSelection(e,1),this.fireRequestNavigate(r),setTimeout((function(){i.viewer&&(i.documentHelper.isTouchInput=t,i.documentHelper.updateFocus(),i.documentHelper.isTouchInput=!1)})))}},t.prototype.getLinkText=function(e,t){var i=new dc(e,this),n=i.navigationLink,r=i.screenTip;return t?(i.localReference.length>0&&("_"!==i.localReference[0]||!(0,a.isNullOrUndefined)(n)&&0!==n.length?i.isCrossRef?n+=i.localReference:n+="#"+i.localReference:n="Current Document"),i.destroy(),n):(i.destroy(),r)},t.prototype.setHyperlinkContentToToolTip=function(e,t,i,n){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;this.toolTipElement||(this.toolTipElement=(0,a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement),this.screenTipElement=(0,a.createElement)("p"),this.toolTipElement.appendChild(this.screenTipElement),this.toolTipTextElement=(0,a.createElement)("p",{styles:"font-weight:bold"}),this.toolTipElement.appendChild(this.toolTipTextElement)),this.toolTipElement.style.display="block";var r=new a.L10n("documenteditor",this.owner.defaultLocale);r.setLocale(this.owner.locale);var o=r.getConstant("Click to follow link");this.owner.useCtrlClickToFollowHyperlink&&(o=this.documentHelper.isIosDevice?"Command+"+o:"Ctrl+"+o);var s=this.getScreenTipText(e);if(n){var l=e.formFieldData.helpText;if((0,a.isNullOrUndefined)(l)||""===l)return;this.screenTipElement.innerText=l}else this.screenTipElement.innerText=s,this.toolTipTextElement.innerText=o;var d=this.getTooltipPosition(e.line,i,this.toolTipElement,!1);this.showToolTip(d.x,d.y),(0,a.isNullOrUndefined)(this.toolTipField)||e===this.toolTipField||(this.toolTipObject.position={X:d.x,Y:d.y}),this.toolTipObject.show(),this.toolTipField=e}else this.hideToolTip()},t.prototype.getScreenTipText=function(e){var t=new dc(e,this);return t.screenTip||t.localReference?t.screenTip?t.screenTip:t.localReference:t.navigationLink},t.prototype.setFootnoteContentToToolTip=function(e,t,i){if(e){if("block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display&&this.owner.contextMenuModule)return;this.toolTipElement||(this.toolTipElement=(0,a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var n=new a.L10n("documenteditor",this.owner.defaultLocale);n.setLocale(this.owner.locale);var r=void 0;"Endnote"===e.footnoteType?r=n.getConstant("Click to View/Edit Endnote"):"Footnote"===e.footnoteType&&(r=n.getConstant("Click to View/Edit Footnote")),this.toolTipElement.innerHTML="<b>"+r+"</b>";var o=this.getTooltipPosition(e.line,i,this.toolTipElement,!1);this.showToolTip(o.x,o.y),(0,a.isNullOrUndefined)(this.toolTipField)||(this.toolTipObject.position={X:o.x,Y:o.y}),this.toolTipObject.show()}else this.hideToolTip()},t.prototype.setLockInfoTooptip=function(e,t,i){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;var n=this.toolTipElement;this.toolTipElement||(n=(0,a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(n),this.toolTipElement=n),n.style.display="block";var r=new a.L10n("documenteditor",this.owner.defaultLocale);r.setLocale(this.owner.locale);var o=r.getConstant("This region is locked by");n.innerHTML=o+" <b>"+i+"</b>";var s=this.getTooltipPosition(e,t,n,!1);this.showToolTip(s.x,s.y),(0,a.isNullOrUndefined)(this.toolTipField)||i===this.toolTipField||(this.toolTipObject.position={X:s.x,Y:s.y}),this.toolTipObject.show(),this.toolTipField=i}else this.hideToolTip()},t.prototype.getTooltipPosition=function(e,t,i,n){var r=this.getTop(e)*this.documentHelper.zoomFactor,o=this.getPage(e.paragraph),s=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,a=o.boundingRectangle.x+t*this.documentHelper.zoomFactor;a+i.clientWidth+10>s&&(a-=i.clientWidth-(s-a)+15);var l=n?0:i.offsetHeight,d=this.getPageTop(o)+(r-l);return d=d>this.documentHelper.viewerContainer.scrollTop?d:d+e.height+l,new Sa(a,d)},t.prototype.updateSelectionInfo=function(e){var t=this.selectedWidgets.keys;if(t[0]instanceof Vl&&t[t.length-1]instanceof Vl&&t.length>0){var i=t[0],n=t[t.length-1],r=i.ownerRow,o=n.ownerRow,s=r.getCell(r.rowIndex,void 0,0),a=this.owner.documentHelper.getFirstParagraphInCell(s);e.start=this.owner.documentHelper.selection.getHierarchicalIndex(a,"0");var l=o.getCell(o.rowIndex,void 0,o.childWidgets.length-1),d=this.getLastParagraph(l),h=this.getParagraphLength(d);e.end=this.owner.documentHelper.selection.getHierarchicalIndex(d,h.toString())}return e},t.prototype.createPasteElement=function(e,t){var i,n=new a.L10n("documenteditor",this.owner.defaultLocale);switch(n.setLocale(this.owner.locale),this.currentPasteAction){case"DefaultPaste":i=[{text:n.getConstant("Keep source formatting"),iconCss:"e-icons e-de-paste-source"},{text:n.getConstant("Match destination formatting"),iconCss:"e-icons e-de-paste-merge"},{text:n.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"TextOnly":i=[{text:n.getConstant("Text only"),iconCss:"e-icons e-de-paste-text"}];break;case"InsertAsColumns":case"OverwriteCells":case"InsertAsRows":if(i=[{text:n.getConstant("NestTable"),iconCss:"e-icons e-de-paste-nested-table"},{text:n.getConstant("InsertAsRows"),iconCss:"e-icons e-de-paste-row"}],"InsertAsColumns"===this.currentPasteAction){var r={text:n.getConstant("InsertAsColumns"),iconCss:"e-icons e-de-paste-column"};i.unshift(r)}else if("OverwriteCells"===this.currentPasteAction){r={text:n.getConstant("OverwriteCells"),iconCss:"e-icons e-de-paste-overwrite-cells"};i.splice(2,0,r)}}if(this.pasteElement)this.pasteDropDwn.items=i;else{this.pasteElement=(0,a.createElement)("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.pasteElement);var o=(0,a.createElement)("button",{id:this.owner.containerId+"_iconsplitbtn"});this.pasteElement.appendChild(o),this.pasteDropDwn=new pl.DropDownButton({items:i,iconCss:"e-icons e-de-paste",select:this.pasteOptions}),this.pasteDropDwn.appendTo(o)}this.pasteElement.style.display="block",this.pasteElement.style.position="absolute",this.pasteElement.style.left=t,this.pasteElement.style.top=e,this.pasteDropDwn.dataBind()},t.prototype.getContextBasedPasteOptions=function(e){var t=Pa.getSfdtDocument(e);!(0,a.isNullOrUndefined)(t.optimizeSfdt)&&t.optimizeSfdt?this.owner.editorModule.keywordIndex=1:this.owner.editorModule.keywordIndex=0;var i=[];this.owner.editorModule.getBlocks(t,!0,i,[],[],!0);var n=this.documentHelper.selection;if(n.start.paragraph.isInsideTable&&n.end.paragraph.isInsideTable){var r=!1;if(1===i.length){var o=i[0].childWidgets;o.length<3&&(1===o.length&&o[0]instanceof Al||2===o.length&&o[0]instanceof Al&&o[1].isEmpty())&&(r=!0)}if(r){var s=n.start.paragraph.associatedCell,l=n.end.paragraph.associatedCell;i[0].childWidgets[0];if(s.ownerTable.equals(l.ownerTable))return 0===n.start.paragraph.associatedCell.rowIndex&&0===n.end.paragraph.associatedCell.rowIndex&&s.equals(l)&&!this.isCellSelected(s,n.start,n.end)?["NewColumn","NestTable","NewRow"]:["NestTable","NewRow","OverwriteCells"]}}return["KeepSourceFormatting","MergeWithExistingFormatting","KeepTextOnly"]},t.prototype.showToolTip=function(e,t){this.toolTipObject||(this.toolTipObject=new el.Popup(this.toolTipElement,{height:"auto",width:"auto",relateTo:this.documentHelper.viewerContainer.parentElement,position:{X:e,Y:t}}))},t.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipObject&&(this.toolTipElement.style.display="none",this.toolTipObject.hide(),this.toolTipObject.destroy(),this.toolTipObject=void 0)},t.prototype.getHyperLinkFieldInCurrentSelection=function(e,t,i){var n=void 0,r=this.getTop(e),o=this.getLineStartLeft(e),s=Pa.convertPointToPixel(e.paragraph.paragraphFormat.leftIndent),l=Pa.convertPointToPixel(e.paragraph.paragraphFormat.rightIndent);if(!(t.y<r||t.y>r+e.height||t.x<o||t.x>o+e.paragraph.width+s+l)){var d=e.paragraph.x,h=this.getFirstElement(e,d);d=h.left;var c=h.element;if((0,a.isNullOrUndefined)(c)){var p=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=o+p||t.x>=o+p){var u=[],g=this.getHyperLinkFields(e.paragraph,u,!1,i);return u=[],u=void 0,g}}else{var m=e.renderedElements;if(t.x>d+c.margin.left)for(var f=m.indexOf(c);f<m.length&&(c=m[f],!(t.x<d+c.margin.left+c.width||f===m.length-1));f++)d+=c.margin.left+c.width;n=c;p=c.margin.left+c.width;if((0,a.isNullOrUndefined)(n.nextNode)&&(p+=this.documentHelper.textHelper.getParagraphMarkWidth(n.line.paragraph.characterFormat)),t.x<=d+p){u=[],g=this.getHyperLinkFieldInternal(n.line.paragraph,n,u,!1,i);return u=[],u=void 0,g}}}},t.prototype.getFootNoteElementInCurrentSelection=function(e,t){var i=void 0,n=this.getTop(e),r=this.getLineStartLeft(e);if(!(t.y<n||t.y>n+e.height||t.x<r||t.x>r+e.paragraph.width)){var o=e.paragraph.x,s=this.getFirstElement(e,o);o=s.left;var l=s.element;if((0,a.isNullOrUndefined)(l)){var d=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=r+d||t.x>=r+d){var h=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0).element;return h instanceof Yl?h:void 0}}else{if(t.x>o+l.margin.left)for(var c=e.children.indexOf(l);c<e.children.length&&(l=e.children[c],!(t.x<o+l.margin.left+l.width||c===e.children.length-1));c++)o+=l.margin.left+l.width;l instanceof Yl&&(i=l);d=l.margin.left+l.width;if((0,a.isNullOrUndefined)(l.nextNode)&&(d+=this.documentHelper.textHelper.getParagraphMarkWidth(l.line.paragraph.characterFormat)),t.x<=o+d)return i}}},t.prototype.getHyperlinkField=function(e){if(!(0,a.isNullOrUndefined)(this.end)){var t=0,i=this.documentHelper.selection,n=(i.start,i.end);i.isForward||(i.end,n=i.start);var r=this.end.currentWidget.getInline(n.offset,t);t=r.index;var o=r.element,s=[],l=void 0;if((0,a.isNullOrUndefined)(o))l=this.getHyperLinkFields(this.end.paragraph,s,e);else if(this.documentHelper.isFormFillProtectedMode&&o instanceof td&&o.previousNode instanceof _l&&1===o.previousNode.fieldType)l=void 0;else{var d=o.line.paragraph;l=this.getHyperLinkFieldInternal(d,o,s,e,!1)}return s=[],l}},t.prototype.getHyperLinkFields=function(e,t,i,n){for(var r=0;r<this.documentHelper.fields.length;r++)if(-1===t.indexOf(this.documentHelper.fields[r])&&!(0,a.isNullOrUndefined)(this.documentHelper.fields[r].fieldSeparator)){t.push(this.documentHelper.fields[r]);var o=this.getFieldCode(this.documentHelper.fields[r]);o=o.trim().toLowerCase();var s=this.paragraphIsInFieldResult(this.documentHelper.fields[r],e);if((i||!i&&o.match("hyperlink "))&&s)return this.documentHelper.fields[r];if(s&&n&&this.documentHelper.fields[r].formFieldData)return this.documentHelper.fields[r];if((i||!i&&o.match("ref "))&&s)return this.documentHelper.fields[r]}},t.prototype.getHyperLinkFieldInternal=function(e,t,i,n,r){for(var o=0;o<this.documentHelper.fields.length;o++)if(-1===i.indexOf(this.documentHelper.fields[o])&&!(0,a.isNullOrUndefined)(this.documentHelper.fields[o].fieldSeparator)){i.push(this.documentHelper.fields[o]);var s=this.getFieldCode(this.documentHelper.fields[o]);s=s.trim().toLowerCase();var l=this.documentHelper.fields[o],d=l.fieldEnd;n&&l.nextNode instanceof td&&l.nextNode.reference&&(d=l.nextNode.reference);var h=this.inlineIsInFieldResult(l,d,l.fieldSeparator,t,n)||this.isImageField();if((n||!n&&s.match("hyperlink "))&&h)return this.documentHelper.fields[o];if(h&&r&&this.documentHelper.fields[o].formFieldData)return this.documentHelper.fields[o];if((n||!n&&s.match("ref "))&&h)return this.documentHelper.fields[o]}if(e.containerWidget instanceof Ol&&!(e instanceof Bl))return this.getHyperLinkFieldInternal(e.containerWidget,t,i,n,r)},t.prototype.getBlock=function(e){if(""!==e&&!(0,a.isNullOrUndefined)(e)){var t={index:e},i=this.start.getPage(t),n=t.index.indexOf(";"),r=t.index.substring(0,n);t.index=t.index.substring(n).replace(";","");var o=i.bodyWidgets[parseInt(r,10)];return this.getBlockInternal(o,t.index)}},t.prototype.getBlockInternal=function(e,t){if(""!==t&&!(0,a.isNullOrUndefined)(t)){var i=t.indexOf(";"),n=t.substring(0,i);t=t.substring(i).replace(";","");var r=e;if(!((i=parseInt(n,10))>=0&&i<e.childWidgets.length))return r;var o=e.childWidgets[i];return t.indexOf(";")>=0?o instanceof Rl?(t.indexOf(";")>=0&&(t="0"),o):o instanceof Ll?this.getBlockInternal(o,t):r:o}},t.prototype.inlineIsInFieldResult=function(e,t,i,n,r){return!((0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(i)||!this.isExistBeforeInline(i,n))&&this.isExistAfterInline(t,n,r)},t.prototype.paragraphIsInFieldResult=function(e,t){if(!(0,a.isNullOrUndefined)(e.fieldEnd)&&!(0,a.isNullOrUndefined)(e.fieldSeparator)){var i=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===t||this.isExistBefore(i,t))return e.fieldEnd.line.paragraph!==t&&this.isExistAfter(i,t)}return!1},t.prototype.isImageField=function(){if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=0,n=e.paragraph.getInline(e.offset,i),r=n.element;(i=n.index)===r.length&&(r=this.getNextRenderedElementBox(r,i));var o=(n=t.paragraph.getInline(t.offset,i)).element;if(i=n.index,r instanceof _l&&0===r.fieldType&&o instanceof _l&&1===o.fieldType&&r.fieldSeparator){var s=r.fieldSeparator.nextNode;if(s instanceof gd&&s.nextNode===o)return!0}return!1},t.prototype.isFormField=function(){var e=this.currentFormField;return!!(e instanceof _l&&e.formFieldData)},t.prototype.isReferenceField=function(e){if((0,a.isNullOrUndefined)(e)&&(e=this.getHyperlinkField(!0)),e){var t=this.getFieldCode(e);if(t=t.toLowerCase(),e instanceof _l&&t.match("ref "))return!0}return!1},t.prototype.isInlineFormFillMode=function(e){return!!(this.documentHelper.isInlineFormFillProtectedMode&&(e=(0,a.isNullOrUndefined)(e)?this.currentFormField:e,(0,a.isNullOrUndefined)(e)&&(e=this.getCurrentFormField()),e&&e.formFieldData instanceof Gl&&"Text"===e.formFieldData.type))},t.prototype.getFormFieldType=function(e){if((0,a.isNullOrUndefined)(e)&&(e=this.currentFormField),e instanceof _l){if(e.formFieldData instanceof Gl)return"Text";if(e.formFieldData instanceof Kl)return"CheckBox";if(e.formFieldData instanceof Xl)return"DropDown"}},t.prototype.getCurrentFormField=function(e){var t;if(e||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)for(var i=0;i<this.documentHelper.formFields.length;i++){var n=this.documentHelper.formFields[i],r=this.start,o=this.end;if(this.isForward||(r=this.end,o=this.start),Pa.isLinkedFieldCharacter(n)){var s=n.fieldSeparator.line.getOffset(n.fieldSeparator,1),l=new ac(this.owner);l.setPositionParagraph(n.fieldSeparator.line,s);var d=n.fieldEnd;s=d.line.getOffset(d,0);var h=new ac(this.owner);if(h.setPositionParagraph(d.line,s),(r.isExistAfter(l)||r.isAtSamePosition(l))&&(o.isExistBefore(h)||o.isAtSamePosition(h))){t=n;break}}}else t=this.getHyperlinkField(!0);if(t instanceof _l&&0===t.fieldType&&!(0,a.isNullOrUndefined)(t.formFieldData))return t},t.prototype.getCurrentTextFrame=function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof cd)return e;e&&(e=e.containerWidget)}while(e);return null},t.prototype.isTableSelected=function(e){var t=this.start,i=this.end;if(this.isForward||(t=this.end,i=this.start),(0,a.isNullOrUndefined)(t.paragraph.associatedCell)||(0,a.isNullOrUndefined)(i.paragraph.associatedCell))return!1;var n=t.paragraph.associatedCell.ownerTable.getSplitWidgets(),r=this.getFirstBlockInFirstCell(n[0]),o=this.getLastBlockInLastCell(n[n.length-1]);if(e){for(var s=o.associatedCell.ownerTable;s.containerWidget instanceof Vl;)s=s.containerWidget.ownerTable;o=this.getLastBlockInLastCell(s)}return t.paragraph.associatedCell.equals(r.associatedCell)&&i.paragraph.associatedCell.equals(o.associatedCell)&&(!r.associatedCell.equals(o.associatedCell)||0===t.offset&&i.offset===this.getLineLength(o.lastChild)+1)},t.prototype.selectListText=function(){var e=this.documentHelper.selectionLineWidget.getHierarchicalIndex("0"),t=this.getTextPosition(e),i=this.getTextPosition(e);this.isSelectList=!0,this.selectRange(t,i),this.isSelectList=!1,this.highlightListText(this.documentHelper.selectionLineWidget),this.contextTypeInternal="List"},t.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.documentHelper.getLeftValue(e),n=e.paragraph.y;this.createHighlightBorder(e,t,i,n,!1),this.documentHelper.isListTextSelected=!0},t.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);var n=null,r=0,o=t.paragraph;if(o===i.paragraph&&t.offset+1===i.offset){var s=o.getInline(i.offset,r);n=s.element,r=s.index}if(n instanceof gd||n instanceof hd){var a=n.width,l=n.height,d=n.alternateText;if(n.width=e.width,n.height=e.height,n.alternateText=e.alternatetext,e.width=a,e.height=l,e.alternatetext=d,null!==o&&null!==o.containerWidget&&this.owner.editorModule){var h=o.childWidgets.indexOf(n.line),c=n.line.children.indexOf(n);this.documentHelper.layout.reLayoutParagraph(o,h,c),this.highlightSelection(!1)}}},t.prototype.getSelectedCellsInTable=function(e,t,i){for(var n=t.columnIndex,r=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,s=i.ownerRow.index,a=[],l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];if(d.index>=o&&d.index<=s)for(var h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];c.columnIndex>=n&&c.columnIndex<=r&&a.push(c)}if(d.index>s)break}return a},t.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},t.prototype.copySelectedContent=function(e){(0,a.isNullOrUndefined)(this.owner.sfdtExportModule)||(this.documentHelper.isCopying=!0,this.htmlContent=this.getHtmlContent(),this.copyToClipboard(),this.documentHelper.isCopying=!1,e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.owner.enableAutoFocus&&this.documentHelper.updateFocus())},t.prototype.writeSfdt=function(){var e=this.start,t=this.end;return this.isForward||(e=this.end,t=this.start),this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,e.currentWidget,e.offset,t.currentWidget,t.offset,!0)},t.prototype.getHtmlContent=function(){var e=this.writeSfdt();this.sfdtContent=JSON.stringify(e),this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(e));var t=this.owner.documentEditorSettings.optimizeSfdt;return this.htmlWriter.writeHtml(e,t)},t.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t,i=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&navigator.userAgent.indexOf("Macintosh")>-1&&navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome"),n=/Android|Windows Phone|iPhone|Trident|webOS/i.test(navigator.userAgent)||i,r=document.createElement("div");(r.style.left="-10000px",r.style.top="-10000px",r.style.position="relative",(0,a.isNullOrUndefined)(e)?i&&(r.innerText="copy"):r.innerHTML=e,n)?document.body.appendChild(r):((t=document.createElement("div")).attachShadow({mode:"open"}).appendChild(r),document.body.appendChild(t));void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")&&(r.contentEditable="true");var o=document.createRange();o.selectNodeContents(r),window.getSelection().addRange(o);var s=!1;try{s=document.execCommand("copy")}catch(e){}finally{window.getSelection().removeAllRanges(),r.parentNode.removeChild(r),n||t.parentNode.removeChild(t)}return s},t.prototype.onCopy=function(e){e.clipboardData&&!(0,a.isNullOrUndefined)(this.htmlContent)&&(e.clipboardData.clearData(),e.clipboardData.setData("text/html",this.htmlContent),e.clipboardData.setData("text/plain",this.text),e.clipboardData.setData("application/json",JSON.stringify(this.sfdtContent)),this.htmlContent=void 0,this.sfdtContent=void 0)},t.prototype.showCaret=function(){var e=(0,a.isNullOrUndefined)(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage;if(!((0,a.isNullOrUndefined)(e)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize)){var t,i=e.boundingRectangle.x;if(t=this.viewer instanceof kl?e.boundingRectangle.width*this.documentHelper.zoomFactor+i:e.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)if(this.isHideSelection(this.start.paragraph))this.caret.style.display="none";else if(this.isEmpty&&(!this.owner.isReadOnly||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())){var n=parseInt(this.caret.style.left.replace("px",""),10);this.caret.style.display=n<i||n>t?"none":"block"}else this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||(0,a.isNullOrUndefined)(this))&&(this.documentHelper.isComposingIME||(this.caret.style.display="none"));if((0,a.isNullOrUndefined)(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode)this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none";else{var r=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,o=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,s=this.getSelectionPage(this.start);s&&(this.documentHelper.touchEnd.style.display=o<i||o>t?"none":"block",this.isEmpty||(i=s.boundingRectangle.x,t=s.boundingRectangle.width*this.documentHelper.zoomFactor+i),this.documentHelper.touchStart.style.display=r<i||r>t?"none":"block")}}},t.prototype.setEditableDivCaretPosition=function(e){this.documentHelper.editableDiv.focus();var t=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];if(t){var i=document.createRange();i.setStart(t,e),i.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(i)}},t.prototype.initCaret=function(){this.caret=(0,a.createElement)("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.caret.style.display="none",this.owner.documentHelper.viewerContainer.appendChild(this.caret)},t.prototype.updateCaretPosition=function(){var e=this.end.location,t=this.getSelectionPage(this.end);if(t&&!(0,a.isNullOrUndefined)(this.caret)){var i=t.boundingRectangle.x+Math.round(e.x)*this.documentHelper.zoomFactor+"px";this.caret.style.left=i;var n=this.updateCaretSize(this.owner.selectionModule.end),r=n.topMargin,o=this.viewer,s=(t.boundingRectangle.y-o.pageGap*(this.documentHelper.pages.indexOf(t)+1))*this.documentHelper.zoomFactor+o.pageGap*(this.documentHelper.pages.indexOf(t)+1),l=s;this.caret.style.top=l+Math.round(e.y+r)*this.documentHelper.zoomFactor+"px","Subscript"===this.owner.selectionModule.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),(this.documentHelper.isTouchInput||"none"!==this.documentHelper.touchStart.style.display)&&(this.documentHelper.touchStart.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=l+(e.y+n.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=l+(e.y+n.height)*this.documentHelper.zoomFactor+"px"),a.Browser.isDevice&&(this.documentHelper.editableDiv.style.left=i+"px",this.documentHelper.editableDiv.style.top=s+"px")}this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},t.prototype.showHidePasteOptions=function(e,t){if(!a.Browser.isIE)if(this.isViewPasteOptions){if(this.pasteElement&&"block"===this.pasteElement.style.display)return;this.createPasteElement(e,t)}else this.pasteElement&&(this.pasteElement.style.display="none",(0,a.isNullOrUndefined)(this.owner.editorModule)||(this.owner.editorModule.isHtmlPaste=!1))},t.prototype.getRect=function(e){var t=e.location,i=this.getSelectionPage(e);if(i){var n=this.owner.documentHelper,r=i.boundingRectangle.x+Math.round(t.x)*n.zoomFactor,o=this.viewer.pageGap,s=(i.boundingRectangle.y-o*(i.index+1))*n.zoomFactor+o*(i.index+1)+Math.round(t.y)*n.zoomFactor;return new Sa(r,s)}return new Sa(0,0)},t.prototype.getSelectionPage=function(e){var t=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(t)return this.getPage(t.paragraph)},t.prototype.updateCaretSize=function(e,t){var i,n=0,r=!1,o=0,s=0;if(this.characterFormat.italic&&(r=this.characterFormat.italic),e.paragraph.isEmpty()){var l=e.paragraph,d=0,h=this.getParagraphMarkSize(l,n,d);n=h.topMargin,d=h.bottomMargin;var c=h.height,p=this.characterFormat.baselineAlignment,u=c;"Normal"!==p&&(u/=1.5,"Subscript"===p&&(n=c-u)),s=n<0?n+u:u,t||(this.caret.style.height=s*this.documentHelper.zoomFactor+"px"),n=0}else{var g=e.currentWidget.getInline(e.offset,o);o=g.index;var m=g.element;(0,a.isNullOrUndefined)(m)||(s=(i=this.getCaretHeight(m,o,m.characterFormat,!0,n,r)).height,t||(this.caret.style.height=i.height*this.documentHelper.zoomFactor+"px"))}return t||(this.caret.style.transform=r?"rotate(13deg)":""),{topMargin:n,height:s}},t.prototype.updateCaretToPage=function(e,t){if(!(0,a.isNullOrUndefined)(t))if(this.documentHelper.selectionEndPage=t,this.owner.selectionModule.isEmpty)this.documentHelper.selectionStartPage=t;else{var i=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),n=this.getPage(i.paragraph);(0,a.isNullOrUndefined)(n)||(this.documentHelper.selectionStartPage=n)}this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.getCaretBottom=function(e,t){var i=e.location.y;if(e.paragraph.isEmpty()){var n=e.paragraph,r=0,o=0,s=this.getParagraphMarkSize(n,r,o);r=s.topMargin,o=s.bottomMargin,i+=s.height,i+=r,t||(i+=o)}else{var a=0,l=e.paragraph.getInline(e.offset,a),d=l.element;a=l.index;r=0;var h=!1,c=this.getCaretHeight(d,a,d.characterFormat,!1,r,h);r=c.topMargin,h=c.isItalic,i+=c.height,t&&(i-=Pa.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)))}return i},t.prototype.checkForCursorVisibility=function(){this.showCaret()},t.prototype.onKeyDownInternal=function(e,t,i,n){var r=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||n)if(!i||t||n)if(i&&t&&!n)switch(r){case 32:this.owner.editorModule.insertText(String.fromCharCode(160));break;case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey();break;case 56:this.owner.toggleShowHiddenMarksInternal()}else switch(r){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(this.documentHelper.isCompleted=!1,r){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,r){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selectionModule.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),(0,a.isNullOrUndefined)(this.owner.optionsPaneModule)||(this.owner.documentEditorSettings.showNavigationPane=!0,this.owner.optionsPaneModule.showHideOptionsPane(!0))}if(this.isFormField()&&!this.documentHelper.isDocumentProtected){var o=this.getCurrentFormField(!0);if(o&&o.formFieldData instanceof Xl){o=37===e.keyCode||38===e.keyCode||40===e.keyCode?o:o.nextElement instanceof td?o.nextElement.reference:o.fieldEnd;var s=39===e.keyCode?1:0,l=o.line.getOffset(o,s),d=this.getPhysicalPositionInternal(o.line,l,!1);this.selectInternal(o.line,o,s,d)}}!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode||this.isInlineFormFillMode()||this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.owner.editor.canEditContentControl&&!(0,a.isNullOrUndefined)(this.documentHelper.selection)&&this.documentHelper.selection.checkContentControlLocked()?this.owner.editorModule.onKeyDownInternal(e,t,i,n):this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9!==e.keyCode&&32!==e.keyCode||this.owner.editorModule.onKeyDownInternal(e,t,i,n)),this.owner.searchModule&&!(0,a.isNullOrUndefined)(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear(),27!==e.keyCode&&27!==e.which||((0,a.isNullOrUndefined)(this.owner.optionsPaneModule)||(this.owner.optionsPaneModule.showHideOptionsPane(!1),this.documentHelper.updateFocus()),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},t.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget,i);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget,i)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},t.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&this.viewer instanceof kl||this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width},t.prototype.isCursorInHeaderRegion=function(e,t){if(this.viewer instanceof kl){var i=this.getPageTop(t),n=0,r=t.headerWidget;r&&(n=r.y+r.height);var o=r.isEmpty&&!this.owner.enableHeaderAndFooter,s=Pa.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin),a=Pa.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageHeight),l=o?s:Math.min(Math.max(n,s),a/100*40);if(l*=this.documentHelper.zoomFactor,this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+l)return!0}return!1},t.prototype.isCursorInFooterRegion=function(e,t){if(this.viewer instanceof kl){var i=t.boundingRectangle,n=this.getPageTop(t),r=n+i.height*this.documentHelper.zoomFactor,o=Pa.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),s=0;t.footerWidget&&(s=t.footerWidget.height);var a=Pa.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin),l=t.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter,d=i.height;if(d=l?(d-a)*this.documentHelper.zoomFactor:(d-Math.min(i.height/100*40,Math.max(s+o,a)))*this.documentHelper.zoomFactor,this.viewer.containerTop+e.y<=r&&this.viewer.containerTop+e.y>=n+d)return!0}return!1},t.prototype.enableHeadersFootersRegion=function(e,t){return this.viewer instanceof kl&&(this.owner.enableHeaderAndFooter=!0,e.page=t,this.comparePageWidthAndMargins(e,t),this.updateTextPositionForBlockContainer(e),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},t.prototype.disableXml=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},t.prototype.comparePageWidthAndMargins=function(e,t){var i,n=-1!=e.headerFooterType.indexOf("Header"),r=!1;if(i=n?t.headerWidgetIn:t.footerWidgetIn,!(0,a.isNullOrUndefined)(i)){var o=e.sectionFormat,s=i.sectionFormat;(0,a.isNullOrUndefined)(o)||(0,a.isNullOrUndefined)(s)||(n?e.width==i.width&&o.headerDistance==s.headerDistance||(r=!0):e.width==i.width&&o.footerDistance==s.footerDistance||(r=!0)),r&&(this.owner.viewer.updateHFClientArea(e.sectionFormat,n),e=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,e))}},t.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var e=0;e<this.documentHelper.headersFooters.length;e++){var t=this.documentHelper.headersFooters[e],i=this.getBodyWidgetInternal(e,0);if(!(0,a.isNullOrUndefined)(i))for(var n=i.sectionFormat,r=0,o=Object.keys(t);r<o.length;r++){var s=t[o[r]];s.isEmpty&&this.owner.editorModule.shiftPageContent(s.headerFooterType,n)}}},t.prototype.updateTextPositionForBlockContainer=function(e){var t=e.firstChild;t instanceof Al&&(t=this.getFirstBlockInFirstCell(t))instanceof Al&&(t=this.getFirstBlockInFirstCell(t)),this.selectParagraphInternal(t,!0)},t.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},t.prototype.clear=function(){this.editRegionHighlighters&&this.editRegionHighlighters.clear(),this.editRangeCollection=[],this.selectedWidgets&&this.selectedWidgets.clear(),this.contentControleditRegionHighlighters&&this.contentControleditRegionHighlighters.clear(),this.contentControls=[],this.currentContentControl=void 0},t.prototype.destroy=function(){(0,a.isNullOrUndefined)(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.pasteDropDwn&&(this.pasteDropDwn.destroy(),this.pasteDropDwn=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.owner=void 0,this.upDownSelectionLength=void 0,this.isSkipLayouting=void 0,this.isImageSelected=void 0,(0,a.isNullOrUndefined)(this.documentHelper)||(this.documentHelper=void 0),this.contextTypeInternal=void 0,this.isRetrieveFormatting=void 0,this.characterFormatIn&&this.characterFormatIn.destroy(),this.characterFormatIn=void 0,this.paragraphFormatIn&&this.paragraphFormatIn.destroy(),this.paragraphFormatIn=void 0,this.sectionFormatIn&&this.sectionFormatIn.destroy(),this.sectionFormatIn=void 0,this.tableFormatIn&&this.tableFormatIn.destroy(),this.tableFormatIn=void 0,this.cellFormatIn&&this.cellFormatIn.destroy(),this.cellFormatIn=void 0,this.rowFormatIn&&this.rowFormatIn.destroy(),this.rowFormatIn=void 0,this.imageFormatInternal=void 0,this.skipFormatRetrieval=void 0,this.startInternal=void 0,this.endInternal=void 0,this.htmlWriterIn=void 0,this.toolTipElement=void 0,(0,a.isNullOrUndefined)(this.toolTipObject)||this.toolTipObject.destroy(),this.toolTipField=void 0,this.isMoveDownOrMoveUp=void 0,this.pasteElement=void 0,this.currentPasteAction=void 0,this.isViewPasteOptions=void 0,this.skipEditRangeRetrieval=void 0,this.editPosition=void 0,(0,a.isNullOrUndefined)(this.selectedWidgets)||this.selectedWidgets.destroy(),this.isHighlightEditRegionIn=void 0,this.isHighlightFormFields=void 0,this.editRangeCollection=[],this.editRangeCollection=void 0,this.isHightlightEditRegionInternal=void 0,this.isCurrentUser=void 0,this.isHighlightNext=void 0,this.hightLightNextParagraph=void 0,this.isWebLayout=void 0,(0,a.isNullOrUndefined)(this.editRegionHighlighters)||this.editRegionHighlighters.destroy(),(0,a.isNullOrUndefined)(this.formFieldHighlighters)||this.formFieldHighlighters.destroy(),(0,a.isNullOrUndefined)(this.contentControleditRegionHighlighters)||this.contentControleditRegionHighlighters.destroy(),this.isCellPrevSelected=void 0,this.currentFormField=void 0,this.contentControls=[]},t.prototype.getCellsToSelect=function(e,t,i,n){var r=e.childWidgets;if(!((0,a.isNullOrUndefined)(n.paragraph.associatedCell)||!(0,a.isNullOrUndefined)(n.reference)&&(0,a.isNullOrUndefined)(n.reference.paragraph.associatedCell))){for(var o=n.paragraph.associatedCell.ownerRow.rowIndex,s=n.reference.paragraph.associatedCell.ownerRow.rowIndex,l=[],d=o;d<=s;d++)for(var h=r[d],c=t;c<=i;c++){var p=h.childWidgets[c];(0,a.isNullOrUndefined)(p)||l.push(p)}return l}},t.prototype.selectBookmarkInTable=function(e){this.documentHelper.clearSelectionHighlight();var t=parseInt(e.properties.columnFirst),i=parseInt(e.properties.columnLast),n=e.paragraph.associatedCell.ownerTable,r=this.getCellsToSelect(n,t,i,e);if(!(0,a.isNullOrUndefined)(r))for(var o=0;o<r.length;o++)this.highlightCellWidget(r[o])},t.prototype.navigateBookmark=function(e,t,i){var n=this.documentHelper.bookmarks;if(n.containsKey(e)){var r=n.get(e);if((0,a.isNullOrUndefined)(r.properties)){var o=r.line.getOffset(r,0);i&&o++;var s=new ac(this.owner);if(s.setPositionParagraph(r.line,o),t)this.documentHelper.selection.selectRange(s,s,!0);else{var l=r.reference;r.reference&&null==r.reference.line.paragraph.bodyWidget&&(l=r);var d=l.line.getOffset(l,1);l instanceof td&&!i&&((0,a.isNullOrUndefined)(l.properties)||l.properties.isAfterParagraphMark&&(d=l.line.getOffset(l,1))),i&&d--;var h=new ac(this.owner);h.setPositionParagraph(l.line,d),this.documentHelper.selection.selectRange(s,h,!0)}}else this.selectBookmarkInTable(r)}},t.prototype.selectBookmark=function(e,t){this.isSelectBookmark=!0,this.isExcludeBookmarkStartEnd=t,this.navigateBookmark(e,void 0,t),this.isSelectBookmark=!1},t.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)t=e,e=e.previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},t.prototype.isTocStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},t.prototype.isTOC=function(){for(var e=this.getParagraphInfo(this.start).paragraph,t=0;t<e.childWidgets[0].children.length;t++){var i=e.childWidgets[0].children[t];if(i instanceof _l){var n=this.owner.selectionModule.getFieldCode(i);if(n.match("TOC ")||n.match("Toc"))return!0}}return!1},t.prototype.getElementsForward=function(e,t,i,n){if(!(0,a.isNullOrUndefined)(t)){for(var r=[],o=e.children.indexOf(t);o>=0;){for(var s=o;s<e.children.length;s++){var l=e.children[s];if(l.line!==e){o=-1;break}if(l===i){r.push(l),o=-1;break}r.push(l)}o=-1}return 0===r.length?void 0:r}},t.prototype.getElementsBackward=function(e,t,i,n){for(var r=[];n&&t&&t.previousElement&&(!t.isRightToLeft||t instanceof Zl&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(var o=e.children.indexOf(t);o>=0;){for(var s=o;s>-1&&s<e.children.length;n?s++:s--){var a=e.children[s];if(a.line!==e){o=-1;break}if(r.push(a),a===i){o=-1;break}}o=-1}return r},t.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},t.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},t.prototype.commentNavigateInternal=function(e){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}if(this.documentHelper.currentSelectedComment){var t=this.documentHelper.comments,i=this.documentHelper.currentSelectedComment,n=t.indexOf(i);i=e?n===t.length-1?t[0]:t[n+1]:0===n?t[t.length-1]:t[n-1],this.documentHelper.currentSelectedComment=i,this.selectComment(i)}},t.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},t.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},t.prototype.revisionNavigateInternal=function(e){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}if(this.documentHelper.currentSelectedRevision){var t=this.documentHelper.owner.revisions.changes,i=this.documentHelper.currentSelectedRevision,n=t.indexOf(i);i=e?n===t.length-1?t[0]:t[n+1]:0===n?t[t.length-1]:t[n-1],this.documentHelper.currentSelectedRevision=i,this.selectRevision(i)}this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},t.prototype.selectComment=function(e){if(!(0,a.isNullOrUndefined)(e)){var t=this.getElementPosition(e.commentStart,!0).startPosition,i=this.getElementPosition(e.commentEnd,!1).startPosition;this.owner.commentReviewPane&&this.owner.commentReviewPane.selectComment(e),this.selectPosition(t,i)}},t.prototype.selectRevision=function(e,t,i){var n=!1;if((0,a.isNullOrUndefined)(t)&&(0,a.isNullOrUndefined)(i)&&(n=!0),!(0,a.isNullOrUndefined)(e)&&e.range.length>0){var r=e.range[0],o=e.range[e.range.length-1],s=void 0;if(r instanceof ka?s=r.ownerBase:r instanceof Ca||(s=r.line.paragraph),!(0,a.isNullOrUndefined)(s)&&!(0,a.isNullOrUndefined)(s.bodyWidget)&&s.bodyWidget instanceof Bl&&((0,a.isNullOrUndefined)(s.bodyWidget.page)||!(0,a.isNullOrUndefined)(s.bodyWidget.page)&&-1===s.bodyWidget.page.index))return;if(r instanceof Ca){var l=r.ownerBase,d=l.childWidgets[0],h=l.childWidgets[l.childWidgets.length-1],c=this.getFirstParagraph(d),p=this.getLastParagraph(h);this.start.setPosition(c.firstChild,!0),this.end.setPositionParagraph(p.lastChild,p.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}else if(r&&o){(0,a.isNullOrUndefined)(t)&&(t=new ac(this.owner));var u=0;if(r instanceof ka){u=(f=r.ownerBase).childWidgets.length>1?this.getParagraphLength(f)-this.getParagraphLength(f,f.lastChild):this.isEmptyWidget(f)?0:f.getLength(),t.setPositionParagraph(f.lastChild,u)}else{u=r.line.getOffset(r,0);var g=r.line;if(g.isFirstLine())for(var m=0;m<g.children.length;m++){if(r===g.children[m]&&g.children[m]instanceof Zl&&!(g.children[m]instanceof Yl)){u=0;break}if(g.children[m]instanceof Zl)break}t.setPositionForLineWidget(r.line,u)}if((0,a.isNullOrUndefined)(i)&&(i=new ac(this.owner)),o instanceof ka){var f,v=(f=o.ownerBase).getSplitWidgets();((f=v[v.length-1]).isEndsWithPageBreak||f.isEndsWithColumnBreak)&&(this.owner.trackChangesPane.isTrackingPageBreak=!0),u=f.childWidgets.length>1?this.getParagraphLength(f)-this.getParagraphLength(f,f.lastChild):f.getLength(),i.setPositionParagraph(f.lastChild,u+1)}else u=o.line.getOffset(o,0)+o.length,this.isTOC()&&(u+=1),i.setPositionForLineWidget(o.line,u);var y=t.clone();t.isExistBefore(i)||(t=i,i=y),n&&this.selectPosition(t,i)}}},t.prototype.isEmptyWidget=function(e){if(e instanceof Al)return!1;if(e.isEmpty())return!0;for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],n=0;n<i.children.length;n++)if(i.children[n]instanceof Zl)return!1;return!0},t.prototype.selectTableRevision=function(e){if(!(0,a.isNullOrUndefined)(e)&&e[0].range.length>0){var t=e[0].range[0],i=e[e.length-1].range[0];if(t instanceof Ca){var n=t.ownerBase.childWidgets[0],r=i.ownerBase,o=r.childWidgets[r.childWidgets.length-1],s=this.getFirstParagraph(n),l=this.getLastParagraph(o);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(l.lastChild,l.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}}},t.prototype.updateEditRangeCollection=function(){var e,t;if(this.editRangeCollection.length>0&&(this.editRangeCollection=[]),this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){e=this.documentHelper.editRanges.get(this.owner.currentUser);for(r=0;r<e.length;r++)(0,a.isNullOrUndefined)(e[r].editRangeEnd)||this.editRangeCollection.push(e[r])}if(this.documentHelper.editRanges.containsKey("Everyone")){n="Everyone";t=this.documentHelper.editRanges.get(n);for(r=0;r<t.length;r++)(0,a.isNullOrUndefined)(t[r].editRangeEnd)||this.editRangeCollection.push(t[r])}}else for(var i=0;i<this.documentHelper.editRanges.length;i++){var n=this.documentHelper.editRanges.keys[i];e=this.documentHelper.editRanges.get(n);for(var r=0;r<e.length;r++)(0,a.isNullOrUndefined)(e[r].editRangeEnd)||this.editRangeCollection.push(e[r])}},t.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion(),this.viewer.renderVisiblePages()},t.prototype.onHighlightContentControl=function(){if(this.isHighlightContentControlEditRegion&&this.documentHelper.contentControlCollection.length>0)for(var e=0;e<this.documentHelper.contentControlCollection.length;e++)this.documentHelper.contentControlCollection[e].paragraph.isInHeaderFooter&&"Continuous"===this.documentHelper.owner.layoutType||this.documentHelper.contentControlCollection[e].line.paragraph.bodyWidget.page&&this.documentHelper.contentControlCollection[e].line.paragraph.bodyWidget.page.documentHelper&&this.highlightContentControlEditRegionInternal(this.documentHelper.contentControlCollection[e])},t.prototype.highlightContentControlEditRegionInternal=function(e){var t=this.getPosition(e);if(!(0,a.isNullOrUndefined)(t.startPosition)&&!(0,a.isNullOrUndefined)(t.endPosition)){var i=t.startPosition,n=t.endPosition;this.highlight(e.line.paragraph,i,n,e);for(var r=e.line.paragraph;r!==n.paragraph;){if(!(r.nextRenderedWidget instanceof Rl))return;r=r.nextRenderedWidget,this.highlight(r,i,n,e)}}},t.prototype.selectPlaceHolderText=function(e){e.contentControlProperties&&e.contentControlProperties.hasPlaceHolderText&&("RichText"===e.contentControlProperties.type||"Text"===e.contentControlProperties.type)&&this.selectContentControlInternal(e)},t.prototype.isPlainContentControl=function(){var e=this.owner.editorModule.getContentControl();return!(!e||!e.contentControlProperties||"Text"!==e.contentControlProperties.type)},t.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.owner.enableLockAndEdit)this.viewer.updateScrollBars();else if(this.isHighlightEditRegion){this.isHightlightEditRegionInternal=!0,(0,a.isNullOrUndefined)(this.editRegionHighlighters)&&(this.editRegionHighlighters=new l),this.editRegionHighlighters.clear();for(var e=0;e<this.editRangeCollection.length;e++)this.highlightEditRegionInternal(this.editRangeCollection[e]);this.isHightlightEditRegionInternal=!1,this.viewer.updateScrollBars()}else this.unHighlightEditRegion()},t.prototype.highlightFormFields=function(){(0,a.isNullOrUndefined)(this.formFieldHighlighters)&&(this.formFieldHighlighters=new l),this.formFieldHighlighters.clear();var e=this.documentHelper.formFields;if(!(0,a.isNullOrUndefined)(e)&&e.length>0){for(var t=0;t<e.length;t++){var i=e[t];if(Pa.isLinkedFieldCharacter(i)){var n=i.line.getOffset(i,0),r=new ac(this.owner);r.setPositionParagraph(i.line,n);var o=i.fieldEnd;n=o.line.getOffset(o,1);var s=new ac(this.owner);s.setPositionParagraph(o.line,n),this.isHighlightFormFields=!0,this.highlight(r.paragraph,r,s),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,r,s),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}}this.isHighlightFormFields=!1,this.viewer.updateScrollBars()}},t.prototype.unHighlightEditRegion=function(){(0,a.isNullOrUndefined)(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0),this.isHightlightEditRegionInternal=!1},t.prototype.highlightEditRegionInternal=function(e){var t=this.getPosition(e),i=t.startPosition,n=t.endPosition;this.isCurrentUser=!0,this.highlightEditRegions(e,i,n),this.isCurrentUser=!1},t.prototype.showAllEditingRegion=function(){0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight();for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),n=i.startPosition,r=i.endPosition;this.highlightEditRegions(t,n,r)}},t.prototype.highlightEditRegions=function(e,t,i){if(!e.line.paragraph.isInsideTable||e.line.paragraph.isInsideTable&&!e.editRangeEnd.line.paragraph.isInsideTable||-1===e.columnFirst)this.highlight(e.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);else{var n=e.line.paragraph.associatedCell.ownerRow.childWidgets[e.columnFirst];if(n)for(var r=0;r<n.childWidgets.length;r++)n.childWidgets[r]instanceof Rl&&(this.highlight(n.childWidgets[r],t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0))}},t.prototype.navigateToNextEditingRegion=function(){var e=this.getEditRangeStartElement(!0);if(this.editRangeCollection.length>0){this.sortEditRangeCollection();var t=this.editRangeCollection.length,i=t;(0,a.isNullOrUndefined)(e)||(i=this.editRangeCollection.indexOf(e));var n=i<t-1?this.editRangeCollection[i+1]:this.editRangeCollection[0],r=this.getPosition(n,!0),o=r.startPosition,s=r.endPosition;this.selectRange(o,s)}},t.prototype.sortEditRangeCollection=function(){for(var e=this.editRangeCollection.length-1;e>=0;e--)for(var t=1;t<=e;t++){var i=this.getPosition(this.editRangeCollection[t-1]).startPosition,n=this.getPosition(this.editRangeCollection[t]).startPosition;if(i.isExistAfter(n)){var r=this.editRangeCollection[t-1];this.editRangeCollection[t-1]=this.editRangeCollection[t],this.editRangeCollection[t]=r}}},t.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},t.prototype.getEditRangeStartElement=function(e){for(var t=0;t<this.editRangeCollection.length;t++){var i=this.editRangeCollection[t],n=this.getPosition(i,e),r=n.startPosition,o=n.endPosition;if((this.start.isExistAfter(r)||this.start.isAtSamePosition(r))&&(this.end.isExistBefore(o)||this.end.isAtSamePosition(o)))return i}},t.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},t.prototype.checkSelectionIsAtEditRegion=function(e,t){if((0,a.isNullOrUndefined)(e)&&(0,a.isNullOrUndefined)(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start)),this.editRangeCollection.length>0&&this.isFootEndNoteParagraph(e.paragraph)&&this.isFootEndNoteParagraph(t.paragraph)&&e.paragraph.containerWidget==t.paragraph.containerWidget){var i=this.getElementPosition(e.paragraph.containerWidget.footNoteReference,!0).startPosition;e=i,t=i}for(var n=0;n<this.editRangeCollection.length;n++){var r=this.editRangeCollection[n];if(!r.line.paragraph.isInsideTable||r.line.paragraph.isInsideTable&&!r.editRangeEnd.line.paragraph.isInsideTable||-1===r.columnFirst){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(r.paragraph.isInsideTable&&r.editRangeEnd&&r.editRangeEnd.line.paragraph.isInsideTable){var o=r.paragraph.associatedCell.ownerRow,s=e.paragraph.associatedCell,l=t.paragraph.associatedCell;if(!(0,a.isNullOrUndefined)(s)&&!(0,a.isNullOrUndefined)(l)&&o.equals(s.ownerRow)&&o.equals(l.ownerRow)&&s.index>=r.columnFirst&&s.index<=r.columnLast)if(this.isEmpty&&s.index===r.line.paragraph.associatedCell.index){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(!this.isCellSelected(s,e,t))return!0}}return!1},t.prototype.isEditRangeCellSelected=function(e,t){(0,a.isNullOrUndefined)(e)&&(0,a.isNullOrUndefined)(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var i=0;i<this.editRangeCollection.length;i++){var n=this.editRangeCollection[i];if(n.paragraph.isInsideTable&&n.editRangeEnd&&n.editRangeEnd.line.paragraph.isInsideTable){var r=e.paragraph.associatedCell,o=t.paragraph.associatedCell,s=n.paragraph.associatedCell;if(!(0,a.isNullOrUndefined)(r)&&!(0,a.isNullOrUndefined)(o)&&r.index>=n.columnFirst&&r.index<=n.columnLast&&this.isCellSelected(s,e,t))return!0}}return!1},t.prototype.isSelectionInsideEditRange=function(e,t,i){var n=this.getPosition(e),r=n.startPosition,o=n.endPosition;return!(!t.isExistAfter(r)&&!t.isAtSamePosition(r)||!i.isExistBefore(o)&&!i.isAtSamePosition(o))},t.prototype.getPosition=function(e,t){var i,n,r=e.line.getOffset(e,1),o=new ac(this.owner);if(o.setPositionParagraph(e.line,r),e instanceof vd?i=e.editRangeEnd:e instanceof id||e instanceof td?i=e.reference:e instanceof Bd&&(i=e.comment.commentEnd),i){var s=i.line;(0,a.isNullOrUndefined)(i.line)||(0,a.isNullOrUndefined)(s.children)?n=o.clone():(r=i.line.getOffset(i,t||i instanceof id&&this.isSelectionisInCC?0:1),(n=new ac(this.owner)).setPositionParagraph(i.line,r))}return{startPosition:o,endPosition:n}},t.prototype.checkContentControlLocked=function(e){this.owner.editorModule.isXmlMapped=!1,this.isSelectionisInCC=!0;for(var t=0;t<this.documentHelper.contentControlCollection.length;t++){var i=this.documentHelper.contentControlCollection[t];if(!(0,a.isNullOrUndefined)(i.reference)&&-1!==i.reference.indexInOwner){var n=this.getPosition(i),r=n.startPosition,o=n.endPosition,s=this.start,l=this.end;if(this.isForward||(s=this.end,l=this.start),(0,a.isNullOrUndefined)(e)){var d=(r.isExistAfter(s)||r.isAtSamePosition(s))&&(r.isExistBefore(l)||r.isAtSamePosition(l)),h=(o.isExistAfter(s)||o.isAtSamePosition(s))&&(o.isExistBefore(l)||o.isAtSamePosition(l));if(d&&h)return!(!i.contentControlProperties.lockContentControl&&!this.documentHelper.isFormFillProtectedMode)&&(this.owner.trigger(S),!0);if((d||h)&&!r.isAtSamePosition(s)&&!o.isAtSamePosition(s)&&(i.contentControlProperties.lockContentControl||i.contentControlProperties.lockContents))return!0}if(e){d=(r.isExistAfter(s)||r.isAtSamePosition(s))&&(r.isExistBefore(l)||r.isAtSamePosition(l)),h=(o.isExistAfter(s)||o.isAtSamePosition(s))&&(o.isExistBefore(l)||o.isAtSamePosition(l));if(d&&h)return!!i.contentControlProperties.lockContents&&(this.owner.trigger(S),!0);if((d||h)&&!r.isAtSamePosition(s)&&!o.isAtSamePosition(s)&&i.contentControlProperties.lockContents)return!0}if((s.isExistAfter(r)||s.isAtSamePosition(r))&&(l.isExistBefore(o)||l.isAtSamePosition(o))){if(i.contentControlProperties.xmlMapping&&i.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),i.contentControlProperties.lockContents)return this.owner.trigger(S),!0;if((0,a.isNullOrUndefined)(e)&&("CheckBox"===i.contentControlProperties.type||"ComboBox"===i.contentControlProperties.type||"DropDownList"===i.contentControlProperties.type||"Date"===i.contentControlProperties.type||"Picture"===i.contentControlProperties.type||"Text"===i.contentControlProperties.type||"RichText"===i.contentControlProperties.type))return this.owner.trigger(S),!0}}}return!1},t.prototype.getElementPosition=function(e,t){var i=e.line.getOffset(e,t?0:1),n=new ac(this.owner);return n.setPositionParagraph(e.line,i),{startPosition:n,endPosition:void 0}},t.prototype.updateRefField=function(e){if((0,a.isNullOrUndefined)(e)&&(e=this.getHyperlinkField(!0)),!(0,a.isNullOrUndefined)(e)){if(!this.isReferenceField(e))return;var t=this.getFieldCode(e).replace(/\s+/g," ");if(0===(t=t.trim()).toLowerCase().indexOf("ref")){var i=t.split(" ");if(i.length>1){var n=i[1];if(this.documentHelper.bookmarks.containsKey(n)){var r=this.start,o=this.end;this.isForward||(r=this.end,o=this.start);var s=this.documentHelper.bookmarks.get(n),l=s.reference,d=s.previousNode;!(0,a.isNullOrUndefined)(d)&&d instanceof _l||!l||!(l.previousNode instanceof _l)||1!==l.previousNode.fieldType||(0,a.isNullOrUndefined)(l.previousNode.fieldBegin)||(0,a.isNullOrUndefined)(l.previousNode.fieldBegin.formFieldData)?d instanceof _l&&0===d.fieldType&&!(0,a.isNullOrUndefined)(d.formFieldData)&&(s=d.fieldSeparator,l=d.fieldEnd):(s=l.previousNode.fieldBegin.fieldSeparator,l=l.previousNode.fieldBegin.fieldEnd);var h=s.line.getOffset(s,1);r.setPositionParagraph(s.line,h),o.setPositionParagraph(l.line,l.line.getOffset(l,0));var c=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,r.currentWidget,r.offset,o.currentWidget,o.offset,!1,!0),p=e.fieldSeparator,u=e.fieldEnd;r.setPositionParagraph(p.line,p.line.getOffset(p,1)),o.setPositionParagraph(u.line,u.line.getOffset(u,0)),this.owner.editorModule.pasteContents(c)}}}}},t.prototype.footnoteReferenceElement=function(e,t,i){var n=0;if(this.getContainerWidget(e.paragraph)instanceof Dl)for(var r=this.start.paragraph.bodyWidget.footNoteReference,o=0;o<this.documentHelper.pages.length;o++){n=0;for(var s=this.documentHelper.pages[o],l=0;l<s.bodyWidgets.length;l++)for(var d=s.bodyWidgets[l],h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];if(c instanceof Al)for(var p=0;p<c.childWidgets.length;p++)for(var u=c.childWidgets[p],g=0;g<u.childWidgets.length;g++)for(var m=u.childWidgets[g],f=0;f<m.childWidgets.length;f++)for(var v=m.childWidgets[f],y=0;y<v.childWidgets.length;y++){var w=v.childWidgets[y];if(n=0,!(0,a.isNullOrUndefined)(w.children))for(var b=0;b<w.children.length;b++){n+=(x=w.children[b]).length,x instanceof Yl&&x===r&&(e.setPositionParagraph(w,n-1),t.setPositionParagraph(w,n),this.selectRange(e,t))}}else for(var C=0;C<c.childWidgets.length;C++){w=c.childWidgets[C];if(n=0,!(0,a.isNullOrUndefined)(w.children))for(b=0;b<w.children.length;b++){var x;n+=(x=w.children[b]).length,x instanceof Yl&&x===r&&(e.setPositionParagraph(w,n-1),t.setPositionParagraph(w,n),this.selectRange(e,t))}}}}},t.prototype.getAbsolutePositionFromRelativePosition=function(e){var t;t="string"==typeof e?this.getTextPosBasedOnLogicalIndex(e):e;var i=this.getParagraphInfo(t),n={position:0,done:!1};return this.getPositionInfoForHeaderFooter(i,n),n.position},t.prototype.getPositionInfoForBodyContent=function(e,t,i,n){var r=(0,a.isNullOrUndefined)(i)?this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0]:i;return t.position+=this.getBlockIndex(r,e,t,n),t},t.prototype.getPositionInfoForHeaderFooter=function(e,t,i){return(t=this.getPositionInfoForBodyContent(e,t,void 0,i)).done||this.getBlockIndexFromHeaderFooter(e,t,i),t},t.prototype.getBlockIndexFromHeaderFooter=function(e,t,i){for(var n=0,r=this.documentHelper.headersFooters;n<r.length;n++)for(var o=r[n],s=0;s<6;s++){var a=o[s];if(a){if(t.position+=this.getBlockIndex(a.childWidgets[0],e,t,i),t.done)return t}else t.position+=1}return t},t.prototype.getBlockIndex=function(e,t,i,n){var r=0,o={length:0};do{if(e instanceof Rl&&!(0,a.isNullOrUndefined)(t)&&!(0,a.isNullOrUndefined)(t.paragraph)&&t.paragraph.equals(e)){r+=1;var s=e.getInline(t.offset,0);r+=this.getBlockOffsetByElement(t,e,s.element,s.index,o),i.done=!0;break}if(r=this.getBlockLength(t,e,r,i,!0,n,o),i.done)break;if(!(0,a.isNullOrUndefined)(e))if(e.containerWidget instanceof Ol&&e.containerWidget.containerWidget instanceof Dl){var l=e.getSplitWidgets().pop().nextRenderedWidget;if(!(0,a.isNullOrUndefined)(l)&&e.containerWidget!==l.containerWidget)break;e=l}else e=e.getSplitWidgets().pop().nextRenderedWidget}while(e);return r},t.prototype.getBlockTotalLength=function(e,t,i,n,r){for(var o=0,s=!1,a=e.getSplitWidgets(),l=0;l<a.length;l++)for(var d=0;d<a[l].childWidgets.length;d++)for(var h=a[l].childWidgets[d],c=0;c<h.children.length;c++){var p=h.children[c];if(!(p instanceof md)){if((p instanceof hd||p instanceof Yl)&&(p instanceof hd?p.textFrame.childWidgets.length>0&&(o+=this.getBlockIndex(p.textFrame.childWidgets[0],t,i,void 0)):o+=this.getBlockIndex(p.bodyWidget.childWidgets[0],t,i,void 0),i.done))return o;p instanceof _l&&0==p.fieldType&&p.formFieldData instanceof Xl&&(s=!0),s&&p instanceof _l&&1==p.fieldType&&p.previousNode instanceof Zl&&(r.length+=p.previousNode.length,s=!1),p.skipformFieldLength||(o+=p.length)}}return o},t.prototype.getBlockLength=function(e,t,i,n,r,o,s){if(e&&t instanceof Rl&&!(0,a.isNullOrUndefined)(e.paragraph)&&e.paragraph.equals(t)){i+=1;var l=t.getInline(e.offset,0);return i+=this.getBlockOffsetByElement(e,t,l.element,l.index,s),this.isEndOffset&&t.isInsideTable&&t.associatedCell.lastChild.equals(t)&&e.offset===this.getParagraphLength(t)+1&&(i+=1),n.done=!0,i}if(t instanceof Rl)i+=1,i+=r?this.getBlockTotalLength(t,e,n,o,s):t.getTotalLength();else if(t instanceof Al){if(i+=1,!(0,a.isNullOrUndefined)(o)&&o instanceof Al&&o.equals(t))return n.done=!0,i;for(var d=t.firstChild;d;){if(i+=1,!(0,a.isNullOrUndefined)(o)&&o instanceof Ul&&o.equals(d))return n.done=!0,i;for(var h=d.firstChild;h;){if(i+=1,!(0,a.isNullOrUndefined)(o)&&o instanceof Vl&&o.equals(h))return n.done=!0,i;for(var c=h.firstChild;c;){if(i=this.getBlockLength(e,c,i,n,r,o,s),n.done)return i;c=c.getSplitWidgets().pop().nextRenderedWidget}h=h.nextWidget}var p=d.ownerTable.index;(d=d.getSplitWidgets().pop().nextRenderedWidget)&&d.ownerTable.index!==p&&(d=void 0)}}return i},t.prototype.calculateCellLength=function(e){for(var t=e.firstChild,i=0,n={done:!1},r={paragraph:null,offset:0};t;)i=this.getBlockLength(r,t,i,n,!0,void 0,void 0),t=t.getSplitWidgets().pop().nextRenderedWidget;return i},t.prototype.getBlockOffsetByElement=function(e,t,i,n,r){for(var o=0,s=!1,a=t.getSplitWidgets(),l=0;l<a.length;l++)for(var d=0;d<a[l].childWidgets.length;d++)for(var h=a[l].childWidgets[d],c=0;c<h.children.length;c++){var p=h.children[c];if(!(p instanceof md)){if(p instanceof _l&&0==p.fieldType&&p.formFieldData instanceof Xl&&(s=!0),s&&p instanceof _l&&1==p.fieldType&&p.previousNode instanceof Zl&&(r.length+=p.previousNode.length,s=!1),p===i)return o+n;if(p instanceof hd||p instanceof Yl)if(p instanceof hd){if(p.textFrame.childWidgets.length>0)for(var u=0;u<p.textFrame.childWidgets.length;u++)o=this.getBlockLength(e,p.textFrame.childWidgets[u],o,{done:!1},!1,void 0,void 0)}else if(p.bodyWidget.childWidgets.length>0)for(u=0;u<p.bodyWidget.childWidgets.length;u++)o=this.getBlockLength(e,p.bodyWidget.childWidgets[u],o,{done:!1},!1,void 0,void 0);p.skipformFieldLength||(o+=p.length)}}return o},t.prototype.getTableRelativeValue=function(e,t){if(e.currentWidget.paragraph.isInsideTable){if(this.isTableSelected())return 3;if(this.isRowSelect()&&t.paragraph.isInsideTable&&e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable))return 2;var i=e.paragraph.associatedCell.ownerTable.getSplitWidgets(),n=this.getFirstBlockInFirstCell(i[0]);if(e.paragraph.associatedCell.equals(n.associatedCell)){if(t.paragraph.isInsideTable){if(e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable))return 0;for(var r=this.isRowSelect()?2:3,o=e.paragraph.associatedCell.ownerTable;o.containerWidget instanceof Vl&&(r+=3,!(o=o.containerWidget.ownerTable).equals(t.paragraph.associatedCell.ownerTable)););return r}return 3}return t.currentWidget.paragraph.isInsideTable&&e.paragraph.associatedCell.ownerTable.equals(t.paragraph.associatedCell.ownerTable)?0:2}return 0},t.prototype.isRowSelect=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),(0,a.isNullOrUndefined)(e.paragraph.associatedCell)||(0,a.isNullOrUndefined)(t.paragraph.associatedCell)||e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||this.isTableSelected(!0))return!1;var i=t.paragraph.associatedCell.ownerTable,n=!1;if(i.containerWidget instanceof Vl)for(;i.containerWidget instanceof Vl;){i=i.containerWidget.ownerTable;for(var r=0;r<i.childWidgets.length;r++){var o=i.childWidgets[r];o.childWidgets[o.childWidgets.length-1].equals(i.containerWidget)&&(n=!0)}}else for(r=0;r<i.childWidgets.length;r++){var s=i.childWidgets[r];s.childWidgets[s.childWidgets.length-1].equals(t.paragraph.associatedCell)&&(n=!0)}var l,d=e.paragraph.associatedCell.ownerRow.getSplitWidgets();return d[0].childWidgets.length>0&&(l=d[0].childWidgets[0]),e.paragraph.associatedCell.equals(l)&&n},t}(),Qc=function(){function e(e){this.langIDInternal=0,this.enableSpellCheckInternal=!0,this.uniqueSpelledWords={},this.spellSuggestionInternal=!0,this.uniqueKey="",this.removeUnderlineInternal=!1,this.uniqueWordsCountInternal=15e3,this.performOptimizedCheck=!0,this.isChangeAll=!1,this.documentHelper=e,this.errorWordCollection=new l,this.uniqueWordsCollection=new l,this.errorSuggestions=new l,this.ignoreAllItems=[],this.uniqueSpelledWords={},this.textSearchResults=new Lc(this.documentHelper.owner),this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}return e.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(e.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(e){this.performOptimizedCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uniqueWordsCount",{get:function(){return(0,a.isNullOrUndefined)(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(e){this.uniqueWordsCountInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageID",{get:function(){return(0,a.isNullOrUndefined)(this.langIDInternal)?0:this.langIDInternal},set:function(e){this.langIDInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(e){this.spellSuggestionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(e){this.removeUnderlineInternal=e,this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(e){this.enableSpellCheckInternal=e,this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.manageReplace=function(e,t){this.documentHelper.triggerSpellCheck=!0;if(!(0,a.isNullOrUndefined)(t)&&t instanceof Ql){var i=t.text;if(this.documentHelper.selection.start=t.start.clone(),this.documentHelper.selection.end=t.end.clone(),"Ignore Once"!==e)return e=this.manageSpecialCharacters(i,e),this.documentHelper.owner.editorModule.insertTextInternal(e,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:i,element:t}}if(!(0,a.isNullOrUndefined)(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==e){var n=this.currentContextInfo.element;this.currentContextInfo.element.text,this.documentHelper.selection.start=n.start.clone(),this.documentHelper.selection.end=n.end.clone()}else this.handleReplace(e);"Ignore Once"!==e&&(this.documentHelper.owner.editorModule.insertTextInternal(e,!0),(0,a.isNullOrUndefined)(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight()),this.documentHelper.triggerSpellCheck=!1},e.prototype.handleReplace=function(e){var t=this.documentHelper.selection.start,i=t.offset,n=t.currentWidget.getInline(i,0,!1,!0);n.element.line.getOffset(n.element,0)+n.element.length===i&&this.retrieveExactElementInfo(n);for(var r,o=n.element.text,s=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),l=[];!(0,a.isNullOrUndefined)(r=s.exec(o));)l.push(r);if("Ignore Once"!==e){t.offset=i-n.index,!(0,a.isNullOrUndefined)(l)&&l.length>0&&(t.offset+=l[0].toString().length),t.location=this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(t.currentWidget,t.offset,!0),(t=this.documentHelper.owner.searchModule.textSearch.getTextPosition(t.currentWidget,t.offset.toString())).setPositionParagraph(t.currentWidget,t.offset);var d=t.offset+n.element.length-t.offset,h=t.currentWidget.getOffset(n.element,d),c=t.currentWidget,p=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g");for(l=[];!(0,a.isNullOrUndefined)(r=p.exec(o));)l.push(r);!(0,a.isNullOrUndefined)(l)&&l.length>0&&(h-=l[0].toString().length),this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(c,h.toString()),this.documentHelper.selection.end.location=this.documentHelper.owner.selectionModule.getPhysicalPositionInternal(t.currentWidget,h,!0),this.documentHelper.selection.end.setPositionParagraph(c,h),this.currentContextInfo={element:n.element,text:n.element.text}}else this.handleIgnoreOnce(n)},e.prototype.retrieveExactElementInfo=function(e){var t=e.element.nextElement;!(0,a.isNullOrUndefined)(t)&&t instanceof Zl&&(""!=t.text.trim()&&(e.element=t))},e.prototype.handleIgnoreOnce=function(e){var t=e.element,i="";i=!(0,a.isNullOrUndefined)(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element.text:t.text,i=this.manageSpecialCharacters(i,void 0,!0),-1===t.ignoreOnceItems.indexOf(i)&&t.ignoreOnceItems.push(i),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection)},e.prototype.handleIgnoreAllItems=function(e){var t=(0,a.isNullOrUndefined)(e)?this.retriveText():e,i=this.manageSpecialCharacters(t.text,void 0,!0);-1===this.ignoreAllItems.indexOf(i)&&(this.ignoreAllItems.push(i),this.removeErrorsFromCollection(t),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},e.prototype.handleAddToDictionary=function(e){var t=this,i=(0,a.isNullOrUndefined)(e)?this.retriveText():e,n=this.manageSpecialCharacters(i.text,void 0,!0);this.callSpellChecker(this.languageID,n,!1,!1,!0).then((function(e){(0,a.isNullOrUndefined)(t.documentHelper)||(t.documentHelper.triggerSpellCheck=!0,t.removeErrorsFromCollection(i),t.ignoreAllItems.push(n),t.documentHelper.owner.editorModule.reLayout(t.documentHelper.selection,!0),t.documentHelper.triggerSpellCheck=!1)}))},e.prototype.manageSpecialCharacters=function(e,t,i){if(!(0,a.isNullOrUndefined)(e)){(0,a.isNullOrUndefined)(t)&&(t=e);for(var n=new RegExp("^[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\`\\s\\’]+","g"),r=[],o=void 0;!(0,a.isNullOrUndefined)(o=n.exec(e));)r.push(o);if(r.length>0)for(var s=0;s<r.length;s++){var l=r[s];t=i?t.replace(l[0],""):l[0]+t}var d=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\s\\`\\’]+$","g");r=[];var h=t;for(i||(h=e);!(0,a.isNullOrUndefined)(o=d.exec(h));)r.push(o);if(r.length>0)for(s=0;s<r.length;s++){l=r[s];t=i?t.slice(0,l.index):t+l[0]}}return t},e.prototype.removeErrorsFromCollection=function(e){if(!(0,a.isNullOrUndefined)(e.text)&&this.errorWordCollection.containsKey(e.text)){var t=this.errorWordCollection.get(e.text);t.indexOf(e.element)>=0&&t.splice(0,1),0===t.length&&this.errorWordCollection.remove(e.text)}},e.prototype.retriveText=function(){var e,t;if(!(0,a.isNullOrUndefined)(this.currentContextInfo)&&this.currentContextInfo.element)t=this.currentContextInfo.element,e=this.currentContextInfo.element.text,this.documentHelper.selection.start=t.start.clone(),this.documentHelper.selection.end=t.end.clone();else{var i=this.documentHelper.selection.start,n=i.offset,r=i.currentWidget.getInline(n,0);t=r.element,e=r.element.text}return{text:e,element:t}},e.prototype.handleSuggestions=function(e){this.spellCheckSuggestion=[],0===e.length||(e=e.length>3?this.constructInlineMenu(e):e),this.spellCheckSuggestion.push(this.documentHelper.owner.contextMenuModule.locale.getConstant("Add to Dictionary"));var t=[];if(this.spellCheckSuggestion.length>0)for(var i=0,n=this.spellCheckSuggestion;i<n.length;i++){var r=n[i];t.push({text:r,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+(r===this.documentHelper.owner.contextMenuModule.locale.getConstant("Add to Dictionary")?"Add to Dictionary":r),iconCss:""})}return t},e.prototype.checktextElementHasErrors=function(e,t,i){var n=!1,r=[];if(e=e.replace(/[\s]+/g,""),!(0,a.isNullOrUndefined)(t.errorCollection)&&t.errorCollection.length>0){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:n,elements:r};for(var o=0;o<t.errorCollection.length;o++)this.handleErrorCollection(t.errorCollection[o])&&(n=!0,r.push(t.errorCollection[o]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(n=!0,r.push(t));return{errorFound:n,elements:r}},e.prototype.updateStatusForGlobalErrors=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var n=this.manageSpecialCharacters(e[i].text,void 0,!0);if(this.errorWordCollection.containsKey(n))for(var r=this.errorWordCollection.get(n),o=0;o<r.length;o++)if(r[o]instanceof Ql&&r[o]===e[i]){r[o].ischangeDetected=!0,r[o].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0),r[o].line=t.line;break}}},e.prototype.handleErrorCollection=function(e){var t=this.errorWordCollection,i=this.manageSpecialCharacters(e.text,void 0,!0);return!!(t.containsKey(i)&&e.length>1)&&(!(this.ignoreAllItems.indexOf(i)>-1)||(t.containsKey(i)&&t.remove(i),!1))},e.prototype.constructInlineMenu=function(e){for(var t=e.length-1;t>0;t--)e.length>3&&(this.spellCheckSuggestion.push(e[t]),e.pop());return e},e.prototype.findCurretText=function(){var e,t,i=this.documentHelper.selection.start,n=i.currentWidget.getInline(this.documentHelper.selection.start.offset,0);if(!(0,a.isNullOrUndefined)(n.element)){if(!(0,a.isNullOrUndefined)(n.element.errorCollection)&&n.element.errorCollection.length>0)for(var r=0;r<n.element.errorCollection.length;r++){var o=n.element.errorCollection[r];if(o.start.location.x<=i.location.x&&o.end.location.x>=i.location.x){t=o.text,e=o;break}}else t=n.element.text;" "===t&&(t=(n=i.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0)).element.text)}return{text:t,element:e}},e.prototype.addErrorCollection=function(e,t,i){if(e=this.manageSpecialCharacters(e,void 0,!0),this.errorWordCollection.containsKey(e)){var n=this.errorWordCollection.get(e);t instanceof Ql?this.compareErrorTextElement(t,n)||n.push(t):t instanceof Zl&&(this.compareTextElement(t,n)||n.push(t))}else!(0,a.isNullOrUndefined)(i)&&i.length>0&&this.errorSuggestions.add(e,i),this.errorWordCollection.add(e,[t]),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!0)},e.prototype.addCorrectWordCollection=function(e){e=this.manageSpecialCharacters(e,void 0,!0),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!1)},e.prototype.isInUniqueWords=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.containsKey(e)},e.prototype.isErrorWord=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.get(e)},e.prototype.isCorrectWord=function(e){return e=e.replace(/[\s]+/g,""),!this.uniqueWordsCollection.get(e)},e.prototype.compareErrorTextElement=function(e,t){for(var i=[],n=!1,r=0;r<t.length;r++)i.push(t[r]);var o=t.length;for(r=0;r<o;r++)if(i[r]instanceof Ql)if(i[r].ischangeDetected){var s=this.manageSpecialCharacters(i[r].text,void 0,!0);n=!0,this.removeErrorsFromCollection({element:i[r],text:s})}else{var a=i[r];if(e.start.offset===a.start.offset&&e.end.offset===a.end.offset)return!0}return n&&this.errorWordCollection.add(this.manageSpecialCharacters(e.text,void 0,!0),[e]),!1},e.prototype.compareTextElement=function(e,t){for(var i=0;i<t.length;i++){if(t[i]instanceof Zl)if(t[i]===e)return!0}return!1},e.prototype.handleWordByWordSpellCheck=function(e,t,i,n,r,o,s,l){if((0,a.isNullOrUndefined)(l)&&(l=t.text),e.HasSpellingError&&s){if(this.addErrorCollection(l,t,e.Suggestions),l===t.text.trim()){var d=t.line.paragraph.containerWidget instanceof Vl?t.line.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor;this.documentHelper.render.renderWavyLine(t,i,n,r,"#FF0000","Single",o,d),t.isSpellChecked=!0}}else this.addCorrectWordCollection(l),t.isSpellChecked=!0},e.prototype.checkElementCanBeCombined=function(e,t,i,n,r,o,s,l){var d=(0,a.isNullOrUndefined)(r)?"":r,h=!(0,a.isNullOrUndefined)(l)&&l,c=!!(0,a.isNullOrUndefined)(s)||s,p=!!(0,a.isNullOrUndefined)(o)||o,u=[],g=this.documentHelper.selection.getLineWidget(e,0),m=g.children.indexOf(e),f=e.text;u.push(e);var v=s?0:1,y=!1,w=!1;if("\v"!==e.text){if(c){for(var b=void 0,C=m-v;C>=0&&(b=g.children[C],(0,a.isNullOrUndefined)(b)||(0,a.isNullOrUndefined)(b.revisions)||!(b.revisions.length>0)||"Deletion"!==b.revisions[0].revisionType);C--)if(b instanceof Zl&&!w){if(0!==f.indexOf(" ")&&b.text.lastIndexOf(" ")!==b.text.length-1)y=!(0,a.isNullOrUndefined)(r),d=b.text+d,f=b.text,w=!1,u.push(b),h=!0;else if(!(0,a.isNullOrUndefined)(b)){b=b.nextElement;break}}else b instanceof _l&&1!==b.fieldType&&(w=!0);var x=h?b:e;if(this.lookThroughPreviousLine(d,f,x,t,i))return!0}s?d=y?d:e.text+d:d+=e.text,w=!1;var I=e.text;if(p){var k=!1,F=void 0;for(C=m+1;C<g.children.length&&(F=g.children[C],(0,a.isNullOrUndefined)(F)||(0,a.isNullOrUndefined)(F.revisions)||!(F.revisions.length>0)||"Deletion"!==F.revisions[0].revisionType);C++)if(F instanceof Zl&&!w){if(I.lastIndexOf(" ")!==I.length-1&&0!==F.text.indexOf(" "))d+=F.text,I=F.text,w=!1,u.push(F),k=!0,h=!0;else if(!(0,a.isNullOrUndefined)(F)){F=F.previousElement;break}}else F instanceof _l&&2!==F.fieldType&&(w=!0);if("\f"!==(x=k?F:e).text&&x.text!==String.fromCharCode(14)&&this.lookThroughNextLine(d,f,x,t,i))return!0}}return h&&n&&!this.checkCombinedElementsBeIgnored(u,d)&&this.handleCombinedElements(e,d,t,i),h},e.prototype.lookThroughPreviousLine=function(e,t,i,n,r){if(!(0,a.isNullOrUndefined)(i)&&0===i.indexInOwner&&!(0,a.isNullOrUndefined)(i.line.previousLine)){var o=i.line.previousLine,s=o.children.length-1;if(!(0,a.isNullOrUndefined)(o.children[s])&&o.children[s]instanceof Zl){var l=o.children[s];if(!(0,a.isNullOrUndefined)(i.text)&&0!==i.text.indexOf(" ")&&l.text.lastIndexOf(" ")!==l.text.length-1)return e=e.length>0?e:t,this.checkElementCanBeCombined(l,n,r,!0,e,!1,!0,!0),!0}}return!1},e.prototype.lookThroughNextLine=function(e,t,i,n,r){if(i instanceof Zl&&!(0,a.isNullOrUndefined)(i)&&i.indexInOwner===i.line.children.length-1&&!(0,a.isNullOrUndefined)(i.line.nextLine)){var o=i.line.nextLine;if(!(0,a.isNullOrUndefined)(o.children[0])&&o.children[0]instanceof Zl){var s=o.children[0];if(i.text.lastIndexOf(" ")!==i.text.length-1&&0!==s.text.indexOf(" "))return e=e.length>0?e:t,this.checkElementCanBeCombined(s,n,r,!0,e,!0,!1,!0),!0}}return!1},e.prototype.handleCombinedElements=function(e,t,i,n){e.istextCombined=!0;var r=t.split(/[\s]+/);if(-1===this.ignoreAllItems.indexOf(t)&&e instanceof Zl&&-1===e.ignoreOnceItems.indexOf(t))if(r.length>1)for(var o=0;o<r.length;o++){var s=r[o];s=this.manageSpecialCharacters(s,void 0,!0),this.documentHelper.render.handleUnorderedElements(s,e,i,o,0,o===r.length-1,n)}else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,e,i,0,0,!0,n)},e.prototype.checkArrayHasSameElement=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.start.location.x===t.start.location.x&&n.start.location.y===t.start.location.y)return!0}return!1},e.prototype.handleSplitWordSpellCheck=function(e,t,i,n,r,o,s,a){if(e.HasSpellingError&&" "!==i.text&&n){var l=this.getMatchedResultsFromElement(i,t);i.previousElement instanceof _l&&1===i.previousElement.fieldType&&(l.elementInfo.values.pop(),l.elementInfo.values.push(0)),s=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):s,i.previousElement instanceof _l&&1===i.previousElement.fieldType&&(l.elementInfo.values.pop(),l.elementInfo.values.push(0)),this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(l.matches,l.textResults,l.elementInfo,0,i,!1,null,s),this.handleMatchedResults(l.textResults,i,r,o,e.Suggestions,a)}else this.addCorrectWordCollection(t),a&&(i.isSpellChecked=!0);this.updateUniqueWords([{Text:t,HasSpellError:e.HasSpellingError}])},e.prototype.handleMatchedResults=function(e,t,i,n,r,o){if(0===e.length&&o)t.isSpellChecked=!0;else for(var s=0;s<e.length;s++){var l=this.createErrorElementWithInfo(e.innerList[s],t),d="#FF0000";(0,a.isNullOrUndefined)(t.errorCollection)||this.checkArrayHasSameElement(t.errorCollection,l)||t.errorCollection.splice(n,0,l),this.addErrorCollection(l.text,l,r);var h=this.errorWordCollection.get(l.text);(0,a.isNullOrUndefined)(h)||-1===h.indexOf(t)||h.indexOf(t)===h.indexOf(l)||h.splice(h.indexOf(t),1);for(var c=t.line.paragraph.containerWidget instanceof Vl?t.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,p=t.line.paragraph,u=p.y,g=0;g<p.childWidgets.length&&p.childWidgets[g]!=t.line;g++)u+=p.childWidgets[g].height;t.isRightToLeft?this.documentHelper.render.renderWavyLine(l,l.end.location.x,u,i,d,"Single",t.characterFormat.baselineAlignment,c):this.documentHelper.render.renderWavyLine(l,l.start.location.x,u,i,d,"Single",t.characterFormat.baselineAlignment,c),o&&(t.isSpellChecked=!0)}},e.prototype.callSpellChecker=function(e,t,i,n,r,o){var s=this,l=this;return new Promise((function(d,h){if(!(0,a.isNullOrUndefined)(s)){var c=new XMLHttpRequest,p=s.documentHelper.owner.serviceUrl;p=o?p+s.documentHelper.owner.serverActionSettings.spellCheckByPage:p+s.documentHelper.owner.serverActionSettings.spellCheck,c.open("POST",p,!0),c.setRequestHeader("Content-Type","application/json");var u=s.documentHelper.owner.headers;o&&(t=t.replace(String.fromCharCode(160)," "));var g={LanguageID:e,TexttoCheck:t,CheckSpelling:i,CheckSuggestion:n,AddWord:r},m={serverActionType:"SpellCheck",headers:u,timeout:0,cancel:!1,withCredentials:!1};u=m.headers,s.documentHelper.owner.trigger(_,m),s.setCustomHeaders(c,m.headers),c.withCredentials=m.withCredentials,m.cancel||c.send(JSON.stringify(g)),c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status||304===c.status)d(c.response);else{var e={status:c.status.toString(),statusText:c.responseText,url:p,name:"onFailure"};(0,a.isNullOrUndefined)(l.documentHelper)||l.documentHelper.owner.fireServiceFailure(e),h(c.response)}}}}))},e.prototype.setCustomHeaders=function(e,t){if(!(0,a.isNullOrUndefined)(t))for(var i=0;i<t.length;i++)for(var n=t[i],r=0,o=Object.keys(n);r<o.length;r++){var s=o[r];e.setRequestHeader(s,n[s])}},e.prototype.checkForNextError=function(){if(!(0,a.isNullOrUndefined)(this.viewer)){var e=this.errorWordCollection;if(e.length>0)for(var t=0;t<e.length;t++){for(var i=e.get(e.keys[t]),n=0;n<i.length;n++){if(i[n]instanceof Ql&&!i[n].ischangeDetected)this.updateErrorElementTextBox(e.keys[t],i[n]);else if(i[n]instanceof Zl){var r=this.getMatchedResultsFromElement(i[n]),o=r.textResults,s=i[n].ischangeDetected?i[n].start.offset:i[n].line.getOffset(i[n],0);this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(r.matches,o,r.elementInfo,0,i[n],!1,null,s);for(var l=0;l<o.length;l++){var d=this.createErrorElementWithInfo(o.innerList[l],i[n]);this.updateErrorElementTextBox(d.text,d);break}}break}break}else this.documentHelper.clearSelectionHighlight()}},e.prototype.createErrorElementWithInfo=function(e,t){var i=new Ql,n=!1;if(t instanceof Ql&&((0,a.isNullOrUndefined)(e.start)||(0,a.isNullOrUndefined)(e.end)||(0,a.isNullOrUndefined)(e.text))){i.text=t.text;for(var r=t.line,o=0;o<r.children.length;o++)if(r.children[o]instanceof Zl){var s=r.children[o].text,l=t.text;if(-1!==s.indexOf(l)){t.start.offset=s.indexOf(l),t.end.offset=t.start.offset+l.length,i.start=t.start,i.end=t.end,i.start.currentWidget=t.line,i.end.currentWidget=t.line,n=!0;break}}n||(i.text=t.text,i.start=t.start,i.end=t.end,n=!0)}return n||(i.text=e.text,i.start=e.start,i.end=e.end),i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=Math.abs(i.start.location.x-i.end.location.x),i},e.prototype.getMatchedResultsFromElement=function(e,t){var i=e.line,n=this.documentHelper.owner.searchModule.textSearch.stringToRegex((0,a.isNullOrUndefined)(t)?e.text:t,"CaseSensitive");this.textSearchResults.clearResults();for(var r,o=this.textSearchResults,s=this.documentHelper.owner.searchModule.textSearch.getElementInfo(i.children[0],0,!1,n,void 0,void 0,void 0,void 0,!0),l=s.fullText,d=[],h=s.elementsWithOffset;!(0,a.isNullOrUndefined)(r=n.exec(l));)this.isChangeAll&&(r.index=h.get(e)),d.push(r);return{matches:d,elementInfo:h,textResults:o}},e.prototype.updateErrorElementTextBox=function(e,t){var i=t;this.documentHelper.clearSelectionHighlight(),this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone(),this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end),this.documentHelper.owner.spellCheckDialogModule.updateSuggestionDialog(e,i)},e.prototype.getWhiteSpaceCharacterInfo=function(e){var t,i=e.text,n=e.characterFormat,r=0,o=0;if(t=i.match(/[\s]+/),!(0,a.isNullOrUndefined)(t)&&t.length>0)for(var s=0;s<t.length;s++)r+=this.documentHelper.textHelper.getWidth(t[s],n,e.scriptType),o+=t[s].length;return{width:r,wordLength:o,isBeginning:!(0,a.isNullOrUndefined)(t)&&0===t.index}},e.prototype.getSpecialCharactersInfo=function(e){var t=e.text,i=e.characterFormat,n=[],r=0,o=0,s=0;n=t.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/);for(var l=0;l<n.length;l++)!(0,a.isNullOrUndefined)(n[l])&&n[l].length>0&&(r=this.documentHelper.textHelper.getWidth(n[l],i,e.scriptType)),s=n.length;n=t.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/);for(l=0;l<n.length;l++)!(0,a.isNullOrUndefined)(n[l])&&n[l].length>0&&(o=this.documentHelper.textHelper.getWidth(n[l],i,e.scriptType)),s=n.length;return{beginningWidth:r,endWidth:o,wordLength:s}},e.prototype.getCombinedElement=function(e){for(var t=e;!(0,a.isNullOrUndefined)(e)&&e instanceof Zl&&e.istextCombined;)t=e,e=e.previousElement;return t},e.prototype.checkCombinedElementsBeIgnored=function(e,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<e.length;i++)if(-1!==e[i].ignoreOnceItems.indexOf(t))return!0;return!1},e.prototype.updateSplittedElementError=function(e,t){var i=e.errorCollection.length;if(i>0){for(var n=[],r=0;r<i;r++)n.push(e.errorCollection[r]);for(r=0;r<i;r++)-1===e.text.indexOf(n[r].text)&&(t.ischangeDetected=!0,e.errorCollection.splice(0,1))}},e.prototype.getPageContent=function(e){var t="";if(this.documentHelper.owner.sfdtExportModule){var i=this.documentHelper.owner.sfdtExportModule,n=i.keywordIndex;i.keywordIndex=0,i.Initialize();var r=i.writePage(e);if(i.keywordIndex=n,this.documentHelper.owner.textExportModule){var o=this.documentHelper.owner.textExportModule;o.pageContent="",o.setDocument(r),o.writeInternal(),t=o.pageContent}}return t},e.prototype.updateUniqueWords=function(e){if((0,a.isNullOrUndefined)(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},e.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var t=0;t<e.length;t++)this.checkForUniqueWords(e[t]);this.addUniqueWordsToLocalStorage(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords)),this.uniqueSpelledWords={}},e.prototype.addUniqueWordsToLocalStorage=function(e,t){try{localStorage.setItem(e,t)}catch(i){"QuotaExceededError"===i.name&&(this.clearCache(),localStorage.setItem(e,t))}},e.prototype.checkForUniqueWords=function(e){this.uniqueSpelledWords[e.Text]||(this.uniqueSpelledWords[e.Text]=e.HasSpellError)},e.prototype.clearCache=function(){(0,a.isNullOrUndefined)(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},e.prototype.createGuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))},e.prototype.checkSpellingInPageInfo=function(e){var t=JSON.parse(localStorage.getItem(this.uniqueKey));return(0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(t[e])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:t[e],isElementPresent:!0}},e.prototype.destroy=function(){this.errorWordCollection=void 0,this.ignoreAllItems=void 0,this.errorSuggestions=void 0,this.uniqueWordsCollection=void 0,this.uniqueSpelledWords={},this.textSearchResults=void 0,(0,a.isNullOrUndefined)(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey),this.documentHelper=void 0},e}(),$c=function(){function e(e){this.documentHelper=e,this.optimizedHeightCollection={}}return e.prototype.getModuleName=function(){return"Optimized"},e.prototype.getkeyFromCharFormat=function(e){var t=e.fontFamily.toLocaleLowerCase();return e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},e.prototype.getFontInfo=function(e){var t=(0,a.createElement)("iframe");document.body.appendChild(t);var i="<!DOCTYPE html><html><head></head><body></body></html>",n=this.documentHelper.owner.externalFonts;n&&n.length>0&&n.forEach((function(e){e.src&&(i+="<style>@font-face {font-family: '"+e.fontFamily+"'; src: "+e.src+"; }</style>")})),(0,a.isNullOrUndefined)(t.contentDocument)||(t.contentDocument.open(),t.contentDocument.write(i),t.contentDocument.close());var r=document.createElement("div");r.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;");var o=1/window.devicePixelRatio;r.style.transform="scale("+o.toString()+","+o.toString()+")",r.innerHTML='<span class="e-de-font-info" style="font-size:0; font-family: \''+e.fontFamily+'\'; display: inline-block;">m</span><span class="e-de-font-info" style="font-size:288pt; font-family: \''+e.fontFamily+"';"+(e.bold?"font-weight:bold;":"")+(e.italic?"font-style:italic;":"")+' display: inline-block;">m</span>',t.contentDocument.body.appendChild(r);var s=r.firstChild.offsetTop/r.lastChild.offsetHeight,l=parseFloat((r.lastChild.offsetHeight/288).toFixed(2));return document.body.removeChild(t),{HeightFactor:l,BaselineFactor:s}},e.prototype.getHeightInternal=function(e){var t=this.getkeyFromCharFormat(e),i=e.bidi||e.complexScript;if((0,a.isNullOrUndefined)(this.optimizedHeightCollection[""+t])){var n=this.getFontInfo(e);return this.optimizedHeightCollection[""+t]=n,{Height:r=n.HeightFactor*(i?e.fontSizeBidi:e.fontSize),BaselineOffset:n.BaselineFactor*r}}var r,o=this.optimizedHeightCollection[""+t];return{Height:r=o.HeightFactor*(i?e.fontSizeBidi:e.fontSize),BaselineOffset:o.BaselineFactor*r}},e.prototype.destroy=function(){this.documentHelper=void 0,this.optimizedHeightCollection=void 0},e}(),ep=function(){function e(e){this.documentHelper=e}return e.prototype.getModuleName=function(){return"Regular"},e.prototype.getHeightInternal=function(e,t){var i,n,r=document.createElement("span");r.innerText="m";var o=(0,a.createElement)("iframe");document.body.appendChild(o);(0,a.isNullOrUndefined)(o.contentDocument)||(o.contentDocument.open(),o.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),o.contentDocument.close()),this.applyStyle(r,e,t);var s=document.createElement("div");s.setAttribute("style","display:inline-block;position:absolute;");var l=document.createElement("div");l.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),s.appendChild(r),s.appendChild(l),o.contentDocument.body.appendChild(s),i=r.offsetHeight;var d=r.offsetTop;return n=l.offsetTop-d,document.body.removeChild(o),{Height:i,BaselineOffset:n}},e.prototype.applyStyle=function(e,t,i){if(!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(t)){var n="white-space:nowrap;";(0,a.isNullOrUndefined)(i)||""===i?n+="font-family:"+t.fontFamily+";":n+="font-family:"+i+";";var r=t.bidi||t.complexScript?t.fontSizeBidi:t.fontSize;r<=.5&&(r=.5),n+="font-size:"+r.toString()+"pt;",t.bold&&(n+="font-weight:bold;"),t.italic&&(n+="font-style:italic;"),e.setAttribute("style",n)}},e.prototype.destroy=function(){this.documentHelper=void 0},e}(),tp=m(35),ip=function(){function e(e){this.documentHelper=void 0,this.commentStarts=void 0,this.commentEnds=void 0,this.commentsCollection=void 0,this.revisionCollection=void 0,this.isPageBreakInsideTable=!1,this.referedRevisions=[],this.isParseHeader=!1,this.footnotes=void 0,this.endnotes=void 0,this.keywordIndex=void 0,this.themes=void 0,this.isCutPerformed=!1,this.isPaste=!1,this.isContextBasedPaste=!1,this.isHtmlPaste=!1,this.documentHelper=e,this.editableRanges=new l}return Object.defineProperty(e.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.convertJsonToDocument=function(e,t){this.commentStarts=new l,this.commentEnds=new l,this.commentsCollection=new l,this.revisionCollection=new l,this.fontInfoCollection=new l,this.referedRevisions=[],this.keywordIndex=0,this.footnotes=new Jl,this.endnotes=new Jl;var i=[],n=Pa.getSfdtDocument(e);return!(0,a.isNullOrUndefined)(n.optimizeSfdt)&&n.optimizeSfdt&&(this.keywordIndex=1),(0,a.isNullOrUndefined)(n[te[this.keywordIndex]])||this.parseFontSubstitutionTable(n[te[this.keywordIndex]]),(0,a.isNullOrUndefined)(n[ie[this.keywordIndex]])?this.parseCharacterFormat(0,this.viewer.owner.characterFormat,this.documentHelper.characterFormat):(this.documentHelper.characterFormat.clearFormat(),this.parseCharacterFormat(this.keywordIndex,n[ie[this.keywordIndex]],this.documentHelper.characterFormat)),(0,a.isNullOrUndefined)(n[ne[this.keywordIndex]])?this.parseParagraphFormat(0,this.viewer.owner.paragraphFormat,this.documentHelper.paragraphFormat):this.parseParagraphFormat(this.keywordIndex,n[ne[this.keywordIndex]],this.documentHelper.paragraphFormat),(0,a.isNullOrUndefined)(n[Ee[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,n[Ee[this.keywordIndex]],this.documentHelper.themeFontLanguage),this.parseDocumentProtection(n),(0,a.isNullOrUndefined)(n[ce[this.keywordIndex]])||(this.documentHelper.defaultTabWidth=n[ce[this.keywordIndex]]),(0,a.isNullOrUndefined)(n[ue[this.keywordIndex]])||(this.documentHelper.owner.enableTrackChanges!==Pa.parseBoolValue(n[ue[this.keywordIndex]])&&(this.documentHelper.owner.skipSettingsOps=!0),this.documentHelper.owner.enableTrackChanges=Pa.parseBoolValue(n[ue[this.keywordIndex]])),(0,a.isNullOrUndefined)(n[Ie[this.keywordIndex]])||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=Pa.parseBoolValue(n[Ie[this.keywordIndex]])),(0,a.isNullOrUndefined)(n[Ys[this.keywordIndex]])||(this.documentHelper.allowSpaceOfSameStyleInTable=Pa.parseBoolValue(n[Ys[this.keywordIndex]])),(0,a.isNullOrUndefined)(n[ke[this.keywordIndex]])||(this.documentHelper.alignTablesRowByRow=Pa.parseBoolValue(n[ke[this.keywordIndex]])),(0,a.isNullOrUndefined)(n[se[this.keywordIndex]])||(this.documentHelper.backgroundColor=this.getColor(n[se[this.keywordIndex]][or[this.keywordIndex]])),(0,a.isNullOrUndefined)(n[He[this.keywordIndex]])||(this.documentHelper.compatibilityMode=this.getCompatibilityMode(n[He[this.keywordIndex]]),(0,a.isNullOrUndefined)(this.documentHelper.owner.documentSettings)||(this.documentHelper.owner.documentSettings.compatibilityMode=this.getCompatibilityMode(n[He[this.keywordIndex]]))),(0,a.isNullOrUndefined)(n[oe[this.keywordIndex]])||this.parseAbstractList(n,this.documentHelper.abstractLists),(0,a.isNullOrUndefined)(n[re[this.keywordIndex]])||this.parseList(n,this.documentHelper.lists),(0,a.isNullOrUndefined)(n[ae[this.keywordIndex]])||this.parseStyles(n,this.documentHelper.styles),(0,a.isNullOrUndefined)(n[le[this.keywordIndex]])||this.parseComments(n,this.documentHelper.comments),(0,a.isNullOrUndefined)(n[de[this.keywordIndex]])||this.parseRevisions(n,this.viewer.owner.revisionsInternal.changes),(0,a.isNullOrUndefined)(n[na[this.keywordIndex]])||this.parseImages(n[na[this.keywordIndex]]),(0,a.isNullOrUndefined)(n[ee[this.keywordIndex]])||this.parseSections(n[ee[this.keywordIndex]],i),(0,a.isNullOrUndefined)(n[he[this.keywordIndex]])||this.parseCustomXml(n),(0,a.isNullOrUndefined)(n[Fe[this.keywordIndex]])||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=Pa.parseBoolValue(n[Fe[this.keywordIndex]])),(0,a.isNullOrUndefined)(n[Se[this.keywordIndex]])||this.parseFootnotes(n[Se[this.keywordIndex]],this.documentHelper.footnotes),(0,a.isNullOrUndefined)(n[Te[this.keywordIndex]])||this.parseEndtnotes(n[Te[this.keywordIndex]],this.documentHelper.endnotes),(0,a.isNullOrUndefined)(n[Ne[this.keywordIndex]])||this.parseThemes(n[Ne[this.keywordIndex]],this.documentHelper.themes),this.generalizeRevisions(),this.removeUnmappedBookmark(),(0,a.isNullOrUndefined)(n[ha[0]])||(t[ha[0]]=n[ha[0]]),this.documentHelper.fieldStacks&&this.documentHelper.fieldStacks.length>0&&(this.documentHelper.fieldStacks=[]),i},e.prototype.parseFontSubstitutionTable=function(e){if(!(0,a.isNullOrUndefined)(this.documentHelper)&&!(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)&&Object.keys(e).length>0)for(var t=0,i=Object.keys(e);t<i.length;t++){var n=i[t];this.documentHelper.fontSubstitutionTable.add(n,e[n])}},e.prototype.removeUnmappedBookmark=function(){for(var e=this.documentHelper.bookmarks.keys,t=this.documentHelper.endBookmarksUpdated,i=0;i<e.length;i++)if(-1===t.indexOf(e[i])){var n=this.documentHelper.bookmarks.get(e[i]);n&&n.line.children.splice(n.line.children.indexOf(n),1),this.documentHelper.bookmarks.remove(e[i])}this.documentHelper.endBookmarksUpdated=[]},e.prototype.generalizeRevisions=function(){var e=this,t=new l,i=[];this.referedRevisions.forEach((function(n){var r=e.documentHelper.revisionsInternal.get(n);-1===i.indexOf(r)&&(i.push(r),t.add(n,r))})),this.viewer.owner.revisionsInternal.changes=i,this.documentHelper.revisionsInternal=t},e.prototype.parseFootnotes=function(e,t){(0,a.isNullOrUndefined)(e[us[this.keywordIndex]])||this.parseBody(e[us[this.keywordIndex]],t.separator),(0,a.isNullOrUndefined)(e[ms[this.keywordIndex]])||this.parseBody(e[ms[this.keywordIndex]],t.continuationNotice),(0,a.isNullOrUndefined)(e[gs[this.keywordIndex]])||this.parseBody(e[gs[this.keywordIndex]],t.continuationSeparator)},e.prototype.parseImages=function(e){for(var t in e)if(Array.isArray(e[""+t]))this.documentHelper.images.add(parseInt(t),e[""+t]);else{var i=[];i.push(e[""+t]),this.documentHelper.images.add(parseInt(t),i)}},e.prototype.parseEndtnotes=function(e,t){(0,a.isNullOrUndefined)(e[us[this.keywordIndex]])||this.parseBody(e[us[this.keywordIndex]],t.separator),(0,a.isNullOrUndefined)(e[ms[this.keywordIndex]])||this.parseBody(e[ms[this.keywordIndex]],t.continuationNotice),(0,a.isNullOrUndefined)(e[gs[this.keywordIndex]])||this.parseBody(e[gs[this.keywordIndex]],t.continuationSeparator)},e.prototype.parseCustomXml=function(e){for(var t=0;t<e[he[this.keywordIndex]].length;t++){var i=e[he[this.keywordIndex]][t];this.documentHelper.customXmlData.containsKey(i[Gr[this.keywordIndex]])||this.documentHelper.customXmlData.add(i[Gr[this.keywordIndex]],i[Kr[this.keywordIndex]])}},e.prototype.parseDocumentProtection=function(e){(0,a.isNullOrUndefined)(e[pe[this.keywordIndex]])||(this.documentHelper.restrictFormatting=Pa.parseBoolValue(e[pe[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[me[this.keywordIndex]])||(this.documentHelper.isDocumentProtected=Pa.parseBoolValue(e[me[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[ge[this.keywordIndex]])||(this.documentHelper.protectionType=this.getProtectionType(e[ge[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[fe[this.keywordIndex]])||(this.documentHelper.hashValue=e[fe[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[ve[this.keywordIndex]])||(this.documentHelper.saltValue=e[ve[this.keywordIndex]])},e.prototype.parseStyles=function(e,t){for(var i=0;i<e[ae[this.keywordIndex]].length;i++){var n=this.documentHelper.owner.editorModule;(!(0,a.isNullOrUndefined)(n)&&n.isRemoteAction||(0,a.isNullOrUndefined)(this.documentHelper.styles.findByName(e[ae[this.keywordIndex]][i][We[this.keywordIndex]])))&&this.parseStyle(e,e[ae[this.keywordIndex]][i],t)}},e.prototype.parseRevisions=function(e,t){for(var i=0;i<e[de[this.keywordIndex]].length;i++){var n=e[de[this.keywordIndex]][i];if(!(0,a.isNullOrUndefined)(n[jr[this.keywordIndex]])&&!(0,a.isNullOrUndefined)(n[_r[this.keywordIndex]])){var r=this.parseRevision(n),o=!0;if(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===this.getRevisionType(n[_r[this.keywordIndex]])&&this.isPaste&&this.documentHelper.owner.enableTrackChanges&&!this.documentHelper.owner.editorModule.isRemoteAction)continue;this.revisionCollection.containsKey(n[jr[this.keywordIndex]])||this.revisionCollection.add(n[jr[this.keywordIndex]],r)}else this.revisionCollection.add(n[jr[this.keywordIndex]],r);for(var s=0;s<t.length;s++)t[s].revisionID===r.revisionID&&(o=!1);o&&!this.documentHelper.owner.editorModule.isRemoteAction&&t.push(r)}}this.documentHelper.revisionsInternal=this.revisionCollection,this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},e.prototype.parseRevision=function(e){if(!(0,a.isNullOrUndefined)(e)){var t=new xa(this.viewer.owner,e[Ar[this.keywordIndex]],e[Vr[this.keywordIndex]]);return t.revisionID=e[jr[this.keywordIndex]],t.revisionType=this.getRevisionType(e[_r[this.keywordIndex]]),t}},e.prototype.checkAndApplyRevision=function(e,t,i){if(!(0,a.isNullOrUndefined)(t[dt[e]])&&t[dt[e]].length>0)for(var n=0;n<t[dt[e]].length;n++){var r=t[dt[e]][n];if(this.revisionCollection.containsKey(r)){this.referedRevisions.push(r);var o=this.revisionCollection.get(r);i instanceof ba||o.range.push(i),i.revisions.push(o),this.isPaste&&this.documentHelper.owner.editorModule.isRemoteAction&&i instanceof Ca&&this.documentHelper.owner.editorModule.remotePasteRevision.push(o)}}},e.prototype.parseComments=function(e,t){for(var i=0,n=0;n<e[le[this.keywordIndex]].length;n++){var r=e[le[this.keywordIndex]][n],o=void 0;for(o=this.parseComment(r,o);i<r[qr[this.keywordIndex]].length;){var s=void 0;(s=this.parseComment(r[qr[this.keywordIndex]][i],s)).ownerComment=o,s.isReply=!0,o.replyComments.push(s),this.commentsCollection.add(s.commentId,s),i++}this.commentsCollection.add(o.commentId,o),t.push(o),i=0}},e.prototype.parseComment=function(e,t){return(t=new Ld(e[Vr[this.keywordIndex]])).author=e[Ar[this.keywordIndex]],t.initial=e[Ur[this.keywordIndex]],t.commentId=e[Rr[this.keywordIndex]],t.isResolved=Pa.parseBoolValue(e[zr[this.keywordIndex]]),t.text=this.parseCommentText(e[Go[this.keywordIndex]]),t.mentions=this.parseCommentMentions(e[Go[this.keywordIndex]]),t.isPosted=!0,t},e.prototype.parseCommentText=function(e){for(var t="",i=!1,n=0;n<e.length;n++){if(0!==n&&(t+="<div>"),e[n][Qr[this.keywordIndex]].length>0)for(var r=e[n][Qr[this.keywordIndex]],o=0;o<r.length;o++){var s=r[o];if(0!==s[Cr[this.keywordIndex]]&&1!==s[Cr[this.keywordIndex]]&&2!==s[Cr[this.keywordIndex]]){var a=s[Dn[this.keywordIndex]];i?(t=t+'<span contenteditable="false" class="e-mention-chip">'+a+"</span>",i=!1):a&&(t+=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"))}else 0===s[Cr[this.keywordIndex]]?o++:2===s[Cr[this.keywordIndex]]&&(i=!0)}else t+=0===n?"<div><br></div>":"<br>";0!==n&&(t+="</div>")}return t},e.prototype.parseCommentMentions=function(e){for(var t=[],i=!1,n=!1,r=0;r<e.length;r++)for(var o=e[r][Qr[this.keywordIndex]],s={},a=0;a<o.length;a++){var l=o[a];if(0!==l[Cr[this.keywordIndex]]&&1!==l[Cr[this.keywordIndex]]&&2!==l[Cr[this.keywordIndex]]){var d=l[Dn[this.keywordIndex]];if(i){var h=d.replace(/.*"(.*)".*/,"$1");h=h.replace("mailto:",""),s.value=h,i=!1}else n&&(s.text=d,n=!1,t.push(s),s={})}else 0===l[Cr[this.keywordIndex]]?i=!0:2===l[Cr[this.keywordIndex]]&&(n=!0)}return t},e.prototype.parseStyle=function(e,t,i,n){var r,o=0,s=this.documentHelper.owner.editorModule;if(!(0,a.isNullOrUndefined)(n)&&n&&(o=this.keywordIndex,this.keywordIndex=0),!(0,a.isNullOrUndefined)(t[Ms[this.keywordIndex]])){if("Paragraph"===this.getStyleType(t[Ms[this.keywordIndex]])&&((r=new Wa).type="Paragraph"),"Character"===this.getStyleType(t[Ms[this.keywordIndex]])&&((r=new Oa).type="Character"),"Table"===this.getStyleType(t[Ms[this.keywordIndex]])&&((r=new Ba).type="Table"),(0,a.isNullOrUndefined)(t[We[this.keywordIndex]])||(r.name=t[We[this.keywordIndex]]),i.push(r),!(0,a.isNullOrUndefined)(t[Oe[this.keywordIndex]])){var l=void 0;if(l=!(0,a.isNullOrUndefined)(s)&&s.isRemoteAction?this.documentHelper.styles.findByName(t[Oe[this.keywordIndex]]):i.findByName(t[Oe[this.keywordIndex]]),(0,a.isNullOrUndefined)(l)){var d=this.getStyle(t[Oe[this.keywordIndex]],e),h=void 0;(0,a.isNullOrUndefined)(d)||this.getStyleType(d[Ms[this.keywordIndex]])!==r.type?"Paragraph"===r.type?h=JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):"Character"===r.type&&(h=JSON.parse('{"type": "Character","name": "Default Paragraph Font"}')):h=d,this.parseStyle(e,h,i),!(0,a.isNullOrUndefined)(s)&&s.isRemoteAction?r.basedOn=this.documentHelper.styles.findByName(h[We[this.keywordIndex]]):r.basedOn=i.findByName(h[We[this.keywordIndex]])}else if(l.type===r.type&&l.name!==r.name){r.basedOn=l;var c=this.getStyle(t[Oe[this.keywordIndex]],e);this.isPaste&&!(0,a.isNullOrUndefined)(c)&&"Paragraph"===r.type&&"Paragraph"===this.getStyleType(c[Ms[this.keywordIndex]])&&this.updateParagraphFormatFromBaseStyle(t,c)}}if(!(0,a.isNullOrUndefined)(t[Le[this.keywordIndex]])){var p=i.findByName(t[Le[this.keywordIndex]]),u=this.getStyle(t[Le[this.keywordIndex]],e);!(0,a.isNullOrUndefined)(s)&&s.isRemoteAction&&(p=this.documentHelper.styles.findByName(t[Le[this.keywordIndex]]));h=void 0;if((0,a.isNullOrUndefined)(p)){if((0,a.isNullOrUndefined)(u)){var g={};g[ie[this.keywordIndex]]=t[ie[this.keywordIndex]],g[We[this.keywordIndex]]=t[We[this.keywordIndex]]+" Char",g[Ms[this.keywordIndex]]="Character",g[Oe[this.keywordIndex]]="Normal"===t[Oe[this.keywordIndex]]?"Default Paragraph Font":t[Oe[this.keywordIndex]]+" Char",h=g}else h=u;this.parseStyle(e,h,i);var m=void 0;!(0,a.isNullOrUndefined)(s)&&s.isRemoteAction?(m=this.documentHelper.styles.findByName(h[We[this.keywordIndex]]),r.link=(0,a.isNullOrUndefined)(m)?t[Le[this.keywordIndex]]:m):(m=i.findByName(h[We[this.keywordIndex]]),r.link=(0,a.isNullOrUndefined)(m)?t[Le[this.keywordIndex]]:m)}else r.link=p}if((0,a.isNullOrUndefined)(t[ie[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,t[ie[this.keywordIndex]],r.characterFormat),(0,a.isNullOrUndefined)(t[ne[this.keywordIndex]])||this.parseParagraphFormat(this.keywordIndex,t[ne[this.keywordIndex]],r.paragraphFormat),!(0,a.isNullOrUndefined)(t[Be[this.keywordIndex]]))if(t[Be[this.keywordIndex]]===t[We[this.keywordIndex]])r.next=r;else{var f=void 0;if(f=!(0,a.isNullOrUndefined)(s)&&s.isRemoteAction?this.documentHelper.styles.findByName(t[Be[this.keywordIndex]]):i.findByName(t[Be[this.keywordIndex]]),(0,a.isNullOrUndefined)(f)||f.type!==r.type){var v=this.getStyle(t[Be[this.keywordIndex]],e);(0,a.isNullOrUndefined)(v)?r.next=r:(this.parseStyle(e,v,i),!(0,a.isNullOrUndefined)(s)&&s.isRemoteAction?r.next=this.documentHelper.styles.findByName(v.name):r.next=i.findByName(v.name))}else r.next=f}}!(0,a.isNullOrUndefined)(n)&&n&&(this.keywordIndex=o),(0,a.isNullOrUndefined)(r)||"Table"===r.type||this.documentHelper.addToStylesMap(r)},e.prototype.updateParagraphFormatFromBaseStyle=function(e,t){if(!(0,a.isNullOrUndefined)(e[ne[this.keywordIndex]])&&!(0,a.isNullOrUndefined)(t[ne[this.keywordIndex]])){var i=e[ne[this.keywordIndex]],n=t[ne[this.keywordIndex]];!i.hasOwnProperty(gt[this.keywordIndex])&&n.hasOwnProperty(gt[this.keywordIndex])&&(i[gt[this.keywordIndex]]=n[gt[this.keywordIndex]]),!i.hasOwnProperty(mt[this.keywordIndex])&&n.hasOwnProperty(mt[this.keywordIndex])&&(i[mt[this.keywordIndex]]=n[mt[this.keywordIndex]]),!i.hasOwnProperty(wt[this.keywordIndex])&&n.hasOwnProperty(wt[this.keywordIndex])&&(i[wt[this.keywordIndex]]=n[wt[this.keywordIndex]]),!i.hasOwnProperty(yt[this.keywordIndex])&&n.hasOwnProperty(yt[this.keywordIndex])&&(i[yt[this.keywordIndex]]=n[yt[this.keywordIndex]]),!i.hasOwnProperty(xt[this.keywordIndex])&&n.hasOwnProperty(xt[this.keywordIndex])&&(i[xt[this.keywordIndex]]=n[xt[this.keywordIndex]]),!i.hasOwnProperty(It[this.keywordIndex])&&n.hasOwnProperty(It[this.keywordIndex])&&(i[It[this.keywordIndex]]=n[It[this.keywordIndex]]),!i.hasOwnProperty(vt[this.keywordIndex])&&n.hasOwnProperty(vt[this.keywordIndex])&&(i[vt[this.keywordIndex]]=n[vt[this.keywordIndex]]),!i.hasOwnProperty(Tt[this.keywordIndex])&&n.hasOwnProperty(Tt[this.keywordIndex])&&(i[Tt[this.keywordIndex]]=n[Tt[this.keywordIndex]]),!i.hasOwnProperty(Ht[this.keywordIndex])&&n.hasOwnProperty(Ht[this.keywordIndex])&&(i[Ht[this.keywordIndex]]=n[Ht[this.keywordIndex]]),!i.hasOwnProperty(Ft[this.keywordIndex])&&n.hasOwnProperty(Ft[this.keywordIndex])&&(i[Ft[this.keywordIndex]]=n[Ft[this.keywordIndex]]),!i.hasOwnProperty(St[this.keywordIndex])&&n.hasOwnProperty(St[this.keywordIndex])&&(i[St[this.keywordIndex]]=n[St[this.keywordIndex]]),!i.hasOwnProperty(Pt[this.keywordIndex])&&n.hasOwnProperty(Pt[this.keywordIndex])&&(i[Pt[this.keywordIndex]]=n[Pt[this.keywordIndex]])}},e.prototype.getStyle=function(e,t){for(var i=0;i<t[ae[this.keywordIndex]].length;i++)if(t[ae[this.keywordIndex]][i][We[this.keywordIndex]]===e)return t[ae[this.keywordIndex]][i]},e.prototype.parseAbstractList=function(e,t){for(var i=0;i<e[oe[this.keywordIndex]].length;i++){var n=new Aa,r=e[oe[this.keywordIndex]][i];if(!(0,a.isNullOrUndefined)(r)&&((0,a.isNullOrUndefined)(r[ls[this.keywordIndex]])||(n.abstractListId=r[ls[this.keywordIndex]]),(0,a.isNullOrUndefined)(r[ds])||(n.nsid=r[ds]),!(0,a.isNullOrUndefined)(r[hs[this.keywordIndex]])))for(var o=0;o<r[hs[this.keywordIndex]].length;o++){var s=r[hs[this.keywordIndex]][o];if(!(0,a.isNullOrUndefined)(s)){var l=this.parseListLevel(s,n);n.levels.push(l)}}t.push(n)}},e.prototype.parseListLevel=function(e,t){var i=new Va(t);return"Bullet"===this.getListLevelPattern(e[ts[this.keywordIndex]])?(i.listLevelPattern="Bullet",i.numberFormat=(0,a.isNullOrUndefined)(e[ss[this.keywordIndex]])?"":e[ss[this.keywordIndex]]):(i.listLevelPattern=this.getListLevelPattern(e[ts[this.keywordIndex]]),i.startAt=e[ns[this.keywordIndex]],i.numberFormat=(0,a.isNullOrUndefined)(e[ss[this.keywordIndex]])?"":e[ss[this.keywordIndex]],e[rs[this.keywordIndex]]>=0?i.restartLevel=e[rs[this.keywordIndex]]:i.restartLevel=e[os[this.keywordIndex]]),i.paraStyleName=(0,a.isNullOrUndefined)(e[as[this.keywordIndex]])?"":e[as[this.keywordIndex]],i.isLegalStyleNumbering=!(0,a.isNullOrUndefined)(e[Oo[this.keywordIndex]])&&Pa.parseBoolValue(e[Oo[this.keywordIndex]]),i.followCharacter=this.getFollowCharacterType(e[is[this.keywordIndex]]),this.parseCharacterFormat(this.keywordIndex,e[ie[this.keywordIndex]],i.characterFormat),this.parseParagraphFormat(this.keywordIndex,e[ne[this.keywordIndex]],i.paragraphFormat),i},e.prototype.parseList=function(e,t){for(var i=0;i<e[re[this.keywordIndex]].length;i++){var n=new zh,r=e[re[this.keywordIndex]][i];(0,a.isNullOrUndefined)(r[ls[this.keywordIndex]])||(n.abstractListId=r[ls[this.keywordIndex]],n.abstractList=this.documentHelper.getAbstractListById(r[ls[this.keywordIndex]])),t.push(n),(0,a.isNullOrUndefined)(r[ht[this.keywordIndex]])||(n.listId=r[ht[this.keywordIndex]]),(0,a.isNullOrUndefined)(r[ds])?n.nsid=n.abstractList.nsid:n.nsid=r[ds],r.hasOwnProperty(ps[this.keywordIndex])&&this.parseLevelOverride(r[ps[this.keywordIndex]],n)}},e.prototype.parseLevelOverride=function(e,t){if(!(0,a.isNullOrUndefined)(e))for(var i=0;i<e.length;i++){var n=new Ua,r=e[i];n.startAt=r[ns[this.keywordIndex]],n.levelNumber=r[os[this.keywordIndex]],(0,a.isNullOrUndefined)(r[cs[this.keywordIndex]])||(n.overrideListLevel=this.parseListLevel(r[cs[this.keywordIndex]],n)),t.levelOverrides.push(n)}},e.prototype.parseSections=function(e,t){for(var i=0;i<e.length;i++){var n=new Ol;n.sectionFormat=new ga(n),n.index=i;var r,o=e[i],s=e[i+1],l=s&&s[es[this.keywordIndex]]?s[es[this.keywordIndex]]:void 0;r=l&&l[ti[this.keywordIndex]]?l[ti[this.keywordIndex]]:"NewPage",(0,a.isNullOrUndefined)(o[es[this.keywordIndex]])||this.parseSectionFormat(this.keywordIndex,o[es[this.keywordIndex]],n.sectionFormat),(0,a.isNullOrUndefined)(o[$o[this.keywordIndex]])&&(o[$o[this.keywordIndex]]={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(o[$o[this.keywordIndex]],this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(o[Go[this.keywordIndex]],n,i+1<e.length,r);for(var d=0;d<n.childWidgets.length;d++)n.childWidgets[d].containerWidget=n;t.push(n)}},e.prototype.parseHeaderFooter=function(e,t){this.isParseHeader=!0;var i={};if(!(0,a.isNullOrUndefined)(e[Ko[this.keywordIndex]])){var n=new Bl("OddHeader");i[0]=n,this.parseTextBody(e[Ko[this.keywordIndex]][Go[this.keywordIndex]],n)}if(!(0,a.isNullOrUndefined)(e[Xo[this.keywordIndex]])){var r=new Bl("OddFooter");i[1]=r,this.parseTextBody(e[Xo[this.keywordIndex]][Go[this.keywordIndex]],r)}if(!(0,a.isNullOrUndefined)(e[Zo[this.keywordIndex]])){var o=new Bl("EvenHeader");i[2]=o,this.parseTextBody(e[Zo[this.keywordIndex]][Go[this.keywordIndex]],o)}if(!(0,a.isNullOrUndefined)(e[Jo[this.keywordIndex]])){var s=new Bl("EvenFooter");i[3]=s,this.parseTextBody(e[Jo[this.keywordIndex]][Go[this.keywordIndex]],s)}if(!(0,a.isNullOrUndefined)(e[Yo[this.keywordIndex]])){var l=new Bl("FirstPageHeader");i[4]=l,this.parseTextBody(e[Yo[this.keywordIndex]][Go[this.keywordIndex]],l)}if(!(0,a.isNullOrUndefined)(e[Qo[this.keywordIndex]])){var d=new Bl("FirstPageFooter");i[5]=d,this.parseTextBody(e[Qo[this.keywordIndex]][Go[this.keywordIndex]],d)}return i},e.prototype.parseTextBody=function(e,t,i,n){this.parseBody(e,t.childWidgets,t,i,void 0,void 0,n)},e.prototype.addCustomStyles=function(e){if(!(0,a.isNullOrUndefined)(e[ae[this.keywordIndex]]))for(var t=0;t<e[ae[this.keywordIndex]].length;t++){void 0===this.documentHelper.styles.findByName(e[ae[this.keywordIndex]][t][We[this.keywordIndex]])&&this.parseStyle(e,e[ae[this.keywordIndex]][t],this.documentHelper.styles)}},e.prototype.parseBody=function(e,t,i,n,r,o,s,l){if(!(0,a.isNullOrUndefined)(e))for(var d=0;d<e.length;d++){var h=e[d],c=!1;if(h.hasOwnProperty(Qr[this.keywordIndex])){var p=new Rl;if(p.characterFormat=new ka(p),p.paragraphFormat=new ba(p),h[Qr[this.keywordIndex]].length>0&&(c=this.parseParagraph(h[Qr[this.keywordIndex]],p,!1,void 0,l&&0===d)),!n||h!==e[e.length-1]||0!==h[Qr[this.keywordIndex]].length||c){this.parseCharacterFormat(this.keywordIndex,h[ie[this.keywordIndex]],p.characterFormat),this.parseParagraphFormat(this.keywordIndex,h[ne[this.keywordIndex]],p.paragraphFormat);var u,g="Normal";(0,a.isNullOrUndefined)(h[ne[this.keywordIndex]])||(0,a.isNullOrUndefined)(h[ne[this.keywordIndex]][Je[this.keywordIndex]])||(g=h[ne[this.keywordIndex]][Je[this.keywordIndex]],!0),u=this.documentHelper.styles.findByName(g,"Paragraph"),(0,a.isNullOrUndefined)(u)||p.paragraphFormat.applyStyle(u),t.push(p)}else n&&1===e.length||(p.isSectionBreak=!0),t.push(p);p.index=t.length-1,p.containerWidget=i}else if(h.hasOwnProperty(Eo[this.keywordIndex]))this.parseTable(h,t,t.length,i);else if(h.hasOwnProperty($r[this.keywordIndex])){var m=new id("Block"),f=new id("Block");this.parseContentControlProperties(h[$r[this.keywordIndex]],m.contentControlProperties),f.contentControlProperties=m.contentControlProperties,m.type=0,f.type=1,this.parseBody(h[Go[this.keywordIndex]],t,i,n,m.contentControlProperties);for(var v=0;v<2;v++){var y=t.length<h[Go[this.keywordIndex]].length?t[0]:0===v?t[t.length-h[Go[this.keywordIndex]].length]:t[t.length-1],w=void 0;if(y instanceof Rl)w=y;else if(y instanceof Al){if(0===v)w=y.firstChild.firstChild.firstChild;else w=y.lastChild.lastChild.lastChild}if(!(0,a.isNullOrUndefined)(w)&&0===w.childWidgets.length){var b=new zl(w);w.childWidgets.push(b)}0===v?(w.firstChild.children.splice(0,0,m),m.line=w.firstChild):(w.lastChild.children.push(f),f.line=w.lastChild)}}(0,a.isNullOrUndefined)(r)||(t[t.length-1].contentControlProperties=r)}},e.prototype.parseTable=function(e,t,i,n){var r=new Al;r.index=i,(0,a.isNullOrUndefined)(e[Lo[this.keywordIndex]])||this.parseTableFormat(e[Lo[this.keywordIndex]],r.tableFormat,this.keywordIndex),r.tableFormat.title=e[no[this.keywordIndex]],r.tableFormat.description=e[No[this.keywordIndex]],this.parseTablePositioning(e,r);for(var o=0;o<e[Eo[this.keywordIndex]].length;o++){var s=new Ul;s.rowFormat=new Ca(s);var l=e[Eo[this.keywordIndex]][o];if((0,a.isNullOrUndefined)(l[$r[this.keywordIndex]])||(s.contentControlProperties=new nd("Row"),this.parseContentControlProperties(l[$r[this.keywordIndex]],s.contentControlProperties)),l.hasOwnProperty(To[this.keywordIndex])){this.parseRowFormat(l[To[this.keywordIndex]],s.rowFormat,this.keywordIndex),s.index=o;for(var d=0;d<l[Ho[this.keywordIndex]].length;d++){var h=new Vl;h.cellFormat=new Ma(h);var c=l[Ho[this.keywordIndex]][d];(0,a.isNullOrUndefined)(c[$r[this.keywordIndex]])||(h.contentControlProperties=new nd("Cell"),this.parseContentControlProperties(c[$r[this.keywordIndex]],h.contentControlProperties)),s.childWidgets.push(h),h.containerWidget=s,h.index=d,h.rowIndex=o,h.columnIndex=d,c.hasOwnProperty(So[this.keywordIndex])&&this.parseCellFormat(c[So[this.keywordIndex]],h.cellFormat,this.keywordIndex);for(var p=c[Go[this.keywordIndex]],u=0;u<p.length;u++)p[u].hasOwnProperty([Eo[this.keywordIndex]])&&(r.isContainInsideTable=!0);if(this.isPageBreakInsideTable=!0,this.parseTextBody(c[Go[this.keywordIndex]],h,!1),!(0,a.isNullOrUndefined)(h.contentControlProperties)){var g=new id("Cell"),m=new id("Cell");if(g.contentControlProperties=h.contentControlProperties,m.contentControlProperties=h.contentControlProperties,g.type=0,m.type=1,0===h.firstChild.childWidgets.length){var f=new zl(h.firstChild);h.firstChild.childWidgets.push(f)}if(g.line=h.firstChild.firstChild,h.firstChild.firstChild.children.splice(0,0,g),0===h.lastChild.childWidgets.length){f=new zl(h.lastChild);h.lastChild.childWidgets.push(f)}m.line=h.lastChild.lastChild,h.lastChild.lastChild.children.push(m)}if(!(0,a.isNullOrUndefined)(s.contentControlProperties))if(s.firstChild===h){var v=new id("Row");if(v.contentControlProperties=s.contentControlProperties,v.type=0,0===h.firstChild.childWidgets.length){f=new zl(h.firstChild);h.firstChild.childWidgets.push(f)}v.line=h.firstChild.firstChild,h.firstChild.firstChild.children.splice(0,0,v)}else if(s.lastChild===h){var y=new id("Row");if(y.contentControlProperties=s.contentControlProperties,y.type=1,0===h.lastChild.childWidgets.length){f=new zl(h.lastChild);h.lastChild.childWidgets.push(f)}y.line=h.lastChild.lastChild,h.lastChild.lastChild.children.push(y)}this.isPageBreakInsideTable=!1}}s.childWidgets.length>0&&(r.childWidgets.push(s),s.containerWidget=r)}r.containerWidget=n,r.childWidgets.length>0&&t.push(r),r.isGridUpdated=!1},e.prototype.parseTablePositioning=function(e,t){t.wrapTextAround=!(0,a.isNullOrUndefined)(e[Wo[this.keywordIndex]])&&Pa.parseBoolValue(e[Wo[this.keywordIndex]]),t.wrapTextAround&&(t.positioning=new Ml,t.positioning.allowOverlap=Pa.parseBoolValue(e[Bo[this.keywordIndex]][Do[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][Uo[this.keywordIndex]])||(t.positioning.distanceBottom=Pa.convertPointToPixel(e[Bo[this.keywordIndex]][Uo[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][Ao[this.keywordIndex]])||(t.positioning.distanceLeft=Pa.convertPointToPixel(e[Bo[this.keywordIndex]][Ao[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][Mo[this.keywordIndex]])||(t.positioning.distanceRight=Pa.convertPointToPixel(e[Bo[this.keywordIndex]][Mo[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][Ro[this.keywordIndex]])||(t.positioning.distanceTop=Pa.convertPointToPixel(e[Bo[this.keywordIndex]][Ro[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][oi[this.keywordIndex]])||(t.positioning.verticalAlignment=this.getTableVerticalPosition(e[Bo[this.keywordIndex]][oi[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][Vo[this.keywordIndex]])||(t.positioning.verticalOrigin=this.getTableVerticalRelation(e[Bo[this.keywordIndex]][Vo[this.keywordIndex]])),t.positioning.verticalPosition=e[Bo[this.keywordIndex]][zo[this.keywordIndex]],(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][_o[this.keywordIndex]])||(t.positioning.horizontalAlignment=this.getTableHorizontalPosition(e[Bo[this.keywordIndex]][_o[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[Bo[this.keywordIndex]][qo[this.keywordIndex]])||(t.positioning.horizontalOrigin=this.getTableHorizontalRelation(e[Bo[this.keywordIndex]][qo[this.keywordIndex]])),t.positioning.horizontalPosition=e[Bo[this.keywordIndex]][jo[this.keywordIndex]])},e.prototype.parseRowGridValues=function(e,t,i){(0,a.isNullOrUndefined)(e[ci[i]])||(t.gridBefore=e[ci[i]]),(0,a.isNullOrUndefined)(e[pi[i]])||(t.gridBeforeWidth=e[pi[i]]),(0,a.isNullOrUndefined)(e[ui[i]])||(t.gridBeforeWidthType=this.getWidthType(e[ui[i]])),(0,a.isNullOrUndefined)(e[gi[i]])||(t.gridAfter=e[gi[i]]),(0,a.isNullOrUndefined)(e[mi[i]])||(t.gridAfterWidth=e[mi[i]]),(0,a.isNullOrUndefined)(e[fi[i]])||(t.gridAfterWidthType=this.getWidthType(e[fi[i]]))},e.prototype.parseContentControlProperties=function(e,t,i){if((0,a.isNullOrUndefined)(i)&&(i=this.keywordIndex),(0,a.isNullOrUndefined)(e[eo[i]])||(t.lockContentControl=Pa.parseBoolValue(e[eo[i]])),(0,a.isNullOrUndefined)(e[to[i]])||(t.lockContents=Pa.parseBoolValue(e[to[i]])),(0,a.isNullOrUndefined)(e[io[i]])?t.tag=void 0:t.tag=e[io[i]],(0,a.isNullOrUndefined)(e[or[i]])||(t.color=e[or[i]]),(0,a.isNullOrUndefined)(e[no[i]])?t.title=void 0:t.title=e[no[i]],(0,a.isNullOrUndefined)(e[Zs[i]])||(t.appearance=this.getContentControlAppearance(e[Zs[i]])),(0,a.isNullOrUndefined)(e[Ms[i]])||(t.type=this.getContentControlType(e[Ms[i]])),(0,a.isNullOrUndefined)(e[ro[i]])||(t.hasPlaceHolderText=Pa.parseBoolValue(e[ro[i]])),(0,a.isNullOrUndefined)(e[oo[i]])||(t.multiline=Pa.parseBoolValue(e[oo[i]])),(0,a.isNullOrUndefined)(e[so[i]])||(t.isTemporary=Pa.parseBoolValue(e[so[i]])),(0,a.isNullOrUndefined)(e[ie[i]])||this.parseCharacterFormat(i,e[ie[i]],t.characterFormat),"CheckBox"===t.type)(0,a.isNullOrUndefined)(e[po[i]])||(t.isChecked=Pa.parseBoolValue(e[po[i]])),(0,a.isNullOrUndefined)(e[uo[i]])||(t.uncheckedState=new od,t.uncheckedState.font=e[uo[i]][vo[i]],t.uncheckedState.value=e[uo[i]][yo[i]]),(0,a.isNullOrUndefined)(e[go[i]])||(t.checkedState=new od,t.checkedState.font=e[go[i]][vo[i]],t.checkedState.value=e[go[i]][yo[i]]);else if("Date"===t.type)(0,a.isNullOrUndefined)(e[ao[i]])||(t.dateCalendarType=this.getDateCalendarType(e[ao[i]])),(0,a.isNullOrUndefined)(e[lo[i]])||(t.dateStorageFormat=this.getDateStorageFormat(e[lo[i]])),(0,a.isNullOrUndefined)(e[ho[i]])||(t.dateDisplayLocale=e[ho[i]]),(0,a.isNullOrUndefined)(e[co[i]])||(t.dateDisplayFormat=e[co[i]]);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!(0,a.isNullOrUndefined)(e[mo[i]])){t.contentControlListItems=[];for(var n=0;n<e[mo[i]].length;n++){var r=new rd;r.displayText=e[mo[i]][n][wo[i]],r.value=e[mo[i]][n][yo[i]],t.contentControlListItems.push(r)}}(0,a.isNullOrUndefined)(e[fo[i]])||(t.xmlMapping=new sd,t.xmlMapping.isMapped=Pa.parseBoolValue(e[fo[i]][bo[i]]),t.xmlMapping.isWordMl=Pa.parseBoolValue(e[fo[i]][Co[i]]),(0,a.isNullOrUndefined)(e[fo[i]][xo[i]])||(t.xmlMapping.prefixMapping=e[fo[i]][xo[i]]),t.xmlMapping.xPath=e[fo[i]][Io[i]],t.xmlMapping.storeItemId=e[fo[i]][ko[i]],(0,a.isNullOrUndefined)(e[fo[i]][Fo[i]])||(t.xmlMapping.customXmlPart=new ad,t.xmlMapping.customXmlPart.id=e[fo[i]][Fo[i]][Po[i]],t.xmlMapping.customXmlPart.xml=e[fo[i]][Fo[i]][Kr[i]]))},e.prototype.parseSymbol=function(e,t){var i=e.split(" "),n=i.indexOf("SYMBOL");if(-1!==n){var r=i[n+1],o=new Zl;o.characterFormat=new ka(o),o.text=String.fromCharCode(parseInt(r));var s=i.indexOf("\\f");if(-1!==s){for(var a="",l=s+1;l<i.length&&"\\s"!==i[l];l++)a+=i[l]+" ";null!==a&&(a=(a=a.replace(/"/g,"")).trim(),o.characterFormat.fontFamily=a)}var d=i.indexOf("\\s");-1!==d&&(o.characterFormat.fontSize=parseInt(i[d+1])),o.line=t,t.children.push(o)}},e.prototype.parseParagraph=function(e,t,i,n,r){var o=this,s=!1;(0,a.isNullOrUndefined)(n)?n=new zl(t):s=!0;for(var l,d,h=!1,c=this.viewer.owner.enableTrackChanges,p=0,u=!1,g=!1,m=void 0,f=function(s){var f=e[s];if(u=!1,f.hasOwnProperty([Cr[v.keywordIndex]])&&(2===f[Cr[v.keywordIndex]]&&(p=s),1===f[Cr[v.keywordIndex]]&&p+1===s&&(u=!0,p=0)),u&&v.documentHelper.isPageField)return(y=new $l).characterFormat=new ka(y),y.text="",y.line=n,n.children.push(y),h=!0,s--,d=s,"continue";if(u&&!(0,a.isNullOrUndefined)(m)&&-1!==m.indexOf("SYMBOL")&&(v.parseSymbol(m,n),m=void 0,u=!1),f.hasOwnProperty(Dn[v.keywordIndex])||f.hasOwnProperty($e[v.keywordIndex])){var y=void 0;if(v.documentHelper.isPageField)(y=new $l).fieldBegin=v.documentHelper.fieldStacks[v.documentHelper.fieldStacks.length-1];else if("\t"===f[Dn[v.keywordIndex]])y=new ed;else{if("\f"===f[Dn[v.keywordIndex]]&&v.isPageBreakInsideTable)return d=s,"continue";if(f.hasOwnProperty($e[v.keywordIndex]))(y=new zd).breakClearType=v.getBreakClearType(f[$e[v.keywordIndex]]);else if(""===f[Dn[v.keywordIndex]]||Pa.checkTextFormat(f[Dn[v.keywordIndex]])&&0===n.children.length&&0===s&&r)y=new _d;else if(y=new Zl,0===f[Dn[v.keywordIndex]].length&&!(0,a.isNullOrUndefined)(f[dt[v.keywordIndex]]))return d=s,"continue"}if(y.characterFormat=new ka(y),v.parseCharacterFormat(v.keywordIndex,f[ie[v.keywordIndex]],y.characterFormat,i),v.applyCharacterStyle(f,y),y.text=y instanceof zd?"\v":f[Dn[v.keywordIndex]],m=y.text,v.isHtmlPaste&&(y instanceof Zl||y instanceof zd)){var w=void 0;n.children.length>0&&(w=n.children[n.children.length-1]),v.documentHelper.textHelper.isRTLText(y.text)?(y.characterFormat.bidi=!0,w instanceof Zl&&" "===w.text&&(w.characterFormat.bidi=!0)):" "===y.text&&w&&w.characterFormat.bidi&&(y.characterFormat.bidi=!0)}if(v.documentHelper.owner.parser.isPaste&&!v.isCutPerformed){if(!(0,a.isNullOrUndefined)(f[dt[v.keywordIndex]]))for(var b=0;b<f[dt[v.keywordIndex]].length;b++)if(v.revisionCollection.containsKey(f[dt[v.keywordIndex]][b])){if(c&&(l=v.revisionCollection.get(f[dt[v.keywordIndex]][b])),!(0,a.isNullOrUndefined)(l)&&n.children.length>0&&!(0,a.isNullOrUndefined)(n.children[s-1].revisions[b])&&(!c||c&&"Deletion"===l.revisionType)&&l.revisionID===f[dt[v.keywordIndex]][b]){f[dt[v.keywordIndex]][b]=n.children[s-1].revisions[b].revisionID,v.checkAndApplyRevision(v.keywordIndex,f,y);continue}c||(l=v.documentHelper.revisionsInternal.get(f[dt[v.keywordIndex]][b])),v.documentHelper.owner.editorModule.isRemoteAction?v.documentHelper.owner.editorModule.insertRevision(y,l.revisionType,l.author,void 0,void 0,!1,l.revisionID):v.documentHelper.owner.editorModule.insertRevision(y,l.revisionType,l.author,void 0,void 0,!1),f[dt[v.keywordIndex]][b]=y.revisions[b].revisionID}}else v.checkAndApplyRevision(v.keywordIndex,f,y);y.line=n;for(var C=n.children,x=C.length-1;C.length>0&&C[x]instanceof td&&!(0,a.isNullOrUndefined)(C[x].properties)&&!0===C[x].properties.isAfterParagraphMark;)x--;x!==C.length-1?C.splice(x+1,0,y):C.push(y),y instanceof Zl&&y.text.length>90&&Pa.splitWordByMaxLength(y,n,!0),h=!0}else if(f.hasOwnProperty(Xr[v.keywordIndex])){var I=new Yl;I.line=n,I.footnoteType=v.getFootnoteType(f[Xr[v.keywordIndex]]),"Footnote"===I.footnoteType?v.documentHelper.footnoteCollection.push(I):v.documentHelper.endnoteCollection.push(I),I.symbolCode=f[Zr[v.keywordIndex]],I.symbolFontName=f[Jr[v.keywordIndex]],I.customMarker=f[Yr[v.keywordIndex]],I.characterFormat=new ka(I),v.parseCharacterFormat(v.keywordIndex,f[ie[v.keywordIndex]],I.characterFormat,i),v.applyCharacterStyle(f,I),v.checkAndApplyRevision(v.keywordIndex,f,I),v.parseBody(f[Go[v.keywordIndex]],I.bodyWidget.childWidgets,I.bodyWidget,!1,void 0,void 0,void 0,!0),n.children.push(I),h=!0}else if(f.hasOwnProperty(Wn[v.keywordIndex])){v.documentHelper.owner.editorModule&&(v.documentHelper.owner.editorModule.chartType=!0);var k=new yd;k.title=f[Nn[v.keywordIndex]],k.type=f[Wn[v.keywordIndex]],k.chartGapWidth=f[On[v.keywordIndex]],k.chartOverlap=f[Bn[v.keywordIndex]],v.parseChartTitleArea(f[Pn[v.keywordIndex]],k.chartTitleArea),v.parseChartArea(f[Fn[v.keywordIndex]],k.chartArea),v.parseChartArea(f[Sn[v.keywordIndex]],k.chartPlotArea),v.parseChartLegend(f[Tn[v.keywordIndex]],k.chartLegend),v.parseChartData(f,k),v.parseChartCategoryAxis(f[Hn[v.keywordIndex]],k.chartPrimaryCategoryAxis),v.parseChartCategoryAxis(f[En[v.keywordIndex]],k.chartPrimaryValueAxis),null!=f[Ln[v.keywordIndex]]&&v.parseChartDataTable(f[Ln[v.keywordIndex]],k.chartDataTable),k.line=n,n.children.push(k),k.height=Pa.convertPointToPixel(f[qn[v.keywordIndex]]),k.width=Pa.convertPointToPixel(f[zn[v.keywordIndex]]);var F=new tp.ChartComponent;F.chartRender(f,v.keywordIndex),k.officeChart=F,F.chart.appendTo(k.targetElement),h=!0}else if(f.hasOwnProperty(lr[v.keywordIndex])){var P=new gd(Pa.parseBoolValue(f[cr[v.keywordIndex]]));P.isMetaFile=Pa.parseBoolValue(f[pr[v.keywordIndex]]),P.isCompressed=f[ta[v.keywordIndex]],P.metaFileImageString=f[dr[v.keywordIndex]],P.characterFormat=new ka(P),P.line=n,v.checkAndApplyRevision(v.keywordIndex,f,P),n.children.push(P);var S=Pa.formatClippedString(f[lr[v.keywordIndex]]).formatClippedString;if(v.validateImageUrl(S)?v.isPaste&&!(0,a.isNullOrUndefined)(v.documentHelper.owner.editorModule.pasteImageIndex)?(P.imageString=v.documentHelper.owner.editorModule.pasteImageIndex.get(f[lr[v.keywordIndex]]),(0,a.isNullOrUndefined)(f[dr[v.keywordIndex]])||(P.metaFileImageString=v.documentHelper.owner.editorModule.pasteImageIndex.get(f[dr[v.keywordIndex]]))):P.imageString=f[lr[v.keywordIndex]]:P.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC","NaN"===parseInt(f[lr[v.keywordIndex]]).toString()&&v.documentHelper.addBase64StringInCollection(P),P.width=Pa.convertPointToPixel(f[zn[v.keywordIndex]]),P.height=Pa.convertPointToPixel(f[qn[v.keywordIndex]]),!v.isContextBasedPaste){var T=v.documentHelper.getImageString(P);(0,a.isNullOrUndefined)(T)||!Pa.startsWith(T,"http://")&&!Pa.startsWith(T,"https://")||(P.element.crossOrigin="Anonymous",v.viewer.documentHelper.getBase64(T,P.width,P.height).then((function(e){o.viewer.documentHelper.images.get(parseInt(P.imageString))[1]=e,P.element.src=e}))),P.element.src=T}P.top=f[ur[v.keywordIndex]],P.left=f[fr[v.keywordIndex]],P.bottom=f[gr[v.keywordIndex]],P.right=f[mr[v.keywordIndex]],P.cropHeightScale=f[vr[v.keywordIndex]],P.cropWidthScale=f[yr[v.keywordIndex]],P.name=f[We[v.keywordIndex]],P.alternateText=f[Mn[v.keywordIndex]],P.title=f[no[v.keywordIndex]],P.visible=Pa.parseBoolValue(f[An[v.keywordIndex]]),P.widthScale=f[_n[v.keywordIndex]],P.heightScale=f[jn[v.keywordIndex]],P.verticalPosition=Pa.convertPointToPixel(f[zo[v.keywordIndex]]),P.verticalOrigin=v.getVerticalOrigin(f[Vo[v.keywordIndex]]),P.verticalAlignment=v.getShapeVerticalAlignment(f[oi[v.keywordIndex]]),P.horizontalPosition=Pa.convertPointToPixel(f[jo[v.keywordIndex]]),P.horizontalOrigin=v.getHorizontalOrigin(f[qo[v.keywordIndex]]),P.horizontalAlignment=v.getShapeHorizontalAlignment(f[_o[v.keywordIndex]]),P.allowOverlap=Pa.parseBoolValue(f[Do[v.keywordIndex]]),(0,a.isNullOrUndefined)(f[Xn[v.keywordIndex]])||(P.textWrappingStyle=v.getTextWrappingStyle(f[Xn[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Zn[v.keywordIndex]])||(P.textWrappingType=v.getTextWrappingType(f[Zn[v.keywordIndex]])),P.isBelowText=Pa.parseBoolValue(f[Un[v.keywordIndex]]),(0,a.isNullOrUndefined)(f[Uo[v.keywordIndex]])||(P.distanceBottom=Pa.convertPointToPixel(f[Uo[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Ao[v.keywordIndex]])||(P.distanceLeft=Pa.convertPointToPixel(f[Ao[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Mo[v.keywordIndex]])||(P.distanceRight=Pa.convertPointToPixel(f[Mo[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Ro[v.keywordIndex]])||(P.distanceTop=Pa.convertPointToPixel(f[Ro[v.keywordIndex]])),P.zOrderPosition=f[er[v.keywordIndex]],P.layoutInCell=Pa.parseBoolValue(f[tr[v.keywordIndex]]),(!(0,a.isNullOrUndefined)(f[ur[v.keywordIndex]])&&0!==f[ur[v.keywordIndex]]||!(0,a.isNullOrUndefined)(f[gr[v.keywordIndex]])&&0!==f[gr[v.keywordIndex]]||!(0,a.isNullOrUndefined)(f[fr[v.keywordIndex]])&&0!==f[fr[v.keywordIndex]]||!(0,a.isNullOrUndefined)(f[mr[v.keywordIndex]])&&0!==f[mr[v.keywordIndex]])&&(P.isCrop=!0),"Inline"!==v.getTextWrappingStyle(P.textWrappingStyle)&&t.floatingElements.push(P),v.parseCharacterFormat(v.keywordIndex,f[ie[v.keywordIndex]],P.characterFormat),h=!0}else if(f.hasOwnProperty(wr[v.keywordIndex])||f.hasOwnProperty(Cr[v.keywordIndex])&&0===f[Cr[v.keywordIndex]]){g=!0;var H=new _l(0);if(v.parseCharacterFormat(v.keywordIndex,f[ie[v.keywordIndex]],H.characterFormat,i),v.applyCharacterStyle(f,H),H.fieldCodeType=f.fieldCodeType,H.hasFieldEnd=f[wr[v.keywordIndex]],f.hasOwnProperty(br[v.keywordIndex])){var E=void 0;E=v.parseFormFieldData(v.keywordIndex,f,E),H.formFieldData=E,v.isContextBasedPaste||v.documentHelper.formFields.push(H)}v.documentHelper.fieldStacks.push(H),v.checkAndApplyRevision(v.keywordIndex,f,H),H.line=n,v.isContextBasedPaste||v.documentHelper.fields.push(H),n.children.push(H)}else if(f.hasOwnProperty([Cr[v.keywordIndex]])){var N=void 0;if(2===f[Cr[v.keywordIndex]]||1===f[Cr[v.keywordIndex]]&&g){if(N=new _l(2),v.parseCharacterFormat(v.keywordIndex,f[ie[v.keywordIndex]],N.characterFormat,i),v.checkAndApplyRevision(v.keywordIndex,f,N),v.fieldSeparator=N,v.documentHelper.fieldStacks.length>0)if(N.fieldBegin=v.documentHelper.fieldStacks[v.documentHelper.fieldStacks.length-1],N.fieldBegin.fieldSeparator=N,n.children.length>=2){var W=v.containsFieldBegin(n);if(!(0,a.isNullOrUndefined)(W)&&W instanceof Zl&&(W.text.match("PAGE")||W.text.match("page")))W.text.replace(/^\s+/g,"").startsWith("HYPERLINK")||(v.documentHelper.isPageField=!0)}1===f[Cr[v.keywordIndex]]&&g&&(s--,p=s),g=!1}else 1===f[Cr[v.keywordIndex]]&&(N=new _l(1),v.parseCharacterFormat(v.keywordIndex,f[ie[v.keywordIndex]],N.characterFormat,i),v.applyCharacterStyle(f,N),v.checkAndApplyRevision(v.keywordIndex,f,N),v.documentHelper.fieldStacks.length>0&&(N.fieldBegin=v.documentHelper.fieldStacks[v.documentHelper.fieldStacks.length-1],N.fieldBegin.fieldEnd=N),!(0,a.isNullOrUndefined)(N.fieldBegin)&&N.fieldBegin.fieldSeparator&&(N.fieldSeparator=N.fieldBegin.fieldSeparator,N.fieldBegin.fieldSeparator.fieldEnd=N,h=!0),v.documentHelper.fieldStacks.splice(v.documentHelper.fieldStacks.length-1,1),v.fieldSeparator=void 0,v.documentHelper.isPageField=!1,v.isContextBasedPaste||v.documentHelper.fieldCollection.push(N.fieldBegin),m=void 0);N.line=n,n.children.push(N)}else if(f.hasOwnProperty([fs[v.keywordIndex]])){var O=void 0;if((O=new td(f[fs[v.keywordIndex]])).name=f[We[v.keywordIndex]],O.properties=f[vs[v.keywordIndex]],(0,a.isNullOrUndefined)(f[vs[v.keywordIndex]])||((0,a.isNullOrUndefined)(f[vs[v.keywordIndex]][ra[v.keywordIndex]])||(O.properties.isAfterParagraphMark=Pa.parseBoolValue(f[vs[v.keywordIndex]][ra[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[vs[v.keywordIndex]][da[v.keywordIndex]])||(O.properties.isAfterTableMark=Pa.parseBoolValue(f[vs[v.keywordIndex]][da[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[vs[v.keywordIndex]][sa[v.keywordIndex]])||(O.properties.isAfterRowMark=Pa.parseBoolValue(f[vs[v.keywordIndex]][sa[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[vs[v.keywordIndex]][oa[v.keywordIndex]])||(O.properties.isAfterCellMark=Pa.parseBoolValue(f[vs[v.keywordIndex]][oa[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[vs[v.keywordIndex]][ks[v.keywordIndex]])||(O.properties.columnFirst=f[vs[v.keywordIndex]][ks[v.keywordIndex]]),(0,a.isNullOrUndefined)(f[vs[v.keywordIndex]][Fs[v.keywordIndex]])||(O.properties.columnLast=f[vs[v.keywordIndex]][Fs[v.keywordIndex]])),v.checkAndApplyRevision(v.keywordIndex,f,O),n.children.push(O),O.line=n,!v.isParseHeader||v.isPaste)if(0===f[fs[v.keywordIndex]]){var B=v.isPaste&&!v.documentHelper.bookmarks.containsKey(O.name);!v.isPaste||B&&!v.isContextBasedPaste?v.documentHelper.bookmarks.add(O.name,O):B||n.children.splice(n.children.indexOf(O),1)}else if(1===f[fs[v.keywordIndex]]&&v.documentHelper.bookmarks.containsKey(O.name)){var L=v.documentHelper.bookmarks.get(O.name),D=v.isPaste&&(0,a.isNullOrUndefined)(L.reference);!v.isPaste||D&&!v.isContextBasedPaste?(L.reference=O,O.reference=L,v.documentHelper.endBookmarksUpdated.push(O.name)):D||n.children.splice(n.children.indexOf(O),1)}0!==O.name.indexOf("_")&&(h=!0)}else if(f.hasOwnProperty([Is[v.keywordIndex]])){if(f.hasOwnProperty(Ts[v.keywordIndex])){var R=new fd;if(v.editableRanges.containsKey(f[Is[v.keywordIndex]])){var M=v.editableRanges.get(f[Is[v.keywordIndex]]);R.editRangeStart=M,M.editRangeEnd=R,(0,a.isNullOrUndefined)(f[Is[v.keywordIndex]])||(R.editRangeId=f[Is[v.keywordIndex]]),v.editableRanges.remove(f[Is[v.keywordIndex]])}n.children.push(R),R.line=n}else{var A=v.parseEditableRangeStart(f);n.children.push(A),A.line=n,v.editableRanges.containsKey(f[Is[v.keywordIndex]])||v.editableRanges.add(f[Is[v.keywordIndex]],A)}h=!0}else if(f.hasOwnProperty([Rr[v.keywordIndex]])){var U=f[Rr[v.keywordIndex]],V=void 0;v.commentStarts.containsKey(U)&&v.commentStarts.get(U);if(v.commentEnds.containsKey(U)&&v.commentEnds.get(U),f.hasOwnProperty([Mr[v.keywordIndex]])){if(0===f[Mr[v.keywordIndex]]){var z=new Bd(0);z.commentId=U,v.commentStarts.containsKey(U)||v.commentStarts.add(U,z),z.line=n,n.children.push(z),V=v.commentsCollection.get(U),(0,a.isNullOrUndefined)(V)||(V.commentStart=z,z.comment=V)}else{var q=new Bd(1);q.commentId=U,v.commentEnds.containsKey(U)||v.commentEnds.add(U,q),q.line=n,n.children.push(q),V=v.commentsCollection.get(U),(0,a.isNullOrUndefined)(V)||(V.commentEnd=q,q.comment=V)}!(0,a.isNullOrUndefined)(V)&&V.isReply&&((0,a.isNullOrUndefined)(V.ownerComment.commentStart)&&(V.ownerComment.commentStart=V.commentStart),(0,a.isNullOrUndefined)(V.ownerComment.commentEnd)&&(V.ownerComment.commentEnd=V.commentEnd))}}else if(f.hasOwnProperty([Rn[v.keywordIndex]])){var _=new hd;if(_.shapeId=f[Rn[v.keywordIndex]],_.name=f[We[v.keywordIndex]],_.alternateText=f[Mn[v.keywordIndex]],_.title=f[no[v.keywordIndex]],_.visible=Pa.parseBoolValue(f[An[v.keywordIndex]]),_.width=Pa.convertPointToPixel(f[zn[v.keywordIndex]]),_.height=Pa.convertPointToPixel(f[qn[v.keywordIndex]]),0===_.height&&(_.isZeroHeight=!0),_.widthScale=f[_n[v.keywordIndex]],_.heightScale=f[jn[v.keywordIndex]],_.verticalPosition=Pa.convertPointToPixel(f[zo[v.keywordIndex]]),_.verticalOrigin=v.getVerticalOrigin(f[Vo[v.keywordIndex]]),_.verticalAlignment=v.getShapeVerticalAlignment(f[oi[v.keywordIndex]]),_.verticalRelativePercent=f[Jn[v.keywordIndex]],_.horizontalPosition=Pa.convertPointToPixel(f[jo[v.keywordIndex]]),_.horizontalOrigin=v.getHorizontalOrigin(f[qo[v.keywordIndex]]),_.horizontalAlignment=v.getShapeHorizontalAlignment(f[_o[v.keywordIndex]]),_.horizontalRelativePercent=f[Yn[v.keywordIndex]],_.heightRelativePercent=f[Qn[v.keywordIndex]],_.widthRelativePercent=f[$n[v.keywordIndex]],_.zOrderPosition=f[er[v.keywordIndex]],_.allowOverlap=Pa.parseBoolValue(f[Do[v.keywordIndex]]),_.textWrappingStyle=v.getTextWrappingStyle(f[Xn[v.keywordIndex]]),_.textWrappingType=v.getTextWrappingType(f[Zn[v.keywordIndex]]),_.isBelowText=Pa.parseBoolValue(f[Un[v.keywordIndex]]),_.isHorizontalRule=Pa.parseBoolValue(f[Vn[v.keywordIndex]]),(0,a.isNullOrUndefined)(f[Uo[v.keywordIndex]])||(_.distanceBottom=Pa.convertPointToPixel(f[Uo[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Ao[v.keywordIndex]])||(_.distanceLeft=Pa.convertPointToPixel(f[Ao[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Mo[v.keywordIndex]])||(_.distanceRight=Pa.convertPointToPixel(f[Mo[v.keywordIndex]])),(0,a.isNullOrUndefined)(f[Ro[v.keywordIndex]])||(_.distanceTop=Pa.convertPointToPixel(f[Ro[v.keywordIndex]])),_.layoutInCell=Pa.parseBoolValue(f[tr[v.keywordIndex]]),_.lockAnchor=Pa.parseBoolValue(f[ir[v.keywordIndex]]),_.autoShapeType=v.getAutoShapeType(f[nr[v.keywordIndex]]),_.editingPoints=f[ca[v.keywordIndex]],f.hasOwnProperty(Gn[v.keywordIndex])){var j=new pd;j.line=Pa.parseBoolValue(f[Gn[v.keywordIndex]][Ui[v.keywordIndex]]),j.lineFormatType=v.getLineFormatType(f[Gn[v.keywordIndex]][Js[v.keywordIndex]]),j.color=f[Gn[v.keywordIndex]][or[v.keywordIndex]],j.weight=f[Gn[v.keywordIndex]][Qs[v.keywordIndex]],j.dashStyle=v.getLineDashStyle(f[Gn[v.keywordIndex]][Oi[v.keywordIndex]]),_.lineFormat=j}if(f.hasOwnProperty(Kn[v.keywordIndex])){var G=new ud;G.color=f[Kn[v.keywordIndex]][or[v.keywordIndex]],G.fill=Pa.parseBoolValue(f[Kn[v.keywordIndex]][sr[v.keywordIndex]]),_.fillFormat=G}if(f.hasOwnProperty(rr[v.keywordIndex])){var K=new cd;if(K.textVerticalAlignment=v.getTextVerticalAlignment(f[rr[v.keywordIndex]][ar[v.keywordIndex]]),K.marginLeft=Pa.convertPointToPixel(f[rr[v.keywordIndex]][Mt[v.keywordIndex]]),K.marginRight=Pa.convertPointToPixel(f[rr[v.keywordIndex]][At[v.keywordIndex]]),K.marginTop=Pa.convertPointToPixel(f[rr[v.keywordIndex]][Ut[v.keywordIndex]]),K.marginBottom=Pa.convertPointToPixel(f[rr[v.keywordIndex]][Vt[v.keywordIndex]]),0===f[rr[v.keywordIndex]][Go[v.keywordIndex]].length&&"DownArrow"===_.autoShapeType){var X=1===v.keywordIndex?{i:[]}:{inlines:[]};f[rr[v.keywordIndex]][Go[v.keywordIndex]].push(X)}v.parseBody(f[rr[v.keywordIndex]][Go[v.keywordIndex]],K.childWidgets,K),_.textFrame=K,K.containerShape=_}_.line=n,v.checkAndApplyRevision(v.keywordIndex,f,_),n.children.push(_),t.floatingElements.push(_)}else if(f.hasOwnProperty($r[v.keywordIndex])){var Z=new id("Inline"),J=new id("Inline");v.parseContentControlProperties(f[$r[v.keywordIndex]],Z.contentControlProperties),J.contentControlProperties=Z.contentControlProperties,Z.line=n,J.line=n,Z.type=0,J.type=1,n.children.push(Z),v.parseParagraph(f[Qr[v.keywordIndex]],t,i,n);for(var Y=n.children[n.children.length-1];!(Y instanceof id);)Y.contentControlProperties=Z.contentControlProperties,Y=Y.previousElement;n.children.push(J),h=!0}d=s},v=this,y=0;y<e.length;y++)f(y),y=d;return this.isCutPerformed=!1,s||t.childWidgets.push(n),h},e.prototype.parseFormFieldData=function(e,t,i){return i instanceof Gl||i instanceof Kl||i instanceof Xl?(i instanceof Kl?(i.sizeType=t.sizeType,i.size=t.size,i.defaultValue=t.defaultValue,i.checked=t.checked):i instanceof Gl?(i.type=t.type,i.maxLength=t.maxLength,i.defaultValue=t.defaultValue,i.format=t.format):(i.dropdownItems=t.dropdownItems,i.selectedIndex=t.selectedIndex),i.name=t.name,i.enabled=t.enabled,i.helpText=t.helpText,i.statusText=t.statusText):(t[br[e]].hasOwnProperty(Pr[e])?((i=new Gl).type=this.getTextFormFieldType(t[br[e]][Pr[e]][Ms[e]]),i.maxLength=t[br[e]][Pr[e]][Hr[e]],i.defaultValue=t[br[e]][Pr[e]][Er[e]],i.format=this.getTextFormFieldFormat(t[br[e]][Pr[e]][Nr[e]])):t[br[e]].hasOwnProperty(Sr[e])?((i=new Kl).sizeType=this.getCheckBoxSizeType(t[br[e]][Sr[e]][Wr[e]]),i.size=t[br[e]][Sr[e]][Or[e]],i.defaultValue=Pa.parseBoolValue(t[br[e]][Sr[e]][Er[e]]),i.checked=Pa.parseBoolValue(t[br[e]][Sr[e]][Br[e]])):((i=new Xl).dropdownItems=t[br[e]][Tr[e]][Lr[e]],i.selectedIndex=t[br[e]][Tr[e]][Dr[e]]),i.name=t[br[e]][We[e]],i.enabled=Pa.parseBoolValue(t[br[e]][Ir[e]]),i.helpText=t[br[e]][kr[e]],i.statusText=t[br[e]][Fr[e]]),i},e.prototype.applyCharacterStyle=function(e,t){if(!(0,a.isNullOrUndefined)(e[ie[this.keywordIndex]])&&!(0,a.isNullOrUndefined)(e[ie[this.keywordIndex]][Je[this.keywordIndex]])){var i=this.documentHelper.styles.findByName(e[ie[this.keywordIndex]][Je[this.keywordIndex]],"Character");t.characterFormat.applyStyle(i)}},e.prototype.parseEditableRangeStart=function(e){var t=new vd;return(0,a.isNullOrUndefined)(e[ks[this.keywordIndex]])||(t.columnFirst=e[ks[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[Fs[this.keywordIndex]])||(t.columnLast=e[Fs[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[Is[this.keywordIndex]])||(t.editRangeId=e[Is[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[Ps[this.keywordIndex]])||(t.user=e[Ps[this.keywordIndex]],-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),(0,a.isNullOrUndefined)(e[Ss[this.keywordIndex]])||""===e[Ss[this.keywordIndex]]||(t.group=e[Ss[this.keywordIndex]],t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},e.prototype.addEditRangeCollection=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){this.documentHelper.editRanges.get(e).push(t)}else{var i=[];i.push(t),this.documentHelper.editRanges.add(e,i)}},e.prototype.parseChartTitleArea=function(e,t){t.chartfontName=e[ea[this.keywordIndex]],t.chartFontSize=e[Ke[this.keywordIndex]],this.parseChartDataFormat(e[Di[this.keywordIndex]],t.dataFormat),this.parseChartLayout(e[Li[this.keywordIndex]],t.layout)},e.prototype.parseChartDataFormat=function(e,t){t.fill.color=e[sr[this.keywordIndex]][Vi[this.keywordIndex]],t.fill.rgb=e[sr[this.keywordIndex]][Xs[this.keywordIndex]],t.line.color=e[Ui[this.keywordIndex]][or[this.keywordIndex]],t.line.rgb=e[Ui[this.keywordIndex]][Xs[this.keywordIndex]]},e.prototype.parseChartLayout=function(e,t){t.chartLayoutLeft=e[qi[this.keywordIndex]],t.chartLayoutTop=e[_i[this.keywordIndex]]},e.prototype.parseChartLegend=function(e,t){t.chartLegendPostion=e[ws[this.keywordIndex]],this.parseChartTitleArea(e[Pn[this.keywordIndex]],t.chartTitleArea)},e.prototype.parseChartCategoryAxis=function(e,t){t.categoryAxisType=e[xn[this.keywordIndex]],t.categoryNumberFormat=e[ss[this.keywordIndex]],e.hasOwnProperty(Us[this.keywordIndex])&&(t.isAutoInternal=Pa.parseBoolValue(e[Us[this.keywordIndex]])),t.interval=e[As[this.keywordIndex]],t.axisFontSize=e[Ke[this.keywordIndex]],t.axisFontName=e[ea[this.keywordIndex]],t.max=e[Vs[this.keywordIndex]],t.min=e[zs[this.keywordIndex]],t.majorGridLines=Pa.parseBoolValue(e[qs[this.keywordIndex]]),t.minorGridLines=Pa.parseBoolValue(e[_s[this.keywordIndex]]),t.majorTick=e[js[this.keywordIndex]],t.minorTick=e[Gs[this.keywordIndex]],t.tickPosition=e[Ks[this.keywordIndex]],t.categoryAxisTitle=e[Nn[this.keywordIndex]],null!=e[Nn[this.keywordIndex]]&&this.parseChartTitleArea(e[Pn[this.keywordIndex]],t.chartTitleArea)},e.prototype.parseChartDataTable=function(e,t){t.showSeriesKeys=Pa.parseBoolValue(e[yn[this.keywordIndex]]),t.hasHorzBorder=Pa.parseBoolValue(e[wn[this.keywordIndex]]),t.hasVertBorder=Pa.parseBoolValue(e[bn[this.keywordIndex]]),t.hasBorders=Pa.parseBoolValue(e[Cn[this.keywordIndex]])},e.prototype.parseChartArea=function(e,t){t.chartForeColor=e[Vi[this.keywordIndex]]},e.prototype.parseChartData=function(e,t){for(var i=0;i<e[In[this.keywordIndex]].length;i++){var n=new bd,r=e[In[this.keywordIndex]][i];r.hasOwnProperty(Ai[this.keywordIndex])&&(n.xName=r[Ai[this.keywordIndex]]);for(var o=0;o<r[Mi[this.keywordIndex]].length;o++){var s=new Cd,a=r[Mi[this.keywordIndex]][o];s.yAxisValue=a[Ri[this.keywordIndex]],"Bubble"===e[Wn[this.keywordIndex]]&&(s.bubbleSize=a[Or[this.keywordIndex]]),n.chartData.push(s)}t.chartCategory.push(n)}this.parseChartSeries(e,t)},e.prototype.parseChartSeries=function(e,t){for(var i=e[Wn[this.keywordIndex]],n="Pie"===i||"Doughnut"===i,r=0;r<e[kn[this.keywordIndex]].length;r++){var o=new Id,s=e[kn[this.keywordIndex]][r];if(s.hasOwnProperty(nn[this.keywordIndex])){if(o.seriesName=s[nn[this.keywordIndex]],n&&(s.hasOwnProperty(dn[this.keywordIndex])&&(o.firstSliceAngle=s[dn[this.keywordIndex]]),"Doughnut"===i&&(o.doughnutHoleSize=s[hn[this.keywordIndex]])),s.hasOwnProperty(rn[this.keywordIndex])&&this.parseChartDataLabels(s[rn[this.keywordIndex]],o),s.hasOwnProperty(sn[this.keywordIndex])){var a=new Fd,l=s[sn[this.keywordIndex]];a.markerStyle=l[Xi[this.keywordIndex]],a.markerColor=l[Zi[this.keywordIndex]],a.numberValue=l[Ji[this.keywordIndex]],o.seriesFormat=a}if(s.hasOwnProperty(on[this.keywordIndex])){var d=o.errorBar;d.errorType=s[on[this.keywordIndex]][Ms[this.keywordIndex]],d.errorDirection=s[on[this.keywordIndex]][ji[this.keywordIndex]],d.errorEndStyle=s[on[this.keywordIndex]][Gi[this.keywordIndex]],d.numberValue=s[on[this.keywordIndex]][Ki[this.keywordIndex]]}s.hasOwnProperty(an[this.keywordIndex])&&this.parseChartTrendLines(s[an[this.keywordIndex]],o),this.parseChartSeriesDataPoints(s[ln[this.keywordIndex]],o)}t.chartSeries.push(o)}},e.prototype.parseChartDataLabels=function(e,t){var i=new Pd;i.labelPosition=e[ws[this.keywordIndex]],i.fontName=e[ea[this.keywordIndex]],i.fontColor=e[Xe[this.keywordIndex]],i.fontSize=e[Ke[this.keywordIndex]],i.isLegendKey=Pa.parseBoolValue(e[cn[this.keywordIndex]]),i.isBubbleSize=Pa.parseBoolValue(e[pn[this.keywordIndex]]),i.isCategoryName=Pa.parseBoolValue(e[un[this.keywordIndex]]),i.isSeriesName=Pa.parseBoolValue(e[gn[this.keywordIndex]]),i.isValue=Pa.parseBoolValue(e[mn[this.keywordIndex]]),i.isPercentage=Pa.parseBoolValue(e[fn[this.keywordIndex]]),i.isLeaderLines=Pa.parseBoolValue(e[vn[this.keywordIndex]]),t.dataLabels=i},e.prototype.parseChartSeriesDataPoints=function(e,t){for(var i=0;i<e.length;i++){var n=new Hd;e[i].hasOwnProperty(Po[this.keywordIndex])&&(n.id=e[i][Po[this.keywordIndex]]),this.parseChartDataFormat(e[i],n),t.chartDataFormat.push(n)}},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=new Sd;r.trendLineName=n[We[this.keywordIndex]],r.trendLineType=n[Ms[this.keywordIndex]],r.forwardValue=n[Yi[this.keywordIndex]],r.backwardValue=n[Qi[this.keywordIndex]],r.interceptValue=n[$i[this.keywordIndex]],r.isDisplayEquation=Pa.parseBoolValue(n[tn[this.keywordIndex]]),r.isDisplayRSquared=Pa.parseBoolValue(n[en[this.keywordIndex]]),t.trendLines.push(r)}},e.prototype.parseTableFormat=function(e,t,i){this.parseBorders(i,e[Et[i]],t.borders),(0,a.isNullOrUndefined)(e[vi[i]])||(t.allowAutoFit=Pa.parseBoolValue(e[vi[i]])),(0,a.isNullOrUndefined)(e[yi[i]])||(t.cellSpacing=e[yi[i]]),(0,a.isNullOrUndefined)(e[Mt[i]])||(t.leftMargin=e[Mt[i]]),(0,a.isNullOrUndefined)(e[Ut[i]])||(t.topMargin=e[Ut[i]]),(0,a.isNullOrUndefined)(e[At[i]])||(t.rightMargin=e[At[i]]),(0,a.isNullOrUndefined)(e[Vt[i]])||(t.bottomMargin=e[Vt[i]]),(0,a.isNullOrUndefined)(e[gt[i]])||(t.leftIndent=e[gt[i]]),this.parseShading(e[wi[i]],t.shading,i),(0,a.isNullOrUndefined)(e[bi[i]])||(t.tableAlignment=this.getTableAlignment(e[bi[i]])),(0,a.isNullOrUndefined)(e[Ci[i]])||(t.preferredWidth=e[Ci[i]]),(0,a.isNullOrUndefined)(e[xi[i]])||(t.preferredWidthType=this.getWidthType(e[xi[i]])),(0,a.isNullOrUndefined)(e[Ye[i]])||(t.bidi=Pa.parseBoolValue(e[Ye[i]])),(0,a.isNullOrUndefined)(e[Ii[i]])||(t.horizontalPositionAbs=this.getHorizontalPositionAbs(e[Ii[i]])),(0,a.isNullOrUndefined)(e[jo[i]])||(t.horizontalPosition=e[jo[i]]),(0,a.isNullOrUndefined)(e[Je[i]])||(t.styleName=e[Je[i]]),this.documentHelper.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(e[no[i]])&&(t.title=e[no[i]]),this.documentHelper.owner.enableCollaborativeEditing&&!(0,a.isNullOrUndefined)(e[No[i]])&&(t.description=e[No[i]])},e.prototype.parseCellFormat=function(e,t,i){(0,a.isNullOrUndefined)(e)||(this.parseBorders(i,e[Et[i]],t.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,t,i),(0,a.isNullOrUndefined)(e[ii[i]])||(t.cellWidth=e[ii[i]]),(0,a.isNullOrUndefined)(e[ni[i]])||(t.columnSpan=e[ni[i]]),(0,a.isNullOrUndefined)(e[ri[i]])||(t.rowSpan=e[ri[i]]),this.parseShading(e[wi[i]],t.shading,i),(0,a.isNullOrUndefined)(e[oi[i]])||(t.verticalAlignment=this.getCellVerticalAlignment(e[oi[i]])),(0,a.isNullOrUndefined)(e[xi[i]])||(t.preferredWidthType=this.getWidthType(e[xi[i]])),(0,a.isNullOrUndefined)(e[Ci[i]])||(t.preferredWidth=e[Ci[i]]))},e.prototype.parseCellMargin=function(e,t,i){(0,a.isNullOrUndefined)(e[Mt[i]])||(t.leftMargin=e[Mt[i]]),(0,a.isNullOrUndefined)(e[At[i]])||(t.rightMargin=e[At[i]]),(0,a.isNullOrUndefined)(e[Ut[i]])||(t.topMargin=e[Ut[i]]),(0,a.isNullOrUndefined)(e[Vt[i]])||(t.bottomMargin=e[Vt[i]])},e.prototype.parseRowFormat=function(e,t,i){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e[si[i]])||(t.allowBreakAcrossPages=Pa.parseBoolValue(e[si[this.keywordIndex]])),(0,a.isNullOrUndefined)(e[ai[i]])||(t.isHeader=Pa.parseBoolValue(e[ai[i]])),(0,a.isNullOrUndefined)(e[li[i]])||(t.heightType=this.getHeightType(e[li[i]])),(0,a.isNullOrUndefined)(e[qn[i]])||(t.height=e[qn[i]]),(0,a.isNullOrUndefined)(e[Mt[i]])||(t.leftMargin=e[Mt[i]]),(0,a.isNullOrUndefined)(e[Ut[i]])||(t.topMargin=e[Ut[i]]),(0,a.isNullOrUndefined)(e[At[i]])||(t.rightMargin=e[At[i]]),(0,a.isNullOrUndefined)(e[Vt[i]])||(t.bottomMargin=e[Vt[i]]),(0,a.isNullOrUndefined)(e[gt[i]])||(t.leftIndent=e[gt[i]]),!(0,a.isNullOrUndefined)(e[dt[i]])&&e[dt[i]].length>0&&this.checkAndApplyRevision(i,e,t),this.parseRowGridValues(e,t,i),this.parseBorders(i,e[Et[i]],t.borders))},e.prototype.parseBorders=function(e,t,i){(0,a.isNullOrUndefined)(t)||(i.isParsing=!0,this.parseBorder(e,t[fr[e]],i.left),this.parseBorder(e,t[mr[e]],i.right),this.parseBorder(e,t[ur[e]],i.top),this.parseBorder(e,t[gr[e]],i.bottom),this.parseBorder(e,t[Hi[e]],i.vertical),this.parseBorder(e,t[Ei[e]],i.horizontal),this.parseBorder(e,t[Wi[e]],i.diagonalDown),this.parseBorder(e,t[Ni[e]],i.diagonalUp),i.isParsing=!1)},e.prototype.parseBorder=function(e,t,i){(0,a.isNullOrUndefined)(t)||((0,a.isNullOrUndefined)(t[or[e]])||(i.color=this.getColor(t[or[e]])),(0,a.isNullOrUndefined)(t[Oi[e]])||(i.lineStyle=this.getLineStyle(t[Oi[e]])),(0,a.isNullOrUndefined)(t[Bi[e]])||(i.lineWidth=t[Bi[e]]),(0,a.isNullOrUndefined)(t[Ti[e]])||(i.hasNoneStyle=Pa.parseBoolValue(t[Ti[e]])),(0,a.isNullOrUndefined)(t[Hs[e]])||(i.space=t[Hs[e]]),(0,a.isNullOrUndefined)(t[Si[e]])||(i.shadow=Pa.parseBoolValue(t[Si[e]])))},e.prototype.parseShading=function(e,t,i){(0,a.isNullOrUndefined)(e)||((0,a.isNullOrUndefined)(e[Fi[i]])||(t.backgroundColor=this.getColor(e[Fi[i]])),(0,a.isNullOrUndefined)(e[Pi[i]])||(t.foregroundColor=this.getColor(e[Pi[i]])),(0,a.isNullOrUndefined)(e[ki[i]])&&(0,a.isNullOrUndefined)(e.textureStyle)||(t.textureStyle=(0,a.isNullOrUndefined)(e[ki[i]])?this.getTextureStyle(e.textureStyle):this.getTextureStyle(e[ki[i]])))},e.prototype.parseCharacterFormat=function(e,t,i,n){if(!(0,a.isNullOrUndefined)(t)){if(n&&t.hasOwnProperty($s[e]))return void this.parseCharacterFormat(e,t.inlineFormat,i);if((0,a.isNullOrUndefined)(t[_e[e]])||(i.baselineAlignment=this.getBaseAlignment(t[_e[e]])),(0,a.isNullOrUndefined)(t[Ve[e]])||(i.underline=this.getUnderline(t[Ve[e]])),(0,a.isNullOrUndefined)(t[ze[e]])||(i.underlineColor=this.getColor(t[ze[e]])),(0,a.isNullOrUndefined)(t[qe[e]])||(i.fontHintType=this.getFontHintType(t[qe[e]])),(0,a.isNullOrUndefined)(t[je[e]])||(i.strikethrough=this.getStrikethrough(t[je[e]])),!(0,a.isNullOrUndefined)(t[Ke[e]])){t[Ke[e]]=parseFloat(t[Ke[e]]);var r=10*t[Ke[e]];r%10!=0&&(r=10*t[Ke[e]].toFixed(1),t[Ke[e]]=r%5==0?t[Ke[e]].toFixed(1):Math.round(t[Ke[e]]));var o=parseFloat(t[Ke[e]]);i.fontSize=o<0?0:o}if(!(0,a.isNullOrUndefined)(t[Ze[e]])){-1!==t[Ze[e]].indexOf('"')&&(t[Ze[e]]=t[Ze[e]].replace('"',""));var s=t[Ze[e]];(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(s)||this.isFontInstalled(s)||(s=this.documentHelper.fontSubstitutionTable.get(s)),i.fontFamily=s,(0,a.isNullOrUndefined)(t[st[e]])&&(i.fontFamilyAscii=s),(0,a.isNullOrUndefined)(t[lt[e]])&&(i.fontFamilyNonFarEast=s)}if((0,a.isNullOrUndefined)(t[Ae[e]])||(i.bold=Pa.parseBoolValue(t[Ae[e]])),(0,a.isNullOrUndefined)(t[Ue[e]])||(i.italic=Pa.parseBoolValue(t[Ue[e]])),(0,a.isNullOrUndefined)(t[Ge[e]])||(i.highlightColor=this.getHighlightColor(t[Ge[e]])),(0,a.isNullOrUndefined)(t[Xe[e]])||(i.fontColor=this.getColor(t[Xe[e]])),(0,a.isNullOrUndefined)(t[Ye[e]])||(i.bidi=Pa.parseBoolValue(t[Ye[e]])),(0,a.isNullOrUndefined)(t[Qe[e]])||(i.bdo=this.getBiDirectionalOverride(t[Qe[e]])),!(0,a.isNullOrUndefined)(t[et[e]])){o=parseFloat(t[et[e]]);i.fontSizeBidi=o<0?0:o}if(!(0,a.isNullOrUndefined)(t[tt[e]])){-1!==t[tt[e]].indexOf('"')&&(t[tt[e]]=t[tt[e]].replace('"',""));var l=t[tt[e]];(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(l)||this.isFontInstalled(l)||(l=this.documentHelper.fontSubstitutionTable.get(l)),i.fontFamilyBidi=l}if((0,a.isNullOrUndefined)(t[it[e]])||(i.boldBidi=Pa.parseBoolValue(t[it[e]])),(0,a.isNullOrUndefined)(t[nt[e]])||(i.italicBidi=Pa.parseBoolValue(t[nt[e]])),!(0,a.isNullOrUndefined)(t[dt[e]])&&t[dt[e]].length>0&&this.checkAndApplyRevision(e,t,i),(0,a.isNullOrUndefined)(t[rt[e]])||(i.allCaps=Pa.parseBoolValue(t[rt[e]])),(0,a.isNullOrUndefined)(t[Me[e]])||(i.localeIdBidi=t[Me[e]]),(0,a.isNullOrUndefined)(t[De[e]])||(i.localeIdAscii=t[De[e]]),(0,a.isNullOrUndefined)(t[Re[e]])||(i.localeIdFarEast=t[Re[e]]),(0,a.isNullOrUndefined)(t[ot[e]])||(i.complexScript=Pa.parseBoolValue(t[ot[e]])),!(0,a.isNullOrUndefined)(t[at[e]])){-1!==t[at[e]].indexOf('"')&&(t[at[e]]=t[at[e]].replace('"',""));var d=t[at[e]];(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(d)||this.isFontInstalled(d)||(d=this.documentHelper.fontSubstitutionTable.get(d)),i.fontFamilyFarEast=d}if(!(0,a.isNullOrUndefined)(t[st[e]])){-1!==t[st[e]].indexOf('"')&&(t[st[e]]=t[st[e]].replace('"',""));var h=t[st[e]];(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(h)||this.isFontInstalled(h)||(h=this.documentHelper.fontSubstitutionTable.get(h)),i.fontFamilyAscii=h}if(!(0,a.isNullOrUndefined)(t[lt[e]])){-1!==t[lt[e]].indexOf('"')&&(t[lt[e]]=t[lt[e]].replace('"',""));var c=t[lt[e]];(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(c)||this.isFontInstalled(c)||(c=this.documentHelper.fontSubstitutionTable.get(c)),i.fontFamilyNonFarEast=c}(0,a.isNullOrUndefined)(t[ct[e]])||(i.characterSpacing=t[ct[e]]),(0,a.isNullOrUndefined)(t[pt[e]])||(i.scaling=t[pt[e]])}},e.prototype.isFontInstalled=function(e){if(this.fontInfoCollection&&this.fontInfoCollection.containsKey(e))return this.fontInfoCollection.get(e);var t=this.getWidth("monospace"),i=this.getWidth("sans-serif"),n=this.getWidth("serif"),r=t!==this.getWidth(e+", monospace",t)||i!==this.getWidth(e+", sans-serif",i)||n!==this.getWidth(e+", serif",n);return this.fontInfoCollection&&this.fontInfoCollection.add(e,r),r},e.prototype.getWidth=function(e,t){var i,n=document.createElement("span");return n.innerHTML=Array(100).join("wi"),n.style.cssText=["position:absolute","width:auto","font-size:128px","left:-99999px"].join(" !important;"),n.style.fontFamily=e,document.body.appendChild(n),i=n.clientWidth,""!==n.style.fontFamily||(0,a.isNullOrUndefined)(t)||(i=t),document.body.removeChild(n),i},e.prototype.getColor=function(e){return e||"#ffffff"},e.prototype.parseThemes=function(e,t){this.parseFontScheme(e[Es[this.keywordIndex]],t)},e.prototype.parseFontScheme=function(e,t){(0,a.isNullOrUndefined)(e[Ns[this.keywordIndex]])||(t.fontScheme.fontSchemeName=e[Ns[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[Ws[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[Ws[this.keywordIndex]],t.fontScheme.majorFontScheme),(0,a.isNullOrUndefined)(e[Os[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[Os[this.keywordIndex]],t.fontScheme.minorFontScheme)},e.prototype.parseMajorMinorFontScheme=function(e,t){if(!(0,a.isNullOrUndefined)(e[Ls[this.keywordIndex]])&&Object.keys(e[Ls[this.keywordIndex]]).length>0){for(var i=0,n=Object.keys(e[Ls[this.keywordIndex]]);i<n.length;i++){var r=n[i];t.fontTypeface.add(r,e[Ls[this.keywordIndex]][r])}this.documentHelper.hasThemes=!0}if(!(0,a.isNullOrUndefined)(e[Bs[this.keywordIndex]])&&e[Bs[this.keywordIndex]].length>0){for(var o=0;o<e[Bs[this.keywordIndex]].length;o++){var s=e[Bs[this.keywordIndex]][o],l=new vl;l.name=(0,a.isNullOrUndefined)(s.fontName)?s[We[this.keywordIndex]]:s[ea[this.keywordIndex]],l.typeface=(0,a.isNullOrUndefined)(s.fontTypeface)?s[Ds[this.keywordIndex]]:s.fontTypeface,l.panose=(0,a.isNullOrUndefined)(s.pnose)?s[Rs[this.keywordIndex]]:s.pnose,t.fontSchemeList.push(l)}this.documentHelper.hasThemes=!0}},e.prototype.parseParagraphFormat=function(e,t,i){(0,a.isNullOrUndefined)(t)||((0,a.isNullOrUndefined)(t[Et[e]])||this.parseBorders(e,t[Et[e]],i.borders),(0,a.isNullOrUndefined)(t[Ye[e]])||(i.bidi=Pa.parseBoolValue(t[Ye[e]])),(0,a.isNullOrUndefined)(t[gt[e]])||(i.leftIndent=t[gt[e]]),(0,a.isNullOrUndefined)(t[mt[e]])||(i.rightIndent=t[mt[e]]),(0,a.isNullOrUndefined)(t[ft[e]])||(i.firstLineIndent=t[ft[e]]),(0,a.isNullOrUndefined)(t[yt[e]])||(i.afterSpacing=t[yt[e]]),(0,a.isNullOrUndefined)(t[wt[e]])||(i.beforeSpacing=t[wt[e]]),(0,a.isNullOrUndefined)(t[Ct[e]])||(i.spaceBeforeAuto=Pa.parseBoolValue(t[Ct[e]])),(0,a.isNullOrUndefined)(t[bt[e]])||(i.spaceAfterAuto=Pa.parseBoolValue(t[bt[e]])),(0,a.isNullOrUndefined)(t[xt[e]])||(i.lineSpacing=t[xt[e]]),(0,a.isNullOrUndefined)(t[It[e]])?(0,a.isNullOrUndefined)(t[xt[e]])||(i.lineSpacingType="Multiple"):i.lineSpacingType=this.getLineSpacingType(t[It[e]]),(0,a.isNullOrUndefined)(t[vt[e]])||(i.textAlignment=this.getTextAlignment(t[vt[e]])),(0,a.isNullOrUndefined)(t[Tt[e]])||(i.outlineLevel=this.getOutlineLevel(t[Tt[e]])),(0,a.isNullOrUndefined)(t[Ht[e]])||(i.contextualSpacing=Pa.parseBoolValue(t[Ht[e]])),(0,a.isNullOrUndefined)(t[Ft[e]])||(i.keepWithNext=Pa.parseBoolValue(t[Ft[e]])),(0,a.isNullOrUndefined)(t[St[e]])||(i.keepLinesTogether=Pa.parseBoolValue(t[St[e]])),(0,a.isNullOrUndefined)(t[Pt[e]])||(i.widowControl=Pa.parseBoolValue(t[Pt[e]])),i.listFormat=new ya(i),t.hasOwnProperty(kt[e])&&this.parseListFormat(e,t,i.listFormat),t.hasOwnProperty(Nt[e])&&this.parseTabStop(e,t[Nt[e]],i.tabs))},e.prototype.parseListFormat=function(e,t,i){(0,a.isNullOrUndefined)(t[kt[e]])||((0,a.isNullOrUndefined)(t[kt[e]][ht[e]])||(i.listId=t[kt[e]][ht[e]],i.list=this.documentHelper.getListById(t[kt[e]][ht[e]])),(0,a.isNullOrUndefined)(t[kt[e]][ds])?(0,a.isNullOrUndefined)(i.list)||(i.nsid=i.list.nsid):i.nsid=t[kt[e]][ds],(0,a.isNullOrUndefined)(t[kt[e]][ut[e]])||(i.listLevelNumber=t[kt[e]][ut[e]]))},e.prototype.parseSectionFormat=function(e,t,i){if((0,a.isNullOrUndefined)(t[Dt[e]])||(i.pageWidth=t[Dt[e]]),(0,a.isNullOrUndefined)(t[Rt[e]])||(i.pageHeight=t[Rt[e]]),(0,a.isNullOrUndefined)(t[Mt[e]])||(i.leftMargin=t[Mt[e]]),(0,a.isNullOrUndefined)(t[Ut[e]])||(i.topMargin=t[Ut[e]]),(0,a.isNullOrUndefined)(t[At[e]])||(i.rightMargin=t[At[e]]),(0,a.isNullOrUndefined)(t[Vt[e]])||(i.bottomMargin=t[Vt[e]]),(0,a.isNullOrUndefined)(t[Wt[e]])||(i.headerDistance=t[Wt[e]]),(0,a.isNullOrUndefined)(t[Ot[e]])||(i.footerDistance=t[Ot[e]]),(0,a.isNullOrUndefined)(t[Bt[e]])||(i.differentFirstPage=Pa.parseBoolValue(t[Bt[e]])),(0,a.isNullOrUndefined)(t[Lt[e]])||(i.differentOddAndEvenPages=Pa.parseBoolValue(t[Lt[e]])),(0,a.isNullOrUndefined)(t[Ye[e]])||(i.bidi=Pa.parseBoolValue(t[Ye[e]])),(0,a.isNullOrUndefined)(t[zt[e]])||(i.restartPageNumbering=Pa.parseBoolValue(t[zt[e]])),(0,a.isNullOrUndefined)(t[qt[e]])||(i.pageStartingNumber=t[qt[e]]),(0,a.isNullOrUndefined)(t[_t[e]])||(i.endnoteNumberFormat=this.getFootEndNoteNumberFormat(t[_t[e]])),(0,a.isNullOrUndefined)(t[jt[e]])||(i.footNoteNumberFormat=this.getFootEndNoteNumberFormat(t[jt[e]])),(0,a.isNullOrUndefined)(t[Gt[e]])||(i.restartIndexForFootnotes=this.getFootnoteRestartIndex(t[Gt[e]])),(0,a.isNullOrUndefined)(t[Kt[e]])||(i.restartIndexForEndnotes=this.getFootnoteRestartIndex(t[Kt[e]])),(0,a.isNullOrUndefined)(t[Xt[e]])||(i.initialFootNoteNumber=t[Xt[e]]),(0,a.isNullOrUndefined)(t[Zt[e]])||(i.initialEndNoteNumber=t[Zt[e]]),(0,a.isNullOrUndefined)(t[Jt[e]])||(i.pageNumberStyle=t[Jt[e]]),!(0,a.isNullOrUndefined)(t[Yt[e]])&&!(0,a.isNullOrUndefined)(t[Qt[e]])&&t[Qt[e]]>1&&(i.numberOfColumns=t[Qt[e]],i.equalWidth=Pa.parseBoolValue(t[$t[e]]),i.lineBetweenColumns=Pa.parseBoolValue(t[ei[e]]),t[Yt[e]]))for(var n=0;n<t[Yt[e]].length;n++){var r=new ma;r.width=Pa.convertPointToPixel(t[Yt[e]][n][zn[e]]),r.space=Pa.convertPointToPixel(t[Yt[e]][n][Hs[e]]),r.index=n,i.columns.push(r)}(0,a.isNullOrUndefined)(t[ti[e]])||(i.breakCode=t[ti[e]])},e.prototype.parseColumns=function(e,t){if(t=[],e)for(var i=0;i<e.length;i++){var n=new ma;n.width=Pa.convertPointToPixel(e[i][zn[this.keywordIndex]]),n.space=Pa.convertPointToPixel(e[i][Hs[this.keywordIndex]]),n.index=i,t.push(n)}},e.prototype.parseTabStop=function(e,t,i){if(t)for(var n=0;n<t.length;n++){var r=!1,o=t[n];if(Object.keys(o).length>0){var s=new wa;s.position=o[ws[e]],s.tabLeader=this.getTabLeader(o[xs[e]]),s.deletePosition=o[bs[e]],s.tabJustification=this.getTabJustification(o[ys[e]]);for(var a=0;a<i.length;a++){var l=i[a];if(l.position===s.position&&l.tabLeader===s.tabLeader&&l.deletePosition===s.deletePosition&&l.tabJustification===s.tabJustification){r=!0;break}}r||i.push(s)}}},e.prototype.validateImageUrl=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;return e.charAt(e.length-1)===t.charAt(64)&&i--,e.charAt(e.length-2)===t.charAt(64)&&i--,i%1==0},e.prototype.containsFieldBegin=function(e){for(var t=void 0,i=e.children.length-1;i>=0;i--){if((t=e.children[i])instanceof _l&&t.hasFieldEnd&&t.nextElement instanceof Zl)return t.nextElement;if(t instanceof _l)return}return t},e.prototype.getBaseAlignment=function(e){switch(e){case 0:return"Normal";case 1:return"Superscript";case 2:return"Subscript";default:return e}},e.prototype.getUnderline=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Words";case 3:return"Double";case 4:return"Dotted";case 5:return"Thick";case 6:return"Dash";case 7:return"DashLong";case 8:return"DotDash";case 9:return"DotDotDash";case 10:return"Wavy";case 11:return"DottedHeavy";case 12:return"DashHeavy";case 13:return"DashLongHeavy";case 14:return"DotDashHeavy";case 15:return"DotDotDashHeavy";case 16:return"WavyHeavy";case 17:return"WavyDouble";default:return e}},e.prototype.getFontHintType=function(e){switch(e){case 0:return"Default";case 1:return"EastAsia";case 2:return"CS";default:return e}},e.prototype.getStrikethrough=function(e){switch(e){case 0:return"None";case 1:return"SingleStrike";case 2:return"DoubleStrike";default:return e}},e.prototype.getHighlightColor=function(e){switch(e){case 0:return"NoColor";case 1:return"Yellow";case 2:return"BrightGreen";case 3:return"Turquoise";case 4:return"Pink";case 5:return"Blue";case 6:return"Red";case 7:return"DarkBlue";case 8:return"Teal";case 9:return"Green";case 10:return"Violet";case 11:return"DarkRed";case 12:return"DarkYellow";case 13:return"Gray50";case 14:return"Gray25";case 15:return"Black";default:return e}},e.prototype.getLineSpacingType=function(e){switch(e){case 0:return"Multiple";case 1:return"AtLeast";case 2:return"Exactly";default:return e}},e.prototype.getOutlineLevel=function(e){switch(e){case 0:return"BodyText";case 1:return"Level1";case 2:return"Level2";case 3:return"Level3";case 4:return"Level4";case 5:return"Level5";case 6:return"Level6";case 7:return"Level7";case 8:return"Level8";case 9:return"Level9";default:return e}},e.prototype.getTextAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return e}},e.prototype.getWidthType=function(e){switch(e){case 0:return"Auto";case 1:return"Percent";case 2:return"Point";default:return e}},e.prototype.getTableAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";default:return e}},e.prototype.getLineStyle=function(e){switch(e){case 0:return"Single";case 1:return"None";case 2:return"Dot";case 3:return"DashSmallGap";case 4:return"DashLargeGap";case 5:return"DashDot";case 6:return"DashDotDot";case 7:return"Double";case 8:return"Triple";case 9:return"ThinThickSmallGap";case 10:return"ThickThinSmallGap";case 11:return"ThinThickThinSmallGap";case 12:return"ThinThickMediumGap";case 13:return"ThickThinMediumGap";case 14:return"ThinThickThinMediumGap";case 15:return"ThinThickLargeGap";case 16:return"ThickThinLargeGap";case 17:return"ThinThickThinLargeGap";case 18:return"SingleWavy";case 19:return"DoubleWavy";case 20:return"DashDotStroked";case 21:return"Emboss3D";case 22:return"Engrave3D";case 23:return"Outset";case 24:return"Inset";case 25:return"Thick";case 26:return"Cleared";default:return e}},e.prototype.getTextureStyle=function(e){switch(e){case 0:return"TextureNone";case 1:return"Texture2Pt5Percent";case 2:return"Texture5Percent";case 3:return"Texture7Pt5Percent";case 4:return"Texture10Percent";case 5:return"Texture12Pt5Percent";case 6:return"Texture15Percent";case 7:return"Texture17Pt5Percent";case 8:return"Texture20Percent";case 9:return"Texture22Pt5Percent";case 10:return"Texture25Percent";case 11:return"Texture27Pt5Percent";case 12:return"Texture30Percent";case 13:return"Texture32Pt5Percent";case 14:return"Texture35Percent";case 15:return"Texture37Pt5Percent";case 16:return"Texture40Percent";case 17:return"Texture42Pt5Percent";case 18:return"Texture45Percent";case 19:return"Texture47Pt5Percent";case 20:return"Texture50Percent";case 21:return"Texture52Pt5Percent";case 22:return"Texture55Percent";case 23:return"Texture57Pt5Percent";case 24:return"Texture60Percent";case 25:return"Texture62Pt5Percent";case 26:return"Texture65Percent";case 27:return"Texture67Pt5Percent";case 28:return"Texture70Percent";case 29:return"Texture72Pt5Percent";case 30:return"Texture75Percent";case 31:return"Texture77Pt5Percent";case 32:return"Texture80Percent";case 33:return"Texture82Pt5Percent";case 34:return"Texture85Percent";case 35:return"Texture87Pt5Percent";case 36:return"Texture90Percent";case 37:return"Texture92Pt5Percent";case 38:return"Texture95Percent";case 39:return"Texture97Pt5Percent";case 40:return"TextureSolid";case 41:return"TextureDarkHorizontal";case 42:return"TextureDarkVertical";case 43:return"TextureDarkDiagonalDown";case 44:return"TextureDarkDiagonalUp";case 45:return"TextureDarkCross";case 46:return"TextureDarkDiagonalCross";case 47:return"TextureHorizontal";case 48:return"TextureVertical";case 49:return"TextureDiagonalDown";case 50:return"TextureDiagonalUp";case 51:return"TextureCross";case 52:return"TextureDiagonalCross";default:return e}},e.prototype.getHeightType=function(e){switch(e){case 0:return"AtLeast";case 1:return"Exactly";default:return e}},e.prototype.getCellVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.prototype.getListLevelPattern=function(e){switch(e){case 0:return"None";case 1:case 13:case"KanjiDigit":return"Arabic";case 2:return"UpRoman";case 3:return"LowRoman";case 4:return"UpLetter";case 5:return"LowLetter";case 6:return"Ordinal";case 7:return"Number";case 8:return"OrdinalText";case 9:return"LeadingZero";case 10:return"Bullet";case 11:return"FarEast";case 12:return"Special";default:return e}},e.prototype.getFollowCharacterType=function(e){switch(e){case 0:return"Tab";case 1:return"Space";case 2:return"None";default:return e}},e.prototype.getStyleType=function(e){switch(e){case 0:return"Paragraph";case 1:return"Character";case 2:return"Table";default:return e}},e.prototype.getProtectionType=function(e){switch(e){case 0:return"NoProtection";case 1:return"ReadOnly";case 2:return"FormFieldsOnly";case 3:return"CommentsOnly";case 4:return"RevisionsOnly";default:return e}},e.prototype.getRevisionType=function(e){switch(e){case 1:return"Insertion";case 2:return"Deletion";case 3:return"MoveTo";case 4:return"MoveFrom";default:return e}},e.prototype.getFootnoteType=function(e){switch(e){case 0:return"Footnote";case 1:return"Endnote";default:return e}},e.prototype.getFootnoteRestartIndex=function(e){switch(e){case 0:return"DoNotRestart";case 1:return"RestartForEachSection";case 2:return"RestartForEachPage";default:return e}},e.prototype.getFootEndNoteNumberFormat=function(e){switch(e){case 0:return"Arabic";case 1:return"UpperCaseRoman";case 2:return"LowerCaseRoman";case 3:return"UpperCaseLetter";case 4:return"LowerCaseLetter";default:return e}},e.prototype.getBiDirectionalOverride=function(e){switch(e){case 0:return"None";case 1:return"LTR";case 2:return"RTL";default:return e}},e.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},e.prototype.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.prototype.getShapeVerticalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return e}},e.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return e}},e.prototype.getVerticalOrigin=function(e){switch(e){case 0:return"Paragraph";case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return e}},e.prototype.getHorizontalOrigin=function(e){switch(e){case 0:return"Column";case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return e}},e.prototype.getTableVerticalRelation=function(e){switch(e){case 0:return"Paragraph";case 1:return"Margin";case 2:return"Page";default:return e}},e.prototype.getTableHorizontalRelation=function(e){switch(e){case 0:return"Column";case 1:return"Margin";case 2:return"Page";default:return e}},e.prototype.getTableVerticalPosition=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inside";case 5:return"Outside";default:return e}},e.prototype.getTableHorizontalPosition=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Inside";case 3:return"Outside";case 4:return"Right";default:return e}},e.prototype.getLineDashStyle=function(e){switch(e){case 0:return"Solid";case 1:return"Dash";case 2:return"DashDot";case 3:return"DashDotDot";case 4:return"DashDotGEL";case 5:return"DashGEL";case 6:return"Dot";case 7:return"DotGEL";case 8:return"LongDashDotDotGEL";case 9:return"LongDashDotGEL";case 10:return"LongDashGEL";default:return e}},e.prototype.getHorizontalPositionAbs=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Inside";case 4:return"Outside";default:return e}},e.prototype.getTabJustification=function(e){switch(e){case 0:return"Left";case 1:return"Bar";case 2:return"Center";case 3:return"Decimal";case 4:return"List";case 5:return"Right";default:return e}},e.prototype.getTabLeader=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Dot";case 3:return"Hyphen";case 4:return"Underscore";default:return e}},e.prototype.getTextFormFieldType=function(e){switch(e){case 0:return"Text";case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return e}},e.prototype.getTextFormFieldFormat=function(e){switch(e){case 0:return"None";case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return e}},e.prototype.getCheckBoxSizeType=function(e){switch(e){case 0:return"Auto";case 1:return"Exactly";default:return e}},e.prototype.getContentControlAppearance=function(e){switch(e){case 1:return"BoundingBox";case 2:return"Hidden";case 3:return"Tags";default:return e}},e.prototype.getContentControlType=function(e){switch(e){case 0:return"RichText";case 1:return"BuildingBlockGallery";case 2:return"CheckBox";case 3:return"ComboBox";case 4:return"Date";case 5:return"DropDownList";case 6:return"Group";case 7:return"Picture";case 8:return"RepeatingSection";case 9:return"Text";default:return e}},e.prototype.getDateCalendarType=function(e){switch(e){case 0:return"Gregorian";case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return e}},e.prototype.getDateStorageFormat=function(e){switch(e){case 1:return"DateStorageDate";case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return e}},e.prototype.getTextWrappingStyle=function(e){switch(e){case 0:return"Inline";case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return e}},e.prototype.getTextWrappingType=function(e){switch(e){case 0:return"Both";case 1:return"Left";case 2:return"Right";case 3:return"Largest";default:return e}},e.prototype.getCompatibilityMode=function(e){switch(e){case 0:return"Word2013";case 1:return"Word2003";case 2:return"Word2007";case 3:return"Word2010";default:return e}},e.prototype.getLineFormatType=function(e){switch(e){case 0:return"Solid";case 1:return"Patterned";case 2:return"Gradient";case 3:return"None";default:return e}},e.prototype.getAutoShapeType=function(e){switch(e){case 1:return"Rectangle";case 2:return"RoundedRectangle";case 3:return"StraightConnector";case 4:return"Oval";case 5:return"IsoscelesTriangle";case 6:return"RightTriangle";case 7:return"Parallelogram";case 8:return"Trapezoid";case 9:return"Diamond";case 10:return"RegularPentagon";case 11:return"Hexagon";case 12:return"Heptagon";case 13:return"Octagon";case 14:return"Decagon";case 15:return"Dodecagon";case 16:return"Chord";case 17:return"Teardrop";case 18:return"Frame";case 19:return"HalfFrame";case 20:return"L_Shape";case 21:return"Pie";case 22:return"DiagonalStripe";case 23:return"Cross";case 24:return"Plaque";case 25:return"Can";case 26:return"Cube";case 27:return"Bevel";case 28:return"Donut";case 29:return"NoSymbol";case 30:return"BlockArc";case 31:return"FoldedCorner";case 32:return"SmileyFace";case 33:return"Heart";case 34:return"LightningBolt";case 35:return"Sun";case 36:return"Moon";case 37:return"Cloud";case 38:return"Arc";case 39:return"DoubleBracket";case 40:return"DoubleBrace";case 41:return"LeftBracket";case 42:return"RightBracket";case 43:return"LeftBrace";case 44:return"RightBrace";case 45:return"FlowChartProcess";case 46:return"FlowChartAlternateProcess";case 47:return"FlowChartDecision";case 48:return"FlowChartData";case 49:return"FlowChartPredefinedProcess";case 50:return"FlowChartInternalStorage";case 51:return"FlowChartDocument";case 52:return"FlowChartMultiDocument";case 53:return"FlowChartTerminator";case 54:return"FlowChartPreparation";case 55:return"FlowChartManualInput";case 56:return"FlowChartManualOperation";case 57:return"FlowChartConnector";case 58:return"FlowChartOffPageConnector";case 59:return"FlowChartCard";case 60:return"FlowChartPunchedTape";case 61:return"FlowChartSummingJunction";case 62:return"FlowChartOr";case 63:return"FlowChartCollate";case 64:return"FlowChartSort";case 65:return"FlowChartExtract";case 66:return"FlowChartMerge";case 67:return"FlowChartStoredData";case 68:return"FlowChartDelay";case 69:return"FlowChartSequentialAccessStorage";case 70:return"FlowChartMagneticDisk";case 71:return"FlowChartDirectAccessStorage";case 72:return"FlowChartDisplay";case 73:return"RightArrow";case 74:return"LeftArrow";case 75:return"UpArrow";case 76:return"DownArrow";case 77:return"LeftRightArrow";case 78:return"UpDownArrow";case 79:return"QuadArrow";case 80:return"LeftRightUpArrow";case 81:return"BentArrow";case 82:return"UTurnArrow";case 83:return"LeftUpArrow";case 84:return"BentUpArrow";case 85:return"CurvedRightArrow";case 86:return"CurvedLeftArrow";case 87:return"CurvedUpArrow";case 88:return"CurvedDownArrow";case 89:return"StripedRightArrow";case 90:return"NotchedRightArrow";case 91:return"Pentagon";case 92:return"Chevron";case 93:return"RightArrowCallout";case 94:return"DownArrowCallout";case 95:return"LeftArrowCallout";case 96:return"UpArrowCallout";case 97:return"LeftRightArrowCallout";case 98:return"QuadArrowCallout";case 99:return"CircularArrow";case 100:return"MathPlus";case 101:return"MathMinus";case 102:return"MathMultiply";case 103:return"MathDivision";case 104:return"MathEqual";case 105:return"MathNotEqual";case 106:return"Explosion1";case 107:return"Explosion2";case 108:return"Star4Point";case 109:return"Star5Point";case 110:return"Star6Point";case 111:return"Star7Point";case 112:return"Star8Point";case 113:return"Star10Point";case 114:return"Star12Point";case 115:return"Star16Point";case 116:return"Star24Point";case 117:return"Star32Point";case 118:return"UpRibbon";case 119:return"DownRibbon";case 120:return"CurvedUpRibbon";case 121:return"CurvedDownRibbon";case 122:return"VerticalScroll";case 123:return"HorizontalScroll";case 124:return"Wave";case 125:return"DoubleWave";case 126:return"SnipSingleCornerRectangle";case 127:return"SnipSameSideCornerRectangle";case 128:return"SnipDiagonalCornerRectangle";case 129:return"SnipAndRoundSingleCornerRectangle";case 130:return"RoundSingleCornerRectangle";case 131:return"RoundSameSideCornerRectangle";case 132:return"RoundDiagonalCornerRectangle";case 133:return"Unknown";case 134:return"ElbowConnector";case 135:return"CurvedConnector";default:return e}},e.prototype.destroy=function(){this.footnotes&&this.footnotes.destroy(),this.footnotes=void 0,this.endnotes&&this.endnotes.destroy(),this.endnotes=void 0,this.editableRanges&&this.editableRanges.destroy(),this.editableRanges=void 0,this.commentEnds&&this.commentEnds.destroy(),this.commentEnds=void 0,this.commentStarts&&this.commentStarts.destroy(),this.commentStarts=void 0,this.commentsCollection&&this.commentsCollection.destroy(),this.commentsCollection=void 0,this.revisionCollection&&this.revisionCollection.destroy(),this.revisionCollection=void 0,this.fontInfoCollection&&this.fontInfoCollection.destroy(),this.fontInfoCollection=void 0,this.documentHelper=void 0,this.keywordIndex=void 0},e}(),np=m(115),rp=function(){function e(){this.customXMLItemsPath="customXml/item",this.customXMLItemsPropspath="customXml/itemProps",this.itemPropsPath="itemProps",this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.chartPath="word/charts",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.footnotesPath="word/footnotes.xml",this.endnotesPath="word/endnotes.xml",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.defaultEmbeddingPath="word/embeddings/",this.commentsPath="word/comments.xml",this.commentsExtendedPath="word/commentsExtended.xml",this.themePath="word/theme/theme1.xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.customXMLRelPath="customXml/_rels/item",this.excelRelationPath="xl/_rels/workbook.xml.rels",this.footnotesRelationPath="word/_rels/footnotes.xml.rels",this.endnotesRelationPath="word/_rels/endnotes.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.TemplateContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml",this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml",this.themeContentType="application/vnd.openxmlformats-officedocument.theme+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml",this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",this.ThemeRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.svgNamespace="http://schemas.microsoft.com/office/drawing/2016/SVG/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex",this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart",this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart",this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle",this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main",this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml",this.excelFiles=void 0,this.lastSection=!1,this.mRelationShipID=0,this.cRelationShipId=0,this.eRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.seriesCount=0,this.chartStringCount=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0,this.mComments=[],this.revisions=[],this.customXMLProps=[],this.paraID=0,this.commentParaID=0,this.commentParaIDInfo={},this.isInsideComment=!1,this.commentId={},this.currentCommentId=0,this.trackChangesId=0,this.prevRevisionIds=[],this.isRevisionContinuous=!1,this.isBookmarkAtEnd=!1,this.isBookmarkAtRowEnd=!1,this.isVerticalMergeCell=!1,this.keywordIndex=void 0,this.isHeaderFooter=!1,this.isSerializeFootEndNote=void 0,this.containerWidth=0}return e.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(e.prototype,"bookmarks",{get:function(){return(0,a.isNullOrUndefined)(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new l),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"svgImages",{get:function(){return void 0===this.mSvgImages&&(this.mSvgImages=new l),this.mSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new l),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new l),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterSvgImages",{get:function(){return void 0===this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages=new l),this.mHeaderFooterSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new l),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new l),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new l),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),e.prototype.save=function(e,t,i){var n=this;this.fileName=t,this.serialize(e,i);var r=this.serializeExcelFiles();r&&r.length>0?Promise.all(r).then((function(){n.saveInternal(t,i)})):this.saveInternal(t,i),this.close()},e.prototype.saveInternal=function(e,t){"Docx"===t?this.mArchive.save(e+".docx").then((function(e){e.destroy()})):"Dotx"===t&&this.mArchive.save(e+".dotx").then((function(e){e.destroy()}))},e.prototype.saveAsBlob=function(e,t){var i=this;this.serialize(e,t);var n=this.serializeExcelFiles();return new Promise((function(e,t){n.length>0?Promise.all(n).then((function(){i.mArchive.saveAsBlob().then((function(t){i.mArchive.destroy(),t=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(t)}))})):i.mArchive.saveAsBlob().then((function(t){i.mArchive.destroy(),t=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(t)}))}))},e.prototype.serializeExcelFiles=function(){var e=this,t=this.excelFiles,i=[];if(t&&t.length>0){for(var n=function(n){var r=t.keys[parseInt(n.toString(),10)],o=t.get(r).saveAsBlob();i.push(o),o.then((function(t){var i=new Fa.ZipArchiveItem(t,r);e.mArchive.addItem(i)}))},r=0;r<t.length;r++)n(r);this.excelFiles.clear()}return i},e.prototype.saveExcel=function(){var e=this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.excelFiles.add(e,this.mArchiveExcel),this.mArchiveExcel=void 0},e.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.fileName=void 0,this.imageRelationIds=void 0,this.svgImageRelationIds=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0),this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},e.prototype.serialize=function(e,t){this.keywordIndex=e.owner.documentEditorSettings.optimizeSfdt?1:0;var i,n=e.owner.sfdtExportModule.write(this.keywordIndex);this.setDocument(n),this.mComments=e.comments,this.mCustomXML=e.customXmlData,this.mImages=e.images,this.revisions=e.owner.revisions.changes,this.mArchive=new Fa.ZipArchive,this.mArchive.compressionLevel="Normal",this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.mVerticalMerge=new l,this.mGridSpans=new l,this.imageRelationIds=new l,this.svgImageRelationIds=new l,this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeComments(),this.serializeCommentsExtended(),this.serializeThemes(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(i),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeFootnotes(),this.serializeEndnotes(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(i,t),this.clearDocument()},e.prototype.setDocument=function(e,t){(0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=t),this.document=e,this.mSections=e[ee[this.keywordIndex]],this.mLists=e[re[this.keywordIndex]],this.mAbstractLists=e[oe[this.keywordIndex]],this.defCharacterFormat=e[ie[this.keywordIndex]],this.defParagraphFormat=e[ne[this.keywordIndex]],this.defaultTabWidthValue=e[ce[this.keywordIndex]],this.themeFontLang=e[Ee[this.keywordIndex]],this.dontUseHtmlParagraphAutoSpacing=Pa.parseBoolValue(e[Ie[this.keywordIndex]]),this.mStyles=e[ae[this.keywordIndex]],this.mThemes=e[Ne[this.keywordIndex]],this.formatting=Pa.parseBoolValue(e[pe[this.keywordIndex]]),this.enforcement=Pa.parseBoolValue(e[me[this.keywordIndex]]),this.hashValue=e[fe[this.keywordIndex]],this.saltValue=e[ve[this.keywordIndex]],this.protectionType=e[ge[this.keywordIndex]],this.formFieldShading=Pa.parseBoolValue(e[Fe[this.keywordIndex]]),this.trackChanges=Pa.parseBoolValue(e[ue[this.keywordIndex]]),this.compatibilityMode=e[He[this.keywordIndex]],this.allowSpaceOfSameStyleInTable=Pa.parseBoolValue(e[Ys[this.keywordIndex]])},e.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.trackChanges=void 0,this.customXMLProps=[],this.mRelationShipID=0,this.eRelationShipId=0,this.cRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.keywordIndex=void 0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mSvgImages&&(this.mSvgImages.destroy(),this.mSvgImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0),this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages.destroy(),this.mHeaderFooterSvgImages=void 0),this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0),this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},e.prototype.serializeDocument=function(){var e=new np.XmlWriter;e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),e.writeStartElement("w","background",this.wNamespace),e.writeAttributeString("w","color",void 0,this.getColor(this.document[se[this.keywordIndex]][or[this.keywordIndex]])),e.writeEndElement(),this.serializeDocumentBody(e),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.documentPath);this.mArchive.addItem(t)},e.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},e.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},e.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},e.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document[ee[this.keywordIndex]].length,i=0;i<t;i++)this.section=this.document[ee[this.keywordIndex]][parseInt(i.toString(),10)],this.lastSection=i===t-1,this.containerWidth=this.section[es[this.keywordIndex]][Dt[this.keywordIndex]]-(this.section[es[this.keywordIndex]][Mt[this.keywordIndex]]+this.section[es[this.keywordIndex]][At[this.keywordIndex]]),this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},e.prototype.serializeSection=function(e,t,i){this.blockOwner=t,(0,a.isNullOrUndefined)(t[Go[this.keywordIndex]])||this.serializeBodyItems(e,t[Go[this.keywordIndex]],i),i&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},e.prototype.serializeComments=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new np.XmlWriter;e.writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentInternal(e,this.mComments),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.commentsPath);this.mArchive.addItem(t)}},e.prototype.serializeThemes=function(){if(!(0,a.isNullOrUndefined)(this.mThemes)){var e=new np.XmlWriter;e.writeStartElement("a","theme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office Theme"),e.writeStartElement(void 0,"themeElements",this.aNamespace),e.writeRaw('<a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="44546A" /></a:dk2><a:lt2><a:srgbClr val="E7E6E6" /></a:lt2><a:accent1><a:srgbClr val="4472C4" /></a:accent1><a:accent2><a:srgbClr val="ED7D31" /></a:accent2><a:accent3><a:srgbClr val="A5A5A5" /></a:accent3><a:accent4><a:srgbClr val="FFC000" /></a:accent4><a:accent5><a:srgbClr val="5B9BD5" /></a:accent5><a:accent6><a:srgbClr val="70AD47" /></a:accent6><a:hlink><a:srgbClr val="0563C1" /></a:hlink><a:folHlink><a:srgbClr val="954F72" /></a:folHlink></a:clrScheme>'),e.writeStartElement(void 0,"fontScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,this.mThemes[Ns[this.keywordIndex]]),e.writeStartElement(void 0,"majorFont",this.aNamespace);for(var t=0;t<this.mThemes[Es[this.keywordIndex]][Ws[this.keywordIndex]][Bs[this.keywordIndex]].length;t++){var i=this.mThemes[Es[this.keywordIndex]][Ws[this.keywordIndex]][Bs[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,i)}for(var n=Object.keys(this.mThemes[Es[this.keywordIndex]][Ws[this.keywordIndex]][Ls[this.keywordIndex]]),r=0,o=n;r<o.length;r++){var s=o[r];this.themeType(e,s,this.mThemes[Es[this.keywordIndex]][Ws[this.keywordIndex]][Ls[this.keywordIndex]][""+s])}e.writeEndElement(),e.writeStartElement(void 0,"minorFont",this.aNamespace);for(t=0;t<this.mThemes[Es[this.keywordIndex]][Os[this.keywordIndex]][Bs[this.keywordIndex]].length;t++){i=this.mThemes[Es[this.keywordIndex]][Os[this.keywordIndex]][Bs[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,i)}for(var l=0,d=n=Object.keys(this.mThemes[Es[this.keywordIndex]][Os[this.keywordIndex]][Ls[this.keywordIndex]]);l<d.length;l++){s=d[l];this.themeType(e,s,this.mThemes[Es[this.keywordIndex]][Os[this.keywordIndex]][Ls[this.keywordIndex]][""+s])}e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"fmtScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office"),e.writeRaw('<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:lumMod val="110000" /><a:satMod val="105000" /><a:tint val="67000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="103000" /><a:tint val="73000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="109000" /><a:tint val="81000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="103000" /><a:lumMod val="102000" /><a:tint val="94000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:satMod val="110000" /><a:lumMod val="100000" /><a:shade val="100000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="99000" /><a:satMod val="120000" /><a:shade val="78000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="6350" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="12700" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="19050" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="63000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:solidFill><a:schemeClr val="phClr"><a:tint val="95000" /><a:satMod val="170000" /></a:schemeClr></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="93000" /><a:satMod val="150000" /><a:shade val="98000" /><a:lumMod val="102000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:tint val="98000" /><a:satMod val="130000" /><a:shade val="90000" /><a:lumMod val="103000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="63000" /><a:satMod val="120000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:bgFillStyleLst>'),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var h=new Fa.ZipArchiveItem(e.buffer,this.themePath);this.mArchive.addItem(h)}},e.prototype.themeFont=function(e,t){"latin"!==t[We[this.keywordIndex]]&&"ea"!==t[We[this.keywordIndex]]&&"cs"!==t[We[this.keywordIndex]]||(e.writeStartElement(void 0,t[We[this.keywordIndex]],this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t[Ds[this.keywordIndex]]),e.writeAttributeString(void 0,"panose",void 0,t[Rs[this.keywordIndex]]),e.writeEndElement())},e.prototype.themeType=function(e,t,i){e.writeStartElement(void 0,"font",this.aNamespace),e.writeAttributeString(void 0,"script",void 0,t),e.writeAttributeString(void 0,"typeface",void 0,i),e.writeEndElement()},e.prototype.serializeCommentCommonAttribute=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeCommentInternal=function(e,t){for(var i=0;i<t.length;i++){var n=t[parseInt(i.toString(),10)];e.writeStartElement("w","comment",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,this.commentId[n.commentId].toString()),n.author&&" "!==n.author&&e.writeAttributeString("w","author",this.wNamespace,n.author),n.date&&e.writeAttributeString("w","date",this.wNamespace,n.date),n.initial&&""!==n.initial&&e.writeAttributeString("w","initials",this.wNamespace,n.initial);for(var r=Pa.commentInlines(n.text,n.mentions,this.keywordIndex),o=0;o<r.length;o++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(e,r[parseInt(o.toString(),10)],!0),this.isInsideComment=!1;0===r.length&&(this.isInsideComment=!0,this.commentParaID++),this.commentParaIDInfo[n.commentId]=this.commentParaID,this.isInsideComment=!1,e.writeEndElement(),n.replyComments.length>0&&this.serializeCommentInternal(e,n.replyComments)}},e.prototype.serializeCommentsExtended=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new np.XmlWriter;e.writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentsExInternal(e,this.mComments,!1),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.commentsExtendedPath);this.mArchive.addItem(t)}},e.prototype.serializeCommentsExInternal=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[parseInt(n.toString(),10)];e.writeStartElement("w15","commentEx",this.wNamespace);var o=this.commentParaIDInfo[r.commentId];if(i){var s=this.commentParaIDInfo[r.ownerComment.commentId];e.writeAttributeString("w15","paraIdParent",this.wNamespace,s.toString())}e.writeAttributeString("w15","paraId",this.wNamespace,o.toString());var a=r.done?1:0;e.writeAttributeString("w15","done",this.wNamespace,a.toString()),e.writeEndElement(),r.replyComments.length>0&&this.serializeCommentsExInternal(e,r.replyComments,!0)}},e.prototype.serializeSectionProperties=function(e,t){if((0,a.isNullOrUndefined)(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","sectPr",this.wNamespace),t[$o[this.keywordIndex]]&&this.serializeHFReference(e,t[$o[this.keywordIndex]]),!(0,a.isNullOrUndefined)(t[es[this.keywordIndex]][ti[this.keywordIndex]])){var i=this.getSectionBreakCode(t[es[this.keywordIndex]][ti[this.keywordIndex]]);this.serializeSectionType(e,i)}this.serializePageSetup(e,t[es[this.keywordIndex]]),this.serializeColumns(e,t[es[this.keywordIndex]]),this.serializeFootNotesPr(e,t[es[this.keywordIndex]]),this.serializeEndNotesPr(e,t[es[this.keywordIndex]]),void 0!==t[es[this.keywordIndex]]&&Pa.parseBoolValue(t[es[this.keywordIndex]][Bt[this.keywordIndex]])&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[es[this.keywordIndex]])&&Pa.parseBoolValue(t[es[this.keywordIndex]][Ye[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),e.writeEndElement()},e.prototype.getSectionBreakCode=function(e){switch(e){case"NoBreak":return"continuous";case"NewColumn":return"nextColumn";case"EvenPage":return"evenPage";case"Oddpage":return"oddPage";default:return"nextPage"}},e.prototype.serializeFootNotesPr=function(e,t){(t[jt[this.keywordIndex]]||t[Gt[this.keywordIndex]])&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),e.writeEndElement(),void 0!==t[jt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[jt[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Gt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[Gt[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Xt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Xt[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.getFootNoteNumberFormat=function(e){var t;switch(e){case"UpperCaseRoman":case 1:t="upperRoman";break;case"LowerCaseRoman":case 2:t="lowerRoman";break;case"UpperCaseLetter":case 3:t="upperLetter";break;case"LowerCaseLetter":case 4:t="lowerLetter";break;default:t="decimal"}return t},e.prototype.getFootNoteNumberRestart=function(e){switch(e){case"RestartForEachSection ":case 1:return"eachSect";case"RestartForEachPage":case 2:return"eachPage";default:return"continuous"}},e.prototype.getPageNumberFormat=function(e){var t;switch(e){case"RomanUpper":t="upperRoman";break;case"RomanLower":t="lowerRoman";break;case"LetterUpper":t="upperLetter";break;case"LetterLower":t="lowerLetter";break;default:t="Arabic"}return t},e.prototype.serializeEndNotesPr=function(e,t){(0,a.isNullOrUndefined)(t[_t[this.keywordIndex]])&&(0,a.isNullOrUndefined)(t[Kt[this.keywordIndex]])||(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),e.writeEndElement(),void 0!==t[_t[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[_t[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Kt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[Kt[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Zt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Zt[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeColumns=function(e,t){if(void 0!==t[Qt[this.keywordIndex]]&&t[Qt[this.keywordIndex]]>1){if(e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"num",this.wNamespace,t[Qt[this.keywordIndex]].toString()),Pa.parseBoolValue(t[ei[this.keywordIndex]])&&e.writeAttributeString(void 0,"sep",this.wNamespace,"1"),Pa.parseBoolValue(t[$t[this.keywordIndex]]))e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1");else if(e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"0"),void 0!==t[Yt[this.keywordIndex]]&&t[Yt[this.keywordIndex]].length>0)for(var i=0;i<t[Yt[this.keywordIndex]].length;i++)e.writeStartElement(void 0,"col",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Yt[this.keywordIndex]][parseInt(i.toString(),10)][zn[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,this.roundToTwoDecimal(t[Yt[this.keywordIndex]][parseInt(i.toString(),10)][Hs[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement();e.writeEndElement()}},e.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t),this.serializePageNumberType(e,t)),Pa.parseBoolValue(t[zt[this.keywordIndex]])&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"start",this.wNamespace,t[qt[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},e.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Dt[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t[Rt[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement()},e.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t[Ut[this.keywordIndex]]*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t[At[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t[Vt[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t[Mt[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t[Wt[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t[Ot[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializePageNumberType=function(e,t){void 0!==t[Jt[this.keywordIndex]]&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"fmt",this.wNamespace,this.getPageNumberFormat(t[Jt[this.keywordIndex]])),e.writeEndElement())},e.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},e.prototype.serializeHFReference=function(e,t){var i="";if(void 0!==t){this.mDifferentFirstPage=Pa.parseBoolValue(this.section[es[this.keywordIndex]][Lt[this.keywordIndex]]);var n=t[Yo[this.keywordIndex]];n&&n[Go[this.keywordIndex]]&&n[Go[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"FirstPageHeader",i),e.writeEndElement()),(n=t[Qo[this.keywordIndex]])&&n[Go[this.keywordIndex]]&&n[Go[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"FirstPageFooter",i),e.writeEndElement()),(n=t[Zo[this.keywordIndex]])&&n[Go[this.keywordIndex]]&&n[Go[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"EvenHeader",i),e.writeEndElement()),(n=t[Jo[this.keywordIndex]])&&n[Go[this.keywordIndex]]&&n[Go[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"EvenFooter",i),e.writeEndElement()),(n=t[Ko[this.keywordIndex]])&&n[Go[this.keywordIndex]]&&n[Go[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"OddHeader",i),e.writeEndElement()),(n=t[Xo[this.keywordIndex]])&&n[Go[this.keywordIndex]]&&n[Go[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(n,"OddFooter",i),e.writeEndElement())}},e.prototype.addHeaderFooter=function(e,t,i){var n=new l;this.headersFooters.add(t,n),this.headersFooters.get(t).add(i,e)},e.prototype.serializeBodyItems=function(e,t,i){for(var n=0;n<t.length;n++)this.serializeBodyItem(e,t[parseInt(n.toString(),10)],i)},e.prototype.serializeContentControl=function(e,t,i,n,r){if((0,a.isNullOrUndefined)(t))throw new Error("contentCOntrol should not be undefined");e.writeStartElement("w","sdt",this.wNamespace),e.writeStartElement(void 0,"sdtPr",this.wNamespace),(0,a.isNullOrUndefined)(t)||this.serializeContentProperties(e,t,i,n,r)},e.prototype.serializeContentProperties=function(e,t,i,n,r){if((0,a.isNullOrUndefined)(t[no[this.keywordIndex]])||(e.writeStartElement(void 0,"alias",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[no[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"tag",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[io[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(t[ie[this.keywordIndex]])||this.serializeCharacterFormat(e,i[$r[this.keywordIndex]][ie[this.keywordIndex]]),(Pa.parseBoolValue(t[to[this.keywordIndex]])||Pa.parseBoolValue(t[eo[this.keywordIndex]]))&&(e.writeStartElement(void 0,"lock",this.wNamespace),Pa.parseBoolValue(t[eo[this.keywordIndex]])&&Pa.parseBoolValue(t[to[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):Pa.parseBoolValue(t[eo[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):Pa.parseBoolValue(t[to[this.keywordIndex]])&&e.writeAttributeString("w","val",this.wNamespace,"contentLocked"),e.writeEndElement()),Pa.parseBoolValue(t[ro[this.keywordIndex]])&&(0,a.isNullOrUndefined)(undefined)&&(e.writeStartElement("w","placeholder",void 0),e.writeAttributeString("w","docPart",this.wNamespace,void 0),e.writeEndElement(),e.writeStartElement("w","showingPlcHdr",void 0),e.writeEndElement()),Pa.parseBoolValue(t[so[this.keywordIndex]])&&(e.writeStartElement("w","temporary",void 0),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Zs[this.keywordIndex]])||(e.writeStartElement("w15","appearance",void 0),e.writeAttributeString("w15","val",void 0,1===this.keywordIndex?this.getContentControlAppearance(t[Zs[this.keywordIndex]]).toLowerCase():t[Zs[this.keywordIndex]].toLowerCase()),e.writeEndElement()),(0,a.isNullOrUndefined)(t[or[this.keywordIndex]])||(e.writeStartElement("w15","color",void 0),"empty"===t[or[this.keywordIndex]]||"#00000000"===t[or[this.keywordIndex]]?e.writeAttributeString("w","val",void 0,"auto"):e.writeAttributeString("w","val",void 0,this.getColor(t[or[this.keywordIndex]])),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Ms[this.keywordIndex]])||t[Ms[this.keywordIndex]]!==(1===this.keywordIndex?9:"Text")||(e.writeStartElement(void 0,"text",this.wNamespace),e.writeEndElement()),Pa.parseBoolValue(t[oo[this.keywordIndex]])&&(e.writeStartElement(void 0,"text",this.wNamespace),e.writeAttributeString("w","multiLine",this.wNamespace,"1"),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[fo[this.keywordIndex]])&&Pa.parseBoolValue(t[fo[this.keywordIndex]][bo[this.keywordIndex]])){e.writeStartElement("w","dataBinding",this.wNamespace);var o=t[fo[this.keywordIndex]][xo[this.keywordIndex]];e.writeAttributeString("w","prefixMappings",void 0,o);var s=t[fo[this.keywordIndex]][Io[this.keywordIndex]];e.writeAttributeString("w","xpath",void 0,s);var d=t[fo[this.keywordIndex]][ko[this.keywordIndex]];e.writeAttributeString("w","storeItemID",void 0,d),e.writeEndElement()}if(t.picture&&(e.writeStartElement("w","picture",this.wNamespace),e.writeEndElement()),(0,a.isNullOrUndefined)(t[uo[this.keywordIndex]]||t[go[this.keywordIndex]])||(e.writeStartElement("w14","checkbox",void 0),Pa.parseBoolValue(t[po[this.keywordIndex]])?(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"1"),e.writeEndElement()):(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"0"),e.writeEndElement()),t[uo[this.keywordIndex]]&&(e.writeStartElement("w14","uncheckedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[uo[this.keywordIndex]][yo[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[uo[this.keywordIndex]][vo[this.keywordIndex]]),e.writeEndElement()),t[go[this.keywordIndex]]&&(e.writeStartElement("w14","checkedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[go[this.keywordIndex]][yo[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[go[this.keywordIndex]][vo[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[mo[this.keywordIndex]])&&t[Ms[this.keywordIndex]]===(1===this.keywordIndex?5:"DropDownList")){var h=t[mo[this.keywordIndex]];e.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(e,h),e.writeEndElement()}if(!(0,a.isNullOrUndefined)(t[mo[this.keywordIndex]])&&t[Ms[this.keywordIndex]]===(1===this.keywordIndex?3:"ComboBox")){var c=t[mo[this.keywordIndex]];e.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(e,c),e.writeEndElement()}if(this.serializeContentControlDate(e,t),(0,a.isNullOrUndefined)(t[Ms[this.keywordIndex]])||t[Ms[this.keywordIndex]]===(1===this.keywordIndex?7:"Picture")&&(e.writeStartElement(void 0,"picture",this.wNamespace),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w","sdtContent",this.wNamespace),!r){if(i.hasOwnProperty(Go[this.keywordIndex])&&(0,a.isNullOrUndefined)(i[So[this.keywordIndex]]))for(var p=0;p<i[Go[this.keywordIndex]].length;p++){var u=i[Go[this.keywordIndex]][p];if(u.hasOwnProperty(Qr[this.keywordIndex]))this.paragraph=u,this.serializeParagraph(e,u,n),this.paragraph=void 0;else if(u.hasOwnProperty(To[this.keywordIndex])){var g=new l;this.serializeRow(e,u,g)}else if(u.hasOwnProperty($r[this.keywordIndex]))this.serializeContentControl(e,u[$r[this.keywordIndex]],u,n);else{var m=u;this.serializeTable(e,m)}}else if(i.hasOwnProperty(To[this.keywordIndex])){if(i[Ho[this.keywordIndex]].length>0){g=new l;this.serializeRow(e,i,g)}}else if(i.hasOwnProperty(So[this.keywordIndex])){g=new l;this.serializeCell(e,i,g)}e.writeEndElement(),e.writeEndElement()}},e.prototype.toUnicode=function(e){return e.charCodeAt(0).toString(16)},e.prototype.serializeContentControlList=function(e,t){for(var i=0;i<t.length;i++)e.writeStartElement(void 0,"listItem",this.wNamespace),(0,a.isNullOrUndefined)(t[i][wo[this.keywordIndex]])||e.writeAttributeString("w","displayText",this.wNamespace,t[i][wo[this.keywordIndex]]),e.writeAttributeString("w","value",this.wNamespace,t[i][yo[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeContentParagraph=function(e,t){for(var i=0;i<t[Go[this.keywordIndex]].length;i++){var n=t[Go[this.keywordIndex]][i];if(n.hasOwnProperty(Qr[this.keywordIndex]))for(var r=0;r<n[Qr[this.keywordIndex]].length;r++){var o=n[Qr[this.keywordIndex]][r];(0,a.isNullOrUndefined)(o[ie[this.keywordIndex]])||this.serializeCharacterFormat(e,o[ie[this.keywordIndex]])}}},e.prototype.serializeContentControlDate=function(e,t){t[Ms[this.keywordIndex]]===(1==this.keywordIndex?4:"Date")&&(e.writeStartElement("w","date",this.wNamespace),(0,a.isNullOrUndefined)(t[ao[this.keywordIndex]])||(e.writeStartElement("w","calender",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateCalendarType(t[ao[this.keywordIndex]]):t[ao[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(t[ho[this.keywordIndex]])||(e.writeStartElement("w","lid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[ho[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(t[lo[this.keywordIndex]])||(e.writeStartElement("w","storeMappedDataAs",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateStorageFormat(t[lo[this.keywordIndex]]):t[lo[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(t[co[this.keywordIndex]])||(e.writeStartElement("w","dateFormat",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[co[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeBodyItem=function(e,t,i){if((0,a.isNullOrUndefined)(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty($r[this.keywordIndex]))this.serializeContentControl(e,t[$r[this.keywordIndex]],t,i);else if(t.hasOwnProperty(Qr[this.keywordIndex]))this.paragraph=t,this.serializeParagraph(e,t,i),this.paragraph=void 0;else{for(var n=t,r=0;r<n[Eo[this.keywordIndex]].length;r++)if(n[Eo[this.keywordIndex]][r][Ho[this.keywordIndex]].length>0){this.serializeTable(e,n);break}var o=this.blockOwner;!i&&o.hasOwnProperty(es[this.keywordIndex])&&o[Go[this.keywordIndex]].indexOf(n)===o[Go[this.keywordIndex]].length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,o),e.writeEndElement(),e.writeEndElement())}},e.prototype.serializeParagraph=function(e,t,i){if((0,a.isNullOrUndefined)(t))throw new Error("Paragraph should not be undefined");(0,a.isNullOrUndefined)(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","p",this.wNamespace),this.isInsideComment&&e.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString()),e.writeStartElement(void 0,"pPr",this.wNamespace),(0,a.isNullOrUndefined)(t[ne[this.keywordIndex]])||this.serializeParagraphFormat(e,t[ne[this.keywordIndex]],t),(0,a.isNullOrUndefined)(t[ie[this.keywordIndex]])||this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]);var n=this.blockOwner;!i&&n.hasOwnProperty(es[this.keywordIndex])&&n[Go[this.keywordIndex]].indexOf(t)===n[Go[this.keywordIndex]].length-1&&this.serializeSectionProperties(e,n),e.writeEndElement(),this.prevRevisionIds=[],this.serializeParagraphItems(e,t[Qr[this.keywordIndex]]),(!this.isBookmarkAtEnd&&!this.isBookmarkAtRowEnd||this.isVerticalMergeCell)&&e.writeEndElement(),this.isBookmarkAtEnd=!1},e.prototype.serializeRevisionStart=function(e,t,i){if(t.hasOwnProperty(dt[this.keywordIndex])){if(!(0,a.isNullOrUndefined)(i)&&i.hasOwnProperty(fs[this.keywordIndex])&&0===i[fs[this.keywordIndex]]&&!(i[We[this.keywordIndex]].indexOf("_Toc")>=0)&&(0,a.isNullOrUndefined)(t[dt[this.keywordIndex]]))return;for(var n=t[dt[this.keywordIndex]],r=0;r<n.length;r++){var o=this.retrieveRevision(n[r]);"Insertion"===o.revisionType&&this.serializeTrackChanges(e,"ins",o.author,o.date),"Deletion"===o.revisionType&&this.serializeTrackChanges(e,"del",o.author,o.date)}}},e.prototype.serializeTrackChanges=function(e,t,i,n){e.writeStartElement("w",t,this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString()),"Unknown"!=i&&e.writeAttributeString("w","author",this.wNamespace,i),e.writeAttributeString("w","date",this.wNamespace,n)},e.prototype.retrieveRevision=function(e){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===e)return this.revisions[t]},e.prototype.serializeParagraphItems=function(e,t,i){if((0,a.isNullOrUndefined)(t))throw new Error("Paragraph should not be undefined");var n,r=void 0,o=!1;(0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=i);for(var s=0;s<t.length;s++){var l=t[s];l.hasOwnProperty($r[this.keywordIndex])&&(n=!0,this.serializeContentControl(e,l[$r[this.keywordIndex]],l,void 0,n),this.serializeParagraphItems(e,l[Qr[this.keywordIndex]])),l.hasOwnProperty(Qr[this.keywordIndex])&&this.serializeParagraphItems(e,l),this.serializeRevisionStart(e,l,r);var d=!1;if(l[ie[this.keywordIndex]]&&(d=!(0,a.isNullOrUndefined)(l[ie[this.keywordIndex]][Qe[this.keywordIndex]])&&0!==l[ie[this.keywordIndex]][Qe[this.keywordIndex]])&&!o&&(this.serializeBiDirectionalOverride(e,l[ie[this.keywordIndex]]),o=!0),o&&!d&&(e.writeEndElement(),o=!1),l.hasOwnProperty(Cr[this.keywordIndex]))this.serializeFieldCharacter(e,l);else if(l.hasOwnProperty(lr[this.keywordIndex]))this.serializePicture(e,l);else if(l.hasOwnProperty(Rn[this.keywordIndex])){var h=this.paragraph;this.serializeShape(e,l),this.paragraph=h}else l.hasOwnProperty(fs[this.keywordIndex])?this.serializeBookMark(e,l):l.hasOwnProperty(Is[this.keywordIndex])?this.serializeEditRange(e,l):l.hasOwnProperty(Wn[this.keywordIndex])?(this.chart=l,this.serializeChart(e,l),this.serializeChartStructure()):l.hasOwnProperty(Mr[this.keywordIndex])?this.serializeComment(e,l):l.hasOwnProperty(Xr[this.keywordIndex])?this.serializeEFReference(e,l):this.serializeTextRange(e,l,r);this.serializeRevisionEnd(e,l,r),r=l,n&&(e.writeEndElement(),e.writeEndElement(),n=!1)}o&&e.writeEndElement()},e.prototype.serializeEFReference=function(e,t){var i="",n=t[Go[this.keywordIndex]];t[Xr[this.keywordIndex]]===(1==this.keywordIndex?0:"Footnote")?(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),e.writeStartElement(void 0,"footnoteReference",this.wNamespace),this.document[Se[this.keywordIndex]][ms[this.keywordIndex]]&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"footnote",i),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),e.writeStartElement(void 0,"endnoteReference",this.wNamespace),this.document[Te[this.keywordIndex]][ms[this.keywordIndex]]&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(n,"endnote",i),e.writeEndElement(),e.writeEndElement())},e.prototype.addFootnotesEndnotes=function(e,t,i){var n=new l;this.endnotesFootnotes.add(t,n),this.endnotesFootnotes.get(t).add(i,e)},e.prototype.serializeEndnotesFootnote=function(e,t){if(0!==this.endnotesFootnotes.length&&this.endnotesFootnotes.containsKey(t))for(var i=this.endnotesFootnotes.get(t),n=void 0,r=0;r<i.keys.length;r++){var o=i.keys[r];n=i.get(o),"endnote"===t?(this.endnotesPath,this.endnotesRelationPath,this.serializeInlineEndnotes(e,n,o)):(this.footnotesPath,this.footnotesRelationPath,this.serializeInlineFootnotes(e,n,o))}},e.prototype.serializeInlineEndnotes=function(e,t,i){this.isSerializeFootEndNote="Endnote",this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},e.prototype.serializeInlineFootnotes=function(e,t,i){this.isSerializeFootEndNote="Footnote",this.endNoteFootnote=t;var n=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=n,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},e.prototype.writeEFCommonAttributes=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink"),e.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d"),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeFootnotes=function(){if(!(0,a.isNullOrUndefined)(this.document[Se[this.keywordIndex]])){var e=new np.XmlWriter;e.writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[Se[this.keywordIndex]][us[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[Se[this.keywordIndex]][gs[this.keywordIndex]],!0),e.writeEndElement(),this.document[Se[this.keywordIndex]][ms[this.keywordIndex]]&&(e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[Se[this.keywordIndex]][ms[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"footnote"),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.footnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeEndnotes=function(){if(!(0,a.isNullOrUndefined)(this.document[Te[this.keywordIndex]])){var e=new np.XmlWriter;e.writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[Te[this.keywordIndex]][us[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[Te[this.keywordIndex]][gs[this.keywordIndex]],!0),e.writeEndElement(),this.document[Te[this.keywordIndex]][ms[this.keywordIndex]]&&(e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[Te[this.keywordIndex]][ms[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"endnote"),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.endnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeRevisionEnd=function(e,t,i){if(t.hasOwnProperty(dt[this.keywordIndex]))for(var n=0;n<t[dt[this.keywordIndex]].length;n++){var r=this.retrieveRevision(t[dt[this.keywordIndex]][n]);"Insertion"!==r.revisionType&&"Deletion"!==r.revisionType||e.writeEndElement()}},e.prototype.serializeComment=function(e,t){if(1!==this.mComments.length||""!==this.mComments[0].text){0===t[Mr[this.keywordIndex]]?e.writeStartElement("w","commentRangeStart",this.wNamespace):1===t[Mr[this.keywordIndex]]&&e.writeStartElement("w","commentRangeEnd",this.wNamespace);var i=this.commentId[t[Rr[this.keywordIndex]]];(0,a.isNullOrUndefined)(i)&&(i=this.commentId[t[Rr[this.keywordIndex]]]=this.currentCommentId++),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement(),1===t[Mr[this.keywordIndex]]&&this.serializeCommentItems(e,i)}},e.prototype.serializeCommentItems=function(e,t){e.writeStartElement("w","r",this.wNamespace),e.writeStartElement("w","commentReference",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,t.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBiDirectionalOverride=function(e,t){e.writeStartElement(void 0,"bdo",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getBiDirectionalOverride(t[Qe[this.keywordIndex]]).toLowerCase():t[Qe[this.keywordIndex]].toLowerCase())},e.prototype.serializeEditRange=function(e,t){t.hasOwnProperty(Ts[this.keywordIndex])?e.writeStartElement("w","permEnd",this.wNamespace):(e.writeStartElement("w","permStart",this.wNamespace),t[Ps[this.keywordIndex]]&&""!==t[Ps[this.keywordIndex]]&&e.writeAttributeString("w","ed",this.wNamespace,t[Ps[this.keywordIndex]]),t[Ss[this.keywordIndex]]&&""!==t[Ss[this.keywordIndex]]&&e.writeAttributeString("w","edGrp",this.wNamespace,t[Ss[this.keywordIndex]].toLowerCase()),(0,a.isNullOrUndefined)(t[ks[this.keywordIndex]])||-1===t[ks[this.keywordIndex]]||e.writeAttributeString("w","colFirst",this.wNamespace,t[ks[this.keywordIndex]].toString()),(0,a.isNullOrUndefined)(t[Fs[this.keywordIndex]])||-1===t[Fs[this.keywordIndex]]||e.writeAttributeString("w","colLast",this.wNamespace,t[Fs[this.keywordIndex]].toString())),e.writeAttributeString("w","id",this.wNamespace,t[Is[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeBookMark=function(e,t){var i=this.getBookmarkId(t[We[this.keywordIndex]]),n=t[We[this.keywordIndex]];0===t[fs[this.keywordIndex]]?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,n),(0,a.isNullOrUndefined)(t[vs[this.keywordIndex]])||(e.writeAttributeString("w","colFirst",this.wNamespace,t[vs[this.keywordIndex]][ks[this.keywordIndex]].toString()),e.writeAttributeString("w","colLast",this.wNamespace,t[vs[this.keywordIndex]][Fs[this.keywordIndex]].toString()))):1===t[fs[this.keywordIndex]]&&((0,a.isNullOrUndefined)(t[vs[this.keywordIndex]])||this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||(Pa.parseBoolValue(t[vs[this.keywordIndex]][ra[this.keywordIndex]])?(e.writeEndElement(),this.isBookmarkAtEnd=!0):Pa.parseBoolValue(t[vs[this.keywordIndex]][sa[this.keywordIndex]])&&(e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),this.isBookmarkAtRowEnd=!0)),e.writeStartElement("w","bookmarkEnd",this.wNamespace)),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement()},e.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},e.prototype.serializePicture=function(e,t){t[zn[this.keywordIndex]]>=0&&t[qn[this.keywordIndex]]>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeShape=function(e,t){t[zn[this.keywordIndex]]>=0&&t[qn[this.keywordIndex]]>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),t[Vn[this.keywordIndex]]>0?this.serializeHorizontalRule(e,t):this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeHorizontalRule=function(e,t){e.writeStartElement(void 0,"pict",this.wNamespace),e.writeStartElement("v","rect",void 0);var i=Math.round(t[zn[this.keywordIndex]]),n=Math.round(t[qn[this.keywordIndex]]);if(e.writeAttributeString(void 0,"style",void 0,"width:"+i.toString()+";height:"+n.toString()),t[_o[this.keywordIndex]]>0){var r=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[_o[this.keywordIndex]]):t[_o[this.keywordIndex]].toString();e.writeAttributeString("o","hralign",void 0,r.toLowerCase())}e.writeAttributeString("o","hrstd",void 0,"t"),e.writeAttributeString("o","hr",void 0,"t"),e.writeAttributeString(void 0,"fillcolor",void 0,this.getColor(t[Kn[this.keywordIndex]][or[this.keywordIndex]])),e.writeAttributeString(void 0,"stroked",void 0,"f"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),t.hasOwnProperty(Wn[this.keywordIndex])?this.serializeInlineCharts(e,t):t[Xn[this.keywordIndex]]===(1==this.keywordIndex?0:"Inline")?this.serializeInlinePictureAndShape(e,t):this.serializeWrappingPictureAndShape(e,t),e.writeEndElement()},e.prototype.serializeWrappingPictureAndShape=function(e,t){(0,a.isNullOrUndefined)(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("wp","anchor",this.wpNamespace),this.serializePictureAndShapeDistance(e,t),e.writeAttributeString(void 0,"simplePos",void 0,"0"),e.writeAttributeString(void 0,"relativeHeight",void 0,t[er[this.keywordIndex]]?Math.abs(t[er[this.keywordIndex]]).toString():"0");var i=t[Xn[this.keywordIndex]]&&t[Xn[this.keywordIndex]]===(1==this.keywordIndex?4:"Behind");e.writeAttributeString(void 0,"behindDoc",void 0,i?"1":"0");var n=1==this.keywordIndex?(0,a.isNullOrUndefined)(t[ir[this.keywordIndex]])?"0":t[ir[this.keywordIndex]].toString():t[ir[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"locked",void 0,n);var r=1==this.keywordIndex?(0,a.isNullOrUndefined)(t[tr[this.keywordIndex]])?"0":t[tr[this.keywordIndex]].toString():t[tr[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"layoutInCell",void 0,r);var o=1==this.keywordIndex?(0,a.isNullOrUndefined)(t[Do[this.keywordIndex]])?"0":t[Do[this.keywordIndex]].toString():t[Do[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"allowOverlap",void 0,o),e.writeStartElement("wp","simplePos",this.wpNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("wp","positionH",this.wpNamespace);var s=1==this.keywordIndex?this.getHorizontalOrigin(t[qo[this.keywordIndex]]):t[qo[this.keywordIndex]].toString();if(e.writeAttributeString(void 0,"relativeFrom",void 0,Pa.formatText("firstlower",s)),t[_o[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){e.writeStartElement("wp","posOffset",this.wpNamespace);var l=Math.round(t[jo[this.keywordIndex]]*this.emusPerPoint);e.writeString(l.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var d=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[_o[this.keywordIndex]]):t[_o[this.keywordIndex]].toString();e.writeString(d.toLowerCase()),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("wp","positionV",this.wpNamespace);var h=1==this.keywordIndex?this.getVerticalOrigin(t[Vo[this.keywordIndex]]):t[Vo[this.keywordIndex]].toString();if(e.writeAttributeString(void 0,"relativeFrom",void 0,Pa.formatText("firstlower",h)),t[oi[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){e.writeStartElement("wp","posOffset",this.wpNamespace);var c=Math.round(t[zo[this.keywordIndex]]*this.emusPerPoint);e.writeString(c.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var p=1==this.keywordIndex?this.getShapeVerticalAlignment(t[oi[this.keywordIndex]]):t[oi[this.keywordIndex]];e.writeString(p.toLowerCase()),e.writeEndElement()}e.writeEndElement(),e.writeStartElement(void 0,"extent",this.wpNamespace);var u=Math.round(t[zn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,u.toString());var g=Math.round(t[qn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,g.toString()),e.writeEndElement(),(0,a.isNullOrUndefined)(t[lr[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializeInlinePictureAndShape=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[zn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var n=Math.round(t[qn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),(0,a.isNullOrUndefined)(t[lr[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializePictureAndShapeDistance=function(e,t){var i=t[Ro[this.keywordIndex]]?Math.round(t[Ro[this.keywordIndex]]*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distT",void 0,i);var n=t[Uo[this.keywordIndex]]?Math.round(t[Uo[this.keywordIndex]]*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distB",void 0,n);var r=t[Ao[this.keywordIndex]]?Math.round(t[Ao[this.keywordIndex]]*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distL",void 0,r);var o=t[Mo[this.keywordIndex]]?Math.round(t[Mo[this.keywordIndex]]*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distR",void 0,o)},e.prototype.writeDefaultDistAttribute=function(e){e.writeAttributeString(void 0,"distT",void 0,"0"),e.writeAttributeString(void 0,"distB",void 0,"0"),e.writeAttributeString(void 0,"distL",void 0,"0"),e.writeAttributeString(void 0,"distR",void 0,"0")},e.prototype.serializeInlineCharts=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[zn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var n=Math.round(t[qn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeStartElement(void 0,"effectExtent",this.wpNamespace),e.writeAttributeString(void 0,"l",void 0,"0"),e.writeAttributeString(void 0,"t",void 0,"0"),e.writeAttributeString(void 0,"r",void 0,"0"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeEndElement(),this.serializeDrawingGraphicsChart(e,t),e.writeEndElement()},e.prototype.serializeDrawingGraphicsChart=function(e,t){var i;i=this.updatechartId(t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,this.getNextChartName()),e.writeEndElement(),e.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.chartNamespace),e.writeStartElement("c","chart",this.chartNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("r","id",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getBase64ImageString=function(e){var t=(0,a.isNullOrUndefined)(e[dr[this.keywordIndex]])?this.mImages.get(parseInt(e[lr[this.keywordIndex]])):this.mImages.get(parseInt(e[dr[this.keywordIndex]])),i=t[Pa.parseBoolValue(e[pr[this.keywordIndex]])?1:0];return{imageString:i,metaFileImageString:t[this.startsWith(i,"https://")||this.startsWith(i,"http://")||this.startsWith(i,"file://")?1:0]}},e.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},e.prototype.serializeChart=function(e,t){e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement()},e.prototype.serializeChartStructure=function(){this.serializeChartXML(),this.serializeChartColors(),this.serializeChartExcelData(),this.serializeChartRelations(),this.chart=void 0,this.saveExcel()},e.prototype.serializeChartXML=function(){var e,t=new np.XmlWriter;t.writeStartElement("c","chartSpace",this.chartNamespace),t.writeAttributeString("xmlns","a",void 0,this.aNamespace),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace),this.serializeChartData(t,this.chart),t.writeStartElement("c","externalData",this.chartNamespace),t.writeAttributeString("r","id",void 0,"rId1"),t.writeStartElement("c","autoUpdate",this.chartNamespace),t.writeAttributeString(void 0,"val",void 0,"0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),e=this.chartPath+"/chart"+this.chartCount+".xml";var i=new Fa.ZipArchiveItem(t.buffer,e);this.mArchive.addItem(i)},e.prototype.serializeChartColors=function(){var e=new np.XmlWriter,t="";e.writeStartElement("cs","colorStyle",this.csNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString(void 0,"meth",void 0,"cycle"),e.writeAttributeString(void 0,"id",void 0,"10"),this.serializeChartColor(e),t=this.chartPath+"/colors"+this.chartCount+".xml",e.writeEndElement();var i=new Fa.ZipArchiveItem(e.buffer,t);this.mArchive.addItem(i),t=""},e.prototype.serializeChartColor=function(e){for(var t=1;t<=6;t++)e.writeStartElement("a","schemeClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"accent"+t),e.writeEndElement();e.writeStartElement("cs","variation",this.csNamespace),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"20000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"40000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"30000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartExcelData=function(){(0,a.isNullOrUndefined)(this.excelFiles)&&(this.excelFiles=new l),this.mArchiveExcel=new Fa.ZipArchive,this.mArchiveExcel.compressionLevel="Normal";var e=this.chart[Wn[this.keywordIndex]],t="Scatter_Markers"===e||"Bubble"===e;this.serializeWorkBook(),this.serializeSharedString(t),this.serializeExcelContentTypes(),this.serializeExcelData(t),this.serializeExcelStyles(),this.serializeExcelRelation(),this.serializeExcelGeneralRelations(),this.chartStringCount=0},e.prototype.serializeWorkBook=function(){var e=new np.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"workbook",void 0),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeStartElement(void 0,"sheets",void 0),e.writeStartElement(void 0,"sheet",void 0),e.writeAttributeString(void 0,"name",void 0,"Sheet1"),e.writeAttributeString(void 0,"sheetId",void 0,"1"),e.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,"xl/workbook.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelStyles=function(){var e=new np.XmlWriter;e.writeStartElement(void 0,"styleSheet",void 0),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("mc","Ignorable",void 0,"x14ac"),e.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,"xl/styles.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelData=function(e){var t=new np.XmlWriter;t.writeStartElement(void 0,"worksheet",void 0),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9),t.writeAttributeString("xmlns","mc",void 0,this.veNamespace),t.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),this.serializeExcelSheet(t,e),t.writeEndElement();var i=new Fa.ZipArchiveItem(t.buffer,"xl/worksheets/sheet1.xml");this.mArchiveExcel.addItem(i)},e.prototype.serializeSharedString=function(e){for(var t=this.chart,i=new np.XmlWriter,n=[],r=this.chart[Wn[this.keywordIndex]],o=t[kn[this.keywordIndex]].length,s=0;s<o;s++){var a=t[kn[this.keywordIndex]][s],l=a[nn[this.keywordIndex]].match(/[a-z]/i);e&&0===s&&n.push("X-Values"),l&&(n.push(a[nn[this.keywordIndex]]),this.chartStringCount++)}"Bubble"===r&&n.push("Size");for(var d=0;d<t[In[this.keywordIndex]].length;d++){var h=t[In[this.keywordIndex]][d],c=t[Hn[this.keywordIndex]][ss[this.keywordIndex]],p=h[Ai[this.keywordIndex]];l=p.match(/[a-z]/i);(/^(((0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4})|((0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{4})|((\d{4})\/(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])))/.test(p)||l||"m/d/yyyy"===c)&&(n.push(h[Ai[this.keywordIndex]]),this.chartStringCount++)}var u=this.chartStringCount+1;i.writeStartElement(void 0,"sst",void 0),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),i.writeAttributeString(void 0,"count",void 0,u.toString()),i.writeAttributeString(void 0,"uniqueCount",void 0,u.toString());for(var g=0;g<=n.length;g++)i.writeStartElement(void 0,"si",void 0),i.writeStartElement(void 0,"t",void 0),g!==n.length?i.writeString(n[g]):e||(i.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),i.writeString(" ")),i.writeEndElement(),i.writeEndElement();i.writeEndElement();var m=new Fa.ZipArchiveItem(i.buffer,"xl/sharedStrings.xml");this.mArchiveExcel.addItem(m)},e.prototype.serializeExcelSheet=function(e,t){var i,n=this.chart,r="s",o="Bubble"===n[Wn[this.keywordIndex]],s=n[In[this.keywordIndex]].length+1,l=n[Hn[this.keywordIndex]][ss[this.keywordIndex]],d=n[kn[this.keywordIndex]].length+1;o&&(i=d,d+=1);var h=void 0,c=void 0,p=0;e.writeStartElement(void 0,"sheetData",void 0);for(var u=0;u<s;u++){e.writeStartElement(void 0,"row",void 0),e.writeAttributeString(void 0,"r",void 0,(u+1).toString());for(var g=0;g<d;g++){var m=String.fromCharCode("A".charCodeAt(0)+g)+(u+1).toString();if(e.writeStartElement(void 0,"c",void 0),e.writeAttributeString(void 0,"r",void 0,m),0!==u&&0===g){var f=(h=n[In[this.keywordIndex]][u-1])[Ai[this.keywordIndex]],v=f.match(/[a-z]/i);r=/^(((0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4})|((0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{4})|((\d{4})\/(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])))/.test(f)||(0,a.isNullOrUndefined)(v)&&"m/d/yyyy"===l?"s":!v||t?"n":"s"}else if(0===u&&0!==g&&g!==i){r=(v=(c=n[kn[this.keywordIndex]][g-1])[nn[this.keywordIndex]].match(/[a-z]/i))?"s":"n"}else r=0===u&&o&&g===i||0===u&&0===g?"s":"n";if(e.writeAttributeString(void 0,"t",void 0,r),e.writeStartElement(void 0,"v",void 0),0!==u||0!==g||t){if("s"===r&&p<this.chartStringCount)e.writeString(p.toString()),p++;else if(0!==u&&"s"!==r&&0===g&&g!==i)e.writeString(h[Ai[this.keywordIndex]]);else if(0!==g&&"s"!==r&&0===u&&g!==i)e.writeString(c[nn[this.keywordIndex]]);else if(0!==u&&0!==g&&g!==i){var y=h[Mi[this.keywordIndex]][g-1];if(!(0,a.isNullOrUndefined)(y)){var w=y[Ri[this.keywordIndex]];e.writeString(w.toString())}}else if(0!==u&&o&&g===i){y=h[Mi[this.keywordIndex]][g-2];if(!(0,a.isNullOrUndefined)(y)){var b=y[Or[this.keywordIndex]];e.writeString(b.toString())}}}else e.writeString(this.chartStringCount.toString());e.writeEndElement(),e.writeEndElement(),r=""}e.writeEndElement()}e.writeEndElement()},e.prototype.serializeExcelContentTypes=function(){var e=new np.XmlWriter;e.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(e,"xml",this.xmlContentType),this.serializeDefaultContentType(e,"rels",this.relationContentType),this.serializeOverrideContentType(e,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),this.serializeOverrideContentType(e,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),this.serializeOverrideContentType(e,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this.serializeOverrideContentType(e,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.contentTypesPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelRelation=function(){var e=new np.XmlWriter;this.resetExcelRelationShipId();e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml"),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.excelRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelGeneralRelations=function(){var e=new np.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml"),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},e.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},e.prototype.serializeChartData=function(e,t){e.writeStartElement("c","date1904",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","lang",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"en-US"),e.writeEndElement(),e.writeStartElement("c","roundedCorners",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("mc","AlternateContent",this.veNamespace),e.writeStartElement("mc","Choice",this.veNamespace),e.writeAttributeString("xmlns","c14",void 0,this.c7Namespace),e.writeAttributeString(void 0,"Requires",void 0,"c14"),e.writeStartElement("c14","style",void 0),e.writeAttributeString(void 0,"val",void 0,"102"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("mc","Fallback",this.veNamespace),e.writeStartElement("c","style",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"2"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","chart",this.chartNamespace),(0,a.isNullOrUndefined)(this.chart[Nn[this.keywordIndex]])||(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,this.chart[Pn[this.keywordIndex]],this.chart[Nn[this.keywordIndex]]),e.writeEndElement()),this.serializeChartPlotArea(e,t),e.writeEndElement(),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeStartElement("c","txPr",this.chartNamespace),e.writeAttributeString("xmlns","c",void 0,this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","endParaRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartPlotArea=function(e,t){e.writeStartElement("c","autoTitleDeleted",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","plotArea",this.chartNamespace),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement();var i=this.chartType(t),n="pieChart"===i||"doughnutChart"===i,r="scatterChart"===i||"bubbleChart"===i;if(e.writeStartElement("c",i,this.chartNamespace),"barChart"===i){var o="";o="Column_Clustered"===t[Wn[this.keywordIndex]]||"Column_Stacked"===t[Wn[this.keywordIndex]]||"Column_Stacked_100"===t[Wn[this.keywordIndex]]?"col":"bar",e.writeStartElement("c","barDir",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o),e.writeEndElement()}if(!n&&!r){var s=this.chartGrouping(t[Wn[this.keywordIndex]]);e.writeStartElement("c","grouping",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s),e.writeEndElement()}"scatterChart"===i&&(e.writeStartElement("c","scatterStyle",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"marker"),e.writeEndElement()),e.writeStartElement("c","varyColors",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement();for(var l="",d=0;d<t[kn[this.keywordIndex]].length;d++){var h=t[kn[this.keywordIndex]][d];this.seriesCount=d,e.writeStartElement("c","ser",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeStartElement("c","order",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","strRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace);var c=String.fromCharCode("B".charCodeAt(0)+d);if(l="Sheet1!$"+c,e.writeString(l+"$1"),l=l+"$2:$"+c+"$",e.writeEndElement(),e.writeStartElement("c","strCache",this.chartNamespace),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,"0"),e.writeStartElement("c","v",this.chartNamespace),e.writeString(h[nn[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),"Pie"===t[Wn[this.keywordIndex]]||"Doughnut"===t[Wn[this.keywordIndex]]?(this.parseChartDataPoint(e,h),e.writeStartElement("c","explosion",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):r||this.parseChartSeriesColor(e,h[ln[this.keywordIndex]],i),"scatterChart"===i){var p=h[ln[this.keywordIndex]][0][sr[this.keywordIndex]][Vi[this.keywordIndex]];e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"circle"),e.writeEndElement(),e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"5"),e.writeEndElement(),this.serializeShapeProperties(e,p,!1),e.writeEndElement()}h[rn[this.keywordIndex]]&&this.parseChartDataLabels(e,h[rn[this.keywordIndex]]),h[an[this.keywordIndex]]&&this.parseChartTrendLines(e,h),h[on[this.keywordIndex]]&&this.serializeChartErrorBar(e,h),"scatterChart"===i?this.serializeDefaultShapeProperties(e):"bubbleChart"===i&&this.serializeShapeProperties(e,h[ln[this.keywordIndex]][0][sr[this.keywordIndex]][Vi[this.keywordIndex]],!1);var u="cat",g="strRef",m="strCache";"scatterChart"===i&&(u="xVal",g="numRef",m="numCache"),e.writeStartElement("c",u,this.chartNamespace),e.writeStartElement("c",g,this.chartNamespace),this.serializeChartCategory(e,t,m),e.writeEndElement(),e.writeEndElement(),this.serializeChartValue(e,l,i),e.writeEndElement()}if(e.writeStartElement("c","dLbls",this.chartNamespace),n&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"bestFit"),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeEndElement(),n){var f=0,v=0;(h=this.chart[kn[this.keywordIndex]][0]).hasOwnProperty(dn[this.keywordIndex])&&(f=h[dn[this.keywordIndex]]),e.writeStartElement("c","firstSliceAng",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,f.toString()),e.writeEndElement(),"Doughnut"===t[Wn[this.keywordIndex]]&&(v=h[hn[this.keywordIndex]],e.writeStartElement("c","holeSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,v.toString()),e.writeEndElement())}"lineChart"===i||r?"bubbleChart"!==i&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):(e.writeStartElement("c","gapWidth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[On[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","overlap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[Bn[this.keywordIndex]].toString()),e.writeEndElement()),"bubbleChart"===i&&(e.writeStartElement("c","sizeRepresents",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"area"),e.writeEndElement());var y=this.chart[Wn[this.keywordIndex]];n||(e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement()),e.writeEndElement();var w="Column_Stacked_100"===y||"Area_Stacked_100"===y||"Bar_Stacked_100"===y||"Line_Stacked_100"===y||"Line_Markers_Stacked_100"===y,b=this.chart[Hn[this.keywordIndex]][xn[this.keywordIndex]];if(n||(this.serializeCategoryAxis(e,b,w),this.serializeValueAxis(e,b,w)),this.chart.hasOwnProperty(Ln[this.keywordIndex])){var C=this.chart[Ln[this.keywordIndex]],x=0,I=0,k=0,F=0;Pa.parseBoolValue(C[yn[this.keywordIndex]])&&(F=1),Pa.parseBoolValue(C[wn[this.keywordIndex]])&&(x=1),Pa.parseBoolValue(C[bn[this.keywordIndex]])&&(I=1),Pa.parseBoolValue(C[Cn[this.keywordIndex]])&&(k=1),e.writeStartElement("c","dTable",this.chartNamespace),e.writeStartElement("c","showHorzBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,x.toString()),e.writeEndElement(),e.writeStartElement("c","showVertBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,I.toString()),e.writeEndElement(),e.writeStartElement("c","showOutline",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,k.toString()),e.writeEndElement(),e.writeStartElement("c","showKeys",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,F.toString()),e.writeEndElement(),e.writeEndElement()}this.serializeDefaultShapeProperties(e),e.writeEndElement(),(0,a.isNullOrUndefined)(this.chart[Tn[this.keywordIndex]][ws[this.keywordIndex]])||this.serializeChartLegend(e),e.writeStartElement("c","plotVisOnly",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","dispBlanksAs",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"gap"),e.writeEndElement()},e.prototype.serializeChartLegend=function(e){var t=this.chartLegendPosition(this.chart[Tn[this.keywordIndex]]),i=this.chart[Tn[this.keywordIndex]][Pn[this.keywordIndex]],n=i[Di[this.keywordIndex]][sr[this.keywordIndex]][Vi[this.keywordIndex]];e.writeStartElement("c","legend",this.chartNamespace),e.writeStartElement("c","legendPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[Ke[this.keywordIndex]],n,i[ea[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartErrorBar=function(e,t){var i=t[on[this.keywordIndex]],n=this.errorBarValueType(i[Ms[this.keywordIndex]]),r=0;"Cap"!==i[Gi[this.keywordIndex]]&&(r=1),e.writeStartElement("c","errBars",this.chartNamespace),e.writeStartElement("c","errBarType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[ji[this.keywordIndex]].toLowerCase()),e.writeEndElement(),e.writeStartElement("c","errValType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),e.writeStartElement("c","noEndCap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","val",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[Ki[this.keywordIndex]].toString()),e.writeEndElement(),this.serializeShapeProperties(e,"595959",!0),e.writeEndElement()},e.prototype.errorBarValueType=function(e){var t="";switch(e){case"StandardError":default:t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal"}return t},e.prototype.serializeCategoryAxis=function(e,t,i){var n="catAx",r=this.chart[Hn[this.keywordIndex]][ss[this.keywordIndex]],o=this.chart[Wn[this.keywordIndex]],s="Scatter_Markers"===o||"Bubble"===o;"Time"===t&&(n="dateAx"),s&&(n="valAx"),e.writeStartElement("c",n,this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),this.serializeAxis(e,"335263360",this.chart[Hn[this.keywordIndex]],r,i),s||(e.writeStartElement("c","auto",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","lblAlgn",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"ctr"),e.writeEndElement(),e.writeStartElement("c","lblOffset",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"100"),e.writeEndElement()),"Time"===t?(e.writeStartElement("c","baseTimeUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"days"),e.writeEndElement()):"Bubble"!==this.chart[Wn[this.keywordIndex]]&&(e.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeValueAxis=function(e,t,i){var n=this.chart[En[this.keywordIndex]],r="between";"Time"===t&&(r="midCat"),e.writeStartElement("c","valAx",this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement(),this.serializeAxis(e,"335265000",n,"General",i),e.writeStartElement("c","crossBetween",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),0===n[As[this.keywordIndex]]||i||n[Us[this.keywordIndex]]||(e.writeStartElement("c","majorUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[As[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeAxis=function(e,t,i,n,r){e.writeStartElement("c","scaling",this.chartNamespace),e.writeStartElement("c","orientation",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"minMax"),e.writeEndElement(),0===i[Vs[this.keywordIndex]]||r||(e.writeStartElement("c","max",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[Vs[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","min",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[zs[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("c","delete",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","axPos",this.chartNamespace),"335265000"===t?e.writeAttributeString(void 0,"val",void 0,"l"):e.writeAttributeString(void 0,"val",void 0,"b"),e.writeEndElement(),Pa.parseBoolValue(i[qs[this.keywordIndex]])&&(e.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeEndElement()),Pa.parseBoolValue(i[_s[this.keywordIndex]])&&(e.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"F2F2F2",!0),e.writeEndElement()),i[Nn[this.keywordIndex]]&&(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,i[Pn[this.keywordIndex]],i[Nn[this.keywordIndex]]),e.writeEndElement()),e.writeStartElement("c","numFmt",this.chartNamespace),e.writeAttributeString(void 0,"formatCode",void 0,n),e.writeAttributeString(void 0,"sourceLinked",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","majorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","minorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","tickLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"nextTo"),e.writeEndElement(),"Bubble"===this.chart[Wn[this.keywordIndex]]?this.serializeShapeProperties(e,"BFBFBF",!0):this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[Ke[this.keywordIndex]],"595959",i[ea[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","crossAx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","crosses",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"autoZero"),e.writeEndElement()},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<t[an[this.keywordIndex]].length;i++){var n=t[an[this.keywordIndex]][i],r=this.chartTrendLineType(n[Ms[this.keywordIndex]]),o=0,s=0;Pa.parseBoolValue(n[tn[this.keywordIndex]])?s=1:Pa.parseBoolValue(n[en[this.keywordIndex]])&&(o=1);var a=t[ln[this.keywordIndex]][i];e.writeStartElement("c","trendline",this.chartNamespace),e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"19050"),this.serializeChartSolidFill(e,a[sr[this.keywordIndex]][Vi[this.keywordIndex]],!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"sysDot"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","trendlineType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),e.writeStartElement("c","forward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[Yi[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","backward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[Qi[this.keywordIndex]].toString()),e.writeEndElement(),"NaN"!==n[$i[this.keywordIndex]]&&(e.writeStartElement("c","intercept",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n[$i[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement("c","dispRSqr",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","dispEq",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeEndElement()}},e.prototype.chartTrendLineType=function(e){var t="";switch(e){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},e.prototype.parseChartDataLabels=function(e,t){var i="",n=0,r=0,o=0,s=0,a=0,l=0,d=0;switch(t[ws[this.keywordIndex]]){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}e.writeStartElement("c","dLbls",this.chartNamespace),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[Ke[this.keywordIndex]],t[Xe[this.keywordIndex]],t[ea[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),Pa.parseBoolValue(t[cn[this.keywordIndex]])?n=1:Pa.parseBoolValue(t[pn[this.keywordIndex]])?r=1:Pa.parseBoolValue(t[un[this.keywordIndex]])?o=1:Pa.parseBoolValue(t[gn[this.keywordIndex]])?s=1:Pa.parseBoolValue(t[mn[this.keywordIndex]])?a=1:Pa.parseBoolValue(t[fn[this.keywordIndex]])?l=1:Pa.parseBoolValue(t[vn[this.keywordIndex]])&&(d=1),"Automatic"!==i&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,a.toString()),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeShapeProperties=function(e,t,i){var n=this.chart[Wn[this.keywordIndex]],r="Scatter_Markers"===n||"Bubble"===n;e.writeStartElement("c","spPr",this.chartNamespace),!r||i?(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(e,t,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"solid"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()):"Scatter_Markers"===n?(this.serializeChartSolidFill(e,t,!1),this.serializeDefaultLineProperties(e)):"Bubble"===n&&(this.serializeChartSolidFill(e,t,!0),this.serializeDefaultLineProperties(e)),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultShapeProperties=function(e){e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),this.serializeDefaultLineProperties(e),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultLineProperties=function(e){e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeTextProperties=function(e,t,i){var n=t[Di[this.keywordIndex]][sr[this.keywordIndex]][Vi[this.keywordIndex]],r=100*t[Ke[this.keywordIndex]];e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","rich",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString(void 0,"rot",void 0,"0"),e.writeAttributeString(void 0,"vert",void 0,"horz"),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[Ke[this.keywordIndex]],n,t[ea[this.keywordIndex]]),e.writeStartElement("a","r",this.aNamespace),e.writeStartElement("a","rPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,this.roundToTwoDecimal(r).toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,n,!1),this.serializeFont(e,t[ea[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","t",this.aNamespace),e.writeString(i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeEndElement(),this.serializeChartTitleFont(e,t[Ke[this.keywordIndex]],n,t[ea[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeChartTitleFont=function(e,t,i,n){var r=100*t;e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,this.roundToTwoDecimal(r).toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,i,!1),this.serializeFont(e,n),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartSolidFill=function(e,t,i){e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),"000000"!==t?e.writeAttributeString(void 0,"val",void 0,t):e.writeAttributeString(void 0,"val",void 0,"595959"),"Bubble"===this.chart[Wn[this.keywordIndex]]&&i&&(e.writeStartElement("a","alpha",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"75000"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeFont=function(e,t){e.writeStartElement("a","latin",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","ea",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","cs",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement()},e.prototype.parseChartSeriesColor=function(e,t,i){for(var n=0;n<t.length;n++){var r=t[n];if(e.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"28575"),e.writeAttributeString(void 0,"cap",void 0,"rnd")),"lineChart"!==i?this.serializeChartSolidFill(e,this.getColor(r[sr[this.keywordIndex]][Xs[this.keywordIndex]]),!0):this.serializeChartSolidFill(e,r[Ui[this.keywordIndex]][or[this.keywordIndex]],!0),"lineChart"!==i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),"lineChart"===i){var o="none",s=0;this.chart[kn[this.keywordIndex]][n].hasOwnProperty(sn[this.keywordIndex])&&(o=this.chart[kn[this.keywordIndex]][n][sn[this.keywordIndex]][Xi[this.keywordIndex]],s=this.chart[kn[this.keywordIndex]][n][sn[this.keywordIndex]][Ji[this.keywordIndex]]),e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toLowerCase()),e.writeEndElement(),this.chart[kn[this.keywordIndex]][n].hasOwnProperty(sn[this.keywordIndex])&&(e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement()),e.writeEndElement()}}},e.prototype.parseChartDataPoint=function(e,t){for(var i=t[ln[this.keywordIndex]],n=[],r=0;r<i.length;r++)n.push(i[r]),e.writeStartElement("c","dPt",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","bubble3D",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.parseChartSeriesColor(e,n,this.chart[Wn[this.keywordIndex]]),e.writeEndElement(),n=[]},e.prototype.serializeChartCategory=function(e,t,i){var n=t[In[this.keywordIndex]],r=n.length;e.writeStartElement("c","f",this.chartNamespace),e.writeString("Sheet1!$A$2:$A$"+(r+1).toString()),e.writeEndElement(),e.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement()),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement();for(var o=0;o<n.length;o++){var s=n[o];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),""!==s[Ai[this.keywordIndex]]&&e.writeString(s[Ai[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeChartValue=function(e,t,i){var n="val";("scatterChart"===i||"bubbleChart"===i)&&(n="yVal"),this.serializeChartYValue(e,n,t),"bubbleChart"===i&&(n="bubbleSize",t="Sheet1!$C$2:$C$",this.serializeChartYValue(e,n,t)),"lineChart"!==i&&"scatterChart"!==i||(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement())},e.prototype.serializeChartYValue=function(e,t,i){var n=this.chart[In[this.keywordIndex]],r=n.length;e.writeStartElement("c",t,this.chartNamespace),e.writeStartElement("c","numRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),e.writeString(i+(r+1).toString()),e.writeEndElement(),e.writeStartElement("c","numCache",this.chartNamespace),e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement(),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement();for(var o=0;o<r;o++)for(var s=n[o],a=0;a<s[Mi[this.keywordIndex]].length;a++)if(a===this.seriesCount){var l=s[Mi[this.keywordIndex]][this.seriesCount];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),"bubbleSize"!==t?e.writeString(l[Ri[this.keywordIndex]].toString()):e.writeString(l[Or[this.keywordIndex]].toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.chartType=function(e){var t=e[Wn[this.keywordIndex]];switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return"Area"!==t&&"Area_Stacked"!==t&&"Area_Stacked_100"!==t||(t="areaChart"),"Bar_Stacked_100"!==t&&"Bar_Stacked"!==t&&"Bar_Clustered"!==t&&"Column_Clustered"!==t&&"Column_Stacked"!==t&&"Column_Stacked_100"!==t||(t="barChart"),"Line"!==t&&"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Stacked"!==t&&"Line_Markers_Stacked_100"!==t&&"Line_Stacked_100"!==t||(t="lineChart"),t},e.prototype.chartGrouping=function(e){var t="standard";return"Bar_Stacked"===e||"Column_Stacked"===e||"Area_Stacked"===e||"Line_Stacked"===e||"Line_Markers_Stacked"===e?t="stacked":"Bar_Stacked_100"===e||"Column_Stacked_100"===e||"Area_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e?t="percentStacked":"Bar_Clustered"!==e&&"Column_Clustered"!==e||(t="clustered"),t},e.prototype.chartLegendPosition=function(e){var t=e[ws[this.keywordIndex]];switch(t){case"Top":t="t";break;case"Bottom":default:t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr"}return t},e.prototype.updatechartId=function(e){var t="";return""===t&&(t=this.addChartRelation(this.documentCharts,e)),t},e.prototype.addChartRelation=function(e,t){var i;return i=this.getNextRelationShipID(),e.add(i,t),i},e.prototype.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.prototype.serializeShapeDrawingGraphics=function(e,t){var i=t[nr[this.keywordIndex]];t[Rn[this.keywordIndex]];this.serializeShapeWrapStyle(e,t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,t[We[this.keywordIndex]]),e.writeAttributeString(void 0,"title",void 0,t[no[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace),e.writeStartElement("wps","wsp",this.wpShapeNamespace),e.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace),e.writeStartElement("a","cxnSpLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeShapeType",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wps","spPr",this.wpShapeNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var n=Math.round(t[zn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,n.toString());var r=Math.round(t[qn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),i===(1==this.keywordIndex?3:"StraightConnector")?e.writeAttributeString(void 0,"prst",void 0,"straightConnector1"):i===(1==this.keywordIndex?2:"RoundedRectangle")?e.writeAttributeString(void 0,"prst",void 0,"roundRect"):"number"!=typeof i?e.writeAttributeString(void 0,"prst",void 0,this.getExportAutoShapeType(this.getAutoShapeTypeEnumValue(i))):e.writeAttributeString(void 0,"prst",void 0,this.getExportAutoShapeType(i)),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),t[Kn[this.keywordIndex]]&&t[Kn[this.keywordIndex]][or[this.keywordIndex]]&&Pa.parseBoolValue(t[Kn[this.keywordIndex]][sr[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[Kn[this.keywordIndex]][or[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement());var o=t[Gn[this.keywordIndex]][Qs[this.keywordIndex]]?t[Gn[this.keywordIndex]][Qs[this.keywordIndex]]*this.emusPerPoint:this.emusPerPoint;if(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,Math.round(o).toString()),!(0,a.isNullOrUndefined)(t[Gn[this.keywordIndex]][Js[this.keywordIndex]])&&t[Gn[this.keywordIndex]][Js[this.keywordIndex]]!==(1==this.keywordIndex?3:"None")&&Pa.parseBoolValue(t[Gn[this.keywordIndex]][Ui[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[Gn[this.keywordIndex]][or[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","headEnd",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","tailEnd",this.aNamespace),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeEndElement(),e.writeEndElement(),i!==(1==this.keywordIndex?1:"Rectangle")&&i!==(1==this.keywordIndex?2:"RoundedRectangle")||(e.writeStartElement("wps","txbx",this.wpShapeNamespace),e.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(e,t[rr[this.keywordIndex]][Go[this.keywordIndex]],!0),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("wps","bodyPr",this.wpShapeNamespace),!(0,a.isNullOrUndefined)(t[rr[this.keywordIndex]])){var s=void 0;if(t[rr[this.keywordIndex]][Mt[this.keywordIndex]]>=0&&(s=Math.round(t[rr[this.keywordIndex]][Mt[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"lIns",void 0,s)),t[rr[this.keywordIndex]][Ut[this.keywordIndex]]>=0&&(s=Math.round(t[rr[this.keywordIndex]][Ut[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"tIns",void 0,s)),t[rr[this.keywordIndex]][At[this.keywordIndex]]>=0&&(s=Math.round(t[rr[this.keywordIndex]][At[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"rIns",void 0,s)),t[rr[this.keywordIndex]][Vt[this.keywordIndex]]>=0&&(s=Math.round(t[rr[this.keywordIndex]][Vt[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"bIns",void 0,s)),t[rr[this.keywordIndex]][ar[this.keywordIndex]]){var l=void 0;l=1==this.keywordIndex?Pa.getTextVerticalAlignment(t[rr[this.keywordIndex]][ar[this.keywordIndex]]).toString().toLowerCase():t[rr[this.keywordIndex]][ar[this.keywordIndex]].toString().toLowerCase(),e.writeAttributeString(void 0,"anchor",void 0,this.getTextVerticalAlignmentProperty(l))}e.writeAttributeString(void 0,"anchorCtr",void 0,"0")}e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getTextVerticalAlignmentProperty=function(e){switch(e){case"top":return"t";case"middle":case"center":return"ctr";case"bottom":return"b";default:return e}},e.prototype.serializeShapeWrapStyle=function(e,t){var i=1==this.keywordIndex?this.getTextWrappingStyle(t[Xn[this.keywordIndex]]):t[Xn[this.keywordIndex]];if("Inline"!==i){var n="wrapNone";if(i&&"InFrontOfText"!==i&&"Behind"!==i&&(n="wrap"+i,"Tight"===i&&(n="wrapSquare")),e.writeStartElement("wp",n,this.wpNamespace),i&&"InFrontOfText"!==i&&"Behind"!==i&&!(0,a.isNullOrUndefined)(t[Zn[this.keywordIndex]])){var r=1==this.keywordIndex?this.getTextWrappingType(t[Zn[this.keywordIndex]]):"Both"===t[Zn[this.keywordIndex]]?"bothSides":t[Zn[this.keywordIndex]].toLowerCase();e.writeAttributeString(void 0,"wrapText",void 0,r)}e.writeEndElement()}},e.prototype.serializeDrawingGraphics=function(e,t){var i,n,r=this.getBase64ImageString(t),o=r.imageString;if(Pa.parseBoolValue(t[pr[this.keywordIndex]])&&".svg"!==(n=Pa.formatClippedString(r.metaFileImageString).extension)&&(o=r.metaFileImageString),i=this.updateShapeId(t,!1),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),(0,a.isNullOrUndefined)(t[Mn[this.keywordIndex]])||e.writeAttributeString(void 0,"descr",void 0,t[Mn[this.keywordIndex]]),e.writeAttributeString(void 0,"name",void 0,(0,a.isNullOrUndefined)(t[We[this.keywordIndex]])?"":t[We[this.keywordIndex]]),(0,a.isNullOrUndefined)(t[no[this.keywordIndex]])||e.writeAttributeString(void 0,"title",void 0,t[no[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(o,"data:image"))e.writeAttributeString("r","embed",this.rNamespace,i);else if(this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,o),e.writeAttributeString(void 0,"link",this.rNamespace,i),!(0,a.isNullOrUndefined)(r.metaFileImageString)&&(this.startsWith(o,"https://")||this.startsWith(o,"http://")||this.startsWith(o,"file://")))){var s=this.getNextRelationShipID();this.documentImages.add(s,r.metaFileImageString),e.writeAttributeString("r","embed",this.rNamespace,s)}if(".svg"===n&&this.serializeBlipExtensions(e,t),e.writeEndElement(),!(0,a.isNullOrUndefined)(t[ur[this.keywordIndex]])&&0!==t[ur[this.keywordIndex]]||!(0,a.isNullOrUndefined)(t[gr[this.keywordIndex]])&&0!==t[gr[this.keywordIndex]]||!(0,a.isNullOrUndefined)(t[fr[this.keywordIndex]])&&0!==t[fr[this.keywordIndex]]||!(0,a.isNullOrUndefined)(t[mr[this.keywordIndex]])&&0!==t[mr[this.keywordIndex]]){e.writeStartElement("a","srcRect",this.aNamespace);var l=Math.round(1e3*t[fr[this.keywordIndex]]);e.writeAttributeString(void 0,"l",void 0,l.toString());var d=Math.round(1e3*t[ur[this.keywordIndex]]);e.writeAttributeString(void 0,"t",void 0,d.toString());var h=Math.round(1e3*t[mr[this.keywordIndex]]);e.writeAttributeString(void 0,"r",void 0,h.toString());var c=Math.round(1e3*t[gr[this.keywordIndex]]);e.writeAttributeString(void 0,"b",void 0,c.toString()),e.writeEndElement()}e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var p=Math.round(t[zn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,p.toString());var u=Math.round(t[qn[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,u.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBlipExtensions=function(e,t){e.writeStartElement("a","extLst",this.aNamespace),e.writeStartElement("a","ext",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),e.writeStartElement("asvg","svgBlip",this.svgNamespace);var i=this.updateShapeId(t,!0);e.writeAttributeString("r","embed",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.updateShapeId=function(e,t){var i="",n=this.paragraph;return this.headerFooter?i=this.updateHFImageRels(this.headerFooter,e,t):""===i&&(n.hasOwnProperty(es[this.keywordIndex])||n.hasOwnProperty(Qr[this.keywordIndex]))&&(i=this.addImageRelation(t?this.svgImages:this.documentImages,e,t)),i},e.prototype.addImageRelation=function(e,t,i){var n="";return(i?this.svgImageRelationIds.keys.indexOf(parseInt(t[lr[this.keywordIndex]])):this.imageRelationIds.keys.indexOf(parseInt(t[lr[this.keywordIndex]])))<0||this.isHeaderFooter?(n=this.getNextRelationShipID(),i?this.svgImageRelationIds.add(parseInt(t[lr[this.keywordIndex]]),n):this.imageRelationIds.add(parseInt(t[lr[this.keywordIndex]]),n)):n=i?this.svgImageRelationIds.get(parseInt(t[lr[this.keywordIndex]])):this.imageRelationIds.get(parseInt(t[lr[this.keywordIndex]])),e.add(n,t),n},e.prototype.updateHFImageRels=function(e,t,i){for(var n="",r="",o=this.headersFooters.keys,s=0;s<o.length;s++)for(var a=this.headersFooters.get(o[s]),d=a.keys,h=0;h<d.length;h++)if(a.get(d[h])===e){r=d[h];var c=void 0;i?this.headerFooterSvgImages.containsKey(r)?(c=this.headerFooterSvgImages.get(r),n=this.addImageRelation(c,t,!0)):(c=new l,n=this.addImageRelation(c,t,!0),this.headerFooterSvgImages.add(r,c)):this.headerFooterImages.containsKey(r)?(c=this.headerFooterImages.get(r),n=this.addImageRelation(c,t,!1)):(c=new l,n=this.addImageRelation(c,t,!1),this.headerFooterImages.add(r,c))}return n},e.prototype.serializeTable=function(e,t){if((0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=0),!(t[Eo[this.keywordIndex]].length<=0)){var i=this.table;this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace);var n=t[Eo[this.keywordIndex]][0][To[this.keywordIndex]];this.serializeTableFormat(e,n,t),this.serializeTableGrid(e,t);var r=new l,o=new l,s=new l,d=t[Eo[this.keywordIndex]];if(d.length>0)for(var h=0;h<d.length;h++){var c=d[h];if(c[Ho[this.keywordIndex]].length>0){if(c.hasOwnProperty($r[this.keywordIndex])){this.serializeContentControl(e,c[$r[this.keywordIndex]],c);continue}var p=this.row;this.row=c,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,c);for(var u=c[Ho[this.keywordIndex]],g=u.length,m=0,f=0;f<g;f++){var v=u[f],y=v[ia[this.keywordIndex]];if(v.hasOwnProperty($r[this.keywordIndex]))this.serializeContentControl(e,v[$r[this.keywordIndex]],v);else{var w=v[So[this.keywordIndex]];if(y-m>0)for(var b=0===f?0:m+1;b<y;b++)if(r.containsKey(b)){var C=this.getMergeCellFormat(w,s.get(b),b<v[ia[this.keywordIndex]]);this.isVerticalMergeCell=!0,this.isBookmarkAtRowEnd=!0,this.serializeTableCell(e,v,C,!1),r.set(b,r.get(b)-1),1===r.get(b)&&(r.remove(b),s.remove(b),o.containsKey(b)&&o.remove(b)),o.containsKey(b)&&(m+=o.get(b)-1,(b+=o.get(b))>0&&b--)}this.isVerticalMergeCell=!1,this.isBookmarkAtRowEnd=!1,m=y,w[ri[this.keywordIndex]]>1&&(r.add(y,w[ri[this.keywordIndex]]),s.add(y,w)),this.serializeTableCell(e,v,w,!0),w[ni[this.keywordIndex]]>1&&w[ri[this.keywordIndex]]>1&&o.add(y,w[ni[this.keywordIndex]]);for(var x=y+1;;x++)if(r.containsKey(x)){var I=this.getMergeCellFormat(w,s.get(x),x<v[ia[this.keywordIndex]]);this.serializeTableCell(e,v,I,!1),r.set(x,r.get(x)-1),m++,1===r.get(x)&&(r.remove(x),s.remove(x),o.containsKey(x)&&o.remove(x)),o.containsKey(x)&&(m+=o.get(x)-1,x+=o.get(x))}else if(!(f===g-1&&x<t[la[this.keywordIndex]]))break}}this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtRowEnd=!1,this.row=p}}e.writeEndElement(),this.table=i}},e.prototype.getMergeCellFormat=function(e,t,i){var n=t;return i?n[Et[this.keywordIndex]][mr[this.keywordIndex]]=e[Et[this.keywordIndex]][fr[this.keywordIndex]]:n[Et[this.keywordIndex]][fr[this.keywordIndex]]=e[Et[this.keywordIndex]][mr[this.keywordIndex]],n},e.prototype.serializeTableCell=function(e,t,i,n){var r=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMargins(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[Et[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,t[So[this.keywordIndex]][wi[this.keywordIndex]]),this.serializeTableCellDirection(e,i),this.serializeCellVerticalAlign(e,i[oi[this.keywordIndex]]),i[ni[this.keywordIndex]]>1){var o=i[ni[this.keywordIndex]];e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()}if(i[ri[this.keywordIndex]]>1&&(e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n?"restart":"continue"),e.writeEndElement()),e.writeEndElement(),t&&t[Go[this.keywordIndex]].length>0)for(var s=0,a=void 0;s<t[Go[this.keywordIndex]].length;)a=t[Go[this.keywordIndex]][s],this.serializeBodyItem(e,a,!1),s+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();this.isBookmarkAtRowEnd&&!this.isVerticalMergeCell||e.writeEndElement(),this.blockOwner=r},e.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t[aa[this.keywordIndex]].length&&this.serializeGridColumns(e,t[aa[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeTableRows=function(e,t){var i=new l;if(t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(r[Ho[this.keywordIndex]].length>0){if(r.hasOwnProperty($r[this.keywordIndex])){this.serializeContentControl(e,r[$r[this.keywordIndex]],r);continue}this.serializeRow(e,r,i)}}},e.prototype.serializeRow=function(e,t,i){var n=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t[Ho[this.keywordIndex]],i),this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtRowEnd=!1,this.row=n},e.prototype.serializeRowFormat=function(e,t){if(this.serializeRowMargins(e,t[To[this.keywordIndex]]),e.writeStartElement(void 0,"trPr",this.wNamespace),t[To[this.keywordIndex]][qn[this.keywordIndex]]>0){e.writeStartElement(void 0,"trHeight",this.wNamespace),t[To[this.keywordIndex]][li[this.keywordIndex]]===(1==this.keywordIndex?1:"Exactly")?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):t[To[this.keywordIndex]][li[this.keywordIndex]]===(1==this.keywordIndex?0:"AtLeast")&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast");var i=this.roundToTwoDecimal(t[To[this.keywordIndex]][qn[this.keywordIndex]]*this.twentiethOfPoint).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}var n=t[To[this.keywordIndex]],r=n[ci[this.keywordIndex]];r>0&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.toString()),e.writeEndElement());var o=n[gi[this.keywordIndex]];if(o>0&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()),r>0){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),n[ui[this.keywordIndex]]){case"Percent":case 1:var s=this.roundToTwoDecimal(n[pi[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","w",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:var l=this.roundToTwoDecimal(n[pi[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","w",this.wNamespace,l),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(o>0){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),n[fi[this.keywordIndex]]){case"Percent":case 1:s=this.roundToTwoDecimal(n[mi[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:l=this.roundToTwoDecimal(n[mi[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,l),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}(0,a.isNullOrUndefined)(n[si[this.keywordIndex]])||Pa.parseBoolValue(n[si[this.keywordIndex]])||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),Pa.parseBoolValue(n[ai[this.keywordIndex]])&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),!(0,a.isNullOrUndefined)(n[dt[this.keywordIndex]])&&n[dt[this.keywordIndex]].length>0&&(this.serializeRevisionStart(e,n,void 0),this.serializeRevisionEnd(e,n,void 0)),e.writeEndElement()},e.prototype.serializeCells=function(e,t,i){for(var n=0;n<t.length;n++)t[n].hasOwnProperty($r[this.keywordIndex])?this.serializeContentControl(e,t[n][$r[this.keywordIndex]],t[n]):this.serializeCell(e,t[n],i)},e.prototype.serializeCell=function(e,t,i){var n=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(e,t[So[this.keywordIndex]],!0,!0,i),t[Go[this.keywordIndex]].length>0)for(var r=0,o=void 0;r<t[Go[this.keywordIndex]].length;)o=t[Go[this.keywordIndex]][r],this.serializeBodyItem(e,o,!1),r+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();this.isBookmarkAtRowEnd||e.writeEndElement();var s=1;if(i.containsKey(t[ia[this.keywordIndex]]+t[So[this.keywordIndex]][ni[this.keywordIndex]]-1+s)&&1===this.row[Ho[this.keywordIndex]].length)for(var a=i.keys[i.keys.length-1];s<=a;)s=this.createCellForMerge(e,t,i,s),s++;else this.createCellForMerge(e,t,i,s);this.blockOwner=n},e.prototype.createCellForMerge=function(e,t,i,n){for(;i.containsKey(t[ia[this.keywordIndex]]+t[So[this.keywordIndex]][ni[this.keywordIndex]]-1+n)&&(this.row[Ho[this.keywordIndex]].indexOf(t)===this.row[Ho[this.keywordIndex]].length-1||this.row[Ho[this.keywordIndex]].indexOf(t)===t[ia[this.keywordIndex]])&&void 0===t.nextNode;){var r=t[ia[this.keywordIndex]]+t[So[this.keywordIndex]][ni[this.keywordIndex]]-1+n;e.writeStartElement(void 0,"tc",this.wNamespace);var o=!0;(0,a.isNullOrUndefined)(this.spanCellFormat)?(e.writeStartElement(void 0,"tcPr",this.wNamespace),o=!1):(o=!1,i=this.serializeCellFormat(e,this.spanCellFormat,!1,o,i)),this.serializeColumnSpan(r,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),(0,a.isNullOrUndefined)(this.spanCellFormat)&&(e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[So[this.keywordIndex]][Et[this.keywordIndex]],8,!1),e.writeEndElement()),o||e.writeEndElement(),i=this.checkMergeCell(r,i),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),n++}return n},e.prototype.serializeCellFormat=function(e,t,i,n,r){var o=this.blockOwner;this.table[Lo[this.keywordIndex]],this.row[To[this.keywordIndex]];return e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,t),this.serializeCellMargins(e,t),i&&(r=this.serializeCellMerge(e,t,r),this.serializeGridSpan(e,o)),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[Et[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,o[So[this.keywordIndex]][wi[this.keywordIndex]]),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t[oi[this.keywordIndex]]),n&&e.writeEndElement(),r},e.prototype.serializeCellWidth=function(e,t){e.writeStartElement(void 0,"tcW",this.wNamespace),t[xi[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Ci[this.keywordIndex]]*this.percentageFactor).toString())):t[xi[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")):(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Ci[this.keywordIndex]]*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")),e.writeEndElement()},e.prototype.serializeCellMerge=function(e,t,i){var n,r=this.blockOwner,o=!1,s=r[ia[this.keywordIndex]],a=this.row[Ho[this.keywordIndex]].indexOf(r),l=a>0?this.row[Ho[this.keywordIndex]][a-1][ia[this.keywordIndex]]:r[ia[this.keywordIndex]];if(r[ia[this.keywordIndex]]===a?(n=r[ia[this.keywordIndex]],o=!0):o=!1,!o){0===a&&(s=r[ia[this.keywordIndex]],l=-1);for(var d=l;d<s;d++)n=l+1,l+=1,0===n&&i.containsKey(n)&&(i=this.createMerge(e,n,r,i))}return t[ri[this.keywordIndex]]>1?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(n,t[ri[this.keywordIndex]]-1),t[ni[this.keywordIndex]]>1&&this.mGridSpans.add(n,t[ni[this.keywordIndex]]),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):i.containsKey(n)&&o&&(i=this.createMerge(e,n,r,i)),i},e.prototype.createMerge=function(e,t,i,n){return this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[So[this.keywordIndex]][Et[this.keywordIndex]],8,!1),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i[So[this.keywordIndex]]),n=this.checkMergeCell(t,n)},e.prototype.serializeColumnSpan=function(e,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},e.prototype.checkMergeCell=function(e,t){return t.get(e)-1==0?(t.remove(e),this.spanCellFormat=void 0,this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):t.set(e,t.get(e)-1),t},e.prototype.serializeGridSpan=function(e,t){if(t[So[this.keywordIndex]][ni[this.keywordIndex]]>1){var i=t[So[this.keywordIndex]][ni[this.keywordIndex]];e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.toString()),e.writeEndElement()}},e.prototype.serializeTableCellDirection=function(e,t){},e.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":case 2:e.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:e.writeAttributeString("w","val",this.wNamespace,"top")}e.writeEndElement()},e.prototype.serializeGridColumns=function(e,t){for(var i=0,n=t.length;i<n;i++){var r=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeEndElement()}},e.prototype.serializeTableFormat=function(e,t,i){e.writeStartElement(void 0,"tblPr",this.wNamespace),(0,a.isNullOrUndefined)(i[Lo[this.keywordIndex]][Je[this.keywordIndex]])||(e.writeStartElement(void 0,"tblStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[Lo[this.keywordIndex]][Je[this.keywordIndex]]),e.writeEndElement()),this.serializeTablePositioning(e,i),this.serializeTableWidth(e,i),this.serializeTableAlignment(e,i[Lo[this.keywordIndex]]),this.serializeCellSpacing(e,i[Lo[this.keywordIndex]]),this.serializeTableIndentation(e,i[Lo[this.keywordIndex]]),this.serializeTableMargins(e,i[Lo[this.keywordIndex]]),this.serializeTableBorders(e,i[Lo[this.keywordIndex]]),this.serializeShading(e,i[Lo[this.keywordIndex]][wi[this.keywordIndex]]),Pa.parseBoolValue(i[Lo[this.keywordIndex]][Ye[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidiVisual",this.wNamespace),e.writeEndElement()),this.serializeTblLayout(e,i[Lo[this.keywordIndex]]),(0,a.isNullOrUndefined)(i)||e.writeEndElement()},e.prototype.serializeTablePositioning=function(e,t){if(Pa.parseBoolValue(t[Wo[this.keywordIndex]])){if(e.writeStartElement("w","tblpPr",this.wNamespace),t[Bo[this.keywordIndex]][Ao[this.keywordIndex]]>0){var i=Math.round(t[Bo[this.keywordIndex]][Ao[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","leftFromText",this.wNamespace,i)}if(t[Bo[this.keywordIndex]][Mo[this.keywordIndex]]>0){var n=Math.round(t[Bo[this.keywordIndex]][Mo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","rightFromText",this.wNamespace,n)}if(t[Bo[this.keywordIndex]][Ro[this.keywordIndex]]>0){var r=Math.round(t[Bo[this.keywordIndex]][Ro[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","topFromText",this.wNamespace,r)}if(t[Bo[this.keywordIndex]][Uo[this.keywordIndex]]>0){var o=Math.round(t[Bo[this.keywordIndex]][Uo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","bottomFromText",this.wNamespace,o)}if(!(0,a.isNullOrUndefined)(t[Bo[this.keywordIndex]][Vo[this.keywordIndex]])){var s=t[Bo[this.keywordIndex]][Vo[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")?"text":1==this.keywordIndex?this.getTableVerticalRelation(t[Bo[this.keywordIndex]][Vo[this.keywordIndex]]).toLowerCase():this.getTableVerticalRelation(this.getTableVerticalRelationEnumValue(t[Bo[this.keywordIndex]][Vo[this.keywordIndex]])).toLowerCase();e.writeAttributeString("w","vertAnchor",this.wNamespace,s)}if(!(0,a.isNullOrUndefined)(t[Bo[this.keywordIndex]][qo[this.keywordIndex]])&&t[Bo[this.keywordIndex]][qo[this.keywordIndex]]!==(1==this.keywordIndex?0:"Column")){var l=1==this.keywordIndex?this.getTableHorizontalRelation(t[Bo[this.keywordIndex]][qo[this.keywordIndex]]).toLowerCase():t[Bo[this.keywordIndex]][qo[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","horzAnchor",this.wNamespace,l)}if(!(0,a.isNullOrUndefined)(t[Bo[this.keywordIndex]][_o[this.keywordIndex]])&&t[Bo[this.keywordIndex]][_o[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")){var d=1==this.keywordIndex?this.getTableHorizontalAlignment(t[Bo[this.keywordIndex]][_o[this.keywordIndex]]):t[Bo[this.keywordIndex]][_o[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","tblpXSpec",this.wNamespace,d)}if(!(0,a.isNullOrUndefined)(t[Bo[this.keywordIndex]][oi[this.keywordIndex]])&&t[Bo[this.keywordIndex]][oi[this.keywordIndex]]!==(1==this.keywordIndex?0:"None")){var h=1==this.keywordIndex?this.getTableVerticalAlignment(t[Bo[this.keywordIndex]][oi[this.keywordIndex]]):t[Bo[this.keywordIndex]][oi[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","tblpYSpec",this.wNamespace,h)}if((!(0,a.isNullOrUndefined)(t[Bo[this.keywordIndex]][_o[this.keywordIndex]])&&t[Bo[this.keywordIndex]][_o[this.keywordIndex]]===(1==this.keywordIndex?0:"Left")||!t[Bo[this.keywordIndex]][_o[this.keywordIndex]])&&t[Bo[this.keywordIndex]][jo[this.keywordIndex]]>0){var c=Math.round(t[Bo[this.keywordIndex]][jo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpX",this.wNamespace,c)}if(!(0,a.isNullOrUndefined)(t[Bo[this.keywordIndex]][oi[this.keywordIndex]])&&t[Bo[this.keywordIndex]][oi[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){var p=Math.round(t[Bo[this.keywordIndex]][zo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpY",this.wNamespace,p)}e.writeEndElement(),Pa.parseBoolValue(t[Bo[this.keywordIndex]][Do[this.keywordIndex]])||(e.writeStartElement("w","tblOverlap",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"never"),e.writeEndElement())}(0,a.isNullOrUndefined)(t[No[this.keywordIndex]])||(e.writeStartElement("w","tblDescription",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[No[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(t[no[this.keywordIndex]])||(e.writeStartElement("w","tblCaption",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[no[this.keywordIndex]]),e.writeEndElement())},e.prototype.serializeTableMargins=function(e,t){this.serializeMargins(e,t,"tblCellMar")},e.prototype.serializeRowMargins=function(e,t){e.writeStartElement(void 0,"tblPrEx",this.wNamespace),e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[Et[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeMargins(e,t,"tblCellMar"),e.writeEndElement()},e.prototype.serializeCellMargins=function(e,t){this.serializeMargins(e,t,"tcMar")},e.prototype.serializeMargins=function(e,t,i){if(void 0!==t[Ut[this.keywordIndex]]||void 0!==t[Mt[this.keywordIndex]]||void 0!==t[Vt[this.keywordIndex]]||void 0!==t[At[this.keywordIndex]]){if(e.writeStartElement(void 0,i,this.wNamespace),!(0,a.isNullOrUndefined)(t[Ut[this.keywordIndex]])){var n=Math.round(20*t[Ut[this.keywordIndex]]);e.writeStartElement(void 0,"top",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!(0,a.isNullOrUndefined)(t[Mt[this.keywordIndex]])){var r=Math.round(20*t[Mt[this.keywordIndex]]);e.writeStartElement(void 0,"left",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!(0,a.isNullOrUndefined)(t[Vt[this.keywordIndex]])){var o=Math.round(20*t[Vt[this.keywordIndex]]);e.writeStartElement(void 0,"bottom",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,o.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!(0,a.isNullOrUndefined)(t[At[this.keywordIndex]])){var s=Math.round(20*t[At[this.keywordIndex]]);e.writeStartElement(void 0,"right",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,s.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}e.writeEndElement()}},e.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),t[Fi[this.keywordIndex]]&&"empty"!==t[Fi[this.keywordIndex]]?e.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t[Fi[this.keywordIndex]])):e.writeAttributeString(void 0,"fill",this.wNamespace,"auto"),"empty"===t[Pi[this.keywordIndex]]||(0,a.isNullOrUndefined)(t[Pi[this.keywordIndex]])?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[Pi[this.keywordIndex]])),(0,a.isNullOrUndefined)(t[ki[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t[ki[this.keywordIndex]])),e.writeEndElement()},e.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":case 1:case 2:case 3:return"pct5";case"Texture10Percent":case 4:return"pct10";case"Texture12Pt5Percent":case 5:return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":case 6:case 7:return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":case 8:case 9:return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":case 10:case 11:return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":case 12:case 13:return"pct30";case"Texture35Percent":case 14:return"pct35";case"Texture37Pt5Percent":case 15:return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":case 16:case 17:return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":case 18:case 19:return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":case 20:case 21:return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":case 22:case 23:return"pct55";case"Texture60Percent":case 24:return"pct60";case"Texture62Pt5Percent":case 25:return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":case 26:case 27:return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":case 28:case 29:return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":case 30:case 31:return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":case 32:case 33:return"pct80";case"Texture85Percent":case 34:return"pct85";case"Texture87Pt5Percent":case 35:return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":case 36:case 37:return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":case 38:case 39:return"pct95";case 40:case"TextureSolid":return"solid";case"TextureCross":case 51:return"thinHorzCross";case"TextureDarkCross":case 45:return"horzCross";case"TextureDarkDiagonalCross":case 46:return"diagCross";case"TextureDarkDiagonalDown":case 43:return"reverseDiagStripe";case"TextureDarkDiagonalUp":case 44:return"diagStripe";case"TextureDarkHorizontal":case 41:return"horzStripe";case"TextureDarkVertical":case 42:return"vertStripe";case"TextureDiagonalCross":case 52:return"thinDiagCross";case"TextureDiagonalDown":case 49:return"thinReverseDiagStripe";case"TextureDiagonalUp":case 50:return"thinDiagStripe";case"TextureHorizontal":case 47:return"thinHorzStripe";case"TextureVertical":case 48:return"thinVertStripe";default:return"clear"}},e.prototype.serializeParagraphBorders=function(e,t){var i=t[Et[this.keywordIndex]];(0,a.isNullOrUndefined)(i)||(e.writeStartElement(void 0,"pBdr",this.wNamespace),this.serializeBorders(e,t[Et[this.keywordIndex]],8,!0),e.writeEndElement())},e.prototype.serializeTableBorders=function(e,t){var i=t[Et[this.keywordIndex]];(0,a.isNullOrUndefined)(i)||(e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[Et[this.keywordIndex]],8,!1),e.writeEndElement())},e.prototype.serializeBorders=function(e,t,i,n){this.serializeBorder(e,t[ur[this.keywordIndex]],"top",i),this.serializeBorder(e,t[fr[this.keywordIndex]],"left",i),this.serializeBorder(e,t[gr[this.keywordIndex]],"bottom",i),this.serializeBorder(e,t[mr[this.keywordIndex]],"right",i),n?(this.serializeBorder(e,t[Ei[this.keywordIndex]],"between",i),this.serializeBorder(e,t[Hi[this.keywordIndex]],"bar",i)):(this.serializeBorder(e,t[Ei[this.keywordIndex]],"insideH",i),this.serializeBorder(e,t[Hi[this.keywordIndex]],"insideV",i),this.serializeBorder(e,t[Wi[this.keywordIndex]],"tl2br",i),this.serializeBorder(e,t[Ni[this.keywordIndex]],"tr2bl",i))},e.prototype.serializeTblLayout=function(e,t){(!Pa.parseBoolValue(t[vi[this.keywordIndex]])||t[Ci[this.keywordIndex]]>this.containerWidth)&&(e.writeStartElement(void 0,"tblLayout",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),e.writeEndElement())},e.prototype.serializeBorder=function(e,t,i,n){var r=t[Oi[this.keywordIndex]],o=(t[Bi[this.keywordIndex]]?t[Bi[this.keywordIndex]]:0)*n,s=t[Hs[this.keywordIndex]]?t[Hs[this.keywordIndex]]:0;if(r===(1==this.keywordIndex?26:"Cleared"))return e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),void e.writeEndElement();(r===(1==this.keywordIndex?1:"None")||(0,a.isNullOrUndefined)(r))&&!Pa.parseBoolValue(t[Ti[this.keywordIndex]])||o<0&&!Pa.parseBoolValue(t[Ti[this.keywordIndex]])||(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(r)),t[or[this.keywordIndex]]&&e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[or[this.keywordIndex]])),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(o).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,s.toString()),Pa.parseBoolValue(t[Si[this.keywordIndex]])&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},e.prototype.getBorderStyle=function(e){switch(e){case"Cleared":case 26:return"cleared";case"None":case 1:return"none";case"DashSmallGap":case 3:return"dashSmallGap";case"Triple":case 8:return"triple";case"Dot":case 2:return"dotted";case"DashDot":case 5:return"dotDash";case"DashLargeGap":case 4:return"dashed";case"DashDotDot":case 6:return"dotDotDash";case"Double":case 7:return"double";case"ThinThickSmallGap":case 9:return"thinThickSmallGap";case"ThickThinSmallGap":case 10:return"thickThinSmallGap";case"ThinThickThinSmallGap":case 11:return"thinThickThinSmallGap";case"ThickThinMediumGap":case 12:return"thickThinMediumGap";case"ThinThickMediumGap":case 13:return"thinThickMediumGap";case"ThinThickThinMediumGap":case 14:return"thinThickThinMediumGap";case"ThickThinLargeGap":case 16:return"thickThinLargeGap";case"ThinThickLargeGap":case 15:return"thinThickLargeGap";case"ThinThickThinLargeGap":case 17:return"thinThickThinLargeGap";case"Thick":case 25:return"thick";case"SingleWavy":case 18:return"wave";case"DoubleWavy":case 19:return"doubleWave";case"DashDotStroked":case 20:return"dashDotStroked";case"Engrave3D":case 22:return"threeDEngrave";case"Emboss3D":case 21:return"threeDEmboss";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";default:return"single"}},e.prototype.serializeTableIndentation=function(e,t){if(!(0,a.isNullOrUndefined)(t[gt[this.keywordIndex]])){e.writeStartElement(void 0,"tblInd",this.wNamespace);var i=Math.round(t[gt[this.keywordIndex]]*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}},e.prototype.serializeCellSpacing=function(e,t){!(0,a.isNullOrUndefined)(t[yi[this.keywordIndex]])&&t[yi[this.keywordIndex]]>0&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[yi[this.keywordIndex]]/2*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},e.prototype.serializeTableWidth=function(e,t){if(e.writeStartElement(void 0,"tblW",this.wNamespace),t[Lo[this.keywordIndex]][xi[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")){var i=Math.round(t[Lo[this.keywordIndex]][Ci[this.keywordIndex]]*this.percentageFactor);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct")}else if(t[Lo[this.keywordIndex]][xi[this.keywordIndex]]===(1==this.keywordIndex?2:"Point")){i=Math.round(t[Lo[this.keywordIndex]][Ci[this.keywordIndex]]*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto");e.writeEndElement()},e.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t[bi[this.keywordIndex]]){case"Right":case 2:e.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},e.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),e.writeStartElement(void 0,"fldChar",this.wNamespace);var i=0===t[Cr[this.keywordIndex]]?"begin":1===t[Cr[this.keywordIndex]]?"end":"separate";if(e.writeAttributeString(void 0,"fldCharType",this.wNamespace,i),"begin"===i&&!(0,a.isNullOrUndefined)(t[br[this.keywordIndex]])){var n=t[br[this.keywordIndex]];if(e.writeStartElement(void 0,"ffData",this.wNamespace),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[We[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"enabled",this.wNamespace),e.writeEndElement(),n.hasOwnProperty(Pr[this.keywordIndex])){e.writeStartElement(void 0,"textInput",this.wNamespace);var r=1==this.keywordIndex?this.getTextFormFieldType(n[Pr[this.keywordIndex]][Ms[this.keywordIndex]]):n[Pr[this.keywordIndex]][Ms[this.keywordIndex]].toString();e.writeStartElement(void 0,"type",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"Calculation"==r?"calculated":r.toLowerCase()),e.writeEndElement(),e.writeStartElement(void 0,"default",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Pr[this.keywordIndex]][Er[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"format",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex&&"Text"===r?this.getTextFormFieldFormat(n[Pr[this.keywordIndex]][Nr[this.keywordIndex]]):n[Pr[this.keywordIndex]][Nr[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}else if(n.hasOwnProperty(Sr[this.keywordIndex]))e.writeStartElement(void 0,"checkBox",this.wNamespace),n[Sr[this.keywordIndex]][Wr[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeStartElement(void 0,"sizeAuto",this.wNamespace),e.writeEndElement()):(e.writeStartElement(void 0,"size",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*n[Sr[this.keywordIndex]][Or[this.keywordIndex]]).toString()),e.writeEndElement()),e.writeStartElement(void 0,"defalut",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Sr[this.keywordIndex]][Er[this.keywordIndex]]?"1":"0"),e.writeEndElement(),n[Sr[this.keywordIndex]][Br[this.keywordIndex]]&&(e.writeStartElement(void 0,"checked",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Sr[this.keywordIndex]][Br[this.keywordIndex]]?"1":"0"),e.writeEndElement()),e.writeEndElement();else{e.writeStartElement(void 0,"ddList",this.wNamespace),0!==n[Tr[this.keywordIndex]][Dr[this.keywordIndex]]&&(e.writeStartElement(void 0,"result",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Tr[this.keywordIndex]][Dr[this.keywordIndex]].toString()),e.writeEndElement());for(var o=0;o<n[Tr[this.keywordIndex]][Lr[this.keywordIndex]].length;o++)e.writeStartElement(void 0,"listEntry",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[Tr[this.keywordIndex]][Lr[this.keywordIndex]][o].toString()),e.writeEndElement();e.writeEndElement()}e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),0===t[Cr[this.keywordIndex]]&&"FieldFormTextInput"===t[Cr[this.keywordIndex]]&&(e.writeStartElement("w","r",this.wNamespace),e.writeStartElement(void 0,"instrText",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString("FORMTEXT"),e.writeEndElement(),e.writeEndElement())},e.prototype.serializeTextRange=function(e,t,i,n){if(e.writeStartElement("w","r",this.wNamespace),(0,a.isNullOrUndefined)(t[ie[this.keywordIndex]])||this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),"\t"===t[Dn[this.keywordIndex]])e.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===t[Dn[this.keywordIndex]])e.writeElementString(void 0,"br",this.wNamespace,void 0);else if((0,a.isNullOrUndefined)(t[$e[this.keywordIndex]]))if("\f"===t[Dn[this.keywordIndex]])e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page"),e.writeEndElement();else if("\r"===t[Dn[this.keywordIndex]])e.writeStartElement("w","cr",this.wNamespace),e.writeEndElement();else if(t[Dn[this.keywordIndex]]===String.fromCharCode(14))e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"column"),e.writeEndElement();else if("%02"===encodeURI(t[Dn[this.keywordIndex]]))e.writeStartElement(void 0,"footnoteRef",this.wNamespace),e.writeEndElement();else if("%02"===encodeURI(t[Dn[this.keywordIndex]])&&"endnote"===n)e.writeStartElement(void 0,"endnoteRef",this.wNamespace),e.writeEndElement();else if("%03"===encodeURI(t[Dn[this.keywordIndex]]))e.writeStartElement(void 0,"separator",this.wNamespace),e.writeEndElement();else if("%04"===encodeURI(t[Dn[this.keywordIndex]]))e.writeStartElement(void 0,"continuationSeparator",this.wNamespace),e.writeEndElement();else{var r=this.retrieveDeleteRevision(t),o=!(0,a.isNullOrUndefined)(i)&&i.hasOwnProperty(Cr[this.keywordIndex])&&2!==i[Cr[this.keywordIndex]]?r?"delInstrText":"instrText":r?"delText":"t";e.writeStartElement(void 0,o,this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(t[Dn[this.keywordIndex]]),e.writeEndElement()}else e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"textWrapping"),e.writeAttributeString("w","clear",this.wNamespace,this.getBreakClearType(t[$e[this.keywordIndex]]).toString().toLowerCase()),e.writeEndElement();e.writeEndElement()},e.prototype.retrieveDeleteRevision=function(e){if(e.hasOwnProperty(dt[this.keywordIndex])&&e[dt[this.keywordIndex]].length>0)for(var t=0;t<e[dt[this.keywordIndex]].length;t++)if("Deletion"===this.retrieveRevision(e[dt[this.keywordIndex]][t]).revisionType)return!0;return!1},e.prototype.serializeParagraphFormat=function(e,t,i,n){(0,a.isNullOrUndefined)(t)||((0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=n),this.serializeParagraphBorders(e,t),(0,a.isNullOrUndefined)(t[Je[this.keywordIndex]])||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Je[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(i)?this.serializeListFormat(e,t[kt[this.keywordIndex]]):this.serializeListFormat(e,i[ne[this.keywordIndex]][kt[this.keywordIndex]]),Pa.parseBoolValue(t[Ye[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Ft[this.keywordIndex]])||(e.writeStartElement(void 0,"keepNext",this.wNamespace),Pa.parseBoolValue(t[Ft[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),(0,a.isNullOrUndefined)(t[St[this.keywordIndex]])||(e.writeStartElement(void 0,"keepLines",this.wNamespace),Pa.parseBoolValue(t[St[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Tt[this.keywordIndex]])||(e.writeStartElement(void 0,"outlineLvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t[Tt[this.keywordIndex]]).toString()),e.writeEndElement()),this.serializeParagraphSpacing(e,t),(0,a.isNullOrUndefined)(t[Ht[this.keywordIndex]])||(e.writeStartElement("w","contextualSpacing",this.wNamespace),Pa.parseBoolValue(t[Ht[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Pt[this.keywordIndex]])||(e.writeStartElement("w","widowControl",this.wNamespace),Pa.parseBoolValue(t[Pt[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"1"):e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),this.serializeIndentation(e,t),this.serializeParagraphAlignment(e,t[vt[this.keywordIndex]],Pa.parseBoolValue(t[Ye[this.keywordIndex]])),!(0,a.isNullOrUndefined)(t[Nt[this.keywordIndex]])&&t[Nt[this.keywordIndex]].length>0&&this.serializeTabs(e,t[Nt[this.keywordIndex]]))},e.prototype.getOutlineLevelValue=function(e){if(1==this.keywordIndex){if(e>0)return e-1}else if(-1!==e.toString().indexOf("Level")){var t=parseInt(e.toString().substring(5),10);if(t>0)return t-1}return 9},e.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},e.prototype.serializeTab=function(e,t){var i=0;e.writeStartElement("w","tab",this.wNamespace),0===t[ws[this.keywordIndex]]&&0!==t[bs[this.keywordIndex]]?(i=t[bs[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(i=t[ws[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t[ys[this.keywordIndex]]))),(0,a.isNullOrUndefined)(t[xs[this.keywordIndex]])||t[xs[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t[xs[this.keywordIndex]])),isNaN(i)||e.writeAttributeString("w","pos",this.wNamespace,i.toString()+""),e.writeEndElement()},e.prototype.getTextWrappingType=function(e){switch(e){case 0:default:return"bothSides";case 1:return"left";case 2:return"right";case 3:return"largest"}},e.prototype.getTextWrappingStyle=function(e){switch(e){case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return"Inline"}},e.prototype.getDateStorageFormat=function(e){switch(e){case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return"DateStorageDate"}},e.prototype.getDateCalendarType=function(e){switch(e){case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return"Gregorian"}},e.prototype.getContentControlAppearance=function(e){switch(e){case 2:return"Hidden";case 3:return"Tags";default:return"BoundingBox"}},e.prototype.getTextFormFieldFormat=function(e){switch(e){case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return"None"}},e.prototype.getTextFormFieldType=function(e){switch(e){case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return"Text"}},e.prototype.getTabLeader=function(e){switch(e){case"Dot":case 2:return"dot";case"Hyphen":case 3:return"hyphen";case"Underscore":case 4:return"underscore";default:return"none"}},e.prototype.getTabJustification=function(e){switch(e){case"Bar":case 0:case"Left":return"left";case 1:return"bar";case"Center":case 2:return"center";case"Decimal":case 3:return"decimal";case"List":case 4:return"num";case"Right":case 5:return"right";default:return"clear"}},e.prototype.getTableVerticalAlignment=function(e){switch(e){case 1:return"top";case 2:return"center";case 3:return"bottom";case 4:return"inside";case 5:return"outside";default:return"none"}},e.prototype.getTableHorizontalAlignment=function(e){switch(e){case 1:return"center";case 2:return"inside";case 3:return"outside";case 4:return"right";default:return"left"}},e.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":default:return 0;case"Margin":return 1;case"Page":return 2}},e.prototype.getTableVerticalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Paragraph"}},e.prototype.getTableHorizontalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Column"}},e.prototype.getVerticalOrigin=function(e){switch(e){case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return"Paragraph"}},e.prototype.getHorizontalOrigin=function(e){switch(e){case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return"Column"}},e.prototype.getShapeVerticalAlignment=function(e){switch(e){case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return"None"}},e.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return"None"}},e.prototype.getBiDirectionalOverride=function(e){switch(e){case 1:return"LTR";case 2:return"RTL";default:return"None"}},e.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},e.prototype.serializeListFormat=function(e,t){if(!(0,a.isNullOrUndefined)(t[ht[this.keywordIndex]])||!(0,a.isNullOrUndefined)(t[ut[this.keywordIndex]])){if(e.writeStartElement(void 0,"numPr",this.wNamespace),(0,a.isNullOrUndefined)(t[ut[this.keywordIndex]])||-1===t[ut[this.keywordIndex]]||(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[ut[this.keywordIndex]].toString()),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[ht[this.keywordIndex]])){e.writeStartElement(void 0,"numId",this.wNamespace);var i=(t[ht[this.keywordIndex]]+1).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}e.writeEndElement()}},e.prototype.serializeParagraphAlignment=function(e,t,i){if(!(0,a.isNullOrUndefined)(t)){e.writeStartElement(void 0,"jc",this.wNamespace);var n=void 0;switch(t){case"Center":case 1:n="center";break;case"Right":case 2:n="right";break;case"Justify":case 3:n="both";break;default:n="left"}e.writeAttributeString("w","val",this.wNamespace,n),e.writeEndElement()}},e.prototype.serializeParagraphSpacing=function(e,t){if(e.writeStartElement(void 0,"spacing",this.wNamespace),(0,a.isNullOrUndefined)(t[wt[this.keywordIndex]])||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t[wt[this.keywordIndex]]*this.twentiethOfPoint).toString()),!(0,a.isNullOrUndefined)(t[Ct[this.keywordIndex]])){var i=1==this.keywordIndex?t[Ct[this.keywordIndex]].toString():t[Ct[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"beforeAutospacing",this.wNamespace,i)}if((0,a.isNullOrUndefined)(t[yt[this.keywordIndex]])||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t[yt[this.keywordIndex]]*this.twentiethOfPoint).toString()),!(0,a.isNullOrUndefined)(t[bt[this.keywordIndex]])){i=1==this.keywordIndex?t[bt[this.keywordIndex]].toString():t[bt[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"afterAutospacing",this.wNamespace,i)}if(!(0,a.isNullOrUndefined)(t[xt[this.keywordIndex]])){var n=t[It[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")||t[It[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")?this.roundToTwoDecimal(t[xt[this.keywordIndex]]*this.twentiethOfPoint):this.roundToTwoDecimal(240*t[xt[this.keywordIndex]]);e.writeAttributeString(void 0,"line",this.wNamespace,n.toString())}if(!(0,a.isNullOrUndefined)(t[It[this.keywordIndex]])){var r="auto";t[It[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")?r="atLeast":t[It[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")&&(r="exact"),e.writeAttributeString(void 0,"lineRule",this.wNamespace,r)}e.writeEndElement()},e.prototype.serializeIndentation=function(e,t){e.writeStartElement(void 0,"ind",this.wNamespace),(0,a.isNullOrUndefined)(t[gt[this.keywordIndex]])||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t[gt[this.keywordIndex]]*this.twipsInOnePoint).toString()),(0,a.isNullOrUndefined)(t[mt[this.keywordIndex]])||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t[mt[this.keywordIndex]]*this.twipsInOnePoint).toString()),(0,a.isNullOrUndefined)(t[ft[this.keywordIndex]])||(t[ft[this.keywordIndex]]<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t[ft[this.keywordIndex]]*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t[ft[this.keywordIndex]]*this.twipsInOnePoint).toString())),e.writeEndElement()},e.prototype.serializeCustomXMLMapping=function(e,t){if(e.length>0)for(var i=e.keys,n=0;n<i.length;n++){var r=new np.XmlWriter;r.writeStartElement(void 0,"Relationships",this.rpNamespace);var o=this.mCustomXML.get(i[n]),s=i[n],a=this.getNextRelationShipID(),l=n+1,d=this.createXMLItem(o,a,l),h=this.createXMLItemProps(s,l);this.serializeRelationShip(t,a,this.customXmlRelType,"../"+d),this.customXMLRelation(r,l,h),r.writeEndElement();var c=new Fa.ZipArchiveItem(r.buffer,this.customXMLRelPath+l+".xml.rels");this.mArchive.addItem(c)}},e.prototype.customXMLRelation=function(e,t,i){this.serializeRelationShip(e,"rId1",this.wordMLCustomXmlPropsRelType,i)},e.prototype.createXMLItem=function(e,t,i){var n=new Blob([e],{type:"text/plain"}),r=this.customXMLItemsPath+i+".xml",o=new Fa.ZipArchiveItem(n,r);return this.mArchive.addItem(o),r},e.prototype.createXMLItemProps=function(e,t){var i=new np.XmlWriter,n=this.customXMLItemsPropspath+t+".xml",r=this.itemPropsPath+t+".xml";i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,e),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(n);var o=new Fa.ZipArchiveItem(i.buffer,n);return this.mArchive.addItem(o),r},e.prototype.serializeStyles=function(){var e=new np.XmlWriter;e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.stylePath);this.mArchive.addItem(t)},e.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),(0,a.isNullOrUndefined)(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDocumentStyles=function(e){for(var t=0;t<this.mStyles.length;t++){var i=this.mStyles[t];e.writeStartElement(void 0,"style",this.wNamespace);var n=this.getStyleType(i[Ms[this.keywordIndex]]);e.writeAttributeString("w","type",this.wNamespace,n),e.writeAttributeString("w","styleId",this.wNamespace,i[We[this.keywordIndex]]),e.writeStartElement(void 0,"name",this.wNamespace);-1!=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"].indexOf(i[We[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,i[We[this.keywordIndex]].toLowerCase()):e.writeAttributeString("w","val",this.wNamespace,i[We[this.keywordIndex]]),e.writeEndElement(),(0,a.isNullOrUndefined)(i[Oe[this.keywordIndex]])||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[Oe[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(i[Be[this.keywordIndex]])||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[Be[this.keywordIndex]]),e.writeEndElement()),(0,a.isNullOrUndefined)(i[Le[this.keywordIndex]])||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[Le[this.keywordIndex]]),e.writeEndElement()),i[Ms[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,i[ne[this.keywordIndex]],void 0),e.writeEndElement()),i[Ms[this.keywordIndex]]!==(1==this.keywordIndex?2:"Table")&&this.serializeCharacterFormat(e,i[ie[this.keywordIndex]]),e.writeEndElement()}},e.prototype.serializeCharacterFormat=function(e,t){if((0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=0),e.writeStartElement(void 0,"rPr",this.wNamespace),(0,a.isNullOrUndefined)(t[Je[this.keywordIndex]])||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Je[this.keywordIndex]]),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[Ze[this.keywordIndex]])||!(0,a.isNullOrUndefined)(t[tt[this.keywordIndex]])||!(0,a.isNullOrUndefined)(t[at[this.keywordIndex]])){if(e.writeStartElement(void 0,"rFonts",this.wNamespace),!(0,a.isNullOrUndefined)(t[st[this.keywordIndex]])){var i=Pa.isThemeFont(t[st[this.keywordIndex]])?"asciiTheme":"ascii";e.writeAttributeString(void 0,i,this.wNamespace,t[st[this.keywordIndex]])}if(!(0,a.isNullOrUndefined)(t[at[this.keywordIndex]])){i=Pa.isThemeFont(t[at[this.keywordIndex]])?"eastAsiaTheme":"eastAsia";e.writeAttributeString(void 0,i,this.wNamespace,t[at[this.keywordIndex]])}if(!(0,a.isNullOrUndefined)(t[lt[this.keywordIndex]])){i=Pa.isThemeFont(t[lt[this.keywordIndex]])?"hAnsiTheme":"hAnsi";e.writeAttributeString(void 0,i,this.wNamespace,t[lt[this.keywordIndex]])}if(!(0,a.isNullOrUndefined)(t[tt[this.keywordIndex]])){i=Pa.isThemeFont(t[tt[this.keywordIndex]])?"cstheme":"cs";e.writeAttributeString(void 0,i,this.wNamespace,t[tt[this.keywordIndex]])}(0,a.isNullOrUndefined)(t[qe[this.keywordIndex]])||e.writeAttributeString(void 0,"hint",this.wNamespace,this.getFontHintType(t[qe[this.keywordIndex]])),e.writeEndElement()}if((0,a.isNullOrUndefined)(t[Ae[this.keywordIndex]])||this.serializeBoolProperty(e,"b",Pa.parseBoolValue(t[Ae[this.keywordIndex]])),Pa.parseBoolValue(t[it[this.keywordIndex]])&&this.serializeBoolProperty(e,"bCs",Pa.parseBoolValue(t[it[this.keywordIndex]])),(0,a.isNullOrUndefined)(t[Ue[this.keywordIndex]])||this.serializeBoolProperty(e,"i",Pa.parseBoolValue(t[Ue[this.keywordIndex]])),(0,a.isNullOrUndefined)(t[nt[this.keywordIndex]])||this.serializeBoolProperty(e,"iCs",Pa.parseBoolValue(t[nt[this.keywordIndex]])),Pa.parseBoolValue(t[Ye[this.keywordIndex]])&&(e.writeStartElement(void 0,"rtl",this.wNamespace),e.writeEndElement()),(0,a.isNullOrUndefined)(t[rt[this.keywordIndex]])||this.serializeBoolProperty(e,"caps",Pa.parseBoolValue(t[rt[this.keywordIndex]])),Pa.parseBoolValue(t[ot[this.keywordIndex]])&&this.serializeBoolProperty(e,"cs",Pa.parseBoolValue(t[ot[this.keywordIndex]])),!(0,a.isNullOrUndefined)(t[je[this.keywordIndex]]))switch(t[je[this.keywordIndex]]){case"SingleStrike":case 1:this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":case 2:this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if((0,a.isNullOrUndefined)(t[Xe[this.keywordIndex]])||(e.writeStartElement(void 0,"color",this.wNamespace),"empty"===t[Xe[this.keywordIndex]]||"#00000000"===t[Xe[this.keywordIndex]]?e.writeAttributeString("w","val",this.wNamespace,"auto"):e.writeAttributeString("w","val",this.wNamespace,this.getColor(t[Xe[this.keywordIndex]])),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Ke[this.keywordIndex]])||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[Ke[this.keywordIndex]]).toString()),e.writeEndElement()),(0,a.isNullOrUndefined)(t[ct[this.keywordIndex]])||(e.writeStartElement(void 0,"spacing",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,(20*t[ct[this.keywordIndex]]).toString()),e.writeEndElement()),(0,a.isNullOrUndefined)(t[pt[this.keywordIndex]])||(e.writeStartElement(void 0,"w",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[pt[this.keywordIndex]].toString()),e.writeEndElement()),(0,a.isNullOrUndefined)(t[et[this.keywordIndex]])||(e.writeStartElement(void 0,"szCs",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[et[this.keywordIndex]]).toString()),e.writeEndElement()),(0,a.isNullOrUndefined)(t[Ge[this.keywordIndex]])||t[Ge[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t[Ge[this.keywordIndex]])),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[dt[this.keywordIndex]])&&t[dt[this.keywordIndex]].length>0&&(this.serializeRevisionStart(e,t,void 0),this.serializeRevisionEnd(e,t,void 0)),(0,a.isNullOrUndefined)(t[Ve[this.keywordIndex]])||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t[Ve[this.keywordIndex]])),(0,a.isNullOrUndefined)(t[ze[this.keywordIndex]])||e.writeAttributeString("w","color",this.wNamespace,this.getColor(t[ze[this.keywordIndex]])),e.writeEndElement()),!(0,a.isNullOrUndefined)(t[_e[this.keywordIndex]])){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),t[_e[this.keywordIndex]]){case"Superscript":case 1:e.writeAttributeString("w","val",this.wNamespace,"superscript");break;case"Subscript":case 2:e.writeAttributeString("w","val",this.wNamespace,"subscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},e.prototype.getColor=function(e){return e.length>0&&("#"===e[0]&&(e=e.substr(1)),e.length>6&&(e=e.substr(0,6))),e},e.prototype.getStyleType=function(e){switch(e){case"Character":case 1:return"character";case"Table":case 2:return"table";default:return"paragraph"}},e.prototype.getUnderlineStyle=function(e){switch(e){case"None":case 0:return"none";case"Single":case 1:return"single";case"Words":case 2:return"words";case"Double":case 3:return"double";case"Dotted":case 4:return"dotted";case"Thick":case 5:return"thick";case 6:default:return"dash";case"DashLong":case 7:return"dashLong";case"DotDash":case 8:return"dotDash";case"DotDotDash":case 9:return"dotDotDash";case"Wavy":case 10:return"wave";case"DottedHeavy":case 11:return"dottedHeavy";case"DashHeavy":case 12:return"dashedHeavy";case"DashLongHeavy":case 13:return"dashLongHeavy";case"DotDashHeavy":case 14:return"dashDotHeavy";case"DotDotDashHeavy":case 15:return"dashDotDotHeavy";case"WavyHeavy":case 16:return"wavyHeavy";case"WavyDouble":case 17:return"wavyDouble"}},e.prototype.getFontHintType=function(e){switch(e){case"EastAsia":case 1:return"eastAsia";case"CS":case 2:return"cs";default:return"default"}},e.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":case 2:return"green";case"Turquoise":case 3:return"cyan";case"Pink":case 4:return"magenta";case"Blue":case 5:return"blue";case"Red":case 6:return"red";case"DarkBlue":case 7:return"darkBlue";case"Teal":case 8:return"darkCyan";case"Green":case 9:return"darkGreen";case"Violet":case 10:return"darkMagenta";case"DarkRed":case 11:return"darkRed";case"DarkYellow":case 12:return"darkYellow";case"Gray50":case 13:return"darkGray";case"Gray25":case 14:return"lightGray";case"Black":case 15:return"black";default:return"yellow"}},e.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeNumberings=function(){if(0!==this.document[re[this.keywordIndex]].length){var e=new np.XmlWriter;e.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document[oe[this.keywordIndex]]),this.serializeListInstances(e,this.document[re[this.keywordIndex]]),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.numberingPath);this.mArchive.addItem(t)}},e.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,n[ls[this.keywordIndex]].toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,Pa.numberToHexDecimal(n[ds])),e.writeEndElement();for(var r=0,o=n[hs[this.keywordIndex]].length;r<o;r++)this.serializeListLevel(e,n[hs[this.keywordIndex]][r],r);e.writeEndElement()}},e.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(n[ht[this.keywordIndex]]+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,n[ls[this.keywordIndex]].toString()),e.writeEndElement();for(var r=0,o=n[ps[this.keywordIndex]].length;r<o;r++)this.serializeLevelOverrides(e,n[ps[this.keywordIndex]][r],n[ps[this.keywordIndex]][r][os[this.keywordIndex]]);e.writeEndElement()}},e.prototype.roundToTwoDecimal=function(e){return Math.round(e)},e.prototype.serializeListLevel=function(e,t,i){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),!(0,a.isNullOrUndefined)(t[Oo[this.keywordIndex]])&&t[Oo[this.keywordIndex]]&&e.writeElementString(void 0,"isLgl",this.wNamespace,void 0),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[ns[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t[ts[this.keywordIndex]])),e.writeEndElement(),(0,a.isNullOrUndefined)(t[as[this.keywordIndex]])||""===t[as[this.keywordIndex]].toString()||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[as[this.keywordIndex]].toString()),e.writeEndElement()),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,i+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t[ne[this.keywordIndex]],void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t[ie[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeLevelOverrides=function(e,t,i){e.writeStartElement(void 0,"lvlOverride",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),(0,a.isNullOrUndefined)(t[cs[this.keywordIndex]])||this.serializeListLevel(e,t[cs[this.keywordIndex]],i),(0,a.isNullOrUndefined)(t[ns[this.keywordIndex]])||(e.writeStartElement(void 0,"startOverride",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[ns[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.getLevelPattern=function(e){var t;switch(e){case"None":case 0:t="none";break;case"Arabic":case 1:t="decimal";break;case"UpRoman":case 2:t="upperRoman";break;case"LowRoman":case 3:t="lowerRoman";break;case"UpLetter":case 4:t="upperLetter";break;case"LowLetter":case 5:t="lowerLetter";break;case"Ordinal":case 6:t="ordinal";break;case"Number":case 7:t="cardinalText";break;case"OrdinalText":case 8:t="ordinalText";break;case"LeadingZero":case 9:t="decimalZero";break;case"FarEast":case 11:t="aiueoFullWidth";break;case"Special":case 12:t="russianLower";break;default:t="bullet"}return t},e.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[ss[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeLevelFollow=function(e,t){var i;i=t[is[this.keywordIndex]]===(1==this.keywordIndex?0:"Tab")?"tab":t[is[this.keywordIndex]]===(1==this.keywordIndex?1:"Space")?"space":"nothing",e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement()},e.prototype.serializeThemeFontLang=function(e){var t=this.themeFontLang[Me[this.keywordIndex]]>0,n=this.themeFontLang[De[this.keywordIndex]]>0,r=this.themeFontLang[Re[this.keywordIndex]]>0;if(n||r||t){if(e.writeStartElement("w","themeFontLang",void 0),n){var o=i[this.themeFontLang[De[this.keywordIndex]]];e.writeAttributeString("w","val",void 0,o.replace("_","-"))}if(t){var s=i[this.themeFontLang[Me[this.keywordIndex]]];e.writeAttributeString("w","bidi",void 0,s.replace("_","-"))}if(r){var a=i[this.themeFontLang[Re[this.keywordIndex]]];e.writeAttributeString("w","eastAsia",void 0,a.replace("_","-"))}e.writeEndElement()}},e.prototype.serializeDocumentProtectionSettings=function(e){if(e.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&e.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&0!==this.protectionType){var t=void 0;switch(this.protectionType){case"ReadOnly":case 1:t="readOnly";break;case"FormFieldsOnly":case 2:t="forms";break;case"CommentsOnly":case 3:t="comments";break;case"RevisionsOnly":case 4:t="trackedChanges"}e.writeAttributeString("w","edit",this.wNamespace,t)}e.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES"),e.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash"),e.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny"),e.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14"),e.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000"),this.enforcement&&e.writeAttributeString("w","enforcement",this.wNamespace,"1"),this.hashValue&&e.writeAttributeString("w","hash",this.wNamespace,this.hashValue),this.saltValue&&e.writeAttributeString("w","salt",this.wNamespace,this.saltValue),e.writeEndElement()},e.prototype.serializeSettings=function(){var e=new np.XmlWriter;e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDocumentProtectionSettings(e),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),this.serializeThemeFontLang(e),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace);var t=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.trackChanges&&(e.writeStartElement(void 0,"trackRevisions",this.wNamespace),e.writeEndElement()),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),this.formFieldShading||(e.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(e,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing),this.allowSpaceOfSameStyleInTable&&this.serializeBoolProperty(e,"allowSpaceOfSameStyleInTable",this.allowSpaceOfSameStyleInTable),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word");var i=1===this.keywordIndex?Pa.getCompatibilityModeValue(this.compatibilityMode):Pa.getCompatibilityModeValue(this.getCompatibilityModeEnumValue(this.compatibilityMode.toString()));e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement(),e.writeEndElement(),this.document[Se[this.keywordIndex]]&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),this.document[Te[this.keywordIndex]]&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),e.writeEndElement();var n=new Fa.ZipArchiveItem(e.buffer,this.settingsPath);this.mArchive.addItem(n)},e.prototype.serializeCoreProperties=function(){},e.prototype.serializeAppProperties=function(){},e.prototype.serializeFontTable=function(e){},e.prototype.serializeSettingsRelation=function(){},e.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},e.prototype.serializeHeaderFooters=function(){this.isHeaderFooter=!0,this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader"),this.isHeaderFooter=!1},e.prototype.serializeHeaderFooter=function(e){var t,i;if(0!==this.headersFooters.length&&this.headersFooters.containsKey(e))for(var n=this.headersFooters.get(e),r=void 0,o=0;o<n.keys.length;o++){var s=n.keys[o];r=n.get(s),"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+s.replace("rId","")+".xml",i=this.headerRelationPath+s.replace("rId","")+".xml.rels",this.serializeHeader(r,s,t,i)):(t=this.footerPath+s.replace("rId","")+".xml",i=this.footerRelationPath+s.replace("rId","")+".xml.rels",this.serializeFooter(r,s,t,i))}},e.prototype.serializeHeader=function(e,t,i,n){this.headerFooter=e;var r=new np.XmlWriter;r.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(r);var o=this.blockOwner;this.blockOwner=e,this.serializeBodyItems(r,e[Go[this.keywordIndex]],!0),this.blockOwner=o,r.writeEndElement();var s=new Fa.ZipArchiveItem(r.buffer,i);this.mArchive.addItem(s),this.serializeHFRelations(t,n),this.headerFooter=void 0},e.prototype.serializeHFRelations=function(e,t){if(this.headerFooterImages.containsKey(e)){var i=new np.XmlWriter;i.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),i,!1),this.headerFooterSvgImages.containsKey(e)&&this.serializeSvgImageRelation(this.headerFooterSvgImages.get(e),i),i.writeEndElement();var n=new Fa.ZipArchiveItem(i.buffer,t);this.mArchive.addItem(n)}},e.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},e.prototype.serializeFooter=function(e,t,i,n){this.headerFooter=e;var r=new np.XmlWriter;r.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(r),this.serializeBodyItems(r,e[Go[this.keywordIndex]],!0),r.writeEndElement();var o=new Fa.ZipArchiveItem(r.buffer,i);this.mArchive.addItem(o),this.serializeHFRelations(t,n)},e.prototype.serializeDocumentRelations=function(){var e=new np.XmlWriter;e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document[Te[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml"),this.document[Se[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml"),this.mComments.length>0&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml"))),(0,a.isNullOrUndefined)(this.mThemes)||this.serializeRelationShip(e,this.getNextRelationShipID(),this.ThemeRelType,"theme/theme1.xml"),this.document[re[this.keywordIndex]].length>0&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e,!1),this.serializeSvgImageRelation(this.svgImages,e),this.serializeCustomXMLMapping(this.mCustomXML,e),this.serializeChartDocumentRelations(this.documentCharts,e),this.serializeExternalLinkImages(e),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.wordRelationPath);this.mArchive.addItem(t),this.headerFooter=void 0},e.prototype.serializeChartDocumentRelations=function(e,t){if(e.length>0)for(var i=e.keys,n=1;n<=i.length;n++)this.serializeRelationShip(t,i[n-1],this.chartRelType,"charts/chart"+n+".xml")},e.prototype.serializeChartRelations=function(){var e=new np.XmlWriter;this.resetChartRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace);var t="colors"+this.chartCount+".xml",i=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",n="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.packageRelType,n),this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.chartColorStyleRelType,t),e.writeEndElement();var r=new Fa.ZipArchiveItem(e.buffer,i);this.mArchive.addItem(r)},e.prototype.serializeImagesRelations=function(e,t,i){if(e.length>0)for(var n="",r=void 0,o=e.keys,s=0;s<o.length;s++){var l=e.get(o[s]),d=void 0;if("string"==typeof l&&this.startsWith(l,"data"))r=l;else if(r=(d=this.getBase64ImageString(l)).imageString,Pa.parseBoolValue(l[pr[this.keywordIndex]]))(".svg"!==Pa.formatClippedString(d.metaFileImageString).extension||i)&&(r=d.metaFileImageString);if((0,a.isNullOrUndefined)(r))n=this.imagePath+"/0.jpeg",this.serializeRelationShip(t,o[s],this.imageRelType,n.replace("word/",""));else{var h=Pa.formatClippedString(r),c=h.extension,p=h.formatClippedString;n=this.imagePath+o[s]+c,this.serializeRelationShip(t,o[s],this.imageRelType,n.replace("word/",""));var u=void 0;u=this.startsWith(r,"data:image/svg+xml;utf8,")?new Blob([p]):new Blob([this.encodedString(p)]);var g=new Fa.ZipArchiveItem(u,n);this.mArchive.addItem(g)}}},e.prototype.serializeSvgImageRelation=function(e,t){this.serializeImagesRelations(e,t,!0)},e.prototype.encodedString=function(e){var t,i,n,r,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,d=0,h=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&h--,e.charAt(e.length-2)===a.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var c=new Uint8Array(0|h);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(r=a.indexOf(e.charAt(l++)))>>4,i=(15&r)<<4|(o=a.indexOf(e.charAt(l++)))>>2,n=(3&o)<<6|(s=a.indexOf(e.charAt(l++))),c[d++]=t,64!==o&&(c[d++]=i),64!==s&&(c[d++]=n);return c},e.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},e.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},e.prototype.serializeHFRelation=function(e,t){var i,n="";if(this.headersFooters.containsKey(t))for(var r=this.headersFooters.get(t),o=0;o<r.keys.length;o++){var s=r.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(n="header"+s.replace("rId","")+".xml",i=this.headerRelType):(n="footer"+s.replace("rId","")+".xml",i=this.footerRelType),this.serializeRelationShip(e,s,i,n)}},e.prototype.serializeRelationShip=function(e,t,i,n){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,n.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(n,"http://")||this.startsWith(n,"https://")||this.startsWith(n,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},e.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},e.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},e.prototype.serializeGeneralRelations=function(){var e=new np.XmlWriter;this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement();var t=new Fa.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchive.addItem(t)},e.prototype.serializeContentTypes=function(e,t){var i=new np.XmlWriter;if(i.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(i,"rels",this.relationContentType),this.serializeDefaultContentType(i,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(i,"png","image/png"),this.serializeDefaultContentType(i,"bmp","image/bmp"),this.serializeDefaultContentType(i,"emf","image/x-emf"),this.serializeDefaultContentType(i,"wmf","image/x-wmf"),this.serializeDefaultContentType(i,"gif","image/gif"),this.serializeDefaultContentType(i,"ico","image/x-icon"),this.serializeDefaultContentType(i,"tif","image/tiff"),this.serializeDefaultContentType(i,"tiff","image/tiff"),this.serializeDefaultContentType(i,"jpeg","image/jpeg"),this.serializeDefaultContentType(i,"jpg","image/jpeg"),this.serializeDefaultContentType(i,"svg","image/svg+xml")),"Docx"==t?this.serializeOverrideContentType(i,this.documentPath,this.documentContentType):"Dotx"==t&&this.serializeOverrideContentType(i,this.documentPath,this.TemplateContentType),this.serializeOverrideContentType(i,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(i,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(i,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(i,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(i,this.themePath,this.themeContentType),this.serializeOverrideContentType(i,this.commentsExtendedPath,this.commentsExContentType),this.chartCount>0){var n=1;for(this.serializeDefaultContentType(i,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");n<=this.chartCount;)this.serializeOverrideContentType(i,"word/charts/chart"+n+".xml",this.chartsContentType),this.serializeOverrideContentType(i,"word/charts/colors"+n+".xml",this.chartColorStyleContentType),n++}if(this.customXMLProps.length>0)for(var r=0;r<this.customXMLProps.length;r++)this.serializeOverrideContentType(i,this.customXMLProps[r],this.customXmlContentType);this.serializeHFContentTypes(i),this.SerializeEFContentTypes(i),i.writeEndElement();var o=new Fa.ZipArchiveItem(i.buffer,this.contentTypesPath);this.mArchive.addItem(o)},e.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},e.prototype.serializeHeaderFootersContentType=function(e,t){var i,n;if(this.headersFooters.containsKey(t))for(var r=this.headersFooters.get(t),o=0;o<r.keys.length;o++){var s=r.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(n=this.headerPath+s.replace("rId","")+".xml",i=this.headerContentType):(n=this.footerPath+s.replace("rId","")+".xml",i=this.footerContentType),this.serializeOverrideContentType(e,n,i)}},e.prototype.SerializeEFContentTypes=function(e){this.serializeEFContentType(e)},e.prototype.serializeEFContentType=function(e){var t,i;i=this.endnotesPath,t=this.endnoteContentType,this.serializeOverrideContentType(e,i,t),i=this.footnotesPath,t=this.footnoteContentType,this.serializeOverrideContentType(e,i,t)},e.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.resetRelationShipID=function(){this.mRelationShipID=0},e.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},e.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},e.prototype.close=function(){},e.prototype.getExportAutoShapeType=function(e){switch(e){case 1:return"rect";case 2:return"roundRect";case 3:return"straightConnector1";case 4:return"ellipse";case 5:return"triangle";case 6:return"rtTriangle";case 7:return"parallelogram";case 8:return"trapezoid";case 9:return"diamond";case 10:return"pentagon";case 11:return"hexagon";case 12:return"heptagon";case 13:return"octagon";case 14:return"decagon";case 15:return"dodecagon";case 16:return"chord";case 17:return"teardrop";case 18:return"frame";case 19:return"halfFrame";case 20:return"corner";case 21:return"pie";case 22:return"diagStripe";case 23:return"plus";case 24:return"plaque";case 25:return"can";case 26:return"cube";case 27:return"bevel";case 28:return"donut";case 29:return"noSmoking";case 30:return"blockArc";case 31:return"foldedCorner";case 32:return"smileyFace";case 33:return"heart";case 34:return"lightningBolt";case 35:return"sun";case 36:return"moon";case 37:return"cloud";case 38:return"arc";case 39:return"bracketPair";case 40:return"bracePair";case 41:return"leftBracket";case 42:return"rightBracket";case 43:return"leftBrace";case 44:return"rightBrace";case 45:return"flowChartProcess";case 46:return"flowChartAlternateProcess";case 47:return"flowChartDecision";case 48:return"flowChartInputOutput";case 49:return"flowChartPredefinedProcess";case 50:return"flowChartInternalStorage";case 51:return"flowChartDocument";case 52:return"flowChartMultidocument";case 53:return"flowChartTerminator";case 54:return"flowChartPreparation";case 55:return"flowChartManualInput";case 56:return"flowChartManualOperation";case 57:return"flowChartConnector";case 58:return"flowChartOffpageConnector";case 59:return"flowChartPunchedCard";case 60:return"flowChartPunchedTape";case 61:return"flowChartSummingJunction";case 62:return"flowChartOr";case 63:return"flowChartCollate";case 64:return"flowChartSort";case 65:return"flowChartExtract";case 66:return"flowChartMerge";case 67:return"flowChartOnlineStorage";case 68:return"flowChartDelay";case 69:return"flowChartMagneticTape";case 70:return"flowChartMagneticDisk";case 71:return"flowChartMagneticDrum";case 72:return"flowChartDisplay";case 73:return"rightArrow";case 74:return"leftArrow";case 75:return"upArrow";case 76:return"downArrow";case 77:return"leftRightArrow";case 78:return"upDownArrow";case 79:return"quadArrow";case 80:return"leftRightUpArrow";case 81:return"bentArrow";case 82:return"uturnArrow";case 83:return"leftUpArrow";case 84:return"bentUpArrow";case 85:return"curvedRightArrow";case 86:return"curvedLeftArrow";case 87:return"curvedUpArrow";case 88:return"curvedDownArrow";case 89:return"stripedRightArrow";case 90:return"notchedRightArrow";case 91:return"homePlate";case 92:return"chevron";case 93:return"rightArrowCallout";case 94:return"downArrowCallout";case 95:return"leftArrowCallout";case 96:return"upArrowCallout";case 97:return"leftRightArrowCallout";case 98:return"quadArrowCallout";case 99:return"circularArrow";case 100:return"mathPlus";case 101:return"mathMinus";case 102:return"mathMultiply";case 103:return"mathDivide";case 104:return"mathEqual";case 105:return"mathNotEqual";case 106:return"irregularSeal1";case 107:return"irregularSeal2";case 108:return"star4";case 109:return"star5";case 110:return"star6";case 111:return"star7";case 112:return"star8";case 113:return"star10";case 114:return"star12";case 115:return"star16";case 116:return"star24";case 117:return"star32";case 118:return"ribbon2";case 119:return"ribbon";case 120:return"ellipseRibbon2";case 121:return"ellipseRibbon";case 122:return"verticalScroll";case 123:return"horizontalScroll";case 124:return"wave";case 125:return"doubleWave";case 126:return"snip1Rect";case 127:return"snip2SameRect";case 128:return"snip2DiagRect";case 129:return"snipRoundRect";case 130:return"round1Rect";case 131:return"round2SameRect";case 132:return"round2DiagRect";case 133:return"textNoShape";case 134:return"bentConnector3";case 135:return"curvedConnector3";default:return e}},e.prototype.getAutoShapeTypeEnumValue=function(e){switch(e){case"Rectangle":return 1;case"RoundedRectangle":return 2;case"StraightConnector":return 3;case"Oval":return 4;case"IsoscelesTriangle":return 5;case"RightTriangle":return 6;case"Parallelogram":return 7;case"Trapezoid":return 8;case"Diamond":return 9;case"RegularPentagon":return 10;case"Hexagon":return 11;case"Heptagon":return 12;case"Octagon":return 13;case"Decagon":return 14;case"Dodecagon":return 15;case"Chord":return 16;case"Teardrop":return 17;case"Frame":return 18;case"HalfFrame":return 19;case"L_Shape":return 20;case"Pie":return 21;case"DiagonalStripe":return 22;case"Cross":return 23;case"Plaque":return 24;case"Can":return 25;case"Cube":return 26;case"Bevel":return 27;case"Donut":return 28;case"NoSymbol":return 29;case"BlockArc":return 30;case"FoldedCorner":return 31;case"SmileyFace":return 32;case"Heart":return 33;case"LightningBolt":return 34;case"Sun":return 35;case"Moon":return 36;case"Cloud":return 37;case"Arc":return 38;case"DoubleBracket":return 39;case"DoubleBrace":return 40;case"LeftBracket":return 41;case"RightBracket":return 42;case"LeftBrace":return 43;case"RightBrace":return 44;case"FlowChartProcess":return 45;case"FlowChartAlternateProcess":return 46;case"FlowChartDecision":return 47;case"FlowChartData":return 48;case"FlowChartPredefinedProcess":return 49;case"FlowChartInternalStorage":return 50;case"FlowChartDocument":return 51;case"FlowChartMultiDocument":return 52;case"FlowChartTerminator":return 53;case"FlowChartPreparation":return 54;case"FlowChartManualInput":return 55;case"FlowChartManualOperation":return 56;case"FlowChartConnector":return 57;case"FlowChartOffPageConnector":return 58;case"FlowChartCard":return 59;case"FlowChartPunchedTape":return 60;case"FlowChartSummingJunction":return 61;case"FlowChartOr":return 62;case"FlowChartCollate":return 63;case"FlowChartSort":return 64;case"FlowChartExtract":return 65;case"FlowChartMerge":return 66;case"FlowChartStoredData":return 67;case"FlowChartDelay":return 68;case"FlowChartSequentialAccessStorage":return 69;case"FlowChartMagneticDisk":return 70;case"FlowChartDirectAccessStorage":return 71;case"FlowChartDisplay":return 72;case"RightArrow":return 73;case"LeftArrow":return 74;case"UpArrow":return 75;case"DownArrow":return 76;case"LeftRightArrow":return 77;case"UpDownArrow":return 78;case"QuadArrow":return 79;case"LeftRightUpArrow":return 80;case"BentArrow":return 81;case"UTurnArrow":return 82;case"LeftUpArrow":return 83;case"BentUpArrow":return 84;case"CurvedRightArrow":return 85;case"CurvedLeftArrow":return 86;case"CurvedUpArrow":return 87;case"CurvedDownArrow":return 88;case"StripedRightArrow":return 89;case"NotchedRightArrow":return 90;case"Pentagon":return 91;case"Chevron":return 92;case"RightArrowCallout":return 93;case"DownArrowCallout":return 94;case"LeftArrowCallout":return 95;case"UpArrowCallout":return 96;case"LeftRightArrowCallout":return 97;case"QuadArrowCallout":return 98;case"CircularArrow":return 99;case"MathPlus":return 100;case"MathMinus":return 101;case"MathMultiply":return 102;case"MathDivision":return 103;case"MathEqual":return 104;case"MathNotEqual":return 105;case"Explosion1":return 106;case"Explosion2":return 107;case"Star4Point":return 108;case"Star5Point":return 109;case"Star6Point":return 110;case"Star7Point":return 111;case"Star8Point":return 112;case"Star10Point":return 113;case"Star12Point":return 114;case"Star16Point":return 115;case"Star24Point":return 116;case"Star32Point":return 117;case"UpRibbon":return 118;case"DownRibbon":return 119;case"CurvedUpRibbon":return 120;case"CurvedDownRibbon":return 121;case"VerticalScroll":return 122;case"HorizontalScroll":return 123;case"Wave":return 124;case"DoubleWave":return 125;case"SnipSingleCornerRectangle":return 126;case"SnipSameSideCornerRectangle":return 127;case"SnipDiagonalCornerRectangle":return 128;case"SnipAndRoundSingleCornerRectangle":return 129;case"RoundSingleCornerRectangle":return 130;case"RoundSameSideCornerRectangle":return 131;case"RoundDiagonalCornerRectangle":return 132;case"Unknown":return 133;case"ElbowConnector":return 134;case"CurvedConnector":return 135;default:return 0}},e}(),op=function(){function e(){this.pageContent="",this.curSectionIndex=0,this.inField=!1}return e.prototype.getModuleName=function(){return"TextExport"},e.prototype.save=function(e,t){this.serialize(e);var i=new np.StreamWriter;this.writeInternal(i),i.save(t+".txt")},e.prototype.saveAsBlob=function(e){this.serialize(e);var t=new np.StreamWriter;this.writeInternal(t);var i=t.buffer;return t.destroy(),new Promise((function(e,t){e(i)}))},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write(0);this.setDocument(t)},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},e.prototype.writeInternal=function(e){var t=void 0,i=this.document.sections.length-1,n=!1;this.updateLastParagraph();for(var r=0;r<=i;r++)t=this.document.sections[r],n=r===i,this.writeBody(e,t.blocks,!1),this.writeNewLine(e),this.writeSectionEnd(t,n);for(var o=0;o<=i;o++)t=this.document.sections[o],this.writeHeadersFooters(e,t)},e.prototype.writeBody=function(e,t,i){for(var n=t.length-1,r=void 0,o=0;o<=n;o++)if((r=t[o]).hasOwnProperty("inlines")){var s=r===this.lastPara;this.writeParagraph(e,r,s,i)}else r.blocks?this.writeBody(e,r.blocks,i):this.writeTable(e,r)},e.prototype.writeParagraph=function(e,t,i,n){for(var r=0;r<t.inlines.length;r++){var o=t.inlines[r];o.hasOwnProperty("fieldType")?this.inField=0===o.fieldType:o.hasOwnProperty("text")&&!this.inField&&this.writeText(e,o.text)}(!n||t.inlines.length>0)&&(i||this.writeNewLine(e))},e.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var n=t.rows[i],r=0;r<n.cells.length;r++){var o=n.cells[r];this.writeBody(e,o.blocks,!1)}},e.prototype.writeHeadersFooters=function(e,t){var i=t.headersFooters;(0,a.isNullOrUndefined)(i)||(this.writeHeaderFooter(e,t.headersFooters.header),this.writeHeaderFooter(e,t.headersFooters.footer),this.writeHeaderFooter(e,t.headersFooters.evenFooter),this.writeHeaderFooter(e,t.headersFooters.evenHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageFooter))},e.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks,!0)},e.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},e.prototype.writeNewLine=function(e){(0,a.isNullOrUndefined)(e)?this.pageContent=this.pageContent+" ":e.writeLine("")},e.prototype.writeText=function(e,t){(0,a.isNullOrUndefined)(e)?this.pageContent+=t:e.write(t)},e.prototype.updateLastParagraph=function(){var e,t=this.document.sections.length;if(t>0&&(e=this.document.sections[t-1]),!(0,a.isNullOrUndefined)(e)){for(var i=[],n=0;n<e.blocks.length;n++)e.blocks[n].hasOwnProperty("inlines")&&i.push(e.blocks[n]);var r=i.length;r>0&&(this.lastPara=i[r-1])}},e.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=[],this.sections=void 0,this.pageContent=void 0},e}(),sp=function(){function e(e){this.startLine=void 0,this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.images=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.blockContent=!1,this.startContent=!1,this.multipleLineContent=!1,this.nestedContent=!1,this.editRangeId=-1,this.selectedCommentsId=[],this.selectedRevisionId=[],this.nestedBlockContent=!1,this.nestedBlockEnabled=!1,this.blocks=[],this.contentInline=[],this.isContentControl=!1,this.isBlockClosed=!0,this.isWriteInlinesFootNote=!1,this.isWriteEndFootNote=!1,this.iscontentInsert=!0,this.keywordIndex=void 0,this.isExport=!0,this.isPartialExport=!1,this.checkboxOrDropdown=!1,this.copyWithTrackChange=!1,this.documentHelper=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"SfdtExport"},e.prototype.clear=function(){this.writeInlineStyles=void 0,this.startLine=void 0,this.endLine=void 0,this.lists=void 0,this.images=void 0,this.document=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.selectedCommentsId=[],this.selectedRevisionId=[],this.startBlock=void 0,this.endBlock=void 0,this.isPartialExport=!1,this.keywordIndex=void 0},e.prototype.serialize=function(){return this.seralizeInternal(this.owner.documentEditorSettings.optimizeSfdt?1:0)},e.prototype.seralizeInternal=function(e){return JSON.stringify(this.write(e))},e.prototype.saveAsBlobNonOptimized=function(e){var t=new Blob([this.serialize()],{type:"text/plain"});return new Promise((function(e,i){e(t)}))},e.prototype.saveAsBlob=function(e){var t=this.serialize(),i=new Blob([t],{type:"application/json"}),n=new Fa.ZipArchiveItem(i,"sfdt"),r=new Fa.ZipArchive;return r.addItem(n),r.saveAsBlob()},e.prototype.updateEditRangeId=function(){for(var e=-1,t=0;t<this.documentHelper.editRanges.keys.length;t++)for(var i=this.documentHelper.editRanges.keys,n=0;n<i[t].length;n++)for(var r=this.documentHelper.editRanges.get(i[t]),o=0;o<r.length;o++)e++,r[o].editRangeId=e,(0,a.isNullOrUndefined)(r[o].editRangeEnd)||(r[o].editRangeEnd.editRangeId=e)},e.prototype.write=function(e,t,i,n,r,o,s){var l;if(o&&(this.writeInlineStyles=!0),(0,a.isNullOrUndefined)(e)?this.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0:this.keywordIndex=e,this.Initialize(),this.updateEditRangeId(),t instanceof zl&&n instanceof zl){this.isExport=!1,(0,a.isNullOrUndefined)(s)||(this.isExport=s);var d=t.paragraph,h=n.paragraph;this.isPartialExport&&(this.startBlock=this.getParentBlock(d),this.endBlock=this.getParentBlock(h));var c=d.associatedCell,p=h.associatedCell,u=(d.bodyWidget,this.createSection(t.paragraph.bodyWidget));this.document[ee[this.keywordIndex]].push(u);var g=c,m=p;c instanceof Vl&&(g=this.getParentCell(g)),p instanceof Vl&&(m=this.getParentCell(m));var f=g instanceof Vl&&m instanceof Vl&&g.equals(m);if(f||(0,a.isNullOrUndefined)(p))this.startLine=t,this.endLine=n,this.endOffset=r;else if(c instanceof Vl){var v=c.getContainerTable(),y=p.getContainerTable();v.tableFormat===y.tableFormat&&(this.endCell=p,this.endCell.ownerTable!==c.ownerTable&&c.ownerTable.associatedCell&&c.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===c.ownerTable.associatedCell.childWidgets.indexOf(c.ownerTable)&&(c=c.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=c.columnIndex)}else this.endCell=p;var w=void 0;if(f&&!this.isPartialExport||(0,a.isNullOrUndefined)(c)){var b=t.paragraph,C=this.owner.selection.getLineLength(h.lastChild),x=d===h&&this.endOffset===C+1;if(!this.owner.documentHelper.isCopying||(0,a.isNullOrUndefined)(d.contentControlProperties)||0!==i&&1!==i||d===h&&!x){I=this.createParagraph(t.paragraph);u[Go[this.keywordIndex]].push(I),w=this.writeParagraph(t.paragraph,I,u[Go[this.keywordIndex]],t.indexInOwner,i)}else{if(this.isContentControl=!0,w=this.writeBlock(b,0,u[Go[this.keywordIndex]]),x){var I=this.createParagraph(t.paragraph);u[Go[this.keywordIndex]].push(I)}this.isContentControl=!1}for(this.isPartialExport&&(w=this.getNextBlock(w,b),u=this.document[ee[this.keywordIndex]][this.document[ee[this.keywordIndex]].length-1]);w;){if(w.containerWidget instanceof Ol&&b.containerWidget instanceof Ol&&w.containerWidget.sectionIndex!==b.containerWidget.sectionIndex){u=this.createSection(w.containerWidget),this.document[ee[this.keywordIndex]].push(u);I=this.createParagraph(w);u[Go[this.keywordIndex]].push(I),b=w,w=this.writeParagraph(b,I,u[Go[this.keywordIndex]],t.indexInOwner,i)}else{if(b=w,this.owner.documentHelper.isCopying&&w instanceof Rl&&!(0,a.isNullOrUndefined)(w.contentControlProperties)&&w===h&&this.endOffset!==C+1){this.isContentControl=!0;I=this.createParagraph(w);u[Go[this.keywordIndex]].push(I);var k=w.isEmpty()?0:this.owner.selection.getNextValidOffset(w.firstChild,0);w=this.writeParagraph(w,I,u[Go[this.keywordIndex]],0,k),this.isContentControl=!1}else w=this.writeBlock(w,0,u[Go[this.keywordIndex]]);this.isPartialExport&&(0,a.isNullOrUndefined)(w)&&(w=this.getNextBlock(w,b),u=this.document[ee[this.keywordIndex]][this.document[ee[this.keywordIndex]].length-1])}}}else{if((0,a.isNullOrUndefined)(p)&&c.ownerTable.associatedCell){var F=(v=c.getContainerTable()).childWidgets[v.childWidgets.length-1],P=F.childWidgets[F.childWidgets.length-1];if(P.ownerTable!==c.ownerTable&&c.ownerTable.associatedCell&&0===c.ownerTable.associatedCell.childWidgets.indexOf(c.ownerTable))for(;c.ownerTable!==P.ownerTable;)c=c.ownerTable.associatedCell;this.endColumnIndex=P.columnIndex+P.cellFormat.columnSpan,this.startColumnIndex=c.columnIndex}var S=this.createTable(c.ownerTable);u[Go[this.keywordIndex]].push(S);b=c.ownerTable;for(w=this.writeTable(c.ownerTable,S,c.ownerRow.indexInOwner,u[Go[this.keywordIndex]]),this.isPartialExport&&(w=this.getNextBlock(w,b),u=this.document[ee[this.keywordIndex]][this.document[ee[this.keywordIndex]].length-1]);w;){if(w.containerWidget instanceof Ol&&b.containerWidget instanceof Ol&&w.containerWidget.sectionIndex!==b.containerWidget.sectionIndex){u=this.createSection(w.containerWidget),this.document[ee[this.keywordIndex]].push(u);I=this.createParagraph(w);u[Go[this.keywordIndex]].push(I),b=w,w=this.writeParagraph(b,I,u[Go[this.keywordIndex]],t.indexInOwner,i)}else b=w,w=this.writeBlock(w,0,u[Go[this.keywordIndex]]),this.isPartialExport&&(w=this.getNextBlock(w,b),u=this.document[ee[this.keywordIndex]][this.document[ee[this.keywordIndex]].length-1])}}}else if(this.isExport=!0,this.documentHelper.pages.length>0){var T=this.documentHelper.pages[0];this.writePage(T)}else this.serializeMinimal();this.document[se[this.keywordIndex]]=((l={})[or[this.keywordIndex]]=this.documentHelper.backgroundColor,l),this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.writeImages(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper);var H=this.document;return this.clear(),H},e.prototype.serializeMinimal=function(){var e={};e[es[this.keywordIndex]]={},e[Go[this.keywordIndex]]=[];var t={};t[Qr[this.keywordIndex]]=[],e[Go[this.keywordIndex]].push(t),e[$o[this.keywordIndex]]={},this.document[ee[this.keywordIndex]].push(e)},e.prototype.getNextBlock=function(e,t){if((0,a.isNullOrUndefined)(e)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t))if((e=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==e.bodyWidget.index){var i=this.createSection(e.bodyWidget);this.document[ee[this.keywordIndex]].push(i)}else e=void 0;return e},e.prototype.Initialize=function(){this.lists=[],this.images=[],this.document={},this.document.optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,this.document[ee[this.keywordIndex]]=[],this.document[ie[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.characterFormat,this.keywordIndex),this.document[ne[this.keywordIndex]]=this.writeParagraphFormat(this.documentHelper.paragraphFormat,this.keywordIndex),(0,a.isNullOrUndefined)(this.documentHelper.fontSubstitutionTable)||(this.document[te[this.keywordIndex]]=this.writeFontSubsitutionTable(this.documentHelper)),this.document[Ee[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.themeFontLanguage,this.keywordIndex),this.document[ce[this.keywordIndex]]=this.documentHelper.defaultTabWidth,this.document[ue[this.keywordIndex]]=Pa.getBoolInfo(this.owner.enableTrackChanges,this.keywordIndex),this.document[me[this.keywordIndex]]=Pa.getBoolInfo(this.documentHelper.isDocumentProtected,this.keywordIndex),this.document[fe[this.keywordIndex]]=this.documentHelper.hashValue,this.document[ve[this.keywordIndex]]=this.documentHelper.saltValue,this.document[pe[this.keywordIndex]]=Pa.getBoolInfo(this.documentHelper.restrictFormatting,this.keywordIndex),this.document[ge[this.keywordIndex]]=1==this.keywordIndex?this.getProtectionTypeEnumValue(this.documentHelper.protectionType):this.documentHelper.protectionType,this.document[Ie[this.keywordIndex]]=Pa.getBoolInfo(this.documentHelper.dontUseHtmlParagraphAutoSpacing,this.keywordIndex),this.document[Fe[this.keywordIndex]]=Pa.getBoolInfo(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading,this.keywordIndex),this.document[He[this.keywordIndex]]=1==this.keywordIndex?this.getCompatibilityModeEnumValue(this.documentHelper.compatibilityMode):this.documentHelper.compatibilityMode,this.document[Ys[this.keywordIndex]]=Pa.getBoolInfo(this.documentHelper.allowSpaceOfSameStyleInTable,this.keywordIndex),this.documentHelper.hasThemes&&(this.document[Ne[this.keywordIndex]]=this.writeThemes(this.documentHelper.themes))},e.prototype.writeFontSubsitutionTable=function(e){for(var t={},i=0;i<e.fontSubstitutionTable.length;i++){var n=e.fontSubstitutionTable.keys[i];t[n]=this.documentHelper.fontSubstitutionTable.get(n)}return t},e.prototype.writePage=function(e){if(e.bodyWidgets.length>0){var t=e.bodyWidgets[0];do{t=this.writeBodyWidget(t,0)}while(!(0,a.isNullOrUndefined)(t))}return this.document},e.prototype.writeBodyWidget=function(e,t){if(e instanceof Ol){var i=this.createSection(e);this.document[ee[this.keywordIndex]].push(i),this.writeHeaderFooters(this.documentHelper.headersFooters[e.index],i);var n=e.childWidgets[t];(0,a.isNullOrUndefined)(n)&&e.nextRenderedWidget&&(n=e.nextRenderedWidget.childWidgets[t]);do{n=this.writeBlock(n,0,i[Go[this.keywordIndex]])}while(n);var r=e;do{e=r,r=r.nextRenderedWidget,!(0,a.isNullOrUndefined)(r)||(0,a.isNullOrUndefined)(e.page.nextPage)||(0,a.isNullOrUndefined)(e.page.nextPage)||(r=e.page.nextPage.bodyWidgets[0])}while(r instanceof Ol&&r.index===e.index);return r}},e.prototype.writeHeaderFooters=function(e,t){if(!(0,a.isNullOrUndefined)(e)){var i=t[$o[this.keywordIndex]];(0,a.isNullOrUndefined)(e[0])||e[0].isEmpty||(i[Ko[this.keywordIndex]]=this.writeHeaderFooter(e[0]),"{}"==JSON.stringify(i[Ko[this.keywordIndex]])&&delete i[Ko[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[1])||e[1].isEmpty||(i[Xo[this.keywordIndex]]=this.writeHeaderFooter(e[1]),"{}"==JSON.stringify(i[Xo[this.keywordIndex]])&&delete i[Xo[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[2])||e[2].isEmpty||(i[Zo[this.keywordIndex]]=this.writeHeaderFooter(e[2]),"{}"==JSON.stringify(i[Zo[this.keywordIndex]])&&delete i[Zo[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[3])||e[3].isEmpty||(i[Jo[this.keywordIndex]]=this.writeHeaderFooter(e[3]),"{}"==JSON.stringify(i[Jo[this.keywordIndex]])&&delete i[Jo[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[4])||e[4].isEmpty||(i[Yo[this.keywordIndex]]=this.writeHeaderFooter(e[4]),"{}"==JSON.stringify(i[Yo[this.keywordIndex]])&&delete i[Yo[this.keywordIndex]]),(0,a.isNullOrUndefined)(e[5])||e[5].isEmpty||(i[Qo[this.keywordIndex]]=this.writeHeaderFooter(e[5]),"{}"==JSON.stringify(i[Qo[this.keywordIndex]])&&delete i[Qo[this.keywordIndex]])}},e.prototype.writeHeaderFooter=function(e){if(!(0,a.isNullOrUndefined)(e)&&!e.isEmpty){var t={};if(e&&e.childWidgets&&e.childWidgets.length>0){t[Go[this.keywordIndex]]=[];var i=e.firstChild;do{i=this.writeBlock(i,0,t[Go[this.keywordIndex]])}while(i)}return t}},e.prototype.createSection=function(e){var t={};return t[es[this.keywordIndex]]={},t[es[this.keywordIndex]]=this.writeSectionFormat(e.sectionFormat,t[es[this.keywordIndex]],this.keywordIndex),t[Go[this.keywordIndex]]=[],t[$o[this.keywordIndex]]={},t},e.prototype.writeSectionFormat=function(e,t,i){if(t[Dt[i]]=e.pageWidth,t[Rt[i]]=e.pageHeight,t[Mt[i]]=e.leftMargin,t[At[i]]=e.rightMargin,t[Ut[i]]=e.topMargin,t[Vt[i]]=e.bottomMargin,t[Wt[i]]=e.headerDistance,t[Ot[i]]=e.footerDistance,t[Bt[i]]=Pa.getBoolInfo(e.differentFirstPage,i),t[Lt[i]]=Pa.getBoolInfo(e.differentOddAndEvenPages,i),t[Ye[i]]=Pa.getBoolInfo(e.bidi,i),(0,a.isNullOrUndefined)(e.breakCode)||(t[ti[i]]=e.breakCode),e.restartPageNumbering&&(t[zt[i]]=Pa.getBoolInfo(e.restartPageNumbering,i),t[qt[i]]=e.pageStartingNumber),t[_t[i]]=1==i?this.getFootEndNoteNumberFormatEnumValue(e.endnoteNumberFormat):e.endnoteNumberFormat,t[jt[i]]=1==i?this.getFootEndNoteNumberFormatEnumValue(e.footNoteNumberFormat):e.footNoteNumberFormat,t[Gt[i]]=1==i?this.getFootnoteRestartIndexEnumValue(e.restartIndexForFootnotes):e.restartIndexForFootnotes,t[Kt[i]]=1==i?this.getFootnoteRestartIndexEnumValue(e.restartIndexForEndnotes):e.restartIndexForEndnotes,t[Xt[i]]=e.initialFootNoteNumber,t[Zt[i]]=e.initialEndNoteNumber,(0,a.isNullOrUndefined)(e.pageNumberStyle)||(t[Jt[i]]=e.pageNumberStyle),!(0,a.isNullOrUndefined)(e.columns)&&!(0,a.isNullOrUndefined)(e.numberOfColumns&&e.numberOfColumns>1)){var n=e.columns;t[Qt[i]]=e.numberOfColumns,t[$t[i]]=Pa.getBoolInfo(e.equalWidth,i),t[ei[i]]=Pa.getBoolInfo(e.lineBetweenColumns,i),t[Yt[i]]=[];for(var r=0;r<n.length;r++){var o={};o[zn[i]]=Pa.convertPixelToPoint(n[r].width),o[Hs[i]]=Pa.convertPixelToPoint(n[r].space),t[Yt[i]].push(o)}}return t},e.prototype.writeBlock=function(e,t,i){if(e instanceof Ll){if(e instanceof Rl){if(e.hasOwnProperty("contentControlProperties")&&e.contentControlProperties&&"BuildingBlockGallery"!==e.contentControlProperties.type){var n=this.blockContentControl(e);return this.blockContent=!1,(0,a.isNullOrUndefined)(n)||!this.isBlockClosed&&this.nestedBlockContent||(this.nestedBlockEnabled=!1,i.push(n),this.blocks=[]),this.nextBlock}var r=this.createParagraph(e);return i.push(r),this.writeParagraph(e,r,i)}var o=e;if(o.hasOwnProperty("contentControlProperties")&&o.contentControlProperties&&"BuildingBlockGallery"!==o.contentControlProperties.type){n=this.tableContentControl(o);return!(0,a.isNullOrUndefined)(n)&&this.isBlockClosed&&i.push(n),this.nextBlock}var s=this.createTable(o);return i.push(s),this.writeTable(o,s,0,i)}},e.prototype.writeParagraphs=function(e){var t=this.blocks,i=e.childWidgets[0],n=i.children[0],r=i.children[1];if((n instanceof md||r instanceof md)&&(n=i.children[2],r=i.children[3]),this.nestedBlockEnabled&&(t=[]),n instanceof id&&r instanceof id&&!this.nestedBlockContent||this.blockContent&&n instanceof id&&!this.nestedBlockContent){var o=!1;if(r instanceof id&&"Block"===r.contentControlWidgetType&&(o=!0),o||this.blockContent&&n instanceof id&&!this.nestedBlockContent&&0===n.type&&r instanceof id&&"Block"===n.contentControlWidgetType){this.nestedBlockContent=!0,this.nestedBlockEnabled=!0;var s=this.blockContentControl(e);(0,a.isNullOrUndefined)(s)||this.blocks.push(s)}else{var l=this.createParagraph(e);t.push(l),this.nextBlock=this.writeParagraph(e,l,t)}}else{l=this.createParagraph(e);t.push(l),this.nextBlock=this.writeParagraph(e,l,t)}return!this.nestedBlockContent&&this.nestedBlockEnabled&&(this.nestedBlockEnabled=!1),t},e.prototype.contentControlProperty=function(e,t){(0,a.isNullOrUndefined)(t)&&(t=this.keywordIndex);var i={},n=[];if(i[eo[t]]=Pa.getBoolInfo(e.lockContentControl,t),i[to[t]]=Pa.getBoolInfo(e.lockContents,t),i[io[t]]=e.tag,i[or[t]]=e.color,i[no[t]]=e.title,(0,a.isNullOrUndefined)(e.appearance)||(i[Zs[t]]=1==t?this.getContentControlAppearanceEnumValue(e.appearance):e.appearance),i[Ms[t]]=1==t?this.getContentControlTypeEnumValue(e.type):e.type,i[ro[t]]=Pa.getBoolInfo(e.hasPlaceHolderText,t),i[oo[t]]=Pa.getBoolInfo(e.multiline,t),i[so[t]]=Pa.getBoolInfo(e.isTemporary,t),(0,a.isNullOrUndefined)(e.isChecked)||(i[po[t]]=Pa.getBoolInfo(e.isChecked,t)),(0,a.isNullOrUndefined)(e.uncheckedState)||(i[uo[t]]=this.tounCheckedState(e.uncheckedState)),(0,a.isNullOrUndefined)(e.checkedState)||(i[go[t]]=this.toCheckedState(e.checkedState)),(0,a.isNullOrUndefined)(e.dateCalendarType)||(i[ao[t]]=1==t?this.getDateCalendarTypeEnumValue(e.dateCalendarType):e.dateCalendarType),(0,a.isNullOrUndefined)(e.dateStorageFormat)||(i[lo[t]]=1==t?this.getDateStorageFormatEnumValue(e.dateStorageFormat):e.dateStorageFormat),(0,a.isNullOrUndefined)(e.dateDisplayLocale)||(i[ho[t]]=e.dateDisplayLocale),(0,a.isNullOrUndefined)(e.dateDisplayFormat)||(i[co[t]]=e.dateDisplayFormat),!(0,a.isNullOrUndefined)(e.xmlMapping)){var r={},o={};r[bo[t]]=Pa.getBoolInfo(e.xmlMapping.isMapped,t),r[Co[t]]=Pa.getBoolInfo(e.xmlMapping.isWordMl,t),(0,a.isNullOrUndefined)(e.xmlMapping.prefixMapping)||(r[xo[t]]=e.xmlMapping.prefixMapping),r[Io[t]]=e.xmlMapping.xPath,r[ko[t]]=e.xmlMapping.storeItemId,(0,a.isNullOrUndefined)(e.xmlMapping.customXmlPart)||(o[Po[t]]=e.xmlMapping.customXmlPart.id,o[Kr[t]]=e.xmlMapping.customXmlPart.xml,r[Fo[t]]=o),i[fo[t]]=r}if((0,a.isNullOrUndefined)(e.characterFormat)||(i[ie[t]]=this.writeCharacterFormat(e.characterFormat,t)),!(0,a.isNullOrUndefined)(e.contentControlListItems))for(var s=0;s<e.contentControlListItems.length;s++){var l={};l[wo[t]]=e.contentControlListItems[s].displayText,l[yo[t]]=e.contentControlListItems[s].value,n.push(l)}return i[mo[t]]=n,i},e.prototype.tounCheckedState=function(e){var t={};return t[vo[this.keywordIndex]]=e.font,t[yo[this.keywordIndex]]=e.value,t},e.prototype.toCheckedState=function(e){var t={};return t[vo[this.keywordIndex]]=e.font,t[yo[this.keywordIndex]]=e.value,t},e.prototype.blockContentControl=function(e){var t={};if(0!==e.childWidgets.length){if(this.isBlockClosed||!this.nestedBlockContent||(0,a.isNullOrUndefined)(e.associatedCell)||(0,a.isNullOrUndefined)(e.associatedCell.ownerTable)||(0,a.isNullOrUndefined)(e.associatedCell.ownerTable.contentControlProperties)||(this.nestedBlockEnabled=!0),t[Go[this.keywordIndex]]=this.writeParagraphs(e),(0,a.isNullOrUndefined)(this.nextBlock))this.isBlockClosed=!0;else{if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.nestedBlockContent=!0,this.blocks=t[Go[this.keywordIndex]];this.isBlockClosed=!0}if(!(0,a.isNullOrUndefined)(t[Go[this.keywordIndex]])){var i=e.childWidgets[0],n=i.children[0],r=i.children[1];if((n instanceof md||r instanceof md)&&(n=i.children[2],r=i.children[3]),n instanceof id&&r instanceof id&&!this.nestedBlockContent||this.blockContent&&n instanceof id&&!this.nestedBlockContent){if(!(r instanceof id))return t[$r[this.keywordIndex]]=this.contentControlProperty(n.contentControlProperties),t;"Block"===r.contentControlWidgetType?t[$r[this.keywordIndex]]=this.contentControlProperty(r.contentControlProperties):t[$r[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)}else t[$r[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties);return t}}else this.nextBlock=e.nextWidget},e.prototype.tableContentControl=function(e){var t={};if(t[Go[this.keywordIndex]]=this.tableContentControls(e),!(0,a.isNullOrUndefined)(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.blocks=t[Go[this.keywordIndex]];this.isBlockClosed=!0}return t[$r[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t},e.prototype.tableContentControls=function(e){var t=[];this.isBlockClosed||(t=this.blocks);var i=this.createTable(e);return t.push(i),this.nextBlock=this.writeTable(e,i,0,t),t},e.prototype.writeParagraph=function(e,t,i,n,r){(0,a.isNullOrUndefined)(n)&&(n=0),(0,a.isNullOrUndefined)(r)&&(r=0);for(var o=e;o instanceof Rl;){if(this.writeLines(o,n,r,t[Qr[this.keywordIndex]]))return void(this.endLine!==o.lastChild||this.endOffset!==this.owner.selection.getLineLength(o.lastChild)+1||-1!==o.paragraphFormat.listFormat.listId||this.isContentControl||i.push(this.createParagraph(o)));n=0,r=0,o=(e=o).nextSplitWidget}if(o=e.nextRenderedWidget,"Continuous"!==this.documentHelper.owner.layoutType&&(0,a.isNullOrUndefined)(o)&&e.containerWidget instanceof Ol&&!(0,a.isNullOrUndefined)(e.containerWidget.page)&&!(0,a.isNullOrUndefined)(e.containerWidget.page.nextPage)&&!(0,a.isNullOrUndefined)(e.containerWidget.page.nextPage.bodyWidgets)&&(o=e.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),this.isExport){var s=o instanceof Ll&&e.containerWidget.index===o.containerWidget.index,l=o instanceof Ll&&o.containerWidget instanceof Vl;return s||l?o:void 0}return o},e.prototype.writeInlines=function(e,t,i){this.contentInline=[];for(var n=t,r=!1,o=0;o<n.children.length;o++){var s=n.children[o];if(this.isExport&&this.checkboxOrDropdown){if(r&&s instanceof Zl)continue;s instanceof _l&&2===s.fieldType&&(r=!0)}if(!(s instanceof md))if(s instanceof Yl)i.push(this.writeInlinesFootNote(s));else{if(s instanceof id||this.startContent&&!this.blockContent)this.writeInlinesContentControl(s,t,i,o);else if(s instanceof Zl&&!(0,a.isNullOrUndefined)(s.previousNode)&&s.previousNode instanceof Zl&&!this.isSpecialCharacter(s.text)&&!this.isSpecialCharacter(s.previousNode.text)&&s.previousNode.characterFormat.isEqualFormat(s.characterFormat)&&s.previousNode.scriptType===s.scriptType&&0===s.revisions.length&&0===s.previousNode.revisions.length&&s.previousNode.text.length>0&&"-"!==s.previousNode.text[s.previousNode.text.length-1]&&i.length>0){var l=s.text;this.isWriteEndFootNote||!(0,a.isNullOrUndefined)(this.owner.editorModule)&&this.owner.editorModule.isPaste||(l=Pa.removeInvalidXmlChars(l)),this.isWriteInlinesFootNote&&0===s.indexInOwner&&0===s.line.indexInOwner&&0==s.paragraph.indexInOwner&&Pa.checkTextFormat(l)&&(l=""),-1!==l.indexOf(String.fromCharCode(30))?l.replace(/\u001e/g,"-"):-1!==l.indexOf(String.fromCharCode(31))&&l.replace(/\u001f/g,""),i[i.length-1][Dn[this.keywordIndex]]+=l}else{var d=this.writeInline(s);(0,a.isNullOrUndefined)(d)||i.push(d)}this.isExport&&s instanceof _l&&1===s.fieldType&&(r=!1,this.checkboxOrDropdown=!1)}}},e.prototype.isSpecialCharacter=function(e){return-1!==["\t","\v","\f","\r",String.fromCharCode(14),String.fromCharCode(31),String.fromCharCode(8194)].indexOf(e)||-1!==["%02","%03","%04"].indexOf(encodeURI(e))},e.prototype.inlineContentControl=function(e,t,i){var n={},r=[];if((0,a.isNullOrUndefined)(i))if(this.nestedContent){n[Qr[this.keywordIndex]]=this.inlineContentControls(e,void 0,r);o=this.nestedContentProperty(t,n);(0,a.isNullOrUndefined)(o)&&!this.multipleLineContent||(this.contentInline.push(n),r=[])}else n[Qr[this.keywordIndex]]=this.inlineContentControls(e,this.contentInline);else if(this.nestedContent){null==(i=i[i.length-1][Qr[this.keywordIndex]])[i.length-1][Qr[this.keywordIndex]]&&(i[i.length-1][Qr[this.keywordIndex]]=[]),n=this.inlineContentControls(e,i[i.length-1][Qr[this.keywordIndex]]);var o=this.nestedContentProperty(t,i[i.length-1]);(0,a.isNullOrUndefined)(o)||(this.contentInline.push(n),r=[])}else this.inlineContentControls(e,i[i.length-1][Qr[this.keywordIndex]]);return t instanceof id&&1===t.type&&!this.nestedContent?this.multipleLineContent&&!(0,a.isNullOrUndefined)(i)?(i[i.length-1][$r[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),void(this.multipleLineContent=!1)):(n[$r[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),n):this.startContent?(this.multipleLineContent=!0,n):void 0},e.prototype.nestedContentProperty=function(e,t,i){if((0,a.isNullOrUndefined)(e)){if(this.startContent)return this.multipleLineContent=!0,t}else{if(1===e.type)return t[$r[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t;if(this.startContent)return this.multipleLineContent=!0,t}},e.prototype.inlineContentControls=function(e,t,i){var n=this.writeInline(e);return(0,a.isNullOrUndefined)(i)?(t.push(n),t):(i.push(n),i)},e.prototype.writeInline=function(e){var t={};if(e.removedIds.length>0)for(var i=0;i<e.removedIds.length;i++)e.revisions[i]=this.documentHelper.revisionsInternal.get(e.removedIds[i]);if(t[ie[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex),e instanceof _l)t[Cr[this.keywordIndex]]=e.fieldType,0===e.fieldType&&(t[wr[this.keywordIndex]]=e.hasFieldEnd,e.formFieldData&&(t[br[this.keywordIndex]]={},t[br[this.keywordIndex]][We[this.keywordIndex]]=e.formFieldData.name,t[br[this.keywordIndex]][Ir[this.keywordIndex]]=Pa.getBoolInfo(e.formFieldData.enabled,this.keywordIndex),t[br[this.keywordIndex]][kr[this.keywordIndex]]=e.formFieldData.helpText,t[br[this.keywordIndex]][Fr[this.keywordIndex]]=e.formFieldData.statusText,e.formFieldData instanceof Gl?(t[br[this.keywordIndex]][Pr[this.keywordIndex]]={},t[br[this.keywordIndex]][Pr[this.keywordIndex]][Ms[this.keywordIndex]]=1==this.keywordIndex?this.getTextFormFieldTypeEnumValue(e.formFieldData.type):e.formFieldData.type,t[br[this.keywordIndex]][Pr[this.keywordIndex]][Hr[this.keywordIndex]]=e.formFieldData.maxLength,t[br[this.keywordIndex]][Pr[this.keywordIndex]][Er[this.keywordIndex]]=e.formFieldData.defaultValue,t[br[this.keywordIndex]][Pr[this.keywordIndex]][Nr[this.keywordIndex]]=1==this.keywordIndex&&"Text"===e.formFieldData.type?this.getTextFormFieldFormatEnumValue(e.formFieldData.format):e.formFieldData.format):e.formFieldData instanceof Kl?(t[br[this.keywordIndex]][Sr[this.keywordIndex]]={},this.checkboxOrDropdown=!0,t[br[this.keywordIndex]][Sr[this.keywordIndex]][Wr[this.keywordIndex]]=1==this.keywordIndex?this.getCheckBoxSizeTypeEnumValue(e.formFieldData.sizeType):e.formFieldData.sizeType,t[br[this.keywordIndex]][Sr[this.keywordIndex]][Or[this.keywordIndex]]=e.formFieldData.size,t[br[this.keywordIndex]][Sr[this.keywordIndex]][Er[this.keywordIndex]]=Pa.getBoolInfo(e.formFieldData.defaultValue,this.keywordIndex),t[br[this.keywordIndex]][Sr[this.keywordIndex]][Br[this.keywordIndex]]=Pa.getBoolInfo(e.formFieldData.checked,this.keywordIndex)):(t[br[this.keywordIndex]][Tr[this.keywordIndex]]={},this.checkboxOrDropdown=!0,t[br[this.keywordIndex]][Tr[this.keywordIndex]][Lr[this.keywordIndex]]=e.formFieldData.dropdownItems,t[br[this.keywordIndex]][Tr[this.keywordIndex]][Dr[this.keywordIndex]]=e.formFieldData.selectedIndex))),e.fieldCodeType&&""!==e.fieldCodeType&&(t.fieldCodeType=e.fieldCodeType);else if(e instanceof yd)this.writeChart(e,t);else if(e instanceof gd)t[lr[this.keywordIndex]]=e.imageString,this.images.push(parseInt(e.imageString,10)),t[dr[this.keywordIndex]]=e.metaFileImageString,t[pr[this.keywordIndex]]=Pa.getBoolInfo(e.isMetaFile,this.keywordIndex),t[ta[this.keywordIndex]]=e.isCompressed,t[zn[this.keywordIndex]]=Pa.convertPixelToPoint(e.width),t[qn[this.keywordIndex]]=Pa.convertPixelToPoint(e.height),e.isCrop&&(t[gr[this.keywordIndex]]=e.bottom,t[mr[this.keywordIndex]]=e.right,t[fr[this.keywordIndex]]=e.left,t[ur[this.keywordIndex]]=e.top,t[yr[this.keywordIndex]]=e.cropWidthScale,t[vr[this.keywordIndex]]=e.cropHeightScale),t[We[this.keywordIndex]]=e.name,t[Mn[this.keywordIndex]]=e.alternateText,t[no[this.keywordIndex]]=e.title,t[An[this.keywordIndex]]=Pa.getBoolInfo(e.visible,this.keywordIndex),t[_n[this.keywordIndex]]=e.widthScale,t[jn[this.keywordIndex]]=e.heightScale,t[zo[this.keywordIndex]]=Pa.convertPixelToPoint(e.verticalPosition),t[Vo[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[oi[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[jo[this.keywordIndex]]=Pa.convertPixelToPoint(e.horizontalPosition),t[qo[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[_o[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[Do[this.keywordIndex]]=Pa.getBoolInfo(e.allowOverlap,this.keywordIndex),t[Xn[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[Zn[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[Un[this.keywordIndex]]=Pa.getBoolInfo(e.isBelowText,this.keywordIndex),(0,a.isNullOrUndefined)(e.distanceBottom)||(t[Uo[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceBottom)),(0,a.isNullOrUndefined)(e.distanceLeft)||(t[Ao[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceLeft)),(0,a.isNullOrUndefined)(e.distanceRight)||(t[Mo[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceRight)),(0,a.isNullOrUndefined)(e.distanceTop)||(t[Ro[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceTop)),t[tr[this.keywordIndex]]=Pa.getBoolInfo(e.layoutInCell,this.keywordIndex),t[er[this.keywordIndex]]=e.zOrderPosition;else if(e instanceof td){if(t[fs[this.keywordIndex]]=e.bookmarkType,t[We[this.keywordIndex]]=e.name,!(0,a.isNullOrUndefined)(e.properties)){var n={};(0,a.isNullOrUndefined)(e.properties.isAfterParagraphMark)||(n[ra[this.keywordIndex]]=Pa.getBoolInfo(e.properties.isAfterParagraphMark,this.keywordIndex)),(0,a.isNullOrUndefined)(e.properties.isAfterTableMark)||(n[da[this.keywordIndex]]=Pa.getBoolInfo(e.properties.isAfterTableMark,this.keywordIndex)),(0,a.isNullOrUndefined)(e.properties.isAfterRowMark)||(n[sa[this.keywordIndex]]=Pa.getBoolInfo(e.properties.isAfterRowMark,this.keywordIndex)),(0,a.isNullOrUndefined)(e.properties.isAfterCellMark)||(n[oa[this.keywordIndex]]=Pa.getBoolInfo(e.properties.isAfterCellMark,this.keywordIndex)),(0,a.isNullOrUndefined)(e.properties.columnFirst)||(n[ks[this.keywordIndex]]=e.properties.columnFirst),(0,a.isNullOrUndefined)(e.properties.columnLast)||(n[Fs[this.keywordIndex]]=e.properties.columnLast),t[vs[this.keywordIndex]]=n}}else if(e instanceof zd)t[$e[this.keywordIndex]]=1==this.keywordIndex?Pa.getBreakClearType(e.breakClearType):e.breakClearType;else if(e instanceof Yl)t=this.writeInlinesFootNote(e);else if(e instanceof Zl){var r=e.text;if(this.isWriteEndFootNote||!(0,a.isNullOrUndefined)(this.owner.editorModule)&&this.owner.editorModule.isPaste||(r=Pa.removeInvalidXmlChars(r)),this.isWriteInlinesFootNote&&0===e.indexInOwner&&0===e.line.indexInOwner&&0==e.paragraph.indexInOwner&&Pa.checkTextFormat(r)&&(r=""),-1!==r.indexOf(String.fromCharCode(30)))t[Dn[this.keywordIndex]]=r.replace(/\u001e/g,"-");else if(-1!==r.indexOf(String.fromCharCode(31)))t[Dn[this.keywordIndex]]=r.replace(/\u001f/g,"");else if(e instanceof _d)t[Dn[this.keywordIndex]]="";else if(0!==e.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)t[Dn[this.keywordIndex]]=r;else{this.copyWithTrackChange=!0;for(var o=0;o<e.revisions.length;o++){var s=e.revisions[o];-1===this.selectedRevisionId.indexOf(s.revisionID)&&this.selectedRevisionId.push(s.revisionID),"Deletion"!==e.revisions[o].revisionType&&(t[Dn[this.keywordIndex]]=r)}}else t[Dn[this.keywordIndex]]=r}else if(e instanceof vd)""!==e.user&&(t[Ps[this.keywordIndex]]=e.user),t[Ss[this.keywordIndex]]=e.group,t[ks[this.keywordIndex]]=e.columnFirst,t[Fs[this.keywordIndex]]=e.columnLast,t[Is[this.keywordIndex]]=e.editRangeId.toString();else if(e instanceof fd)t[Ts[this.keywordIndex]]={},t[Ts[this.keywordIndex]][Ps[this.keywordIndex]]=e.editRangeStart.user,t[Ts[this.keywordIndex]][Ss[this.keywordIndex]]=e.editRangeStart.group,t[Ts[this.keywordIndex]][ks[this.keywordIndex]]=e.editRangeStart.columnFirst,t[Ts[this.keywordIndex]][Fs[this.keywordIndex]]=e.editRangeStart.columnLast,t[Is[this.keywordIndex]]=e.editRangeId.toString();else if(e instanceof Bd){if(!this.iscontentInsert)return;this.isExport||0!==e.commentType||this.selectedCommentsId.push(e.commentId),t[Mr[this.keywordIndex]]=e.commentType,t[Rr[this.keywordIndex]]=e.commentId}else e instanceof hd?this.writeShape(e,t):t=void 0;return this.writeInlineRevisions(t,e),t},e.prototype.writeInlineRevisions=function(e,t){if(t.revisions.length>0&&(this.isExport||!this.isExport&&!this.owner.enableTrackChanges)){e[dt[this.keywordIndex]]=[];for(var i=0;i<t.revisions.length;i++)-1===this.selectedRevisionId.indexOf(t.revisions[i].revisionID)&&this.selectedRevisionId.push(t.revisions[i].revisionID),e[dt[this.keywordIndex]].push(t.revisions[i].revisionID)}},e.prototype.writeShape=function(e,t){if(t[Rn[this.keywordIndex]]=e.shapeId,t[We[this.keywordIndex]]=e.name,t[Mn[this.keywordIndex]]=e.alternateText,t[no[this.keywordIndex]]=e.title,t[An[this.keywordIndex]]=Pa.getBoolInfo(e.visible,this.keywordIndex),t[zn[this.keywordIndex]]=Pa.convertPixelToPoint(e.width),t[qn[this.keywordIndex]]=Pa.convertPixelToPoint(e.height),e.isZeroHeight?t[qn[this.keywordIndex]]=0:t[qn[this.keywordIndex]]=Pa.convertPixelToPoint(e.height),t[_n[this.keywordIndex]]=e.widthScale,t[jn[this.keywordIndex]]=e.heightScale,t[zo[this.keywordIndex]]=Pa.convertPixelToPoint(e.verticalPosition),t[Vo[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[oi[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[Jn[this.keywordIndex]]=e.verticalRelativePercent,t[jo[this.keywordIndex]]=Pa.convertPixelToPoint(e.horizontalPosition),t[qo[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[_o[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[Yn[this.keywordIndex]]=e.horizontalRelativePercent,t[Qn[this.keywordIndex]]=e.heightRelativePercent,t[$n[this.keywordIndex]]=e.widthRelativePercent,t[er[this.keywordIndex]]=e.zOrderPosition,t[Do[this.keywordIndex]]=Pa.getBoolInfo(e.allowOverlap,this.keywordIndex),t[Xn[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[Zn[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[Un[this.keywordIndex]]=Pa.getBoolInfo(e.isBelowText,this.keywordIndex),t[Vn[this.keywordIndex]]=Pa.getBoolInfo(e.isHorizontalRule,this.keywordIndex),(0,a.isNullOrUndefined)(e.distanceBottom)||(t[Uo[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceBottom)),(0,a.isNullOrUndefined)(e.distanceLeft)||(t[Ao[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceLeft)),(0,a.isNullOrUndefined)(e.distanceRight)||(t[Mo[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceRight)),(0,a.isNullOrUndefined)(e.distanceTop)||(t[Ro[this.keywordIndex]]=Pa.convertPixelToPoint(e.distanceTop)),t[tr[this.keywordIndex]]=Pa.getBoolInfo(e.layoutInCell,this.keywordIndex),t[ir[this.keywordIndex]]=Pa.getBoolInfo(e.lockAnchor,this.keywordIndex),t[nr[this.keywordIndex]]=1==this.keywordIndex?this.getAutoShapeTypeEnumValue(e.autoShapeType):e.autoShapeType,e.fillFormat&&(t[Kn[this.keywordIndex]]={},t[Kn[this.keywordIndex]][or[this.keywordIndex]]=e.fillFormat.color,t[Kn[this.keywordIndex]][sr[this.keywordIndex]]=Pa.getBoolInfo(e.fillFormat.fill,this.keywordIndex)),e.lineFormat&&(t[Gn[this.keywordIndex]]={},t[Gn[this.keywordIndex]][Js[this.keywordIndex]]=1==this.keywordIndex?this.getLineFormatTypeEnumValue(e.lineFormat.lineFormatType):e.lineFormat.lineFormatType,t[Gn[this.keywordIndex]][or[this.keywordIndex]]=e.lineFormat.color,t[Gn[this.keywordIndex]][Qs[this.keywordIndex]]=e.lineFormat.weight,t[Gn[this.keywordIndex]][Oi[this.keywordIndex]]=1==this.keywordIndex?this.getLineDashStyleEnumValue(e.lineFormat.dashStyle):e.lineFormat.dashStyle,t[Gn[this.keywordIndex]][Ui[this.keywordIndex]]=Pa.getBoolInfo(e.lineFormat.line,this.keywordIndex)),e.textFrame){t[rr[this.keywordIndex]]={},t[rr[this.keywordIndex]][ar[this.keywordIndex]]=1==this.keywordIndex?this.getTextVerticalAlignmentEnumValue(e.textFrame.textVerticalAlignment):e.textFrame.textVerticalAlignment,t[rr[this.keywordIndex]][Mt[this.keywordIndex]]=Pa.convertPixelToPoint(e.textFrame.marginLeft),t[rr[this.keywordIndex]][At[this.keywordIndex]]=Pa.convertPixelToPoint(e.textFrame.marginRight),t[rr[this.keywordIndex]][Ut[this.keywordIndex]]=Pa.convertPixelToPoint(e.textFrame.marginTop),t[rr[this.keywordIndex]][Vt[this.keywordIndex]]=Pa.convertPixelToPoint(e.textFrame.marginBottom),t[rr[this.keywordIndex]][Go[this.keywordIndex]]=[];for(var i=0;i<e.textFrame.childWidgets.length;i++){var n=e.textFrame.childWidgets[i];n.hasOwnProperty("contentControlProperties")&&!(0,a.isNullOrUndefined)(e.paragraph)&&e.paragraph.hasOwnProperty("contentControlProperties")&&(this.blocks=[]),this.writeBlock(n,0,t[rr[this.keywordIndex]][Go[this.keywordIndex]])}}},e.prototype.writeChart=function(e,t){t[Tn[this.keywordIndex]]={},t[Pn[this.keywordIndex]]={},t[Fn[this.keywordIndex]]={},t[Sn[this.keywordIndex]]={},t[In[this.keywordIndex]]=[],t[kn[this.keywordIndex]]=[],t[Hn[this.keywordIndex]]={},t[En[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[Pn[this.keywordIndex]]),this.writeChartArea(e.chartArea,t[Fn[this.keywordIndex]]),this.writeChartArea(e.chartPlotArea,t[Sn[this.keywordIndex]]),this.writeChartCategory(e,t[In[this.keywordIndex]]),this.createChartSeries(e,t[kn[this.keywordIndex]]),this.writeChartLegend(e.chartLegend,t[Tn[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryCategoryAxis,t[Hn[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryValueAxis,t[En[this.keywordIndex]]),void 0!==e.chartDataTable.showSeriesKeys&&(t[Ln[this.keywordIndex]]={},this.writeChartDataTable(e.chartDataTable,t[Ln[this.keywordIndex]])),t[Nn[this.keywordIndex]]=e.title,t[Wn[this.keywordIndex]]=e.type,t[On[this.keywordIndex]]=e.chartGapWidth,t[Bn[this.keywordIndex]]=e.chartOverlap,t[qn[this.keywordIndex]]=Pa.convertPixelToPoint(e.height),t[zn[this.keywordIndex]]=Pa.convertPixelToPoint(e.width)},e.prototype.writeChartTitleArea=function(e,t){t[ea[this.keywordIndex]]=e.chartfontName,t[Ke[this.keywordIndex]]=e.chartFontSize,t[Li[this.keywordIndex]]={},t[Di[this.keywordIndex]]=this.writeChartDataFormat(e.dataFormat),this.writeChartLayout(e.layout,t[Li[this.keywordIndex]])},e.prototype.writeChartDataFormat=function(e){var t={};return t[sr[this.keywordIndex]]={},t[Ui[this.keywordIndex]]={},(0,a.isNullOrUndefined)(e.id)||(t[Po[this.keywordIndex]]=e.id),(0,a.isNullOrUndefined)(e.fill.color)||(e.fill.color.length>6?t[sr[this.keywordIndex]][Vi[this.keywordIndex]]=e.fill.color.substring(2):t[sr[this.keywordIndex]][Vi[this.keywordIndex]]=e.fill.color),t[sr[this.keywordIndex]][Xs[this.keywordIndex]]=e.fill.rgb,t[Ui[this.keywordIndex]][or[this.keywordIndex]]=e.line.color,t[Ui[this.keywordIndex]][Xs[this.keywordIndex]]=e.line.rgb,t},e.prototype.writeChartLayout=function(e,t){t[qi[this.keywordIndex]]=e.chartLayoutLeft,t[_i[this.keywordIndex]]=e.chartLayoutTop},e.prototype.writeChartArea=function(e,t){t[Vi[this.keywordIndex]]=e.chartForeColor},e.prototype.writeChartLegend=function(e,t){t[ws[this.keywordIndex]]=e.chartLegendPostion,t[Pn[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[Pn[this.keywordIndex]])},e.prototype.writeChartCategoryAxis=function(e,t){t[Nn[this.keywordIndex]]=e.categoryAxisTitle,t[Pn[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[Pn[this.keywordIndex]]),t[xn[this.keywordIndex]]=e.categoryAxisType,t[Ke[this.keywordIndex]]=e.axisFontSize,t[ea[this.keywordIndex]]=e.axisFontName,t[ss[this.keywordIndex]]=e.categoryNumberFormat,t[Vs[this.keywordIndex]]=e.max,t[zs[this.keywordIndex]]=e.min,t[Us[this.keywordIndex]]=Pa.getBoolInfo(e.isAutoInternal,this.keywordIndex),t[As[this.keywordIndex]]=e.interval,t[qs[this.keywordIndex]]=Pa.getBoolInfo(e.majorGridLines,this.keywordIndex),t[_s[this.keywordIndex]]=Pa.getBoolInfo(e.minorGridLines,this.keywordIndex),t[js[this.keywordIndex]]=e.majorTick,t[Gs[this.keywordIndex]]=e.minorTick,t[Ks[this.keywordIndex]]=e.tickPosition},e.prototype.writeChartDataTable=function(e,t){t[yn[this.keywordIndex]]=Pa.getBoolInfo(e.showSeriesKeys,this.keywordIndex),t[wn[this.keywordIndex]]=Pa.getBoolInfo(e.hasHorzBorder,this.keywordIndex),t[bn[this.keywordIndex]]=Pa.getBoolInfo(e.hasVertBorder,this.keywordIndex),t[Cn[this.keywordIndex]]=Pa.getBoolInfo(e.hasBorders,this.keywordIndex)},e.prototype.writeChartCategory=function(e,t){var i=e.chartCategory;t[Mi[this.keywordIndex]]=[];for(var n=0;n<i.length;n++){var r=i[n],o=this.createChartCategory(r,e.chartType);t.push(o)}},e.prototype.createChartCategory=function(e,t){var i={};return i[Mi[this.keywordIndex]]=[],this.writeChartData(e,i[Mi[this.keywordIndex]],t),i[Ai[this.keywordIndex]]=e.categoryXName,i},e.prototype.writeChartData=function(e,t,i){for(var n=e.chartData,r=0;r<n.length;r++){var o=n[r],s=this.createChartData(o,i);t.push(s)}},e.prototype.createChartData=function(e,t){var i={};return i[Ri[this.keywordIndex]]=e.yValue,"Bubble"===t&&(i[Or[this.keywordIndex]]=e.size),i},e.prototype.createChartSeries=function(e,t){for(var i=e.chartSeries,n=e.chartType,r=0;r<i.length;r++){var o=i[r],s=this.writeChartSeries(o,n);t.push(s)}},e.prototype.writeChartSeries=function(e,t){var i="Pie"===t||"Doughnut"===t,n={},r={},o=e.errorBar;if(n[ln[this.keywordIndex]]=[],n[nn[this.keywordIndex]]=e.seriesName,i&&((0,a.isNullOrUndefined)(e.firstSliceAngle)||(n[dn[this.keywordIndex]]=e.firstSliceAngle),"Doughnut"===t&&(n[hn[this.keywordIndex]]=e.doughnutHoleSize)),!(0,a.isNullOrUndefined)(e.dataLabels.labelPosition)){var s=this.writeChartDataLabels(e.dataLabels);n[rn[this.keywordIndex]]=s}if(!(0,a.isNullOrUndefined)(e.seriesFormat.markerStyle)){var l={},d=e.seriesFormat;l[Xi[this.keywordIndex]]=d.markerStyle,l[Ji[this.keywordIndex]]=d.numberValue,l[Zi[this.keywordIndex]]=d.markerColor,n[sn[this.keywordIndex]]=l}if((0,a.isNullOrUndefined)(o.type)||(r[Ms[this.keywordIndex]]=o.type,r[ji[this.keywordIndex]]=o.direction,r[Gi[this.keywordIndex]]=o.endStyle,r[Ki[this.keywordIndex]]=o.numberValue,n[on[this.keywordIndex]]=r),e.trendLines.length>0){n[an[this.keywordIndex]]=[];for(var h=0;h<e.trendLines.length;h++){var c=this.writeChartTrendLines(e.trendLines[h]);n[an[this.keywordIndex]].push(c)}}for(h=0;h<e.chartDataFormat.length;h++){d=this.writeChartDataFormat(e.chartDataFormat[h]);n[ln[this.keywordIndex]].push(d)}return n},e.prototype.writeChartDataLabels=function(e){var t={};return t[ws[this.keywordIndex]]=e.position,t[ea[this.keywordIndex]]=e.fontName,t[Xe[this.keywordIndex]]=Pa.convertArgbToRgb(e.fontColor),t[Ke[this.keywordIndex]]=e.fontSize,t[cn[this.keywordIndex]]=Pa.getBoolInfo(e.isLegendKey,this.keywordIndex),t[pn[this.keywordIndex]]=Pa.getBoolInfo(e.isBubbleSize,this.keywordIndex),t[un[this.keywordIndex]]=Pa.getBoolInfo(e.isCategoryName,this.keywordIndex),t[gn[this.keywordIndex]]=Pa.getBoolInfo(e.isSeriesName,this.keywordIndex),t[mn[this.keywordIndex]]=Pa.getBoolInfo(e.isValue,this.keywordIndex),t[fn[this.keywordIndex]]=Pa.getBoolInfo(e.isPercentage,this.keywordIndex),t[vn[this.keywordIndex]]=Pa.getBoolInfo(e.isLeaderLines,this.keywordIndex),t},e.prototype.writeChartTrendLines=function(e){var t={};return t[We[this.keywordIndex]]=e.trendLineName,t[Ms[this.keywordIndex]]=e.trendLineType,t[Yi[this.keywordIndex]]=e.forwardValue,t[Qi[this.keywordIndex]]=e.backwardValue,t[$i[this.keywordIndex]]=e.interceptValue,t[tn[this.keywordIndex]]=Pa.getBoolInfo(e.isDisplayEquation,this.keywordIndex),t[en[this.keywordIndex]]=Pa.getBoolInfo(e.isDisplayRSquared,this.keywordIndex),t},e.prototype.writeLines=function(e,t,i,n){for(var r=t,o=this.endLine instanceof zl&&this.endLine.paragraph===e,s=o?this.endLine.indexInOwner:e.childWidgets.length-1,a=r;a<=s;a++){var l=e.childWidgets[a];this.endLine===l||t===a&&0!==i?(this.endLine===l&&e.paragraphFormat.bidi&&this.startLine!==this.endLine&&(this.endOffset=l.getEndOffset()),this.writeLine(l,this.startLine===this.endLine||l===this.startLine||this.isContentControl?i:0,n)):this.writeInlines(e,l,n)}return o},e.prototype.writeLine=function(e,t,i){this.contentInline=[];for(var n=e===this.endLine,r=e,o=!1,s=!1,l=0,d=0;d<r.children.length;d++){var h=r.children[d];if(!(h instanceof md)){var c=void 0;if(o=(l+=h.length)>t,s=n&&l>=this.endOffset,o)if(h instanceof id||this.startContent||this.blockContent){if(s){this.startContent=!1;break}this.writeInlinesContentControl(h,e,i,d)}else{if(c=this.writeInline(h),!(0,a.isNullOrUndefined)(c)&&(i[i.length]=c,l>t||s)){if(c.hasOwnProperty(Dn[this.keywordIndex])){var p=l-h.length,u=t-p,g=s?this.endOffset-p:h.length;c[Dn[this.keywordIndex]]=c[Dn[this.keywordIndex]].substring(u,g)}t=-1}if(s)break}}}},e.prototype.writeInlinesFootNote=function(e){this.isWriteInlinesFootNote=!0;var t={};t[Xr[this.keywordIndex]]=1==this.keywordIndex?this.getFootnoteTypeEnumValue(e.footnoteType):e.footnoteType,t[ie[this.keywordIndex]]={},t[ie[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex),t[Go[this.keywordIndex]]=[];for(var i=e.bodyWidget;i;){for(var n=0;n<i.childWidgets.length;n++)i.childWidgets[n].previousSplitWidget||this.writeBlock(i.childWidgets[n],0,t[Go[this.keywordIndex]]);if((0,a.isNullOrUndefined)(i.containerWidget)||!(i.containerWidget instanceof Dl)||"Endnote"!==i.containerWidget.footNoteType)break;i=i.nextSplitWidget}return t[Zr[this.keywordIndex]]=e.symbolCode,t[Jr[this.keywordIndex]]=e.symbolFontName,t[Yr[this.keywordIndex]]=e.customMarker,this.writeInlineRevisions(t,e),this.isWriteInlinesFootNote=!1,t},e.prototype.writeInlinesContentControl=function(e,t,i,n){if(e instanceof id&&"Block"===e.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===e.type?(this.nestedBlockContent=!0,!0):this.nestedBlockContent&&1===e.type?(this.nestedBlockContent=!1,!0):(this.blockContent=0===e.type,t.children[n-1]instanceof id&&"Block"===t.children[n-1].contentControlWidgetType&&(this.blockContent=!0),(0,a.isNullOrUndefined)(t.children[n+1]&&t.children[n+1]instanceof id)||"Inline"===t.children[n+1].contentControlWidgetType&&(this.blockContent=!1),this.blockContent||(this.isBlockClosed=!0),!0);if(e instanceof id){if(this.startContent&&0===e.type)return this.nestedContent=!0,!0;if(this.startContent&&this.nestedContent){if((s={})[Qr[this.keywordIndex]]=this.contentInline,this.contentInline.length>0){var r=this.nestedContentProperty(t.children[n+1],s);i.push(r),this.contentInline=[]}return this.multipleLineContent&&(s=i[i.length-1],this.nestedContentProperty(t.children[n+1],s),this.multipleLineContent=!1),this.nestedContent=!1,!0}return this.contentType=e.contentControlWidgetType,this.startContent=0===e.type,!0}if(this.startContent&&"Inline"===this.contentType)if(this.multipleLineContent&&!(0,a.isNullOrUndefined)(i)&&i.length>0)this.inlineContentControl(e,e.nextNode,i),this.contentInline=[];else{var o=this.inlineContentControl(e,e.nextNode);if(!(0,a.isNullOrUndefined)(o)){if(!this.nestedContent||!this.multipleLineContent)return i.push(o),this.contentInline=[],!1;(s={})[Qr[this.keywordIndex]]=this.contentInline,i.push(s),this.contentInline=[]}}else{var s=this.writeInline(e);(0,a.isNullOrUndefined)(s)||i.push(s)}},e.prototype.createParagraph=function(e){var t={},i=!1,n=!1;if(!this.documentHelper.selection||this.documentHelper.selection.isEmpty||this.isExport)i=!0;else{var r=this.documentHelper.selection.end;this.documentHelper.selection.isForward||(r=this.documentHelper.selection.start);var o=r.paragraph.childWidgets[r.paragraph.childWidgets.length-1];n=!(0,a.isNullOrUndefined)(e.paragraphFormat.listFormat.list),i=this.documentHelper.selection.isParagraphLastLine(o)&&r.currentWidget===o&&(r.offset===this.documentHelper.selection.getLineLength(o)+1||!(e.indexInOwner==r.paragraph.indexInOwner)&&n)}return t[ne[this.keywordIndex]]=this.writeParagraphFormat(i?e.paragraphFormat:new ba(e),this.keywordIndex),t[ie[this.keywordIndex]]=this.writeCharacterFormat(i?e.characterFormat:new ka(e),this.keywordIndex),t[Qr[this.keywordIndex]]=[],t},e.prototype.writeCharacterFormat=function(e,t,i){var n={};if(Pa.writeCharacterFormat(n,i,e,t),n[it[t]]=i?Pa.getBoolInfo(e.boldBidi,t):e.getValue("boldBidi"),n[nt[t]]=i?Pa.getBoolInfo(e.italicBidi,t):e.getValue("italicBidi"),e.revisions.length>0){n[dt[t]]=[];for(var r=0;r<e.revisions.length;r++)n[dt[t]].push(e.revisions[r].revisionID)}return this.writeInlineStyles&&!i&&(n[$s[t]]=this.writeCharacterFormat(e,t,!0)),n},e.prototype.writeParagraphFormat=function(e,t,i){var n={};return this.keywordIndex=(0,a.isNullOrUndefined)(this.keywordIndex)?0:this.keywordIndex,Pa.writeParagraphFormat(n,i,e,t),n[kt[t]]=this.writeListFormat(e.listFormat,i),n[Nt[t]]=this.writeTabs(e.tabs),this.writeInlineStyles&&!i&&(n[$s[t]]=this.writeParagraphFormat(e,t,!0)),n},e.prototype.writeThemes=function(e){var t={};return t[Es[this.keywordIndex]]={},t[Es[this.keywordIndex]][Ns[this.keywordIndex]]=e.fontScheme.fontSchemeName,t[Es[this.keywordIndex]][Ws[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.majorFontScheme),t[Es[this.keywordIndex]][Os[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.minorFontScheme),t},e.prototype.writeMajorMinorFontScheme=function(e){var t={};t[Bs[this.keywordIndex]]=this.writeFontSchemeList(e.fontSchemeList);for(var i={},n=0,r=e.fontTypeface.keys;n<r.length;n++){var o=r[n];i[o]=e.fontTypeface.get(o)}return t[Ls[this.keywordIndex]]=i,t},e.prototype.writeFontSchemeList=function(e){var t=this,i=[];return e.forEach((function(e){var n={};n[We[t.keywordIndex]]=e.name,n[Ds[t.keywordIndex]]=e.typeface,n[Rs[t.keywordIndex]]=e.panose,i.push(n)})),i},e.prototype.writeTabs=function(e){if(!((0,a.isNullOrUndefined)(e)||e.length<1)){for(var t=[],i=0;i<e.length;i++){var n=e[i],r={};r[ws[this.keywordIndex]]=n.position,r[bs[this.keywordIndex]]=n.deletePosition,r[ys[this.keywordIndex]]=1==this.keywordIndex?this.getTabJustificationEnumValue(n.tabJustification):n.tabJustification,r[xs[this.keywordIndex]]=1==this.keywordIndex?this.getTabLeaderEnumValue(n.tabLeader):n.tabLeader,t.push(r)}return t}},e.prototype.writeListFormat=function(e,t){var i={},n=e.getValue("listId");(0,a.isNullOrUndefined)(n)||(i[ht[this.keywordIndex]]=n,(0,a.isNullOrUndefined)(this.lists)&&(this.lists=[]),this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId));var r=e.getValue("listLevelNumber");(0,a.isNullOrUndefined)(r)||(i[ut[this.keywordIndex]]=r);var o=e.getValue("nsid");return(0,a.isNullOrUndefined)(o)||(i[ds]=o),i},e.prototype.writeTable=function(e,t,i,n){var r=e.childWidgets[i];if(!(r instanceof Ul&&this.writeRow(r,t[Eo[this.keywordIndex]]))){var o=e;do{o=(e=o).nextSplitWidget}while(o instanceof Ll);return(o=e.nextRenderedWidget)instanceof Ll&&o.containerWidget.index===e.containerWidget.index?o:void 0}},e.prototype.writeRow=function(e,t){var i=e;do{if((e=i)===(i=this.writeRowInternal(i,t)))return!0}while(i instanceof Ul);return!1},e.prototype.writeRowInternal=function(e,t){if(!(e instanceof Ul))return e;e.isCellsHaveSameWidthUnit()||e.updateUniformWidthUnitForCells();var i=this.createRow(e);t.push(i);for(var n=0;n<e.childWidgets.length;n++){var r=e.childWidgets[n];if(r instanceof Vl&&e.index===r.rowIndex&&((0,a.isNullOrUndefined)(this.startColumnIndex)||r.columnIndex>=this.startColumnIndex)&&((0,a.isNullOrUndefined)(this.endColumnIndex)||r.columnIndex<this.endColumnIndex)&&this.writeCell(r,i[Ho[this.keywordIndex]]))return e}var o=e;do{o=(e=o).nextRenderedWidget,!(0,a.isNullOrUndefined)(e.ownerTable.bodyWidget)&&o&&(e.ownerTable.index!==o.ownerTable.index&&e.ownerTable.bodyWidget.sectionIndex===o.ownerTable.bodyWidget.sectionIndex||e.ownerTable.bodyWidget.sectionIndex!==o.ownerTable.bodyWidget.sectionIndex)&&(o=void 0)}while(o instanceof Ul&&o.index===e.index);return o},e.prototype.writeCell=function(e,t){var i=this.createCell(e);t.push(i);var n=e.firstChild;do{n=this.writeBlock(n,0,i[Go[this.keywordIndex]])}while(n);return this.endCell instanceof Vl&&this.endCell.cellFormat===e.cellFormat},e.prototype.createTable=function(e){var t={};(0,a.isNullOrUndefined)(this.keywordIndex)&&(this.keywordIndex=0),t[Eo[this.keywordIndex]]=[],t[aa[this.keywordIndex]]=[];for(var i=0;i<e.tableHolder.columns.length;i++)t[aa[this.keywordIndex]][i]=e.tableHolder.columns[i].preferredWidth;return t[Lo[this.keywordIndex]]=this.writeTableFormat(e.tableFormat,this.keywordIndex),t[No[this.keywordIndex]]=e.tableFormat.description,t[no[this.keywordIndex]]=e.tableFormat.title,t[la[this.keywordIndex]]=e.tableHolder.columns.length,this.writeTablePositioning(t,e),t},e.prototype.writeTablePositioning=function(e,t){t.wrapTextAround&&(e[Wo[this.keywordIndex]]=Pa.getBoolInfo(t.wrapTextAround,this.keywordIndex),e[Bo[this.keywordIndex]]={},e[Bo[this.keywordIndex]][Do[this.keywordIndex]]=Pa.getBoolInfo(t.positioning.allowOverlap,this.keywordIndex),(0,a.isNullOrUndefined)(t.positioning.distanceBottom)||(e[Bo[this.keywordIndex]][Uo[this.keywordIndex]]=Pa.convertPixelToPoint(t.positioning.distanceBottom)),(0,a.isNullOrUndefined)(t.positioning.distanceLeft)||(e[Bo[this.keywordIndex]][Ao[this.keywordIndex]]=Pa.convertPixelToPoint(t.positioning.distanceLeft)),(0,a.isNullOrUndefined)(t.positioning.distanceRight)||(e[Bo[this.keywordIndex]][Mo[this.keywordIndex]]=Pa.convertPixelToPoint(t.positioning.distanceRight)),(0,a.isNullOrUndefined)(t.positioning.distanceTop)||(e[Bo[this.keywordIndex]][Ro[this.keywordIndex]]=Pa.convertPixelToPoint(t.positioning.distanceTop)),(0,a.isNullOrUndefined)(t.positioning.verticalAlignment)||(e[Bo[this.keywordIndex]][oi[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalPositionEnumValue(t.positioning.verticalAlignment):t.positioning.verticalAlignment),(0,a.isNullOrUndefined)(t.positioning.verticalOrigin)||(e[Bo[this.keywordIndex]][Vo[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalRelationEnumValue(t.positioning.verticalOrigin):t.positioning.verticalOrigin),e[Bo[this.keywordIndex]][zo[this.keywordIndex]]=t.positioning.verticalPosition,(0,a.isNullOrUndefined)(t.positioning.horizontalAlignment)||(e[Bo[this.keywordIndex]][_o[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalPositionEnumValue(t.positioning.horizontalAlignment):t.positioning.horizontalAlignment),(0,a.isNullOrUndefined)(t.positioning.horizontalOrigin)||(e[Bo[this.keywordIndex]][qo[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalRelationEnumValue(t.positioning.horizontalOrigin):t.positioning.horizontalOrigin),e[Bo[this.keywordIndex]][jo[this.keywordIndex]]=t.positioning.horizontalPosition)},e.prototype.createRow=function(e){var t={};return t[Ho[this.keywordIndex]]=[],t[To[this.keywordIndex]]=this.writeRowFormat(e.rowFormat,this.keywordIndex),e.hasOwnProperty("contentControlProperties")&&(t[$r[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.createCell=function(e){var t={};return t[Go[this.keywordIndex]]=[],t[So[this.keywordIndex]]=this.writeCellFormat(e.cellFormat,this.keywordIndex),t[ia[this.keywordIndex]]=e.columnIndex,e.hasOwnProperty("contentControlProperties")&&(t[$r[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.writeShading=function(e,t){var i={};return i[Fi[t]]=e.hasValue("backgroundColor")?e.backgroundColor:void 0,i[Pi[t]]=e.hasValue("foregroundColor")?e.foregroundColor:void 0,i[ki[t]]=e.hasValue("textureStyle")?1==t?this.getTextureStyleEnumValue(e.textureStyle):e.textureStyle:void 0,i},e.prototype.writeBorders=function(e,t){var i={};return i[ur[t]]=Pa.writeBorder(e.top,t),i[fr[t]]=Pa.writeBorder(e.left,t),i[mr[t]]=Pa.writeBorder(e.right,t),i[gr[t]]=Pa.writeBorder(e.bottom,t),i[Wi[t]]=Pa.writeBorder(e.diagonalDown,t),i[Ni[t]]=Pa.writeBorder(e.diagonalUp,t),i[Ei[t]]=Pa.writeBorder(e.horizontal,t),i[Hi[t]]=Pa.writeBorder(e.vertical,t),i},e.prototype.writeCellFormat=function(e,t){var i={};return i[Et[t]]=this.writeBorders(e.borders,t),i[wi[t]]=this.writeShading(e.shading,t),i[Ut[t]]=e.hasValue("topMargin")?e.topMargin:void 0,i[At[t]]=e.hasValue("rightMargin")?e.rightMargin:void 0,i[Mt[t]]=e.hasValue("leftMargin")?e.leftMargin:void 0,i[Vt[t]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,i[Ci[t]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,i[xi[t]]=e.hasValue("preferredWidthType")?1==t?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,i[ii[t]]=e.hasValue("cellWidth")?e.cellWidth:void 0,i[ni[t]]=e.columnSpan,i[ri[t]]=e.rowSpan,i[oi[t]]=e.hasValue("verticalAlignment")?1==t?this.getCellVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment:void 0,i},e.prototype.writeRowFormat=function(e,t){var i={},n=[];this.assignRowFormat(i,e,t);for(var r=0;r<e.revisions.length;r++)i[dt[t]]=this.writeRowRevisions(e.revisions[r],n);return i},e.prototype.assignRowFormat=function(e,t,i){e[qn[i]]=t.hasValue("height")?t.height:void 0,e[si[i]]=t.hasValue("allowBreakAcrossPages")?Pa.getBoolInfo(t.allowBreakAcrossPages,this.keywordIndex):void 0,e[li[i]]=t.hasValue("heightType")?1==this.keywordIndex?this.getHeighTypeEnumValue(t.heightType):t.heightType:void 0,e[ai[i]]=t.hasValue("isHeader")?Pa.getBoolInfo(t.isHeader,this.keywordIndex):void 0,e[Et[i]]=this.writeBorders(t.borders,i),e[ci[i]]=t.gridBefore,e[pi[i]]=t.hasValue("gridBeforeWidth")?t.gridBeforeWidth:void 0,e[ui[i]]=t.hasValue("gridBeforeWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(t.gridBeforeWidthType):t.gridBeforeWidthType:void 0,e[gi[i]]=t.gridAfter,e[mi[i]]=t.hasValue("gridAfterWidth")?t.gridAfterWidth:void 0,e[fi[i]]=t.hasValue("gridAfterWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(t.gridAfterWidthType):t.gridAfterWidthType:void 0,e[Mt[i]]=t.hasValue("leftMargin")?t.leftMargin:void 0,e[Ut[i]]=t.hasValue("topMargin")?t.topMargin:void 0,e[At[i]]=t.hasValue("rightMargin")?t.rightMargin:void 0,e[Vt[i]]=t.hasValue("bottomMargin")?t.bottomMargin:void 0,e[gt[i]]=t.hasValue("leftIndent")?t.leftIndent:void 0},e.prototype.writeRowRevisions=function(e,t){return-1===this.selectedRevisionId.indexOf(e.revisionID)&&this.selectedRevisionId.push(e.revisionID),t.push(e.revisionID),t},e.prototype.writeTableFormat=function(e,t){var i={};return i[Et[t]]=this.writeBorders(e.borders,t),i[wi[t]]=this.writeShading(e.shading,t),i[yi[t]]=e.hasValue("cellSpacing")?e.cellSpacing:void 0,i[gt[t]]=e.hasValue("leftIndent")?e.leftIndent:void 0,i[bi[t]]=e.hasValue("tableAlignment")?1==this.keywordIndex?this.getTableAlignmentEnumValue(e.tableAlignment):e.tableAlignment:void 0,i[Ut[t]]=e.hasValue("topMargin")?e.topMargin:void 0,i[At[t]]=e.hasValue("rightMargin")?e.rightMargin:void 0,i[Mt[t]]=e.hasValue("leftMargin")?e.leftMargin:void 0,i[Vt[t]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,i[Ci[t]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,i[xi[t]]=e.hasValue("preferredWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,i[Ye[t]]=e.hasValue("bidi")?Pa.getBoolInfo(e.bidi,this.keywordIndex):void 0,i[vi[t]]=e.hasValue("allowAutoFit")?Pa.getBoolInfo(e.allowAutoFit,this.keywordIndex):void 0,i[Je[t]]=(0,a.isNullOrUndefined)(e.styleName)?void 0:e.styleName,i},e.prototype.footnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<e.footnotes.separator.length;t++)this.seprators(e);this.isWriteEndFootNote=!1},e.prototype.seprators=function(e){if(e.footnotes.separator.length>0){this.document[Se[this.keywordIndex]]={},this.document[Se[this.keywordIndex]][us[this.keywordIndex]]=[];for(var t=0;t<e.footnotes.separator.length;t++)this.writeBlock(e.footnotes.separator[t],0,this.document[Se[this.keywordIndex]][us[this.keywordIndex]])}if(e.footnotes.continuationSeparator.length>0){this.document[Se[this.keywordIndex]][gs[this.keywordIndex]]=[];for(t=0;t<e.footnotes.continuationSeparator.length;t++)this.writeBlock(e.footnotes.continuationSeparator[t],0,this.document[Se[this.keywordIndex]][gs[this.keywordIndex]])}if(e.footnotes.continuationNotice.length>0){this.document[Se[this.keywordIndex]][ms[this.keywordIndex]]=[];for(t=0;t<e.footnotes.continuationNotice.length;t++)this.writeBlock(e.footnotes.continuationNotice[t],0,this.document[Se[this.keywordIndex]][ms[this.keywordIndex]])}},e.prototype.endnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(e);this.isWriteEndFootNote=!1},e.prototype.endnoteSeparator=function(e){if(e.endnotes.separator.length>0){this.document[Te[this.keywordIndex]]={},this.document[Te[this.keywordIndex]][us[this.keywordIndex]]=[];for(var t=0;t<e.endnotes.separator.length;t++)this.writeBlock(e.endnotes.separator[t],0,this.document[Te[this.keywordIndex]][us[this.keywordIndex]])}if(e.endnotes.continuationSeparator.length>0){this.document[Te[this.keywordIndex]][gs[this.keywordIndex]]=[];for(t=0;t<e.endnotes.continuationSeparator.length;t++)this.writeBlock(e.endnotes.continuationSeparator[t],0,this.document[Te[this.keywordIndex]][gs[this.keywordIndex]])}if(e.endnotes.continuationNotice.length>0){this.document[Te[this.keywordIndex]][ms[this.keywordIndex]]=[];for(t=0;t<e.endnotes.continuationNotice.length;t++)this.writeBlock(e.endnotes.continuationNotice[t],0,this.document[Te[this.keywordIndex]][ms[this.keywordIndex]])}},e.prototype.writeStyles=function(e){this.document[ae[this.keywordIndex]]=[];for(var t=0;t<e.styles.length;t++)this.document[ae[this.keywordIndex]].push(this.writeStyle(e.styles.getItem(t)))},e.prototype.writeStyle=function(e){var t={};return t[We[this.keywordIndex]]=e.name,"Paragraph"===e.type&&(t[Ms[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[ne[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat,this.keywordIndex),t[ie[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex)),"Character"===e.type&&(t[Ms[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[ie[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex)),"Table"===e.type&&(t[Ms[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type),(0,a.isNullOrUndefined)(e.basedOn)||(t[Oe[this.keywordIndex]]=e.basedOn.name),(0,a.isNullOrUndefined)(e.link)||(t[Le[this.keywordIndex]]=e.link.name),(0,a.isNullOrUndefined)(e.next)||(t[Be[this.keywordIndex]]=e.next.name),t},e.prototype.writeRevisions=function(e){this.document[de[this.keywordIndex]]=[];for(var t=0;t<e.owner.revisions.changes.length;t++)(this.isExport||!this.isExport&&!this.owner.enableTrackChanges&&-1!==this.selectedRevisionId.indexOf(e.owner.revisions.changes[t].revisionID))&&this.document[de[this.keywordIndex]].push(this.writeRevision(e.owner.revisions.changes[t]))},e.prototype.writeRevision=function(e){var t={};return t[Ar[this.keywordIndex]]=e.author,t[Vr[this.keywordIndex]]=e.date,t[_r[this.keywordIndex]]=1==this.keywordIndex?this.getRevisionTypeEnumValue(e.revisionType):e.revisionType,t[jr[this.keywordIndex]]=e.revisionID,t},e.prototype.writeComments=function(e){this.document[le[this.keywordIndex]]=[];for(var t=0;t<e.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document[le[this.keywordIndex]].push(this.writeComment(this.documentHelper.comments[t]))},e.prototype.writeCustomXml=function(e){this.document[he[this.keywordIndex]]=[];for(var t=0;t<e.customXmlData.length;t++){var i={},n=e.customXmlData.keys[t];i[Gr[this.keywordIndex]]=n;var r=this.documentHelper.customXmlData.get(n);i[Kr[this.keywordIndex]]=r,this.document[he[this.keywordIndex]].push(i)}},e.prototype.writeImages=function(e){this.document[na[this.keywordIndex]]={};for(var t=0;t<this.images.length;t++){var i=this.images[t],n=e.images.get(i);this.document[na[this.keywordIndex]][i]=n}},e.prototype.writeComment=function(e){var t={};t[Rr[this.keywordIndex]]=e.commentId,t[Ar[this.keywordIndex]]=e.author,t[Vr[this.keywordIndex]]=e.date,t[Go[this.keywordIndex]]=Pa.commentInlines(e.text,e.mentions,this.keywordIndex),t[zr[this.keywordIndex]]=Pa.getBoolInfo(e.isResolved,this.keywordIndex),t[qr[this.keywordIndex]]=[];for(var i=0;i<e.replyComments.length;i++)t[qr[this.keywordIndex]].push(this.writeComment(e.replyComments[i]));return t},e.prototype.writeLists=function(e){var t=[];this.document[re[this.keywordIndex]]=[];for(var i=0;i<e.lists.length;i++){var n=e.lists[i];this.lists.indexOf(n.listId)>-1&&(this.document[re[this.keywordIndex]].push(this.writeList(n)),t.indexOf(n.abstractListId)<0&&t.push(n.abstractListId))}this.document[oe[this.keywordIndex]]=[];for(i=0;i<e.abstractLists.length;i++){var r=e.abstractLists[i];t.indexOf(r.abstractListId)>-1&&this.document[oe[this.keywordIndex]].push(this.writeAbstractList(r))}},e.prototype.writeAbstractList=function(e){var t={};t[ls[this.keywordIndex]]=e.abstractListId,t[ds]=e.nsid,t[hs[this.keywordIndex]]=[];for(var i=0;i<e.levels.length;i++)t[hs[this.keywordIndex]][i]=this.writeListLevel(e.levels[i]);return t},e.prototype.writeList=function(e){var t={};if(!(0,a.isNullOrUndefined)(e)){t[ls[this.keywordIndex]]=e.abstractListId,t[ps[this.keywordIndex]]=[];for(var i=0;i<e.levelOverrides.length;i++)t[ps[this.keywordIndex]].push(this.writeLevelOverrides(e.levelOverrides[i]));t[ht[this.keywordIndex]]=e.listId,t[ds]=e.nsid}return t},e.prototype.writeLevelOverrides=function(e){var t={};return t[os[this.keywordIndex]]=e.levelNumber,e.overrideListLevel&&(t[cs[this.keywordIndex]]=this.writeListLevel(e.overrideListLevel)),t[ns[this.keywordIndex]]=e.startAt,t},e.prototype.writeListLevel=function(e){var t={};return t[ie[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat,this.keywordIndex),t[ne[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat,this.keywordIndex),t[Oo[this.keywordIndex]]=Pa.getBoolInfo(e.isLegalStyleNumbering,this.keywordIndex),t[is[this.keywordIndex]]=1==this.keywordIndex?this.getFollowCharacterType(e.followCharacter):e.followCharacter,t[ts[this.keywordIndex]]=1==this.keywordIndex?this.getListLevelPatternEnumValue(e.listLevelPattern):e.listLevelPattern,t[ss[this.keywordIndex]]=e.numberFormat,t[as[this.keywordIndex]]=e.paraStyleName,t[rs[this.keywordIndex]]=e.restartLevel,t[ns[this.keywordIndex]]=e.startAt,t},e.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e},e.prototype.getParentCell=function(e){for(;e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},e.prototype.getWidthTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Percent":return 1;case"Point":return 2}},e.prototype.getTableAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2}},e.prototype.getTextureStyleEnumValue=function(e){switch(e){case"TextureNone":return 0;case"Texture2Pt5Percent":return 1;case"Texture5Percent":return 2;case"Texture7Pt5Percent":return 3;case"Texture10Percent":return 4;case"Texture12Pt5Percent":return 5;case"Texture15Percent":return 6;case"Texture17Pt5Percent":return 7;case"Texture20Percent":return 8;case"Texture22Pt5Percent":return 9;case"Texture25Percent":return 10;case"Texture27Pt5Percent":return 11;case"Texture30Percent":return 12;case"Texture32Pt5Percent":return 13;case"Texture35Percent":return 14;case"Texture37Pt5Percent":return 15;case"Texture40Percent":return 16;case"Texture42Pt5Percent":return 17;case"Texture45Percent":return 18;case"Texture47Pt5Percent":return 19;case"Texture50Percent":return 20;case"Texture52Pt5Percent":return 21;case"Texture55Percent":return 22;case"Texture57Pt5Percent":return 23;case"Texture60Percent":return 24;case"Texture62Pt5Percent":return 25;case"Texture65Percent":return 26;case"Texture67Pt5Percent":return 27;case"Texture70Percent":return 28;case"Texture72Pt5Percent":return 29;case"Texture75Percent":return 30;case"Texture77Pt5Percent":return 31;case"Texture80Percent":return 32;case"Texture82Pt5Percent":return 33;case"Texture85Percent":return 34;case"Texture87Pt5Percent":return 35;case"Texture90Percent":return 36;case"Texture92Pt5Percent":return 37;case"Texture95Percent":return 38;case"Texture97Pt5Percent":return 39;case"TextureSolid":return 40;case"TextureDarkHorizontal":return 41;case"TextureDarkVertical":return 42;case"TextureDarkDiagonalDown":return 43;case"TextureDarkDiagonalUp":return 44;case"TextureDarkCross":return 45;case"TextureDarkDiagonalCross":return 46;case"TextureHorizontal":return 47;case"TextureVertical":return 48;case"TextureDiagonalDown":return 49;case"TextureDiagonalUp":return 50;case"TextureCross":return 51;case"TextureDiagonalCross":return 52}},e.prototype.getHeighTypeEnumValue=function(e){switch(e){case"AtLeast":default:return 0;case"Exactly":return 1}},e.prototype.getCellVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Center":return 1;case"Bottom":return 2}},e.prototype.getListLevelPatternEnumValue=function(e){switch(e){case"None":return 0;case"KanjiDigit":case"Arabic":return 1;case"UpRoman":return 2;case"LowRoman":return 3;case"UpLetter":return 4;case"LowLetter":return 5;case"Ordinal":return 6;case"Number":return 7;case"OrdinalText":return 8;case"LeadingZero":return 9;case"Bullet":return 10;case"FarEast":return 11;case"Special":return 12}},e.prototype.getStyleTypeEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Character":return 1;case"Table":return 2}},e.prototype.getProtectionTypeEnumValue=function(e){switch(e){case"NoProtection":return 0;case"ReadOnly":return 1;case"FormFieldsOnly":return 2;case"CommentsOnly":return 3;case"RevisionsOnly":return 4}},e.prototype.getRevisionTypeEnumValue=function(e){switch(e){case"Insertion":return 1;case"Deletion":return 2;case"MoveTo":return 3;case"MoveFrom":return 4}},e.prototype.getFootnoteTypeEnumValue=function(e){switch(e){case"Footnote":return 0;case"Endnote":return 1}},e.prototype.getFootnoteRestartIndexEnumValue=function(e){switch(e){case"DoNotRestart":return 0;case"RestartForEachSection":return 1;case"RestartForEachPage":return 2}},e.prototype.getFootEndNoteNumberFormatEnumValue=function(e){switch(e){case"Arabic":return 0;case"UpperCaseRoman":return 1;case"LowerCaseRoman":return 2;case"UpperCaseLetter":return 3;case"LowerCaseLetter":return 4}},e.prototype.getTextVerticalAlignmentEnumValue=function(e){switch(e){case"Top":default:return 0;case"Middle":case"Center":return 1;case"Bottom":return 2}},e.prototype.getShapeVerticalAlignmentEnumValue=function(e){switch(e){case"None":default:return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inline":return 4;case"Inside":return 5;case"Outside":return 6}},e.prototype.getShapeHorizontalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Center":return 1;case"Inside":return 2;case"Left":return 3;case"Outside":return 4;case"Right":return 5}},e.prototype.getVerticalOriginEnumValue=function(e){switch(e){case"Paragraph":return 0;case"BottomMargin":return 1;case"InsideMargin":return 2;case"Line":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"TopMargin":return 7}},e.prototype.getHorizontalOriginEnumValue=function(e){switch(e){case"Column":return 0;case"Character":return 1;case"InsideMargin":return 2;case"LeftMargin":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"RightMargin":return 7}},e.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":default:return 0;case"Margin":return 1;case"Page":return 2}},e.prototype.getTableHorizontalRelationEnumValue=function(e){switch(e){case"Column":default:return 0;case"Margin":return 1;case"Page":return 2}},e.prototype.getTableVerticalPositionEnumValue=function(e){switch(e){case"None":default:return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inside":return 4;case"Outside":return 5}},e.prototype.getTableHorizontalPositionEnumValue=function(e){switch(e){case"Left":default:return 0;case"Center":return 1;case"Inside":return 2;case"Outside":return 3;case"Right":return 4}},e.prototype.getLineDashStyleEnumValue=function(e){switch(e){case"Solid":return 0;case"Dash":return 1;case"DashDot":return 2;case"DashDotDot":return 3;case"DashDotGEL":return 4;case"DashGEL":return 5;case"Dot":return 6;case"DotGEL":return 7;case"LongDashDotDotGEL":return 8;case"LongDashDotGEL":return 9;case"LongDashGEL":return 10}},e.prototype.getHorizontalPositionAbsEnumValue=function(e){switch(e){case"Left":default:return 0;case"Center":return 1;case"Right":return 2;case"Inside":return 3;case"Outside":return 4}},e.prototype.getTabJustificationEnumValue=function(e){switch(e){case"Left":return 0;case"Bar":return 1;case"Center":return 2;case"Decimal":return 3;case"List":return 4;case"Right":return 5}},e.prototype.getTabLeaderEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Dot":return 2;case"Hyphen":return 3;case"Underscore":return 4}},e.prototype.getTextFormFieldTypeEnumValue=function(e){switch(e){case"Text":return 0;case"Number":return 1;case"Date":return 2;case"Calculation":return 3}},e.prototype.getTextFormFieldFormatEnumValue=function(e){switch(e){case"None":default:return 0;case"FirstCapital":return 1;case"Lowercase":return 2;case"Uppercase":return 3;case"Titlecase":return 4}},e.prototype.getCheckBoxSizeTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Exactly":return 1}},e.prototype.getContentControlAppearanceEnumValue=function(e){switch(e){case"BoundingBox":default:return 1;case"Hidden":return 2;case"Tags":return 3}},e.prototype.getContentControlTypeEnumValue=function(e){switch(e){case"RichText":return 0;case"BuildingBlockGallery":return 1;case"CheckBox":return 2;case"ComboBox":return 3;case"Date":return 4;case"DropDownList":return 5;case"Group":return 6;case"Picture":return 7;case"RepeatingSection":return 8;case"Text":return 9}},e.prototype.getDateCalendarTypeEnumValue=function(e){switch(e){case"Gregorian":default:return 0;case"GregorianArabic":return 1;case"GregorianEnglish":return 2;case"GregorianMiddleEastFrench":return 3;case"GregorianTransliteratedEnglish":return 4;case"GregorianTransliteratedFrench":return 5;case"Hebrew":return 6;case"Hijri":return 7;case"Japan":return 8;case"Korean":return 9;case"Saka":return 10;case"Taiwan":return 11;case"Thai":return 12}},e.prototype.getDateStorageFormatEnumValue=function(e){switch(e){case"DateStorageDate":return 1;case"DateStorageDateTime":return 2;case"DateStorageText":return 3;default:return 0}},e.prototype.getTextWrappingStyleEnumValue=function(e){switch(e){case"Inline":default:return 0;case"InFrontOfText":return 1;case"Square":return 2;case"TopAndBottom":return 3;case"Behind":return 4}},e.prototype.getTextWrappingTypeEnumValue=function(e){switch(e){case"Both":return 0;case"Left":return 1;case"Right":return 2;case"Largest":return 3}},e.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},e.prototype.getLineFormatTypeEnumValue=function(e){switch(e){case"Solid":return 0;case"Patterned":return 1;case"Gradient":return 2;case"None":return 3}},e.prototype.getAutoShapeTypeEnumValue=function(e){switch(e){case"Rectangle":return 1;case"RoundedRectangle":return 2;case"StraightConnector":return 3;case"Oval":return 4;case"IsoscelesTriangle":return 5;case"RightTriangle":return 6;case"Parallelogram":return 7;case"Trapezoid":return 8;case"Diamond":return 9;case"RegularPentagon":return 10;case"Hexagon":return 11;case"Heptagon":return 12;case"Octagon":return 13;case"Decagon":return 14;case"Dodecagon":return 15;case"Chord":return 16;case"Teardrop":return 17;case"Frame":return 18;case"HalfFrame":return 19;case"L_Shape":return 20;case"Pie":return 21;case"DiagonalStripe":return 22;case"Cross":return 23;case"Plaque":return 24;case"Can":return 25;case"Cube":return 26;case"Bevel":return 27;case"Donut":return 28;case"NoSymbol":return 29;case"BlockArc":return 30;case"FoldedCorner":return 31;case"SmileyFace":return 32;case"Heart":return 33;case"LightningBolt":return 34;case"Sun":return 35;case"Moon":return 36;case"Cloud":return 37;case"Arc":return 38;case"DoubleBracket":return 39;case"DoubleBrace":return 40;case"LeftBracket":return 41;case"RightBracket":return 42;case"LeftBrace":return 43;case"RightBrace":return 44;case"FlowChartProcess":return 45;case"FlowChartAlternateProcess":return 46;case"FlowChartDecision":return 47;case"FlowChartData":return 48;case"FlowChartPredefinedProcess":return 49;case"FlowChartInternalStorage":return 50;case"FlowChartDocument":return 51;case"FlowChartMultiDocument":return 52;case"FlowChartTerminator":return 53;case"FlowChartPreparation":return 54;case"FlowChartManualInput":return 55;case"FlowChartManualOperation":return 56;case"FlowChartConnector":return 57;case"FlowChartOffPageConnector":return 58;case"FlowChartCard":return 59;case"FlowChartPunchedTape":return 60;case"FlowChartSummingJunction":return 61;case"FlowChartOr":return 62;case"FlowChartCollate":return 63;case"FlowChartSort":return 64;case"FlowChartExtract":return 65;case"FlowChartMerge":return 66;case"FlowChartStoredData":return 67;case"FlowChartDelay":return 68;case"FlowChartSequentialAccessStorage":return 69;case"FlowChartMagneticDisk":return 70;case"FlowChartDirectAccessStorage":return 71;case"FlowChartDisplay":return 72;case"RightArrow":return 73;case"LeftArrow":return 74;case"UpArrow":return 75;case"DownArrow":return 76;case"LeftRightArrow":return 77;case"UpDownArrow":return 78;case"QuadArrow":return 79;case"LeftRightUpArrow":return 80;case"BentArrow":return 81;case"UTurnArrow":return 82;case"LeftUpArrow":return 83;case"BentUpArrow":return 84;case"CurvedRightArrow":return 85;case"CurvedLeftArrow":return 86;case"CurvedUpArrow":return 87;case"CurvedDownArrow":return 88;case"StripedRightArrow":return 89;case"NotchedRightArrow":return 90;case"Pentagon":return 91;case"Chevron":return 92;case"RightArrowCallout":return 93;case"DownArrowCallout":return 94;case"LeftArrowCallout":return 95;case"UpArrowCallout":return 96;case"LeftRightArrowCallout":return 97;case"QuadArrowCallout":return 98;case"CircularArrow":return 99;case"MathPlus":return 100;case"MathMinus":return 101;case"MathMultiply":return 102;case"MathDivision":return 103;case"MathEqual":return 104;case"MathNotEqual":return 105;case"Explosion1":return 106;case"Explosion2":return 107;case"Star4Point":return 108;case"Star5Point":return 109;case"Star6Point":return 110;case"Star7Point":return 111;case"Star8Point":return 112;case"Star10Point":return 113;case"Star12Point":return 114;case"Star16Point":return 115;case"Star24Point":return 116;case"Star32Point":return 117;case"UpRibbon":return 118;case"DownRibbon":return 119;case"CurvedUpRibbon":return 120;case"CurvedDownRibbon":return 121;case"VerticalScroll":return 122;case"HorizontalScroll":return 123;case"Wave":return 124;case"DoubleWave":return 125;case"SnipSingleCornerRectangle":return 126;case"SnipSameSideCornerRectangle":return 127;case"SnipDiagonalCornerRectangle":return 128;case"SnipAndRoundSingleCornerRectangle":return 129;case"RoundSingleCornerRectangle":return 130;case"RoundSameSideCornerRectangle":return 131;case"RoundDiagonalCornerRectangle":return 132;case"Unknown":return 133;case"ElbowConnector":return 134;case"CurvedConnector":return 135;default:return 0}},e.prototype.getFollowCharacterType=function(e){switch(e){case"Tab":return 0;case"Space":return 1;case"None":return 2}},e.prototype.destroy=function(){this.lists=void 0,this.images=void 0,this.endLine=void 0,this.startLine=void 0,this.endOffset=void 0,this.documentHelper=void 0},e}(),ap=function(){function e(e){this.version=0,this.userMap={},this.connectionId="",this.pendingOps=[],this.commentsStart=[],this.commentsEnd=[],this.deletedComments=[],this.serviceUrl="",this.isSyncServerChanges=!1,this.logEventEnabled=!0,this.message="",this.documentEditor=e}return e.prototype.getModuleName=function(){return"CollaborativeEditingHandler"},e.prototype.updateRoomInfo=function(e,t,i){this.roomName=e,this.serviceUrl=i,this.version=t},e.prototype.sendActionToServer=function(e){if((0,a.isNullOrUndefined)(e)||0!==e.length){var t=this.pendingOps[this.pendingOps.length-1];t&&this.checkAndCombineOperation(t,e)||this.pendingOps.push(e),this.isAcknowledgePending()||this.sendLocalOperation(),this.transformRemoteCursor(this.connectionId,e[0],e[0].offset)}},e.prototype.checkAndCombineOperation=function(e,t){if(1!==e.length||1!==t.length)return!1;var i=e[0],n=t[0];if(this.isSameOperation(i,n)&&this.canCombineOperation(i,n)){if("Insert"===i.action&&i.offset+i.length===n.offset||"Delete"===i.action&&i.offset===n.offset)return i.length+=n.length,i.text+=n.text,!0;if("Delete"===i.action&&n.offset+n.length===i.offset)return i.text=n.text+i.text,i.offset=n.offset,i.length+=n.length,!0}return!1},e.prototype.canCombineOperation=function(e,t){return e.format===t.format&&!this.isControlCharacter(e.text)&&!this.isControlCharacter(t.text)&&(0,a.isNullOrUndefined)(e.markerData)&&(0,a.isNullOrUndefined)(t.markerData)},e.prototype.isSameOperation=function(e,t){return e.action===t.action},e.prototype.isControlCharacter=function(e){return-1!==[o.Table,o.Row,o.Cell,o.Image,o.PageBreak,o.ColumnBreak,o.Section_Break,o.Table,o.Field_Separator,o.Marker_Start,o.Marker_End,o.Tab,o.LineBreak].indexOf(e)},e.prototype.applyRemoteAction=function(e,t){switch(e){case"connectionId":this.connectionId=t;break;case"removeUser":this.removeCarets(t);break;case"action":this.dataReceived(t)}},e.prototype.isAcknowledgePending=function(){return!(0,a.isNullOrUndefined)(this.acknowledgmentPending)},e.prototype.handleAcknowledgementReceived=function(e){var t=this.getVersionDifference(e);t>1?this.checkAndRetriveChangesFromServer():(this.logMessage("Ack received: "+e.version),this.logMessage("Ack version diff: "+t),e.version>this.version&&(this.updateVersion(e.version),this.acknowledgementReceived(),this.sendLocalOperation()))},e.prototype.updateVersion=function(e){e>this.version&&(this.version=e)},e.prototype.acknowledgementReceived=function(){this.acknowledgmentPending=void 0},e.prototype.sendLocalOperation=function(){var e=this;if(this.pendingOps.length>0){var t=this.pendingOps.shift(),i={};i.currentUser=this.documentEditor.currentUser,i.roomName=this.roomName,i.connectionId=this.connectionId,i.version=this.version,i.operations=t,this.acknowledgmentPending=t;var n=new XMLHttpRequest;n.open("Post",this.serviceUrl+"UpdateAction",!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.setCustomAjaxHeaders(n),n.onreadystatechange=function(){if(4===n.readyState)if(200===n.status||304===n.status){var t=JSON.parse(n.responseText);e.isSyncServerChanges||e.handleAcknowledgementReceived(t)}else{var i={status:n.status.toString(),statusText:n.statusText,url:e.serviceUrl+"UpdateAction"};e.documentEditor.fireServiceFailure(i)}},this.logMessage("Sent: "+JSON.stringify(i)),n.send(JSON.stringify(i))}},e.prototype.dataReceived=function(e){if(e.connectionId===this.connectionId&&!this.documentEditor.editor.isIncrementalSave||this.isSyncServerChanges)this.logMessage(this.isSyncServerChanges?"SignalR Server sync"+e.version:"SignalR Same user sync:"+e.version);else{var t=this.getVersionDifference(e);if(t<=0&&!this.documentEditor.editor.isIncrementalSave)this.logMessage("SignalR return diff:<=0"+e.version);else{if(t>1&&!this.documentEditor.editor.isIncrementalSave)return this.logMessage("SignalR return diff:>=1"+e.version),void this.checkAndRetriveChangesFromServer();this.logMessage("SignalR ack: "+e.version),this.logMessage("Received: "+JSON.stringify(e)),this.handleRemoteOperation(e)}}},e.prototype.getVersionDifference=function(e){return e.version-this.version},e.prototype.handleRemoteOperation=function(e){this.documentEditor.editorModule.isRemoteAction=!0;var t=this.documentEditor.selectionModule.getAbsolutePositionFromRelativePosition(this.documentEditor.selectionModule.start),i=this.documentEditor.selectionModule.getAbsolutePositionFromRelativePosition(this.documentEditor.selectionModule.end)-t;(0,a.isNullOrUndefined)(this.acknowledgmentPending)||(this.logMessage("Acknowledge transform:"+this.acknowledgmentPending[0].text+"version:"+e.version),this.transform([this.acknowledgmentPending],e.operations)),this.pendingOps.length>0&&this.logMessage("Pending transform:"+this.pendingOps.length+"version:"+e.version),this.transform(this.pendingOps,e.operations),this.applyRemoteOperation(e,t,i),this.updateVersion(e.version),this.documentEditor.editorModule.isRemoteAction=!1,this.documentEditor.editorHistoryModule.canUndo()&&(this.documentEditor.editorHistoryModule.undoStack.length=0),this.documentEditor.editorHistoryModule.canRedo()&&(this.documentEditor.editorHistoryModule.redoStack.length=0)},e.prototype.transform=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(e.length>0)for(var r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++){var s=e[r][o];this.transformSelectionOperation(s,n);var a=n.offset;this.transformOperation(s,n,t),this.logMessage("Transformed offset:"+(n.offset-a))}}},e.prototype.skipAction=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.length=0,i.skipOperation=!0}},e.prototype.handleAcceptReject=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.author===t.markerData.author&&n.revisionType===t.markerData.revisionType)this.documentEditor.editorModule.getRevision(n.revisionID)&&("Accept"===t.markerData.isAcceptOrReject?n.accept():"Reject"===t.markerData.isAcceptOrReject&&n.reject())}},e.prototype.applyRemoteOperation=function(e,t,i){var r,s,l=this.documentEditor.currentUser,d=this.documentEditor.commentReviewPane.commentPane.isEditMode,h=this.documentEditor.editorHistoryModule.lastOperation;(0,a.isNullOrUndefined)(this.documentEditor.commentReviewPane.commentPane.currentEditingComment)||(r=this.documentEditor.commentReviewPane.commentPane.currentEditingComment.textArea);for(var c=0;c<e.operations.length;c++){var p=e.operations[c].markerData,u=void 0,g=this.documentEditor.enableTrackChanges;if((0,a.isNullOrUndefined)(p)||(0,a.isNullOrUndefined)(p.author)||(this.documentEditor.currentUser=p.author),!(0,a.isNullOrUndefined)(p)&&!(0,a.isNullOrUndefined)(p.isSkipTracking)&&p.isSkipTracking&&this.documentEditor.enableTrackChanges&&(this.documentEditor.skipSettingsOps=!0,this.documentEditor.enableTrackChanges=!1),!(e.operations[c].skipOperation||!(0,a.isNullOrUndefined)(e.operations[c].markerData)&&e.operations[c].markerData.skipOperation))if("Update"!==e.operations[c].action){var m=this.getRelativePositionFromAbsolutePosition(e.operations[c].offset,!1,!1,!1),f=e.operations[c],v=m;if((0,a.isNullOrUndefined)(e.operations[c].action))this.documentSettings(e.operations[c]);else if("Delete"!==e.operations[c].action&&"Format"!==e.operations[c].action||("Format"===f.action&&0===f.length||(this.documentEditor.selectionModule.isEndOffset=!0),v=this.getRelativePositionFromAbsolutePosition(e.operations[c].offset+e.operations[c].length,!1,!1,!1),this.documentEditor.selectionModule.isEndOffset=!1),("Insert"===f.action&&f.text!==o.Row&&f.text!==o.Cell&&((0,a.isNullOrUndefined)(f.markerData)||(0,a.isNullOrUndefined)(f.markerData.isAcceptOrReject))||"Delete"===f.action&&f.text!==o.Cell&&((0,a.isNullOrUndefined)(f.markerData)||(0,a.isNullOrUndefined)(f.markerData.isAcceptOrReject))||"Format"===f.action&&((0,a.isNullOrUndefined)(f.markerData)||(0,a.isNullOrUndefined)(f.markerData.isAcceptOrReject)))&&this.documentEditor.selectionModule.select(m,v),(0,a.isNullOrUndefined)(f.markerData)||((0,a.isNullOrUndefined)(f.markerData.revisionForFootnoteEndnoteContent)&&(0,a.isNullOrUndefined)(f.markerData.revisionId)||(this.documentEditor.editorModule.revisionData=[]),(0,a.isNullOrUndefined)(f.markerData.revisionForFootnoteEndnoteContent)||this.documentEditor.editorModule.revisionData.push(f.markerData.revisionForFootnoteEndnoteContent),(0,a.isNullOrUndefined)(f.markerData.revisionId)||this.documentEditor.editorModule.revisionData.push(f.markerData),!(0,a.isNullOrUndefined)(f.markerData.splittedRevisions)&&f.markerData.splittedRevisions.length>0&&(this.documentEditor.editorModule.revisionData=this.documentEditor.editorModule.revisionData.concat(f.markerData.splittedRevisions))),(0,a.isNullOrUndefined)(f.markerData)||(0,a.isNullOrUndefined)(f.markerData.isAcceptOrReject)||""===f.markerData.isAcceptOrReject){if("Insert"===f.action)if("Paste"===f.type)this.documentEditor.editorModule.isPasteListUpdated=!1,this.documentEditor.editorModule.pasteContents(Pa.getSfdtDocument(f.pasteContent));else if("PasteToc"===f.type)this.documentEditor.editorModule.isInsertingTOC=!0,this.documentEditor.editorModule.pasteContents(Pa.getSfdtDocument(f.pasteContent)),this.documentEditor.editorModule.isInsertingTOC=!1;else if(f.text===o.Image.toString())this.insertImage(f.imageData);else if(f.text===o.Section_Break.toString()&&"NewPage"===f.type)this.documentEditor.editorModule.insertSectionBreak();else if(f.text===o.Section_Break.toString()&&"Continuous"===f.type)this.documentEditor.editorModule.insertSectionBreak(n.Continuous);else if(!p||f.text!==o.Marker_Start&&f.text!==o.Marker_End&&f.text!==o.Field_Separator)if(p&&!(0,a.isNullOrUndefined)(p.dropDownIndex)&&"DropDown"===f.type){(K=this.documentEditor.selectionModule.start.currentWidget.getInline(this.documentEditor.selectionModule.start.offset,0).element)instanceof _l&&this.documentEditor.editorModule.updateFormField(K,p.dropDownIndex,!1)}else if(f.text===o.Section_Break.toString()&&"NewPage"===f.type)this.documentEditor.editorModule.insertSectionBreak();else if(f.text===o.Section_Break.toString()&&"Continuous"===f.type)this.documentEditor.editorModule.insertSectionBreak(n.Continuous);else if(f.text===o.Table)c=e.operations.length,this.buildTable(e.operations),u=this.getOperationLength(e.operations);else if(f.text===o.Row)c=e.operations.length,(0,a.isNullOrUndefined)(f.format)&&e.operations.reverse(),this.buildRow(e.operations),u=this.getOperationLength(e.operations);else if(f.text===o.Cell){var y=void 0,w=void 0;"CellFormat"===f.type&&(f.length>0&&(y=e.operations[c-1].format,w=e.operations[c-2].format),this.buildCell(f,y,w))}else if(f.text===o.PageBreak.toString())this.documentEditor.editorModule.insertPageBreak();else if(f.text===o.ColumnBreak.toString())this.documentEditor.editorModule.insertColumnBreak();else{if(f.format){N=new ka;var b=JSON.parse(f.format);this.documentEditor.parser.parseCharacterFormat(0,b,N),this.documentEditor.selectionModule.isRetrieveFormatting=!0,this.documentEditor.selectionModule.characterFormat.copyFormat(N),this.documentEditor.selectionModule.isRetrieveFormatting=!1}this.documentEditor.editorModule.insertText(f.text)}else{var C=void 0;if(p.type&&"Bookmark"===p.type){if(f.text===o.Marker_Start)C=this.documentEditor.editorModule.createBookmarkElements(p.bookmarkName)[0],this.documentEditor.documentHelper.isBookmarkInserted=!1,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[C]);else if(this.documentEditor.documentHelper.bookmarks.containsKey(p.bookmarkName)){var x=this.documentEditor.documentHelper.bookmarks.get(p.bookmarkName);x&&(C=x.reference,this.documentEditor.documentHelper.isBookmarkInserted=!0,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[C]),this.documentEditor.selectionModule.selectBookmark(p.bookmarkName),x.properties=this.documentEditor.selectionModule.getBookmarkProperties(x),C.properties=this.documentEditor.selectionModule.getBookmarkProperties(C),this.documentEditor.editorModule.fireContentChange())}}else if(p.type&&"EditRange"===p.type){var I=p.user,k=p.editRangeId;if(f.text===o.Marker_Start)this.documentEditor.documentHelper.restrictEditingPane&&this.documentEditor.documentHelper.restrictEditingPane.addUserDialog.bindListData(I),(C=this.documentEditor.editorModule.addEditElement(I,k)).columnFirst=parseInt(p.columnFirst),C.columnLast=parseInt(p.columnLast),C.line=this.documentEditor.selectionModule.start.currentWidget;else for(var F=0,P=this.documentEditor.documentHelper.editRanges.get(I);F<P.length;F++){var S=P[F];if(S.editRangeId===k){(C=S.editRangeEnd).line=this.documentEditor.selectionModule.start.currentWidget;break}}this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[C]),this.documentEditor.editorModule.fireContentChange()}else if(p.type&&"Field"===p.type){this.documentEditor.editor.isFieldOperation=!0;var T=f.text===o.Marker_Start?0:f.text===o.Marker_End?1:f.text===o.Field_Separator?2:void 0;if(!(0,a.isNullOrUndefined)(T)&&(0,a.isNullOrUndefined)(p.checkBoxValue)){var H=new _l(T);if(0===T&&!(0,a.isNullOrUndefined)(p.formFieldData)){var E=this.documentEditor.editor.getFormFieldData(f.type);this.documentEditor.parser.parseFormFieldData(0,JSON.parse(p.formFieldData),E),H.formFieldData=E}var N=new ka;if(f.format){var W=JSON.parse(f.format);this.documentEditor.parser.parseCharacterFormat(0,W,N)}H.characterFormat.copyFormat(N),this.documentEditor.editorModule.initInsertInline(H)}else{(K=this.documentEditor.selectionModule.start.currentWidget.getInline(this.documentEditor.selectionModule.start.offset,0).element)instanceof _l&&this.documentEditor.editorModule.toggleCheckBoxFormField(K,!0,p.checkBoxValue)}}else if((0,a.isNullOrUndefined)(p)||(0,a.isNullOrUndefined)(p.commentId))if((0,a.isNullOrUndefined)(f.markerData.type)||"Footnote"!==f.markerData.type&&"Endnote"!==f.markerData.type){if(p.type&&"ContentControl"===p.type){f.text===o.Marker_Start&&(s=new nd(p.text),(0,a.isNullOrUndefined)(p.contentControlProperties)||this.documentEditor.editorModule.assignContentControl(s,JSON.parse(p.contentControlProperties)));var O=new id(s.contentControlWidgetType);O.contentControlProperties=s,O.type=f.text===o.Marker_Start?0:1,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[O]),f.text===o.Marker_End&&O.reference&&this.documentEditor.editorModule.updatePropertiesToBlock(O.reference,!0)}}else"Footnote"===f.markerData.type?this.documentEditor.editorModule.insertFootnote():"Endnote"===f.markerData.type&&this.documentEditor.editorModule.insertEndnote();else{var B=f.text===o.Marker_Start?0:1,L=this.documentEditor.documentHelper.layout.getCommentById(this.deletedComments,p.commentId),D=void 0;if((0,a.isNullOrUndefined)(L)&&(L=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,p.commentId),(0,a.isNullOrUndefined)(L)&&!(0,a.isNullOrUndefined)(p.ownerCommentId)&&(D=this.documentEditor.documentHelper.layout.getCommentById(this.documentEditor.documentHelper.comments,p.ownerCommentId),(0,a.isNullOrUndefined)(D)||(L=this.documentEditor.documentHelper.layout.getCommentById(D.replyComments,p.commentId)))),(0,a.isNullOrUndefined)(L)){(ae=new Bd(B)).commentId=p.commentId,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[ae]),0===B?this.commentsStart.push(ae):this.commentsEnd.push(ae)}else{(ae=new Bd(B)).commentId=p.commentId,this.documentEditor.editorModule.insertElementsInternal(this.documentEditor.selectionModule.start,[ae]),ae.comment=L;var R=this.documentEditor.selectionModule.start.currentWidget.children.indexOf(ae);L.commentStart=this.documentEditor.selectionModule.start.currentWidget.children[R]}}}else if("Delete"===f.action)if(f.text===o.Marker_Start||f.text===o.Marker_End)if((0,a.isNullOrUndefined)(p)||(0,a.isNullOrUndefined)(p.commentId)){var M=(A=this.documentEditor.selectionModule).start.offset-1;this.documentEditor.editorModule.removeAtOffset(A.start.currentWidget,this.documentEditor.selectionModule,M)}else{var A=this.documentEditor.selectionModule;B=f.text===o.Marker_Start?0:1,L=void 0;if(this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element instanceof Bd&&(L=this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element),1===B){-1!==L.indexInOwner&&this.documentEditor.editorModule.removeAtOffset(A.start.currentWidget,this.documentEditor.selectionModule,A.start.offset)}else{var U=L;-1!==U.indexInOwner&&this.documentEditor.editorModule.removeAtOffset(A.start.currentWidget,this.documentEditor.selectionModule,A.start.offset),U.removeCommentMark()}}else f.text===o.Cell?this.buildDeleteCells(f):this.documentEditor.editorModule.onBackSpace();else if("Format"===f.action)if(f.text===o.Marker_Start.toString()+o.Marker_End.toString())this.updateOperation(f);else if(f.text!==o.Marker_Start||(0,a.isNullOrUndefined)(f.format))if(f.text!==o.Marker_Start||(0,a.isNullOrUndefined)(f.markerData)||"ContentControlCheckBox"!==f.markerData.type){if((0,a.isNullOrUndefined)(f.markerData)||(0,a.isNullOrUndefined)(f.markerData.revisionId))if(f.text===o.Row){var V=this.getRelativePositionFromAbsolutePosition(f.offset,!1,!0,!1);if(!(0,a.isNullOrUndefined)(V.rowWidget)){var z=V.rowWidget.ownerTable,q=JSON.parse(f.format);this.documentEditor.documentHelper.owner.parser.parseRowFormat(q,V.rowWidget.rowFormat,0),z.calculateGrid(!1),this.documentEditor.documentHelper.layout.reLayoutTable(z)}}else if(f.text===o.Cell){if("TableFormat"===f.type){var _=this.getRelativePositionFromAbsolutePosition(f.offset,!0,!1,!1);z=JSON.parse(f.format);this.documentEditor.documentHelper.owner.parser.parseTableFormat(z,_.tableWidget.tableFormat,0),_.tableWidget.calculateGrid(!1),this.documentEditor.documentHelper.layout.reLayoutTable(_.tableWidget)}if("RowFormat"===f.type){q=this.getRelativePositionFromAbsolutePosition(f.offset,!1,!0,!1),$=JSON.parse(f.format);this.documentEditor.documentHelper.owner.parser.parseRowFormat($,q.rowWidget.rowFormat,0)}if("CellFormat"===f.type){var j=this.getRelativePositionFromAbsolutePosition(f.offset,!1,!1,!0),G=JSON.parse(f.format);this.documentEditor.documentHelper.owner.parser.parseCellFormat(G,j.cellWidget.cellFormat,0)}}else if(f.text===o.Image){var K;(K=this.documentEditor.selectionModule.end.currentWidget.getInline(this.documentEditor.selectionModule.end.offset,0).element)instanceof gd&&this.documentEditor.editorModule.onImageFormat(K,Pa.convertPointToPixel(f.imageData.width),Pa.convertPointToPixel(f.imageData.height),f.imageData.alternativeText)}else if("ListFormat"===f.type){var X=JSON.parse(f.format),Z=new ba(void 0);this.documentEditor.parser.parseParagraphFormat(0,X,Z),this.updateList(f,Z);var J=this.documentEditor.documentHelper.getListById(X.listFormat.nsid,!0);(0,a.isNullOrUndefined)(J)||(Z.listFormat.listId=J.listId,Z.listFormat.list=J),this.documentEditor.editorModule.onApplyParagraphFormat(f.text,Z.listFormat,!1,!1)}else if("RestartNumbering"===f.type){var Y=this.updateList(f);J=this.documentEditor.documentHelper.getListById(Y,!0);this.documentEditor.editorModule.restartListAtInternal(this.documentEditor.selectionModule,J.listId,J.nsid)}else if("ContinueNumbering"===f.type){X=JSON.parse(f.format),Z=new ba(void 0);this.documentEditor.parser.parseParagraphFormat(0,X,Z);J=this.documentEditor.documentHelper.getListById(Z.listFormat.nsid,!0);(0,a.isNullOrUndefined)(J)||(Z.listFormat.listId=J.listId,Z.listFormat.list=J),this.documentEditor.editorModule.applyContinueNumberingInternal(this.documentEditor.selectionModule,Z)}else"CharacterFormat"===f.type?this.insertCharaterFormat(f.type,f.format):"ParagraphFormat"===f.type?this.insertParagraphFormat(f,f.format):"TableFormat"===f.type?this.insertTableFormat(f.text,f.format,f.offset):"SectionFormat"===f.type?this.insertSectionFormat(f.text,f.format):"RowFormat"===f.type?this.insertRowFormat(f.text,f.format):"CellFormat"===f.type&&this.insertCellFormat(f.format);else if(!(0,a.isNullOrUndefined)(f.markerData.revisionType)&&"Deletion"===f.markerData.revisionType){if(f.text===o.Row){var Q=this.getRelativePositionFromAbsolutePosition(f.offset,!1,!0,!1);if(!(0,a.isNullOrUndefined)(Q.rowWidget)){var $=Q.rowWidget;this.documentEditor.editorModule.trackRowDeletion($),this.documentEditor.trackChangesPane.updateTrackChanges();continue}}this.documentEditor.editorModule.onBackSpace()}}else{(ee=this.documentEditor.selection.currentContentControl)&&"CheckBox"===ee.contentControlProperties.type&&this.documentEditor.editorModule.toggleContentControlCheckBox(ee,p.checkBoxValue)}else{var ee;(ee=this.documentEditor.selection.currentContentControl)&&this.documentEditor.editorModule.assignContentControl(ee.contentControlProperties,JSON.parse(f.format))}this.documentEditor.editor.revisionData=void 0,this.documentEditor.enableTrackChanges!=g&&(this.documentEditor.skipSettingsOps=!0,this.documentEditor.enableTrackChanges=g),this.documentEditor.currentUser=l;var te=this.documentEditor.selectionModule.startOffset;if(this.updateRemoteSelection(e,this.documentEditor.selectionModule.getAbsolutePositionFromRelativePosition(te)),!(0,a.isNullOrUndefined)(u)){var ie=f.length;f.length=u,u=ie}var ne=this.transformSection(f.action,f,t)[1],re=this.transformSection(f.action,f,t+i)[1];t=ne,this.documentEditor.selectionModule.select(this.getRelativePositionFromAbsolutePosition(ne,!1,!1,!1),this.getRelativePositionFromAbsolutePosition(re,!1,!1,!1)),(0,a.isNullOrUndefined)(u)||(f.length=u),this.transformRemoteCursor(e.connectionId,f,f.offset),!(0,a.isNullOrUndefined)(this.documentEditor.searchModule)&&!(0,a.isNullOrUndefined)(this.documentEditor.optionsPaneModule)&&this.documentEditor.searchModule.searchResults.length>0&&this.documentEditor.optionsPaneModule.isOptionsPaneShow&&this.documentEditor.optionsPaneModule.searchIconClickInternal()}else{var oe=this.documentEditor.editorModule.getRevision(f.markerData.revisionId);if(oe)"Accept"===f.markerData.isAcceptOrReject?oe.accept():"Reject"===f.markerData.isAcceptOrReject&&oe.reject();else if(f.text===o.Row){var se=this.getRelativePositionFromAbsolutePosition(f.offset,!1,!0,!1);se&&se.rowWidget&&this.handleAcceptReject(se.rowWidget.rowFormat.revisions,f)}else{this.documentEditor.selectionModule.select(m,v);var ae=void 0;if(this.documentEditor.selection.start.isAtParagraphEnd)ae=this.documentEditor.selection.start.currentWidget.paragraph.characterFormat;else ae=this.documentEditor.selectionModule.start.currentWidget.getInline(this.documentEditor.selectionModule.start.offset+1,0).element;(0,a.isNullOrUndefined)(ae)||this.handleAcceptReject(ae.revisions,f)}}}else if(!(0,a.isNullOrUndefined)(e.operations[c].styleData)){var le=JSON.parse(e.operations[c].styleData);this.documentEditor.editor.updateStyleObject(le)}}if(s=void 0,this.documentEditor.editor.isFieldOperation&&(this.documentEditor.editorModule.layoutWholeDocument(),this.documentEditor.editor.isFieldOperation=!1),!(0,a.isNullOrUndefined)(this.rowWidget)){var de=this.rowWidget.ownerTable.combineWidget(this.documentEditor.viewer);de.updateRowIndex(0),de.calculateGrid(!0),this.documentEditor.documentHelper.layout.reLayoutTable(de),this.documentEditor.editorModule.reLayout(this.documentEditor.selectionModule),this.rowWidget=void 0}(0,a.isNullOrUndefined)(this.table)||(this.table.calculateGrid(),this.documentEditor.editorModule.updateTable(this.table),this.documentEditor.editorModule.reLayout(this.documentEditor.selectionModule,!0),this.table=void 0),this.documentEditor.currentUser=l,this.documentEditor.commentReviewPane.commentPane.isEditMode=d,this.documentEditor.editorHistoryModule.lastOperation=h,(0,a.isNullOrUndefined)(this.documentEditor.commentReviewPane.commentPane.currentEditingComment)||(this.documentEditor.commentReviewPane.commentPane.currentEditingComment.textArea=r)},e.prototype.updateOperation=function(e){var t=e.markerData;if(e.text===o.Marker_Start.toString()+o.Marker_End.toString()){var i=void 0,n=void 0;if(this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element instanceof Bd&&e.offset>0){var r=this.documentEditor.selection.getElementInfo(this.documentEditor.selection.end.currentWidget,this.documentEditor.selection.end.offset).element.commentId;n=this.getComment(r)}if(!(0,a.isNullOrUndefined)(n)&&((0,a.isNullOrUndefined)(t.done)||!(0,a.isNullOrUndefined)(t.date))&&(0,a.isNullOrUndefined)(t.isReply))if(n.text!==t.text)return(s=this.documentEditor.commentReviewPane.commentPane.comments.get(n)).commentText.innerText=t.text,void(n.text=t.text);if((0,a.isNullOrUndefined)(n)){(l=new Ld(t.date)).commentId=t.commentId;d=this.getObjectByCommentId(this.commentsStart,l.commentId),h=this.getObjectByCommentId(this.commentsEnd,l.commentId);if(!(0,a.isNullOrUndefined)(d)&&!(0,a.isNullOrUndefined)(h))this.documentEditor.editorModule.updateCommentElement(l,d,h,t),this.documentEditor.editorModule.addCommentWidget(l,!0,!0,!1),this.commentsStart.splice(this.commentsStart.indexOf(d),1),this.commentsEnd.splice(this.commentsEnd.indexOf(h),1),this.documentEditor.commentReviewPane.commentPane.comments.get(l).postComment()}else{if(!(0,a.isNullOrUndefined)(t.done)&&(0,a.isNullOrUndefined)(t.commentAction))return void(t.done?this.documentEditor.editorModule.resolveComment(n):this.documentEditor.editorModule.reopenComment(n));if("remove"===t.commentAction){var s;(s=this.documentEditor.commentReviewPane.commentPane.comments.get((0,a.isNullOrUndefined)(i)?n:i)).showDrawer(),this.documentEditor.editorModule.deleteCommentWidget(n),this.deletedComments.push(n),s.hideDrawer()}else{var l;(l=new Ld(t.date)).commentId=t.commentId;var d=this.getObjectByCommentId(this.commentsStart,l.commentId),h=this.getObjectByCommentId(this.commentsEnd,l.commentId);(0,a.isNullOrUndefined)(d)||(0,a.isNullOrUndefined)(h)||(this.documentEditor.editorModule.updateCommentElement(l,d,h,t),l.ownerComment=n,n.replyComments.splice(t.commentIndex,0,l),this.documentEditor.commentReviewPane.addReply(l,!1,!1))}}}},e.prototype.getComment=function(e){for(var t=this.documentEditor.documentHelper.comments,i=0;i<t.length;i++){var n=this.documentEditor.documentHelper.layout.getCommentById(t,e);if(!(0,a.isNullOrUndefined)(n))return n;for(var r=0;r<t[i].replyComments.length;r++){var o=this.documentEditor.documentHelper.layout.getCommentById(t[i].replyComments,e);if(!(0,a.isNullOrUndefined)(o))return o}}return null},e.prototype.updateList=function(e,t){var i=-1;if(e.listData){var n=JSON.parse(e.listData);if(n.hasOwnProperty("optimizeSfdt")&&(this.documentEditor.parser.keywordIndex=n.optimizeSfdt?1:0),(0,a.isNullOrUndefined)(t))n.hasOwnProperty(ds)&&(i=n[ds]),this.updateListCollection(n,this.documentEditor.parser.keywordIndex);else{var r=this.documentEditor.documentHelper.getListById(t.listFormat.nsid,!0);if((0,a.isNullOrUndefined)(r))this.updateListCollection(n,this.documentEditor.parser.keywordIndex);else{var o=[];if(this.documentEditor.parser.parseAbstractList(n,o),!(0,a.isNullOrUndefined)(r.abstractList)&&r.abstractList.levels.length<t.listFormat.listLevelNumber){r.abstractList.levels=[];for(var s=0;s<o[0].levels.length;s++)r.abstractList.levels.push(o[0].levels[s])}}}}return i},e.prototype.getOperationLength=function(e){for(var t=0,i=0;i<e.length;i++)e[parseInt(i.toString(),10)].text!==o.Table&&e[parseInt(i.toString(),10)].text!==o.Row&&e[parseInt(i.toString(),10)].text!==o.Cell||(t+=e[parseInt(i.toString(),10)].length);return t},e.prototype.updateListCollection=function(e,t){for(var i=this.documentEditor.editorModule.getUniqueListOrAbstractListId(!0),n=this.documentEditor.editorModule.getUniqueListOrAbstractListId(!1),r=function(r){var o=e[re[t]][r],s=e[oe[t]].filter((function(e){return e[ls[t]]===o[ls[t]]}))[0];(0,a.isNullOrUndefined)(s)||(s[ls[t]]=n,o[ht[t]]=i,o[ls[t]]=n,i++,n++)},o=0;o<e[re[t]].length;o++)r(o);this.documentEditor.parser.parseAbstractList(e,this.documentEditor.documentHelper.abstractLists),this.documentEditor.parser.parseList(e,this.documentEditor.documentHelper.lists)},e.prototype.getObjectByCommentId=function(e,t){for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r.commentId===t)return r}},e.prototype.transformOperation=function(e,t,i){if("Insert"!==e.action||"Insert"!==t.action&&"Format"!==t.action)if("Delete"!==e.action||"Delete"!==t.action&&"Format"!==t.action)if("Insert"!==e.action||"Delete"!==t.action&&"Format"!==t.action){if("Delete"===e.action&&("Insert"===t.action||"Format"===t.action))if(e.offset<=t.offset&&e.offset+e.length<=t.offset)t.offset=t.offset-e.length;else if(e.offset<t.offset&&e.offset+e.length>=t.offset+t.length)if((0,a.isNullOrUndefined)(t.markerData)||(0,a.isNullOrUndefined)(t.markerData.type)||"Field"===t.markerData.type||t.text!==o.Marker_End&&t.text!==o.Marker_Start)t.length=0,t.skipOperation=!0,(0,a.isNullOrUndefined)(t.markerData)||(0,a.isNullOrUndefined)(t.markerData.type)||"Field"!==t.markerData.type||t.text!==o.Marker_Start&&t.text!==o.Marker_End||this.skipAction(i);else{if(!(0,a.isNullOrUndefined)(t.markerData.commentId)&&t.text===o.Marker_End)return this.skipAction(i),[e,t];var n=t.offset-e.offset;t.offset-=n}else e.offset<=t.offset&&"Insert"==t.action&&e.offset+e.length>=t.offset?this.skipAction(i):e.offset>t.offset&&"Format"!==t.action&&(e.offset=e.offset+t.length)}else{if(e.offset<=t.offset)return t.offset=t.offset+e.length,[e,t];if(e.offset>=t.offset+t.length&&"Format"!==t.action)return e.offset=e.offset-t.length,[e,t];e.offset>t.offset&&e.offset<t.offset+t.length&&(t.length+=e.length)}else{if(e.offset<t.offset)return t.offset=t.offset-e.length,[e,t];if(e.offset>t.offset&&"Format"!==t.action)return e.offset=e.offset-t.length,[e,t]}else{if(e.offset<t.offset)return t.offset=t.offset+e.length,[e,t];if(e.offset>=t.offset&&"Format"!==t.action)return e.offset=e.offset+t.length,[e,t]}return[e,t]},e.prototype.transformSection=function(e,t,i){if("Insert"===e){if(t.offset<i)return[t.offset,i+t.length]}else if("Delete"===e&&t.offset<=i)return[t.offset,i-t.length];return[t.offset,i]},e.prototype.transformRemoteCursor=function(e,t,i){this.documentEditor.editorModule.isIncrementalSave||this.updateCaretPosition(e,t)},e.prototype.updateCaretPosition=function(e,t){if(!(0,a.isNullOrUndefined)(this.userMap))for(var i,n=Object.keys(this.userMap),r=0;r<n.length;r++){var o=n[r];if(o!==e){if((0,a.isNullOrUndefined)(t))i=this.userMap[o].offset;else{var s=this.userMap[o].offset;i=this.transformSection(t.action,t,s)[1],this.userMap[o].offset=i}this.updateCaretPositionInteral(this.userMap[o].caret,i)}}},e.prototype.updateRemoteSelection=function(e,t){if(!this.documentEditor.editorModule.isIncrementalSave&&e.connectionId){var i="",n=void 0;void 0!==this.userMap[e.connectionId]?(i=this.userMap[e.connectionId].color,n=this.userMap[e.connectionId].caret):(i=this.getColorForMember(100*Math.random()),n=(0,a.createElement)("div",{className:"e-de-blink-cursor",styles:"position:absolute;border-left: 2px solid "+i}),this.userMap[e.connectionId]=new lp(i,n,t,e.currentUser)),this.userMap[e.connectionId].offset=t,this.updateCaretPositionInteral(n,t)}},e.prototype.removeCarets=function(e){void 0!==this.userMap[e]&&(this.userMap[e].caret.remove(),delete this.userMap[e])},e.prototype.getColorForMember=function(e){return"hsl("+360*(e%20)/7%360+", 100%, 35%)"},e.prototype.updateCaretPositionInteral=function(e,t){var i=this.documentEditor.zoomFactor,n=this.documentEditor.selectionModule,r=n.getTextPosBasedOnLogicalIndex(this.getRelativePositionFromAbsolutePosition(t,!1,!1,!1)),o=r.location;e.style.display="block",e.parentElement||this.documentEditor.documentHelper.viewerContainer.appendChild(e);var s=n.getSelectionPage(r);if(s){e.style.left=s.boundingRectangle.x+Math.round(o.x)*i+"px";var a=n.updateCaretSize(r,!0),l=a.topMargin;e.style.height=a.height*i+"px";var d=n.getPageTop(s);e.style.top=d+Math.round(o.y+l)*i+"px","Subscript"===n.characterFormat.baselineAlignment&&(e.style.top=parseFloat(e.style.top)+parseFloat(e.style.height)/2+"px")}},e.prototype.getBlockPosition=function(e,t,i,n,r,o,s){var l;if(i instanceof Rl){var d=this.getBlockTotalLength(e,t,i,n,r,o,s);if(n.done)return n.done=!0,d;t=d.currentLength,e=d.offset,l=d.paragraph}else if(i instanceof Al){if((e-=1)===t&&(r||this.documentEditor.selectionModule.isEndOffset))return n.done=!0,{offset:e,currentLength:t,paragraph:l,tableWidget:i};for(var h=i.firstChild;h;){if((e-=1)===t){if(o||this.documentEditor.selectionModule.isEndOffset)return n.done=!0,{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:h.index,rowWidget:h};if(s)return n.done=!0,{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:(m=l.associatedCell).cellIndex+1,cellWidget:m}}for(var c=h.firstChild;c;){if((e-=1)===t)if(s)return n.done=!0,{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:c.cellIndex,cellWidget:c};for(var p=c.firstChild;p;){var u=this.getBlockPosition(e,t,p,n,r,o,s);if(n.done){if(o&&(0,a.isNullOrUndefined)(u.rowWidget)){n.done=!0;var g=c.ownerRow;return{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:g.index+1,rowWidget:g}}var m;return s&&(0,a.isNullOrUndefined)(u.cellWidget)?(n.done=!0,{offset:e,currentLength:t,paragraph:l,rowOrCellIndex:(m=c).cellIndex+1,cellWidget:m}):u}e=u.offset,t=u.currentLength,l=u.paragraph,p=p.getSplitWidgets().pop().nextRenderedWidget}c=c.nextWidget}var f=h.ownerTable.index;(h=h.getSplitWidgets().pop().nextRenderedWidget)&&h.ownerTable.index!==f&&(h=void 0)}}return{offset:e,currentLength:t,paragraph:l}},e.prototype.getBlockTotalLength=function(e,t,i,n,r,o,s){var l=i.getSplitWidgets(),d=0;if(t+1>=e)return n.done=!0,{offset:e-1,currentLength:t,paragraph:i};for(var h=0,c=0;c<l.length;c++)for(var p=0;p<l[c].childWidgets.length;p++)for(var u=l[c].childWidgets[p],g=0;g<u.children.length;g++){var m=u.children[g];if(!(m instanceof md)){if(m instanceof hd&&!(0,a.isNullOrUndefined)(m.textFrame)&&m.textFrame.childWidgets.length>0||m instanceof Yl){var f=void 0;if(m instanceof hd)for(var v=t+h+d+1,y=0;y<m.textFrame.childWidgets.length;y++)v=(f=this.getBlockPosition(e,v,m.textFrame.childWidgets[y],n,r,o,s)).currentLength,e=f.offset;else{v=t+h+d+1;for(var w=0;w<m.bodyWidget.childWidgets.length&&!n.done;w++)v=(f=this.getBlockPosition(e,v,m.bodyWidget.childWidgets[w],n,r,o,s)).currentLength,e=f.offset}if(e=f.offset,h+=f.currentLength-(t+d+1+h),n.done)return t=f.currentLength,f}if(t+h+(d+=m.length)+1>=(e+=m.skipformFieldLength?m.length:0))return n.done=!0,{offset:e-1,currentLength:t+h,paragraph:i}}}return t+h+d+1+1==e&&this.documentEditor.selection.isEndOffset&&!this.documentEditor.selection.isFootEndNoteParagraph(i)?(n.done=!0,{offset:e-1,currentLength:t+h,paragraph:i}):{offset:e,currentLength:t+=d+h+1,paragraph:i}},e.prototype.getRelativePositionFromAbsolutePosition=function(e,t,i,n){var r=this.documentEditor,o=this.documentEditor.documentHelper.pages[0].bodyWidgets[0].childWidgets[0],s=0,a={done:!1},l=this.getBlockByIndex(o,e,s,a,t,i,n);if(a.done){(p=l.offset-l.currentLength)<0&&(p=0);var d={paragraph:l.paragraph,offset:p};return t||i||n?l:r.selectionModule.getHierarchicalIndex(d.paragraph,d.offset.toString())}if(l.offset===l.currentLength+1&&this.documentEditor.selection.isEndOffset){var h=this.documentEditor.selection.getParagraphLength(l.paragraph);return s=l.currentLength-h,r.selection.getHierarchicalIndex(l.paragraph,(l.offset-s).toString())}var c=this.getBlockIndexFromHeaderFooter(l.offset,l.currentLength,a,t,i,n);if(a.done){var p;(p=c.offset-c.currentLength)<0&&(p=0);d={paragraph:c.paragraph,offset:p};return t||i||n?c:r.selectionModule.getHierarchicalIndex(d.paragraph,d.offset.toString())}return""},e.prototype.getBlockIndexFromHeaderFooter=function(e,t,i,n,r,o){for(var s,a=0,l=this.documentEditor.documentHelper.headersFooters;a<l.length;a++)for(var d=l[a],h=0;h<6;h++){var c=d[h];if(c){if(t=(s=this.getBlockByIndex(c.childWidgets[0],e,t,i,n,r,o)).currentLength,e=s.offset,i.done)return s}else{if(t+1>=e)return i.done=!0,s;t++,s.currentLength=t}}return s},e.prototype.getBlockByIndex=function(e,t,i,n,r,o,s){var a;do{if(i=(a=this.getBlockPosition(t,i,e,n,r,o,s)).currentLength,t=a.offset,n.done)return a;e=e.getSplitWidgets().pop().nextRenderedWidget}while(e);return a},e.prototype.insertImage=function(e){(0,a.isNullOrUndefined)(e.metaString)?this.documentEditor.editorModule.insertImageInternal(e.imageString,!0,Pa.convertPointToPixel(e.width),Pa.convertPointToPixel(e.height),e.alternativeText):(this.documentEditor.editorModule.isImageInsert=!0,this.documentEditor.editorModule.insertImageInternal(e.metaString,!0,Pa.convertPointToPixel(e.width),Pa.convertPointToPixel(e.height),e.alternativeText))},e.prototype.buildTable=function(e){for(var t=0,i=0,n=0;n<e.length;n++)e[n].text===o.Row&&((0,a.isNullOrUndefined)(e[n].markerData)||((0,a.isNullOrUndefined)(this.documentEditor.editorModule.revisionData)&&(this.documentEditor.editorModule.revisionData=[]),this.documentEditor.editorModule.revisionData.push(e[n].markerData)),t++);for(n=0;n<e.length&&(e[n].text===o.Cell&&(n+=2,i++),e[n].text===o.Table||!(0,a.isNullOrUndefined)(e[n+1])&&e[n+1].text!==o.Row);n++);this.documentEditor.editorModule.insertTable(t,i),this.documentEditor.editorModule.revisionData=void 0},e.prototype.buildRow=function(e){var t,i=[],n=[],r=[],s=0,l=0,d=this.getRelativePositionFromAbsolutePosition(e[0].offset,!1,!0,!1),h=d.rowWidget.ownerTable.combineWidget(this.documentEditor.viewer);if(!(0,a.isNullOrUndefined)(e[0].markerData)&&(0,a.isNullOrUndefined)(e[0].format)){var c=d.rowWidget;if(c.rowFormat.revisions.length>0)return void c.rowFormat.revisions[0].accept()}for(var p=0;p<e.length;p++){var u=e[p];if(u.text===o.Cell&&(s++,i.push(JSON.parse(u.format)),n.push(JSON.parse(e[p+1].format)),r.push(JSON.parse(e[p+2].format)),p+=2),(0,a.isNullOrUndefined)(e[p+1])||e[p+1].text===o.Row)break}for(p=0;p<e.length;p++)e[p].text===o.Row&&((0,a.isNullOrUndefined)(e[p].markerData)||((0,a.isNullOrUndefined)(this.documentEditor.editorModule.revisionData)&&(this.documentEditor.editorModule.revisionData=[]),this.documentEditor.editorModule.revisionData.push(e[p].markerData)),l++,t=JSON.parse(e[p].format));this.documentEditor.editorModule.rowInsertionForCE(d.rowOrCellIndex,s,l,h,t,i,n,r),i=[],n=[],r=[],this.documentEditor.editorModule.revisionData=void 0},e.prototype.buildCell=function(e,t,i){var n=this.getRelativePositionFromAbsolutePosition(e.offset,!1,!1,!0);e.length>0?(this.rowWidget=n.cellWidget.ownerRow,this.documentEditor.editorModule.cellInsertionForCE(n.rowOrCellIndex,this.rowWidget,JSON.parse(e.format),JSON.parse(t),JSON.parse(i))):this.documentEditor.documentHelper.owner.parser.parseCellFormat(JSON.parse(e.format),n.cellWidget.cellFormat,0)},e.prototype.buildDeleteCells=function(e){var t=this.getRelativePositionFromAbsolutePosition(e.offset,!1,!1,!0);if(!(0,a.isNullOrUndefined)(t.cellWidget)){var i=this.documentEditor.selectionModule.getFirstParagraph(t.cellWidget),n=this.documentEditor.selectionModule.getLastParagraph(t.cellWidget);(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(n)||(this.documentEditor.selectionModule.start.setPosition(i.firstChild,!0),this.documentEditor.selectionModule.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)),this.documentEditor.editorModule.checkAndRemoveComments(),this.table=t.cellWidget.ownerTable.combineWidget(this.documentEditor.viewer);var r=void 0;if(t.cellWidget.nextWidget){var o=t.cellWidget.nextWidget;r=this.documentEditor.selectionModule.getFirstParagraph(o)}else if(t.cellWidget.previousWidget){var s=t.cellWidget.previousWidget;r=this.documentEditor.selectionModule.getFirstParagraph(s)}(0,a.isNullOrUndefined)(r)&&(r=this.documentEditor.editorModule.getParagraphForSelection(this.table)),e.length+=this.documentEditor.editorModule.onDeleteColumn(this.table,[t.cellWidget]),this.table.updateRowIndex(0),this.documentEditor.selectionModule.selectParagraphInternal(r,!0)}},e.prototype.transformSelectionOperation=function(e,t){if("Delete"===e.action&&("Delete"===t.action||"Format"==t.action)){var i=t.offset,n=t;if(e.offset+e.length<=n.offset||e.offset>=n.offset+n.length)return;if(e.offset>=n.offset&&e.offset+e.length<=n.offset+n.length)return t.offset=t.offset,t.length-=e.length,void(t.length<=0&&(t.skipOperation=!0));if(e.offset<n.offset&&e.offset+e.length<=n.offset+n.length)return t.offset=e.offset+e.length,void(t.length-=t.offset-i);if(e.offset>=n.offset&&e.offset+e.length>n.offset+n.length)return void(t.length-=t.offset+t.length-e.offset);if(e.offset<n.offset&&e.offset+e.length>n.offset+n.length)return n.offset=e.offset,n.length=0,void(t.skipOperation=!0)}},e.prototype.documentSettings=function(e){switch(this.documentEditor.skipSettingsOps=!0,e.text){case"enableTrackChanges":this.documentEditor.enableTrackChanges=e.enableTrackChanges;break;case"protection":this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(this.documentEditor.documentHelper.restrictEditingPane.isShowRestrictPane),(0,a.isNullOrUndefined)(e.protectionData.saltValue)?(0,a.isNullOrUndefined)(e.protectionData.hashValue)?this.documentEditor.editorModule.unProtectDocument():this.documentEditor.editorModule.validateHashValue(e.protectionData.hashValue):""===e.protectionData.hashValue&&""===e.protectionData.saltValue?this.documentEditor.editorModule.protectDocument(e.protectionData.protectionType):this.documentEditor.editorModule.enforceProtectionAssign(e.protectionData.saltValue,e.protectionData.hashValue,e.protectionData.protectionType)}},e.prototype.checkAndRetriveChangesFromServer=function(){var e=this;if(!this.isSyncServerChanges){var t={version:this.version,connectionId:this.connectionId,roomName:this.roomName},i=new XMLHttpRequest;i.open("Post",this.serviceUrl+"GetActionsFromServer",!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.setCustomAjaxHeaders(i),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status||304===i.status)e.applyChangesFromServer(i.responseText);else{var t={status:i.status.toString(),statusText:i.statusText,url:e.serviceUrl+"GetActionsFromServer"};e.documentEditor.fireServiceFailure(t)}},i.send(JSON.stringify(t)),this.isSyncServerChanges=!0}},e.prototype.applyChangesFromServer=function(e){var t=JSON.parse(e);if(t.length>0){for(var i=0;i<t.length;i++){var n=t[i];n.connectionId===this.connectionId?(this.acknowledgementReceived(),this.logMessage(this.isSyncServerChanges?"SignalR Server sync"+n.version:"SignalR Same user sync:"+n.version)):(this.handleRemoteOperation(n),this.logMessage("Received: "+JSON.stringify(JSON.stringify(n)))),this.updateVersion(n.version),this.logMessage("Server sync ack:"+n.version)}this.updateVersion(t[t.length-1].version)}this.isSyncServerChanges=!1,this.isAcknowledgePending()||this.acknowledgementReceived(),this.sendLocalOperation()},e.prototype.insertCharaterFormat=function(e,t){var i=new ka(void 0),n=JSON.parse(t),r=Object.keys(n);this.documentEditor.documentHelper.owner.parser.parseCharacterFormat(0,n,i),r.length>1?(this.documentEditor.documentHelper.owner.fontDialogModule.onCharacterFormat(this.documentEditor.selectionModule,i),this.documentEditor.editorModule.onApplyCharacterFormat("CharacterFormat",i)):1===r.length?-1!==r.indexOf("styleName")?(0,a.isNullOrUndefined)(n.styleName)?this.documentEditor.editorModule.onApplyCharacterFormat("styleName",null,!1,!0):this.documentEditor.editorModule.applyStyle(n.styleName):-1!==r.indexOf("Uppercase")||-1!==r.indexOf("Lowercase")||-1!==r.indexOf("SentenceCase")||-1!==r.indexOf("ToggleCase")||-1!==r.indexOf("CapitalizeEachWord")?this.documentEditor.editorModule.changeCase(r[0]):"increment"===e||"decrement"===e?this.documentEditor.editorModule.onApplyCharacterFormat(r[0],e,!0):this.documentEditor.editorModule.onApplyCharacterFormat(r[0],n[r[0]]):this.documentEditor.editorModule.clearFormatting()},e.prototype.insertParagraphFormat=function(e,t){var i=new ba(void 0),n=JSON.parse(t),r=!1;(0,a.isNullOrUndefined)(n.isFirstParaForList)||(delete n.isFirstParaForList,r=!0);var o=Object.keys(n);if(this.documentEditor.documentHelper.owner.parser.parseParagraphFormat(0,n,i),1===o.length)if(-1!==o.indexOf("styleName"))this.documentEditor.editorModule.applyStyle(n.styleName);else if("borders"===o[0])this.documentEditor.editorModule.onApplyParagraphFormat(o[0],i.borders,!1,!1);else if("listFormat"===o[0]){this.updateList(e,i);var s=this.documentEditor.documentHelper.getListById(n.listFormat.nsid,!0);(0,a.isNullOrUndefined)(s)||(i.listFormat.listId=s.listId,i.listFormat.list=s),this.documentEditor.editorModule.onApplyParagraphFormat("listFormat",i.listFormat,!1,!1)}else this.documentEditor.editorModule.onApplyParagraphFormat(o[0],n[o[0]],r,!1);else this.documentEditor.documentHelper.owner.paragraphDialogModule.onParagraphFormat(i)},e.prototype.insertTableFormat=function(e,t,i){var n=new Ra(void 0),r=JSON.parse(t),o=Object.keys(r);this.documentEditor.documentHelper.owner.parser.parseTableFormat(r,n,0);var s=this.getRelativePositionFromAbsolutePosition(i,!0,!1,!1).tableWidget;if((0,a.isNullOrUndefined)(e))1===o.length?this.documentEditor.editorModule.onApplyTableFormat(o[0],r[o[0]],s):-1!==o.indexOf("borders")||-1!==o.indexOf("shading")?(this.documentEditor.editorModule.isBordersAndShadingDialog=!0,this.documentEditor.editorModule.onTableFormat(n,!0,s),this.documentEditor.editorModule.isBordersAndShadingDialog=!1):-1!==o.indexOf("cellSpacing")||-1!==o.indexOf("leftMargin")||-1!==o.indexOf("topMargin")||-1!==o.indexOf("rightMargin")||-1!==o.indexOf("bottomMargin")?this.documentEditor.documentHelper.owner.tableOptionsDialogModule.applySubTableOptions(n,s):this.documentEditor.editorModule.onTableFormat(n,!1,s);else{var l="TableAutoFitToContents"===e?"FitToContents":"TableAutoFitToWindow"===e?"FitToWindow":"FixedColumnWidth";this.documentEditor.editorModule.insertAutoFitTable(l,s)}},e.prototype.insertRowFormat=function(e,t){var i=new Ca(void 0),n=JSON.parse(t),r=Object.keys(n);this.documentEditor.documentHelper.owner.parser.parseRowFormat(n,i,0),1===r.length?this.documentEditor.editorModule.onApplyTableRowFormat(r[0],n[r[0]]):this.documentEditor.editorModule.onRowFormat(i)},e.prototype.insertCellFormat=function(e){if(this.documentEditor.selectionModule.start.paragraph.isInsideTable){var t=new Ma(void 0),i=JSON.parse(e),n=Object.keys(i);this.documentEditor.documentHelper.owner.parser.parseCellFormat(i,t,0);var r=this.documentEditor.selectionModule.start.paragraph.associatedCell.cellFormat;1===n.length?("shading"===n[0]?this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,n[0],t.shading,r):"borders"===n[0]?this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,n[0],t.borders,r):this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,n[0],i[n[0]],r),this.rowWidget=this.documentEditor.selectionModule.start.paragraph.associatedCell.ownerRow):-1!==n.indexOf("preferredWidth")||-1!==n.indexOf("preferredWidthType")||-1!==n.indexOf("verticalAlignment")||-1!==n.indexOf("borders")||-1!==n.indexOf("shading")?(-1===n.indexOf("borders")&&-1===n.indexOf("shading")||(this.documentEditor.editorModule.isBordersAndShadingDialog=!0),this.documentEditor.editorModule.applyCellPropertyValue(this.documentEditor.selectionModule,void 0,t,r),this.rowWidget=this.documentEditor.selectionModule.start.paragraph.associatedCell.ownerRow,this.documentEditor.editorModule.isBordersAndShadingDialog=!1):this.documentEditor.documentHelper.owner.cellOptionsDialogModule.applySubCellOptions(t)}},e.prototype.insertSectionFormat=function(e,t){var i=JSON.parse(t),n=Object.keys(i);if("linkToPrevious"===n[0]){var r=this.documentEditor.selectionModule.start.paragraph.bodyWidget,o=r.sectionIndex,s=r.headerFooterType;this.documentEditor.editorModule.removeInlineHeaderFooterWidget(o,s,e,i.linkToPrevious)}else if(n.length>1){var a=new ga;this.documentEditor.documentHelper.owner.parser.parseSectionFormat(0,i,a),this.documentEditor.editorModule.onApplySectionFormat(void 0,a)}else this.documentEditor.editorModule.onApplySectionFormat(Object.keys(i)[0],i[Object.keys(i)[0]])},e.prototype.logMessage=function(e){this.logEventEnabled&&(this.message+=e+" \n")},e.prototype.setCustomAjaxHeaders=function(e){for(var t=0;t<this.documentEditor.headers.length;t++)for(var i=this.documentEditor.headers[t],n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];e.setRequestHeader(o,i[o])}},e.prototype.destroy=function(){this.version=void 0,this.documentEditor=void 0,this.roomName=void 0,this.userMap=void 0,this.connectionId=void 0,this.acknowledgmentPending=void 0,this.pendingOps=void 0,this.serviceUrl=void 0,this.isSyncServerChanges=void 0,this.message=void 0,this.rowWidget=void 0},e}(),lp=function(){function e(e,t,i,n){this.color=e,this.caret=t,this.offset=i,this.userName=n,this.initializeElement()}return e.prototype.initializeElement=function(){this.hoverDiv=(0,a.createElement)("div",{className:"e-de-user-info e-de-user-name-collapse",styles:"z-index: 1; visibility: hidden;left:-4px;position:absolute;width:20px;height:20px;pointer-events:all;"}),this.userViewContainer=(0,a.createElement)("div"),this.spanViewContainer=(0,a.createElement)("div",{styles:"background-color:"+this.color+";left: 0px; top: 15px; visibility: visible;"}),this.spanView=(0,a.createElement)("span",{styles:"background-color:"+this.color+"; left: 0px;top:-4px;pointer:default"}),this.spanViewContainer.appendChild(this.spanView),this.userViewContainer.appendChild(this.spanViewContainer),this.hoverDiv.appendChild(this.userViewContainer),this.caret.appendChild(this.hoverDiv),this.hoverDiv.addEventListener("mouseenter",this.onMouseEnter.bind(this)),this.hoverDiv.addEventListener("mouseleave",this.onMouseLeave.bind(this))},e.prototype.onMouseEnter=function(){this.hoverDiv.classList.remove("e-de-user-name-collapse"),this.hoverDiv.classList.add("e-de-user-name-expended"),this.spanView.innerText=this.userName},e.prototype.onMouseLeave=function(){this.hoverDiv.classList.add("e-de-user-name-collapse"),this.hoverDiv.classList.remove("e-de-user-name-expended"),this.spanView.innerText=""},e}(),dp=function(){function e(e){var t=this;this.list=void 0,this.noteNumberFormat=void 0,this.sectionFormat=void 0,this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus(),t.unWireEventsAndBindings()},this.loadFontDialog=function(){var e,i;if(t.documentHelper.updateFocus(),i=t.sectionFormat?t.sectionFormat:t.documentHelper.owner.selectionModule.sectionFormat,t.documentHelper.selection.isinFootnote){var n=i.footNoteNumberFormat,r=i.initialFootNoteNumber;e=t.reversetype(n),t.notesList.value=e,t.startValueTextBox.value=r}else{var o=i.endnoteNumberFormat;e=t.reversetype(o);r=i.initialEndNoteNumber;t.notesList.value=e,t.startValueTextBox.value=r}},this.onInsertFootnoteClick=function(){var e=new ga(void 0);if(!(0,a.isNullOrUndefined)(t.notesList)){var i=t.notesList.value.toString(),n=t.types(i),r=t.startValueTextBox.value;(0,a.isNullOrUndefined)(t.notesList)||(t.documentHelper.selection.isinFootnote?(e.footNoteNumberFormat=n,e.initialFootNoteNumber=r,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e)):(e.endnoteNumberFormat=n,e.initialEndNoteNumber=r,t.documentHelper.owner.editorModule.onApplySectionFormat(void 0,e)))}t.documentHelper.hideDialog()},this.unWireEventsAndBindings=function(){t.notesList.value=void 0},this.documentHelper=e}return e.prototype.getModuleName=function(){return"FootNotesDialog"},e.prototype.notesDialog=function(e,t){var i=this.documentHelper.owner.containerId+"_insert_Footnote";this.target=(0,a.createElement)("div",{id:i,className:"e-de-insert-footnote"}),this.firstDiv=(0,a.createElement)("div"),this.startatValue=(0,a.createElement)("div"),this.footCount=(0,a.createElement)("input",{attrs:{type:"text"},id:this.documentHelper.owner.containerId+"row"}),this.startatValue.appendChild(this.footCount),this.numberFormatDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.formatType=(0,a.createElement)("select",{id:this.target.id+"_papersize",styles:"padding-bottom: 20px;",innerHTML:'<option value="1, 2, 3, ...">'+e.getConstant("1, 2, 3, ...")+'</option><option value="a, b, c, ...">'+e.getConstant("a, b, c, ...")+'</option><option value="A, B, C, ...">'+e.getConstant("A, B, C, ...")+'</option><option value="I, II, III, ...">'+e.getConstant("I, II, III, ...")+'</option><option value="i, ii, iii, ...">'+e.getConstant("i, ii, iii, ...")+"</option>"}),this.numberFormatDiv.appendChild(this.formatType),this.notesList=new al.DropDownList({enableRtl:t,placeholder:e.getConstant("Number format"),floatLabelType:"Always",htmlAttributes:{"aria-labelledby":e.getConstant("Number format")}}),this.notesList.appendTo(this.formatType),this.firstDiv.appendChild(this.numberFormatDiv),this.firstDiv.appendChild(this.startatValue),this.target.appendChild(this.firstDiv),this.startValueTextBox=new rl.NumericTextBox({format:"#",min:1,max:99999,enablePersistence:!1,placeholder:e.getConstant("Start at"),floatLabelType:"Always"}),this.startValueTextBox.appendTo(this.footCount),this.footCount.setAttribute("aria-labelledby",e.getConstant("Start at"))},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);if(e.setLocale(this.documentHelper.owner.locale),this.target||this.notesDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.selection.isinFootnote?this.documentHelper.dialog.header=e.getConstant("Footnote"):this.documentHelper.dialog.header=e.getConstant("Endnote"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.loadFontDialog,this.documentHelper.dialog.buttons=[{click:this.onInsertFootnoteClick,buttonModel:{content:e.getConstant("Apply"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.startValueTextBox.value=1,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show(),this.documentHelper.selection.isinEndnote){var t=this.endnoteListValue(this.list);this.notesList.index=t}},e.prototype.types=function(e){switch(e){case"1, 2, 3, ...":default:return"Arabic";case"A, B, C, ...":return"UpperCaseLetter";case"a, b, c, ...":return"LowerCaseLetter";case"I, II, III, ...":return"LowerCaseRoman";case"i, ii, iii, ...":return"UpperCaseRoman"}},e.prototype.reversetype=function(e){switch(e){case"Arabic":default:return"1, 2, 3, ...";case"UpperCaseLetter":return"A, B, C, ...";case"LowerCaseLetter":return"a, b, c, ...";case"UpperCaseRoman":return"I, II, III, ...";case"LowerCaseRoman":return"i, ii, iii, ..."}},e.prototype.endnoteListValue=function(e){return"A, B, C, ..."===e?0:"1, 2, 3, ..."===e?1:"a, b, c, ..."===e?2:3},e.prototype.destroy=function(){this.footCount&&(this.footCount.parentElement&&this.footCount.parentElement.removeChild(this.footCount),this.footCount=void 0),this.startValueTextBox&&(this.startValueTextBox.destroy(),this.startValueTextBox=void 0),this.notesList&&(this.notesList.destroy(),this.notesList=void 0),this.removeElements(),this.footCount=void 0,this.documentHelper=void 0},e.prototype.removeElements=function(){this.firstDiv&&(this.firstDiv.remove(),this.firstDiv=void 0),this.startatValue&&(this.startatValue.remove(),this.startatValue=void 0),this.numberFormatDiv&&(this.numberFormatDiv.remove(),this.numberFormatDiv=void 0),this.formatType&&(this.formatType.remove(),this.formatType=void 0),this.target&&(this.target.remove(),this.target=void 0)},e}(),hp=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.isEmpty=function(){return 0===this.height&&0===this.width},e.prototype.clone=function(){return new e(this.width,this.height)},e}(),cp=function(){function e(e,t){this.interval=4,this.segmentWidth=47.9988,this.orientation="Horizontal",this.tickAlignment="RightOrBottom",this.markerColor="red",this.thickness=15,this.arrangeTick=null,this.length=400,this.offset=0,this.scale=1,this.rulerStartValue=1584,this.zeroPosition=Pa.convertPointToPixel(1584),this.addSegmentWidth=!1,this.element=e,this.rulerHelper=t}return e.prototype.appendTo=function(){this.preRender(),this.render()},e.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.updateRulerGeometry()},e.prototype.getModuleName=function(){return"Ruler"},e.prototype.destroy=function(){var e=this;this.unWireEvents(),this.rulerSpacediv&&(this.rulerSpacediv.remove(),this.rulerSpacediv=null),this.rulerSVGElement&&(this.rulerSVGElement.childNodes.forEach((function(t){e.rulerSVGElement.removeChild(t),t=null})),this.rulerSVGElement.innerHTML="",this.rulerSVGElement.remove(),this.rulerSVGElement=null),this.element.classList.remove("e-ruler")},e.prototype.showHideRuler=function(e){this.element.style.display=e?"block":"none"},e.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},e.prototype.renderRulerSpace=function(){var e=this.getRulerGeometry();return this.rulerSpacediv=document.getElementById(this.element.id+"_ruler_space"),this.rulerSpacediv||(this.rulerSpacediv=this.rulerHelper.createHtmlElement("div",{id:this.element.id+"_ruler_space",style:"height:"+e.height+"px;width:"+e.width+"px;cssFloat:left;"}),this.element.appendChild(this.rulerSpacediv)),this.rulerSpacediv},e.prototype.updateRuler=function(){var e=this.getRulerSize(),t=this.getRulerGeometry(),i=0,n=0,r=new hp;if(this.rulerSVGElement=this.getRulerSVG(t),this.rulerSVGElement&&(i=this.length,r.height=e,n=this.offset,i&&i!==1/0)){var o=i,s=n;this.updateSegments(s,o+Math.abs(s),this.rulerSVGElement,e)}},e.prototype.updateSegments=function(e,t,i,n){var r=e,o={trans:0};for(this.rulerStartValue=Pa.convertPixelToPoint(this.zeroPosition);r<t;){var s=this.getNewSegment(r,i);s&&(i.appendChild(s.segment),r=this.updateSegment(e,t,s,r,o,n))}this.addSegmentWidth=!1},e.prototype.updateSegment=function(e,t,i,n,r,o){var s=this.updateSegmentWidth(this.scale);if(n===e)this.startValue=Math.floor(e/s)*s/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.rulerStartValue.toString(),this.defStartValue=n=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=e-n:this.vRulerOffset=e-n;else{this.startValue=Pa.convertPixelToPoint(n),this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue;var a=void 0;0===this.rulerStartValue&&(this.addSegmentWidth=!0),a=this.addSegmentWidth?Math.abs(this.rulerStartValue+36):Math.abs(this.rulerStartValue-36),i.label.textContent=a.toString(),this.rulerStartValue=a}this.updateTickLabel(i,o);var l="Horizontal"===this.orientation?r.trans+.5+",0.5":"0.5,"+(r.trans+.5);return i.segment.setAttribute("transform","translate("+l+") scale(1,1)"),r.trans+=s*this.scale,n+=s},e.prototype.updateTickLabel=function(e,t){var i=e.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,r="RightOrBottom"===this.tickAlignment,o=n?-4:0,s=n?r?t/2+5.5-5.5:t/2+5.5:i.height;n&&(s+=2),n||(o+=10,s+=2);var a=r?-(i.width+2)+","+(t/2-i.height):-(i.width+2)+","+(t/2-i.height/2),l=n?{x:o,y:s}:{x:o,y:s,transform:"rotate(270)translate("+a+")"};this.rulerHelper.setAttributeSvg(e.segment.lastChild,l)},e.prototype.getNewSegment=function(e,t){var i=this.createNewTicks(e,t);return{segment:i,label:this.createTickLabel(t,i)}},e.prototype.createNewTicks=function(e,t){var i,n,r=this.updateSegmentWidth(this.scale),o=this.rulerHelper.createSvgElement("g",{class:"e-de-ruler-segment"}),s=this.rulerHelper.createSvgElement("rect",{class:"e-de-ruler-segment1"}),a="Horizontal"===this.orientation?r*this.scale:15,l="Horizontal"===this.orientation?15:r;s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("width",a.toString()),s.setAttribute("height",l.toString()),s.setAttribute("fill","lightgrey");for(var d=0;d<this.interval;d++)n=r/this.interval,(i=this.createTick(t,n,d+1,e))&&o.appendChild(i);return o},e.prototype.getLinePoint=function(e,t,i){var n=this.updateSegmentWidth(this.scale),r=this.getRulerSize();return i=(t*=i-1)%n==0?r:.3*r},e.prototype.createTick=function(e,t,i,n){var r,o=this.getLinePoint(e,t,i),s=this.getRulerSize(),a="Horizontal"===this.orientation,l="RightOrBottom"===this.tickAlignment,d=t*(i-1)*this.scale,h=a?d:l?s:0,c=a?d:l?s-o:s-(s-o),p=a?l?s:s-(s-o):d,u=a?l?s-o:0:d;if(0!==u){a||(h-=6,c-=6);var g={x1:h,y1:p-=6,x2:c,y2:u-=6,"stroke-width":"0.25",stroke:"black"};(r=this.rulerHelper.createSvgElement("line",g)).setAttribute("class","e-de-ruler-tick")}return r},e.prototype.createTickLabel=function(e,t){var i;if(t){i=this.rulerHelper.createSvgElement("text",{class:"e-de-ruler-tick-label",style:"font-weight: 400"}),t.appendChild(i)}return i},e.prototype.updateSegmentWidth=function(e){if(100!==this.segmentWidth)return this.segmentWidth;var t,i=1;for(t=100,t=100/Math.pow(2,Math.round(Math.log(e)/Math.log(2)));t>100;)i/=10,t/=10;for(;t<25;)i*=10,t*=10;return t>=25&&t%25!=0&&(t=25*Math.round(t/25)),t*e/i},e.prototype.getRulerGeometry=function(){return"Horizontal"===this.orientation?new hp(this.length,this.element?this.element.getBoundingClientRect().height:0):new hp(this.element?this.element.getBoundingClientRect().width:0,this.length)},e.prototype.getRulerSize=function(){return this.thickness},e.prototype.getRulerSVG=function(e){var t,i,n=this.getRulerSize();if(this.element&&(t=document.getElementById(this.element.id+"_ruler_space"))){var r={id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?this.length:n+"px",height:"Horizontal"===this.orientation?n:e.height+"px",style:"position:inherit;"};if(i=this.rulerHelper.createSvgElement("svg",r),t.childNodes.length>0)for(var o=t.childNodes.length-1;o>=0;o--)t.childNodes[parseInt(o.toString(),10)].parentNode.removeChild(t.childNodes[parseInt(o.toString(),10)]);t.appendChild(i)}return i},e.prototype.wireEvents=function(){},e.prototype.unWireEvents=function(){},e}(),pp=function(){function e(){this.resizerEnabled=!1,this.isDraggingRender=!1,this.isDraggingIndents1=!1,this.isDraggingIndents2=!1,this.isDraggingIndents3=!1,this.isDraggingIndents4=!1,this.isDraggingForTab=!1,this.currentTabStop=void 0,this.tabIndex=0,this.isLeftRulerMargin=void 0,this.isLeftMultiColumn=!1,this.isRightMultiColumn=!1,this.onmarkIndicatorClickHandler=this.onMarkIndicatorClick.bind(this),this.onHorizontalRulerMouseMoveHandler=this.onHorizontalRulerMouseMoved.bind(this),this.onHRulerMouseEnterHandler=this.onHRulerMouseEnter.bind(this),this.onHRulerMouseLeaveHandler=this.onHRulerMouseLeave.bind(this),this.onHRulerMouseDownHandler=this.onHRulerMouseDown.bind(this),this.onHRulerMouseUpHandler=this.onHRulerMouseUp.bind(this),this.onRulerDblClickHandler=this.onRulerDblClick.bind(this),this.onDoubleClickHandler=this.onDoubleClick.bind(this),this.onRulerMouseUpHandler=this.onRularMouseUp.bind(this),this.onVMouseMoveHandler=this.onVMouseMove.bind(this),this.onVMouseDownHandler=this.onVMouseDown.bind(this),this.onVMouseUpHandler=this.onVMouseUp.bind(this),this.onDocumentIntentTrueChangeHandler=this.onDocumentIntentTrue.bind(this),this.onDocumentIntentFalseChangeHandler=this.onDocumentIntentFalse.bind(this),this.onFirstLineIndentMouseDownHandler=this.onFirstLineIndentMouseDown.bind(this),this.onIndentMouseMoveHandler=this.onIndentMouseMove.bind(this),this.onIndentMouseUpHandler=this.onIndentMouseUp.bind(this),this.onHangIndentMouseDownHandler=this.onHangIndentMouseDown.bind(this),this.onHangIndentMouseMoveHandler=this.onHangIndentMouseMove.bind(this),this.onHangIndentMouseUpHandler=this.onHangIndentMouseUp.bind(this),this.onLeftIndentMouseDownHandler=this.onLeftIndentMouseDown.bind(this),this.onLeftIndentMouseMoveHandler=this.onLeftIndentMouseMove.bind(this),this.onLeftIndentMouseUpHandler=this.onLeftIndentMouseUp.bind(this),this.onRightIndentMouseDownHandler=this.onRightIndentMouseDown.bind(this),this.onRightIndentMouseMoveHandler=this.onRightIndentMouseMove.bind(this),this.onRightIndentMouseUpHandler=this.onRightIndentMouseUp.bind(this),this.onTabStopMouseDownHandler=this.onTabStopMouseDown.bind(this),this.onTabStopMouseUpHandler=this.onTabStopMouseUp.bind(this),this.onTabStopMouseMoveHandler=this.onTabStopMouseMove.bind(this),this.onRenderTabStopMouseUpHandler=this.onRenderTabStopMouseUp.bind(this),this.onTabStopDblClickHandler=this.onTabStopDblClick.bind(this),this.isTopRulerMargin=!1}return e.prototype.onMarkIndicatorClick=function(){for(var e=document.querySelector(".e-de-ruler-markIndicator"),t=0;t<e.childNodes.length;t++){var i=e.childNodes[parseInt(t.toString(),10)];if("block"===i.style.display){i.style.display="none";var n=(t+1)%e.childNodes.length;e.childNodes[parseInt(n.toString(),10)].style.display="block";break}}},e.prototype.onHRulerMouseEnter=function(){(0,a.isNullOrUndefined)(this.currentTabStopElement)||(this.currentTabStopElement.style.display="block")},e.prototype.onHRulerMouseLeave=function(){(0,a.isNullOrUndefined)(this.currentTabStopElement)||(this.currentTabStopElement.style.display="none")},e.prototype.onRulerDblClick=function(){this.documentEditor.showDialog("PageSetup")},e.prototype.onHRulerMouseDown=function(e){if(this.resizerEnabled&&!this.documentEditor.isTableMarkerDragging){this.isDraggingRender=!0,this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length>0&&(this.isLeftMultiColumn?this.columnInitialValue=this.multiColumnElement.getBoundingClientRect().left:this.isRightMultiColumn&&(this.columnInitialValue=this.multiColumnElement.getBoundingClientRect().left+this.multiColumnElement.getBoundingClientRect().width));var t=this.hRuler.getBoundingClientRect();this.renderInitialValue=Pa.convertPixelToPoint(Math.round(e.clientX-t.left)),this.currentScrollLeft=this.hRuler.scrollLeft;var i=document.getElementById(this.documentEditor.element.id+"_rightIndent");this.initialRightMargin=Pa.getNumberFromString(i.style.left);var n=Math.round(e.clientX-t.left),r=this.documentEditor.documentHelper.currentPage.boundingRectangle.x+n,o=document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg");o.style.left=r+"px",o.style.display="block"}var s=this.hRuler.getBoundingClientRect();if(s.y+s.height/2<=e.clientY)if(this.mouseDownTabValue=e.clientX-this.hRuler.getBoundingClientRect().left,"Pages"===this.documentEditor.layoutType){if(this.mouseDownTabValue=Pa.convertPixelToPoint(this.mouseDownTabValue-Pa.convertPointToPixel(this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)*this.documentEditor.zoomFactor),this.position.paragraph.paragraphFormat.bidi){var l=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());l=Pa.convertPixelToPoint(l*this.documentEditor.zoomFactor),this.mouseDownTabValue=l-this.mouseDownTabValue}}else if("Continuous"===this.documentEditor.layoutType)if(this.position.paragraph.paragraphFormat.bidi){this.mouseDownTabValue=Pa.convertPixelToPoint(this.mouseDownTabValue-20);l=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());l=Pa.convertPixelToPoint(l*this.documentEditor.zoomFactor),this.mouseDownTabValue=l-this.mouseDownTabValue}else this.mouseDownTabValue=Pa.convertPixelToPoint(this.mouseDownTabValue-20)},e.prototype.onHRulerMouseUp=function(e){var t=document.getElementById(this.documentEditor.element.id+"_markIndicator"),i=this.hRuler.getBoundingClientRect();if(i.y+i.height/2<=e.clientY){if(this.mouseUpTabValue=e.clientX-this.hRuler.getBoundingClientRect().left,"Pages"===this.documentEditor.layoutType){if(this.mouseUpTabValue=Pa.convertPixelToPoint(this.mouseUpTabValue-Pa.convertPointToPixel(this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)*this.documentEditor.zoomFactor),this.position.paragraph.paragraphFormat.bidi){var n=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());n=Pa.convertPixelToPoint(n*this.documentEditor.zoomFactor),this.mouseUpTabValue=n-this.mouseUpTabValue}}else if("Continuous"===this.documentEditor.layoutType)if(this.position.paragraph.paragraphFormat.bidi){this.mouseUpTabValue=Pa.convertPixelToPoint(this.mouseUpTabValue-20);n=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());n=Pa.convertPixelToPoint(n*this.documentEditor.zoomFactor),this.mouseUpTabValue=n-this.mouseUpTabValue}else this.mouseUpTabValue=Pa.convertPixelToPoint(this.mouseUpTabValue-20);var r=document.getElementById(this.documentEditor.element.id+"_rightIndent"),o=Pa.getNumberFromString(r.style.left);if(this.mouseUpTabValue>0&&this.mouseUpTabValue<o&&this.mouseDownTabValue===this.mouseUpTabValue&&!(0,a.isNullOrUndefined)(t)){var s=t.querySelector('.e-de-ruler-marker[style*="display: block;"]');if(!(0,a.isNullOrUndefined)(s)){this.mouseUpTabValue/=this.documentEditor.zoomFactor;var l=s.getAttribute("data-name");if("LeftTab"===l||"CenterTab"===l||"RightTab"===l||"DecimalTab"===l||"BarTab"===l){var d=new wa;d.position=this.mouseUpTabValue,d.tabJustification=this.getTabJustification(l),d.deletePosition=0,d.tabLeader="None",this.documentEditor.editorModule.onApplyParagraphFormat("tabStop",[d],!1,!1)}else if("FirstLineIndent"===l||"HangingIndent"===l){if("HangingIndent"===l){var h=this.documentEditor.selectionModule.paragraphFormat.firstLineIndent,c=this.mouseUpTabValue+h,p=this.documentEditor.selectionModule.start.paragraph.paragraphFormat.firstLineIndent;this.documentEditor.editorModule.onApplyParagraphFormat("firstLineIndent",p-c,!1,!1);var u=this.documentEditor.selectionModule.start.paragraph.paragraphFormat.leftIndent+p;p-=c,this.documentEditor.editorModule.onApplyParagraphFormat("leftIndent",u-p,!1,!1,!0)}else this.documentEditor.editorModule.onApplyParagraphFormat("firstLineIndent",this.mouseDownTabValue,!1,!1)}}}}},e.prototype.onRularMouseUp=function(e){if(this.isDraggingRender&&!this.documentEditor.isTableMarkerDragging){this.hRuler.getBoundingClientRect();var t=this.finalmouseXRelativeToDiv;if(this.isLeftMultiColumn||this.isRightMultiColumn){var i;i=e.clientX-this.columnInitialValue;for(var n=this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.cloneFormat(),r=this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin-this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin,o=this.isLeftMultiColumn?n.columns[0].space+Pa.convertPixelToPoint(i):n.columns[0].space-Pa.convertPixelToPoint(i),s=0;s<n.columns.length;s++){var a=n.columns[parseInt(s.toString(),10)];if(o>=0&&a.width>=36){var l=Pa.convertPointToPixel((r-Pa.convertPixelToPoint(o)*(n.numberOfColumns-1))/n.numberOfColumns);a.width=l,s<n.columns.length-1&&(a.space=o)}else a[0].space=a[1].space}this.documentEditor.editorModule.onApplySectionFormat(void 0,n),this.isLeftMultiColumn=!1,this.isRightMultiColumn=!1}else if(this.isLeftRulerMargin)this.documentEditor.hRuler.startMargin=t/this.documentEditor.zoomFactor,this.documentEditor.selectionModule.sectionFormat.leftMargin=t/this.documentEditor.zoomFactor;else{var d=Pa.convertPixelToPoint(this.rulerGeometry.width)-t/this.documentEditor.zoomFactor;this.documentEditor.selectionModule.sectionFormat.rightMargin=d}this.resizerEnabled=!1,this.isDraggingRender=!1,this.isLeftRulerMargin=void 0,document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.display="none"}},e.prototype.onVMouseMove=function(e){if(!this.documentEditor.isDestroyed&&this.documentEditor.documentEditorSettings.showRuler){var t=this.vRuler.getBoundingClientRect(),i=this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin*this.documentEditor.zoomFactor,n=Pa.convertPixelToPoint(t.height)-this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*this.documentEditor.zoomFactor,r=Pa.convertPixelToPoint(Math.round(e.clientY-t.top)),o=Math.round(e.clientY-t.top);if(this.isDraggingRender||(i-3<=r&&i+3>=r?(this.vRuler.style.cursor="n-resize",this.vRuler.setAttribute("title",this.locale.getConstant("Top Margin")),this.resizerEnabled=!0,this.isTopRulerMargin=!0):n-3<=r&&n+3>=r?(this.vRuler.style.cursor="n-resize",this.vRuler.setAttribute("title",this.locale.getConstant("Bottom Margin")),this.resizerEnabled=!0,this.isTopRulerMargin=!1):(this.vRuler.style.cursor="default",this.vRuler.hasAttribute("title")&&this.vRuler.removeAttribute("title"),this.resizerEnabled=!1)),this.isDraggingRender){var s=Pa.convertPixelToPoint(Math.round(e.clientY-t.top)),a=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.topMargin)*this.documentEditor.zoomFactor,l=this.documentEditor.selectionModule.sectionFormat.pageHeight,d=this.documentEditor.selectionModule.sectionFormat.bottomMargin,h=this.documentEditor.selectionModule.sectionFormat.topMargin;if(this.isTopRulerMargin){var c=a,p=a+Pa.convertPointToPixel(l-d-12)*this.documentEditor.zoomFactor;o+a>p?(o=p-a,s=Pa.convertPixelToPoint(o)):o+a<c&&(o=c-a,s=Pa.convertPixelToPoint(o))}else{var u=a+Pa.convertPointToPixel(h+12)*this.documentEditor.zoomFactor,g=a+Pa.convertPointToPixel(l)*this.documentEditor.zoomFactor;o+a>g?(o=g-a,s=Pa.convertPixelToPoint(o)):o+a<u&&(o=u-a,s=Pa.convertPixelToPoint(o))}var m=Pa.convertPixelToPoint(t.height)-this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*this.documentEditor.zoomFactor;this.resizeVRulerMargins(this.isTopRulerMargin,this.initialYValue,this.currentScrollTop,m,this.vRuler,s,this.documentEditor);var f=this.documentEditor.documentHelper.currentPage.boundingRectangle.y*this.documentEditor.zoomFactor+o;document.getElementById(this.documentEditor.element.id+"_vRuler_indicator_svg").style.top=f+"px"}}},e.prototype.onVMouseDown=function(e){if(this.resizerEnabled){this.isDraggingRender=!0;var t=this.vRuler.getBoundingClientRect();this.initialYValue=Pa.convertPixelToPoint(Math.round(e.clientY-t.top)),this.currentScrollTop=this.vRuler.scrollTop;var i=Math.round(e.clientY-t.top),n=document.getElementById(this.documentEditor.element.id+"_vRuler_indicator_svg"),r=this.documentEditor.documentHelper.currentPage.boundingRectangle.y*this.documentEditor.zoomFactor+i;n.style.top=r+"px",n.style.display="block"}},e.prototype.onVMouseUp=function(e){if(this.isDraggingRender){var t=this.vRuler.getBoundingClientRect(),i=Pa.convertPixelToPoint(Math.round(e.clientY-t.top));if(this.isTopRulerMargin)this.documentEditor.vRuler.startMargin=i/this.documentEditor.zoomFactor,this.documentEditor.selectionModule.sectionFormat.topMargin=i/this.documentEditor.zoomFactor;else{var n=Pa.convertPixelToPoint(this.rulerGeometry.height)-i/this.documentEditor.zoomFactor;this.documentEditor.vRuler.endMargin=n,this.documentEditor.selectionModule.sectionFormat.bottomMargin=n}this.resizerEnabled=!1,this.isDraggingRender=!1,document.getElementById(this.documentEditor.element.id+"_vRuler_indicator_svg").style.display="none",this.isTopRulerMargin=void 0}},e.prototype.onDocumentIntentTrue=function(){this.documentEditor.isOnIndent=!0},e.prototype.onDocumentIntentFalse=function(){this.documentEditor.isOnIndent=!1},e.prototype.onDoubleClick=function(e){this.documentEditor.showDialog("Paragraph"),e.stopPropagation()},e.prototype.onFirstLineIndentMouseDown=function(e){this.isDraggingIndents1=!0,this.firstLineOffset=e.clientX-this.firstLineIndent.getBoundingClientRect().left,this.indentInitialValue=Pa.getNumberFromString(this.firstLineIndent.style.left);var t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor;this.documentEditor.selectionModule.paragraphFormat.bidi&&(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor),"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20,this.documentEditor.selectionModule.paragraphFormat.bidi&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor));var i=t+e.clientX-this.firstLineOffset-this.hRuler.getBoundingClientRect().left,n=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,r=(n="Continuous"===this.documentEditor.layoutType?0:n)+(i-t)+6,o=document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg");o.style.left=r+"px",o.style.display="block",e.stopPropagation()},e.prototype.onIndentMouseMove=function(e){if(this.isDraggingIndents1){var t=void 0,i=void 0,n=void 0,r=document.getElementById(this.documentEditor.element.id+"_rightIndent"),o=Pa.getNumberFromString(r.style.left);"Pages"===this.documentEditor.layoutType?this.documentEditor.selectionModule.paragraphFormat.bidi?(i=(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor)-6+Pa.convertPointToPixel(this.documentEditor.selectionModule.sectionFormat.pageWidth)*this.documentEditor.zoomFactor,n=o+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor):(n=(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor)-6,i=o-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor):"Continuous"===this.documentEditor.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor,i=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20+40-6,n=o+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor):(n=(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20)-6,i=o-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor));var s=t+e.clientX-this.firstLineOffset-this.hRuler.getBoundingClientRect().left;s<n?s=n:s>i&&(s=i),this.firstLineIndent.style.left=s+"px";var a=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,l=(a="Continuous"===this.documentEditor.layoutType?0:a)+(s-t)+6;document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.left=l+"px"}},e.prototype.onIndentMouseUp=function(e){if(this.isDraggingIndents1){this.isDraggingIndents1=!1;var t=Pa.getNumberFromString(this.firstLineIndent.style.left);parseInt(this.firstLineIndent.style.left.replace("px",""),10)<0&&(t*=-1),this.documentEditor.selectionModule.paragraphFormat.bidi?this.documentEditor.editorModule.applyRulerMarkerValues("firstLineIndent",t,this.indentInitialValue):this.documentEditor.editorModule.applyRulerMarkerValues("firstLineIndent",this.indentInitialValue,t),this.indentInitialValue=t,document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.display="none"}},e.prototype.onHangIndentMouseDown=function(e){this.isDraggingIndents2=!0,this.hangingLineOffset=e.clientX-this.hangingIndent.getBoundingClientRect().left,this.hangingIndentInitialValue=Pa.getNumberFromString(this.hangingIndent.style.left);var t,i=document.getElementById(this.documentEditor.element.id+"_rightIndent"),n=Pa.getNumberFromString(i.style.left);"Pages"===this.documentEditor.layoutType?this.documentEditor.selectionModule.paragraphFormat.bidi?(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor,this.minLimit1=n+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor,this.maxLimit1=t-6+Pa.convertPointToPixel(this.documentEditor.selectionModule.sectionFormat.pageWidth)*this.documentEditor.zoomFactor):(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor,this.minLimit1=t-6,this.maxLimit1=n-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor):"Continuous"===this.documentEditor.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor,this.maxLimit1=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20+40-6,this.minLimit1=n+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor):(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20,this.minLimit1=t-6,this.maxLimit1=n-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor)),this.leftIndent1=document.getElementById(this.documentEditor.element.id+"_leftIndent");var r=t+e.clientX-this.hangingLineOffset-this.hRuler.getBoundingClientRect().left,o=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,s=(o="Continuous"===this.documentEditor.layoutType?0:o)+(r-t)+6,a=document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg");a.style.left=s+"px",a.style.display="block",e.stopPropagation()},e.prototype.onHangIndentMouseMove=function(e){if(this.isDraggingIndents2){var t=void 0;"Pages"===this.documentEditor.layoutType?t=this.documentEditor.selectionModule.paragraphFormat.bidi?Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor:Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor:"Continuous"===this.documentEditor.layoutType&&(t=this.position.paragraph.paragraphFormat.bidi?this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor:this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20);var i=t+e.clientX-this.hangingLineOffset-this.hRuler.getBoundingClientRect().left;i>this.maxLimit1?i=this.maxLimit1:i<this.minLimit1&&(i=this.minLimit1),this.leftIndent1.style.left=i+"px",this.hangingIndent.style.left=i+"px";var n=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,r=(n="Continuous"===this.documentEditor.layoutType?0:n)+(i-t)+6;document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.left=r+"px"}},e.prototype.onHangIndentMouseUp=function(e){if(this.isDraggingIndents2){this.isDraggingIndents2=!1;var t=Pa.getNumberFromString(this.hangingIndent.style.left);parseInt(this.hangingIndent.style.left.replace("px",""),10)<0&&(t*=-1),this.documentEditor.selectionModule.paragraphFormat.bidi?this.documentEditor.editorModule.applyRulerMarkerValues("hangingIndent",t,this.hangingIndentInitialValue):this.documentEditor.editorModule.applyRulerMarkerValues("hangingIndent",this.hangingIndentInitialValue,t),this.hangingIndentInitialValue=t,document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.display="none"}},e.prototype.onLeftIndentMouseDown=function(e){var t;this.isDraggingIndents3=!0,this.leftLineOffset=e.clientX-this.leftIndent.getBoundingClientRect().left,this.indentInitialValue=Pa.getNumberFromString(this.leftIndent.style.left),this.firstIndentInitialValue=Pa.getNumberFromString(this.firstLineIndent.style.left),this.diff=this.firstIndentInitialValue-this.indentInitialValue,this.firstLineIndent=document.getElementById(this.documentEditor.element.id+"_firstLineIndent");var i=document.getElementById(this.documentEditor.element.id+"_rightIndent"),n=Pa.getNumberFromString(i.style.left);"Pages"===this.documentEditor.layoutType?this.documentEditor.selectionModule.paragraphFormat.bidi?(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor,this.minLimit2=n+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor,this.maxLimit2=t-6+Pa.convertPointToPixel(this.documentEditor.selectionModule.sectionFormat.pageWidth)*this.documentEditor.zoomFactor,this.isHangingIndent=Pa.getNumberFromString(this.hangingIndent.style.left)-n<=Pa.getNumberFromString(this.firstLineIndent.style.left)-n):(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor,this.minLimit2=t-6,this.maxLimit2=n-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor,this.isHangingIndent=n-Pa.getNumberFromString(this.hangingIndent.style.left)<=n-Pa.getNumberFromString(this.firstLineIndent.style.left)):"Continuous"===this.documentEditor.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor,this.maxLimit2=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20+40-6,this.minLimit2=n+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor,this.isHangingIndent=Pa.getNumberFromString(this.hangingIndent.style.left)-n<=Pa.getNumberFromString(this.firstLineIndent.style.left)-n):(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20,this.minLimit2=t-6,this.maxLimit2=n-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor,this.isHangingIndent=n-Pa.getNumberFromString(this.hangingIndent.style.left)<=n-Pa.getNumberFromString(this.firstLineIndent.style.left)));var r=t+e.clientX-this.leftLineOffset-this.hRuler.getBoundingClientRect().left,o=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,s=(o="Continuous"===this.documentEditor.layoutType?0:o)+(r-t)+6,a=document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg");a.style.left=s+"px",a.style.display="block",e.stopPropagation()},e.prototype.onLeftIndentMouseMove=function(e){if(this.isDraggingIndents3){var t=void 0,i=void 0;this.documentEditor.selectionModule.paragraphFormat.bidi?("Pages"===this.documentEditor.layoutType?t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor:"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor),i=t+e.clientX-this.leftLineOffset-this.hRuler.getBoundingClientRect().left,this.isHangingIndent?i+this.diff>this.maxLimit2&&(i=this.maxLimit2-this.diff):i>this.maxLimit2&&(i=this.maxLimit2),this.isHangingIndent?i<this.minLimit2&&(i=this.minLimit2):i+this.diff<this.minLimit2&&(i=this.minLimit2-this.diff)):("Pages"===this.documentEditor.layoutType?t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor:"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20),i=t+e.clientX-this.leftLineOffset-this.hRuler.getBoundingClientRect().left,this.isHangingIndent?i>this.maxLimit2&&(i=this.maxLimit2):i+this.diff>this.maxLimit2&&(i=this.maxLimit2-this.diff),this.isHangingIndent?i+this.diff<this.minLimit2&&(i=this.minLimit2-this.diff):i<this.minLimit2&&(i=this.minLimit2)),this.hangingIndent.style.left=i+"px",this.leftIndent.style.left=i+"px",this.firstLineIndent.style.left=this.firstIndentInitialValue+(i-this.indentInitialValue)+"px";var n=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,r=(n="Continuous"===this.documentEditor.layoutType?0:n)+(i-t)+6;document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.left=r+"px"}},e.prototype.onLeftIndentMouseUp=function(e){if(this.isDraggingIndents3){this.isDraggingIndents3=!1;var t=Pa.getNumberFromString(this.leftIndent.style.left);parseInt(this.leftIndent.style.left.replace("px",""),10)<0&&(t*=-1),this.documentEditor.selectionModule.paragraphFormat.bidi?this.documentEditor.editorModule.applyRulerMarkerValues("leftIndent",t,this.indentInitialValue):this.documentEditor.editorModule.applyRulerMarkerValues("leftIndent",this.indentInitialValue,t),this.indentInitialValue=t,document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.display="none"}},e.prototype.onRightIndentMouseDown=function(e){this.isDraggingIndents4=!0,this.rightLineOffset=e.clientX-this.rightIndent.getBoundingClientRect().left,this.indentInitialValue=Pa.getNumberFromString(this.rightIndent.style.left);var t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor;this.documentEditor.selectionModule.paragraphFormat.bidi&&(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor),"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20,this.documentEditor.selectionModule.paragraphFormat.bidi&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor));var i=t+e.clientX-this.rightLineOffset-this.hRuler.getBoundingClientRect().left,n=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,r=(n="Continuous"===this.documentEditor.layoutType?0:n)+(i-t)+6,o=document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg");o.style.left=r+"px",o.style.display="block",e.stopPropagation()},e.prototype.onRightIndentMouseMove=function(e){if(this.isDraggingIndents4){var t=void 0,i=void 0,n=document.getElementById(this.documentEditor.element.id+"_leftIndent"),r=document.getElementById(this.documentEditor.element.id+"_firstLineIndent"),o=void 0,s=void 0;if(this.documentEditor.selectionModule.paragraphFormat.bidi){"Pages"===this.documentEditor.layoutType?t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin-(this.documentEditor.selectionModule.sectionFormat.pageWidth-this.documentEditor.selectionModule.sectionFormat.leftMargin-this.documentEditor.selectionModule.sectionFormat.rightMargin))*this.documentEditor.zoomFactor:"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor),i=t+e.clientX-this.rightLineOffset-this.hRuler.getBoundingClientRect().left;var a=Pa.getNumberFromString(n.style.left)-i<=Pa.getNumberFromString(r.style.left)-i?n:r;o=(l=Pa.getNumberFromString(a.style.left))-Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor,s=t-6}else{"Pages"===this.documentEditor.layoutType?t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor:"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20);a=(i=t+e.clientX-this.rightLineOffset-this.hRuler.getBoundingClientRect().left)-Pa.getNumberFromString(n.style.left)<=i-Pa.getNumberFromString(r.style.left)?n:r;var l=Pa.getNumberFromString(a.style.left);o=t+this.documentEditor.documentHelper.currentPage.boundingRectangle.width*this.documentEditor.zoomFactor-6,s=l+Pa.convertPointToPixel(42)*this.documentEditor.zoomFactor}i<s?i=s:i>o&&(i=o),this.rightIndent.style.left=i+"px";var d=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,h=(d="Continuous"===this.documentEditor.layoutType?0:d)+(i-t)+6;document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.left=h+"px"}},e.prototype.onRightIndentMouseUp=function(e){if(this.isDraggingIndents4){this.isDraggingIndents4=!1;var t=Pa.getNumberFromString(this.rightIndent.style.left);this.documentEditor.selectionModule.paragraphFormat.bidi?this.documentEditor.editorModule.applyRulerMarkerValues("rightIndent",this.indentInitialValue,t):this.documentEditor.editorModule.applyRulerMarkerValues("rightIndent",t,this.indentInitialValue),this.indentInitialValue=t,document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.display="none"}},e.prototype.onTabStopMouseDown=function(e){e.stopPropagation(),this.isDraggingForTab=!0,this.tabStopOffset=e.clientX-this.tabStopElement.getBoundingClientRect().left,this.tabInitialValue=Pa.getNumberFromString(this.tabStopElement.style.left),this.tabIndex=parseInt(this.tabStopElement.id.split("_")[this.tabStopElement.id.split("_").length-1],10),this.currentTabStop=this.currrentParagraph.paragraphFormat.tabs[parseInt(this.tabIndex.toString(),10)],this.currentTabStopElement=this.tabStopElement;var t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor;"Continuous"===this.documentEditor.layoutType&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20,this.position.paragraph.paragraphFormat.bidi&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor));var i=t+e.clientX-this.tabStopOffset-this.hRuler.getBoundingClientRect().left,n=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,r=(n="Continuous"===this.documentEditor.layoutType?0:n)+(i-t),o=document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg");o.style.left=r+"px",o.style.display="block"},e.prototype.onTabStopMouseUp=function(e){(0,a.isNullOrUndefined)(this.currentTabStopElement)||(this.currentTabStopElement=void 0)},e.prototype.onTabStopMouseMove=function(e){if(this.isDraggingForTab){var t=void 0;"Continuous"===this.documentEditor.layoutType?(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20,this.position.paragraph.paragraphFormat.bidi&&(t=this.documentEditor.hRuler.zeroPosition*this.documentEditor.zoomFactor-20-this.documentEditor.viewer.clientArea.width*this.documentEditor.zoomFactor)):"Pages"===this.documentEditor.layoutType&&(t=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor,this.position.paragraph.bidi&&(t=Pa.convertPointToPixel(1584+this.documentEditor.selectionModule.sectionFormat.rightMargin-this.documentEditor.selectionModule.sectionFormat.pageWidth)*this.documentEditor.zoomFactor));var i=t+e.clientX-this.tabStopOffset-this.hRuler.getBoundingClientRect().left,n=t,r=document.getElementById(this.documentEditor.element.id+"_rightIndent"),o=Pa.getNumberFromString(r.style.left),s=o,a=document.getElementById(this.documentEditor.element.id+"_leftIndent"),l=Pa.getNumberFromString(a.style.left);n=l,this.position.paragraph.paragraphFormat.bidi&&(n=o,s=l),"CenterTab"===this.justification||"DecimalTab"===this.justification?s+=4:"RightTab"===this.justification?s+=5.5:s+=1.5,i<n?i=n:i>s&&(i=s),this.tabStopElement.style.left=i+"px";var d=this.documentEditor.documentHelper.currentPage.boundingRectangle.x,h=(d="Continuous"===this.documentEditor.layoutType?0:d)+(i-t)+6;document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.left=h+"px"}},e.prototype.onRenderTabStopMouseUp=function(e){if(this.isDraggingForTab&&!(0,a.isNullOrUndefined)(this.currentTabStop)){if((0,a.isNullOrUndefined)(this.currentTabStopElement)||"none"!==this.currentTabStopElement.style.display){var t=Pa.getNumberFromString(this.tabStopElement.style.left);this.tabInitialValue=t,this.documentEditor.editorModule.removeTabStops([this.currrentParagraph],[this.currentTabStop]),t=Pa.convertPixelToPoint(t/this.documentEditor.zoomFactor)-1584,t=this.currrentParagraph.paragraphFormat.bidi?-1*t:t,this.currentTabStop.position=t,this.documentEditor.editorModule.updateTabStopCollection(this.currrentParagraph,[this.currentTabStop])}else this.documentEditor.editorModule.removeTabStops([this.currrentParagraph],[this.currentTabStop]),this.currentTabStopElement.parentNode.removeChild(this.currentTabStopElement);this.updateTabStopMarkers(this.documentEditor),this.isDraggingForTab=!1,document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.display="none",this.currentTabStopElement=void 0}},e.prototype.onTabStopDblClick=function(e){this.documentEditor.showTabDialog(),e.stopPropagation()},e.prototype.hideTabStopSwitch=function(e){this.tabStopStwitch&&this.showHideElement(e,this.tabStopStwitch)},e.prototype.hideRulerBottom=function(e){this.hRulerBottom&&this.showHideElement(e,this.hRulerBottom),this.vRulerBottom&&this.showHideElement(e,this.vRulerBottom)},e.prototype.showHideElement=function(e,t){t.style.display=e?"block":"none"},e.prototype.createHtmlElement=function(e,t){var i=(0,a.createElement)(e,t);return this.setAttributeHtml(i,t),i},e.prototype.createSvgElement=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return this.setAttributeSvg(i,t),i},e.prototype.applyStyleAgainstCsp=function(e,t){for(var i=t.split(";"),n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)].split(":");2===r.length&&(e.style[r[0].trim()]=r[1].trim())}},e.prototype.setAttributeSvg=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)e&&"style"!==i[parseInt(n.toString(),10)]?e.setAttribute(i[parseInt(n.toString(),10)],t[i[parseInt(n.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(n.toString(),10)]])},e.prototype.setAttributeHtml=function(e,t){for(var i=Object.keys(t),n=0;n<i.length;n++)"style"!==i[parseInt(n.toString(),10)]?e.setAttribute(i[parseInt(n.toString(),10)],t[i[parseInt(n.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(n.toString(),10)]])},e.prototype.renderOverlapElement=function(e){var t=this.getRulerSize(e),i={id:e.element.id+"_overlapRuler",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;diplay:none",class:"e-ruler-overlap"};this.overlap=this.createHtmlElement("div",i);var n=document.getElementById(e.element.id+"_viewerContainer");return n.insertBefore(this.overlap,n.firstChild),this.overlap},e.prototype.renderRulerMarkerIndicatorElement=function(e){if(e.enableSelection){var t=this.getRulerSize(e),i={id:e.element.id+"_markIndicator",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;z-index:5;border:1px solid #ccc;display:"+("Pages"===e.layoutType?"block;":"none;"),class:"e-de-ruler-markIndicator"};this.markIndicator=this.createHtmlElement("div",i),this.tabStopStwitch=this.markIndicator;var n=document.getElementById(e.element.id+"_viewerContainer");n.insertBefore(this.markIndicator,n.firstChild);var r=e.element.id;this.firstLineIndentRuler=document.getElementById(r+"_firstLineIndent").cloneNode(!0),this.hangingIndentRuler=document.getElementById(r+"_hangingIndent").cloneNode(!0),this.firstLineIndentRuler.style.left="1px",this.firstLineIndentRuler.style.top=t.height/2-3+"px",this.firstLineIndentRuler.style.display="none",this.firstLineIndentRuler.classList.add("e-de-ruler-marker"),this.firstLineIndentRuler.setAttribute("id",r+"_firstLineIndent_-1"),this.hangingIndentRuler.style.left="1px",this.hangingIndentRuler.style.top=t.height/2-3+"px",this.hangingIndentRuler.style.display="none",this.hangingIndentRuler.classList.add("e-de-ruler-marker"),this.hangingIndentRuler.setAttribute("id",r+"_hangingIndent_-1"),this.markIndicator.appendChild(this.hangingIndentRuler),this.markIndicator.appendChild(this.firstLineIndentRuler);var o=["Left","Center","Right","Decimal","Bar"],s=new a.L10n("documenteditor",e.defaultLocale);s.setLocale(e.locale);for(var l=0;l<5;l++){this.renderTab(e,t,void 0,o[parseInt(l.toString(),10)],-1,s);var d=document.getElementById(e.element.id+"_"+o[parseInt(l.toString(),10)]+"Tab_-1");(0,a.isNullOrUndefined)(d)||(d.classList.remove("e-de-ruler-tab"),d.classList.add("e-de-ruler-marker"),d.style.display=0===l?"block":"none",d.style.position="absolute",d.style.margin="4px 3px",this.markIndicator.appendChild(d))}this.markIndicator.addEventListener("click",this.onmarkIndicatorClickHandler)}},e.prototype.renderRuler=function(e,t){if(this.documentEditor=e,e.enableSelection){this.rulerDiv=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));var i=this.getRulerSize(e);this.rulerGeometry=this.getRulerGeometry(e);var n=t?e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x:e.selectionModule.getPageTop(e.selectionModule.end.paragraph.bodyWidget.page),r=t?"margin-left:"+n+"px;":"margin-top:"+n+"px;";if(e.selectionModule.isForward?this.position=e.selectionModule.start:this.position=e.selectionModule.end,!this.rulerDiv){var o="height:"+(t?i.height:this.rulerGeometry.height)+"px;overflow:hidden;width:"+(t?this.rulerGeometry.width:i.width)+"px;position:absolute;font-size:9px;text-align: left;z-index: 4;user-select:none;"+r,s={id:e.element.id+(t?"_hRuler":"_vRuler"),style:o,class:t?"e-de-hRuler":"e-de-vRuler"};this.rulerDiv=this.createHtmlElement("div",s)}this.rulerDiv.addEventListener("dblclick",this.onRulerDblClickHandler);var l=document.getElementById(e.element.id+"_pageContainer"),d="height:"+(t?i.height:l.getBoundingClientRect().height)+"px;overflow:hidden;width:"+(t?l.getBoundingClientRect().width:i.width)+"px;position:absolute;z-index: 3;",h={id:e.element.id+(t?"_hRulerBottom":"_vRulerBottom"),style:d,class:t?"e-de-hRuler":"e-de-vRuler"};this.rulerOverlap=this.createHtmlElement("div",h),t?this.hRulerBottom=this.rulerOverlap:this.vRulerBottom=this.rulerOverlap;var c=document.getElementById(e.element.id+"_viewerContainer");c.insertBefore(this.rulerOverlap,c.firstChild);var p=t?document.getElementById(e.element.id+"_hRulerBottom"):document.getElementById(e.element.id+"_vRulerBottom");p.insertBefore(this.rulerDiv,p.firstChild),this.renderRulerMargins(e,t,this.rulerDiv);var u=new cp(this.rulerDiv,this);u.orientation=t?"Horizontal":"Vertical",this.updateMargin(u,e,t),u.length=2*u.zeroPosition,u.appendTo(),t?e.hRuler=u:e.vRuler=u,this.updateRulerPosition(e,t);var g=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=g:e.vRuler.element=g,g&&(t?g.scrollLeft=u.zeroPosition-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin):g.scrollTop=u.zeroPosition-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin)),this.locale=new a.L10n("documenteditor",e.defaultLocale),t&&this.renderIndents(e,t,i,this.rulerGeometry,this.locale),this.hRuler=document.getElementById(e.element.id+"_hRuler"),t&&(document.addEventListener("mousemove",this.onHorizontalRulerMouseMoveHandler),this.hRuler.addEventListener("mouseenter",this.onHRulerMouseEnterHandler),this.hRuler.addEventListener("mouseleave",this.onHRulerMouseLeaveHandler),this.hRuler.addEventListener("mousedown",this.onHRulerMouseDownHandler),this.hRuler.addEventListener("mouseup",this.onHRulerMouseUpHandler),document.addEventListener("mouseup",this.onRulerMouseUpHandler)),this.vRuler=document.getElementById(e.element.id+"_vRuler"),this.isTopRulerMargin=!1,t||(document.addEventListener("mousemove",this.onVMouseMoveHandler),this.vRuler.addEventListener("mousedown",this.onVMouseDownHandler),document.addEventListener("mouseup",this.onVMouseUpHandler))}},e.prototype.onHorizontalRulerMouseMoved=function(e){if(!this.documentEditor.isDestroyed&&this.documentEditor.documentEditorSettings.showRuler){var t=this.hRuler.getBoundingClientRect(),i=this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*this.documentEditor.zoomFactor,n=Pa.convertPixelToPoint(t.width)-this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*this.documentEditor.zoomFactor,r=Math.round(e.clientX-t.left),o=Pa.convertPixelToPoint(r);if(!this.isDraggingRender)if(this.documentEditor.isOnIndent)this.hRuler.style.cursor="default",this.hRuler.hasAttribute("title")&&this.hRuler.removeAttribute("title"),this.resizerEnabled=!1;else if(i-3<=o&&i+3>=o)"Pages"===this.documentEditor.layoutType&&(this.hRuler.style.cursor="e-resize",this.hRuler.setAttribute("title",this.locale.getConstant("Left Margin")),this.resizerEnabled=!0,this.isLeftRulerMargin=!0);else if(n-3<=o&&n+3>=o)"Pages"===this.documentEditor.layoutType&&(this.hRuler.style.cursor="e-resize",this.hRuler.setAttribute("title",this.locale.getConstant("Right Margin")),this.resizerEnabled=!0,this.isLeftRulerMargin=!1);else if(this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns.length>0){var s=this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns;if("Pages"===this.documentEditor.layoutType)for(var a=1;a<=s.length;a++){var l=document.getElementById(this.documentEditor.element.id+"_hRuler_Margin"+a),d=l.getBoundingClientRect().left,h=l.getBoundingClientRect().width;if(d-3<=e.clientX&&d+3>=e.clientX){this.hRuler.style.cursor="e-resize",this.multiColumnElement=l,this.hRuler.setAttribute("title",this.locale.getConstant("Left Margin")),this.isLeftMultiColumn=!0,this.resizerEnabled=!0;break}if(d+h-3<=e.clientX&&d+h+3>=e.clientX){this.hRuler.style.cursor="e-resize",this.multiColumnElement=l,this.hRuler.setAttribute("title",this.locale.getConstant("Right Margin")),this.isRightMultiColumn=!0,this.resizerEnabled=!0;break}this.hRuler.style.cursor="default",this.hRuler.hasAttribute("title")&&this.hRuler.removeAttribute("title"),this.isLeftMultiColumn=!1,this.isRightMultiColumn=!1,this.resizerEnabled=!1}}else this.hRuler.style.cursor="default",this.hRuler.hasAttribute("title")&&this.hRuler.removeAttribute("title"),this.resizerEnabled=!1;if(this.isDraggingRender){var c=Pa.convertPointToPixel(1584-this.documentEditor.selectionModule.sectionFormat.leftMargin)*this.documentEditor.zoomFactor,p=this.documentEditor.selectionModule.sectionFormat.pageWidth,u=this.documentEditor.selectionModule.sectionFormat.rightMargin,g=this.documentEditor.selectionModule.paragraphFormat.rightIndent;g=g>0?g:0;var m=this.documentEditor.selectionModule.paragraphFormat.firstLineIndent,f=this.documentEditor.selectionModule.sectionFormat.leftMargin;m=m>=0?m:0;var v=this.documentEditor.selectionModule.paragraphFormat.leftIndent;if(this.isLeftRulerMargin){var y=c+Pa.convertPointToPixel(p-u-g-42-m-v)*this.documentEditor.zoomFactor,w=c;r+c>y?(r=y-c,o=Pa.convertPixelToPoint(r)):r+c<w&&(r=w-c,o=Pa.convertPixelToPoint(r))}else{var b=c+Pa.convertPointToPixel(f+v+m+42+g)*this.documentEditor.zoomFactor,C=c+Pa.convertPointToPixel(p)*this.documentEditor.zoomFactor;r+c>C?(r=C-c,o=Pa.convertPixelToPoint(r)):r+c<b&&(r=b-c,o=Pa.convertPixelToPoint(r))}this.finalmouseXRelativeToDiv=o;var x=Pa.convertPixelToPoint(t.width)-this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*this.documentEditor.zoomFactor;this.documentEditor.selectionModule.end.paragraph.bodyWidget.sectionFormat.numberOfColumns<=1&&this.resizeRulerMargins(this.isLeftRulerMargin,this.renderInitialValue,this.currentScrollLeft,x,this.hRuler,o,!0,this.documentEditor);var I=document.getElementById(this.documentEditor.element.id+"_rightIndent");if(this.isLeftRulerMargin){var k=o-this.renderInitialValue;I.style.left=this.initialRightMargin-Pa.convertPointToPixel(k)+"px"}else{k=o-this.renderInitialValue;I.style.left=this.initialRightMargin+Pa.convertPointToPixel(k)+"px"}var F=this.documentEditor.documentHelper.currentPage.boundingRectangle.x+r;document.getElementById(this.documentEditor.element.id+"_hRuler_indicator_svg").style.left=F+"px"}}},e.prototype.updateRulerPosition=function(e,t){var i=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=i:e.vRuler.element=i,i&&(i.scrollLeft=2112-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin))},e.prototype.updateIndicatorLines=function(e){var t=document.getElementById(e.element.id+"_hRuler_indicator_svg"),i=document.getElementById(e.element.id+"_hRuler_indicator"),n=document.getElementById(e.element.id+"_vRuler_indicator_svg"),r=document.getElementById(e.element.id+"_vRuler_indicator"),o=document.getElementById(e.element.id+"_pageContainer").getBoundingClientRect(),s=o.height,a=o.width;t.style.height=s+"px",i.setAttribute("y2",""+s),n.style.width=a+"px",r.setAttribute("x2",""+a)},e.prototype.createIndicatorLines=function(e){if(e.enableSelection){var t=document.getElementById(e.element.id+"_viewerContainer"),i=document.getElementById(e.element.id+"_pageContainer"),n=(t.getBoundingClientRect(),i.getBoundingClientRect()),r=n.height,o=n.width;this.hRuler=document.getElementById(e.element.id+"_hRuler");var s={id:e.element.id+"_hRuler_indicator_svg",width:"0.5px",height:r+"px",style:"position:absolute;z-index:1;display:none;"};this.hSvg=this.createSvgElement("svg",s);var a={x1:0,y1:this.hRuler.getBoundingClientRect().height+5,x2:0,y2:r,"stroke-width":.5,stroke:"black"};this.vLine=this.createSvgElement("line",a),this.vLine.setAttribute("id",e.element.id+"_hRuler_indicator"),this.hSvg.appendChild(this.vLine),t.insertBefore(this.hSvg,t.firstChild);var l=document.getElementById(e.element.id+"_vRuler"),d={id:e.element.id+"_vRuler_indicator_svg",width:o+"px",height:"0.5px",style:"position:absolute;z-index:1;display:none;"};this.vSvg=this.createSvgElement("svg",d);var h={x1:l.getBoundingClientRect().width+5,y1:0,x2:o,y2:0,"stroke-width":.5,stroke:"black"};this.hLine=this.createSvgElement("line",h),this.hLine.setAttribute("id",e.element.id+"_vRuler_indicator"),this.vSvg.appendChild(this.hLine),t.insertBefore(this.vSvg,t.firstChild)}},e.prototype.updateIndentMarkers=function(e){if(!((0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.element)||(0,a.isNullOrUndefined)(e.element.id)||(0,a.isNullOrUndefined)(e.hRuler)||(0,a.isNullOrUndefined)(e.hRuler.zeroPosition))){var t=void 0,i=e.element.id,n=Pa.convertPointToPixel(1584-e.selectionModule.sectionFormat.leftMargin),r=this.getRulerGeometry(e);if(this.position.paragraph.paragraphFormat.bidi||this.position.paragraph.isInsideTable&&this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi)n-=r.width/e.zoomFactor-Pa.convertPointToPixel(this.position.paragraph.bodyWidget.sectionFormat.rightMargin+this.position.paragraph.bodyWidget.sectionFormat.leftMargin);var o,s=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.x:parseFloat(this.position.paragraph.absoluteXPosition.x.toString()),l=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());this.position.paragraph.paragraphFormat.bidi&&(n=Pa.convertPointToPixel(1584-e.selectionModule.sectionFormat.leftMargin-(e.selectionModule.sectionFormat.pageWidth-e.selectionModule.sectionFormat.leftMargin-e.selectionModule.sectionFormat.rightMargin)));var d=document.getElementById(e.element.id+"_leftIndent"),h=document.getElementById(e.element.id+"_rightIndent");this.position.paragraph.paragraphFormat.bidi?(d.setAttribute("title",this.locale.getConstant("Right Indent")),h.setAttribute("title",this.locale.getConstant("Left Indent")),o=n+s+l):(d.setAttribute("title",this.locale.getConstant("Left Indent")),h.setAttribute("title",this.locale.getConstant("Right Indent")),o=n+s);var c=this.position.paragraph.paragraphFormat.firstLineIndent;t=document.getElementById(i+"_leftIndent"),(0,a.isNullOrUndefined)(t)||("Pages"===e.layoutType?t.style.left=o*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(o=(n=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+s+l,t.style.left=o+"px"):(o=(n=e.hRuler.zeroPosition*e.zoomFactor-20)+s*e.zoomFactor,t.style.left=o+"px"))),t=document.getElementById(i+"_hangingIndent"),(0,a.isNullOrUndefined)(t)||("Pages"===e.layoutType?t.style.left=o*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(o=(n=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+s+l,t.style.left=o+"px"):(o=(n=e.hRuler.zeroPosition*e.zoomFactor-20)+s*e.zoomFactor,t.style.left=o+"px"))),t=document.getElementById(i+"_firstLineIndent"),"Pages"===e.layoutType?(0,a.isNullOrUndefined)(t)||(this.position.paragraph.paragraphFormat.bidi?t.style.left=(o-Pa.convertPointToPixel(c))*e.zoomFactor-6+"px":t.style.left=(o+Pa.convertPointToPixel(c))*e.zoomFactor-6+"px"):"Continuous"===e.layoutType&&(o=this.position.paragraph.paragraphFormat.bidi?(n=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+s+l-Pa.convertPointToPixel(c)*e.zoomFactor:(n=e.hRuler.zeroPosition*e.zoomFactor-20)+(s+Pa.convertPointToPixel(c))*e.zoomFactor,t.style.left=o+"px"),t=document.getElementById(i+"_rightIndent"),"Pages"===e.layoutType?(o=this.position.paragraph.paragraphFormat.bidi?n+s:n+s+l,(0,a.isNullOrUndefined)(t)||(t.style.left=o*e.zoomFactor-6+"px")):"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(o=(n=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor)+s,t.style.left=o+"px"):(o=(n=e.hRuler.zeroPosition*e.zoomFactor-20)+(s+l)*e.zoomFactor,t.style.left=o+"px"))}},e.prototype.updateTabStopMarkers=function(e){if(!((0,a.isNullOrUndefined)(e)||(0,a.isNullOrUndefined)(e.element)||(0,a.isNullOrUndefined)(e.element.id)||(0,a.isNullOrUndefined)(e.hRuler)||(0,a.isNullOrUndefined)(e.hRuler.zeroPosition))){var t=new a.L10n("documenteditor",e.defaultLocale);t.setLocale(e.locale);var i=e.element.id;this.markIndicator=document.getElementById(i+"_markIndicator"),this.markIndicator.style.display="Pages"===e.layoutType?"block":"none";for(var n=this.position.paragraph.paragraphFormat.tabs,r=e.zoomFactor,o=this.getRulerSize(e),s=Pa.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-tab")),l=0;l<n.length;l++){var d=n[parseInt(l.toString(),10)],h=d.tabJustification,c=e.element.id+"_"+h+"Tab_"+l.toString(),p=document.getElementById(c);if((0,a.isNullOrUndefined)(p))"List"===h||(0,a.isNullOrUndefined)(h)||this.renderTab(e,o,d,h,l,t);else{!(0,a.isNullOrUndefined)(s)&&s.length>0&&s.splice(s.indexOf(p),1);var u=this.position.paragraph.paragraphFormat.bidi?Pa.convertPointToPixel(1584-d.position):Pa.convertPointToPixel(1584+d.position);p.style.left="Center"===h||"Decimal"===h?u*r-4+"px":"Right"===h?u*r-5.5+"px":u*r-1.5+"px"}}if(!(0,a.isNullOrUndefined)(s))for(l=0;l<s.length;l++){var g=s[parseInt(l.toString(),10)];(0,a.isNullOrUndefined)(g)||g.parentNode.removeChild(g)}}},e.prototype.renderRulerMargins=function(e,t,i){var n=this.getRulerSize(e),r=this.getRulerGeometry(e),o=(t?e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x:(e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.y,n.height),2112*e.zoomFactor),s=t?"margin-left:"+o+"px;":"margin-top:"+o+"px;",a=t?n.height:r.height-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin)*e.zoomFactor;if(t)for(var l=1;l<=13;l++){if(this.rulerMarginDiv=document.getElementById(e.element.id+"_hRuler_Margin"+l),!this.rulerMarginDiv){var d="height:"+a+"px;overflow:hidden;width:"+(r.width-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor)+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;display: block"+s,h={id:e.element.id+"_hRuler_Margin"+l,style:d,class:"e-de-ruler-margin"};this.rulerMarginDiv=this.createHtmlElement("div",h)}i.appendChild(this.rulerMarginDiv)}else{if(!this.verticalRulerMarginDiv){this.verticalRulerMarginDiv=document.getElementById(e.element.id+"_vRuler_Margin");d="height:"+a+"px;overflow:hidden;width:"+n.width+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;"+s,h={id:e.element.id+"_vRuler_Margin",style:d,class:"e-de-ruler-margin"};this.verticalRulerMarginDiv=this.createHtmlElement("div",h)}i.appendChild(this.verticalRulerMarginDiv)}},e.prototype.updateRulerMargins=function(e){var t=this.getRulerGeometry(e),i=e.hRuler.zeroPosition*e.zoomFactor;this.updateHorizontalRulerMargin(e);var n=document.getElementById(e.element.id+"_vRuler_Margin"),r=t.height-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin*e.zoomFactor);n.style.marginTop=i+"px",n.style.height=r+"px"},e.prototype.updateHorizontalRulerMargin=function(e){var t=e.selectionModule.end.paragraph.bodyWidget.sectionFormat.columns,i=e.hRuler.zeroPosition*e.zoomFactor,n=!1,r=this.position.paragraph.paragraphFormat.bidi,o=!1,s=Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin-72),l=Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin-72);this.position.paragraph.isInsideTable&&(o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi);var d=this.getRulerGeometry(e).width-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor);(r||o)&&(i=e.hRuler.zeroPosition*e.zoomFactor-d);for(var h=0;h<13;h++){var c=document.getElementById(e.element.id+"_hRuler_Margin"+(h+1));if(c)if(0===t.length&&!n||"Continuous"===e.layoutType&&!n){if(r||o){var p=e.hRuler.zeroPosition*e.zoomFactor-d;c.style.marginLeft=p+"px"}else c.style.marginLeft=i+"px";if(c.style.display="block","Continuous"===e.layoutType){var u=(0,a.isNullOrUndefined)(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());c.style.width=u*e.zoomFactor+"px"}else c.style.width=d+"px";n=!0}else t.length>=h+1&&"Pages"===e.layoutType?(c.style.marginLeft=i+"px",i-=(s+l)/t.length*e.zoomFactor,i+=(t[parseInt(h.toString(),10)].width+t[parseInt(h.toString(),10)].space)*e.zoomFactor,c.style.display="block",c.style.width=(t[parseInt(h.toString(),10)].width-(s+l)/t.length)*e.zoomFactor+"px"):c.style.display="none"}},e.prototype.resizeVRulerMargins=function(e,t,i,n,r,o,s){var a=document.getElementById(s.element.id+"_vRuler_Margin"),l=this.getRulerGeometry(s);if(e)a.style.height=(l.height-Pa.convertPointToPixel(s.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin*s.zoomFactor+o)).toString()+"px",r.scrollTop=t<o?i-Pa.convertPointToPixel(o-t):i+Pa.convertPointToPixel(t-o);else{var d=Pa.convertPixelToPoint(l.height)-o;a.style.height=(l.height-Pa.convertPointToPixel(s.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin*s.zoomFactor+d)).toString()+"px"}},e.prototype.resizeRulerMargins=function(e,t,i,n,r,o,s,l){var d=document.getElementById(l.element.id+(s?"_hRuler_Margin1":"_vRuler_Margin")),h=this.getRulerGeometry(l);if(!(0,a.isNullOrUndefined)(e)&&e)d.style.width=(h.width-Pa.convertPointToPixel(l.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*l.zoomFactor+o)).toString()+"px",r.scrollLeft=t<o?i-Pa.convertPointToPixel(o-t):i+Pa.convertPointToPixel(t-o);else{var c=Pa.convertPixelToPoint(h.width)-o;d.style.width=(h.width-Pa.convertPointToPixel(l.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*l.zoomFactor+c)).toString()+"px"}},e.prototype.getRulerOrigin=function(){Pa.convertPointToPixel(1584)},e.prototype.renderIndents=function(e,t,i,n,r){if(this.hRuler=document.getElementById(e.element.id+"_hRuler"),this.firstLineIndent=document.getElementById(e.element.id+"_firstLineIndent"),!this.firstLineIndent){var o="left:"+(Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)*e.zoomFactor+"px;",s="height:"+(i.height-3)/2+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+o,a={id:e.element.id+"_firstLineIndent",style:s,"data-name":"FirstLineIndent",class:"e-de-ruler-indent"};this.firstLineIndent=this.createHtmlElement("div",a),this.firstLineIndent.setAttribute("title",r.getConstant("First Line Indent"));var l={id:e.element.id+"_firstLineIndent_svg",width:i.width+"px",height:(i.height-3)/2+"px",style:"position:inherit;left:0px"};this.firstLineIndentSvg=this.createSvgElement("svg",l),this.firstLineIndentSvg.setAttribute("fill","none");var d={style:"position:inherit;left:0px"};this.firstLineIndentPath=this.createSvgElement("path",d),this.firstLineIndentPath.setAttribute("class","e-de-ruler-indent-svg"),this.firstLineIndentPath.setAttribute("d","M 0.5 0.5 H 11.5 V 2.7128 L 6 5.4211 L 0.5 2.7128 V 0.5 Z"),this.firstLineIndentPath.setAttribute("fill","white"),this.firstLineIndentPath.setAttribute("stroke","#A1A1A1"),this.firstLineIndentSvg.appendChild(this.firstLineIndentPath),this.firstLineIndent.appendChild(this.firstLineIndentSvg),this.hRuler.append(this.firstLineIndent),this.firstLineIndent.addEventListener("dblclick",this.onDoubleClickHandler),this.isDraggingIndents1=!1,this.indentInitialValue=Pa.getNumberFromString(this.firstLineIndent.style.left);Pa.getNumberFromString(this.firstLineIndent.style.left);this.firstLineIndent.addEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.firstLineIndent.addEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.firstLineIndent.addEventListener("mousedown",this.onFirstLineIndentMouseDownHandler),document.addEventListener("mousemove",this.onIndentMouseMoveHandler),document.addEventListener("mouseup",this.onIndentMouseUpHandler)}if(this.hangingIndent=document.getElementById(e.element.id+"_hangingIndent"),!this.hangingIndent){o="left:"+(Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;",s="height:"+i.height/2+"px;top:"+((i.height-3)/2+1)+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+o,a={id:e.element.id+"_hangingIndent",style:s,"data-name":"HangingIndent",class:"e-de-ruler-indent"};this.hangingIndent=this.createHtmlElement("div",a),this.hangingIndent.setAttribute("title",r.getConstant("Hanging Indent"));l={id:e.element.id+"_hangingIndent_svg",width:i.width+"px",height:(i.height-3)/2+"px",style:"position:inherit;left:0px"};this.hangingIndentSvg=this.createSvgElement("svg",l),this.hangingIndentSvg.setAttribute("fill","none");d={style:"position:inherit;left:0px"};this.hangingIndentPath=this.createSvgElement("path",d),this.hangingIndentPath.setAttribute("class","e-de-ruler-indent-svg"),this.hangingIndentPath.setAttribute("d","M 0.5 5.3211 H 11.5 V 3.1083 L 6 0.4 L 0.5 3.1083 V 5.3211 Z"),this.hangingIndentPath.setAttribute("fill","white"),this.hangingIndentPath.setAttribute("stroke","#A1A1A1"),this.hangingIndentSvg.appendChild(this.hangingIndentPath),this.hangingIndent.appendChild(this.hangingIndentSvg),this.hRuler.append(this.hangingIndent),this.hangingIndent.addEventListener("dblclick",this.onDoubleClickHandler),this.hangingIndentInitialValue=Pa.getNumberFromString(this.hangingIndent.style.left);Pa.getNumberFromString(this.hangingIndent.style.left);this.hangingIndent.addEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.hangingIndent.addEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.hangingIndent.addEventListener("mousedown",this.onHangIndentMouseDownHandler),document.addEventListener("mousemove",this.onHangIndentMouseMoveHandler),document.addEventListener("mouseup",this.onHangIndentMouseUpHandler)}if(this.leftIndent=document.getElementById(e.element.id+"_leftIndent"),!this.leftIndent){s="height:4px;top:11px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+(o="left:"+(Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;"),a={id:e.element.id+"_leftIndent",style:s,class:"e-de-ruler-indent"};this.leftIndent=this.createHtmlElement("div",a),this.leftIndent.setAttribute("title",r.getConstant("Left Indent"));l={id:e.element.id+"_leftIndent_svg",width:i.width+"px",height:"4px",style:"position:inherit;left:0px"};this.leftIndentSvg=this.createSvgElement("svg",l),this.leftIndentSvg.setAttribute("fill","none");d={style:"position:inherit;left:0px"};this.leftIndentPath=this.createSvgElement("path",d),this.leftIndentPath.setAttribute("class","e-de-ruler-indent-svg"),this.leftIndentPath.setAttribute("d","M 0.5 3.5 H 11.5 V 0.5 H 0.5 V 3.5 Z"),this.leftIndentPath.setAttribute("fill","white"),this.leftIndentPath.setAttribute("stroke","#A1A1A1"),this.leftIndentSvg.appendChild(this.leftIndentPath),this.leftIndent.appendChild(this.leftIndentSvg),this.hRuler.append(this.leftIndent),this.leftIndent.addEventListener("dblclick",this.onDoubleClickHandler),this.indentInitialValue=Pa.getNumberFromString(this.leftIndent.style.left);Pa.getNumberFromString(this.leftIndent.style.left);this.leftIndent.addEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.leftIndent.addEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.leftIndent.addEventListener("mousedown",this.onLeftIndentMouseDownHandler),document.addEventListener("mousemove",this.onLeftIndentMouseMoveHandler),document.addEventListener("mouseup",this.onLeftIndentMouseUpHandler)}if(this.rightIndent=document.getElementById(e.element.id+"_rightIndent"),!this.rightIndent){s="height:7px;top:8px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+(o="left:"+(e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin)-6)+"px;"),a={id:e.element.id+"_rightIndent",style:s,class:"e-de-ruler-indent"};this.rightIndent=this.createHtmlElement("div",a),this.rightIndent.setAttribute("title",r.getConstant("Right Indent"));l={id:e.element.id+"_rightIndent_svg",width:i.width+"px",height:"7px",style:"position:inherit;left:0px"};this.rightIndentSvg=this.createSvgElement("svg",l),this.rightIndentSvg.setAttribute("fill","none");d={style:"position:inherit;left:0px"};this.rightIndentPath=this.createSvgElement("path",d),this.rightIndentPath.setAttribute("class","e-de-ruler-indent-svg"),this.rightIndentPath.setAttribute("d","M 0.5 6.5 H 11.5 V 4.2872 L 6 1.5789 L 0.5 4.2872 V 6.5 Z"),this.rightIndentPath.setAttribute("fill","white"),this.rightIndentPath.setAttribute("stroke","#A1A1A1"),this.rightIndentSvg.appendChild(this.rightIndentPath),this.rightIndent.appendChild(this.rightIndentSvg),this.hRuler.append(this.rightIndent),this.rightIndent.addEventListener("dblclick",this.onDoubleClickHandler),this.indentInitialValue=Pa.getNumberFromString(this.rightIndent.style.left);Pa.getNumberFromString(this.rightIndent.style.left);this.rightIndent.addEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.rightIndent.addEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.rightIndent.addEventListener("mousedown",this.onRightIndentMouseDownHandler),document.addEventListener("mousemove",this.onRightIndentMouseMoveHandler),document.addEventListener("mouseup",this.onRightIndentMouseUpHandler)}this.updateIndentMarkers(e)},e.prototype.updateRuler=function(e,t){if(!(e.isDestroyed||e.rulerHelper&&e.documentEditorSettings&&!e.documentEditorSettings.showRuler||e.isReadOnlyMode)){(0,a.isNullOrUndefined)(e.hRuler)&&(0,a.isNullOrUndefined)(e.vRuler)||(e.selectionModule.isForward?this.position=e.selectionModule.start:this.position=e.selectionModule.end,this.updateRulerDimension(e,e.hRuler,0,t),this.updateRulerDimension(e,e.vRuler,0,t),this.updateRulerMargins(e),this.updateIndentMarkers(e),this.updateTabStopMarkers(e),this.position.paragraph.isInsideTable?this.updateTableMarkers(e,e.hRuler):this.removeTableMarkers(e,e.hRuler),this.updateIndicatorLines(e))}},e.prototype.removeTableMarkers=function(e,t){var i=Pa.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));if(!(0,a.isNullOrUndefined)(i))for(var n=0;n<i.length;n++){var r=i[parseInt(n.toString(),10)];(0,a.isNullOrUndefined)(r)||r.parentNode.removeChild(r)}},e.prototype.updateTableMarkers=function(e,t){var i=Pa.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));((0,a.isNullOrUndefined)(i)||this.position.paragraph.isInsideTable)&&this.renderTableMarkers(e,t)},e.prototype.renderTableMarkers=function(e,t){var i=this;this.removeTableMarkers(e,e.hRuler);this.position.paragraph.containerWidget.ownerTable;var n,r=this.position.paragraph.associatedCell.ownerRow.clone().childWidgets,o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?r.length:0;this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi&&r.reverse(),this.hRuler=document.getElementById(e.element.id+"_hRuler");for(var s=function(s){var d=document.getElementById(e.element.id+"_tableMarker_"+o),h=void 0;h=0===s?"left:"+((n=(r[parseInt(s.toString(),10)].x-r[parseInt(s.toString(),10)].margin.left)*e.zoomFactor+l.hRuler.scrollLeft)-4)+"px;":"left:"+((n+=(r[s-1].width+r[s-1].margin.left+r[s-1].margin.right)*e.zoomFactor)-4)+"px;";var c="height:"+t.thickness+"px;overflow:hidden;width:10px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+h,p={id:e.element.id+"_tableMarker_"+o,class:"e-de-ruler-table-marker",style:c};d=l.createHtmlElement("div",p);var u=new a.L10n("documenteditor",e.defaultLocale);d.setAttribute("title",u.getConstant("Move Table Column"));var g={id:e.element.id+"_tableMarker_svg"+s,width:"9px",height:"11px",style:"position:inherit;left:0px;top:3px;"},m=l.createSvgElement("svg",g);m.setAttribute("fill","none");var f,v=l.createSvgElement("path",{style:"position:inherit;left:0px;"});v.setAttribute("class","e-de-ruler-table-svg"),v.setAttribute("d","M1 1V0H2V1H3V0H4V1H5V0H6V1H7V2H6V3H7V4H6V5H7V6H6V7H7V8H0V7H1V6H0V5H1V4H0V3H1V2H0V1H1ZM2 2V3H3V2H2ZM4 2V3H5V2H4ZM5 4H4V5H5V4ZM5 6H4V7H5V6ZM3 7V6H2V7H3ZM2 5H3V4H2V5Z"),v.setAttribute("fill","#A1A1A1"),m.appendChild(v),d.appendChild(m),l.hRuler.append(d),l.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?o--:o++,d.addEventListener("dblclick",(function(t){e.showDialog("TableProperties"),t.stopPropagation()})),d.addEventListener("mousedown",(function(t){f=t.clientX-d.getBoundingClientRect().left,e.startXPosition=Pa.convertPixelToPoint(t.clientX),e.isTableMarkerDragging=!0;var n,r=new Sa(t.clientX,t.clientY),o=e.viewer.findFocusedPage(r,!0,!0);if(t.currentTarget instanceof HTMLElement){var s=t.currentTarget.id.split("_"),a=s[s.length-1];n=parseInt(a,10)}var l=e.selectionModule.end.paragraph.containerWidget.ownerTable;e.editorModule.tableResize.currentResizingTable=l,e.editorModule.tableResize.resizeNode=0,e.editorModule.tableResize.resizerPosition=n,e.editorModule.tableResize.startingPoint.x=o.x,e.editorModule.tableResize.startingPoint.y=o.y,e.editorHistoryModule.initResizingHistory(o,e.editorModule.tableResize);var h=Pa.convertPointToPixel(1584-e.selectionModule.sectionFormat.leftMargin)*e.zoomFactor,c=h+t.clientX-f-i.hRuler.getBoundingClientRect().left,p=e.documentHelper.currentPage.boundingRectangle.x+(c-h)+6,u=document.getElementById(e.element.id+"_hRuler_indicator_svg");u.style.left=p-6+"px",u.style.display="block"})),document.addEventListener("mousemove",(function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler&&e.isTableMarkerDragging){i.hRuler=document.getElementById(e.element.id+"_hRuler");var n=Pa.convertPointToPixel(1584-e.selectionModule.sectionFormat.leftMargin)*e.zoomFactor;if(e.selectionModule.end.paragraph.associatedCell.ownerTable.tableFormat.bidi)n-=i.getRulerGeometry(e).width-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor);var r=n+t.clientX-f-i.hRuler.getBoundingClientRect().left;d.style.left=r+"px";var o=e.documentHelper.currentPage.boundingRectangle.x+(r-n)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=o-6+"px"}})),document.addEventListener("mouseup",(function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler&&e.isTableMarkerDragging){var n=new Sa(t.clientX,t.clientY),r=i.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?e.startXPosition-Pa.convertPixelToPoint(t.clientX):Pa.convertPixelToPoint(t.clientX)-e.startXPosition;e.editorModule.tableResize.handleResizing(n,!0,r/e.zoomFactor),e.editorModule.tableResize.updateResizingHistory(e.viewer.findFocusedPage(n,!0,!0)),e.isTableMarkerDragging=!1,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}))},l=this,d=0;d<=r.length;d++)s(d)},e.prototype.updateRulerDimension=function(e,t,i,n){var r="Horizontal"===t.orientation,o=(this.getRulerSize(e),this.getRulerGeometry(e));this.updateRulerDiv(e,o,r,t),this.updateRulerSpace(e,o,r,t),this.updateMargin(t,e,r),t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor;var s=t.element;if(r?s.style.marginLeft=("Pages"===e.layoutType?e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.x:0)+"px":(s.parentElement.style.display="Pages"===e.layoutType?"block":"none",s.style.marginTop=e.selectionModule.getPageTop(e.selectionModule.end.paragraph.bodyWidget.page)+"px"),n&&(t.offset=i,t.scale=e.zoomFactor,t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor,t.updateRuler()),r)if("Pages"===e.layoutType){var a=this.position.paragraph.paragraphFormat.bidi,l=!1;if(this.position.paragraph.isInsideTable&&(l=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),a||l){var d=o.width-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor);s.scrollLeft=e.hRuler.zeroPosition*e.zoomFactor-d}else s.scrollLeft=(t.zeroPosition-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin))*e.zoomFactor}else{a=this.position.paragraph.paragraphFormat.bidi,l=!1;this.position.paragraph.isInsideTable&&(l=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),s.scrollLeft=a||l?(t.zeroPosition-e.viewer.clientActiveArea.width)*e.zoomFactor-20:t.zeroPosition*e.zoomFactor-20}else s.scrollTop=(t.zeroPosition-Pa.convertPointToPixel(e.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin))*e.zoomFactor},e.prototype.updateRulerSpace=function(e,t,i,n){this.rulerSpaceDiv=document.getElementById(e.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space")),this.rulerSpaceDiv&&e&&t&&(this.rulerSpaceDiv.style.width=(i?t.width+2*n.segmentWidth:n.thickness)+"px",this.rulerSpaceDiv.style.height=(i?n.thickness:t.height+2*n.segmentWidth)+"px")},e.prototype.updateRulerDiv=function(e,t,i,n){if(this.parentRulerDiv=document.getElementById(e.element.id+(i?"_hRuler":"_vRuler")),this.parentRulerDiv&&e&&t&&(this.parentRulerDiv.style.width=(i?"Continuous"===e.layoutType?t.width/e.zoomFactor:t.width:n.thickness)+"px",this.parentRulerDiv.style.height=(i?n.thickness:t.height)+"px",this.parentRulerDiv=document.getElementById(e.element.id+"_overlapRuler"),this.parentRulerDiv&&(i?(this.parentRulerDiv.style.height,n.thickness):(this.parentRulerDiv.style.width,n.thickness))),i&&this.hRulerBottom){var r=document.getElementById(e.element.id+"_pageContainer");this.hRulerBottom.style.width=r.getBoundingClientRect().width+"px"}},e.prototype.getRulerGeometry=function(e){this.getRulerSize(e);var t=e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height*e.zoomFactor,i=e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.width*e.zoomFactor;return new hp(i,t)},e.prototype.getVerticalHeight=function(e){var t=Pa.convertPixelToPoint(e.selectionModule.end.paragraph.bodyWidget.page.boundingRectangle.height),i=e.element.getBoundingClientRect().height;return t<i?t:i-e.documentHelper.pages[0].boundingRectangle.y},e.prototype.renderTab=function(e,t,i,n,r,o){this.hRuler=document.getElementById(e.element.id+"_hRuler");var s=e.documentHelper.zoomFactor;switch(n){case"Left":if(this.leftTab=document.getElementById(e.element.id+"_LeftTab_"+r),!this.leftTab){var l="";if(!(0,a.isNullOrUndefined)(i))l="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?Pa.convertPointToPixel(1584-i.position):Pa.convertPointToPixel(1584+i.position))-1.5)*s+"px;");var d={id:e.element.id+"_LeftTab_"+r,class:"e-de-ruler-tab e-de-ruler-tab-left",style:l,"data-name":"LeftTab"};this.leftTab=this.createHtmlElement("div",d),this.leftTab.setAttribute("title",o.getConstant("Left Tab"));var h={id:e.element.id+"_leftTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(u=this.createSvgElement("svg",h)).setAttribute("fill","none");var c={style:"position:inherit;left:0px"};(p=this.createSvgElement("path",c)).setAttribute("class","e-de-ruler-tab-svg"),p.setAttribute("d","M3 5H7V7H1V1H3V5Z"),p.setAttribute("fill","#605E5C"),p.setAttribute("stroke","#A1A1A1"),u.appendChild(p),this.leftTab.appendChild(u),this.hRuler.append(this.leftTab)}break;case"Center":if(this.centerTab=document.getElementById(e.element.id+"_CenterTab_"+r),!this.centerTab){l="";if(!(0,a.isNullOrUndefined)(i))l="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?Pa.convertPointToPixel(1584-i.position):Pa.convertPointToPixel(1584+i.position))-4)*s+"px;");d={id:e.element.id+"_CenterTab_"+r,class:"e-de-ruler-tab e-de-ruler-tab-center",style:l,"data-name":"CenterTab"};this.centerTab=this.createHtmlElement("div",d),this.centerTab.setAttribute("title",o.getConstant("Center Tab"));h={id:e.element.id+"_centerTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(u=this.createSvgElement("svg",h)).setAttribute("fill","none");c={style:"position:inherit;left:0px"};(p=this.createSvgElement("path",c)).setAttribute("class","e-de-ruler-tab-svg"),p.setAttribute("d","M5 5H8V7H0V5H3V1H5V5Z"),p.setAttribute("fill","#605E5C"),p.setAttribute("stroke","#A1A1A1"),u.appendChild(p),this.centerTab.appendChild(u),this.hRuler.append(this.centerTab)}break;case"Right":if(this.rightTab=document.getElementById(e.element.id+"_RightTab_"+r),!this.rightTab){l="";if(!(0,a.isNullOrUndefined)(i))l="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?Pa.convertPointToPixel(1584-i.position):Pa.convertPointToPixel(1584+i.position))-5.5)*s+"px;");d={id:e.element.id+"_RightTab_"+r,class:"e-de-ruler-tab e-de-ruler-tab-right",style:l,"data-name":"RightTab"};this.rightTab=this.createHtmlElement("div",d),this.rightTab.setAttribute("title",o.getConstant("Right Tab"));h={id:e.element.id+"_rightTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(u=this.createSvgElement("svg",h)).setAttribute("fill","none");c={style:"position:inherit;left:0px"};(p=this.createSvgElement("path",c)).setAttribute("class","e-de-ruler-tab-svg"),p.setAttribute("d","M5 5V1H7V7H1V5H5Z"),p.setAttribute("fill","#605E5C"),p.setAttribute("stroke","#A1A1A1"),u.appendChild(p),this.rightTab.appendChild(u),this.hRuler.append(this.rightTab)}break;case"Decimal":if(this.decimalTab=document.getElementById(e.element.id+"_DecimalTab_"+r),!this.decimalTab){l="";if(!(0,a.isNullOrUndefined)(i))l="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?Pa.convertPointToPixel(1584-i.position):Pa.convertPointToPixel(1584+i.position))*s-4)+"px;");d={id:e.element.id+"_DecimalTab_"+r,class:"e-de-ruler-tab e-de-ruler-tab-decimal",style:l,"data-name":"DecimalTab"};this.decimalTab=this.createHtmlElement("div",d),this.decimalTab.setAttribute("title",o.getConstant("Decimal Tab"));h={id:e.element.id+"_decimalTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(u=this.createSvgElement("svg",h)).setAttribute("fill","none");var p;c={style:"position:inherit;left:0px"};(p=this.createSvgElement("path",c)).setAttribute("class","e-de-ruler-tab-svg"),p.setAttribute("d","M6 0H4V6H0V8H4H6H10V6H6V0Z"),p.setAttribute("fill","#605E5C"),p.setAttribute("clip-rule","evenodd"),p.setAttribute("fill-rule","evenodd"),p.setAttribute("stroke","#A1A1A1"),u.appendChild(p),this.decimalTab.appendChild(u),this.hRuler.append(this.decimalTab)}break;case"Bar":if(this.barTab=document.getElementById(e.element.id+"_BarTab_"+r),!this.barTab){l="";if(!(0,a.isNullOrUndefined)(i))l="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?Pa.convertPointToPixel(1584-i.position):Pa.convertPointToPixel(1584+i.position))-1.5)*s+"px;");d={id:e.element.id+"_BarTab_"+r,class:"e-de-ruler-tab e-de-ruler-tab-bar",style:l,"data-name":"BarTab"};this.barTab=this.createHtmlElement("div",d),this.barTab.setAttribute("title",o.getConstant("Bar Tab"));var u;h={id:e.element.id+"_barTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(u=this.createSvgElement("svg",h)).setAttribute("fill","none");var g=this.createSvgElement("rect",{style:"position:inherit;left:0px"});g.setAttribute("width","2"),g.setAttribute("height","8"),g.setAttribute("fill","#605E5C"),g.setAttribute("stroke","#A1A1A1"),u.appendChild(g),this.barTab.appendChild(u),this.hRuler.append(this.barTab)}}if(!(0,a.isNullOrUndefined)(i)){this.tabStopElement=document.getElementById(e.element.id+"_"+n+"Tab_"+r),(0,a.isNullOrUndefined)(i)||this.tabStopElement.addEventListener("dblclick",this.onTabStopDblClickHandler),this.tabInitialValue=Pa.getNumberFromString(this.tabStopElement.style.left);Pa.getNumberFromString(this.tabStopElement.style.left);this.justification=this.tabStopElement.getAttribute("data-name"),this.currrentParagraph=this.position.paragraph,this.tabStopElement.addEventListener("mousedown",this.onTabStopMouseDownHandler),this.tabStopElement.addEventListener("mouseup",this.onTabStopMouseUpHandler),document.addEventListener("mousemove",this.onTabStopMouseMoveHandler),document.addEventListener("mouseup",this.onRenderTabStopMouseUpHandler)}},e.prototype.updateMargin=function(e,t,i){i?(e.startMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.leftMargin,e.endMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.rightMargin):(e.startMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.topMargin,e.endMargin=t.selectionModule.end.paragraph.bodyWidget.sectionFormat.bottomMargin)},e.prototype.getTabJustification=function(e){switch(e){case"LeftTab":return"Left";case"CenterTab":return"Center";case"RightTab":return"Right";case"DecimalTab":return"Decimal";case"BarTab":return"Bar"}return"Left"},e.prototype.getRulerSize=function(e){return new hp(15,15)},e.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLElements(),this.removeSvgElements()},e.prototype.removeHTMLElements=function(){var e=this;this.tabStopStwitch&&(this.tabStopStwitch.remove(),this.tabStopStwitch=null),this.hRulerBottom&&(this.hRulerBottom.remove(),this.hRulerBottom=null),this.vRulerBottom&&(this.vRulerBottom.remove(),this.vRulerBottom=null),this.overlap&&(this.overlap.remove(),this.overlap=null),this.markIndicator&&(this.markIndicator.remove(),this.markIndicator=null),this.rulerDiv&&(this.rulerDiv.remove(),this.rulerDiv=null),this.rulerOverlap&&(this.rulerOverlap.remove(),this.rulerOverlap=null),this.rulerMarginDiv&&(this.rulerMarginDiv.remove(),this.rulerMarginDiv=null),this.verticalRulerMarginDiv&&(this.verticalRulerMarginDiv.remove(),this.verticalRulerMarginDiv=null),this.firstLineIndent&&(this.firstLineIndent.remove(),this.firstLineIndent=null),this.hangingIndent&&(this.hangingIndent.remove(),this.hangingIndent=null),this.leftIndent&&(this.leftIndent.remove(),this.leftIndent=null),this.rightIndent&&(this.rightIndent.remove(),this.rightIndent=null),this.parentRulerDiv&&(this.parentRulerDiv.remove(),this.parentRulerDiv=null),this.rulerSpaceDiv&&(this.rulerSpaceDiv.remove(),this.rulerSpaceDiv=null),this.firstLineIndentRuler&&(this.firstLineIndentRuler.remove(),this.firstLineIndentRuler=null),this.hangingIndentRuler&&(this.hangingIndentRuler.remove(),this.hangingIndentRuler=null),this.leftTab&&(this.leftTab.childNodes.forEach((function(t){e.leftTab.removeChild(t),t=null})),this.leftTab.innerHTML="",this.leftTab.remove(),this.leftTab=null),this.rightTab&&(this.rightTab.childNodes.forEach((function(t){e.rightTab.removeChild(t),t=null})),this.rightTab.innerHTML="",this.rightTab.remove(),this.rightTab=null),this.centerTab&&(this.centerTab.childNodes.forEach((function(t){e.centerTab.removeChild(t),t=null})),this.centerTab.innerHTML="",this.centerTab.remove(),this.centerTab=null),this.decimalTab&&(this.decimalTab.childNodes.forEach((function(t){e.decimalTab.removeChild(t),t=null})),this.decimalTab.innerHTML="",this.decimalTab.remove(),this.decimalTab=null),this.barTab&&(this.barTab.childNodes.forEach((function(t){e.barTab.removeChild(t),t=null})),this.barTab.innerHTML="",this.barTab.remove(),this.barTab=null),this.vRuler&&(this.vRuler.childNodes.forEach((function(t){e.vRuler.removeChild(t),t=null})),this.vRuler.innerHTML="",this.vRuler.remove(),this.vRuler=null),this.hRuler&&(this.hRuler.childNodes.forEach((function(t){e.hRuler.removeChild(t),t=null})),this.hRuler.innerHTML="",this.hRuler.remove(),this.hRuler=null)},e.prototype.removeSvgElements=function(){this.hSvg&&(this.hSvg.remove(),this.hSvg=null),this.vLine&&(this.vLine.remove(),this.vLine=null),this.vSvg&&(this.vSvg.remove(),this.vSvg=null),this.hLine&&(this.hLine.remove(),this.hLine=null),this.firstLineIndentSvg&&(this.firstLineIndentSvg.remove(),this.firstLineIndentSvg=null),this.firstLineIndentPath&&(this.firstLineIndentPath.remove(),this.firstLineIndentPath=null),this.hangingIndentSvg&&(this.hangingIndentSvg.remove(),this.hangingIndentSvg=null),this.hangingIndentPath&&(this.hangingIndentPath.remove(),this.hangingIndentPath=null),this.rightIndentSvg&&(this.rightIndentSvg.remove(),this.rightIndentSvg=null),this.rightIndentPath&&(this.rightIndentPath.remove(),this.rightIndentPath=null),this.leftIndentSvg&&(this.leftIndentSvg.remove(),this.leftIndentSvg=null),this.leftIndentPath&&(this.leftIndentPath.remove(),this.leftIndentPath=null)},e.prototype.unWireEvents=function(){this.markIndicator&&this.markIndicator.removeEventListener("click",this.onmarkIndicatorClickHandler),this.rulerDiv&&this.rulerDiv.removeEventListener("dblclick",this.onRulerDblClickHandler),this.hRuler&&(this.hRuler.removeEventListener("mouseenter",this.onHRulerMouseEnterHandler),this.hRuler.removeEventListener("mouseleave",this.onHRulerMouseLeaveHandler),this.hRuler.removeEventListener("mousedown",this.onHRulerMouseDownHandler),this.hRuler.removeEventListener("mouseup",this.onHRulerMouseUpHandler)),this.vRuler&&this.vRuler.removeEventListener("mousedown",this.onVMouseDownHandler),this.firstLineIndent&&(this.firstLineIndent.removeEventListener("dblclick",this.onDoubleClickHandler),this.firstLineIndent.removeEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.firstLineIndent.removeEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.firstLineIndent.removeEventListener("mousedown",this.onFirstLineIndentMouseDownHandler)),document.removeEventListener("mousemove",this.onHorizontalRulerMouseMoveHandler),document.removeEventListener("mouseup",this.onRulerMouseUpHandler),document.removeEventListener("mousemove",this.onVMouseMoveHandler),document.removeEventListener("mouseup",this.onVMouseUpHandler),document.removeEventListener("mousemove",this.onIndentMouseMoveHandler),document.removeEventListener("mouseup",this.onIndentMouseUpHandler),this.leftIndent&&(this.leftIndent.removeEventListener("dblclick",this.onDoubleClickHandler),this.leftIndent.removeEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.leftIndent.removeEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.leftIndent.removeEventListener("mousedown",this.onLeftIndentMouseDownHandler)),document.removeEventListener("mousemove",this.onLeftIndentMouseMoveHandler),document.removeEventListener("mouseup",this.onLeftIndentMouseUpHandler),this.hangingIndent&&(this.hangingIndent.removeEventListener("dblclick",this.onDoubleClickHandler),this.hangingIndent.removeEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.hangingIndent.removeEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.hangingIndent.removeEventListener("mousedown",this.onHangIndentMouseDownHandler)),document.removeEventListener("mousemove",this.onHangIndentMouseMoveHandler),document.removeEventListener("mouseup",this.onHangIndentMouseUpHandler),this.rightIndent&&(this.rightIndent.removeEventListener("dblclick",this.onDoubleClickHandler),this.rightIndent.removeEventListener("mouseenter",this.onDocumentIntentTrueChangeHandler),this.rightIndent.removeEventListener("mouseleave",this.onDocumentIntentFalseChangeHandler),this.rightIndent.removeEventListener("mousedown",this.onRightIndentMouseDownHandler)),document.removeEventListener("mousemove",this.onRightIndentMouseMoveHandler),document.removeEventListener("mouseup",this.onRightIndentMouseUpHandler),this.tabStopElement&&(this.tabStopElement.removeEventListener("dblclick",this.onTabStopDblClickHandler),this.tabStopElement.removeEventListener("mousedown",this.onTabStopMouseDownHandler),this.tabStopElement.removeEventListener("mouseup",this.onTabStopMouseUpHandler)),document.removeEventListener("mousemove",this.onTabStopMouseMoveHandler),document.removeEventListener("mouseup",this.onRenderTabStopMouseUpHandler),this.onmarkIndicatorClickHandler=void 0},e}(),up=function(){function e(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog.hide(),t.documentHelper.updateFocus()},this.documentHelper=e}return e.prototype.getModuleName=function(){return"DateContentDialog"},e.prototype.initDateContentDialog=function(e){this.target=(0,a.createElement)("div"),this.parentDiv=(0,a.createElement)("div"),this.target.appendChild(this.parentDiv);var t=new dl.Calendar({change:this.valueChange.bind(this)});this.documentHelper.owner.editor.dateValue&&(t.value=new Date(this.documentHelper.owner.editor.dateValue)),t.appendTo(this.parentDiv),this.documentHelper.owner.editor.dateValue&&(t.value=new Date(this.documentHelper.owner.editor.dateValue))},e.prototype.valueChange=function(e){if(e.event){var t=e.value.toLocaleDateString(),i=this.documentHelper.owner.selection.currentContentControl;this.documentHelper.owner.editor.dropDownChange(i,t),this.documentHelper.hideDialog()}},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initDateContentDialog(e),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Datepicker Content Control"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.destroy=function(){if(this.calendar&&(this.calendar.destroy(),this.calendar=void 0),this.documentHelper=void 0,this.parentDiv&&(this.parentDiv.remove(),this.parentDiv=void 0),!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}},e}(),gp=function(){function e(e){var t=this;this.colorPicker=void 0,this.fontColor=void 0,this.keyUpOnTextBoxClickHandler=this.onKeyUpOnTextBoxClicked.bind(this),this.setButtonClickHandler=this.onSetButtonClick.bind(this),this.clearButtonClickHandler=this.onClearButtonClick.bind(this),this.characterFormat=void 0,this.clearButtonClick=function(e){t.textBoxInput.value="",t.valueBoxInput.value="";for(var i=0;i<t.convertedItems.length;i++)t.convertedItems[parseInt(i.toString(),10)].value===t.currentSelectedItem&&(t.currentContentControl.contentControlProperties.contentControlListItems.splice(i,1),t.convertedItems.splice(i,1));t.listviewInstance.dataSource=t.convertedItems.slice(),t.listviewInstance.dataBind()},this.setButtonClick=function(e){if(!(0,a.isNullOrUndefined)(t.textBoxInput.value)||!(0,a.isNullOrUndefined)(t.valueBoxInput.value)){var i=new rd;i.displayText=t.textBoxInput.value?t.textBoxInput.value:"",i.value=t.valueBoxInput.value?t.valueBoxInput.value:"",t.currentContentControl.contentControlProperties.contentControlListItems.push(i);var n={displayText:i.displayText,value:i.value};t.convertedItems.push(n),t.listviewInstance.addItem([n])}t.textBoxInput.value="",t.valueBoxInput.value=""},this.onKeyUpOnTextBox=function(){t.enableOrDisableButton()},this.loadPropertiesdialog=function(){t.currentContentControl=t.documentHelper.owner.selection.currentContentControl,(0,a.isNullOrUndefined)(t.currentContentControl)||(t.contentEditedCheckBox.checked=t.currentContentControl.contentControlProperties.lockContents,t.contentDeletedCheckBox.checked=t.currentContentControl.contentControlProperties.lockContentControl,t.removeCheckBox.checked=t.currentContentControl.contentControlProperties.isTemporary,t.multilineCheckBox.checked=t.currentContentControl.contentControlProperties.multiline,t.colorPicker.value=t.currentContentControl.contentControlProperties.color,t.removeCheckBox.checked&&(t.contentEditedCheckBox.checked=!1),t.titleText.value=t.currentContentControl.contentControlProperties.title?t.currentContentControl.contentControlProperties.title:"",t.tagText.value=t.currentContentControl.contentControlProperties.tag?t.currentContentControl.contentControlProperties.tag:"",t.fontColor=t.currentContentControl.contentControlProperties.color,"Text"===t.currentContentControl.contentControlProperties.type?t.plainTextPropertiesDiv.style.display="block":t.plainTextPropertiesDiv.style.display="none","ComboBox"===t.currentContentControl.contentControlProperties.type||"DropDownList"===t.currentContentControl.contentControlProperties.type?t.dropDownPropertiesDiv.style.display="block":t.dropDownPropertiesDiv.style.display="none",(0,a.isNullOrUndefined)(void 0!==t.currentContentControl.contentControlProperties.contentControlListItems)||(t.convertedItems=t.currentContentControl.contentControlProperties.contentControlListItems.map((function(e){var t={};for(var i in e)t[""+i]=e[""+i];return t})),t.listviewInstance.dataSource=t.convertedItems,t.listviewInstance.dataBind())),t.documentHelper.updateFocus()},this.applyProperties=function(){var e=t.documentHelper.selection.start.clone(),i=t.documentHelper.selection.end.clone(),n=t.currentContentControl.line.getOffset(t.currentContentControl,1);t.documentHelper.selection.start.setPositionParagraph(t.currentContentControl.line,n),t.documentHelper.selection.end.setPositionParagraph(t.currentContentControl.line,n+1),t.documentHelper.owner.editorModule.initHistory("UpdateContentControl");var r=t.documentHelper.owner.editor.getContentControlPropObject(t.currentContentControl.contentControlProperties);(0,a.isNullOrUndefined)(t.fontColor)||(t.currentContentControl.contentControlProperties.color=t.fontColor);var o=t.documentHelper.owner.getImageContentControl();if(o instanceof id&&"Picture"==o.contentControlProperties.type&&(o.contentControlProperties.lockContents=t.contentEditedCheckBox.checked,o.contentControlProperties.lockContentControl=t.contentDeletedCheckBox.checked,o.contentControlProperties.isTemporary=t.removeCheckBox.checked,t.removeCheckBox.checked&&(o.contentControlProperties.lockContents=!1),o.contentControlProperties.title=void 0!==t.titleText.value?t.titleText.value:"",o.contentControlProperties.tag=void 0!==t.tagText.value?t.tagText.value:"",o.contentControlProperties.multiline=t.multilineCheckBox.checked),(0,a.isNullOrUndefined)(t.currentContentControl)||(t.currentContentControl.contentControlProperties.lockContents=t.contentEditedCheckBox.checked,t.currentContentControl.contentControlProperties.lockContentControl=t.contentDeletedCheckBox.checked,t.currentContentControl.contentControlProperties.isTemporary=t.removeCheckBox.checked,t.removeCheckBox.checked&&(t.currentContentControl.contentControlProperties.lockContents=!1),t.currentContentControl.contentControlProperties.title=void 0!==t.titleText.value?t.titleText.value:"",t.currentContentControl.contentControlProperties.tag=void 0!==t.tagText.value?t.tagText.value:"",t.currentContentControl.contentControlProperties.multiline=t.multilineCheckBox.checked),t.documentHelper.owner.editorHistoryModule){if(t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo){t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.modifiedProperties.push(r);var s=t.documentHelper.owner.editor.getContentControlPropObject(t.currentContentControl.contentControlProperties);t.documentHelper.owner.editorHistoryModule.currentBaseHistoryInfo.format=JSON.stringify(s)}t.documentHelper.owner.editorHistoryModule.updateHistory()}t.documentHelper.selection.selectRange(e,i),t.unWireEventsAndBindings(),t.documentHelper.dialog.hide(),t.documentHelper.viewer.updateScrollBars(),t.documentHelper.updateFocus(),t.documentHelper.owner.editorModule.fireContentChange()},this.closePropertiesDialog=function(){t.documentHelper.dialog.hide(),t.unWireEventsAndBindings(),t.documentHelper.updateFocus()},this.fontColorUpdate=function(e){(0,a.isNullOrUndefined)(e.currentValue)||(t.fontColor=e.currentValue.hex)},this.selectHandler=function(e){t.currentSelectedItem=e.text},this.documentHelper=e}return e.prototype.getModuleName=function(){return"ContentControlPropertiesDialog"},e.prototype.createInputElement=function(e,t,i){return(0,a.createElement)("input",{attrs:{type:e},id:t,className:i})},e.prototype.initContentControlPropertiesDialog=function(e,t){var i=this;this.target=(0,a.createElement)("div",{className:"e-de-cont-cntr"}),this.container=(0,a.createElement)("div"),this.generalDiv=(0,a.createElement)("div"),this.genLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")}),this.generalDiv.appendChild(this.genLabel),this.displayText=(0,a.createElement)("div",{className:"e-de-dlg-container"}),this.titleText=(0,a.createElement)("input",{className:"e-input"}),this.displayText.appendChild(this.titleText),this.generalDiv.appendChild(this.displayText),this.tagText=(0,a.createElement)("input",{className:"e-input"}),this.generalDiv.appendChild(this.tagText),this.colorDiv=(0,a.createElement)("div",{className:"e-de-container-row"}),this.colorDiv.style.paddingTop="10px",this.fontColorDiv=(0,a.createElement)("div",{className:"e-de-font-dlg-display"}),this.fontColorLabel=(0,a.createElement)("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Color")}),this.fontColorDiv.appendChild(this.fontColorLabel),this.fontColorElement=this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color"),this.fontColorDiv.appendChild(this.fontColorElement),this.colorDiv.appendChild(this.fontColorDiv),this.generalDiv.appendChild(this.colorDiv);var n=this.documentHelper.owner.documentEditorSettings.colorPickerSettings,r=n.columns,o=n.createPopupOnClick,s=n.cssClass,l=n.disabled,d=n.enablePersistence,h=n.inline,c=n.mode,p=n.modeSwitcher,u=n.noColor,g=n.presetColors,m=n.showButtons;this.colorPicker=new rl.ColorPicker({change:this.fontColorUpdate,value:"#000000",locale:this.documentHelper.owner.locale,enableOpacity:!1,mode:c,modeSwitcher:p,showButtons:m,columns:r,createPopupOnClick:o,cssClass:s,disabled:l,enablePersistence:d,inline:h,noColor:u,presetColors:g}),this.colorPicker.appendTo(this.fontColorElement),this.style=(0,a.createElement)("div",{styles:"display:block"}),this.generalDiv.appendChild(this.style),this.remove=(0,a.createElement)("div",{styles:"display:block"}),this.generalDiv.appendChild(this.remove),this.removeContent=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.remove.appendChild(this.removeContent),this.removeCheckBox=new tl.CheckBox({label:e.getConstant("Remove content control when contents are edited"),cssClass:"e-de-para-dlg-cs-check-box"}),this.removeCheckBox.appendTo(this.removeContent),this.removeContent.setAttribute("aria-label",e.getConstant("Remove content control when contents are edited")),this.container.appendChild(this.generalDiv),this.lockedDiv=(0,a.createElement)("div"),this.lockedDiv.style.paddingTop="10px",this.lockedLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Locking")}),this.lockedDiv.appendChild(this.lockedLabel),this.contentDelete=(0,a.createElement)("div",{styles:"display:block"}),this.lockedDiv.appendChild(this.contentDelete),this.contentDeleted=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.contentDelete.appendChild(this.contentDeleted),this.contentDeletedCheckBox=new tl.CheckBox({label:e.getConstant("Content control cannot be deleted"),cssClass:"e-de-para-dlg-cs-check-box",change:function(e){e.checked?(i.removeCheckBox.disabled=!0,i.removeCheckBox.dataBind()):(i.removeCheckBox.disabled=!1,i.removeCheckBox.dataBind())}}),this.contentDeletedCheckBox.appendTo(this.contentDeleted),this.contentDeleted.setAttribute("aria-label",e.getConstant("Content control cannot be deleted")),this.contentEdit=(0,a.createElement)("div",{styles:"display:block"}),this.lockedDiv.appendChild(this.contentEdit),this.contentEdited=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.contentEdit.appendChild(this.contentEdited),this.contentEditedCheckBox=new tl.CheckBox({label:e.getConstant("Contents cannot be edited"),cssClass:"e-de-para-dlg-cs-check-box"}),this.contentEditedCheckBox.appendTo(this.contentEdited),this.contentEdited.setAttribute("aria-label",e.getConstant("Contents cannot be edited")),this.container.appendChild(this.lockedDiv),this.plainTextPropertiesDiv=(0,a.createElement)("div"),this.plainTextPropertiesDiv.style.marginTop="10px",this.plainTextPropertiesDiv.style.display="none",this.plainTextLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Plain Text properties")}),this.plainTextPropertiesDiv.appendChild(this.plainTextLabel),this.multiline=(0,a.createElement)("input",{attrs:{type:"checkbox"}}),this.plainTextPropertiesDiv.appendChild(this.multiline),this.multilineCheckBox=new tl.CheckBox({label:e.getConstant("Allow carriage returns"),cssClass:"e-de-para-dlg-cs-check-box"}),this.multilineCheckBox.appendTo(this.multiline),this.multiline.setAttribute("aria-label",e.getConstant("Allow carriage returns")),this.container.appendChild(this.plainTextPropertiesDiv),this.dropDownPropertiesDiv=(0,a.createElement)("div"),this.dropDownPropertiesDiv.style.marginTop="10px",this.dropDownPropertiesDiv.style.display="none",this.lockedcontentLabel=(0,a.createElement)("div",{className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Drop_Down List properties")}),this.dropDownPropertiesDiv.appendChild(this.lockedcontentLabel),this.commonDiv=(0,a.createElement)("div",{className:"e-bookmark-common"}),this.dropDownPropertiesDiv.appendChild(this.commonDiv),this.searchDiv=(0,a.createElement)("div",{className:"e-bookmark-list"}),this.commonDiv.appendChild(this.searchDiv),this.textBoxDiv=(0,a.createElement)("div",{className:"e-bookmark-textboxdiv"}),this.searchDiv.appendChild(this.textBoxDiv),this.textBoxInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box"}),this.textBoxInput.setAttribute("type","text"),this.textBoxInput.addEventListener("keyup",this.keyUpOnTextBoxClickHandler),this.textBoxInput.setAttribute("aria-label",e.getConstant("Display Text")),this.textBoxDiv.appendChild(this.textBoxInput),this.valueBoxDiv=(0,a.createElement)("div",{className:"e-bookmark-textboxdiv"}),this.searchDiv.appendChild(this.valueBoxDiv),this.valueBoxInput=(0,a.createElement)("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box"}),this.valueBoxInput.setAttribute("type","text"),this.valueBoxInput.addEventListener("keyup",this.keyUpOnTextBoxClickHandler),this.valueBoxInput.setAttribute("aria-label",e.getConstant("Value")),this.valueBoxDiv.appendChild(this.valueBoxInput),this.listviewDiv=(0,a.createElement)("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview",attrs:{tabindex:"-1",role:"listbox"}}),this.searchDiv.appendChild(this.listviewDiv),this.listviewInstance=new il.ListView({cssClass:"e-bookmark-listview",select:this.selectHandler,fields:{text:"value"}}),this.listviewInstance.appendTo(this.listviewDiv),this.buttonDiv=(0,a.createElement)("div",{className:"e-bookmark-button"}),this.commonDiv.appendChild(this.buttonDiv),this.addbuttonDiv=(0,a.createElement)("div",{className:"e-bookmark-addbutton"}),this.buttonDiv.appendChild(this.addbuttonDiv),this.addButtonElement=(0,a.createElement)("button",{innerHTML:"Add",id:"add",attrs:{type:"button"}}),this.addButtonElement.setAttribute("aria-label",e.getConstant("Add")),this.addbuttonDiv.appendChild(this.addButtonElement),this.addButton=new tl.Button({cssClass:"e-button-custom"}),this.addButton.disabled=!0,this.addButton.appendTo(this.addButtonElement),this.addButtonElement.addEventListener("click",this.setButtonClickHandler),this.deleteButtonDiv=(0,a.createElement)("div",{className:"e-bookmark-deletebutton"}),this.buttonDiv.appendChild(this.deleteButtonDiv),this.deleteButtonElement=(0,a.createElement)("button",{innerHTML:"Delete",id:"delete",attrs:{type:"button"}}),this.deleteButtonElement.setAttribute("aria-label","Delete"),this.deleteButtonDiv.appendChild(this.deleteButtonElement),this.deleteButton=new tl.Button({cssClass:"e-button-custom"}),this.deleteButton.appendTo(this.deleteButtonElement),this.deleteButtonElement.addEventListener("click",this.clearButtonClickHandler),this.container.appendChild(this.dropDownPropertiesDiv),this.target.appendChild(this.container),new rl.TextBox({placeholder:e.getConstant("Title"),floatLabelType:"Always"},this.titleText),new rl.TextBox({placeholder:e.getConstant("Tag"),floatLabelType:"Always"},this.tagText),new rl.TextBox({placeholder:e.getConstant("Display Text"),floatLabelType:"Always"},this.textBoxInput),new rl.TextBox({placeholder:e.getConstant("Value"),floatLabelType:"Always"},this.valueBoxInput)},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.target||this.initContentControlPropertiesDialog(e,!1),"none"!==this.documentHelper.selection.caret.style.display&&(this.documentHelper.selection.caret.style.display="none"),"none"===this.dropDownPropertiesDiv.style.display&&"none"===this.plainTextPropertiesDiv.style.display||(this.dropDownPropertiesDiv.style.display="none",this.plainTextPropertiesDiv.style.display="none"),this.documentHelper.dialog.header=e.getConstant("Content Control Properties"),this.documentHelper.dialog.height="auto",this.documentHelper.dialog.width="auto",this.documentHelper.dialog.beforeOpen=this.loadPropertiesdialog,this.documentHelper.dialog.content=this.target,this.documentHelper.dialog.buttons=[{click:this.applyProperties,buttonModel:{content:this.localeValue.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closePropertiesDialog,buttonModel:{content:this.localeValue.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.documentHelper.dialog.close=this.documentHelper.updateFocus,this.documentHelper.dialog.dataBind(),this.documentHelper.dialog.show()},e.prototype.onClearButtonClick=function(e){this.clearButtonClick(e)},e.prototype.onSetButtonClick=function(e){this.setButtonClick(e)},e.prototype.onKeyUpOnTextBoxClicked=function(){this.onKeyUpOnTextBox()},e.prototype.enableOrDisableButton=function(){(0,a.isNullOrUndefined)(this.addButton)||(this.addButton.disabled=""===this.textBoxInput.value||""===this.valueBoxInput.value)},e.prototype.unWireEventsAndBindings=function(){this.fontColor=void 0,this.currentContentControl=void 0,this.currentSelectedItem=void 0,this.convertedItems=[]},e.prototype.destroy=function(){if(this.contentDeletedCheckBox&&(this.contentDeletedCheckBox.destroy(),this.contentDeletedCheckBox=void 0),this.contentEditedCheckBox&&(this.contentEditedCheckBox.destroy(),this.contentEditedCheckBox=void 0),this.removeCheckBox&&(this.removeCheckBox.destroy(),this.removeCheckBox=void 0),this.multilineCheckBox&&(this.multilineCheckBox.destroy(),this.multilineCheckBox=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0),this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.valueBoxInput&&(this.valueBoxInput.remove(),this.valueBoxInput=void 0),this.titleText&&(this.titleText.remove(),this.titleText=void 0),this.tagText&&(this.tagText.remove(),this.tagText=void 0),this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.documentHelper=void 0,this.removeEvents(),this.removeElements(),!(0,a.isNullOrUndefined)(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[parseInt(e.toString(),10)]),e--;this.target=void 0}},e.prototype.removeEvents=function(){this.addButtonElement&&this.addButtonElement.removeEventListener("click",this.setButtonClickHandler),this.deleteButtonElement&&this.deleteButtonElement.removeEventListener("click",this.clearButtonClickHandler),this.textBoxInput&&this.textBoxInput.removeEventListener("keyup",this.keyUpOnTextBoxClickHandler),this.valueBoxInput&&this.valueBoxInput.removeEventListener("keyup",this.keyUpOnTextBoxClickHandler)},e.prototype.removeElements=function(){this.generalDiv&&(this.generalDiv.remove(),this.generalDiv=void 0),this.genLabel&&(this.genLabel.remove(),this.genLabel=void 0),this.displayText&&(this.displayText.remove(),this.displayText=void 0),this.colorDiv&&(this.colorDiv.remove(),this.colorDiv=void 0),this.fontColorDiv&&(this.fontColorDiv.remove(),this.fontColorDiv=void 0),this.fontColorLabel&&(this.fontColorLabel.remove(),this.fontColorLabel=void 0),this.fontColorElement&&(this.fontColorElement.remove(),this.fontColorElement=void 0),this.style&&(this.style.remove(),this.style=void 0),this.remove&&(this.remove.remove(),this.remove=void 0),this.removeContent&&(this.removeContent.remove(),this.removeContent=void 0),this.lockedDiv&&(this.lockedDiv.remove(),this.lockedDiv=void 0),this.lockedLabel&&(this.lockedLabel.remove(),this.lockedLabel=void 0),this.contentDelete&&(this.contentDelete.remove(),this.contentDelete=void 0),this.contentDeleted&&(this.contentDeleted.remove(),this.contentDeleted=void 0),this.contentEdit&&(this.contentEdit.remove(),this.contentEdit=void 0),this.contentEdited&&(this.contentEdited.remove(),this.contentEdited=void 0),this.plainTextLabel&&(this.plainTextLabel.remove(),this.plainTextLabel=void 0),this.multiline&&(this.multiline.remove(),this.multiline=void 0),this.lockedcontentLabel&&(this.lockedcontentLabel.remove(),this.lockedcontentLabel=void 0),this.commonDiv&&(this.commonDiv.remove(),this.commonDiv=void 0),this.searchDiv&&(this.searchDiv.remove(),this.searchDiv=void 0),this.textBoxDiv&&(this.textBoxDiv.remove(),this.textBoxDiv=void 0),this.valueBoxDiv&&(this.valueBoxDiv.remove(),this.valueBoxDiv=void 0),this.listviewDiv&&(this.listviewDiv.remove(),this.listviewDiv=void 0),this.buttonDiv&&(this.buttonDiv.remove(),this.buttonDiv=void 0),this.addbuttonDiv&&(this.addbuttonDiv.remove(),this.addbuttonDiv=void 0),this.addButtonElement&&(this.addButtonElement.remove(),this.addButtonElement=void 0),this.deleteButtonDiv&&(this.deleteButtonDiv.remove(),this.deleteButtonDiv=void 0),this.deleteButtonElement&&(this.deleteButtonElement.remove(),this.deleteButtonElement=void 0)},e}(),mp=function(){function e(e){var t=this;this.onCancelButtonClick=function(){t.documentHelper.dialog2.hide(),t.documentHelper.updateFocus()},this.onInsertPicClick=function(){t.documentHelper.dialog2.hide(),t.imagePicker=(0,a.createElement)("input",{attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp,.svg"},className:"e-de-ctnr-file-picker"}),a.Browser.isIE&&document.body.appendChild(t.imagePicker),t.imagePicker.value="",t.imagePicker.click(),a.EventHandler.add(t.imagePicker,"change",t.onImageChange,t)},this.documentHelper=e}return e.prototype.getModuleName=function(){return"PicContentControlDialog"},e.prototype.show=function(){var e=new a.L10n("documenteditor",this.documentHelper.owner.defaultLocale);e.setLocale(this.documentHelper.owner.locale),this.localeValue=e,this.documentHelper.dialog2.header=e.getConstant("Insert Pictures"),this.documentHelper.dialog2.showCloseIcon=!0,this.documentHelper.dialog2.allowDragging=!0,this.documentHelper.dialog2.position={X:"center",Y:"center"},this.documentHelper.dialog2.width="auto",this.documentHelper.dialog2.beforeOpen=this.documentHelper.updateFocus,this.documentHelper.dialog2.buttons=[{click:this.onInsertPicClick,buttonModel:{content:e.getConstant("Upload from computer"),iconCss:"e-icons e-de-ctnr-upload",iconPosition:"Left"}}],this.documentHelper.dialog2.dataBind(),this.documentHelper.dialog2.show()},e.prototype.onImageChange=function(){var e=this,t=this.imagePicker.files[0],i=new FileReader;i.onload=function(){e.insertImage(i.result)},i.readAsDataURL(t)},e.prototype.insertImage=function(e){this.image=document.createElement("img");var t=this.documentHelper;this.container;this.image.addEventListener("load",(function(){t.owner.editorModule.insertImageInternal(e,!0,this.width,this.height,this.alt),t.owner.selection.isImageSelected||(t.owner.selection.handleShiftLeftKey(),t.owner.editor.insertContentControl("Picture"))})),this.image.src=e},e.prototype.destroy=function(){this.documentHelper=void 0,this.imagePicker&&(this.imagePicker.remove(),this.imagePicker=void 0),this.image&&(this.image.remove(),this.image=void 0)},e}(),fp=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vp=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},yp=function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new i((function(t){t(e.value)})).then(s,a)}l((n=n.apply(e,t||[])).next())}))},wp=function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},bp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)(null)],t.prototype,"popupTarget",void 0),vp([(0,a.Property)("#FFE97F")],t.prototype,"searchHighlightColor",void 0),vp([(0,a.Property)(["Algerian","Arial","Calibri","Cambria","Cambria Math","Candara","Courier New","Georgia","Impact","Segoe Print","Segoe Script","Segoe UI","Symbol","Times New Roman","Verdana","Wingdings"])],t.prototype,"fontFamilies",void 0),vp([(0,a.Property)({shadingColor:"#cfcfcf",applyShading:!0,selectionColor:"#cccccc",formFillingMode:"Popup"})],t.prototype,"formFieldSettings",void 0),vp([(0,a.Property)({interval:2e3,itertationCount:5})],t.prototype,"autoResizeSettings",void 0),vp([(0,a.Property)({roomName:"",editableRegionColor:"#22b24b",lockedRegionColor:"#f44336"})],t.prototype,"collaborativeEditingSettings",void 0),vp([(0,a.Property)(1)],t.prototype,"printDevicePixelRatio",void 0),vp([(0,a.Property)(!0)],t.prototype,"enableOptimizedTextMeasuring",void 0),vp([(0,a.Property)(!0)],t.prototype,"allowDragAndDrop",void 0),vp([(0,a.Property)(32767)],t.prototype,"maximumRows",void 0),vp([(0,a.Property)(63)],t.prototype,"maximumColumns",void 0),vp([(0,a.Property)(!1)],t.prototype,"showHiddenMarks",void 0),vp([(0,a.Property)(!1)],t.prototype,"showBookmarks",void 0),vp([(0,a.Property)(!0)],t.prototype,"highlightEditableRanges",void 0),vp([(0,a.Property)(!0)],t.prototype,"optimizeSfdt",void 0),vp([(0,a.Property)(!1)],t.prototype,"showRuler",void 0),vp([(0,a.Property)({mode:"Picker",modeSwitcher:!0,showButtons:!0})],t.prototype,"colorPickerSettings",void 0),vp([(0,a.Property)(!1)],t.prototype,"showNavigationPane",void 0),vp([(0,a.Property)({mentionChar:"@"})],t.prototype,"mentionSettings",void 0),vp([(0,a.Property)(!1)],t.prototype,"pasteAsNewParagraph",void 0),t}(a.ChildProperty),Cp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)("Word2013")],t.prototype,"compatibilityMode",void 0),t}(a.ChildProperty),xp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)(2e3)],t.prototype,"interval",void 0),vp([(0,a.Property)(5)],t.prototype,"iterationCount",void 0),t}(a.ChildProperty),Ip=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.enableHeaderFooterIn=!1,n.isShiftingEnabled=!1,n.isContainerResize=!1,n.enableXMLPane=!1,n.isLayoutEnabled=!0,n.isPastingContent=!1,n.isOnIndent=!1,n.isTableMarkerDragging=!1,n.startXPosition=0,n.parser=void 0,n.isUpdateTrackChanges=!1,n.disableHistoryIn=!1,n.documentSettingOps=[],n.skipSettingsOps=!1,n.isSettingOp=!1,n.findResultsList=void 0,n.tablePropertiesDialogModule=void 0,n.bordersAndShadingDialogModule=void 0,n.cellOptionsDialogModule=void 0,n.tableOptionsDialogModule=void 0,n.paragraphDialogModule=void 0,n.imageResizerModule=void 0,n.createdTriggered=!1,n.serverActionSettingsImport="Import",n.isXmlPaneTool=!1,n.isXmlMapCC=!1,n.defaultLocale={Table:"Table",Row:"Row",Cell:"Cell",Ok:"OK",Apply:"Apply","Alt Text":"Alt Text",Title:"Title",Description:"Description",Cancel:"Cancel",Size:"Size","Preferred Width":"Preferred width",Points:"Points",Percent:"Percent","Measure in":"Measure in",Alignment:"Alignment",OutlineLevel:"Outline Level",BodyText:"Body Text",Level1:"Level 1",Level2:"Level 2",Level3:"Level 3",Level4:"Level 4",Level5:"Level 5",Level6:"Level 6",Level7:"Level 7",Level8:"Level 8",Level9:"Level 9",Left:"Left",Center:"Center",Right:"Right",Decimal:"Decimal",Bar:"Bar",Justify:"Justify","Indent from left":"Indent from left","Borders and Shading":"Borders and Shading",Options:"Options","Specify height":"Specify height","At least":"At least",Exactly:"Exactly","Row height is":"Row height is","Allow row to break across pages":"Allow row to break across pages","Repeat as header row at the top of each page":"Repeat as header row at the top of each page","Vertical alignment":"Vertical alignment",Top:"Top",Bottom:"Bottom","Default cell margins":"Default cell margins","Default cell spacing":"Default cell spacing","Allow spacing between cells":"Allow spacing between cells","Cell margins":"Cell margins","Same as the whole table":"Same as the whole table",Borders:"Borders",None:"None",Style:"Style",Width:"Width",Height:"Height",Letter:"Letter","1, 2, 3, ...":"1, 2, 3, ...","a, b, c, ...":"a, b, c, ...","A, B, C, ...":"A, B, C, ...","I, II, III, ...":"I, II, III, ...","i, ii, iii, ...":"i, ii, iii, ...",Tabloid:"Tabloid",Legal:"Legal",Statement:"Statement",Executive:"Executive",A3:"A3",A4:"A4",A5:"A5",B4:"B4",B5:"B5","Custom Size":"Custom size","Different odd and even":"Different odd and even","Different first page":"Different first page","From edge":"From edge",Header:"Header",Footer:"Footer","First Page Header":"First Page Header","First Page Footer":"First Page Footer","Even Page Header":"Even Page Header","Even Page Footer":"Even Page Footer","Odd Page Header":"Odd Page Header","Odd Page Footer":"Odd Page Footer","Same as Previous":"Same as Previous",Section:"Section",Margin:"Margins",Paper:"Paper",Layout:"Layout",Orientation:"Orientation",Landscape:"Landscape",Portrait:"Portrait","Show page numbers":"Show page numbers","Right align page numbers":"Right align page numbers",Nothing:"Nothing","Tab leader":"Tab leader",Leader:"Leader","Show levels":"Show levels","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers","Build table of contents from":"Build table of contents from",Styles:"Styles","Available styles":"Available styles","TOC level":"TOC level",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","Heading 7":"Heading 7","Heading 8":"Heading 8","Heading 9":"Heading 9","List Paragraph":"List Paragraph",Normal:"Normal","Outline levels":"Outline levels","Table entry fields":"Table entry fields",Modify:"Modify",Color:"Color",Setting:"Setting",Box:"Box",All:"All",Custom:"Custom",Preview:"Preview",Shading:"Shading",Fill:"Fill","Apply To":"Apply to","Table Properties":"Table Properties","Cell Options":"Cell Options","Table Options":"Table Options","Insert Table":"Insert Table","Number of columns":"Number of columns","Number of rows":"Number of rows","Text to display":"Text to display","ScreenTip text":"ScreenTip text",Address:"Address","Insert Hyperlink":"Insert Hyperlink","Edit Hyperlink":"Edit Hyperlink",Insert:"Insert",General:"General","The number must be between":"The number must be between 1 and 9","The Invalid number":"This is not a valid number",Indentation:"Indentation","Before text":"Before text",Special:"Special","First line":"First line",Hanging:"Hanging","After text":"After text",By:"By",Before:"Before","Line Spacing":"Line spacing",After:"After",At:"At",Multiple:"Multiple",Spacing:"Spacing","Define new Multilevel list":"Define new Multilevel list","List level":"List level","Choose level to modify":"Choose level to modify",Level:"Level","Number format":"Number format","Number style for this level":"Number style for this level","Enter formatting for number":"Enter formatting for number","Start at":"Start at","Restart list after":"Restart list after",Position:"Position","Text indent at":"Text indent at","Aligned at":"Aligned at","Follow number with":"Follow number with","Tab character":"Tab character",Space:"Space",Arabic:"Arabic",UpRoman:"UpRoman",LowRoman:"LowRoman",UpLetter:"UpLetter",LowLetter:"LowLetter",Number:"Number","Leading zero":"Leading zero",Bullet:"Bullet",Ordinal:"Ordinal","Ordinal Text":"Ordinal Text","For East":"For East","No Restart":"No Restart",Font:"Font","Font style":"Font style","Underline style":"Underline style","Font color":"Font color",Effects:"Effects",Strikethrough:"Strikethrough",Superscript:"Superscript",Subscript:"Subscript","Double strikethrough":"Double strikethrough",Regular:"Regular",Bold:"Bold",Italic:"Italic",Cut:"Cut",Copy:"Copy",Paste:"Paste",Hyperlink:"Hyperlink","Remove Content Control":"Remove Content Control","Content Control Properties":"Content Control Properties","Remove content control when contents are edited":"Remove content control when contents are edited","Content control cannot be deleted":"Content control cannot be deleted","Contents cannot be edited":"Contents cannot be edited","Plain Text properties":"Plain Text properties","Allow carriage returns":"Allow carriage returns","Drop_Down List properties":"Drop_Down List properties","Display Text":"Display Text",Locking:"Locking",Tag:"Tag",Value:"Value",PictureContentControl:"PictureContentControl","Upload from computer":"Upload from computer",Picture:"Picture","Choose an item":"Choose an item","Insert Pictures":"Insert Pictures","Open Hyperlink":"Open Hyperlink","Copy Hyperlink":"Copy Hyperlink","Remove Hyperlink":"Remove Hyperlink",Paragraph:"Paragraph","Linked Style":"Linked(Paragraph and Character)",Character:"Character","Merge Cells":"Merge Cells","Insert Above":"Insert Above","Insert Below":"Insert Below","Insert Left":"Insert Left","Insert Right":"Insert Right",Delete:"Delete","Delete Table":"Delete Table","Delete Row":"Delete Row","Delete Column":"Delete Column","File Name":"File Name","Format Type":"Format Type",Save:"Save",Navigation:"Navigation",Results:"Results",Replace:"Replace","Replace All":"Replace All","We replaced all":"We replaced all",Find:"Find","No matches":"No matches","All Done":"All Done",Result:"Result",of:"of",instances:"instances",with:"with","Click to follow link":"Click to follow link","Continue Numbering":"Continue Numbering","Bookmark name":"Bookmark name",Tab:"Tab","Tab stop position":"Tab stop position",Close:"Close","Restart At":"Restart At",Properties:"Properties",Name:"Name","Style type":"Style type","Style based on":"Style based on","Style for following paragraph":"Style for following paragraph",Formatting:"Formatting","Numbering and Bullets":"Numbering and Bullets",Numbering:"Numbering","Update Field":"Update Field","Edit Field":"Edit Field",Bookmark:"Bookmark","Page Setup":"Page Setup","No bookmarks found":"No bookmarks found","Number format tooltip information":'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "Chapter %1." will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>…</br>Chapter N. Item</br></br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "%1.%2." will display numbering like</br>1.1. Item</br>1.2. Item</br>…</br>1.N. Item',Format:"Format","Create New Style":"Create New Style","Modify Style":"Modify Style",New:"New",InsertFootnote:"InsertFootnote",InsertEndnote:"InsertEndnote",Footnote:"Footnote",Endnote:"Endnote","Notes Options":"Notes Options",Bullets:"Bullets","Use bookmarks":"Use bookmarks","Table of Contents":"Table of Contents",AutoFit:"AutoFit","AutoFit to Contents":"AutoFit to Contents","AutoFit to Window":"AutoFit to Window","Fixed Column Width":"Fixed Column Width",Reset:"Reset","Match case":"Match case","Whole words":"Whole words",Add:"Add","Go To":"Go To","Search for":"Search for","Replace with":"Replace with","TOC 1":"TOC 1","TOC 2":"TOC 2","TOC 3":"TOC 3","TOC 4":"TOC 4","TOC 5":"TOC 5","TOC 6":"TOC 6","TOC 7":"TOC 7","TOC 8":"TOC 8","TOC 9":"TOC 9","Right-to-left":"Right-to-left","Left-to-right":"Left-to-right",Direction:"Direction","Table direction":"Table direction","Indent from right":"Indent from right","Contextual Spacing":"Don't add space between paragraphs of the same style","Password Mismatch":"The password don't match","Restrict Editing":"Restrict Editing","Formatting restrictions":"Formatting restrictions","Allow formatting":"Allow formatting","Editing restrictions":"Editing restrictions","Read only":"Read only","Exceptions Optional":"Exceptions (optional)","Select Part Of Document And User":"Select parts of the document and choose users who are allowed to freely edit them.",Everyone:"Everyone","More users":"More users","Add Users":"Add Users","Enforcing Protection":"Yes, Start Enforcing Protection","Start Enforcing Protection":"Start Enforcing Protection","Enter User":"Enter User",Users:"Users","Enter new password":"Enter new password","Reenter new password to confirm":"Reenter new password to confirm","Your permissions":"Your permissions","Protected Document":"This document is protected from unintentional editing.",FormFieldsOnly:"You may only fill in forms in this region.",CommentsOnly:"You may only insert comments into this region.",ReadOnlyProtection:"You may edit in this region.","Stop Protection":"Stop Protection",Password:"Password","Spelling Editor":"Spelling Editor",Spelling:"Spelling","Spell Check":"Spell Check","Underline errors":"Underline errors",Ignore:"Ignore","Ignore All":"Ignore All","Add to Dictionary":"Add to Dictionary",Change:"Change","Change All":"Change All",Suggestions:"Suggestions","The password is incorrect":"The password is incorrect","Error in establishing connection with web server":"Error in establishing connection with web server","Failed to load the file":"Failed to load the file","Highlight the regions I can edit":"Highlight the regions I can edit","Show All Regions I Can Edit":"Show All Regions I Can Edit","Find Next Region I Can Edit":"Find Next Region I Can Edit","Keep source formatting":"Keep source formatting","Match destination formatting":"Match destination formatting",InsertAsRows:"Insert as New Rows",InsertAsColumns:"Insert as New Columns",OverwriteCells:"Overwrite Cells",NestTable:"Nest Table","Text only":"Text only",Comments:"Comments","Type your comment":"Type your comment",Post:"Post",Reply:"Reply","New Comment":"New Comment",Edit:"Edit",Resolve:"Resolve",Reopen:"Reopen","No comments in this document":"No comments in this document",more:"more","Type your comment here":"Type your comment here","Next Comment":"Next Comment","Previous Comment":"Previous Comment","Un-posted comments":"Un-posted comments","XML Mapping":"XML Mapping","Custom XML Part":"Custom XML Part:","Discard Comment":"Added comments not posted. If you continue, that comment will be discarded.","Discard Content Control":"You can not insert a content control when the selection includes another content control.","No Headings":"No Heading Found!","Add Headings":"This document has no headings. Please add headings and try again.","More Options":"More Options","Click to see this comment":"Click to see this comment","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box","Drop Down Form Field":"Drop Down Form Field","Dropdown items":"Drop-down items","Items in dropdown list":"Items in drop-down list",ADD:"ADD",REMOVE:"REMOVE","Field settings":"Field settings",Tooltip:"Tooltip","Dropdown enabled":"Drop-down enabled","Check Box Form Field":"Check Box Form Field","Check box size":"Check box size",Auto:"Auto","Default value":"Default value","Not checked":"Not checked",Checked:"Checked","Check box enabled":"Check box enabled","Text Form Field":"Text Form Field",Type:"Type","Default text":"Default text","Maximum length":"Maximum length","Text format":"Text format","Fillin enabled":"Fill-in enabled","Default number":"Default number","Default date":"Default date","Date format":"Date format","Merge Track":"This action wont be marked as change. Do you want to continue?",UnTrack:"Cannot be tracked !",Accept:"Accept",Reject:"Reject","Previous Changes":"Previous Changes","Next Changes":"Next Changes",Inserted:"Inserted",Deleted:"Deleted","Move From":"Move From","Move To":"Move To",Changes:"Changes","Accept all":"Accept all","Reject all":"Reject all","No changes":"No changes","Accept Changes":"Accept Changes","Reject Changes":"Reject Changes",User:"User",View:"View",Insertion:"Insertion",Deletion:"Deletion","All caps":"All caps","This region is locked by":"This region is locked by",Lock:"Lock",Unlock:"Unlock","Already locked":"Selected or part of region is already locked by another user","Click to View/Edit Footnote":"Click to View/Edit Footnote","Click to View/Edit Endnote":"Click to View/Edit Endnote","Multiple Comment":"Please post your comment","No suggestions":"No suggestions","More Suggestion":"More Suggestion","Ignore Once":"Ignore Once","Keep With Next":"Keep with next","Keep Lines Together":"Keep lines together",WidowControl:"Widow/Orphan control","Indents and Spacing":"Indents and Spacing","Line and Page Breaks":"Line and Page Breaks",Pagination:"Pagination",Single:"Single",DashSmallGap:"DashSmallGap",DashDot:"DashDot",Double:"Double",ThinThickSmallGap:"ThinThickSmallGap",ThickThinSmallGap:"ThickThinSmallGap",ThickThinMediumGap:"ThickThinMediumGap",ThickThinLargeGap:"ThickThinLargeGap",SingleWavy:"SingleWavy",DoubleWavy:"DoubleWavy",Inset:"Inset",DashLargeGap:"DashLargeGap",Dot:"Dot",DashDotDot:"DashDotDot",Triple:"Triple",ThinThickThinSmallGap:"ThinThickThinSmallGap",ThinThickThinMediumGap:"ThinThickThinMediumGap",ThinThickThinLargeGap:"ThinThickThinLargeGap",DashDotStroked:"DashDotStroked",Engrave3D:"Engrave3D",Thick:"Thick",Outset:"Outset",Emboss3D:"Emboss3D",ThinThickLargeGap:"ThinThickLargeGap",ThinThickMediumGap:"ThinThickMediumGap","Number of rows must be between":"Number of rows must be between","Number of columns must be between":"Number of columns must be between",and:"and",Unlimited:"Unlimited","Regular text":"Regular text",Date:"Date",Uppercase:"Uppercase",Lowercase:"Lowercase",FirstCapital:"FirstCapital",TitleCase:"Titlecase","Filling in forms":"Filling in forms",px:"px","Tracked changes":"Tracked changes",TrackChangesOnly:"You may edit in this region, but all change will be tracked.",RemovedIgnoreExceptions:"If you make this change in document protection, Word will ignore all the exceptions in this document.",RemovedIgnore:"Do you want to remove the ignored exceptions?",Information:"Information",Yes:"Yes",No:"No","Page Break":"Page Break","Column Break":"Column Break","Section Break Next Page":"Section Break (Next Page)","Section Break Continuous":"Section Break (Continuous)","Unsupported format":"The file format you have selected isn't supported. Please choose valid format.",One:"One",Two:"Two",Three:"Three",Presets:"Presets",Columns:"Columns","Split your text into two or more columns":"Split your text into two or more columns","Line between column":"Line between column","Width and Spacing":"Width and Spacing","Equal column width":"Equal column width",Column:"Column","Paste Content Dialog":"Due to browser’s security policy, paste from system clipboard is restricted. Alternatively use the keyboard shortcut","Paste Content CheckBox":"Don’t show again",BookMarkList:"List of bookmarks in the document",TabMarkList:"List of tab stops in the paragraph","Default tab stops":"Default tab stops","Tab stops to be cleared":"Tab stops to be cleared",Tabs:"Tabs",Set:"Set",Clear:"Clear","Clear All":"Clear All",Discard:"Discard","The top/bottom margins are too large for the page height in some sections.":"The top/bottom margins are too large for the page height in some sections.","Column width cannot be less than 36 pt.":"Column width cannot be less than 36 pt.","Left and right margins.":"Settings you chose for the left and right margins, column spacing, or pargraph indents are too large for the page width in same secitions.","Left Indent":"Left Indent","Right Indent":"Right Indent","Hanging Indent":"Hanging Indent","First Line Indent":"First Line Indent","Left Margin":"Left Margin","Right Margin":"Right Margin","Top Margin":"Top Margin","Bottom Margin":"Bottom Margin","Left Tab":"Left Tab","Right Tab":"Right Tab","Center Tab":"Center Tab","Decimal Tab":"Decimal Tab","Bar Tab":"Bar Tab","Move Table Column":"Move Table Column","Default Content Control Text":"Click here or tap to insert text","Default Date Picker":"Click or tap enter the date","Rich text Controls":"Rich text controls cannot be applied here.","Plain text Controls":"Plain text controls cannot be applied here."},n.initHelper(),n}var i;return fp(t,e),i=t,Object.defineProperty(t.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(e){this.enableHeaderFooterIn=e,!e&&this.selectionModule&&this.selectionModule.isWebLayout&&(this.selectionModule.isWebLayout=!1),this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||(0,a.isNullOrUndefined)(this.viewer)||this.viewer instanceof Fl?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),t.prototype.getComments=function(){var e=[];if(this.documentHelper.comments.length>0)for(var t=[],i=0,n=this.documentHelper.comments;i<n.length;i++){var r=n[i];t=[];for(var o={author:r.author,isResolved:!!r.isResolved&&r.isResolved,dateTime:this.editor.parseDateTime(r.createdDate)},a=0,l=r.replyComments;a<l.length;a++){var d=l[a],h={author:d.author,isResolved:!!d.isResolved&&r.isResolved,dateTime:this.editor.parseDateTime(d.createdDate)},c=Pa.parseCommentAsText(d),p=new s(d.commentId,h,c);t.push(p)}var u={id:r.commentId,text:Pa.parseCommentAsText(r),commentProperties:o,replies:t};e.push(u)}return e},Object.defineProperty(t.prototype,"selection",{get:function(){return this.selectionModule||this.checkModuleInjection("Selection",this.enableSelection),this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editor",{get:function(){return this.editorModule||this.checkModuleInjection("Editor",this.enableEditor),this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editorHistory",{get:function(){return this.editorHistoryModule||this.checkModuleInjection("EditorHistory",this.enableEditorHistory),this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"search",{get:function(){return this.searchModule||this.checkModuleInjection("Search",this.enableSearch),this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextMenu",{get:function(){return this.contextMenuModule||this.checkModuleInjection("ContextMenu",this.enableContextMenu),this.contextMenuModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spellCheckDialog",{get:function(){return this.spellCheckDialogModule||this.checkModuleInjection("SpellCheck",this.enableSpellCheck),this.spellCheckDialogModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spellChecker",{get:function(){return this.spellCheckerModule||this.checkModuleInjection("SpellCheck",this.enableSpellCheck),this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(e){this.isDocumentLoadedIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDocumentEmpty",{get:function(){if(1===this.documentHelper.pages.length){var e=this.documentHelper.pages[0],t=e.headerWidget,i=e.footerWidget,n=!0,r=!0;if((0,a.isNullOrUndefined)(t)||(0,a.isNullOrUndefined)(t.firstChild)||t.firstChild instanceof Rl&&t.firstChild.isEmpty()||(n=!1),(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(i.firstChild)||i.firstChild instanceof Rl&&i.firstChild.isEmpty()||(r=!1),n&&r){var o=e.bodyWidgets[0];if((0,a.isNullOrUndefined)(o.nextWidget)){var s=o.firstChild;if(s instanceof Rl&&s.isEmpty()&&(0,a.isNullOrUndefined)(s.nextWidget))return!0}}return!1}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"revisions",{get:function(){return(0,a.isNullOrUndefined)(this.revisionsInternal)&&(this.revisionsInternal=new Ia(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!(0,a.isNullOrUndefined)(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentStart",{get:function(){if(!(0,a.isNullOrUndefined)(this.selectionModule))return this.selectionModule.getDocumentStart();this.checkModuleInjection("Selection",this.enableSelection)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentEnd",{get:function(){if(!(0,a.isNullOrUndefined)(this.selectionModule))return this.selectionModule.getDocumentEnd();this.checkModuleInjection("Selection",this.enableSelection)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||(0,a.isNullOrUndefined)(this.editorModule)||(0,a.isNullOrUndefined)(this.selectionModule)||!(0,a.isNullOrUndefined)(this.editorModule)&&this.editorModule.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellCheckerModule.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!(0,a.isNullOrUndefined)(this.imageResizerModule)},enumerable:!0,configurable:!0}),t.prototype.preRender=function(){var e=this;this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?i.Inject($c):i.Inject(ep),this.findResultsList=[],setTimeout((function(){(0,a.isNullOrUndefined)(e.documentEditorSettings.popupTarget)&&(e.documentEditorSettings.popupTarget=document.body)}),0),(0,a.isNullOrUndefined)(this.element)||""!==this.element.id||(this.element.id=Pa.getUniqueElementId()),this.refreshing&&this.initHelper()},t.prototype.updateExternalStyle=function(){var e=this;if(this.externalFonts&&this.externalFonts.length>0){this.clearExistingStyles();var t=document.createElement("style");t.type="text/css",t.id="e-de-custom-font-styles";var i="";this.externalFonts.forEach((function(t){t.src&&t.fontFamily&&!e.parser.isFontInstalled(t.fontFamily)&&(i+="@font-face {font-family: '"+t.fontFamily+"'; src: "+t.src+"}")})),i&&(t.appendChild(document.createTextNode(i)),document.head.appendChild(t),t.onload=function(){var e=this;this.externalFonts.forEach((function(t){if(t.src&&t.fontFamily&&!e.parser.isFontInstalled(t.fontFamily)){var i=document.createElement("div");i.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;"),i.textContent="test font",i.style.fontFamily='"'+t.fontFamily+'"',document.body.appendChild(i)}}))}.bind(this))}},t.prototype.clearExistingStyles=function(){var e=document.head;e.querySelectorAll("style#e-de-custom-font-styles").forEach((function(t){e.removeChild(t)}))},t.prototype.initHelper=function(){this.documentHelper=new xl(this),"Pages"===this.layoutType?this.viewer=new kl(this):this.viewer=new Fl(this),this.parser=new ip(this.documentHelper)},t.prototype.render=function(){if(!(0,a.isNullOrUndefined)(this.element)){var e=this.element;e.style.minHeight="200px",e.style.minWidth="200px",""!==this.height&&(this.element.style.height=(0,a.formatUnit)(this.height)),""!==this.width&&(this.element.style.width=(0,a.formatUnit)(this.width))}this.textMeasureHelper=this.optimizedModule?this.optimizedModule:this.regularModule,(0,a.isNullOrUndefined)(this.textMeasureHelper)&&(this.textMeasureHelper=new $c(this.documentHelper)),this.documentHelper.initializeComponents(),this.openBlank(),this.renderComplete(),this.renderRulers(),this.renderNavigationPane(),this.createdTriggered=!0},t.prototype.renderRulers=function(){this.rulerHelper=new pp,this.rulerContainer=this.rulerHelper.renderOverlapElement(this),this.rulerHelper.renderRuler(this,!0),this.rulerHelper.renderRuler(this,!1),this.rulerHelper.renderRulerMarkerIndicatorElement(this),this.rulerHelper.createIndicatorLines(this),this.showHideRulers()},t.prototype.showHideRulers=function(){if(this.rulerHelper&&this.documentEditorSettings&&!(0,a.isNullOrUndefined)(!this.documentEditorSettings.showRuler)){var e=this.documentEditorSettings.showRuler&&!this.isReadOnlyMode;this.rulerHelper.hideTabStopSwitch(e),this.rulerHelper.hideRulerBottom(e),this.vRuler&&this.vRuler.showHideRuler(e),this.hRuler&&this.hRuler.showHideRuler(e)}},t.prototype.renderNavigationPane=function(){!this.isReadOnly&&this.optionsPaneModule&&this.optionsPaneModule.showHideOptionsPane(this.documentEditorSettings.showNavigationPane)},t.prototype.getModuleName=function(){return"DocumentEditor"},t.prototype.onPropertyChanged=function(e,t){for(var i=this,n=0,r=Object.keys(e);n<r.length;n++){switch(r[n]){case"enableTrackChanges":this.notify(Y,e),this.getSettingData("enableTrackChanges",e.enableTrackChanges),this.documentHelper.isTrackedOnlyMode&&!e.enableTrackChanges&&(this.enableTrackChanges=!0);break;case"autoResizeOnVisibilityChange":e.autoResizeOnVisibilityChange&&this.documentHelper.triggerAutoResizeInterval();break;case"zoomFactor":this.viewer&&t.zoomFactor!==e.zoomFactor&&(this.documentHelper.zoomFactor=e.zoomFactor,this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0),this.enableCollaborativeEditing&&this.collaborativeEditingHandlerModule&&this.collaborativeEditingHandlerModule.updateCaretPosition());break;case"layoutType":if(this.selectionModule&&this.selectionModule.isWebLayout)break;this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new kl(this):(!0===this.enableHeaderAndFooter&&this.selectionModule.closeHeaderFooter(),this.viewer=new Fl(this)),this.selectionModule.start.paragraph.containerWidget instanceof Dl&&(this.selectionModule.clearSelectionHighlightInSelectedWidgets(),this.selectionModule.selectContent(this.documentStart,!0)),this.editorModule.layoutWholeDocument(!0),setTimeout((function(){i.fireViewChange()}),200);break;case"locale":this.localizeDialogs();break;case"isReadOnly":!(0,a.isNullOrUndefined)(this.optionsPaneModule)&&this.optionsPaneModule.isOptionsPaneShow&&(this.optionsPaneModule.showHideOptionsPane(!1),this.documentHelper.updateFocus()),this.showComments&&this.commentReviewPane.showHidePane(!0,"Comments"),this.commentReviewPane.enableDisableItems(),this.trackChangesPane.enableDisableButton(!this.isReadOnly&&!this.documentHelper.isDocumentProtected),this.showHideRulers();break;case"currentUser":case"userColor":this.selectionModule&&this.documentHelper.isDocumentProtected&&this.selectionModule.highlightEditRegion(),this.viewer.updateScrollBars();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"zIndex":this.documentHelper.dialog&&(this.documentHelper.dialog.zIndex=e.zIndex+10),this.documentHelper.dialog2&&(this.documentHelper.dialog2.zIndex=e.zIndex);break;case"showComments":this.viewer&&e.showComments!==t.showComments&&this.documentHelper.showComments(e.showComments),this.viewer.updateScrollBars();break;case"enableRtl":this.localizeDialogs(e.enableRtl);break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(e.enableComment)),this.viewer.updateScrollBars();break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?this.documentHelper.showRevisions(!1):this.viewer&&this.documentHelper.showRevisions(e.showRevisions),this.viewer.updateScrollBars();break;case"documentSettings":if(!(0,a.isNullOrUndefined)(e.documentSettings.compatibilityMode)){var o=t.documentSettings.compatibilityMode,s=e.documentSettings.compatibilityMode;("Word2013"==o&&"Word2013"!=s||"Word2013"!=o&&"Word2013"==s)&&this.documentHelper.compatibilityMode!==s&&(this.documentHelper.compatibilityMode=s,this.editorModule.layoutWholeDocument(!0))}this.viewer.updateScrollBars();break;case"documentEditorSettings":(0,a.isNullOrUndefined)(e.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentHelper.heightInfoCollection={},e.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=this.optimizedModule:this.textMeasureHelper=this.regularModule,this.viewer.updateScrollBars()),(!(0,a.isNullOrUndefined)(e.documentEditorSettings.showHiddenMarks)&&e.documentEditorSettings.showHiddenMarks!==t.documentEditorSettings.showHiddenMarks||!(0,a.isNullOrUndefined)(e.documentEditorSettings.showBookmarks)&&e.documentEditorSettings.showBookmarks!==t.documentEditorSettings.showBookmarks)&&(this.trackChangesPane&&this.trackChangesPane.showHiddenParaMark(),this.viewer.updateScrollBars()),(0,a.isNullOrUndefined)(e.documentEditorSettings.highlightEditableRanges)||this.documentHelper&&this.documentHelper.restrictEditingPane&&(this.documentHelper.restrictEditingPane.highlightCheckBox.checked=e.documentEditorSettings.highlightEditableRanges,this.documentHelper.selection.isHighlightEditRegion=e.documentEditorSettings.highlightEditableRanges),(0,a.isNullOrUndefined)(e.documentEditorSettings.colorPickerSettings)||e.documentEditorSettings.colorPickerSettings&&this.applyColorPickerProperties(e),(0,a.isNullOrUndefined)(e.documentEditorSettings.showRuler)||(this.showHideRulers(),e.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0)),(0,a.isNullOrUndefined)(e.documentEditorSettings.showNavigationPane)||!this.isReadOnly&&this.optionsPaneModule&&this.optionsPaneModule.showHideOptionsPane(this.documentEditorSettings.showNavigationPane),this.enableCollaborativeEditing&&this.collaborativeEditingHandlerModule&&this.collaborativeEditingHandlerModule.updateCaretPosition(),(0,a.isNullOrUndefined)(e.documentEditorSettings.pasteAsNewParagraph)||(this.documentEditorSettings.pasteAsNewParagraph=e.documentEditorSettings.pasteAsNewParagraph);break;case"height":this.element.style.height=(0,a.formatUnit)(this.height),this.resize();break;case"width":this.element.style.width=(0,a.formatUnit)(this.width),this.resize();break;case"enableAutoFocus":this.enableAutoFocus=e.enableAutoFocus}}},t.prototype.applyColorPickerProperties=function(e){if(e.documentEditorSettings.colorPickerSettings){var t=e.documentEditorSettings.colorPickerSettings;!this.isReadOnly&&!(0,a.isNullOrUndefined)(t)&&this.bordersAndShadingDialogModule&&this.documentHelper.borderColorPicker&&this.documentHelper.shadingColorPicker&&((0,a.isNullOrUndefined)(t.mode)||(this.documentHelper.borderColorPicker.mode=e.documentEditorSettings.colorPickerSettings.mode,this.documentHelper.shadingColorPicker.mode=e.documentEditorSettings.colorPickerSettings.mode),(0,a.isNullOrUndefined)(t.showButtons)||(this.documentHelper.borderColorPicker.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons,this.documentHelper.shadingColorPicker.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),(0,a.isNullOrUndefined)(t.modeSwitcher)||(this.documentHelper.borderColorPicker.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher,this.documentHelper.shadingColorPicker.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher)),!this.isReadOnly&&!(0,a.isNullOrUndefined)(t)&&this.fontDialogModule&&this.documentHelper.fontColor&&((0,a.isNullOrUndefined)(t.mode)||(this.documentHelper.fontColor.mode=e.documentEditorSettings.colorPickerSettings.mode),(0,a.isNullOrUndefined)(t.showButtons)||(this.documentHelper.fontColor.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),(0,a.isNullOrUndefined)(t.modeSwitcher)||(this.documentHelper.fontColor.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher)),!this.isReadOnly&&!(0,a.isNullOrUndefined)(t)&&this.styleDialogModule&&this.documentHelper.colorPicker&&((0,a.isNullOrUndefined)(t.mode)||(this.documentHelper.colorPicker.mode=e.documentEditorSettings.colorPickerSettings.mode),(0,a.isNullOrUndefined)(t.showButtons)||(this.documentHelper.colorPicker.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),(0,a.isNullOrUndefined)(t.modeSwitcher)||(this.documentHelper.colorPicker.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher)),(0,a.isNullOrUndefined)(t)||((0,a.isNullOrUndefined)(t.mode)||(this.documentHelper.fontColorInputElement.mode=e.documentEditorSettings.colorPickerSettings.mode,this.documentHelper.shadingBtn.mode=e.documentEditorSettings.colorPickerSettings.mode,this.documentHelper.borderBtn.mode=e.documentEditorSettings.colorPickerSettings.mode),(0,a.isNullOrUndefined)(t.showButtons)||(this.documentHelper.fontColorInputElement.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons,this.documentHelper.shadingBtn.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons,this.documentHelper.borderBtn.showButtons=e.documentEditorSettings.colorPickerSettings.showButtons),(0,a.isNullOrUndefined)(t.modeSwitcher)||(this.documentHelper.fontColorInputElement.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher,this.documentHelper.shadingBtn.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher,this.documentHelper.borderBtn.modeSwitcher=e.documentEditorSettings.colorPickerSettings.modeSwitcher))}},t.prototype.localizeDialogs=function(e){if(""!==this.locale){var t=new a.L10n("documenteditor",this.defaultLocale);t.setLocale(this.locale),(0,a.isNullOrUndefined)(e)||(this.documentHelper.dialog.enableRtl=e,this.documentHelper.dialog2.enableRtl=e),this.optionsPaneModule&&this.optionsPaneModule.initOptionsPane(t,e),this.paragraphDialogModule&&this.paragraphDialogModule.initParagraphDialog(t),this.footNotesDialogModule&&this.footNotesDialogModule.notesDialog(t,e),this.pageSetupDialogModule&&this.pageSetupDialogModule.initPageSetupDialog(t,e),this.columnsDialogModule&&this.columnsDialogModule.initColumnsDialog(t,e),this.fontDialogModule&&this.fontDialogModule.initFontDialog(t,e),this.hyperlinkDialogModule&&this.hyperlinkDialogModule.initHyperlinkDialog(t,e),this.contextMenuModule&&(this.contextMenuModule.contextMenuInstance.destroy(),this.contextMenuModule.initContextMenu(t,e)),this.listDialogModule&&this.listDialogModule.initListDialog(t,e),this.tablePropertiesDialogModule&&this.tablePropertiesDialogModule.initTablePropertyDialog(t,e),this.bordersAndShadingDialogModule&&this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(t,e),this.cellOptionsDialogModule&&this.cellOptionsDialogModule.initCellMarginsDialog(t,e),this.tableOptionsDialogModule&&this.tableOptionsDialogModule.initTableOptionsDialog(t,e),this.tableDialogModule&&this.tableDialogModule.initTableDialog(t),this.styleDialogModule&&this.styleDialogModule.initStyleDialog(t,e),this.tabDialogModule&&this.tabDialogModule.initTabsDialog(t,e),this.tableOfContentsDialogModule&&this.tableOfContentsDialogModule.initTableOfContentDialog(t,e),this.commentReviewPane&&this.commentReviewPane.parentPaneElement&&(this.enableRtl?(0,a.classList)(this.commentReviewPane.parentPaneElement,["e-rtl"],[]):(0,a.classList)(this.commentReviewPane.parentPaneElement,[],["e-rtl"]))}},t.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=JSON.parse(Pa.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),(0,a.isNullOrUndefined)(this.selectionModule)||this.selectionModule.retrieveCurrentFormatProperties()},t.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=JSON.parse(Pa.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),(0,a.isNullOrUndefined)(this.selectionModule)||this.selectionModule.retrieveCurrentFormatProperties()},t.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=JSON.parse(Pa.sanitizeString(JSON.stringify(e))),this.documentHelper.setDefaultDocumentFormat(),(0,a.isNullOrUndefined)(this.selectionModule)||this.selectionModule.retrieveCurrentFormatProperties()},t.prototype.getPersistData=function(){return"documenteditor"},t.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof Il&&this.documentHelper.clearDocumentItems()},t.prototype.getDocumentEditorElement=function(){return this.element},t.prototype.fireContentChange=function(){if(!this.enableEditor||!this.editorModule.isIncrementalSave){this.enableLockAndEdit&&this.collaborativeEditingModule&&this.collaborativeEditingModule.saveContent();var e={source:this};if(this.enableCollaborativeEditing)if(e.operations=[],this.isSettingOp)e.operations=this.documentSettingOps,this.documentSettingOps=[],this.isSettingOp=!1;else if(!(0,a.isNullOrUndefined)(this.editorHistoryModule)){if((0,a.isNullOrUndefined)(this.editorHistoryModule.currentHistoryInfo)||"IMEInput"!==this.editorHistoryModule.currentHistoryInfo.action){if(!(0,a.isNullOrUndefined)(this.editorHistoryModule.lastOperation)){var t=this.editorHistoryModule.lastOperation;"IMEInput"===t.action?e.operations=t.getActionInfo(!0):e.operations=t.getActionInfo(),this.editorHistoryModule.lastOperation=void 0}}else e.operations=this.editorHistoryModule.currentHistoryInfo.getActionInfo();if(this.enableTrackChanges&&e.operations.length>0)for(var i=0;i<e.operations.length;i++)(0,a.isNullOrUndefined)(e.operations[i].markerData)&&(e.operations[i].markerData={}),((0,a.isNullOrUndefined)(e.operations[i].markerData.author)||""===e.operations[i].markerData.author)&&(e.operations[i].markerData.author=this.currentUser)}this.trigger(u,e)}},t.prototype.fireDocumentChange=function(){this.enableLockAndEdit&&this.enableEditor&&this.editorModule.enforceProtection("",!1,!0);var e={source:this};this.trigger(g,e)},t.prototype.fireSelectionChange=function(){if(!this.enableEditor||!this.editorModule.isIncrementalSave){!this.documentHelper.isCompositionStart&&a.Browser.isDevice&&this.editorModule&&this.editorModule.predictText();var e={source:this,isCompleted:this.documentHelper.isCompleted};this.trigger(v,e),this.documentHelper.isSelectionCompleted=this.documentHelper.isCompleted,this.documentHelper.isCompleted=!0}},t.prototype.fireZoomFactorChange=function(){var e={source:this};this.trigger(y,e),this.notify(p,e)},t.prototype.fireOptionPaneChange=function(e){var t={show:e};this.notify(Q,t)},t.prototype.fireBeformFieldFill=function(){this.trigger(w,{})},t.prototype.fireAfterFormFieldFill=function(){this.trigger(b,{})},t.prototype.fireBeforeContentControlFill=function(){this.trigger(T,{})},t.prototype.fireAfterContentControlFill=function(){this.trigger(H,{})},t.prototype.fireServiceFailure=function(e){this.trigger(I,e)},t.prototype.fireViewChange=function(){if(this.viewer&&this.documentHelper.pages.length>0&&this.viewer.visiblePages.length>0){var e=this.viewer.visiblePages,t={startPage:e[0].index+1,endPage:e[e.length-1].index+1,source:this};this.trigger(k,t),this.notify(q,t)}},t.prototype.fireCustomContextMenuSelect=function(e){var t={id:e};this.trigger(F,t)},t.prototype.fireCustomContextMenuBeforeOpen=function(e){var t={ids:e};this.trigger(P,t)},t.prototype.showParagraphDialog=function(e){this.paragraphDialogModule&&!this.isReadOnlyMode&&this.viewer?this.paragraphDialogModule.show(e):this.checkModuleInjection("ParagraphDialog",this.enableParagraphDialog)},t.prototype.showPageSetupDialog=function(){this.pageSetupDialogModule&&!this.isReadOnlyMode&&this.viewer?this.pageSetupDialogModule.show():this.checkModuleInjection("PageSetupDialog",this.enablePageSetupDialog)},t.prototype.showColumnsDialog=function(){this.columnsDialogModule&&!this.isReadOnlyMode&&this.viewer?this.columnsDialogModule.show():this.checkModuleInjection("ColumnsDialog",this.enableColumnsDialog)},t.prototype.showFootNotesDialog=function(){this.footNotesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.footNotesDialogModule.show()},t.prototype.showFontDialog=function(e){this.fontDialogModule&&!this.isReadOnlyMode&&this.viewer?this.fontDialogModule.showFontDialog(e):this.checkModuleInjection("FontDialog",this.enableFontDialog)},t.prototype.showCellOptionsDialog=function(){this.cellOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.cellOptionsDialogModule.show()},t.prototype.showTableOptionsDialog=function(){this.tableOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tableOptionsDialogModule.show():this.checkModuleInjection("TableOptionsDialog",this.enableTableOptionsDialog)},t.prototype.showTableDialog=function(){this.tableDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tableDialogModule.show():this.checkModuleInjection("TableDialog",this.enableTableDialog)},t.prototype.showDateContentDialog=function(){this.dateContentDialogModule&&!this.isReadOnlyMode&&this.viewer?this.dateContentDialogModule.show():this.checkModuleInjection("DateContentDialog",this.enableDateContentDialog)},t.prototype.showPicContentControlDialog=function(){var e=this.getImageContentControl(),t=!0,i=!0,n=this.picturePositionY;this.selection.isEmpty&&this.renderPictureContentControlElement(this,t,i,n),this.selection.isImageSelected&&(this.renderPictureContentControlElement(this,t,i,n),e instanceof id&&"Picture"!=e.contentControlProperties.type||this.editor.insertContentControl("Picture"))},t.prototype.showpicContentControlDialogModule=function(){this.picContentControlDialogModule&&!this.isReadOnlyMode&&this.viewer?this.picContentControlDialogModule.show():this.checkModuleInjection("PicContentControlDialog",this.enablePicContentControlDialog)},t.prototype.renderPictureContentControlElement=function(e,t,i,n){var r=this;if(this.enableSelection){var o,s,l={id:this.element.id+"PICTURE_CONTENT_CONTROL",innerHTML:"Picture",class:"e-btn-icon e-icons e-de-ctnr-image e-icon-left",style:"height:20px;width:70px;z-index:5;position:absolute;background-color:#ccc;border:1px solid #ccc;display:"},d=document.getElementById(this.element.id+"_viewerContainer"),h=document.getElementById(this.element.id+"PICTURE_CONTENT_CONTROL");(0,a.isNullOrUndefined)(h)&&t||i?(o=this.rulerHelper.createHtmlElement("div",l),this.setPictureContentControlPositions(o),d.insertBefore(o,d.firstChild),o.style.display="block",o.addEventListener("click",(function(e){s=r.getImageContentControl(),((0,a.isNullOrUndefined)(s)||"Picture"!=s.contentControlProperties.type)&&r.picContentControlDialogModule.show()}))):(0,a.isNullOrUndefined)(h)||!t||i?(0,a.isNullOrUndefined)(h)||t||i||(h.style.display="none"):(h.style.display="block",this.setPictureContentControlPositions(h),h.addEventListener("click",(function(e){(s=r.getImageContentControl())instanceof id&&!s.contentControlProperties.lockContentControl&&"Picture"==s.contentControlProperties.type&&!r.documentHelper.owner.isReadOnlyMode&&r.picContentControlDialogModule.show()})));var c=new a.L10n("documenteditor",this.defaultLocale);c.setLocale(this.locale),c.getConstant("Picture")}},t.prototype.setPictureContentControlPositions=function(e){var t=this.selection.isForward?this.selection.start.location.x:this.selection.end.location.x,i=this.selection.getTop(this.documentHelper.selection.start.currentWidget);e.style.left=(t*this.documentHelper.zoomFactor+this.documentHelper.pages[0].boundingRectangle.x).toString()+"px",e.style.top=(i*this.documentHelper.zoomFactor).toString()+"px"},t.prototype.getImageContentControl=function(){for(var e,t=this.documentHelper.owner.selectionModule.start.currentWidget.paragraph,i=0;i<t.childWidgets.length;i++)for(var n=0;n<t.childWidgets[i].children.length;n++){var r=t.childWidgets[i].children[n];if(r instanceof id&&0==r.type&&"Picture"==r.contentControlProperties.type){e=t.childWidgets[i].children[n];break}}return e},t.prototype.showContentPropertiesDialog=function(){this.contentControlPropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer?this.contentControlPropertiesDialogModule.show():this.checkModuleInjection("ContentControlPropertiesDialog",this.enableContentControlPropertiesDialog)},t.prototype.showTableOfContentsDialog=function(){this.tableOfContentsDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tableOfContentsDialogModule.show():this.checkModuleInjection("TableOfContentsDialog",this.enableTableOfContentsDialog)},t.prototype.showStyleDialog=function(){this.styleDialogModule&&!this.isReadOnlyMode&&this.viewer?this.styleDialogModule.show():this.checkModuleInjection("StyleDialog",this.enableStyleDialog)},t.prototype.showHyperlinkDialog=function(){this.hyperlinkDialogModule&&!this.isReadOnlyMode&&this.viewer?this.hyperlinkDialogModule.show():this.checkModuleInjection("HyperlinkDialog",this.enableHyperlinkDialog)},t.prototype.showBookmarkDialog=function(){this.bookmarkDialogModule&&!this.isReadOnlyMode&&this.viewer?this.bookmarkDialogModule.show():this.checkModuleInjection("BookmarkDialog",this.enableBookmarkDialog)},t.prototype.showStylesDialog=function(){this.stylesDialogModule&&!this.isReadOnlyMode&&this.viewer?this.stylesDialogModule.show():this.checkModuleInjection("StylesDialog",this.enableStyleDialog)},t.prototype.showListDialog=function(){this.listDialogModule&&!this.isReadOnlyMode&&this.viewer?this.listDialogModule.showListDialog():this.checkModuleInjection("ListDialog",this.enableListDialog)},t.prototype.showTablePropertiesDialog=function(){this.tablePropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer?this.tablePropertiesDialogModule.show():this.checkModuleInjection("TablePropertiesDialog",this.enableTablePropertiesDialog)},t.prototype.showBordersAndShadingDialog=function(){this.bordersAndShadingDialogModule&&!this.isReadOnlyMode&&this.viewer?this.bordersAndShadingDialogModule.show():this.checkModuleInjection("BordersAndShadingDialog",this.enableBordersAndShadingDialog)},t.prototype.requiredModules=function(){var e=[];return this.enableCollaborativeEditing&&e.push({member:"CollaborativeEditingHandler",args:[this]}),this.enableLockAndEdit&&e.push({member:"CollaborativeEditing",args:[this]}),this.enablePrint&&e.push({member:"Print",args:[]}),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&e.push({member:"SfdtExport",args:[this.documentHelper]}),this.enableWordExport&&e.push({member:"WordExport",args:[]}),this.enableTextExport&&e.push({member:"TextExport",args:[]}),(this.enableSelection||this.enableSearch||this.enableEditor)&&(e.push({member:"Selection",args:[this]}),this.enableContextMenu&&e.push({member:"ContextMenu",args:[this.documentHelper]})),this.enableSearch&&(e.push({member:"Search",args:[this]}),this.enableOptionsPane&&e.push({member:"OptionsPane",args:[this.documentHelper]})),this.documentEditorSettings&&this.documentEditorSettings.enableOptimizedTextMeasuring?(i.Inject($c),e.push({member:"Optimized",args:[this.documentHelper]})):(i.Inject(ep),e.push({member:"Regular",args:[this.documentHelper]})),this.enableEditor&&(e.push({member:"Editor",args:[this.documentHelper]}),e.push({member:"XmlPane",args:[this.documentHelper]}),this.enableImageResizer&&e.push({member:"ImageResizer",args:[this,this.documentHelper]}),this.enableEditorHistory&&e.push({member:"EditorHistory",args:[this]}),this.enableHyperlinkDialog&&e.push({member:"HyperlinkDialog",args:[this.documentHelper]}),this.enableTableDialog&&e.push({member:"TableDialog",args:[this.documentHelper]}),this.enableDateContentDialog&&e.push({member:"DateContentDialog",args:[this.documentHelper]}),this.enablePicContentControlDialog&&e.push({member:"PicContentControlDialog",args:[this.documentHelper]}),this.enableContentControlPropertiesDialog&&e.push({member:"ContentControlPropertiesDialog",args:[this.documentHelper]}),this.enableBookmarkDialog&&e.push({member:"BookmarkDialog",args:[this.documentHelper]}),this.enableTableOfContentsDialog&&e.push({member:"TableOfContentsDialog",args:[this.documentHelper]}),this.enablePageSetupDialog&&e.push({member:"PageSetupDialog",args:[this.documentHelper]}),this.enableColumnsDialog&&e.push({member:"ColumnsDialog",args:[this.documentHelper]}),this.enableFootnoteAndEndnoteDialog&&e.push({member:"FootNotesDialog",args:[this.documentHelper]}),this.enableStyleDialog&&(e.push({member:"StylesDialog",args:[this.documentHelper]}),e.push({member:"StyleDialog",args:[this.documentHelper]}),e.push({member:"BulletsAndNumberingDialog",args:[this.documentHelper]})),this.enableListDialog&&e.push({member:"ListDialog",args:[this.documentHelper]}),this.enableParagraphDialog&&(e.push({member:"ParagraphDialog",args:[this.documentHelper]}),e.push({member:"TabDialog",args:[this.documentHelper]})),this.enableFontDialog&&e.push({member:"FontDialog",args:[this.documentHelper]}),this.enableTablePropertiesDialog&&(e.push({member:"TablePropertiesDialog",args:[this.documentHelper]}),e.push({member:"CellOptionsDialog",args:[this.documentHelper]})),this.enableBordersAndShadingDialog&&e.push({member:"BordersAndShadingDialog",args:[this.documentHelper]}),this.enableTableOptionsDialog&&e.push({member:"TableOptionsDialog",args:[this.documentHelper]}),this.enableSpellCheck&&(e.push({member:"SpellChecker",args:[this.documentHelper]}),e.push({member:"SpellCheckDialog",args:[this.documentHelper]})),this.enableFormField&&(e.push({member:"TextFormFieldDialog",args:[this]}),e.push({member:"DropDownFormFieldDialog",args:[this]}),e.push({member:"CheckBoxFormFieldDialog",args:[this]}))),e},t.prototype.checkModuleInjection=function(e,t){if(!t&&!this.isReadOnly)throw console.warn('[WARNING] :: Module "'+e+'" is not available in Document Editor component! You either misspelled the module name or forgot to load it.'),new Error("Inject "+e+" module")},t.prototype.open=function(e){(0,el.showSpinner)(this.element);try{(0,a.isNullOrUndefined)(e)||this.openInternal(e,!1)}catch(e){this.failureHandler("onError")}},t.prototype.openAsync=function(e){(0,el.showSpinner)(this.element);try{(0,a.isNullOrUndefined)(e)||this.openInternal(e,!0)}catch(e){this.failureHandler("onError")}},t.prototype.openInternal=function(e,t){var i=this,n=this.isValidUrl(e);if(null!==n)this.getSfdtFromUrl(e,n).then((function(t){e=t,i.processSfdt(e)})).catch((function(e){console.error(e)}));else if(this.isValidBase64(e))this.getSfdtFromBase64string(e).then((function(t){e=t,i.processSfdt(e)})).catch((function(e){console.error(e)}));else if(e instanceof File)this.convertToSfdt(e).then((function(t){e=t,i.processSfdt(e)})).catch((function(e){console.error(e)}));else if(e instanceof Blob){var r=e.type.split("/");"sfdt"===r[r.length-1]?this.convertFromSfdtBlob(e).then((function(t){e=t,i.processSfdt(e)})).catch((function(e){console.error(e)})):this.convertFromBlob(e).then((function(t){e=t,i.processSfdt(e)})).catch((function(e){console.error(e)}))}else t?setTimeout((function(){try{i.processSfdt(e)}catch(e){i.failureHandler("onError")}}),50):this.processSfdt(e)},t.prototype.processSfdt=function(e){if(!(0,a.isNullOrUndefined)(this.viewer)&&!(0,a.isNullOrUndefined)(e)){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new La,this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.isSpellCheck&&this.isSpellCheck&&!this.spellCheckerModule.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0),!(0,a.isNullOrUndefined)(e)&&this.viewer){var t={},i=this.parser.convertJsonToDocument(e,t);this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(i,t)}this.isSpellCheck&&this.isSpellCheck&&!this.spellCheckerModule.enableOptimizedSpellCheck&&(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1)}(0,el.hideSpinner)(this.element)},t.prototype.isValidUrl=function(e){try{return new URL(e).pathname.split("/").pop()||null}catch(e){return null}},t.prototype.isValidBase64=function(e){try{var t=atob(e);return btoa(t)===e}catch(e){return!1}},t.prototype.getSfdtFromUrl=function(e,t){return yp(this,void 0,void 0,(function(){var i;return wp(this,(function(n){return i=this,[2,new Promise((function(n,r){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){return yp(this,void 0,void 0,(function(){var e,r,s;return wp(this,(function(a){switch(a.label){case 0:return 200!==o.status?[3,2]:(e=o.response,(r=new FormData).append("file",e,t),[4,i.send(r)]);case 1:s=a.sent(),n(s),a.label=2;case 2:return[2]}}))}))},o.onerror=function(){r(null)},o.send()}))]}))}))},t.prototype.convertToSfdt=function(e){return yp(this,void 0,void 0,(function(){var t;return wp(this,(function(i){switch(i.label){case 0:return(t=new FormData).append("files",e),[4,this.send(t)];case 1:return[2,i.sent()]}}))}))},t.prototype.getSfdtFromBase64string=function(e){return yp(this,void 0,void 0,(function(){var t,i,n,r,o;return wp(this,(function(s){switch(s.label){case 0:for(t=atob(e),i=new Uint8Array(t.length),n=0;n<t.length;n++)i[parseInt(n.toString(),10)]=t.charCodeAt(parseInt(n.toString(),10));return r=new Blob([i],{type:"application/octet-stream"}),(o=new FormData).append("file",r),[4,this.send(o)];case 1:return[2,s.sent()]}}))}))},t.prototype.convertFromBlob=function(e){return yp(this,void 0,void 0,(function(){var t,i;return wp(this,(function(n){switch(n.label){case 0:return t=new FormData,i=""===(i=this.getBlobType(e.type))?e.type:i,t.append("files",e,i),[4,this.send(t)];case 1:return[2,n.sent()]}}))}))},t.prototype.getBlobType=function(e){var t="";switch(e){case"text/html":t=".html";break;case"text/plain":t=".txt";break;case"application/rtf":t=".rtf";break;case"application/xml":t=".xml";break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":t=".dotx";break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t=".docx";break;case"application/msword":t=".doc";break;case"application/vnd.ms-word.document.macroEnabled.12":t=".docm";break;case"application/vnd.ms-word.template.macroenabled.12":t=".dotm";break;case"application/vnd.oasis.opendocument.text":t=".odt"}return t},t.prototype.send=function(e){var t=this,i=this.serviceUrl+this.serverActionSettingsImport;return new Promise((function(n,r){var o=new c;o.url=i,o.onSuccess=function(e){n(e.data)},o.onFailure=t.failureHandler.bind(t),o.onError=t.failureHandler.bind(t),o.customHeaders=t.headers;var s={serverActionType:t.serverActionSettingsImport,headers:t.headers,timeout:0,cancel:!1,withCredentials:!1};t.trigger(_,s),s.cancel?r(null):o.send(e,s)}))},t.prototype.convertFromSfdtBlob=function(e){return new Promise((function(t){var i=new FileReader;i.onload=function(e){var i=e.target.result;t(i)},i.readAsText(e)}))},t.prototype.failureHandler=function(e){(0,el.hideSpinner)(this.element);var t=new a.L10n("documenteditor",this.defaultLocale),i={status:"onError"===e.name?t.getConstant("Error in establishing connection with web server"):t.getConstant("Failed to load the file"),hideOpenFailedPopup:!1};this.trigger($,i),i.hideOpenFailedPopup||("onError"===e.name?el.DialogUtility.alert({content:t.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.enableRtl:"onError"===e&&alert(t.getConstant("Failed to load the file")))},t.prototype.scrollToPage=function(e){return!((0,a.isNullOrUndefined)(this.viewer)||e<1||e>this.documentHelper.pages.length)&&(this.viewer.scrollToPage(e-1),!0)},t.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enableFootnoteAndEndnoteDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableDateContentDialog=this.enablePicContentControlDialog=this.enableContentControlPropertiesDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableSpellCheck=this.enableComment=this.enableFormField=this.enableColumnsDialog=!0,i.Inject(pa,sp,rp,op,Yc,Rc,Pc,Sc,xc,Wh,Mc,Dh,Rh,dp,Mh,Ah,Uh,Gh,_h,Vh,sc,up,mp,gp,Kh,Xh,Zh,Jh,Yh,Qh,$h,Qc,ec,tc,ic,nc,oc,Nc)},t.prototype.resize=function(e,t){this.element&&(!(0,a.isNullOrUndefined)(e)&&e>200&&(this.element.style.width=e+"px"),!(0,a.isNullOrUndefined)(t)&&t>200&&(this.element.style.height=t+"px"),this.viewer&&this.documentHelper.updateViewerSize(),this.trackChangesPane.toolbar&&this.trackChangesPane.toolbar.refreshOverflow(),this.optionsPaneModule&&this.optionsPaneModule.refreshHeadingPaneHeight()),this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!1),this.enableCollaborativeEditing&&this.collaborativeEditingHandlerModule&&this.collaborativeEditingHandlerModule.updateCaretPosition()},t.prototype.triggerResize=function(){var e=this;this&&setTimeout((function(){e&&e.resize()}),10)},t.prototype.getFormFieldNames=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)""!==t[parseInt(i.toString(),10)].formFieldData.name&&e.push(t[parseInt(i.toString(),10)].formFieldData.name);return e},t.prototype.getFormFieldInfo=function(e){for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].formFieldData.name===e&&""!==t[parseInt(i.toString(),10)].formFieldData.name)return t[parseInt(i.toString(),10)].formFieldData.getFormFieldInfo()},t.prototype.setFormFieldInfo=function(e,t){e=Pa.sanitizeString(e);for(var i=this.documentHelper.formFields,n=0;n<i.length;n++)if(i[parseInt(n.toString(),10)].formFieldData.name===e&&""!==i[parseInt(n.toString(),10)].formFieldData.name){var r=i[parseInt(n.toString(),10)];return void(this.selectionModule?(this.selectionModule.selectFieldInternal(r),this.editorModule?this.editorModule.setFormField(r,t):this.checkModuleInjection("Editor",this.enableEditor)):this.checkModuleInjection("Selection",this.enableSelection))}},t.prototype.resetFormFields=function(e){this.editorModule||this.checkModuleInjection("Editor",this.enableEditor),(0,a.isNullOrUndefined)(e)||(e=Pa.sanitizeString(e));for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)((0,a.isNullOrUndefined)(e)||e===t[parseInt(i.toString(),10)].formFieldData.name)&&(t[parseInt(i.toString(),10)].formFieldData instanceof Gl?this.editorModule.updateFormField(t[parseInt(i.toString(),10)],t[parseInt(i.toString(),10)].formFieldData.defaultValue,!0):t[parseInt(i.toString(),10)].formFieldData instanceof Kl?this.editorModule.toggleCheckBoxFormField(t[parseInt(i.toString(),10)],!0,t[parseInt(i.toString(),10)].formFieldData.defaultValue):t[parseInt(i.toString(),10)].formFieldData instanceof Xl&&this.editorModule.updateFormField(t[parseInt(i.toString(),10)],0,!0))},t.prototype.importFormData=function(e){this.editorModule||this.checkModuleInjection("Editor",this.enableEditor);for(var t=this.documentHelper.formFields,i=0;i<e.length;i++)for(var n=e[parseInt(i.toString(),10)],r=n.fieldName,o=0;o<t.length;o++)t[parseInt(o.toString(),10)].formFieldData.name===r&&(t[parseInt(o.toString(),10)].formFieldData instanceof Kl?this.editorModule.toggleCheckBoxFormField(t[parseInt(o.toString(),10)],!0,n.value):(t[parseInt(o.toString(),10)].formFieldData instanceof Gl||t[parseInt(o.toString(),10)].formFieldData instanceof Xl)&&this.editorModule.updateFormField(t[parseInt(o.toString(),10)],n.value))},t.prototype.exportFormData=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)if(""!==t[parseInt(i.toString(),10)].formFieldData.name){var n={fieldName:"",value:""};if(n.fieldName=t[parseInt(i.toString(),10)].formFieldData.name,t[parseInt(i.toString(),10)].formFieldData instanceof Kl)n.value=t[parseInt(i.toString(),10)].formFieldData.checked;else if(t[parseInt(i.toString(),10)].formFieldData instanceof Gl){var r="";r=this.documentHelper.isInlineFormFillProtectedMode?this.editorModule.getFieldResultText(t[parseInt(i.toString(),10)]):t[parseInt(i.toString(),10)].resultText;var o=RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===r.replace(o,"")&&(r=""),n.value=r}else t[parseInt(i.toString(),10)].formFieldData instanceof Xl&&(n.value=t[parseInt(i.toString(),10)].formFieldData.selectedIndex);e.push(n)}return e},t.prototype.importContentControlData=function(e){for(var t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)],n=0;n<this.documentHelper.contentControlCollection.length;n++){var r=this.documentHelper.contentControlCollection[parseInt(n.toString(),10)];i.type===r.contentControlProperties.type&&i.title===r.contentControlProperties.title&&this.editorModule.updateContentControl(r,i.value)}return[]},t.prototype.exportContentControlData=function(){this.selection.contentControleditRegionHighlighters.clear(),this.selection.onHighlightContentControl();for(var e=[],t=0,i=this.documentHelper.contentControlCollection;t<i.length;t++){var n=i[t];if(n instanceof id){var r={title:"",tag:"",value:"",canDelete:!1,canEdit:!1,type:n.contentControlProperties.type};r.title=n.contentControlProperties.title,r.tag=n.contentControlProperties.tag,n.contentControlProperties.lockContentControl&&(r.canDelete=!0),n.contentControlProperties.lockContents&&(r.canEdit=!0);var o=n.nextElement;"Picture"===n.contentControlProperties.type?o instanceof gd&&(r.value=this.documentHelper.getImageString(o)):"CheckBox"===n.contentControlProperties.type?r.value=String(n.contentControlProperties.isChecked):"Date"===n.contentControlProperties.type?r.value=o.text:"ComboBox"===n.contentControlProperties.type||"DropDownList"===n.contentControlProperties.type?r.value=this.getContentControlValue(o):r.value=this.getContentControlValueForText(n),e.push(r)}}return e},t.prototype.resetContentControlData=function(e){for(var t=0;t<e.length;t++)for(var i=e[parseInt(t.toString(),10)],n=0;n<this.documentHelper.contentControlCollection.length;n++){var r=this.documentHelper.contentControlCollection[parseInt(n.toString(),10)];i.title===r.contentControlProperties.title&&this.editorModule.updateContentControl(r,i.value,!0)}},t.prototype.getContentControlValue=function(e){for(var t="";e&&!(e instanceof id);)e instanceof Zl&&(t+=e.text),e=e.nextElement;return t},t.prototype.getContentControlValueForText=function(e){var t="",i=e.line.children.indexOf(e)+1,n=!1;if(this.selection.contentControleditRegionHighlighters.containsKey(e))for(var r=this.selection.contentControleditRegionHighlighters.get(e),o=0;o<r.keys.length;o++){var s=r.keys[parseInt(o.toString(),10)];o>0&&s.paragraph!==r.keys[o-1].paragraph&&(t+="/n");for(var a=i;a<s.children.length;a++){i=0;var l=s.children[parseInt(a.toString(),10)];if(l instanceof Zl&&(t+=l.text),l instanceof id){n=!0;break}}if(n)break}return t},t.prototype.updateFields=function(){this.selectionModule||this.checkModuleInjection("Selection",this.enableSelection);for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[parseInt(e.toString(),10)];if(0===this.selectionModule.getFieldCode(t).toLowerCase().trim().indexOf("ref ")){var i=t.line.paragraph;(0,a.isNullOrUndefined)(i)||(0,a.isNullOrUndefined)(this.selectionModule)||(0,a.isNullOrUndefined)(this.selectionModule.getPage(i))||this.selectionModule.updateRefField(t)}}},t.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},t.prototype.fitPage=function(e){(0,a.isNullOrUndefined)(e)&&(e="None"),this.viewer&&(this.viewer.pageFitType=e)},t.prototype.exportAsImage=function(e,t){if((0,a.isNullOrUndefined)(this.viewer))throw new Error("Invalid operation.");if(this.printModule){var i="Png"===t?"image/png":"image/jpeg";return this.printModule.exportAsImage(this.documentHelper,e,i)}this.checkModuleInjection("Print",this.enablePrint)},t.prototype.exportAsPath=function(e){if(!(0,a.isNullOrUndefined)(e)&&e<=this.documentHelper.pages.length&&e>=1){var t=this.documentHelper.pages[e-1];this.documentHelper.render.isExporting=!0,this.documentHelper.render.renderWidgets(t,0,0,0,0);var i=this.documentHelper.render.pageCanvas.toDataURL();return this.documentHelper.render.pageCanvas.getContext("2d").renderedPath="",this.documentHelper.render.isExporting=!1,i}},t.prototype.print=function(e){if((0,a.isNullOrUndefined)(this.viewer))throw new Error("Invalid operation.");this.printModule?"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new kl(this),this.editorModule.layoutWholeDocument(),this.printModule.print(this.documentHelper,e),this.viewer=new Fl(this),this.editorModule.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,e):this.checkModuleInjection("Print",this.enablePrint)},t.prototype.serialize=function(){var e="";return this.enableSfdtExport&&this.sfdtExportModule instanceof sp?e=this.sfdtExportModule.serialize():this.checkModuleInjection("SfdtExport",this.enableSfdtExport),e},t.prototype.save=function(e,t){var i=this;if((0,a.isNullOrUndefined)(e)||(e=Pa.sanitizeString(e)),e=e||"Untitled",(0,a.isNullOrUndefined)(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===t||"Dotx"===t)this.wordExportModule?this.wordExportModule.save(this.documentHelper,e,t):this.checkModuleInjection("WordExport",this.enableWordExport);else if("Txt"===t)this.textExportModule?this.textExportModule.save(this.documentHelper,e):this.checkModuleInjection("TextExport",this.enableTextExport);else{if("Sfdt"!==t)throw new Error("Invalid operation. Specified export is not enabled.");if(this.sfdtExportModule)if(this.documentEditorSettings.optimizeSfdt){var n=this.serialize(),r=new Blob([n],{type:"application/json"}),o=new Fa.ZipArchiveItem(r,"sfdt"),s=new Fa.ZipArchive;s.addItem(o),s.saveAsBlob().then((function(t){i.zipArchiveBlobToSfdtFile(t,e)}))}else{n=this.serialize(),r=new Blob([n],{type:"application/json"});np.Save.save(e+".sfdt",r)}else this.checkModuleInjection("SfdtExport",this.enableSfdtExport)}},t.prototype.zipArchiveBlobToSfdtFile=function(e,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){var e=i.result.split(",")[1],n={};n.sfdt=e;var r=new Blob([JSON.stringify(n)],{type:"application/json"});np.Save.save(t+".sfdt",r)}},t.prototype.saveAsBlob=function(e){var t=this;if((0,a.isNullOrUndefined)(this.viewer))throw new Error("Invalid operation");return new Promise((function(i){"Docx"===e||"Dotx"===e?t.wordExportModule?i(t.wordExportModule.saveAsBlob(t.documentHelper,e)):t.checkModuleInjection("WordExport",t.enableWordExport):"Txt"===e?t.textExportModule?i(t.textExportModule.saveAsBlob(t.documentHelper)):t.checkModuleInjection("TextExport",t.enableTextExport):"Sfdt"===e&&(t.sfdtExportModule?t.documentEditorSettings.optimizeSfdt?t.sfdtExportModule.saveAsBlob(t.documentHelper).then((function(e){t.getBase64StringFromBlob(e).then((function(e){var t={};t.sfdt=e;var n=new Blob([JSON.stringify(t)],{type:"application/json"});i(n)}))})):i(t.sfdtExportModule.saveAsBlobNonOptimized(t.documentHelper)):t.checkModuleInjection("SfdtExport",t.enableSfdtExport))}))},t.prototype.getBase64StringFromBlob=function(e){return new Promise((function(t,i){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){var e=n.result.split(",")[1];t(e)}}))},t.prototype.openBlank=function(){var e=[];e.push(this.createNewBodyWidget());var t=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0);if(this.viewer){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.clearSpellCheck(),this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(t),this.editorModule){this.editorModule.intializeDefaultStyles();for(var i=this.documentHelper.styles.findByName("Normal"),n=0;n<e.length;n++){var r=e[parseInt(n.toString(),10)].childWidgets[0];r.paragraphFormat.baseStyle=i,r.paragraphFormat.listFormat.baseStyle=i}}this.documentHelper.onDocumentChanged(e)}},t.prototype.getStyleNames=function(e){return this.viewer?this.documentHelper.styles.getStyleNames(e):[]},t.prototype.getStyles=function(e){return this.viewer?this.documentHelper.styles.getStyles(e):[]},t.prototype.getBookmarks=function(){var e=[];return this.viewer&&(e=this.documentHelper.getBookmarks(!0)),e},t.prototype.showDialog=function(e){switch(e){case"Hyperlink":this.showHyperlinkDialog();break;case"Table":this.showTableDialog();break;case"Bookmark":this.showBookmarkDialog();break;case"TableOfContents":this.showTableOfContentsDialog();break;case"PageSetup":this.showPageSetupDialog();break;case"Columns":this.showColumnsDialog();break;case"List":this.showListDialog();break;case"Styles":this.showStylesDialog();break;case"Style":this.showStyleDialog();break;case"Paragraph":this.showParagraphDialog();break;case"Font":this.showFontDialog();break;case"TableProperties":this.showTablePropertiesDialog();break;case"BordersAndShading":this.showBordersAndShadingDialog();break;case"TableOptions":this.showTableOptionsDialog();break;case"SpellCheck":this.showSpellCheckDialog();break;case"DatepickerContentControl":this.showDateContentDialog();break;case"PictureContentControl":this.showPicContentControlDialog();break;case"ContentControlProperties":this.showContentPropertiesDialog()}},t.prototype.toggleShowHiddenMarksInternal=function(){this.documentEditorSettings.showHiddenMarks=!this.documentEditorSettings.showHiddenMarks,this.notify(G,this.documentEditorSettings)},t.prototype.showOptionsPane=function(){(0,a.isNullOrUndefined)(this.optionsPaneModule)||(0,a.isNullOrUndefined)(this.viewer)?this.checkModuleInjection("OptionsPane",this.enableOptionsPane):this.optionsPaneModule.showHideOptionsPane(!0)},t.prototype.showXmlPane=function(){!(0,a.isNullOrUndefined)(this.xmlPaneModule)&&(0,a.isNullOrUndefined)(this.xmlPaneModule.element)?this.xmlPaneModule.showXmlProperties(!0):this.checkModuleInjection("XmlPane",this.enableXMLPane)},t.prototype.showRestrictEditingPane=function(e){e=!!(0,a.isNullOrUndefined)(e)||e,this.documentHelper&&this.documentHelper.restrictEditingPane&&this.documentHelper.restrictEditingPane.showHideRestrictPane(e)},t.prototype.showSpellCheckDialog=function(){if(this.spellCheckDialogModule&&this.spellCheckerModule){var e=this.spellCheckerModule.retriveText();(0,a.isNullOrUndefined)(e)||this.spellCheckDialogModule.show(e.text,e.element)}else this.checkModuleInjection("SpellCheck",this.enableSpellCheck)},t.prototype.showTabDialog=function(){this.tabDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tabDialogModule.show()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.destroyDependentModules(),(0,a.isNullOrUndefined)(this.documentHelper)||this.documentHelper.destroy(),this.viewer&&this.viewer.componentDestroy(),this.viewer=void 0,(0,a.isNullOrUndefined)(this.element)||(this.element.classList.remove("e-documenteditor"),this.element.innerHTML=""),this.refreshing||(this.element=void 0,this.rulerHelper.destroy()),this.parser&&(this.parser.destroy(),this.parser=void 0),this.revisionsInternal&&(this.revisionsInternal.destroy(),this.revisionsInternal=void 0),this.findResultsList=[],this.findResultsList=void 0,this.documentHelper=void 0},t.prototype.updateStyle=function(e,t){if(!(0,a.isNullOrUndefined)(this.styleDialogModule)){var i="Paragraph"===t.type?(0,a.isNullOrUndefined)(t.link)?"Paragraph":"Linked Style":"Character";if(e.type=this.styleDialogModule.getTypeValue(i),e.basedOn=t.basedOn,"Paragraph"===i||"Linked Style"===i){e.next=t.next,e.characterFormat.destroy(),e.characterFormat.copyFormat(t.characterFormat);var n=e.paragraphFormat.listFormat.listId;if(e.paragraphFormat.destroy(),e.paragraphFormat.copyFormat(t.paragraphFormat),e.link=t.link,!(0,a.isNullOrUndefined)(n)&&n>-1){var r=this.documentHelper.getListById(n);(0,a.isNullOrUndefined)(r)||this.documentHelper.lists.splice(this.documentHelper.lists.indexOf(r),1)}}else"Character"===i&&(e.characterFormat.destroy(),e.characterFormat.copyFormat(t.characterFormat));e.name=t.name}},t.prototype.createNewBodyWidget=function(){var e=new Ol;e.index=0,e.sectionFormat=new ga(e),this.sectionFormat&&this.parser.parseSectionFormat(0,this.sectionFormat,e.sectionFormat);var t=new Rl;return t.index=0,t.paragraphFormat=new ba(t),t.characterFormat=new ka(t),e.childWidgets.push(t),t.containerWidget=e,e},t.prototype.clearSpellCheck=function(){(0,a.isNullOrUndefined)(this.spellCheckerModule)||((0,a.isNullOrUndefined)(this.spellCheckerModule.errorWordCollection)||this.spellCheckerModule.errorWordCollection.clear(),(0,a.isNullOrUndefined)(this.spellCheckerModule.uniqueWordsCollection)||this.spellCheckerModule.uniqueWordsCollection.clear())},t.prototype.setStyleData=function(e,t){if(this.enableCollaborativeEditing){var i;if(this.isSettingOp=!0,!(0,a.isNullOrUndefined)(e)&&!(0,a.isNullOrUndefined)(this.documentHelper.owner.sfdtExportModule)){var n=this.documentHelper.styles.findByName(e);if(!(0,a.isNullOrUndefined)(n)){var r=this.getStyleObject(n,t);!(0,a.isNullOrUndefined)(n)&&this.enableCollaborativeEditing&&(i={action:"Update",styleData:JSON.stringify(r)},this.documentSettingOps.push(i))}}this.fireContentChange()}},t.prototype.setCustomFonts=function(e){var t,i=this;if(this.externalFonts=[],"string"==typeof e)try{t=JSON.parse(e)}catch(e){return void console.error("Failed to parse JSON string:",e)}else{if(!Array.isArray(e))return void console.error("Invalid input type");t=e}t.forEach((function(e){i.externalFonts.push({fontFamily:e.fontFamily,src:e.src})})),this.updateExternalStyle()},t.prototype.getStyleObject=function(e,t){if(!(0,a.isNullOrUndefined)(e)){var i=this.documentHelper.owner.sfdtExportModule.keywordIndex;this.documentHelper.owner.sfdtExportModule.keywordIndex=1;var n={optimizeSfdt:!0,sty:[this.documentHelper.owner.sfdtExportModule.writeStyle(e)]};if(this.editorModule.isLinkedStyle(e.name)){var r=this.documentHelper.styles.findByName(e.name+" Char"),o=this.documentHelper.owner.sfdtExportModule.writeStyle(r);n.sty.push(o)}if(!(0,a.isNullOrUndefined)(t)&&t>-1){var s=this.documentHelper.getListById(t);n[re[1]]=[],n[re[1]].push(this.sfdtExportModule.writeList(s)),n[oe[1]]=[],n[oe[1]].push(this.sfdtExportModule.writeAbstractList(s.abstractList))}return this.documentHelper.owner.sfdtExportModule.keywordIndex=i,n}},t.prototype.getSettingData=function(e,t,i,n,r){var o;this.enableCollaborativeEditing&&!this.editorModule.isRemoteAction&&(this.isSettingOp=!0,o="protection"===e?{text:e,protectionData:{saltValue:n,hashValue:i,protectionType:r}}:{text:e,enableTrackChanges:t},this.skipSettingsOps||(this.documentSettingOps.push(o),this.fireContentChange()),this.skipSettingsOps=!1,this.isSettingOp=!1)},t.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule.destroy(),this.optionsPaneModule=void 0),this.xmlPaneModule&&(this.xmlPaneModule.destroy(),this.xmlPaneModule=void 0),this.commentReviewPane&&(this.commentReviewPane.destroy(),this.commentReviewPane=void 0),this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0),(0,a.isNullOrUndefined)(this.hyperlinkDialogModule)||(this.hyperlinkDialogModule.destroy(),this.hyperlinkDialogModule=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.contextMenuModule&&(this.contextMenuModule.componentDestroy(),this.contextMenuModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),(0,a.isNullOrUndefined)(this.paragraphDialogModule)||(this.paragraphDialogModule.destroy(),this.paragraphDialogModule=void 0),this.tabDialogModule&&(this.tabDialogModule.destroy(),this.tabDialogModule=void 0),this.pageSetupDialogModule&&(this.pageSetupDialogModule.destroy(),this.pageSetupDialogModule=void 0),this.columnsDialogModule&&(this.columnsDialogModule.destroy(),this.columnsDialogModule=void 0),this.footNotesDialogModule&&(this.footNotesDialogModule.destroy(),this.footNotesDialogModule=void 0),this.fontDialogModule&&(this.fontDialogModule.destroy(),this.fontDialogModule=void 0),this.listDialogModule&&(this.listDialogModule.destroy(),this.listDialogModule=void 0),this.imageResizerModule&&(this.imageResizerModule.destroy(),this.imageResizerModule=void 0),this.tablePropertiesDialogModule&&(this.tablePropertiesDialogModule.destroy(),this.tablePropertiesDialogModule=void 0),this.contentControlPropertiesDialogModule&&(this.contentControlPropertiesDialogModule.destroy(),this.contentControlPropertiesDialogModule=void 0),this.picContentControlDialogModule&&(this.picContentControlDialogModule.destroy(),this.picContentControlDialogModule=void 0),this.bordersAndShadingDialogModule&&(this.bordersAndShadingDialogModule.destroy(),this.bordersAndShadingDialogModule=void 0),this.cellOptionsDialogModule&&(this.cellOptionsDialogModule.destroy(),this.cellOptionsDialogModule=void 0),this.tableOptionsDialogModule&&(this.tableOptionsDialogModule.destroy(),this.tableOptionsDialogModule=void 0),this.tableDialogModule&&(this.tableDialogModule.destroy(),this.tableDialogModule=void 0),this.bookmarkDialogModule&&(this.bookmarkDialogModule.destroy(),this.bookmarkDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule.destroy(),this.styleDialogModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.tableOfContentsDialogModule&&(this.tableOfContentsDialogModule.destroy(),this.tableOfContentsDialogModule=void 0),this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0),this.checkBoxFormFieldDialogModule&&(this.checkBoxFormFieldDialogModule.destroy(),this.checkBoxFormFieldDialogModule=void 0),this.dropDownFormFieldDialogModule&&(this.dropDownFormFieldDialogModule.destroy(),this.dropDownFormFieldDialogModule=void 0),this.textFormFieldDialogModule&&(this.textFormFieldDialogModule.destroy(),this.textFormFieldDialogModule=void 0),this.spellCheckDialogModule&&(this.spellCheckDialogModule.destroy(),this.spellCheckDialogModule=void 0),this.stylesDialogModule&&(this.stylesDialogModule.destroy(),this.stylesDialogModule=void 0),this.optimizedModule&&(this.optimizedModule.destroy(),this.optimizedModule=void 0),this.regularModule&&(this.regularModule.destroy(),this.regularModule=void 0),this.hRuler&&(this.hRuler.destroy(),this.hRuler=void 0),this.vRuler&&(this.vRuler.destroy(),this.vRuler=void 0),this.rulerContainer&&(this.rulerContainer.remove(),this.rulerContainer=null)},vp([(0,a.Property)(!1)],t.prototype,"enableCollaborativeEditing",void 0),vp([(0,a.Property)("KeepSourceFormatting")],t.prototype,"defaultPasteOption",void 0),vp([(0,a.Property)("Pages")],t.prototype,"layoutType",void 0),vp([(0,a.Property)("")],t.prototype,"currentUser",void 0),vp([(0,a.Property)("#FFFF00")],t.prototype,"userColor",void 0),vp([(0,a.Property)(20)],t.prototype,"pageGap",void 0),vp([(0,a.Property)("")],t.prototype,"documentName",void 0),vp([(0,a.Property)("100%")],t.prototype,"width",void 0),vp([(0,a.Property)("200px")],t.prototype,"height",void 0),vp([(0,a.Property)("")],t.prototype,"serviceUrl",void 0),vp([(0,a.Property)(1)],t.prototype,"zoomFactor",void 0),vp([(0,a.Property)(2e3)],t.prototype,"zIndex",void 0),vp([(0,a.Property)(!0)],t.prototype,"isReadOnly",void 0),vp([(0,a.Property)(!1)],t.prototype,"enablePrint",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableSelection",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableEditor",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableEditorHistory",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableSfdtExport",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableWordExport",void 0),vp([(0,a.Property)(!0)],t.prototype,"enableAutoFocus",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableTextExport",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableOptionsPane",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableContextMenu",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableHyperlinkDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableBookmarkDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableTableOfContentsDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableSearch",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableParagraphDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableListDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableTablePropertiesDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableBordersAndShadingDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableFootnoteAndEndnoteDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableColumnsDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enablePageSetupDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableStyleDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableFontDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableTableOptionsDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableTableDialog",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableImageResizer",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableSpellCheck",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableComment",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableTrackChanges",void 0),vp([(0,a.Property)(!0)],t.prototype,"enableFormField",void 0),vp([(0,a.Property)(!1)],t.prototype,"acceptTab",void 0),vp([(0,a.Property)(!0)],t.prototype,"useCtrlClickToFollowHyperlink",void 0),vp([(0,a.Property)("#000000")],t.prototype,"pageOutline",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableCursorOnReadOnly",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableLocalPaste",void 0),vp([(0,a.Property)(!1)],t.prototype,"enableLockAndEdit",void 0),vp([(0,a.Complex)({},bp)],t.prototype,"documentEditorSettings",void 0),vp([(0,a.Complex)({},Cp)],t.prototype,"documentSettings",void 0),vp([(0,a.Property)({systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",spellCheckByPage:"SpellCheckByPage",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],t.prototype,"serverActionSettings",void 0),vp([(0,a.Property)([])],t.prototype,"headers",void 0),vp([(0,a.Property)(!1)],t.prototype,"showComments",void 0),vp([(0,a.Property)(!1)],t.prototype,"showRevisions",void 0),vp([(0,a.Property)(!1)],t.prototype,"autoResizeOnVisibilityChange",void 0),vp([(0,a.Event)()],t.prototype,"documentChange",void 0),vp([(0,a.Event)()],t.prototype,"viewChange",void 0),vp([(0,a.Event)()],t.prototype,"zoomFactorChange",void 0),vp([(0,a.Event)()],t.prototype,"selectionChange",void 0),vp([(0,a.Event)()],t.prototype,"requestNavigate",void 0),vp([(0,a.Event)()],t.prototype,"contentChange",void 0),vp([(0,a.Event)()],t.prototype,"keyDown",void 0),vp([(0,a.Event)()],t.prototype,"searchResultsChange",void 0),vp([(0,a.Event)()],t.prototype,"created",void 0),vp([(0,a.Event)()],t.prototype,"destroyed",void 0),vp([(0,a.Event)()],t.prototype,"customContextMenuSelect",void 0),vp([(0,a.Event)()],t.prototype,"customContextMenuBeforeOpen",void 0),vp([(0,a.Event)()],t.prototype,"beforePaneSwitch",void 0),vp([(0,a.Event)()],t.prototype,"commentBegin",void 0),vp([(0,a.Event)()],t.prototype,"commentEnd",void 0),vp([(0,a.Event)()],t.prototype,"beforeFileOpen",void 0),vp([(0,a.Event)()],t.prototype,"commentDelete",void 0),vp([(0,a.Event)()],t.prototype,"beforeAcceptRejectChanges",void 0),vp([(0,a.Event)()],t.prototype,"beforeCommentAction",void 0),vp([(0,a.Event)()],t.prototype,"trackChange",void 0),vp([(0,a.Event)()],t.prototype,"beforeFormFieldFill",void 0),vp([(0,a.Event)()],t.prototype,"serviceFailure",void 0),vp([(0,a.Event)()],t.prototype,"afterFormFieldFill",void 0),vp([(0,a.Event)()],t.prototype,"actionComplete",void 0),vp([(0,a.Event)()],t.prototype,"contentControl",void 0),vp([(0,a.Event)()],t.prototype,"beforeXmlHttpRequestSend",void 0),vp([(0,a.Event)()],t.prototype,"documentLoadFailed",void 0),t=i=vp([a.NotifyPropertyChanges],t)}(a.Component),kp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)("SystemClipboard")],t.prototype,"systemClipboard",void 0),vp([(0,a.Property)("SpellCheck")],t.prototype,"spellCheck",void 0),vp([(0,a.Property)("SpellCheckByPage")],t.prototype,"spellCheckByPage",void 0),vp([(0,a.Property)("RestrictEditing")],t.prototype,"restrictEditing",void 0),vp([(0,a.Property)("CanLock")],t.prototype,"canLock",void 0),vp([(0,a.Property)("GetPendingActions")],t.prototype,"getPendingActions",void 0),t}(a.ChildProperty),Fp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)("#cfcfcf")],t.prototype,"shadingColor",void 0),vp([(0,a.Property)(!0)],t.prototype,"applyShading",void 0),vp([(0,a.Property)("#cccccc")],t.prototype,"selectionColor",void 0),vp([(0,a.Property)("Popup")],t.prototype,"formFillingMode",void 0),vp([(0,a.Property)([])],t.prototype,"formattingExceptions",void 0),t}(a.ChildProperty),Pp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)("")],t.prototype,"roomName",void 0),vp([(0,a.Property)("#22b24b")],t.prototype,"editableRegionColor",void 0),vp([(0,a.Property)("#f44336")],t.prototype,"lockedRegionColor",void 0),vp([(0,a.Property)(3e3)],t.prototype,"saveTimeout",void 0),t}(a.ChildProperty),Sp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fp(t,e),vp([(0,a.Property)("Import")],t.prototype,"import",void 0),t}(kp),Tp="_toolbar",Hp="_new",Ep="_open",Np="_undo",Wp="_redo",Op="_image",Bp="_image_local",Lp="_table",Dp="_link",Rp="_bookmark",Mp="_comment",Ap="_track",Up="_toc",Vp="_header",zp="_footer",qp="_page_setup",_p="_page_number",jp="_break",Gp="_listView",Kp="_find",Xp="_use_local_clipboard",Zp="_restrict_edit",Jp="_page_break",Yp="_section_break",Qp="_section_break_continuous",$p="_column_break",eu="_read_only",tu="_protections",iu="_form_fields",nu="_update_fields",ru="_text_form",ou="_checkbox",su="_dropdown",au="_footnote",lu="_endnote",du="_columns",hu="_page_set",cu="_content_control",pu="_richtext_content_control",uu="_plaintext_content_control",gu="_combobox_content_control",mu="_dropdown_content_control",fu="_datepicker_content_control",vu="_checkbox_content_control",yu="_picture_content_control",wu="_xmlmapping",bu=function(){function e(e){this.isCommentEditing=!1,this.container=e,this.importHandler=new c}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"toolbar"},e.prototype.enableItems=function(e,t){this.toolbar.enableItems(e,t)},e.prototype.initToolBar=function(e){this.toolbarItems=e,this.renderToolBar(),this.wireEvent()},e.prototype.renderToolBar=function(){if(!(0,a.isNullOrUndefined)(this.container)){var e=this.container.toolbarContainer,t=(0,a.createElement)("div",{className:"e-de-tlbr-wrapper"}),i=(0,a.createElement)("div",{className:"e-de-toolbar"});this.initToolbarItems(),t.appendChild(i),e.appendChild(t);var n=this.container.localObj,r=(0,a.createElement)("div",{className:"e-de-ctnr-properties-pane-btn"});this.buttonElement=(0,a.createElement)("button",{attrs:{type:"button","aria-label":n.getConstant("Hide properties pane"),"aria-pressed":"true"}}),r.appendChild(this.buttonElement);var o="e-tbar-btn e-tbtn-txt e-control e-btn e-de-showhide-btn",s="e-icons e-de-ctnr-showhide";this.container.enableRtl&&(o+="-rtl",s="e-icons e-de-ctnr-showhide e-de-flip"),this.propertiesPaneButton=new tl.Button({cssClass:o,iconCss:s}),this.container.showPropertiesPane?this.buttonElement.title=n.getConstant("Hide properties pane"):(this.buttonElement.title=n.getConstant("Show properties pane"),(0,a.classList)(r,this.container.restrictEditing?["e-de-overlay"]:[],this.container.restrictEditing?[]:["e-de-overlay"]),r.classList.add("e-de-pane-disable-clr")),this.propertiesPaneButton.appendTo(this.buttonElement),a.EventHandler.add(this.buttonElement,"click",this.showHidePropertiesPane,this),e.appendChild(r),this.toolbar.appendTo(i),this.initToolbarDropdown(i)}},e.prototype.initToolbarDropdown=function(e){var t=this;if(this.container){var i=this.container.localObj,n=this.container.element.id+Tp;if(this.toolbarItems.indexOf("Image")>=0&&(this.imgDropDwn=new pl.DropDownButton({items:[{text:i.getConstant("Upload from computer"),iconCss:"e-icons e-de-ctnr-upload",id:n+Bp}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.imgDropDwn.appendTo("#"+n+Op)),this.toolbarItems.indexOf("PageSetup")>=0&&(this.PageSetUpDropDwn=new pl.DropDownButton({items:[{text:i.getConstant("Page Setup"),iconCss:"e-icons e-de-ctnr-page-size",id:n+hu},{text:i.getConstant("Columns"),iconCss:"e-icons e-de-ctnr-columns",id:n+du}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.PageSetUpDropDwn.appendTo("#"+n+qp)),this.toolbarItems.indexOf("ContentControl")>=0&&(this.ContentControlDropDwn=new pl.DropDownButton({items:[{text:i.getConstant("Rich Text Content Control"),iconCss:"e-icons e-de-ctnr-change-case",id:n+pu},{text:i.getConstant("Plain Text Content Control"),iconCss:"e-icons e-de-ctnr-change-case",id:n+uu},{text:i.getConstant("Picture Content Control"),iconCss:"e-icons e-de-ctnr-image",id:n+yu},{text:i.getConstant("Combo Box Content Control"),iconCss:"e-icons e-de-combo-box",id:n+gu},{text:i.getConstant("Drop-Down List Content Control"),iconCss:"e-icons e-de-dropdown-list",id:n+mu},{text:i.getConstant("Date Picker Content Control"),iconCss:"e-icons e-timeline-today",id:n+fu},{text:i.getConstant("Check Box Content Control"),iconCss:"e-icons e-check-box",id:n+vu}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.ContentControlDropDwn.appendTo("#"+n+cu)),this.toolbarItems.indexOf("Break")>=0){var r=[{text:i.getConstant("Page"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-page-break",id:Jp,category:i.getConstant("Page Breaks")},{text:i.getConstant("Column"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-page-break-column",id:$p,category:i.getConstant("Page Breaks")},{text:i.getConstant("Next Page"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-section-break",id:Yp,category:i.getConstant("Section Breaks")},{text:i.getConstant("Continuous"),iconCss:"e-de-listview e-de-listview-icon e-icons e-de-ctnr-section-break-continuous",id:Qp,category:i.getConstant("Section Breaks")}],o={target:"#"+n+jp+Gp,cssClass:"e-caret-hide"};this.breakDropDwn=new pl.DropDownButton(o,"#"+n+jp),this.breakListView=new il.ListView({dataSource:r,width:"170px",fields:{iconCss:"iconCss",groupBy:"category"},showIcon:!0,select:this.onListViewSelection.bind(this)}),this.breakListView.appendTo("#"+n+jp+Gp)}if(this.filePicker=(0,a.createElement)("input",{attrs:{type:"file",accept:".doc,.docx,.rtf,.txt,.htm,.html,.sfdt"},className:"e-de-ctnr-file-picker"}),a.Browser.isIE&&document.body.appendChild(this.filePicker),this.imagePicker=(0,a.createElement)("input",{attrs:{type:"file",accept:".jpg,.jpeg,.png,.bmp,.svg"},className:"e-de-ctnr-file-picker"}),a.Browser.isIE&&document.body.appendChild(this.imagePicker),this.toolbarItems.indexOf("LocalClipboard")>=0&&this.toggleButton(n+Xp,this.container.enableLocalPaste),this.toolbarItems.indexOf("TrackChanges")>=0&&this.toggleButton(n+Ap,this.container.enableTrackChanges),this.toolbarItems.indexOf("RestrictEditing")>=0){this.toggleButton(n+Zp,this.container.restrictEditing);var s="";this.container.restrictEditing&&(s=" e-de-selected-item"),this.restrictDropDwn=new pl.DropDownButton({items:[{text:i.getConstant("Read only"),id:n+eu,iconCss:"e-icons"+s},{text:i.getConstant("Protections"),id:n+tu,iconCss:"e-icons"}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this),beforeItemRender:function(e){t.onBeforeRenderRestrictDropdown(e,n)}}),this.restrictDropDwn.appendTo("#"+n+Zp)}this.toolbarItems.indexOf("FormFields")>=0&&(this.formFieldDropDown=new pl.DropDownButton({items:[{text:i.getConstant("Text Form"),iconCss:"e-icons e-de-textform",id:n+ru},{text:i.getConstant("Check Box"),iconCss:"e-icons e-de-checkbox-form",id:n+ou},{text:i.getConstant("DropDown"),iconCss:"e-icons e-de-dropdownform",id:n+su}],cssClass:"e-de-toolbar-btn-first e-caret-hide",select:this.onDropDownButtonSelect.bind(this)}),this.formFieldDropDown.appendTo("#"+n+iu))}},e.prototype.onListViewSelection=function(e){var t=this.container.element.id+Tp,i=e.item.id;i===t+jp+Gp+"_"+Jp?this.container.documentEditor.editorModule.insertPageBreak():i===t+jp+Gp+"_"+Yp?this.container.documentEditor.editorModule.insertSectionBreak():i===t+jp+Gp+"_"+Qp?this.container.documentEditor.editorModule.insertSectionBreak(n.Continuous):i===t+jp+Gp+"_"+$p&&this.container.documentEditor.editorModule.insertColumnBreak(),e.item.classList.remove("e-active")},e.prototype.onBeforeRenderRestrictDropdown=function(e,t){var i=e.element.getElementsByClassName("e-menu-icon")[0];if(!(0,a.isNullOrUndefined)(i)&&(e.item.id===t+eu&&this.toggleRestrictIcon(i,this.container.restrictEditing),e.item.id===t+tu)){var n=document.getElementsByClassName("e-de-restrict-pane")[0];if(!(0,a.isNullOrUndefined)(n)){var r=!("none"===n.style.display);this.toggleRestrictIcon(i,r)}}},e.prototype.toggleRestrictIcon=function(e,t){t?e.classList.add("e-de-selected-item"):e.classList.remove("e-de-selected-item")},e.prototype.showHidePropertiesPane=function(){var e=document.getElementsByClassName("e-de-ctnr-properties-pane-btn")[0],t=this.container.localObj;"none"===this.container.propertiesPaneContainer.style.display?(this.container.showPropertiesPane=!0,e.classList.remove("e-de-pane-disable-clr"),this.buttonElement.title=t.getConstant("Hide properties pane"),this.buttonElement.setAttribute("aria-label",t.getConstant("Hide properties pane")),this.buttonElement.setAttribute("aria-pressed","true"),(0,a.classList)(e,["e-de-pane-enable-clr"],[]),this.container.trigger(L,{type:"PropertiesPane"})):this.container.previousContext.indexOf("Header")>=0||this.container.previousContext.indexOf("Footer")>=0?this.container.showHeaderProperties=!this.container.showHeaderProperties:(this.container.showPropertiesPane=!1,e.classList.remove("e-de-pane-enable-clr"),this.buttonElement.title=t.getConstant("Show properties pane"),this.buttonElement.setAttribute("aria-label",t.getConstant("Show properties pane")),this.buttonElement.setAttribute("aria-pressed","false"),(0,a.classList)(e,["e-de-pane-disable-clr"],[])),this.enableDisablePropertyPaneButton(this.container.showPropertiesPane),this.container.showPropertiesPaneOnSelection(),this.documentEditor.focusIn()},e.prototype.onWrapText=function(e){var t="",i=e.lastIndexOf(" ");return-1!==i?(t=e.slice(0,i),e.slice(i),t+='<div class="e-de-text-wrap">'+e.slice(i)+"</div>"):t=e,t},e.prototype.wireEvent=function(){this.propertiesPaneButton.on("click",this.togglePropertiesPane.bind(this)),a.EventHandler.add(this.filePicker,"change",this.onFileChange,this),a.EventHandler.add(this.imagePicker,"change",this.onImageChange,this)},e.prototype.initToolbarItems=function(){this.toolbar=new ua.Toolbar({enableRtl:this.container.enableRtl,clicked:this.clickHandler.bind(this),items:this.getToolbarItems()})},e.prototype.reInitToolbarItems=function(e){for(var t=this,i=0;i<e.length;i++)switch(e[parseInt(i.toString(),10)]){case"RestrictEditing":(0,a.isNullOrUndefined)(this.restrictDropDwn)||this.restrictDropDwn.destroy();break;case"Break":(0,a.isNullOrUndefined)(this.breakDropDwn)||this.breakDropDwn.destroy();break;case"PageSetup":(0,a.isNullOrUndefined)(this.PageSetUpDropDwn)||this.PageSetUpDropDwn.destroy();break;case"Image":(0,a.isNullOrUndefined)(this.imgDropDwn)||this.imgDropDwn.destroy();break;case"FormFields":(0,a.isNullOrUndefined)(this.formFieldDropDown)||this.formFieldDropDown.destroy()}this.toolbarItems=e;var n=this.container.toolbarContainer;this.toolbar.items=this.getToolbarItems(),this.toolbarTimer=Number(setTimeout((function(){t.toolbarTimer&&clearTimeout(t.toolbarTimer),t.initToolbarDropdown(n),e.indexOf("Open")>=0&&a.EventHandler.add(t.filePicker,"change",t.onFileChange,t),e.indexOf("Image")>=0&&a.EventHandler.add(t.imagePicker,"change",t.onImageChange,t)}),200))},e.prototype.getToolbarItems=function(){for(var e,t=this.container.localObj,i=this.container.element.id+Tp,n=[],r=this.toolbarItems,o=0;o<this.toolbarItems.length;o++)switch(e=0===o?"e-de-toolbar-btn-start":"Separator"===r[o+1]&&"Separator"===r[o-1]?"e-de-toolbar-btn":"Separator"===r[o+1]?"e-de-toolbar-btn-last":"Separator"===r[o-1]?"e-de-toolbar-btn-first":o===this.toolbarItems.length-1?"e-de-toolbar-btn-end":"e-de-toolbar-btn-middle",r[parseInt(o.toString(),10)]){case"Separator":n.push({type:"Separator",cssClass:"e-de-separator"});break;case"New":n.push({prefixIcon:"e-de-ctnr-new",tooltipText:t.getConstant("Create a new document"),id:i+Hp,text:t.getConstant("New"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Create a new document")}});break;case"Open":n.push({prefixIcon:"e-de-ctnr-open",tooltipText:t.getConstant("Open a document"),id:i+Ep,text:t.getConstant("Open"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Open a document")}});break;case"Undo":n.push({prefixIcon:"e-de-ctnr-undo",tooltipText:t.getConstant("Undo Tooltip"),id:i+Np,text:t.getConstant("Undo"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Undo Tooltip")}});break;case"Redo":n.push({prefixIcon:"e-de-ctnr-redo",tooltipText:t.getConstant("Redo Tooltip"),id:i+Wp,text:t.getConstant("Redo"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Redo Tooltip")}});break;case"Comments":n.push({prefixIcon:"e-de-cnt-cmt-add",tooltipText:t.getConstant("Show comments"),id:i+Mp,text:t.getConstant("Comments"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Show comments")}});break;case"TrackChanges":n.push({prefixIcon:"e-de-cnt-track",tooltipText:t.getConstant("Track Changes"),id:i+Ap,text:this.onWrapText(t.getConstant("TrackChanges")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("TrackChanges"),"aria-pressed":this.container.enableTrackChanges,role:"button","aria-hidden":"true"}});break;case"Image":n.push({template:'<button title="'+t.getConstant("Insert inline picture from a file")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+Op+'"><span class="e-btn-icon e-icons e-de-ctnr-image e-icon-left"></span><span class="e-tbar-btn-text">'+t.getConstant("Image")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+Op,htmlAttributes:{"aria-label":t.getConstant("Insert inline picture from a file"),"aria-haspopup":!1}});break;case"Table":n.push({prefixIcon:"e-de-ctnr-table",tooltipText:t.getConstant("Insert a table into the document"),id:i+Lp,text:t.getConstant("Table"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert a table into the document"),"aria-haspopup":!0}});break;case"Hyperlink":n.push({prefixIcon:"e-de-ctnr-link",tooltipText:t.getConstant("Create Hyperlink"),id:i+Dp,text:t.getConstant("Link"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Create Hyperlink"),"aria-haspopup":!0}});break;case"Bookmark":n.push({prefixIcon:"e-de-ctnr-bookmark",tooltipText:t.getConstant("Insert a bookmark in a specific place in this document"),id:i+Rp,text:t.getConstant("Bookmark"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert a bookmark in a specific place in this document"),"aria-haspopup":!0}});break;case"TableOfContents":n.push({prefixIcon:"e-de-ctnr-tableofcontent",tooltipText:t.getConstant("Provide an overview of your document by adding a table of contents"),id:i+Up,text:this.onWrapText(t.getConstant("Table of Contents")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Table of Contents")}});break;case"Header":n.push({prefixIcon:"e-de-ctnr-header",tooltipText:t.getConstant("Add or edit the header"),id:i+Vp,text:t.getConstant("Header"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Add or edit the header")}});break;case"Footer":n.push({prefixIcon:"e-de-ctnr-footer",tooltipText:t.getConstant("Add or edit the footer"),id:i+zp,text:t.getConstant("Footer"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Add or edit the footer")}});break;case"PageSetup":n.push({template:'<button title="'+t.getConstant("Page Setup")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+qp+'"><span class="e-btn-icon e-icons e-de-ctnr-pagesetup e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Page Setup"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+qp,htmlAttributes:{"aria-label":t.getConstant("Page Setup")}});break;case"PageNumber":n.push({prefixIcon:"e-de-ctnr-pagenumber",tooltipText:t.getConstant("Add page numbers"),id:i+_p,text:this.onWrapText(t.getConstant("Page Number")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Page Number")}});break;case"Break":n.push({template:'<button title="'+t.getConstant("Break")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+jp+'"><span class="e-btn-icon e-icons e-de-ctnr-break e-icon-left"></span><span class="e-tbar-btn-text">'+t.getConstant("Break")+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button><div id="'+i+jp+Gp+'"></div>',id:i+jp,htmlAttributes:{"aria-label":t.getConstant("Break")}});break;case"Find":n.push({prefixIcon:"e-de-ctnr-find",tooltipText:t.getConstant("Find Text"),id:i+Kp,text:t.getConstant("Find"),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Find Text")}});break;case"LocalClipboard":n.push({prefixIcon:"e-de-ctnr-paste",tooltipText:t.getConstant("Toggle between the internal clipboard and system clipboard"),id:i+Xp,text:this.onWrapText(t.getConstant("Local Clipboard")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Local Clipboard"),"aria-pressed":this.container.enableLocalPaste,role:"button","aria-hidden":"true"}});break;case"RestrictEditing":n.push({template:'<button title="'+t.getConstant("Restrict editing")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+Zp+'"><span class="e-btn-icon e-de-ctnr-lock e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Restrict Editing"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',htmlAttributes:{"aria-label":t.getConstant("Restrict editing")}});break;case"FormFields":n.push({template:'<button title="'+t.getConstant("Form Fields")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-de-toolbar-btn-first e-caret-hide" type="button" id="'+i+iu+'"><span class="e-btn-icon e-de-formfield e-icons e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Form Fields"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+iu,htmlAttributes:{"aria-label":t.getConstant("Form Fields")}});break;case"UpdateFields":n.push({prefixIcon:"e-de-update-field",tooltipText:t.getConstant("Update cross reference fields"),id:i+nu,text:this.onWrapText(t.getConstant("Update Fields")),cssClass:e+" e-de-formfields",htmlAttributes:{"aria-label":t.getConstant("Update cross reference fields")}});break;case"InsertFootnote":n.push({prefixIcon:"e-de-footnote",tooltipText:t.getConstant("Footnote Tooltip"),text:this.onWrapText(t.getConstant("Insert Footnote")),id:i+au,cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert Footnote")}});break;case"InsertEndnote":n.push({prefixIcon:"e-de-endnote",tooltipText:t.getConstant("Endnote Tooltip"),text:this.onWrapText(t.getConstant("Insert Endnote")),id:i+lu,cssClass:e,htmlAttributes:{"aria-label":t.getConstant("Insert Endnote")}});break;case"ContentControl":n.push({template:'<button title="'+t.getConstant("Content Control")+'" class="e-tbar-btn e-tbtn-txt e-control e-btn e-lib e-dropdown-btn e-caret-hide" type="button" id="'+i+cu+'"><span class="e-btn-icon e-icons e-de-ctnr-content-control e-icon-left"></span><span class="e-tbar-btn-text">'+this.onWrapText(t.getConstant("Content Control"))+'</span><span class="e-btn-icon e-icons e-icon-right e-caret"></span></button>',id:i+cu,htmlAttributes:{"aria-label":t.getConstant("Content Control")}});break;case"XML Mapping":n.push({prefixIcon:"e-de-ctnr-xml-mapping",tooltipText:t.getConstant("XML Mapping Pane"),id:i+wu,text:this.onWrapText(t.getConstant("XML Mapping Pane")),cssClass:e,htmlAttributes:{"aria-label":t.getConstant("XML Mapping Pane")}});break;default:n.push(r[parseInt(o.toString(),10)])}for(o=0;o<n.length;o++){var s=void 0;"Separator"!==n[o].text&&(s=o.toString(),n[o].htmlattributes={tabindex:s})}return n},e.prototype.clickHandler=function(e){var t=this.container.element.id+Tp;switch(e.item.id){case t+Hp:this.container.documentEditor.openBlank(),this.documentEditor.focusIn();break;case t+Ep:this.filePicker.value="",this.filePicker.click(),this.documentEditor.focusIn();break;case t+Np:this.container.documentEditor.editorHistoryModule.undo();break;case t+Wp:this.container.documentEditor.editorHistoryModule.redo();break;case t+Lp:this.container.documentEditor.showDialog("Table");break;case t+Dp:this.container.documentEditor.showDialog("Hyperlink");break;case t+Rp:this.container.documentEditor.showDialog("Bookmark");break;case t+Mp:this.documentEditor.editorModule.isUserInsert=!0,this.documentEditor.editorModule.insertComment(""),this.documentEditor.editorModule.isUserInsert=!1;break;case t+Ap:this.toggleTrackChangesInternal(e.item.id);break;case t+Vp:this.container.documentEditor.selectionModule.goToHeader(),this.container.statusBar.toggleWebLayout();break;case t+Up:this.onToc();break;case t+wu:this.container.documentEditor.isXmlPaneTool||this.container.documentEditor.showXmlPane(),this.container.statusBar.toggleWebLayout();break;case t+zp:this.container.documentEditor.selectionModule.goToFooter(),this.container.statusBar.toggleWebLayout();break;case t+_p:this.container.documentEditor.editorModule.insertPageNumber();break;case t+Kp:this.container.documentEditor.showOptionsPane();break;case t+Xp:this.toggleLocalPaste(e.item.id);break;case t+nu:this.documentEditor.updateFields();break;case t+au:this.documentEditor.editorModule.insertFootnote();break;case t+lu:this.documentEditor.editorModule.insertEndnote();break;default:this.container.trigger(V,e)}e.item.id!==t+Hp&&e.item.id!==t+Ep&&e.item.id!==t+Np&&e.item.id!==Wp&&e.item.id!==t+wu&&e.item.id!==t+Mp&&e.item.id!==t+Ap&&e.item.id!==t+Vp&&e.item.id!==t+Up&&e.item.id!==t+zp&&e.item.id!==t+_p&&e.item.id!==t+Xp&&e.item.id!==t+nu&&e.item.id!==t+au&&e.item.id!==t+lu&&e.item.id!==t+qp&&e.item.id!==t+jp&&e.item.id!==t+Zp&&e.item.id!==t+iu||this.documentEditor.focusIn()},e.prototype.toggleLocalPaste=function(e){this.container.enableLocalPaste=!this.container.enableLocalPaste,this.toggleButton(e,this.container.enableLocalPaste)},e.prototype.toggleEditing=function(){this.container.restrictEditing=!this.container.restrictEditing,this.container.showPropertiesPane=!this.container.restrictEditing},e.prototype.toggleRestrictEditing=function(e){var t=this.container.element.id+Tp+Zp;document.getElementById(t)&&this.toggleButton(t,e)},e.prototype.toggleButton=function(e,t){var i=document.getElementById(e);t?((0,a.classList)(i,["e-btn-toggle"],[]),i.setAttribute("aria-pressed","true")):((0,a.classList)(i,[],["e-btn-toggle"]),i.setAttribute("aria-pressed","false"))},e.prototype.toggleTrackChangesInternal=function(e,t){(0,a.isNullOrUndefined)(t)||(this.container.enableTrackChanges=!t),this.container.enableTrackChanges=!this.container.enableTrackChanges,this.toggleButton(e,this.container.enableTrackChanges)},e.prototype.togglePropertiesPane=function(){this.container.showPropertiesPane=!this.container.showPropertiesPane},e.prototype.onDropDownButtonSelect=function(e){var t=this,i=this.container.element.id+Tp,n=e.item.id;n===i+Bp?(this.imagePicker.value="",this.imagePicker.click()):n===i+hu?this.container.documentEditor.showDialog("PageSetup"):n===i+du?this.container.documentEditor.showDialog("Columns"):n===i+fu?this.container.documentEditor.editor.insertContentControl("Date"):n===i+vu?this.container.documentEditor.editor.insertContentControl("CheckBox"):n===i+gu?this.container.documentEditor.editor.insertContentControl("ComboBox"):n===i+pu?this.container.documentEditor.editor.insertContentControl("RichText"):n===i+uu?this.container.documentEditor.editor.insertContentControl("Text"):n===i+yu?this.container.documentEditor.showDialog("PictureContentControl"):n===i+mu?this.container.documentEditor.editor.insertContentControl("DropDownList"):n===i+"_image_url"||(n===i+eu?this.toggleEditing():n===i+tu?this.documentEditor.documentHelper.restrictEditingPane.showHideRestrictPane(!0):n===i+ou?this.documentEditor.editorModule.insertFormField("CheckBox"):n===i+su?this.documentEditor.editorModule.insertFormField("DropDown"):n===i+ru&&this.documentEditor.editorModule.insertFormField("Text")),setTimeout((function(){t.documentEditor.focusIn()}),30)},e.prototype.onFileChange=function(){var e=this,t=this.filePicker.files[0],i={fileSize:t.size,isCanceled:undefined};if(this.documentEditor.trigger(z,i),!i.isCanceled&&t){var n=t.name.substr(t.name.lastIndexOf("."));if(".sfdt"===n||".txt"===n){var r=new FileReader;r.onload=function(){".txt"===n?e.container.documentEditor.documentHelper.openTextFile(r.result):e.container.documentEditor.openAsync(r.result)},r.readAsText(t)}else if(this.isSupportedFormatType(n.toLowerCase()))this.documentEditor.open(t);else{var o=new a.L10n("documenteditor",this.documentEditor.defaultLocale);el.DialogUtility.alert({content:o.getConstant("Unsupported format"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.container.enableRtl}this.container.documentEditor.documentName=t.name.substr(0,t.name.lastIndexOf("."))}},e.prototype.isSupportedFormatType=function(e){switch(e){case".dotx":case".docx":case".docm":case".dotm":case".dot":case".doc":case".rtf":case".txt":case".xml":case".html":return!0;default:return!1}},e.prototype.failureHandler=function(e){"onError"===e.name?el.DialogUtility.alert({content:this.container.localObj.getConstant("Error in establishing connection with web server"),closeOnEscape:!0,showCloseIcon:!0,position:{X:"center",Y:"center"}}).enableRtl=this.container.enableRtl:(alert("Failed to load the file"),this.documentEditor.fireServiceFailure(e)),(0,el.hideSpinner)(this.container.containerTarget)},e.prototype.successHandler=function(e){this.container.documentEditor.open(e.data),(0,el.hideSpinner)(this.container.containerTarget)},e.prototype.onImageChange=function(){var e=this,t=this.imagePicker.files[0],i=new FileReader;i.onload=function(){e.insertImage(i.result)},i.readAsDataURL(t)},e.prototype.insertImage=function(e){var t=document.createElement("img"),i=this.container;t.addEventListener("load",(function(){i.documentEditor.editorModule.insertImageInternal(e,!0,this.width,this.height,this.alt)})),t.src=e},e.prototype.enableDisableFormField=function(e){var t=document.getElementById("container_toolbar_form_fields");(0,a.isNullOrUndefined)(t)||this.toolbar.enableItems(t.parentElement,e)},e.prototype.enableDisableInsertComment=function(e){this.isCommentEditing=!e;var t=this.container.element.id+Tp+Mp,i=document.getElementById(t);!this.container.enableComment&&i?this.toolbar.removeItems(i.parentElement):i&&((0,a.isNullOrUndefined)(this.documentEditor)||!this.documentEditor.isReadOnly&&!this.documentEditor.documentHelper.isDocumentProtected||(e=this.documentEditor.documentHelper.isCommentOnlyMode||!this.documentEditor.isReadOnlyMode),this.toolbar.enableItems(i.parentElement,e))},e.prototype.toggleTrackChanges=function(e){var t=this.container.element.id+Tp+Ap;document.getElementById(t)&&this.toggleTrackChangesInternal(t,e)},e.prototype.enableDisableToolBarItem=function(e,t){if(!(0,a.isNullOrUndefined)(this.container.element)){for(var i=this.container.element.id+Tp,n=0,r=this.toolbar.items;n<r.length;n++){var o=r[n],s=o.id;if(s!==i+Hp&&s!==i+Ep&&s!==i+Kp&&s!==i+Xp&&s!==i+Zp&&"Separator"!==o.type){if(e&&this.isCommentEditing&&s===i+Mp)continue;if(s!==i+Np&&s!==i+Wp&&s!==i+Lp&&s!==i+Dp&&s!==i+Rp&&s!==i+Mp&&s!==i+Vp&&s!==i+wu&&s!==i+Up&&s!==i+zp&&s!==i+qp&&s!==i+cu&&s!==i+_p&&s!==i+Op&&s!==i+iu&&s!==i+jp&&s!==i+Ap&&s!==i+au&&s!==i+lu&&s!==i+nu)continue;if(t&&this.documentEditor.documentHelper.isFormFillProtectedMode&&s===i+nu)continue;var l=document.getElementById(o.id);(0,a.isNullOrUndefined)(l)||(0,a.isNullOrUndefined)(l.parentElement)||this.toolbar.enableItems(l.parentElement,e)}}(0,a.isNullOrUndefined)(this.documentEditor)||this.enableDisableFormField(!this.documentEditor.enableHeaderAndFooter&&e&&!this.documentEditor.isReadOnlyMode);var d=this.documentEditor.selectionModule.isPlainContentControl();(this.documentEditor.selectionModule.isinFootnote||this.documentEditor.selectionModule.isinEndnote||this.documentEditor.enableHeaderAndFooter||d)&&(this.containsItem(i+lu)&&this.toolbar.enableItems(document.getElementById(i+lu).parentElement,!1),this.containsItem(i+au)&&this.toolbar.enableItems(document.getElementById(i+au).parentElement,!1),this.containsItem(i+jp)&&this.toolbar.enableItems(document.getElementById(i+jp).parentElement,!1),d&&(this.containsItem(i+Lp)&&this.toolbar.enableItems(document.getElementById(i+Lp).parentElement,!1),this.containsItem(i+Op)&&this.toolbar.enableItems(document.getElementById(i+Op).parentElement,!1),this.containsItem(i+Mp)&&this.toolbar.enableItems(document.getElementById(i+Mp).parentElement,!1),this.containsItem(i+Rp)&&this.toolbar.enableItems(document.getElementById(i+Rp).parentElement,!1),this.containsItem(i+Dp)&&this.toolbar.enableItems(document.getElementById(i+Dp).parentElement,!1),this.containsItem(i+iu)&&this.toolbar.enableItems(document.getElementById(i+iu).parentElement,!1),this.containsItem(i+cu)&&this.toolbar.enableItems(document.getElementById(i+cu).parentElement,!1))),t&&!this.container.showPropertiesPane||(t&&(e=this.container.showPropertiesPane),(0,a.classList)(this.propertiesPaneButton.element.parentElement,e?[]:["e-de-overlay"],e?["e-de-overlay"]:[]));var h=this.documentEditor.documentHelper.protectionType;(e||this.documentEditor.documentHelper.isDocumentProtected&&("FormFieldsOnly"===h||"CommentsOnly"===h))&&this.enableDisableUndoRedo(),this.documentEditor.documentHelper.isTrackedOnlyMode&&this.containsItem(i+Ap)&&this.toolbar.enableItems(document.getElementById(i+Ap).parentElement,!1)}},e.prototype.containsItem=function(e){for(var t=0,i=this.toolbar.items;t<i.length;t++){if(i[t].id===e)return!0}return!1},e.prototype.enableDisableUndoRedo=function(){var e=this.container.element.id+Tp;if(this.toolbarItems.indexOf("Undo")>=0){var t=document.getElementById(e+Np);(0,a.isNullOrUndefined)(t)||this.toolbar.enableItems(t.parentElement,this.container.documentEditor.editorHistoryModule.canUndo())}if(this.toolbarItems.indexOf("Redo")>=0){var i=document.getElementById(e+Wp);(0,a.isNullOrUndefined)(i)||this.toolbar.enableItems(i.parentElement,this.container.documentEditor.editorHistoryModule.canRedo())}},e.prototype.onToc=function(){if("TableOfContents"===this.container.previousContext&&"none"===this.container.propertiesPaneContainer.style.display)return this.container.showPropertiesPane=!1,void this.documentEditor.focusIn();"block"===this.container.headerFooterProperties.element.style.display&&this.documentEditor.selectionModule.closeHeaderFooter(),this.enableDisablePropertyPaneButton(!1),this.container.showProperties("toc")},e.prototype.enableDisablePropertyPaneButton=function(e){e?(0,a.classList)(this.propertiesPaneButton.element.firstChild,["e-pane-enabled"],["e-pane-disabled"]):(0,a.classList)(this.propertiesPaneButton.element.firstChild,["e-pane-disabled"],["e-pane-enabled"])},e.prototype.destroy=function(){if(this.restrictDropDwn&&(this.restrictDropDwn.destroy(),this.restrictDropDwn=void 0),this.imgDropDwn&&(this.imgDropDwn.destroy(),this.imgDropDwn=void 0),this.PageSetUpDropDwn&&(this.PageSetUpDropDwn.destroy(),this.PageSetUpDropDwn=void 0),this.breakDropDwn&&(this.breakDropDwn.destroy(),this.breakDropDwn=void 0),this.formFieldDropDown&&(this.formFieldDropDown.destroy(),this.formFieldDropDown=void 0),this.ContentControlDropDwn&&(this.ContentControlDropDwn.destroy(),this.ContentControlDropDwn=void 0),this.toolbar){var e=this.toolbar.element;this.toolbar.destroy(),this.toolbar=void 0,e.parentElement.removeChild(e)}this.container.toolbarContainer&&(this.container.containerTarget.removeChild(this.container.toolbarContainer),this.container.toolbarContainer=void 0),this.container.toolbarModule&&(this.container.toolbarModule=void 0),this.propertiesPaneButton&&this.propertiesPaneButton.destroy(),this.breakListView&&(this.breakListView.destroy(),this.breakListView=void 0),this.propertiesPaneButton=void 0,this.toolbarItems=[],this.toolbarItems=void 0,this.container=void 0},e}(),Cu=function(){function e(e,t){this.isHeaderTopApply=!1,this.isFooterTopApply=!1,this.HeaderTopApplyClickHook=this.headerTopApply.bind(this),this.FooterTopApplyClickHook=this.footerTopapply.bind(this),this.OnHeaderValueKeyDownHook=this.onHeaderValue.bind(this),this.OnFooterValueKeyDownHook=this.onFooterValue.bind(this),this.ChangeHeaderBlurHook=this.changeHeaderBlur.bind(this),this.ChangeFooterBlurHook=this.changeFooterBlur.bind(this),this.container=e,this.isRtl=t,this.initHeaderFooterPane(),this.wireEvents()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?(0,a.classList)(this.element,[],["e-de-overlay"]):(0,a.classList)(this.element,["e-de-overlay"],[])},e.prototype.initHeaderFooterPane=function(){this.initializeHeaderFooter(),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element)},e.prototype.showHeaderFooterPane=function(e){e&&(this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.onSelectionChange()),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},e.prototype.initializeHeaderFooter=function(){var e,t=this;this.localObj=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.elementId="header_footer_properties",this.element=(0,a.createElement)("div",{id:this.documentEditor.element.id+this.elementId,className:"e-de-prop-pane"}),this.headerDiv=this.createDivTemplate("_header_footer",this.element,"padding-bottom:0"),(0,a.classList)(this.headerDiv,["e-de-cntr-pane-padding"],[]),this.headerLabel=(0,a.createElement)("label",{className:"e-de-prop-header-label"}),this.headerLabel.innerHTML=this.localObj.getConstant("Header And Footer"),e=this.isRtl?"float:left;":"float:right;",this.closeIcon=(0,a.createElement)("span",{id:"_header_footer_close",className:"e-de-ctnr-close e-de-close-icon e-icons",styles:"display:inline-block;cursor:pointer;"+e}),this.closeIcon.addEventListener("click",(function(){t.onClose()})),this.headerDiv.appendChild(this.headerLabel),this.headerDiv.appendChild(this.closeIcon),this.optionsLabelDiv=this.createDivTemplate(this.elementId+"_options",this.element),(0,a.classList)(this.optionsLabelDiv,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]),this.optionsLabel=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"}),this.optionsLabel.innerHTML=this.localObj.getConstant("Options"),this.optionsLabelDiv.appendChild(this.optionsLabel),this.optionsDiv=this.createDivTemplate(this.elementId+"_optionsDiv",this.optionsLabelDiv),this.firstPageDiv=this.createDivTemplate(this.elementId+"_firstPageDiv",this.optionsDiv),(0,a.classList)(this.firstPageDiv,["e-de-hdr-ftr-frst-div"],[]);var i=(0,a.createElement)("input",{id:"firstPage",className:"e-de-prop-sub-label"});this.firstPageDiv.appendChild(i),this.firstPage=new tl.CheckBox({label:this.localObj.getConstant("Different First Page"),change:this.changeFirstPageOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.firstPage.appendTo(i),this.firstPageDiv.children[0].setAttribute("title",this.localObj.getConstant("Different header and footer for first page")),this.oddOrEvenDiv=this.createDivTemplate(this.elementId+"_oddOrEvenDiv",this.optionsDiv),(0,a.classList)(this.oddOrEvenDiv,["e-de-hdr-ftr-frst-div"],[]);var n=(0,a.createElement)("input",{id:"oddOrEven",className:"e-de-sub-prop-label"});this.oddOrEvenDiv.appendChild(n),this.oddOrEven=new tl.CheckBox({label:this.localObj.getConstant("Different Odd And Even Pages"),change:this.changeoddOrEvenOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl}),this.oddOrEven.appendTo(n),this.oddOrEvenDiv.children[0].setAttribute("title",this.localObj.getConstant("Different header and footer for odd and even pages")),this.linkToPreviousDiv=this.createDivTemplate(this.elementId+"_linkToPreviousDiv",this.optionsDiv);var r=(0,a.createElement)("input",{id:"linkToPrevious",className:"e-de-sub-prop-label"});this.linkToPreviousDiv.appendChild(r),this.linkToPrevious=new tl.CheckBox({label:this.localObj.getConstant("Link to Previous"),change:this.changeLinkToPreviousOptions.bind(this),cssClass:"e-de-prop-sub-label",enableRtl:this.isRtl,checked:!0}),this.linkToPrevious.appendTo(r),this.linkToPreviousDiv.children[0].setAttribute("title",this.localObj.getConstant("Link to the previous Title")),this.positionLabelDiv=this.createDivTemplate(this.elementId+"_positionLabelDiv",this.element),(0,a.classList)(this.positionLabelDiv,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]),this.positionLabel=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label",styles:"height:20px;"}),this.positionLabel.innerHTML=this.localObj.getConstant("Position"),this.positionLabelDiv.appendChild(this.positionLabel),this.positionDiv=this.createDivTemplate(this.elementId+"_positionDiv",this.positionLabelDiv),this.headerTopDiv=this.createDivTemplate(this.elementId+"_headerTopDiv",this.positionDiv),(0,a.classList)(this.headerTopDiv,["e-de-hdr-ftr-top-div"],[]),this.headerTopLabel=(0,a.createElement)("label",{className:"e-de-prop-sub-label",styles:"display:block"}),this.headerTopLabel.innerHTML=this.localObj.getConstant("Header from Top"),this.headerTopDiv.appendChild(this.headerTopLabel);var o=(0,a.createElement)("input",{id:this.documentEditor.element.id+"_headerFromTop",className:"e-de-prop-sub-label"});o.setAttribute("aria-label",this.localObj.getConstant("Header from Top")),this.headerTopDiv.appendChild(o),this.headerFromTop=new rl.NumericTextBox({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.headerFromTop.appendTo(o),this.headerFromTop.element.parentElement.setAttribute("title",this.localObj.getConstant("Distance from top of the page to top of the header")),this.footerBottomDiv=this.createDivTemplate(this.elementId+"_footerBottomDiv",this.positionDiv),this.footerBottomLabel=(0,a.createElement)("label",{className:"e-de-prop-sub-label",styles:"display:block"}),this.footerBottomLabel.innerHTML=this.localObj.getConstant("Footer from Bottom"),this.footerBottomDiv.appendChild(this.footerBottomLabel);var s=(0,a.createElement)("input",{id:this.documentEditor.element.id+"_footerFromTop",className:"e-de-prop-sub-label"});s.setAttribute("aria-label",this.localObj.getConstant("Footer from Bottom")),this.footerBottomDiv.appendChild(s),this.footerFromTop=new rl.NumericTextBox({value:36,cssClass:"e-de-prop-header-numeric",showSpinButton:!1,format:"n0",decimals:2,max:1584,min:0,enableRtl:this.isRtl}),this.footerFromTop.appendTo(s),this.footerFromTop.element.parentElement.setAttribute("title",this.localObj.getConstant("Distance from bottom of the page to bottom of the footer"))},e.prototype.createDivTemplate=function(e,t,i){return this.divElement=i?(0,a.createElement)("div",{id:e,styles:i}):(0,a.createElement)("div",{id:e}),t.appendChild(this.divElement),this.divElement},e.prototype.wireEvents=function(){this.headerFromTop.element.addEventListener("click",this.HeaderTopApplyClickHook),this.footerFromTop.element.addEventListener("click",this.FooterTopApplyClickHook),this.headerFromTop.element.addEventListener("keydown",this.OnHeaderValueKeyDownHook),this.footerFromTop.element.addEventListener("keydown",this.OnFooterValueKeyDownHook),this.headerFromTop.element.addEventListener("blur",this.ChangeHeaderBlurHook),this.footerFromTop.element.addEventListener("blur",this.ChangeFooterBlurHook)},e.prototype.headerTopApply=function(){this.isHeaderTopApply=!0},e.prototype.footerTopapply=function(){this.isFooterTopApply=!0},e.prototype.changeHeaderBlur=function(){this.changeHeaderValue(),this.isHeaderTopApply=!1},e.prototype.changeFooterBlur=function(){this.changeFooterValue(),this.isFooterTopApply=!1},e.prototype.onClose=function(){this.container.showHeaderProperties=!0,this.container.documentEditor.selectionModule.closeHeaderFooter()},e.prototype.changeFirstPageOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selectionModule.sectionFormat.differentFirstPage=this.firstPage.checked,setTimeout((function(){e.documentEditor.focusIn()}),10))},e.prototype.changeoddOrEvenOptions=function(){var e=this;this.documentEditor.isReadOnly||(this.documentEditor.selectionModule.sectionFormat.differentOddAndEvenPages=this.oddOrEven.checked,setTimeout((function(){e.documentEditor.focusIn()}),10))},e.prototype.changeLinkToPreviousOptions=function(){var e=this;if(!this.documentEditor.isReadOnly){var t=this.documentEditor.selectionModule.start.paragraph.containerWidget.headerFooterType,i=this.linkToPrevious.checked;switch(t){case"OddHeader":this.documentEditor.selectionModule.sectionFormat.oddPageHeader.linkToPrevious=i;break;case"OddFooter":this.documentEditor.selectionModule.sectionFormat.oddPageFooter.linkToPrevious=i;break;case"EvenHeader":this.documentEditor.selectionModule.sectionFormat.evenPageHeader.linkToPrevious=i;break;case"EvenFooter":this.documentEditor.selectionModule.sectionFormat.evenPageFooter.linkToPrevious=i;break;case"FirstPageHeader":this.documentEditor.selectionModule.sectionFormat.firstPageHeader.linkToPrevious=i;break;case"FirstPageFooter":this.documentEditor.selectionModule.sectionFormat.firstPageFooter.linkToPrevious=i}setTimeout((function(){e.documentEditor.focusIn()}),10)}},e.prototype.changeHeaderValue=function(){if(this.isHeaderTopApply&&!this.documentEditor.isReadOnly){var e=this.headerFromTop.value;e>this.headerFromTop.max&&(e=this.headerFromTop.max),this.documentEditor.selectionModule.sectionFormat.headerDistance=e}},e.prototype.onHeaderValue=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.changeHeaderValue(),t.isHeaderTopApply=!1}),30)},e.prototype.onFooterValue=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.changeFooterValue(),t.isFooterTopApply=!1}),30)},e.prototype.changeFooterValue=function(){if(this.isFooterTopApply&&!this.documentEditor.isReadOnly){var e=this.footerFromTop.value;e>this.footerFromTop.max&&(e=this.footerFromTop.max),this.documentEditor.selectionModule.sectionFormat.footerDistance=e}},e.prototype.onSelectionChange=function(){if(this.headerFromTop.value=this.documentEditor.selectionModule.sectionFormat.headerDistance,this.footerFromTop.value=this.documentEditor.selectionModule.sectionFormat.footerDistance,this.documentEditor.selectionModule.sectionFormat.differentFirstPage?this.firstPage.checked=!0:this.firstPage.checked=!1,this.documentEditor.selectionModule.sectionFormat.differentOddAndEvenPages?this.oddOrEven.checked=!0:this.oddOrEven.checked=!1,0===this.documentEditor.selectionModule.start.paragraph.bodyWidget.sectionIndex)this.linkToPrevious.disabled=!0;else switch(this.linkToPrevious.disabled=!1,this.documentEditor.selectionModule.start.paragraph.containerWidget.headerFooterType){case"OddHeader":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.oddPageHeader.linkToPrevious;break;case"OddFooter":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.oddPageFooter.linkToPrevious;break;case"EvenHeader":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.evenPageHeader.linkToPrevious;break;case"EvenFooter":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.evenPageFooter.linkToPrevious;break;case"FirstPageHeader":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.firstPageHeader.linkToPrevious;break;case"FirstPageFooter":this.linkToPrevious.checked=this.documentEditor.selectionModule.sectionFormat.firstPageFooter.linkToPrevious}},e.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLDOM(),this.element&&(this.element.innerHTML="",this.element.parentElement&&this.element.parentElement.removeChild(this.element)),this.element=void 0,this.firstPage&&this.firstPage.destroy(),this.firstPage=void 0,this.oddOrEven&&this.oddOrEven.destroy(),this.oddOrEven=void 0,this.linkToPrevious&&this.linkToPrevious.destroy(),this.linkToPrevious=void 0,this.headerFromTop&&(this.headerFromTop.destroy(),this.headerFromTop=void 0),this.footerFromTop&&(this.footerFromTop.destroy(),this.footerFromTop=void 0),this.container=void 0,this.localObj=void 0,this.elementId=void 0},e.prototype.unWireEvents=function(){this.headerFromTop.element.removeEventListener("click",this.HeaderTopApplyClickHook),this.footerFromTop.element.removeEventListener("click",this.FooterTopApplyClickHook),this.headerFromTop.element.removeEventListener("keydown",this.OnHeaderValueKeyDownHook),this.footerFromTop.element.removeEventListener("keydown",this.OnFooterValueKeyDownHook),this.headerFromTop.element.removeEventListener("blur",this.ChangeHeaderBlurHook),this.footerFromTop.element.removeEventListener("blur",this.ChangeFooterBlurHook),this.HeaderTopApplyClickHook=void 0,this.FooterTopApplyClickHook=void 0,this.OnHeaderValueKeyDownHook=void 0,this.OnFooterValueKeyDownHook=void 0,this.ChangeHeaderBlurHook=void 0,this.ChangeFooterBlurHook=void 0},e.prototype.removeHTMLDOM=function(){this.headerDiv.remove(),this.headerLabel.remove(),this.closeIcon.remove(),this.optionsLabelDiv.remove(),this.optionsLabel.remove(),this.optionsDiv.remove(),this.firstPageDiv.remove(),this.oddOrEvenDiv.remove(),this.linkToPreviousDiv.remove(),this.positionLabelDiv.remove(),this.positionLabel.remove(),this.positionDiv.remove(),this.headerTopDiv.remove(),this.headerTopLabel.remove(),this.footerBottomDiv.remove(),this.footerBottomLabel.remove(),this.divElement.remove()},e}(),xu=function(){function e(e,t){this.isWidthApply=!1,this.isHeightApply=!1,this.onAspectRatioBtnClickHook=this.onAspectRatioBtnClick.bind(this),this.widthBlurHook=this.widthBlur.bind(this),this.heightBlurHook=this.heightBlur.bind(this),this.onImageWidthHook=this.onImageWidth.bind(this),this.onImageHeightHook=this.onImageHeight.bind(this),this.widthNumericBlurHook=this.widthNumericBlur.bind(this),this.heightNumericBlurHook=this.heightNumericBlur.bind(this),this.altTextAreaBlurHook=this.altTextAreaBlur.bind(this),this.container=e,this.elementId=this.documentEditor.element.id,this.isMaintainAspectRatio=!1,this.isRtl=t,this.initializeImageProperties()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?(0,a.classList)(this.element,[],["e-de-overlay"]):(0,a.classList)(this.element,["e-de-overlay"],[])},e.prototype.initializeImageProperties=function(){this.element=(0,a.createElement)("div",{id:this.elementId+"_imageProperties",className:"e-de-prop-pane"}),this.element.style.display="none",this.container.propertiesPaneContainer.appendChild(this.element),this.initImageProp(),this.initImageAltProp(),this.wireEvents()},e.prototype.initImageProp=function(){var e=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale);this.imageDiv=(0,a.createElement)("div",{id:this.elementId+"_imageDiv",className:"e-de-cntr-pane-padding e-de-prop-separator-line"}),this.element.appendChild(this.imageDiv),this.label=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"}),this.label.textContent=e.getConstant("Image"),this.imageDiv.appendChild(this.label),this.outerDiv=(0,a.createElement)("div"),this.imageDiv.appendChild(this.outerDiv),this.widthElement=this.createImagePropertiesDiv("_widthDiv",this.outerDiv,"_widthInput",e.getConstant("W"),e.getConstant("Width")),this.widthNumericBox=new rl.NumericTextBox({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.widthNumericBox.appendTo(this.widthElement),this.heightElement=this.createImagePropertiesDiv("_heightDiv",this.outerDiv,"_heightInput",e.getConstant("H"),e.getConstant("Height")),this.heightNumericBox=new rl.NumericTextBox({min:0,max:23500,cssClass:"e-de-image-property",showSpinButton:!1,format:"n0",decimals:2}),this.heightNumericBox.appendTo(this.heightElement),this.aspectRatioDiv=(0,a.createElement)("div",{id:this.elementId+"_aspectRatioDiv"}),this.aspectRatioDiv.setAttribute("title",e.getConstant("Aspect ratio")),this.outerDiv.appendChild(this.aspectRatioDiv),this.aspectRatio=(0,a.createElement)("input",{id:this.elementId+"_aspectRatio",className:"e-de-ctnr-prop-label"}),this.aspectRatioDiv.appendChild(this.aspectRatio),this.aspectRatioBtn=new tl.CheckBox({label:e.getConstant("Aspect ratio"),enableRtl:this.isRtl},this.aspectRatio)},e.prototype.initImageAltProp=function(){var e=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale);this.altDiv=(0,a.createElement)("div",{id:this.elementId+"_altDiv",className:"e-de-cntr-pane-padding e-de-prop-separator-line"}),this.element.appendChild(this.altDiv),this.alabel=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"}),this.alabel.textContent=e.getConstant("Alternate Text"),this.altDiv.appendChild(this.alabel),this.textArea=(0,a.createElement)("textarea",{id:this.elementId+"_textarea",className:"e-de-ctnr-prop-label "}),this.altDiv.appendChild(this.textArea),this.textareaObj=new rl.TextBox({floatLabelType:"Never"}),this.textareaObj.appendTo(this.textArea)},e.prototype.createImagePropertiesDiv=function(e,t,i,n,r){var o=(0,a.createElement)("div",{id:this.elementId+e,styles:"position: relative;width: 100%;",className:"e-de-ctnr-segment"});o.setAttribute("title",r),t.appendChild(o);var s=(0,a.createElement)("input",{id:this.elementId+i,className:"e-textbox",styles:"width:100%;"});o.appendChild(s);var l=(0,a.createElement)("span",{className:"e-de-img-prty-span"});return l.textContent=n,o.appendChild(l),s},e.prototype.wireEvents=function(){this.aspectRatioBtn.element.addEventListener("change",this.onAspectRatioBtnClickHook),this.widthNumericBox.element.addEventListener("click",this.widthBlurHook),this.heightNumericBox.element.addEventListener("click",this.heightBlurHook),this.widthNumericBox.element.addEventListener("keydown",this.onImageWidthHook),this.heightNumericBox.element.addEventListener("keydown",this.onImageHeightHook),this.widthNumericBox.element.addEventListener("blur",this.widthNumericBlurHook),this.heightNumericBox.element.addEventListener("blur",this.heightNumericBlurHook),this.textArea.addEventListener("blur",this.altTextAreaBlurHook)},e.prototype.altTextAreaBlur=function(){this.documentEditor.selectionModule.imageFormat.alternateText!==this.textArea.value&&this.applyImageAlternativeText()},e.prototype.heightNumericBlur=function(){this.applyImageHeight(),this.isHeightApply=!1},e.prototype.widthNumericBlur=function(){this.applyImageWidth(),this.isWidthApply=!1},e.prototype.widthBlur=function(){this.isWidthApply=!0},e.prototype.heightBlur=function(){this.isHeightApply=!0},e.prototype.applyImageAlternativeText=function(){var e=a.SanitizeHtmlHelper.sanitize(this.textArea.value);(0,a.isNullOrUndefined)(e)||this.documentEditor.selectionModule.imageFormat.applyImageAlternativeText(e)},e.prototype.onImageWidth=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.applyImageWidth(),t.isWidthApply=!1}),30)},e.prototype.onImageHeight=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.applyImageHeight(),t.isHeightApply=!1}),30)},e.prototype.applyImageWidth=function(){if(this.isMaintainAspectRatio){if(this.isMaintainAspectRatio){(t=this.widthNumericBox.value)>this.widthNumericBox.max&&(t=this.widthNumericBox.max);var e=t/this.documentEditor.selectionModule.imageFormat.width;i=this.heightNumericBox.value*e;this.heightNumericBox.value=i,null!==t&&null!==i&&this.documentEditor.selectionModule.imageFormat.resize(t,i)}}else{var t=this.widthNumericBox.value,i=this.heightNumericBox.value;t>this.widthNumericBox.max&&(t=this.widthNumericBox.max),i>this.heightNumericBox.max&&(i=this.heightNumericBox.max),null!==t&&null!==i&&this.documentEditor.selectionModule.imageFormat.resize(t,i)}},e.prototype.applyImageHeight=function(){if(this.isMaintainAspectRatio){if(this.isMaintainAspectRatio){var e=(i=this.heightNumericBox.value)/this.documentEditor.selectionModule.imageFormat.height;t=this.widthNumericBox.value*e;this.widthNumericBox.value=t,null!==t&&null!==i&&this.documentEditor.selectionModule.imageFormat.resize(t,i)}}else{var t=this.widthNumericBox.value,i=this.heightNumericBox.value;null!==t&&null!==i&&this.documentEditor.selectionModule.imageFormat.resize(t,i)}},e.prototype.onAspectRatioBtnClick=function(){this.isMaintainAspectRatio?this.isMaintainAspectRatio=!1:this.isMaintainAspectRatio=!0},e.prototype.showImageProperties=function(e){"block"===this.element.style.display&&this.updateImageProperties(),!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display||(this.element.style.display=e?"block":"none",this.documentEditor.resize())},e.prototype.updateImageProperties=function(){this.widthNumericBox.value=this.documentEditor.selectionModule.imageFormat.width,this.heightNumericBox.value=this.documentEditor.selectionModule.imageFormat.height,(0,a.isNullOrUndefined)(this.documentEditor.selectionModule.imageFormat.alternateText)?this.textArea.value="":this.textArea.value=this.documentEditor.selectionModule.imageFormat.alternateText},e.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLDom(),this.widthNumericBox&&this.widthNumericBox.destroy(),this.widthNumericBox=void 0,this.heightNumericBox&&this.heightNumericBox.destroy(),this.heightNumericBox=void 0,this.aspectRatioBtn&&this.aspectRatioBtn.destroy(),this.aspectRatioBtn=void 0,this.textareaObj&&(this.textareaObj.destroy(),this.textArea.remove(),this.textArea=void 0),this.element&&(this.element.innerHTML="",this.element=void 0),this.container=void 0},e.prototype.removeHTMLDom=function(){this.outerDiv.remove(),this.label.remove(),this.imageDiv.remove(),this.aspectRatioDiv.remove(),this.aspectRatio.remove(),this.alabel.remove(),this.textArea.remove(),this.altDiv.remove(),this.element.remove()},e.prototype.unWireEvents=function(){this.aspectRatioBtn.element.removeEventListener("change",this.onAspectRatioBtnClickHook),this.widthNumericBox.element.removeEventListener("click",this.widthBlurHook),this.heightNumericBox.element.removeEventListener("click",this.heightBlurHook),this.widthNumericBox.element.removeEventListener("keydown",this.onImageWidthHook),this.heightNumericBox.element.removeEventListener("keydown",this.onImageHeightHook),this.widthNumericBox.element.removeEventListener("blur",this.widthNumericBlurHook),this.heightNumericBox.element.removeEventListener("blur",this.heightNumericBlurHook),this.textArea.removeEventListener("blur",this.altTextAreaBlurHook),this.onAspectRatioBtnClickHook=void 0,this.widthBlurHook=void 0,this.heightBlurHook=void 0,this.onImageWidthHook=void 0,this.onImageHeightHook=void 0,this.widthNumericBlurHook=void 0,this.heightNumericBlurHook=void 0,this.altTextAreaBlurHook=void 0},e}(),Iu=function(){function e(e,t){this.onCloseClickHook=this.onCloseClick.bind(this),this.onInsertToClickHook=this.onInsertToc.bind(this),this.container=e,this.elementId=this.documentEditor.element.id,this.isRtl=t,this.initializeTocPane()}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return this.container.toolbarModule},enumerable:!0,configurable:!0}),e.prototype.enableDisableElements=function(e){e?(0,a.classList)(this.element,[],["e-de-overlay"]):(0,a.classList)(this.element,["e-de-overlay"],[])},e.prototype.initializeTocPane=function(){this.localObj=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.element=(0,a.createElement)("div",{id:this.elementId+"_tocProperties",className:"e-de-prop-pane"});var e=(0,a.createElement)("div",{className:"e-de-cntr-pane-padding e-de-prop-separator-line"});this.tocHeaderDiv(e),this.initTemplates(e),e=(0,a.createElement)("div",{className:"e-de-cntr-pane-padding"}),this.tocOptionsDiv(e),this.contentStylesDropdown(e),this.checkboxContent(e),this.buttonDiv(e),this.wireEvents(),this.updateTocProperties(),this.container.propertiesPaneContainer.appendChild(this.element)},e.prototype.updateTocProperties=function(){this.rightalignPageNumber.checked=!0,this.showPageNumber.checked=!0,this.hyperlink.checked=!0},e.prototype.wireEvents=function(){this.cancelBtn.element.addEventListener("click",this.onCloseClickHook),this.updateBtn.element.addEventListener("click",this.onInsertToClickHook),this.closeButton.addEventListener("click",this.onCloseClickHook)},e.prototype.onCloseClick=function(){this.onClose()},e.prototype.onClose=function(){this.container.showPropertiesPane&&"TableOfContents"!==this.container.previousContext?this.container.showPropertiesPaneOnSelection():(this.showTocPane(!1),this.toolbar&&this.toolbar.enableDisablePropertyPaneButton(!1),this.container.showPropertiesPane=!1)},e.prototype.tocHeaderDiv=function(e){var t,i;this.isRtl?(t="float:left;",i="margin-left:7px;"):(t="float:right;",i="margin-right:7px;"),this.headerDiv=(0,a.createElement)("div",{id:this.elementId+"toc_id",styles:"display: block;"}),e.appendChild(this.headerDiv),this.element.appendChild(e),this.title=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"}),this.title.textContent=this.localObj.getConstant("Table of Contents"),this.headerDiv.appendChild(this.title),this.closeButton=(0,a.createElement)("span",{className:"e-de-ctnr-close e-icons",styles:"cursor: pointer;display:inline-block;color: #4A4A4A;"+t+i}),this.headerDiv.appendChild(this.closeButton)},e.prototype.initTemplates=function(e){this.template1(e)},e.prototype.template1=function(e){this.template1Div=(0,a.createElement)("div",{className:"e-de-toc-template1"}),this.isRtl&&this.template1Div.classList.add("e-de-rtl"),e.appendChild(this.template1Div),this.templateContent1=(0,a.createElement)("div",{className:"e-de-toc-template1-content1"}),this.templateContent1.textContent=this.localObj.getConstant("HEADING - - - - 1"),this.template1Div.appendChild(this.templateContent1),this.templateContent2=(0,a.createElement)("div",{className:"e-de-toc-template1-content2"}),this.templateContent2.textContent=this.localObj.getConstant("HEADING - - - - 2"),this.template1Div.appendChild(this.templateContent2),this.templateContent3=(0,a.createElement)("div",{className:"e-de-toc-template1-content3"}),this.templateContent3.textContent=this.localObj.getConstant("HEADING - - - - 3"),this.template1Div.appendChild(this.templateContent3)},e.prototype.tocOptionsDiv=function(e){this.optionsDiv=(0,a.createElement)("div"),e.appendChild(this.optionsDiv),this.element.appendChild(e),this.isRtl&&this.optionsDiv.classList.add("e-de-rtl"),this.label=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"}),this.label.textContent=this.localObj.getConstant("Options"),this.optionsDiv.appendChild(this.label)},e.prototype.createDropDownButton=function(e,t,i,n,r){var o=(0,a.createElement)("input",{id:e});return t.appendChild(o),new al.DropDownList({index:r,dataSource:n,popupHeight:"150px",cssClass:"e-de-prop-font-button",placeholder:this.localObj.getConstant("Levels")},o)},e.prototype.contentStylesDropdown=function(e){var t=this;this.isRtl,this.contentStyleElement=(0,a.createElement)("div",{id:"contentstyle_div"}),this.contentStyleElement.setAttribute("title",this.localObj.getConstant("Number of heading or outline levels to be shown in table of contents")),e.appendChild(this.contentStyleElement),this.isRtl,this.dropDownLabel=(0,a.createElement)("label",{className:"e-de-prop-sub-label",styles:"display:block"}),this.dropDownLabel.textContent=this.localObj.getConstant("Levels"),this.contentStyleElement.appendChild(this.dropDownLabel),e.appendChild(this.contentStyleElement);this.borderLevelStyle=this.createDropDownButton(this.elementId+"_borderLevelDiv",this.contentStyleElement,"",["1","2","3","4","5","6","7","8","9"],2),this.borderLevelStyle.change=function(e){t.borderLevelStyle.value=e.item.value},e.appendChild(this.contentStyleElement)},e.prototype.checkboxContent=function(e){this.isRtl,this.checkboxElement=(0,a.createElement)("div",{id:"toc_checkboxDiv",styles:"margin-bottom:36px;"}),e.appendChild(this.checkboxElement),this.showPageNumberDiv=(0,a.createElement)("div",{className:"e-de-toc-checkbox1"}),this.showPageNumberDiv.setAttribute("title",this.localObj.getConstant("Show page numbers in table of contents")),this.checkboxElement.appendChild(this.showPageNumberDiv),this.showpagenumberCheckboxElement=(0,a.createElement)("input",{id:"showpagenumber",styles:"width:12px;height:12px;margin-bottom:8px",className:"e-de-prop-sub-label"}),this.showPageNumberDiv.appendChild(this.showpagenumberCheckboxElement),this.showPageNumber=new tl.CheckBox({label:this.localObj.getConstant("Show page numbers"),enableRtl:this.isRtl}),this.showPageNumber.appendTo(this.showpagenumberCheckboxElement),this.rightAlignDiv=(0,a.createElement)("div",{className:"e-de-toc-checkbox2"}),this.rightAlignDiv.setAttribute("title",this.localObj.getConstant("Right align page numbers in table of contents")),this.checkboxElement.appendChild(this.rightAlignDiv),this.rightalignpagenumberCheckboxElement=(0,a.createElement)("input",{id:"rightalignpagenumber",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"}),this.rightAlignDiv.appendChild(this.rightalignpagenumberCheckboxElement),this.rightalignPageNumber=new tl.CheckBox({label:this.localObj.getConstant("Right align page numbers"),enableRtl:this.isRtl}),this.rightalignPageNumber.appendTo(this.rightalignpagenumberCheckboxElement),this.hyperlinkDiv=(0,a.createElement)("div",{className:"e-de-toc-checkbox3"}),this.hyperlinkDiv.setAttribute("title",this.localObj.getConstant("Use hyperlinks instead of page numbers")),this.checkboxElement.appendChild(this.hyperlinkDiv),this.hyperlinkCheckboxElement=(0,a.createElement)("input",{id:"hyperlinkdiv",styles:"width:12px;height:12px",className:"e-de-prop-sub-label"}),this.hyperlinkDiv.appendChild(this.hyperlinkCheckboxElement),this.hyperlink=new tl.CheckBox({label:this.localObj.getConstant("Use hyperlinks"),enableRtl:this.isRtl}),this.hyperlink.appendTo(this.hyperlinkCheckboxElement)},e.prototype.buttonDiv=function(e){var t;t=this.isRtl?"float:left":"float:right",this.footerElement=(0,a.createElement)("div",{id:"footerDiv",styles:t}),e.appendChild(this.footerElement),this.updatebuttoncontentStyleElement=(0,a.createElement)("button",{id:"footerupdatebuttonDiv",attrs:{type:"button"}}),this.footerElement.appendChild(this.updatebuttoncontentStyleElement),this.updateBtn=new tl.Button({content:this.localObj.getConstant("Update"),cssClass:"btn-update",isPrimary:!0}),this.updateBtn.appendTo(this.updatebuttoncontentStyleElement),this.cancelbuttoncontentStyleElement=(0,a.createElement)("button",{id:"footercancelbuttonDiv",attrs:{type:"button"}}),this.footerElement.appendChild(this.cancelbuttoncontentStyleElement),this.cancelBtn=new tl.Button({content:this.localObj.getConstant("Cancel"),cssClass:this.isRtl?"e-de-btn-cancel-rtl":"e-de-btn-cancel"}),this.cancelbuttoncontentStyleElement.setAttribute("aria-label",this.cancelBtn.content),this.cancelBtn.appendTo(this.cancelbuttoncontentStyleElement)},e.prototype.enableDisableInsertButton=function(e){"Text"===this.prevContext?this.updateBtn.disabled=e:this.updateBtn.disabled=!1},e.prototype.showTocPane=function(e,t){if(!e&&"none"===this.element.style.display||e&&"block"===this.element.style.display)this.updateBtn&&this.enableDisableInsertButton(!1);else{if(this.element.style.display=e?"block":"none",this.updateBtn.content="TableOfContents"===this.documentEditor.selectionModule.contextType?this.localObj.getConstant("Update"):this.localObj.getConstant("Insert"),this.updateBtn.element.setAttribute("aria-label",this.updateBtn.content),this.prevContext=this.documentEditor.selectionModule.contextType,"TableOfContents"===this.documentEditor.selectionModule.contextType){var i=this.documentEditor.selectionModule.getTocFieldInternal(),n=this.documentEditor.selectionModule.getFieldCode(i);if(-1!==n.toLocaleLowerCase().indexOf("toc")&&!(0,a.isNullOrUndefined)(this.documentEditor.editorModule)){var r=this.documentEditor.editorModule.getTocSettings(n,i);this.borderLevelStyle.value=r.endLevel.toString()}}else this.borderLevelStyle.value="3";this.enableDisableInsertButton(this.documentEditor.selectionModule.isPlainContentControl()),this.documentEditor.resize(),e&&this.documentEditor.enableAutoFocus&&this.updateBtn.element.focus()}},e.prototype.onInsertToc=function(){var e={startLevel:1,endLevel:parseInt(this.borderLevelStyle.value,0),includeHyperlink:this.hyperlink.checked,includeOutlineLevels:!0,includePageNumber:this.showPageNumber.checked,rightAlign:this.rightalignPageNumber.checked};e.rightAlign&&(e.tabLeader="Dot"),this.documentEditor.editorModule.insertTableOfContents(e),this.documentEditor.focusIn()},e.prototype.destroy=function(){this.container=void 0,this.removeHTMLDOM(),this.unWireEvents(),this.showPageNumber&&(this.showPageNumber.destroy(),this.showPageNumber=void 0),this.rightalignPageNumber&&(this.rightalignPageNumber.destroy(),this.rightalignPageNumber=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn=void 0),this.borderLevelStyle&&(this.borderLevelStyle.destroy(),this.borderLevelStyle=void 0),this.hyperlink&&this.hyperlink.destroy(),this.hyperlink=void 0,this.updateBtn&&this.updateBtn.destroy(),this.updateBtn=void 0,this.cancelBtn&&this.cancelBtn.destroy(),this.cancelBtn=void 0,this.localObj=void 0,this.isRtl=void 0,this.element&&(this.element.innerHTML="",this.element=void 0)},e.prototype.unWireEvents=function(){this.cancelBtn.element.removeEventListener("click",this.onCloseClickHook),this.updateBtn.element.removeEventListener("click",this.onInsertToClickHook),this.closeButton.removeEventListener("click",this.onCloseClickHook),this.onCloseClickHook=void 0,this.onInsertToClickHook=void 0},e.prototype.removeHTMLDOM=function(){this.template1Div.remove(),this.headerDiv.remove(),this.closeButton.remove(),this.title.remove(),this.templateContent1.remove(),this.templateContent2.remove(),this.templateContent3.remove(),this.optionsDiv.remove(),this.label.remove(),this.contentStyleElement.remove(),this.checkboxElement.remove(),this.showPageNumberDiv.remove(),this.showpagenumberCheckboxElement.remove(),this.rightAlignDiv.remove(),this.rightalignpagenumberCheckboxElement.remove(),this.hyperlinkDiv.remove(),this.hyperlinkCheckboxElement.remove(),this.footerElement.remove(),this.updatebuttoncontentStyleElement.remove(),this.cancelbuttoncontentStyleElement.remove()},e}(),ku=function(){function e(e,t){var i=this;this.isRetrieving=!1,this.appliedHighlightColor="rgb(255, 255, 0)",this.createChangecase=function(e){var t=[{text:i.localObj.getConstant("SentenceCase"),id:"sentencecase"},{text:i.localObj.getConstant("UPPERCASE"),id:"uppercase"},{text:i.localObj.getConstant("Lowercase"),id:"lowercase"},{text:i.localObj.getConstant("CapitalizeEachWord"),id:"capitalizeEachWord"},{text:i.localObj.getConstant("ToggleCase"),id:"togglecase"}];i.changeCaseDropdown=new pl.DropDownButton({items:t,iconCss:"e-icons e-de-ctnr-change-case",enableRtl:i.isRtl});var n=(0,a.createElement)("div",{id:e.id+"_changeCase",className:"e-de-ctnr-group-btn"}),r=(0,a.createElement)("button",{id:n.id+"_dropdownBtn",attrs:{type:"button"}});n.appendChild(r),e.appendChild(n),i.changeCaseDropdown.appendTo(r)},this.changeCase=function(e){if(!i.isRetrieving)switch(e.item.id){case"sentencecase":!i.documentEditor.isReadOnly&&i.documentEditor.editorModule&&i.documentEditor.editorModule.changeCase("SentenceCase");break;case"uppercase":!i.documentEditor.isReadOnly&&i.documentEditor.editorModule&&i.documentEditor.editorModule.changeCase("Uppercase");break;case"lowercase":!i.documentEditor.isReadOnly&&i.documentEditor.editorModule&&i.documentEditor.editorModule.changeCase("Lowercase");break;case"capitalizeEachWord":!i.documentEditor.isReadOnly&&i.documentEditor.editorModule&&i.documentEditor.editorModule.changeCase("CapitalizeEachWord");break;case"togglecase":!i.documentEditor.isReadOnly&&i.documentEditor.editorModule&&i.documentEditor.editorModule.changeCase("ToggleCase")}},this.container=e,this.isRtl=t}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.initializeTextPropertiesDiv=function(e,t){this.localObj=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.textProperties=e;var i=this.documentEditor.element.id+"_font_properties",n=this.createDiv(i+"_text",e);(0,a.classList)(n,["e-de-cntr-pane-padding","e-de-prop-separator-line"],[]);var r=this.createDiv(i+"_sizeStyle",n,"display:inline-flex;");(0,a.classList)(r,["e-de-ctnr-segment"],[]),t&&(0,a.classList)(r,["e-de-ctnr-segment-rtl"],[]);var o=this.createDiv(i+"_fontFamilyDiv",r),s=(0,a.createElement)("input",{id:i+"_fontFamily",className:"e-prop-font-style"});o.appendChild(s),(0,a.classList)(o,["e-de-panel-left-width"],[]),this.createDropDownListForFamily(s);var l=this.createDiv(i+"_fontSizeDiv",r),d="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group";t&&(d="e-rtl "+d);var h=(0,a.createElement)("input",{id:i+"_fontSize",innerHTML:"type:number",className:"e-prop-font-style"});l.appendChild(h),(0,a.classList)(l,["e-de-panel-right-width"],[]),this.createDropDownListForSize(h);var c=(0,a.createElement)("div",{id:i+"_properties",styles:"display:inline-flex;",className:"e-de-ctnr-segment"});t&&(0,a.classList)(c,["e-de-ctnr-segment-rtl"],[]),n.appendChild(c);var p=(0,a.createElement)("div",{id:i+"_leftDiv",className:d,styles:"display:inline-flex;"});c.appendChild(p),this.bold=this.createButtonTemplate(i+"_bold","e-de-ctnr-bold e-icons",p,"e-de-prop-font-button","40.5","Bold Tooltip"),this.italic=this.createButtonTemplate(i+"_italic","e-de-ctnr-italic e-icons",p,"e-de-prop-font-button","40.5","Italic Tooltip"),this.underline=this.createButtonTemplate(i+"_underline","e-de-ctnr-underline e-icons",p,"e-de-prop-font-button","40.5","Underline Tooltip"),this.strikethrough=this.createButtonTemplate(i+"_strikethrough","e-de-ctnr-strikethrough e-icons",p,"e-de-prop-font-last-button","40.5","Strikethrough"),d="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",t&&(d="e-rtl "+d);var u=(0,a.createElement)("div",{id:i+"_rightDiv",className:d,styles:"display:inline-flex;"});c.appendChild(u),this.superscript=this.createButtonTemplate(i+"_superscript","e-de-ctnr-superscript e-icons",u,"e-de-prop-font-button","38.5","Superscript Tooltip"),this.subscript=this.createButtonTemplate(i+"_subscript","e-de-ctnr-subscript e-icons",u,"e-de-prop-font-last-button","38.5","Subscript Tooltip");var g=(0,a.createElement)("div",{id:i+"_colorDiv",styles:"display:inline-flex;",className:"e-de-ctnr-segment"});t&&(0,a.classList)(c,["e-de-ctnr-segment-rtl"],[]);var m=(0,a.createElement)("div",{id:i+"_color",className:"e-de-font-clr-picker e-de-ctnr-group-btn",styles:"display:inline-flex;"});t&&(0,a.classList)(m,["e-rtl"],[]),g.appendChild(m),n.appendChild(g),this.fontColor=this.createFontColorPicker(i+"_textColor",40.5,m,this.localObj.getConstant("Font color")),(0,a.classList)(m.firstElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-fontcolor","e-icons"],["e-caret"]),this.initializeHighlightColorElement(),this.highlightColor=this.createHighlightColorSplitButton(i+"_highlightColor",34.5,m,this.localObj.getConstant("Text highlight color")),(0,a.classList)(this.highlightColor.element.nextElementSibling.firstElementChild,["e-de-ctnr-highlight","e-icons"],["e-caret"]),this.highlightColorInputElement=this.highlightColor.element.firstChild,this.clearFormat=this.createButtonTemplate(i+"_clearFormat","e-de-ctnr-clearall e-icons",m,"e-de-prop-font-last-button","40.5","Clear all formatting");var f=(0,a.createElement)("div",{id:i+"_rightDiv2",className:d.replace("e-btn-group",""),styles:"display:inline-flex;"});t&&(0,a.classList)(f,["e-rtl"],[]),f.setAttribute("title",this.container.localObj.getConstant("Change case Tooltip")),n.appendChild(f),this.createChangecase(f)},e.prototype.createHighlightColorSplitButton=function(e,t,i,n){var r=this,o=(0,a.createElement)("button",{id:e,attrs:{type:"button"}});i.appendChild(o);var s=new pl.SplitButton({cssClass:"e-de-btn-hghlclr",iconCss:"e-de-ctnr-hglt-color",target:this.highlightColorElement,close:this.closePopup.bind(this),beforeOpen:this.openPopup.bind(this),enableRtl:this.isRtl});return s.appendTo(o),s.click=function(){r.applyHighlightColor(r.highlightColorInputElement.style.backgroundColor)},s.element.firstChild.style.backgroundColor="rgb(255, 255, 0)",s.element.parentElement.setAttribute("title",n),s.element.parentElement.setAttribute("aria-label",n),s},e.prototype.openPopup=function(){this.highlightColorElement.style.display="block"},e.prototype.closePopup=function(){this.highlightColorElement.style.display="none"},e.prototype.initializeHighlightColorElement=function(){this.highlightColorElement=(0,a.createElement)("div",{styles:"display:none;width:157px",className:"e-de-cntr-highlight-pane"});var e=this.createHightlighColorPickerDiv("#ffff00","yellowDiv"),t=this.createHightlighColorPickerDiv("#00ff00","brightGreenDiv"),i=this.createHightlighColorPickerDiv("#00ffff","turquoiseDiv"),n=this.createHightlighColorPickerDiv("#ff00ff","hotPinkDiv"),r=this.createHightlighColorPickerDiv("#0000ff","blueDiv"),o=this.createHightlighColorPickerDiv("#ff0000","redDiv"),s=this.createHightlighColorPickerDiv("#000080","darkBlueDiv"),l=this.createHightlighColorPickerDiv("#008080","tealDiv"),d=this.createHightlighColorPickerDiv("#008000","greenDiv"),h=this.createHightlighColorPickerDiv("#800080","violetDiv"),c=this.createHightlighColorPickerDiv("#800000","darkRedDiv"),p=this.createHightlighColorPickerDiv("#808000","darkYellowDiv"),u=this.createHightlighColorPickerDiv("#808080","gray50Div"),g=this.createHightlighColorPickerDiv("#c0c0c0","gray25Div"),m=this.createHightlighColorPickerDiv("#000000","blackDiv"),f=(0,a.createElement)("div",{className:"e-hglt-no-color"});this.highlightColorElement.appendChild(f);var v=(0,a.createElement)("div",{styles:"width:24px;height:24px;background-color:#ffffff;margin:3px;",id:"noColorDiv"});f.appendChild(v);var y=(0,a.createElement)("div",{innerHTML:this.localObj.getConstant("No color"),className:"e-de-ctnr-hglt-no-color"});v.appendChild(y),e.addEventListener("click",this.onHighLightColor.bind(this)),t.addEventListener("click",this.onHighLightColor.bind(this)),i.addEventListener("click",this.onHighLightColor.bind(this)),n.addEventListener("click",this.onHighLightColor.bind(this)),r.addEventListener("click",this.onHighLightColor.bind(this)),o.addEventListener("click",this.onHighLightColor.bind(this)),s.addEventListener("click",this.onHighLightColor.bind(this)),l.addEventListener("click",this.onHighLightColor.bind(this)),d.addEventListener("click",this.onHighLightColor.bind(this)),h.addEventListener("click",this.onHighLightColor.bind(this)),c.addEventListener("click",this.onHighLightColor.bind(this)),p.addEventListener("click",this.onHighLightColor.bind(this)),u.addEventListener("click",this.onHighLightColor.bind(this)),g.addEventListener("click",this.onHighLightColor.bind(this)),m.addEventListener("click",this.onHighLightColor.bind(this)),f.addEventListener("click",this.onHighLightColor.bind(this))},e.prototype.createHightlighColorPickerDiv=function(e,t){var i=(0,a.createElement)("div",{className:"e-de-ctnr-hglt-btn",id:t});return i.style.backgroundColor=e,this.highlightColorElement.appendChild(i),i},e.prototype.onHighLightColor=function(e){this.documentEditor.selectionModule&&(this.applyHighlightColor(e.currentTarget.style.backgroundColor),this.highlightColor.toggle())},e.prototype.applyHighlightColorAsBackground=function(e){this.removeSelectedColorDiv(),"NoColor"===e?this.highlightColorElement.querySelector("#noColorDiv").classList.add("e-color-selected"):"Yellow"===e?this.highlightColorElement.querySelector("#yellowDiv").classList.add("e-color-selected"):"BrightGreen"===e?this.highlightColorElement.querySelector("#brightGreenDiv").classList.add("e-color-selected"):"Turquoise"===e?this.highlightColorElement.querySelector("#turquoiseDiv").classList.add("e-color-selected"):"Pink"===e?this.highlightColorElement.querySelector("#hotPinkDiv").classList.add("e-color-selected"):"Red"===e?this.highlightColorElement.querySelector("#redDiv").classList.add("e-color-selected"):"DarkBlue"===e?this.highlightColorElement.querySelector("#darkBlueDiv").classList.add("e-color-selected"):"Teal"===e?this.highlightColorElement.querySelector("#tealDiv").classList.add("e-color-selected"):"Green"===e?this.highlightColorElement.querySelector("#greenDiv").classList.add("e-color-selected"):"Violet"===e?this.highlightColorElement.querySelector("#violetDiv").classList.add("e-color-selected"):"DarkRed"===e?this.highlightColorElement.querySelector("#darkRedDiv").classList.add("e-color-selected"):"DarkYellow"===e?this.highlightColorElement.querySelector("#darkYellowDiv").classList.add("e-color-selected"):"Gray50"===e?this.highlightColorElement.querySelector("#gray50Div").classList.add("e-color-selected"):"Gray25"===e?this.highlightColorElement.querySelector("#gray25Div").classList.add("e-color-selected"):"Black"===e?this.highlightColorElement.querySelector("#blackDiv").classList.add("e-color-selected"):"Blue"===e&&this.highlightColorElement.querySelector("#blueDiv").classList.add("e-color-selected")},e.prototype.removeSelectedColorDiv=function(){this.highlightColorElement.querySelector("#noColorDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#yellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#brightGreenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#turquoiseDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#hotPinkDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#redDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkBlueDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#tealDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#greenDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#violetDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkRedDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#darkYellowDiv").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray50Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#gray25Div").classList.remove("e-color-selected"),this.highlightColorElement.querySelector("#blackDiv").classList.remove("e-color-selected")},e.prototype.applyHighlightColor=function(e){this.appliedHighlightColor=e;var t=this.getHighLightColor(e);"NoColor"===t&&(this.documentEditor.selectionModule.characterFormat.highlightColor=null),this.documentEditor.selectionModule.characterFormat.highlightColor=t,this.documentEditor.focusIn()},e.prototype.getHighLightColor=function(e){switch(e){case"rgb(255, 255, 0)":return"Yellow";case"rgb(0, 255, 0)":return"BrightGreen";case"rgb(0, 255, 255)":return"Turquoise";case"rgb(255, 0, 255)":return"Pink";case"rgb(0, 0, 255)":return"Blue";case"rgb(255, 0, 0)":return"Red";case"rgb(0, 0, 128)":return"DarkBlue";case"rgb(0, 128, 128)":return"Teal";case"rgb(0, 128, 0)":return"Green";case"rgb(128, 0, 128)":return"Violet";case"rgb(128, 0, 0)":return"DarkRed";case"rgb(128, 128, 0)":return"DarkYellow";case"rgb(128, 128, 128)":return"Gray50";case"rgb(192, 192, 192)":return"Gray25";case"rgb(0, 0, 0)":return"Black";default:return"NoColor"}},e.prototype.createDiv=function(e,t,i){var n;return n=i?(0,a.createElement)("div",{id:e,styles:i}):(0,a.createElement)("div",{id:e}),t.appendChild(n),n},e.prototype.createButtonTemplate=function(e,t,i,n,r,o){var s=(0,a.createElement)("Button",{id:e,attrs:{type:"button"}});i.appendChild(s);var l=new tl.Button({cssClass:n,iconCss:t,enableRtl:this.isRtl});switch(l.appendTo(s),s.setAttribute("title",this.localObj.getConstant(o)),s.setAttribute("aria-label",this.localObj.getConstant(o)),s.setAttribute("aria-pressed","false"),o){case"Bold Tooltip":this.boldBtn=l;break;case"Italic Tooltip":this.italicBtn=l;break;case"Underline Tooltip":this.underlineBtn=l;break;case"Strikethrough":this.strikethroughBtn=l;break;case"Superscript Tooltip":this.superscriptBtn=l;break;case"Subscript Tooltip":this.subscriptBtn=l;break;default:this.clearFormatBtn=l}return s},e.prototype.createFontColorPicker=function(e,t,i,n){var r=this.documentEditor.documentEditorSettings.colorPickerSettings,o=r.columns,s=r.createPopupOnClick,l=r.cssClass,d=r.disabled,h=r.enablePersistence,c=r.inline,p=r.mode,u=r.modeSwitcher,g=r.noColor,m=r.presetColors,f=r.showButtons,v=(0,a.createElement)("input",{id:e,attrs:{type:"color"}});return v.style.width=t+"px",i.appendChild(v),this.fontColorInputElement=new rl.ColorPicker({value:"#000000",enableRtl:this.isRtl,locale:this.container.locale,enableOpacity:!1,mode:p,modeSwitcher:u,showButtons:f,columns:o,createPopupOnClick:s,cssClass:l,disabled:d,enablePersistence:h,inline:c,noColor:g,presetColors:m},v),this.fontColorInputElement.element.parentElement.setAttribute("title",n),this.fontColorInputElement.element.parentElement.setAttribute("aria-label",n),this.documentEditor.documentHelper.fontColorInputElement=this.fontColorInputElement,v},e.prototype.createDropDownListForSize=function(e){var t=this;this.fontSize=new al.ComboBox({dataSource:["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72","96"],popupHeight:"180px",popupWidth:"80px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl}),this.fontSize.focus=function(){t.isRetrieving=!1,t.fontSize.element.select()};var i=this.documentEditor.selectionModule.characterFormat;this.fontSize.value=i.bidi||i.complexScript?i.fontSizeBidi.toString():i.fontSize.toString(),this.fontSize.appendTo(e),this.fontSize.element.parentElement.setAttribute("title",this.localObj.getConstant("Font Size"))},e.prototype.createDropDownListForFamily=function(e){var t=this,i=!1,n="";this.container.enableCsp||(n=(0,a.initializeCSPTemplate)((function(e){return'<span style="font-family: '+e.FontName+';">'+e.FontName+"</span>"})),i=!0),this.fontFamily=new al.ComboBox({dataSource:undefined,query:(new jh.Query).select(["FontName"]),fields:{text:"FontName",value:"FontValue"},popupHeight:"150px",cssClass:"e-de-prop-dropdown",allowCustom:!0,showClearButton:!1,enableRtl:this.isRtl,itemTemplate:n}),this.fontFamily.appendTo(e),this.fontFamily.isStringTemplate=i;for(var r=this.container.documentEditorSettings.fontFamilies,o=0;o<r.length;o++){var s=r[o],l={FontName:s,FontValue:s};this.fontFamily.addItem(l,o)}this.fontFamily.focus=function(){t.isRetrieving=!1,t.fontFamily.element.select()},this.fontFamily.element.parentElement.setAttribute("title",this.localObj.getConstant("Font"))},e.prototype.wireEvent=function(){var e=this;this.fontFamily.addEventListener("change",(function(){e.changeFontFamily()})),this.fontSize.addEventListener("change",(function(){e.changeFontSize()})),this.bold.addEventListener("click",(function(){e.isRetrieving=!1,e.boldAction()})),this.italic.addEventListener("click",(function(){e.isRetrieving=!1,e.italicAction()})),this.underline.addEventListener("click",(function(){e.isRetrieving=!1,e.underlineAction()})),this.strikethrough.addEventListener("click",(function(){e.isRetrieving=!1,e.strikethroughAction()})),this.superscript.addEventListener("click",(function(){e.isRetrieving=!1,e.superscriptAction()})),this.subscript.addEventListener("click",(function(){e.isRetrieving=!1,e.subscriptAction()})),this.fontColorInputElement.addEventListener("change",(function(t){e.isRetrieving=!1,e.changeFontColor(t)})),this.clearFormat.addEventListener("click",(function(){e.isRetrieving=!1,e.clearFormatAction()})),this.changeCaseDropdown.addEventListener("select",(function(t){e.isRetrieving=!1,e.changeCase(t)}))},e.prototype.unwireEvents=function(){this.fontFamily.change=void 0,this.fontSize.change=void 0,this.bold.click=void 0,this.italic.click=void 0,this.underline.click=void 0,this.strikethrough.click=void 0,this.superscript.click=void 0,this.subscript.click=void 0,this.fontColorInputElement.change=void 0,this.highlightColorElement.click=void 0,this.highlightColor.click=void 0,this.clearFormat.click=void 0,this.changeCaseDropdown.select=void 0},e.prototype.boldAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleBold(),this.documentEditor.focusIn())},e.prototype.italicAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleItalic(),this.documentEditor.focusIn())},e.prototype.underlineAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleUnderline("Single"),this.documentEditor.focusIn())},e.prototype.strikethroughAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleStrikethrough(),this.documentEditor.focusIn())},e.prototype.clearFormatAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&this.documentEditor.editorModule.clearFormatting()},e.prototype.subscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleSubscript(),this.documentEditor.focusIn())},e.prototype.superscriptAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleSuperscript(),this.documentEditor.focusIn())},e.prototype.changeFontColor=function(e){var t=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selectionModule&&(this.documentEditor.selectionModule.characterFormat.fontColor=e.currentValue.hex,setTimeout((function(){t.documentEditor.focusIn()}),30))},e.prototype.changeFontFamily=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selectionModule&&""!==this.fontFamily.value&&(setTimeout((function(){e.documentEditor.selectionModule.characterFormat.fontFamily=a.SanitizeHtmlHelper.sanitize(e.fontFamily.value)}),10),this.documentEditor.focusIn())},e.prototype.changeFontSize=function(){var e=this;this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.selectionModule&&""!==this.fontSize.value&&(setTimeout((function(){e.documentEditor.selectionModule.characterFormat.fontSize=e.fontSize.value}),10),this.documentEditor.focusIn())},e.prototype.onSelectionChange=function(){if(this.isRetrieving=!0,this.documentEditor.selectionModule){if(this.documentEditor.selectionModule.characterFormat.fontFamily){var e=void 0;if(e=(0,a.isNullOrUndefined)(this.documentEditor.selectionModule.characterFormat.renderedFontFamily)||(0,a.isNullOrUndefined)(this.documentEditor.selectionModule.characterFormat.fontFamily)?this.documentEditor.selectionModule.characterFormat.fontFamily:this.documentEditor.selectionModule.characterFormat.renderedFontFamily,this.fontFamily.value=e,this.fontFamily.dataBind(),(0,a.isNullOrUndefined)(this.fontFamily.getDataByValue(e))){var t={FontName:e,FontValue:e};this.fontFamily.addItem(t)}}else this.fontFamily.value="";if(this.documentEditor.selectionModule.characterFormat.fontSize){var i=this.documentEditor.selectionModule.characterFormat;this.fontSize.value=i.bidi||i.complexScript?(0,a.isNullOrUndefined)(i.fontSizeBidi)?"":i.fontSizeBidi.toString():i.fontSize.toString(),this.fontSize.dataBind()}else this.fontSize.value="";if(this.documentEditor.selectionModule.characterFormat.bold?this.bold.classList.contains("e-btn-toggle")||(this.bold.classList.add("e-btn-toggle"),this.bold.setAttribute("aria-pressed","true")):this.bold.classList.contains("e-btn-toggle")&&(this.bold.classList.remove("e-btn-toggle"),this.bold.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.italic?this.italic.classList.contains("e-btn-toggle")||(this.italic.classList.add("e-btn-toggle"),this.italic.setAttribute("aria-pressed","true")):this.italic.classList.contains("e-btn-toggle")&&(this.italic.classList.remove("e-btn-toggle"),this.italic.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.underline&&"None"!==this.documentEditor.selectionModule.characterFormat.underline?this.underline.classList.contains("e-btn-toggle")||(this.underline.classList.add("e-btn-toggle"),this.underline.setAttribute("aria-pressed","true")):this.underline.classList.contains("e-btn-toggle")&&(this.underline.classList.remove("e-btn-toggle"),this.underline.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.strikethrough&&"None"!==this.documentEditor.selectionModule.characterFormat.strikethrough?this.strikethrough.classList.contains("e-btn-toggle")||(this.strikethrough.classList.add("e-btn-toggle"),this.strikethrough.setAttribute("aria-pressed","true")):this.strikethrough.classList.contains("e-btn-toggle")&&(this.strikethrough.classList.remove("e-btn-toggle"),this.strikethrough.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.baselineAlignment&&"Subscript"===this.documentEditor.selectionModule.characterFormat.baselineAlignment?this.subscript.classList.contains("e-btn-toggle")||(this.subscript.classList.add("e-btn-toggle"),this.subscript.setAttribute("aria-pressed","true")):this.subscript.classList.contains("e-btn-toggle")&&(this.subscript.classList.remove("e-btn-toggle"),this.subscript.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.baselineAlignment&&"Superscript"===this.documentEditor.selectionModule.characterFormat.baselineAlignment?this.superscript.classList.contains("e-btn-toggle")||(this.superscript.classList.add("e-btn-toggle"),this.superscript.setAttribute("aria-pressed","true")):this.superscript.classList.contains("e-btn-toggle")&&(this.superscript.classList.remove("e-btn-toggle"),this.superscript.setAttribute("aria-pressed","false")),this.documentEditor.selectionModule.characterFormat.fontColor){var n=this.documentEditor.selectionModule.characterFormat.fontColor;"empty"!==n&&"#00000000"!==n||(n="#000000"),this.fontColorInputElement.value=n}this.documentEditor.selectionModule.characterFormat.highlightColor&&(this.highlightColorInputElement.style.backgroundColor=this.appliedHighlightColor,this.applyHighlightColorAsBackground(this.documentEditor.selectionModule.characterFormat.highlightColor))}},e.prototype.removeHTMLElement=function(){var e=this;this.bold.remove(),this.bold=null,this.italic.remove(),this.italic=null,this.underline.remove(),this.underline=null,this.strikethrough.remove(),this.strikethrough=null,this.subscript.remove(),this.subscript=null,this.superscript.remove(),this.superscript=null,this.clearFormat.remove(),this.clearFormat=null,this.fontColor.remove(),this.fontColor=null,this.highlightColorInputElement.childNodes.forEach((function(t){e.highlightColorInputElement.removeChild(t)})),this.highlightColorInputElement.remove(),this.highlightColorInputElement=null,this.highlightColorElement.childNodes.forEach((function(t){e.highlightColorElement.removeChild(t)})),this.highlightColorElement.remove(),this.highlightColorElement=null},e.prototype.destroy=function(){this.unwireEvents(),this.removeHTMLElement(),this.highlightColor&&(this.highlightColor.destroy(),this.highlightColor=void 0),this.fontColorInputElement&&(this.fontColorInputElement.destroy(),this.fontColorInputElement.element.remove(),this.fontColorInputElement.element=null,this.fontColorInputElement=void 0),this.fontSize&&(this.fontSize.destroy(),this.fontSize.element&&(this.fontSize.element.remove(),this.fontSize.element=void 0),this.fontSize=void 0),this.fontFamily&&(this.fontFamily.destroy(),this.fontFamily.element&&(this.fontFamily.element.remove(),this.fontFamily.element=void 0),this.fontFamily=void 0),this.changeCaseDropdown&&(this.changeCaseDropdown.destroy(),this.changeCaseDropdown=void 0),this.boldBtn&&(this.boldBtn.destroy(),this.boldBtn=void 0),this.italicBtn&&(this.italicBtn.destroy(),this.italicBtn=void 0),this.underlineBtn&&(this.underlineBtn.destroy(),this.underlineBtn=void 0),this.strikethroughBtn&&(this.strikethroughBtn.destroy(),this.strikethroughBtn=void 0),this.subscriptBtn&&(this.subscriptBtn.destroy(),this.subscriptBtn=void 0),this.superscriptBtn&&(this.superscriptBtn.destroy(),this.superscriptBtn=void 0),this.clearFormatBtn&&(this.clearFormatBtn.destroy(),this.clearFormatBtn=void 0),this.container=void 0},e}(),Fu=function(){function e(e){this.numberedAndBulletNoneClickHandler=this.numberedNoneClick.bind(this),this.numberedNumberDotClickHandler=this.numberedNumberDotClick.bind(this),this.numberedLowLetterClickHandler=this.numberedLowLetterClick.bind(this),this.numberedUpLetterClickHandler=this.numberedUpLetterClick.bind(this),this.numberedLowRomanClickHandler=this.numberedLowRomanClick.bind(this),this.numberedUpRomanClickHandler=this.numberedUpRomanClick.bind(this),this.numberSplitButtonBeforeOpenHandler=this.numberSplitButtonBeforeOpen.bind(this),this.bulletDotClickHandler=this.bulletDotClick.bind(this),this.bulletCircleClickHandler=this.bulletCircleClick.bind(this),this.bulletSquareClickHandler=this.bulletSquareClick.bind(this),this.bulletFlowerClickHandler=this.bulletFlowerClick.bind(this),this.bulletArrowClickHandler=this.bulletArrowClick.bind(this),this.bulletTickClickHandler=this.bulletTickClick.bind(this),this.onrightAlignmentClickHandler=this.onrightAlignmentClick.bind(this),this.isRetrieving=!1,this.appliedBulletStyle="dot",this.appliedNumberingStyle="arabic",this.appliedLineSpacing="",this.splitButtonClass="e-de-prop-splitbutton",this.container=e}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.initializeParagraphPropertiesDiv=function(e,t){this.localObj=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.isRtl=t,this.isRtl&&(this.splitButtonClass="e-rtl "+this.splitButtonClass),this.textProperties=e;var i=this.documentEditor.element.id+"_font_properties";this.paragraphDiv=this.createDivElement(i+"_paragraph",e,""),(0,a.classList)(this.paragraphDiv,["e-de-cntr-pane-padding"],[]),this.label=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"}),this.label.innerHTML=this.localObj.getConstant("Paragraph"),this.paragraphDiv.appendChild(this.label),this.styleDiv=this.createDivElement(i+"_styleDiv",this.paragraphDiv),this.styleDiv.classList.add("e-de-ctnr-segment","e-de-ctnr-style-div"),this.styleSelect=(0,a.createElement)("input",{id:i+"_style",styles:"width:248px;letter-spacing: 0.05px;"}),this.styleDiv.appendChild(this.styleSelect),this.createStyleDropDownList(this.styleSelect),this.indentWholeDiv=this.createDivElement(i+"_indentWholeDiv",this.paragraphDiv),this.indentWholeDiv.style.display="flex",this.indentWholeDiv.classList.add("e-de-ctnr-segment"),t&&(0,a.classList)(this.indentWholeDiv,["e-de-ctnr-segment-rtl"],[]),this.indentDiv=this.createDivElement(i+"_indentDiv",this.indentWholeDiv,"display:flex;");var n="e-de-ctnr-group-btn e-de-char-fmt-btn-left e-btn-group";t&&(n="e-rtl "+n),this.indentDiv.className=n,this.leftAlignment=this.createButtonTemplate(i+"_leftIndent","e-de-ctnr-alignleft e-icons",this.indentDiv,"e-de-prop-indent-button","40.5","Align left Tooltip"),this.centerAlignment=this.createButtonTemplate(i+"_centerIndent","e-de-ctnr-aligncenter e-icons",this.indentDiv,"e-de-prop-indent-button","40.5","Center Tooltip"),this.rightAlignment=this.createButtonTemplate(i+"_rightIndent","e-de-ctnr-alignright e-icons",this.indentDiv,"e-de-prop-indent-button","40.5","Align right Tooltip"),this.justify=this.createButtonTemplate(i+"_justify","e-de-ctnr-justify e-icons",this.indentDiv,"e-de-prop-indent-last-button","40.5","Justify Tooltip");var r="e-de-ctnr-increaseindent e-icons",o="e-de-ctnr-decreaseindent e-icons";this.incDecIndentDiv=this.createDivElement(i+"_lineindentDiv",this.indentWholeDiv,"display:flex;"),n="e-de-ctnr-group-btn e-de-char-fmt-btn-right e-btn-group",t&&(n="e-rtl "+n,r+=" e-de-flip",o+=" e-de-flip"),this.incDecIndentDiv.className=n,this.decreaseIndent=this.createButtonTemplate(i+"_decreaseIndent",o,this.incDecIndentDiv,"e-de-prop-indent-button","37","Decrease indent"),this.increaseIndent=this.createButtonTemplate(i+"_increaseIndent",r,this.incDecIndentDiv,"e-de-prop-indent-last-button","37","Increase indent"),this.listDiv=this.createDivElement(i+"_listDiv",this.paragraphDiv,"display:flex;"),this.paraDiv=this.createDivElement(i+"_paraDiv",this.paragraphDiv,"display:flex"),(0,a.classList)(this.listDiv,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),(0,a.classList)(this.paraDiv,["e-de-ctnr-segment","e-de-ctnr-group-btn"],[]),t&&((0,a.classList)(this.listDiv,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[]),(0,a.classList)(this.paraDiv,["e-de-ctnr-segment-rtl","e-de-ctnr-group-btn"],[])),this.lineHeight=(0,a.createElement)("button",{id:i+"_lineHeight",attrs:{type:"button"}}),this.listDiv.appendChild(this.lineHeight),this.lineSpacing=this.createLineSpacingDropdown(this.lineHeight),this.listDropDown=this.createDivElement(i+"_listDropDiv",this.listDiv),(0,a.classList)(this.listDropDown,["de-split-button","e-de-ctnr-segment-list"],[]),t&&(0,a.classList)(this.listDropDown,["e-de-ctnr-segment-list-rtl"],[]),this.bulletButton=(0,a.createElement)("button",{id:i+"_bullet",attrs:{type:"button"}}),this.listDropDown.appendChild(this.bulletButton),this.numberingList=(0,a.createElement)("button",{id:i+"_numberingList",attrs:{type:"button"}}),this.listDropDown.appendChild(this.numberingList);var s="e-de-ctnr-bullets e-icons",l="e-de-ctnr-numbering e-icons";t&&(s+=" e-de-flip",l+=" e-de-flip"),this.createBulletListDropButton(s,this.bulletButton),this.createNumberListDropButton(l,this.numberingList),this.borders=this.createButtonTemplate(i+"_borders","e-de-ctnr-borders e-icons",this.paraDiv,"e-de-ctnr-group-btn","37","Borders"),this.showHiddenMarks=this.createButtonTemplate(i+"_paraMark","e-de-e-paragraph-mark e-icons",this.paraDiv,"e-de-ctnr-group-btn","37","ShowHiddenMarks Tooltip")},e.prototype.createSeparator=function(e){var t=(0,a.createElement)("div",{className:"e-de-prop-vline"});e.appendChild(t)},e.prototype.createDivElement=function(e,t,i){var n;return n=i?(0,a.createElement)("div",{id:e,styles:i}):(0,a.createElement)("div",{id:e}),t.appendChild(n),n},e.prototype.createButtonTemplate=function(e,t,i,n,r,o){var s=(0,a.createElement)("Button",{id:e,attrs:{type:"button"}});i.appendChild(s);var l=new tl.Button({cssClass:n,iconCss:t});switch(l.appendTo(s),s.setAttribute("title",this.localObj.getConstant(o)),s.setAttribute("aria-label",this.localObj.getConstant(o)),"Decrease indent"!==this.localObj.getConstant(o)&&"Increase indent"!==this.localObj.getConstant(o)&&"Borders"!==this.localObj.getConstant(o)&&s.setAttribute("aria-pressed","false"),o){case"Align left Tooltip":this.leftAlignmentBtn=l;break;case"Align right Tooltip":this.rightAlignmentBtn=l;break;case"Justify Tooltip":this.justifyBtn=l;break;case"Decrease indent":this.decreaseIndentBtn=l;break;case"Increase indent":this.increaseIndentBtn=l;break;case"Borders":this.bordersBtn=l;break;case"ShowHiddenMarks Tooltip":this.showHiddenMarksBtn=l;break;default:this.centerAlignmentBtn=l}return s},e.prototype.createLineSpacingDropdown=function(e){var t=this,i=[{text:this.localObj.getConstant("Single")},{text:"1.15"},{text:"1.5"},{text:this.localObj.getConstant("Double")}],n=new pl.DropDownButton({items:i,iconCss:"e-de-ctnr-linespacing e-icons",enableRtl:this.isRtl,select:this.lineSpacingAction.bind(this),cssClass:this.splitButtonClass,beforeItemRender:function(e){e.element.innerHTML="<span></span>"+e.item.text;var i=e.element.children[0];e.item.text===t.appliedLineSpacing?(i.style.marginRight="10px",i.setAttribute("class","e-de-selected-item e-icons e-de-linespacing")):(e.element.children[0].style.marginRight="25px",e.element.children[0].classList.remove("e-de-selected-item"))}});return n.appendTo(e),e.setAttribute("title",this.localObj.getConstant("Line spacing")),n},e.prototype.createNumberListDropButton=function(e,t){var i=this;this.numberListDropDiv=(0,a.createElement)("div",{id:"target",styles:"width: 211px;height: auto;display:none"}),this.numberListDropUlTag=(0,a.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"}),this.numberListDropDiv.appendChild(this.numberListDropUlTag),this.noneNumberTag=this.createNumberNoneListTag(this.numberListDropUlTag),this.noneNumberTag.addEventListener("click",this.numberedAndBulletNoneClickHandler),this.numberList=this.createNumberListTag(this.numberListDropUlTag,"1.","2.","3."),this.numberList.addEventListener("click",this.numberedNumberDotClickHandler),this.lowLetter=this.createNumberListTag(this.numberListDropUlTag,"a.","b.","c."),this.lowLetter.addEventListener("click",this.numberedLowLetterClickHandler),this.upLetter=this.createNumberListTag(this.numberListDropUlTag,"A.","B.","C."),this.upLetter.addEventListener("click",this.numberedUpLetterClickHandler),this.lowRoman=this.createNumberListTag(this.numberListDropUlTag,"i.","ii.","iii."),this.lowRoman.addEventListener("click",this.numberedLowRomanClickHandler),this.upRoman=this.createNumberListTag(this.numberListDropUlTag,"I.","II.","III."),this.upRoman.addEventListener("click",this.numberedUpRomanClickHandler);var n={target:this.numberListDropDiv,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:this.numberSplitButtonBeforeOpen.bind(this),beforeClose:this.numberSplitButtonBeforeClose.bind(this)};this.numberedListBtn=new pl.SplitButton(n),this.numberedListBtn.click=function(){i.applyLastAppliedNumbering()},this.numberedListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Numbering")),t.parentElement.setAttribute("aria-label",this.localObj.getConstant("Numbering"))},e.prototype.numberSplitButtonBeforeClose=function(){this.numberListDropDiv.style.display="none",this.removeSelectedList()},e.prototype.numberSplitButtonBeforeOpen=function(){this.numberListDropDiv.style.display="block";var e="None";if(!(0,a.isNullOrUndefined)(this.documentEditor.selectionModule.paragraphFormat))if((0,a.isNullOrUndefined)(this.documentEditor.selectionModule.paragraphFormat.listId)||-1===this.documentEditor.selectionModule.paragraphFormat.listId)e="None";else{var t=this.documentEditor.documentHelper.getListById(this.documentEditor.selectionModule.paragraphFormat.listId),i=this.documentEditor.documentHelper.getAbstractListById(t.abstractListId),n=this.documentEditor.selectionModule.isForward?this.documentEditor.selectionModule.start.paragraph:this.documentEditor.selectionModule.end.paragraph;e=i.levels[n.paragraphFormat.listFormat.listLevelNumber].listLevelPattern}this.updateSelectedNumberedListType(e)},e.prototype.updateSelectedBulletListType=function(e){switch(e){case String.fromCharCode(61623):this.dotBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61551)+String.fromCharCode(32):this.circleBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61607):this.squareBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61558):this.flowerBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61656):this.arrowBullet.classList.add("de-list-item-selected");break;case String.fromCharCode(61692):this.tickBullet.classList.add("de-list-item-selected");break;default:this.noneBulletTag.classList.add("de-list-item-selected")}},e.prototype.updateSelectedNumberedListType=function(e){switch(e){case"Arabic":this.numberList.classList.add("de-list-item-selected");break;case"UpRoman":this.upRoman.classList.add("de-list-item-selected");break;case"UpLetter":this.upLetter.classList.add("de-list-item-selected");break;case"LowLetter":this.lowLetter.classList.add("de-list-item-selected");break;case"LowRoman":this.lowRoman.classList.add("de-list-item-selected");break;default:this.noneNumberTag.classList.add("de-list-item-selected")}},e.prototype.removeSelectedList=function(){var e="de-list-item-selected";this.noneNumberTag.classList.remove(e),this.numberList.classList.remove(e),this.lowLetter.classList.remove(e),this.upLetter.classList.remove(e),this.lowRoman.classList.remove(e),this.upRoman.classList.remove(e),this.noneBulletTag.classList.remove(e),this.dotBullet.classList.remove(e),this.circleBullet.classList.remove(e),this.squareBullet.classList.remove(e),this.flowerBullet.classList.remove(e),this.arrowBullet.classList.remove(e),this.tickBullet.classList.remove(e)},e.prototype.applyLastAppliedNumbering=function(){switch(this.appliedNumberingStyle){case"arabic":this.numberedNumberDotClick();break;case"lowletter":this.numberedLowLetterClick();break;case"upletter":this.numberedUpLetterClick();break;case"lowroman":this.numberedLowRomanClick();break;case"uproman":this.numberedUpRomanClick()}},e.prototype.applyLastAppliedBullet=function(){switch(this.appliedBulletStyle){case"dot":this.bulletDotClick();break;case"circle":this.bulletCircleClick();break;case"square":this.bulletSquareClick();break;case"arrow":this.bulletArrowClick();break;case"tick":this.bulletTickClick();break;case"flower":this.bulletFlowerClick()}},e.prototype.createBulletListDropButton=function(e,t){var i=this,n=(0,a.createElement)("div",{id:"bullet_list",styles:"width: 196px;height: auto;display:none"}),r=(0,a.createElement)("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-floating-menu e-de-bullets-menu e-de-list-container e-de-list-thumbnail"});n.appendChild(r),this.noneBulletTag=this.createBulletListTag(r,"e-de-ctnr-bullet-none e-icons e-de-ctnr-list",!0),this.noneBulletTag.addEventListener("click",this.numberedAndBulletNoneClickHandler),this.dotBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-dot e-icons e-de-ctnr-list",!1),this.dotBullet.addEventListener("click",this.bulletDotClickHandler),this.circleBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-circle e-icons e-de-ctnr-list",!1),this.circleBullet.addEventListener("click",this.bulletCircleClickHandler),this.squareBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-square e-icons e-de-ctnr-list",!1),this.squareBullet.addEventListener("click",this.bulletSquareClickHandler),this.flowerBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-flower e-icons e-de-ctnr-list",!1),this.flowerBullet.addEventListener("click",this.bulletFlowerClickHandler),this.arrowBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-arrow e-icons e-de-ctnr-list",!1),this.arrowBullet.addEventListener("click",this.bulletArrowClickHandler),this.tickBullet=this.createBulletListTag(r,"e-de-ctnr-bullet-tick e-icons e-de-ctnr-list",!1),this.tickBullet.addEventListener("click",this.bulletTickClickHandler);var o={target:n,iconCss:e,cssClass:this.splitButtonClass,beforeOpen:function(){if(n.style.display="block",(0,a.isNullOrUndefined)(i.documentEditor.selectionModule.paragraphFormat.listId)||-1===i.documentEditor.selectionModule.paragraphFormat.listId)i.updateSelectedBulletListType(i.documentEditor.selectionModule.paragraphFormat.listText);else{var e=i.documentEditor.selectionModule.isForward?i.documentEditor.selectionModule.start.paragraph:i.documentEditor.selectionModule.end.paragraph;i.updateSelectedBulletListType(e.paragraphFormat.listFormat.listLevel.numberFormat)}},beforeClose:function(){n.style.display="none",i.removeSelectedList()}};this.bulletListBtn=new pl.SplitButton(o),this.bulletListBtn.click=function(){i.applyLastAppliedBullet()},this.bulletListBtn.appendTo(t),t.parentElement.setAttribute("title",this.localObj.getConstant("Bullets")),t.parentElement.setAttribute("aria-label",this.localObj.getConstant("Bullets"))},e.prototype.createNumberListTag=function(e,t,i,n){var r=(0,a.createElement)("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(r);var o="<div>"+t+'<span class="e-de-list-line"></span></div><div>'+i+'<span class="e-de-list-line">';o+="</span></div><div>"+n+'<span class="e-de-list-line"> </span></div >';var s=(0,a.createElement)("div",{className:"e-de-list-header-presetmenu",innerHTML:o});return r.appendChild(s),r},e.prototype.createNumberNoneListTag=function(e){var t=(0,a.createElement)("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(t);var i='<div><span class="e-de-bullets">'+this.localObj.getConstant("None")+"</span></div>",n=(0,a.createElement)("div",{className:"e-de-list-header-presetmenu",styles:"position:relative;left:11px;top:13px",innerHTML:i});return t.appendChild(n),t},e.prototype.createBulletListTag=function(e,t,i){var n=(0,a.createElement)("li",{styles:"display:block;",className:"e-de-floating-menuitem e-de-floating-bullet-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(n);var r=(0,a.createElement)("div",{className:"e-de-bullet-list-header-presetmenu"}),o=(0,a.createElement)("div",{styles:i?"font-size:8px;text-align: center;top: 8px;line-height:normal":""});r.appendChild(o);var s=(0,a.createElement)("span",{className:i?"":t});return o.appendChild(s),i&&(r.style.display="inline-table",s.textContent=this.localObj.getConstant("None")),n.appendChild(r),n},e.prototype.createStyleDropDownList=function(e){var t=this;this.style=new al.ComboBox({dataSource:[{StyleName:"Normal",IconClass:"e-de-e-paragraph-mark e-icons"}],cssClass:"e-de-prop-dropdown",popupHeight:"240px",enableRtl:this.isRtl,allowFiltering:!0,query:(new jh.Query).select(["StyleName","Style","IconClass"]),fields:{text:"StyleName",value:"StyleName"},showClearButton:!1,change:this.selectStyleValue.bind(this)});var i="";this.style.open=this.updateOptions.bind(this),this.container.enableCsp||(i=this.isRtl?(0,a.initializeCSPTemplate)((function(e){return'<span style="'+e.Style+'">'+e.StyleName+'</span><span class="'+e.IconClass+'"></span>'})):(0,a.initializeCSPTemplate)((function(e){return'<span class="'+e.IconClass+'"></span><span style="'+e.Style+'">'+e.StyleName+"</span>"})),this.style.itemTemplate=i,this.style.isStringTemplate=!0),this.style.footerTemplate=(0,a.initializeCSPTemplate)((function(e){return'<span class="e-de-ctnr-dropdown-ftr">\n                '+t.localObj.getConstant("Manage Styles")+"...</span>"})),this.style.appendTo(e),this.style.focus=function(){t.isRetrieving=!1,t.style.element.select()},e.parentElement.setAttribute("title",this.localObj.getConstant("Styles"))},e.prototype.updateOptions=function(e){e.popup.element.getElementsByClassName("e-de-ctnr-dropdown-ftr")[0].addEventListener("click",this.createStyle.bind(this))},e.prototype.updateStyleNames=function(){this.styleName=(0,a.isNullOrUndefined)(this.style.itemData)?void 0:this.style.itemData.StyleName;for(var e=this.documentEditor.documentHelper.stylesMap,t=e.get("Paragraph")?e.get("Paragraph"):[],i=e.get("Linked")?e.get("Linked"):[],n=e.get("Character")?e.get("Character"):[],r=0,o=i;r<o.length;r++)for(var s=o[r],l=0;l<n.length;l++){var d=n[l];if(s.StyleName+" Char"===d.StyleName){n.splice(l,1);break}}this.style.dataSource=t.concat(i,n),this.onSelectionChange()},e.prototype.createStyle=function(){this.style.hidePopup(),this.documentEditor.isReadOnly||this.documentEditor.showDialog("Styles")},e.prototype.constructStyleDropItems=function(e){for(var t=[],i=0,n=e;i<n.length;i++){var r=n[i],o={},s=this.localObj.getConstant(r.name);o.StyleName=""===s?r.name:s,o.Style=this.parseStyle(r.style),"Paragraph"==r.type?o.IconClass="e-list-icon e-de-listview-icon e-de-e-paragraph-style-mark e-icons":"Character"==r.type?o.IconClass="e-list-icon e-de-listview-icon e-de-e-character-style-mark e-icons":o.IconClass="e-list-icon e-de-listview-icon e-de-e-linked-style-mark e-icons",t.push(o)}return t},e.prototype.parseStyle=function(e){var t="",i=JSON.parse(e),n="";if(!(0,a.isNullOrUndefined)(i.characterFormat.baselineAlignment)&&"Normal"!==i.characterFormat.baselineAlignment){var r="";switch(i.characterFormat.baselineAlignment){case"Superscript":r="super";break;case"Subscript":r="sub"}r.length>1&&(t+="vertical-align:"+r+";")}return(0,a.isNullOrUndefined)(i.characterFormat.underline)||"None"===i.characterFormat.underline||(n+="underline "),(0,a.isNullOrUndefined)(i.characterFormat.strikethrough)||"None"===i.characterFormat.strikethrough||(n+="line-through "),(0,a.isNullOrUndefined)(i.characterFormat.fontSize)||(t+="font-size:"+i.characterFormat.fontSize+"px;"),(0,a.isNullOrUndefined)(i.characterFormat.fontFamily)||(t+="font-family:"+i.characterFormat.fontFamily+";"),!(0,a.isNullOrUndefined)(i.characterFormat.bold)&&i.characterFormat.bold&&(t+="font-weight:bold;"),!(0,a.isNullOrUndefined)(i.characterFormat.italic)&&i.characterFormat.italic&&(t+="font-style:italic;"),n.length>1&&(t+="text-decoration:"+n+";"),t},e.prototype.onrightAlignmentClick=function(){this.leftAlignmentAction()},e.prototype.wireEvent=function(){var e=this;this.leftAlignment.addEventListener("click",this.onrightAlignmentClickHandler),this.rightAlignment.addEventListener("click",(function(){e.rightAlignmentAction()})),this.centerAlignment.addEventListener("click",(function(){e.centerAlignmentAction()})),this.justify.addEventListener("click",(function(){e.justifyAction()})),this.increaseIndent.addEventListener("click",(function(){e.increaseIndentAction()})),this.showHiddenMarks.addEventListener("click",(function(){e.container.documentEditorSettings.showHiddenMarks=!e.container.documentEditorSettings.showHiddenMarks,e.toggleHiddenMarks(),setTimeout((function(){e.documentEditor.focusIn()}),30)})),this.decreaseIndent.addEventListener("click",(function(){e.decreaseIndentAction()})),this.lineSpacing.addEventListener("select",(function(t){e.lineSpacingAction(t)})),this.borders.addEventListener("click",(function(){e.documentEditor.showBordersAndShadingDialog()}))},e.prototype.unwireEvents=function(){this.leftAlignment.removeEventListener("click",this.onrightAlignmentClickHandler),this.rightAlignment.click=void 0,this.centerAlignment.click=void 0,this.justify.click=void 0,this.increaseIndent.click=void 0,this.decreaseIndent.click=void 0,this.lineSpacing.select=void 0,this.style.select=void 0},e.prototype.toggleHiddenMarks=function(){this.container.documentEditorSettings.showHiddenMarks?((0,a.classList)(this.showHiddenMarks,["e-btn-toggle"],[]),this.showHiddenMarks.setAttribute("aria-pressed","true")):((0,a.classList)(this.showHiddenMarks,[],["e-btn-toggle"]),this.showHiddenMarks.setAttribute("aria-pressed","false"))},e.prototype.leftAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Left"),this.documentEditor.focusIn())},e.prototype.lineSpacingAction=function(e){var t=this;if(!this.isRetrieving){switch(e.item.text){case this.localObj.getConstant("Single"):this.documentEditor.selectionModule.paragraphFormat.lineSpacing=1;break;case"1.15":this.documentEditor.selectionModule.paragraphFormat.lineSpacing=1.15;break;case"1.5":this.documentEditor.selectionModule.paragraphFormat.lineSpacing=1.5;break;case this.localObj.getConstant("Double"):this.documentEditor.selectionModule.paragraphFormat.lineSpacing=2}setTimeout((function(){t.documentEditor.focusIn()}),30)}},e.prototype.setLineSpacing=function(){var e=this.documentEditor.selectionModule.paragraphFormat.lineSpacing;this.appliedLineSpacing=1===e?this.localObj.getConstant("Single"):1.15===e?"1.15":1.5===e?"1.5":2===e?this.localObj.getConstant("Double"):""},e.prototype.selectStyleValue=function(e){var t=this;if(this.container){if(this.isRetrieving||!e.isInteracted)return;setTimeout((function(){t.applyStyleValue(e)}),10)}},e.prototype.applyStyleValue=function(e){if(!this.documentEditor.isReadOnly&&this.documentEditor.editorModule){var t=this.documentEditor.stylesDialogModule.getStyleName(a.SanitizeHtmlHelper.sanitize(e.itemData.StyleName));if(!(0,a.isNullOrUndefined)(this.documentEditor.documentHelper.styles.findByName(t))){this.documentEditor.editorModule.applyStyle(t,!0);var i=document.getElementById(this.documentEditor.containerId+"_treeDiv");!(0,a.isNullOrUndefined)(i)&&!(0,a.isNullOrUndefined)(this.documentEditor.optionsPaneModule)&&this.documentEditor.optionsPaneModule.isOptionsPaneShow&&this.documentEditor.optionsPaneModule.isHeadingTab&&(i.innerHTML="",this.documentEditor.optionsPaneModule.data=this.documentEditor.optionsPaneModule.dataForTreeview(),this.documentEditor.optionsPaneModule.initHeadingTab())}}},e.prototype.rightAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Right"),this.documentEditor.focusIn())},e.prototype.centerAlignmentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Center"),this.documentEditor.focusIn())},e.prototype.justifyAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.toggleTextAlignment("Justify"),this.documentEditor.focusIn())},e.prototype.increaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.increaseIndent(),this.documentEditor.focusIn())},e.prototype.decreaseIndentAction=function(){this.isRetrieving||!this.documentEditor.isReadOnly&&this.documentEditor.editorModule&&(this.documentEditor.editorModule.decreaseIndent(),this.documentEditor.focusIn())},e.prototype.numberedNoneClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.documentEditor.editorModule.clearList(),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.numberedNumberDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="arabic",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"Arabic"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.numberedUpRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="uproman",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"UpRoman"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.numberedUpLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="upletter",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"UpLetter"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.numberedLowLetterClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="lowletter",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"LowLetter"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.numberedLowRomanClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedNumberingStyle="lowroman",this.documentEditor.editorModule.applyNumbering(this.getLevelFormatNumber(),"LowRoman"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.getLevelFormatNumber=function(){var e="%";return e=e+((this.documentEditor.selectionModule.paragraphFormat.listLevelNumber<=0?0:this.documentEditor.selectionModule.paragraphFormat.listLevelNumber)+1)+"."},e.prototype.bulletDotClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="dot",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61623),"Symbol"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.bulletCircleClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="circle",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61551)+String.fromCharCode(32),"Symbol"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.bulletSquareClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="square",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61607),"Wingdings"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.bulletFlowerClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="flower",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61558),"Wingdings"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.bulletArrowClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="arrow",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61656),"Wingdings"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.bulletTickClick=function(){var e=this;this.isRetrieving||this.documentEditor.editorModule&&(this.appliedBulletStyle="tick",this.documentEditor.editorModule.applyBullet(String.fromCharCode(61692),"Wingdings"),setTimeout((function(){e.documentEditor.focusIn()}),30))},e.prototype.onSelectionChange=function(){if(this.isRetrieving=!0,this.documentEditor.editorModule){var e=this.documentEditor.selectionModule.characterFormat.styleName;if("Default Paragraph Font"===this.documentEditor.selectionModule.characterFormat.styleName&&(e=this.documentEditor.selectionModule.paragraphFormat.styleName),e){var t=this.localObj.getConstant(e);this.style.value=(0,a.isNullOrUndefined)(t)||""==t?e:t}else this.style.value=null;(0,a.classList)(this.leftAlignment,[],["e-btn-toggle"]),(0,a.classList)(this.rightAlignment,[],["e-btn-toggle"]),(0,a.classList)(this.centerAlignment,[],["e-btn-toggle"]),(0,a.classList)(this.justify,[],["e-btn-toggle"]),"Left"===this.documentEditor.selectionModule.paragraphFormat.textAlignment?((0,a.classList)(this.leftAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","true"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","false")):"Right"===this.documentEditor.selectionModule.paragraphFormat.textAlignment?((0,a.classList)(this.rightAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","true"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","false")):"Center"===this.documentEditor.selectionModule.paragraphFormat.textAlignment?((0,a.classList)(this.centerAlignment,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","true"),this.justify.setAttribute("aria-pressed","false")):"Justify"===this.documentEditor.selectionModule.paragraphFormat.textAlignment&&((0,a.classList)(this.justify,["e-btn-toggle"],[]),this.leftAlignment.setAttribute("aria-pressed","false"),this.rightAlignment.setAttribute("aria-pressed","false"),this.centerAlignment.setAttribute("aria-pressed","false"),this.justify.setAttribute("aria-pressed","true")),this.toggleHiddenMarks()}this.setLineSpacing(),this.isRetrieving=!1},e.prototype.removeHTMLElements=function(){this.leftAlignment.remove(),this.leftAlignment=null,this.rightAlignment.remove(),this.rightAlignment=null,this.centerAlignment.remove(),this.centerAlignment=null,this.justify.remove(),this.justify=null,this.increaseIndent.remove(),this.increaseIndent=null,this.decreaseIndent.remove(),this.decreaseIndent=null,this.showHiddenMarks.remove(),this.showHiddenMarks=null,this.noneNumberTag.remove(),this.noneNumberTag=null,this.numberList.remove(),this.numberList=null,this.lowLetter.remove(),this.lowLetter=null,this.upLetter.remove(),this.upLetter=null,this.lowRoman.remove(),this.lowRoman=null,this.upRoman.remove(),this.upRoman=null,this.noneBulletTag.remove(),this.noneBulletTag=null,this.dotBullet.remove(),this.dotBullet=null,this.circleBullet.remove(),this.circleBullet=null,this.squareBullet.remove(),this.squareBullet=null,this.flowerBullet.remove(),this.flowerBullet=null,this.arrowBullet.remove(),this.arrowBullet=null,this.tickBullet.remove(),this.tickBullet=null,this.borders.remove(),this.borders=null,this.paragraphDiv.remove(),this.paragraphDiv=null,this.label.remove(),this.label=null,this.indentWholeDiv.remove(),this.indentWholeDiv=null,this.indentDiv.remove(),this.indentDiv=null,this.incDecIndentDiv.remove(),this.incDecIndentDiv=null,this.listDiv.remove(),this.listDiv=null,this.paraDiv.remove(),this.paraDiv=null,this.lineHeight.remove(),this.lineHeight=null,this.listDropDown.remove(),this.listDropDown=null,this.bulletButton.remove(),this.bulletButton=null,this.numberingList.remove(),this.numberingList=null,this.numberListDropDiv.remove(),this.numberListDropDiv=null,this.numberListDropUlTag.remove(),this.numberListDropUlTag=null},e.prototype.destroy=function(){this.container=void 0,this.unwireEvents(),this.removeHTMLElements(),this.lineSpacing&&(this.lineSpacing.destroy(),this.lineSpacing=void 0),this.bulletListBtn&&(this.bulletListBtn.destroy(),this.bulletListBtn=void 0),this.numberedListBtn&&(this.numberedListBtn.destroy(),this.numberedListBtn=void 0),this.leftAlignmentBtn&&(this.leftAlignmentBtn.destroy(),this.leftAlignmentBtn=void 0),this.rightAlignmentBtn&&(this.rightAlignmentBtn.destroy(),this.rightAlignmentBtn=void 0),this.centerAlignmentBtn&&(this.centerAlignmentBtn.destroy(),this.centerAlignmentBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0),this.justifyBtn&&(this.justifyBtn.destroy(),this.justifyBtn=void 0),this.decreaseIndentBtn&&(this.decreaseIndentBtn.destroy(),this.decreaseIndentBtn=void 0),this.increaseIndentBtn&&(this.increaseIndentBtn.destroy(),this.increaseIndentBtn=void 0),this.bordersBtn&&(this.bordersBtn.destroy(),this.bordersBtn=void 0),this.showHiddenMarksBtn&&(this.showHiddenMarksBtn.destroy(),this.showHiddenMarksBtn=void 0)},e}(),Pu=function(){function e(e,t,i,n){this.container=e,this.text=new ku(e,n),this.paragraph=new Fu(e),this.initializeTextProperties(t,i,n),this.wireEvents()}return e.prototype.initializeTextProperties=function(e,t,i){this.element=(0,a.createElement)("div",{className:"e-de-prop-pane e-de-scrollbar-hide"}),this.element.setAttribute("tabindex","0"),this.text.initializeTextPropertiesDiv(this.element,i),this.paragraph.initializeParagraphPropertiesDiv(this.element,i),this.paragraph.updateStyleNames(),t||this.container.propertiesPaneContainer.appendChild(this.element)},e.prototype.wireEvents=function(){this.text.wireEvent(),this.paragraph.wireEvent()},e.prototype.onSelectionChange=function(){this.text.onSelectionChange(),this.paragraph.onSelectionChange()},e.prototype.destroy=function(){this.text&&(this.text.destroy(),this.text=void 0),this.paragraph&&(this.paragraph.destroy(),this.paragraph=void 0),this.container=void 0},e}(),Su=function(){function e(e,t,i){this.isTopMarginApply=!1,this.isRightMarginApply=!1,this.isBottomMarginApply=!1,this.isLeftMarginApply=!1,this.borderColor="#000000",this.groupButtonClass="e-de-ctnr-group-btn e-btn-group",this.onOutlineBorderClickHandler=this.onOutlineBorder.bind(this),this.onAllBorderHandler=this.onAllBorder.bind(this),this.onInsideBorderHandler=this.onInsideBorder.bind(this),this.onLeftBorderHandler=this.onLeftBorder.bind(this),this.onVerticalBorderHandler=this.onVerticalBorder.bind(this),this.onRightBorderHandler=this.onRightBorder.bind(this),this.onTopBorderHandler=this.onTopBorder.bind(this),this.onHorizontalBorderHandler=this.onHorizontalBorder.bind(this),this.onBottomBorderHandler=this.onBottomBorder.bind(this),this.onInsertRowAboveHandler=this.onInsertRowAbove.bind(this),this.onInsertRowBelowHandler=this.onInsertRowBelow.bind(this),this.onInsertColumnLeftHandler=this.onInsertColumnLeft.bind(this),this.onInsertColumnRightHandler=this.onInsertColumnRight.bind(this),this.onDeleteRowHandler=this.onDeleteRow.bind(this),this.onDeleteColumnHandler=this.onDeleteColumn.bind(this),this.onMergeCellHandler=this.onMergeCell.bind(this),this.applyAlignTopHandler=this.applyAlignTop.bind(this),this.applyAlignBottomHandler=this.applyAlignBottom.bind(this),this.applyAlignCenterHorizontalHandler=this.applyAlignCenterHorizontal.bind(this),this.onTopMarginHandler=this.onTopMargin.bind(this),this.onRightMarginHandler=this.onRightMargin.bind(this),this.onLeftMarginHandler=this.onLeftMargin.bind(this),this.onBottomMarginHandler=this.onBottomMargin.bind(this),this.onTopMarginClickHandler=this.onTopMarginClick.bind(this),this.onTopMarginBlurHandler=this.onTopMarginBlur.bind(this),this.onRightMarginClickHandler=this.onRightMarginClick.bind(this),this.onRightMarginBlurHandler=this.onRightMarginBlur.bind(this),this.onLeftMarginClickHandler=this.onLeftMarginClick.bind(this),this.onLeftMarginBlurHandler=this.onLeftMarginBlur.bind(this),this.onBottomMarginClickHandler=this.onBottomMarginClick.bind(this),this.onBottomMarginBlurHandler=this.onBottomMarginBlur.bind(this),this.container=e,this.isRtl=i,this.isRtl&&(this.groupButtonClass="e-rtl "+this.groupButtonClass),this.tableTextProperties=new Pu(e,"textProperties",!0,this.isRtl),this.imageProperty=t,this.elementId=this.documentEditor.element.id,this.initializeTablePropPane(),this.prevContext=this.documentEditor.selectionModule.contextType}return Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container.documentEditor},enumerable:!0,configurable:!0}),e.prototype.initializeTablePropPane=function(){this.localObj=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale),this.tableProperties=(0,a.createElement)("div",{className:"e-de-scrollbar-hide",styles:"overflow: auto"}),this.initFillColorDiv(),this.initBorderStylesDiv(),this.initCellDiv(),this.initInsertOrDelCell(),this.initCellMargin(),this.initAlignText(),this.addTablePropertyTab(),this.wireEvent()},e.prototype.enableDisableElements=function(e){e?(0,a.classList)(this.element,[],["e-de-overlay"]):(0,a.classList)(this.element,["e-de-overlay"],[])},e.prototype.addTablePropertyTab=function(){var e=(0,a.createElement)("div",{innerHTML:this.localObj.getConstant("Table")}),t=(0,a.createElement)("div",{innerHTML:this.localObj.getConstant("Text")});this.parentElement=(0,a.createElement)("div",{styles:"height:100%;overflow:auto;display:none",className:"e-de-prop-pane e-de-scrollbar-hide"}),this.element=(0,a.createElement)("div",{id:this.elementId+"_propertyTabDiv",className:"e-de-property-tab"});var i=[{header:{text:t},content:this.tableTextProperties.element},{header:{text:e},content:this.tableProperties}];this.propertiesTab=new ua.Tab({items:i,animation:{previous:{effect:"None"},next:{effect:"None"}},selected:this.onTabSelection.bind(this)}),this.propertiesTab.isStringTemplate=!0,this.propertiesTab.appendTo(this.element),this.parentElement.appendChild(this.element),this.container.propertiesPaneContainer.appendChild(this.parentElement)},e.prototype.onTabSelection=function(e){e.preventFocus=!0,this.documentEditor.resize(),this.documentEditor.enableAutoFocus&&this.documentEditor.focusIn()},e.prototype.wireEvent=function(){var e=this;this.shadingBtn.addEventListener("change",this.changeBackgroundColor.bind(this)),this.borderBtn.addEventListener("change",(function(t){setTimeout((function(){e.borderColor=t.currentValue.hex,e.tableOutlineBorder.element.focus()}),10)})),this.tableOutlineBorder.element.addEventListener("click",this.onOutlineBorderClickHandler),this.tableAllBorder.element.addEventListener("click",this.onAllBorderHandler),this.tableCenterBorder.element.addEventListener("click",this.onInsideBorderHandler),this.tableLeftBorder.element.addEventListener("click",this.onLeftBorderHandler),this.tableCenterVerticalBorder.element.addEventListener("click",this.onVerticalBorderHandler),this.tableRightBorder.element.addEventListener("click",this.onRightBorderHandler),this.tableTopBorder.element.addEventListener("click",this.onTopBorderHandler),this.tableCenterHorizontalBorder.element.addEventListener("click",this.onHorizontalBorderHandler),this.tableBottomBorder.element.addEventListener("click",this.onBottomBorderHandler),this.insertRowAbove.element.addEventListener("click",this.onInsertRowAboveHandler),this.insertRowBelow.element.addEventListener("click",this.onInsertRowBelowHandler),this.insertColumnLeft.element.addEventListener("click",this.onInsertColumnLeftHandler),this.insertColumnRight.element.addEventListener("click",this.onInsertColumnRightHandler),this.deleteRow.element.addEventListener("click",this.onDeleteRowHandler),this.deleteColumn.element.addEventListener("click",this.onDeleteColumnHandler),this.horizontalMerge.element.addEventListener("click",this.onMergeCellHandler),this.alignTop.element.addEventListener("click",this.applyAlignTopHandler),this.alignBottom.element.addEventListener("click",this.applyAlignBottomHandler),this.alignCenterHorizontal.element.addEventListener("click",this.applyAlignCenterHorizontalHandler),this.topMargin.htmlAttributes={"aria-label":"top-margin"},this.bottomMargin.htmlAttributes={"aria-label":"bottom-margin"},this.leftMargin.htmlAttributes={"aria-label":"left-margin"},this.rightMargin.htmlAttributes={"aria-label":"right-Margin"},this.topMargin.element.addEventListener("click",this.onTopMarginClickHandler),this.rightMargin.element.addEventListener("click",this.onRightMarginClickHandler),this.leftMargin.element.addEventListener("click",this.onLeftMarginClickHandler),this.bottomMargin.element.addEventListener("click",this.onBottomMarginClickHandler),this.topMargin.element.addEventListener("keydown",this.onTopMarginHandler),this.rightMargin.element.addEventListener("keydown",this.onRightMarginHandler),this.leftMargin.element.addEventListener("keydown",this.onLeftMarginHandler),this.bottomMargin.element.addEventListener("keydown",this.onBottomMarginHandler),this.topMargin.element.addEventListener("blur",this.onTopMarginBlurHandler),this.rightMargin.element.addEventListener("blur",this.onRightMarginBlurHandler),this.leftMargin.element.addEventListener("blur",this.onLeftMarginBlurHandler),this.bottomMargin.element.addEventListener("blur",this.onBottomMarginBlurHandler)},e.prototype.unWireEvent=function(){this.shadingBtn.removeEventListener("change",this.changeBackgroundColor),this.tableOutlineBorder.element.removeEventListener("click",this.onOutlineBorderClickHandler),this.tableAllBorder.element.removeEventListener("click",this.onAllBorderHandler),this.tableCenterBorder.element.removeEventListener("click",this.onInsideBorderHandler),this.tableLeftBorder.element.removeEventListener("click",this.onLeftBorderHandler),this.tableCenterVerticalBorder.element.removeEventListener("click",this.onVerticalBorderHandler),this.tableRightBorder.element.removeEventListener("click",this.onRightBorderHandler),this.tableTopBorder.element.removeEventListener("click",this.onTopBorderHandler),this.tableCenterHorizontalBorder.element.removeEventListener("click",this.onHorizontalBorderHandler),this.tableBottomBorder.element.removeEventListener("click",this.onBottomBorderHandler),this.insertRowAbove.element.removeEventListener("click",this.onInsertRowAboveHandler),this.insertRowBelow.element.removeEventListener("click",this.onInsertRowBelowHandler),this.insertColumnLeft.element.removeEventListener("click",this.onInsertColumnLeftHandler),this.insertColumnRight.element.removeEventListener("click",this.onInsertColumnRightHandler),this.deleteRow.element.removeEventListener("click",this.onDeleteRowHandler),this.deleteColumn.element.removeEventListener("click",this.onDeleteColumnHandler),this.horizontalMerge.element.removeEventListener("click",this.onMergeCellHandler),this.alignTop.element.removeEventListener("click",this.applyAlignTopHandler),this.alignBottom.element.removeEventListener("click",this.applyAlignBottomHandler),this.alignCenterHorizontal.element.removeEventListener("click",this.applyAlignCenterHorizontalHandler),this.topMargin.element.removeEventListener("click",this.onTopMarginClickHandler),this.rightMargin.element.removeEventListener("click",this.onRightMarginClickHandler),this.leftMargin.element.removeEventListener("click",this.onLeftMarginClickHandler),this.bottomMargin.element.removeEventListener("click",this.onBottomMarginClickHandler),this.topMargin.element.removeEventListener("keydown",this.onTopMarginHandler),this.rightMargin.element.removeEventListener("keydown",this.onRightMarginHandler),this.leftMargin.element.removeEventListener("keydown",this.onLeftMarginHandler),this.bottomMargin.element.removeEventListener("keydown",this.onBottomMarginHandler),this.topMargin.element.removeEventListener("blur",this.onTopMarginBlurHandler),this.rightMargin.element.removeEventListener("blur",this.onRightMarginBlurHandler),this.leftMargin.element.removeEventListener("blur",this.onLeftMarginBlurHandler),this.bottomMargin.element.removeEventListener("blur",this.onBottomMarginBlurHandler)},e.prototype.onTopMarginClick=function(){this.isTopMarginApply=!0},e.prototype.onTopMarginBlur=function(){this.applyTopMargin(),this.isTopMarginApply=!1},e.prototype.onRightMarginClick=function(){this.isRightMarginApply=!0},e.prototype.onRightMarginBlur=function(){this.applyRightMargin(),this.isRightMarginApply=!1},e.prototype.onLeftMarginClick=function(){this.isLeftMarginApply=!0},e.prototype.onLeftMarginBlur=function(){this.applyLeftMargin(),this.isLeftMarginApply=!1},e.prototype.onBottomMarginClick=function(){this.isBottomMarginApply=!0},e.prototype.onBottomMarginBlur=function(){this.applyBottomMargin(),this.isBottomMarginApply=!1},e.prototype.getBorder=function(e){var t=this.borderSize.content.indexOf("No Border")>=0?0:parseFloat(this.borderSize.content),i=0===t?"Cleared":"Single";return{type:e,borderColor:this.borderColor,lineWidth:t,borderStyle:i}},e.prototype.onOutlineBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("OutsideBorders"))},e.prototype.onAllBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("AllBorders"))},e.prototype.onInsideBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("InsideBorders"))},e.prototype.onLeftBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("LeftBorder"))},e.prototype.onVerticalBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("InsideVerticalBorder"))},e.prototype.onRightBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("RightBorder"))},e.prototype.onTopBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("TopBorder"))},e.prototype.onHorizontalBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("InsideHorizontalBorder"))},e.prototype.onBottomBorder=function(){this.documentEditor.editorModule.applyBorders(this.getBorder("BottomBorder"))},e.prototype.onTopMargin=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.applyTopMargin(),t.isTopMarginApply=!1}),30)},e.prototype.onBottomMargin=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.applyBottomMargin(),t.isBottomMarginApply=!1}),30)},e.prototype.onLeftMargin=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.applyLeftMargin(),t.isLeftMarginApply=!1}),30)},e.prototype.onRightMargin=function(e){var t=this;13===e.keyCode&&setTimeout((function(){t.applyRightMargin(),t.isRightMarginApply=!1}),30)},e.prototype.applyTopMargin=function(){this.isTopMarginApply&&(this.documentEditor.selectionModule.cellFormat.topMargin=this.topMargin.value>this.topMargin.max?this.topMargin.max:this.topMargin.value)},e.prototype.applyBottomMargin=function(){this.isBottomMarginApply&&(this.documentEditor.selectionModule.cellFormat.bottomMargin=this.bottomMargin.value>this.bottomMargin.max?this.bottomMargin.max:this.bottomMargin.value)},e.prototype.applyLeftMargin=function(){this.isLeftMarginApply&&(this.documentEditor.selectionModule.cellFormat.leftMargin=this.leftMargin.value>this.leftMargin.max?this.leftMargin.max:this.leftMargin.value)},e.prototype.applyRightMargin=function(){this.isRightMarginApply&&(this.documentEditor.selectionModule.cellFormat.rightMargin=this.rightMargin.value>this.rightMargin.max?this.rightMargin.max:this.rightMargin.value)},e.prototype.applyAlignTop=function(){this.documentEditor.selectionModule.cellFormat.verticalAlignment="Top"},e.prototype.applyAlignBottom=function(){this.documentEditor.selectionModule.cellFormat.verticalAlignment="Bottom"},e.prototype.applyAlignCenterHorizontal=function(){this.documentEditor.selectionModule.cellFormat.verticalAlignment="Center"},e.prototype.onMergeCell=function(){this.documentEditor.editorModule.mergeCells()},e.prototype.onInsertRowAbove=function(){this.documentEditor.editorModule.insertRow(!0)},e.prototype.onInsertRowBelow=function(){this.documentEditor.editorModule.insertRow(!1)},e.prototype.onInsertColumnLeft=function(){this.documentEditor.editorModule.insertColumn(!0)},e.prototype.onInsertColumnRight=function(){this.documentEditor.editorModule.insertColumn(!1)},e.prototype.onDeleteRow=function(){this.documentEditor.editorModule.deleteRow(),this.documentEditor.focusIn()},e.prototype.onDeleteColumn=function(){this.documentEditor.editorModule.deleteColumn(),this.documentEditor.focusIn()},e.prototype.onSelectionChange=function(){this.documentEditor.selectionModule&&(this.documentEditor.editorModule&&this.documentEditor.editorModule.canMergeCells()?this.horizontalMerge.disabled=!1:this.horizontalMerge.disabled=!0,"TableText"!==this.documentEditor.selectionModule.contextType&&"TableImage"!==this.documentEditor.selectionModule.contextType||(this.shadingBtn.value=this.documentEditor.selectionModule.cellFormat.background?this.documentEditor.selectionModule.cellFormat.background:""),this.topMargin.value=this.documentEditor.selectionModule.cellFormat.topMargin?this.documentEditor.selectionModule.cellFormat.topMargin:0,this.bottomMargin.value=this.documentEditor.selectionModule.cellFormat.bottomMargin?this.documentEditor.selectionModule.cellFormat.bottomMargin:0,this.rightMargin.value=this.documentEditor.selectionModule.cellFormat.rightMargin?this.documentEditor.selectionModule.cellFormat.rightMargin:0,this.leftMargin.value=this.documentEditor.selectionModule.cellFormat.leftMargin?this.documentEditor.selectionModule.cellFormat.leftMargin:0)},e.prototype.changeBackgroundColor=function(e){var t=this;this.documentEditor.isReadOnly||(this.documentEditor.selectionModule.cellFormat.background=e.currentValue.hex,setTimeout((function(){t.documentEditor.focusIn()}),10))},e.prototype.initFillColorDiv=function(){var e=(0,a.createElement)("div",{id:this.elementId+"_fillColorDiv",className:"e-de-property-div-padding de-tbl-fill-clr"});this.tableProperties.appendChild(e);var t=(0,a.createElement)("label",{className:"e-de-prop-sub-label"});t.classList.add("e-de-prop-fill-label"),this.isRtl&&t.classList.add("e-de-rtl"),t.textContent=this.localObj.getConstant("Fill"),e.appendChild(t),this.shadingBtn=this.createColorPickerTemplate(this.elementId+"_tableShading",e,this.localObj.getConstant("Fill color"),!1),(0,a.classList)(e.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-cellbg-clr-picker"],["e-caret"]),this.documentEditor.documentHelper.shadingBtn=this.shadingBtn},e.prototype.initBorderStylesDiv=function(){this.borderStyleDiv=(0,a.createElement)("div",{className:"e-de-property-div-padding"}),this.tableProperties.appendChild(this.borderStyleDiv);var e=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"});e.textContent=this.localObj.getConstant("Border Style"),this.borderStyleDiv.appendChild(e);var t=(0,a.createElement)("div",{styles:"display:inline-flex;"}),i=(0,a.createElement)("div",{styles:"width:min-content;height:126px",className:"e-de-grp-btn-ctnr"}),n=(0,a.createElement)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-top"});i.appendChild(n);var r=(0,a.createElement)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-middle"});i.appendChild(r);var o=(0,a.createElement)("div",{className:this.groupButtonClass+" e-de-ctnr-group-btn-bottom"});i.appendChild(o),this.isRtl&&(n.classList.add("e-de-rtl"),o.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"),e.classList.add("e-de-rtl"));var s="";this.tableOutlineBorder=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-outsideborder e-icons",n,"e-de-prop-font-button",s,this.localObj.getConstant("Outside borders")),this.tableAllBorder=this.createButtonTemplate(this.elementId+"_tableAllBorder","e-de-ctnr-allborders e-icons",n,"e-de-prop-font-button",s,this.localObj.getConstant("All borders")),this.tableCenterBorder=this.createButtonTemplate(this.elementId+"_tableCenterBorder","e-de-ctnr-insideborders e-icons",n,"e-de-prop-font-button",s,this.localObj.getConstant("Inside borders")),this.tableLeftBorder=this.createButtonTemplate(this.elementId+"_tableLeftBorder","e-de-ctnr-leftborders e-icons",r,"e-de-prop-font-button",s,this.localObj.getConstant("Left border")),this.tableCenterVerticalBorder=this.createButtonTemplate(this.elementId+"_tableCenterVBorder","e-de-ctnr-insideverticalborder e-icons",r,"e-de-prop-font-button",s,this.localObj.getConstant("Inside vertical border")),this.tableRightBorder=this.createButtonTemplate(this.elementId+"_tableRightBorder","e-de-ctnr-rightborder e-icons",r,"e-de-prop-font-button",s,this.localObj.getConstant("Right border")),this.tableTopBorder=this.createButtonTemplate(this.elementId+"_tableTopBorder","e-de-ctnr-topborder e-icons",o,"e-de-prop-font-button",s,this.localObj.getConstant("Top border")),this.tableCenterHorizontalBorder=this.createButtonTemplate(this.elementId+"_tableCenterHBorder","e-de-ctnr-insidehorizondalborder e-icons",o,"e-de-prop-font-button",s,this.localObj.getConstant("Inside horizontal border")),this.tableBottomBorder=this.createButtonTemplate(this.elementId+"_tableBottomBorder","e-de-ctnr-bottomborder e-icons",o,"e-de-prop-font-button",s,this.localObj.getConstant("Bottom border")),t.appendChild(i);var l=(0,a.createElement)("div",{className:"de-tbl-fill-clr"});this.isRtl?l.classList.add("e-de-stylediv-rtl"):l.classList.add("e-de-stylediv"),this.borderBtn=this.createColorPickerTemplate(this.elementId+"_tableBorderColor",l,this.localObj.getConstant("Border color"),!0),this.documentEditor.documentHelper.borderBtn=this.borderBtn,this.borderBtn.value="#000000",l.firstElementChild.lastElementChild.lastElementChild.style.width="30px",l.firstElementChild.lastElementChild.firstElementChild.firstElementChild.style.width="100%",(0,a.classList)(l.lastElementChild.lastElementChild.lastElementChild.firstChild,["e-de-ctnr-highlightcolor"],["e-caret"]),this.borderSizeButton=(0,a.createElement)("button",{id:this.elementId+"_tableBorderSize",className:"e-de-border-size-button",styles:"font-size:10px;padding:0px;",attrs:{type:"button"}}),l.appendChild(this.borderSizeButton),this.borderSize=this.createBorderSizeDropDown("e-de-ctnr-strokesize e-icons",this.borderSizeButton),t.appendChild(l),this.borderSizeColorElement=document.getElementsByClassName("e-de-border-width"),this.borderStyleDiv.appendChild(t)},e.prototype.initCellDiv=function(){var e=(0,a.createElement)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Cell"),e.appendChild(t);var i=(0,a.createElement)("div",{className:"e-de-ctnr-group-btn"});i.classList.add("e-de-cell-div"),this.isRtl&&(i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));this.horizontalMerge=this.createButtonTemplate(this.elementId+"_tableOutlineBorder","e-de-ctnr-mergecell e-icons",i,"e-de-prop-font-button","",this.localObj.getConstant("Merge cells")),e.appendChild(i)},e.prototype.initInsertOrDelCell=function(){var e=(0,a.createElement)("div",{className:"e-de-property-div-padding"});this.tableProperties.appendChild(e);var t=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Insert Or Delete"),e.appendChild(t);var i=(0,a.createElement)("div",{className:"e-de-insert-del-cell",styles:"display:inline-flex"}),n=(0,a.createElement)("div",{className:this.groupButtonClass});i.appendChild(n);var r=(0,a.createElement)("div",{className:this.groupButtonClass});this.isRtl?(r.style.marginRight="12px",i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl")):r.style.marginLeft="12px",i.appendChild(r);var o="";this.insertColumnLeft=this.createButtonTemplate(this.elementId+"_insertColumnLeft","e-de-ctnr-insertleft e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert columns to the left")),this.insertColumnRight=this.createButtonTemplate(this.elementId+"_insertColumnRight","e-de-ctnr-insertright e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert columns to the right")),this.insertRowAbove=this.createButtonTemplate(this.elementId+"_insertRowAbove","e-de-ctnr-insertabove e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert rows above")),this.insertRowBelow=this.createButtonTemplate(this.elementId+"_insertRowBelow","e-de-ctnr-insertbelow e-icons",n,"e-de-prop-font-button",o,this.localObj.getConstant("Insert rows below")),this.deleteRow=this.createButtonTemplate(this.elementId+"_deleteRow","e-de-ctnr-deleterows e-icons",r,"e-de-prop-font-button",o,this.localObj.getConstant("Delete rows")),this.deleteColumn=this.createButtonTemplate(this.elementId+"_deleteColumn","e-de-ctnr-deletecolumns e-icons",r,"e-de-prop-font-button",o,this.localObj.getConstant("Delete columns")),e.appendChild(i)},e.prototype.initCellMargin=function(){var e=(0,a.createElement)("div",{className:"e-de-property-div-padding e-de-cellmargin-text"});this.tableProperties.appendChild(e);var t=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Cell Margin"),e.appendChild(t);var i=(0,a.createElement)("div",{styles:"display:inline-flex"});this.isRtl&&t.classList.add("e-de-rtl");var n="width:48px",r="width:50px;float:left;";this.topMargin=this.createCellMarginTextBox(this.localObj.getConstant("Top"),this.elementId+"_topMargin",i,n,r,500,this.localObj.getConstant("Top margin")),this.bottomMargin=this.createCellMarginTextBox(this.localObj.getConstant("Bottom"),this.elementId+"_bottomMargin",i,n,r,500,this.localObj.getConstant("Bottom margin")),this.leftMargin=this.createCellMarginTextBox(this.localObj.getConstant("Left"),this.elementId+"_leftMargin",i,n,r,500,this.localObj.getConstant("Left margin")),this.rightMargin=this.createCellMarginTextBox(this.localObj.getConstant("Right"),this.elementId+"_rightMargin",i,n,r,500,this.localObj.getConstant("Right margin"),!0),e.appendChild(i)},e.prototype.initAlignText=function(){var e=(0,a.createElement)("div",{className:"e-de-property-div-padding",styles:"border-bottom-width:0px"});this.tableProperties.appendChild(e);var t=(0,a.createElement)("label",{className:"e-de-ctnr-prop-label"});t.textContent=this.localObj.getConstant("Align Text"),e.appendChild(t);var i=(0,a.createElement)("div");this.isRtl&&(i.classList.add("e-de-rtl"),t.classList.add("e-de-rtl"));var n=(0,a.createElement)("div",{className:this.groupButtonClass});i.appendChild(n);this.alignTop=this.createButtonTemplate(this.elementId+"_alignTop","e-de-ctnr-aligntop e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Align top")),this.alignBottom=this.createButtonTemplate(this.elementId+"_alignBottom","e-de-ctnr-alignbottom e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Align bottom")),this.alignCenterHorizontal=this.createButtonTemplate(this.elementId+"_alignCenterHorizontal","e-de-ctnr-aligncenter-table e-icons",n,"e-de-prop-font-button","",this.localObj.getConstant("Align center")),this.alignCenterHorizontal.addEventListener("click",this.applyAlignCenterHorizontal.bind(this)),e.appendChild(i)},e.prototype.createCellMarginTextBox=function(e,t,i,n,r,o,s,l){var d=(0,a.createElement)("div",{styles:r});l||d.classList.add("e-de-cell-text-box");var h=(0,a.createElement)("label",{className:"e-de-prop-sub-label"});h.textContent=e,d.appendChild(h);var c=(0,a.createElement)("input",{className:"e-textbox",id:t,styles:n});d.appendChild(c);var p=new rl.NumericTextBox({showSpinButton:!1,min:0,format:"n0",max:o,enableRtl:this.isRtl},c);return i.appendChild(d),c.setAttribute("title",s),p},e.prototype.createBorderSizeDropDown=function(e,t){var i=this,n=(0,a.createElement)("div",{id:"borderSizeTarget",styles:"display:none"}),r=(0,a.createElement)("ul",{styles:"display: block; outline: 0px; width: 126px; height: auto;",id:"borderSizeListMenu"});n.appendChild(r),this.createDropdownOption(r,this.localObj.getConstant("No Border")).addEventListener("click",(function(){i.onBorderSizeChange("No Border")}));var o=this.localObj.getConstant("px");this.createDropdownOption(r,".25"+o).addEventListener("click",(function(){i.onBorderSizeChange(".25px")})),this.createDropdownOption(r,".5"+o).addEventListener("click",(function(){i.onBorderSizeChange(".5px")})),this.createDropdownOption(r,".75"+o).addEventListener("click",(function(){i.onBorderSizeChange(".75px")})),this.createDropdownOption(r,"1"+o).addEventListener("click",(function(){i.onBorderSizeChange("1px")})),this.createDropdownOption(r,"1.5"+o).addEventListener("click",(function(){i.onBorderSizeChange("1.5px")})),this.createDropdownOption(r,"2"+o).addEventListener("click",(function(){i.onBorderSizeChange("2px")})),this.createDropdownOption(r,"3"+o).addEventListener("click",(function(){i.onBorderSizeChange("3px")})),this.createDropdownOption(r,"4"+o).addEventListener("click",(function(){i.onBorderSizeChange("4px")})),this.createDropdownOption(r,"5"+o).addEventListener("click",(function(){i.onBorderSizeChange("5px")})),this.createDropdownOption(r,"6"+o).addEventListener("click",(function(){i.onBorderSizeChange("6px")}));var s={target:n,iconCss:e,cssClass:"e-de-prop-bordersize",enableRtl:this.isRtl,content:"1.5px"},l=new pl.DropDownButton(s);return l.beforeOpen=function(){n.style.display="block";for(var e=0;e<i.borderSizeColorElement.length;e++)i.borderSizeColorElement[parseInt(e.toString(),10)].style.borderBottomColor=i.borderColor},l.beforeClose=function(){n.style.display="none"},l.appendTo(t),l.element.setAttribute("title",this.localObj.getConstant("Border width")),l},e.prototype.onBorderSizeChange=function(e){var t=this;this.borderSize.content=e,setTimeout((function(){t.tableOutlineBorder.element.focus()}),10)},e.prototype.createDropdownOption=function(e,t){var i,n=(0,a.createElement)("li",{styles:"display:block",className:"e-de-floating-menuitem e-de-floating-menuitem-md e-de-list-items  e-de-list-item-size"});e.appendChild(n),i="No Border"===t?"<div>"+t+"</div>":"1.5px"===t?"<div>"+t+'<span class="e-de-list-line e-de-border-width"  style="margin-left:10px;border-bottom-width:'+t+';"></span></div>':"<div>"+t+'<span class="e-de-list-line e-de-border-width" style="margin-left:20px;border-bottom-width:'+t+';"></span></div>';var r=(0,a.createElement)("div",{className:"e-de-list-header-presetmenu",innerHTML:i});return n.appendChild(r),n},e.prototype.createDropDownButton=function(e,t,i,n,r,o,s){var l=(0,a.createElement)("button",{id:e,styles:t,attrs:{type:"button"}});i.appendChild(l);var d="e-de-prop-splitbutton";this.isRtl&&(d="e-rtl "+d);var h=new pl.DropDownButton({iconCss:n,content:r,enableRtl:this.isRtl,cssClass:d},l);return o&&(h.items=o),s&&(h.target=s),h},e.prototype.createButtonTemplate=function(e,t,i,n,r,o,s,l){var d=(0,a.createElement)("Button",{id:e,styles:r,attrs:{type:"button"}});i.appendChild(d);var h=new tl.Button({cssClass:n,iconCss:t,enableRtl:this.isRtl,iconPosition:l||"Left",content:s||""});return h.appendTo(d),d.setAttribute("title",o),d.setAttribute("aria-label",o),h},e.prototype.createColorPickerTemplate=function(e,t,i,n){var r=this.documentEditor.documentEditorSettings.colorPickerSettings,o=r.columns,s=r.createPopupOnClick,l=r.disabled,d=r.enablePersistence,h=r.inline,c=r.mode,p=r.modeSwitcher,u=r.noColor,g=r.presetColors,m=r.showButtons,f=(0,a.createElement)("input",{id:e});t.appendChild(f);var v="e-de-prop-font-button e-de-prop-font-colorpicker";n&&(v+=" e-de-border-clr-picker");var y=new rl.ColorPicker({cssClass:v,enableRtl:this.isRtl,locale:this.container.locale,enableOpacity:!1,mode:c,modeSwitcher:p,showButtons:m,columns:o,createPopupOnClick:s,disabled:l,enablePersistence:d,inline:h,noColor:u,presetColors:g},f);return f.parentElement.setAttribute("title",i),f.parentElement.setAttribute("aria-label",i),y},e.prototype.showTableProperties=function(e,t){e&&("text"===t?this.propertiesTab.hideTab(1,!0):(this.propertiesTab.hideTab(1,!1),this.prevContext!==this.documentEditor.selectionModule.contextType&&(this.propertiesTab.selectedItem=1)),this.prevContext=this.documentEditor.selectionModule.contextType,this.onSelectionChange(),this.tableTextProperties.onSelectionChange()),!e&&"none"===this.parentElement.style.display||e&&"block"===this.parentElement.style.display||(this.parentElement.style.display=e?"block":"none",e&&this.updateTabContainerHeight(),this.documentEditor.resize(),this.prevContext=this.documentEditor.selectionModule.contextType)},e.prototype.updateTabContainerHeight=function(){if(this.parentElement&&"block"===this.parentElement.style.display){var e=this.parentElement.getElementsByClassName("e-tab-header")[0];if(e){var t=this.parentElement.offsetHeight-e.offsetHeight;this.tableProperties.style.height=t+"px",this.tableTextProperties.element.style.height=t+"px"}}},e.prototype.removeHTMLDomElement=function(){var e=this;this.borderSizeButton&&(this.borderSizeButton.remove(),this.borderSizeButton=null),this.borderStyleDiv&&(this.borderStyleDiv.childNodes.forEach((function(t){e.borderStyleDiv.removeChild(t),t=null})),this.borderStyleDiv.innerHTML="",this.borderStyleDiv.remove(),this.borderStyleDiv=null),this.tableProperties&&(this.tableProperties.childNodes.forEach((function(t){e.tableProperties.removeChild(t),t=null})),this.tableProperties.innerHTML="",this.tableProperties.remove(),this.tableProperties=null)},e.prototype.destroy=function(){this.unWireEvent(),this.container=void 0,this.shadingBtn&&(this.shadingBtn.destroy(),this.shadingBtn.element.remove(),this.shadingBtn.element=null,this.shadingBtn=void 0),this.borderBtn&&(this.borderBtn.destroy(),this.borderBtn.element.remove(),this.borderBtn.element=null,this.borderBtn=void 0),this.borderSize&&(this.borderSize.destroy(),this.borderSize=void 0),this.topMargin&&(this.topMargin.destroy(),this.topMargin=void 0),this.bottomMargin&&(this.bottomMargin.destroy(),this.bottomMargin=void 0),this.leftMargin&&(this.leftMargin.destroy(),this.leftMargin=void 0),this.rightMargin&&((0,a.remove)(this.rightMargin.element),this.rightMargin.destroy(),this.rightMargin=void 0),this.tableTextProperties&&(this.tableTextProperties.destroy(),this.tableTextProperties=void 0),this.propertiesTab&&(this.propertiesTab.destroy(),this.propertiesTab=void 0),this.imageProperty&&(this.imageProperty=null),this.tableOutlineBorder&&this.tableOutlineBorder.destroy(),this.tableOutlineBorder=void 0,this.tableAllBorder&&this.tableAllBorder.destroy(),this.tableAllBorder=void 0,this.tableCenterBorder&&this.tableCenterBorder.destroy(),this.tableCenterBorder=void 0,this.tableLeftBorder&&this.tableLeftBorder.destroy(),this.tableLeftBorder=void 0,this.tableCenterVerticalBorder&&this.tableCenterVerticalBorder.destroy(),this.tableCenterVerticalBorder=void 0,this.tableRightBorder&&this.tableRightBorder.destroy(),this.tableRightBorder=void 0,this.tableTopBorder&&this.tableTopBorder.destroy(),(0,a.remove)(this.tableTopBorder.element),this.tableTopBorder=void 0,this.tableCenterHorizontalBorder&&this.tableCenterHorizontalBorder.destroy(),(0,a.remove)(this.tableCenterHorizontalBorder.element),this.tableCenterHorizontalBorder=void 0,this.tableBottomBorder&&this.tableBottomBorder.destroy(),(0,a.remove)(this.tableBottomBorder.element),this.tableBottomBorder=void 0,this.horizontalMerge&&this.horizontalMerge.destroy(),(0,a.remove)(this.horizontalMerge.element),this.horizontalMerge=void 0,this.insertRowAbove&&this.insertRowAbove.destroy(),(0,a.remove)(this.insertRowAbove.element),this.insertRowAbove=void 0,this.insertRowBelow&&this.insertRowBelow.destroy(),(0,a.remove)(this.insertRowBelow.element),this.insertRowBelow=void 0,this.insertColumnLeft&&this.insertColumnLeft.destroy(),(0,a.remove)(this.insertColumnLeft.element),this.insertColumnLeft=void 0,this.insertColumnRight&&this.insertColumnRight.destroy(),(0,a.remove)(this.insertColumnRight.element),this.insertColumnRight=void 0,this.deleteRow&&this.deleteRow.destroy(),(0,a.remove)(this.deleteRow.element),this.deleteRow=void 0,this.deleteColumn&&this.deleteColumn.destroy(),(0,a.remove)(this.deleteColumn.element),this.deleteColumn=void 0,this.alignBottom&&this.alignBottom.destroy(),this.alignBottom=void 0,this.alignCenterHorizontal&&this.alignCenterHorizontal.destroy(),this.alignCenterHorizontal=void 0,this.alignTop&&this.alignTop.destroy(),this.removeHTMLDomElement(),this.alignTop=void 0,this.groupButtonClass=void 0,this.borderColor=void 0,this.elementId=void 0},e}(),Tu=function(){function e(e,t){this.startPage=1,this.onPageLayoutClickHandler=this.onPageLayoutClick.bind(this),this.onWebLayoutClickHandler=this.onWebLayoutClick.bind(this),this.onPageNumberKeyDownHandler=this.onPageNumberKeyDown.bind(this),this.onPageNumberKeyUpHandler=this.onPageNumberKeyUp.bind(this),this.onPageNumberBlurHandler=this.onPageNumberBlur.bind(this),this.onPageNumberFocusHandler=this.onPageNumberFocus.bind(this),this.statusBarDiv=e,this.container=t,this.initializeStatusBar(),this.wireEvents()}return e.prototype.onPageLayoutClick=function(){this.documentEditor.layoutType="Pages",this.addRemoveClass(this.pageButton,this.webButton),this.documentEditor.focusIn()},e.prototype.onWebLayoutClick=function(){this.documentEditor.layoutType="Continuous",this.addRemoveClass(this.webButton,this.pageButton),this.documentEditor.focusIn()},e.prototype.onPageNumberKeyDown=function(e){13===e.which&&(e.preventDefault(),parseInt(this.pageNumberInput.value,10)>this.editorPageCount?this.updatePageNumber():this.documentEditor.selectionModule?(this.documentEditor.selectionModule.goToPage(parseInt(this.pageNumberInput.value,10)),this.documentEditor.focusIn()):this.documentEditor.scrollToPage(parseInt(this.pageNumberInput.value,10)),this.pageNumberInput.contentEditable="false",""===this.pageNumberInput.value&&this.updatePageNumber());e.which>64&&e.preventDefault()},e.prototype.onPageNumberKeyUp=function(){this.updatePageNumberWidth()},e.prototype.onPageNumberBlur=function(){(""===this.pageNumberInput.value||parseInt(this.pageNumberInput.value,10)>this.editorPageCount)&&this.updatePageNumber(),this.pageNumberInput.contentEditable="false"},e.prototype.onPageNumberFocus=function(){this.pageNumberInput.select()},Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.container?this.container.documentEditor:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorPageCount",{get:function(){return this.documentEditor?this.documentEditor.pageCount:1},enumerable:!0,configurable:!0}),e.prototype.initializeStatusBar=function(){var e=this.container.enableRtl;this.documentEditor.enableSpellCheck=!!this.container.enableSpellCheck,this.localObj=new a.L10n("documenteditorcontainer",this.container.defaultLocale,this.container.locale);var t=e?"padding-right:16px":"padding-left:16px";this.pageNumDiv=(0,a.createElement)("div",{className:this.container.enableSpellCheck?"e-de-ctnr-pg-no":"e-de-ctnr-pg-no-spellout",styles:t}),this.statusBarDiv.appendChild(this.pageNumDiv),this.pageLabel=(0,a.createElement)("span"),this.pageLabel.textContent=this.localObj.getConstant("Page")+" ",this.pageNumDiv.appendChild(this.pageLabel),this.pageNumberInput=(0,a.createElement)("input",{styles:"text-transform:capitalize;white-space:pre;overflow:hidden;user-select:none;cursor:text",attrs:{type:"text","aria-label":this.localObj.getConstant("Current Page Number")},className:"e-de-pagenumber-input"}),this.editablePageNumber=(0,a.createElement)("div",{styles:"display: inline-flex",className:"e-input e-de-pagenumber-text"}),this.editablePageNumber.appendChild(this.pageNumberInput);var i="";e?(this.pageLabel.style.marginLeft="6px",this.editablePageNumber.style.marginLeft="6px",i="padding-left:5px"):(this.pageLabel.style.marginRight="6px",this.editablePageNumber.style.marginRight="6px",i="padding-right:5px"),this.updatePageNumber(),this.pageNumDiv.appendChild(this.editablePageNumber),this.editablePageNumber.setAttribute("title",this.localObj.getConstant("Current Page Number")),this.ofLabel=(0,a.createElement)("span",{styles:i}),this.ofLabel.textContent=" "+this.localObj.getConstant("of")+" ",this.pageNumDiv.appendChild(this.ofLabel),this.pageCount=(0,a.createElement)("span"),this.pageNumDiv.appendChild(this.pageCount),this.updatePageCount(),this.documentEditor.enableSpellCheck&&(this.verticalLine=(0,a.createElement)("div",{className:"e-de-statusbar-separator"}),this.statusBarDiv.appendChild(this.verticalLine),this.spellCheckBtn=this.addSpellCheckElement(),this.spellCheckButton.appendTo(this.spellCheckBtn)),this.pageButton=this.createButtonTemplate(this.container.enableSpellCheck?"e-de-statusbar-pageweb e-btn-pageweb-spellcheck":"e-de-statusbar-pageweb","e-de-printlayout e-icons","Print layout",this.statusBarDiv,this.pageButton,"Pages"===this.documentEditor.layoutType),this.webButton=this.createButtonTemplate("e-de-statusbar-pageweb","e-de-weblayout e-icons","Web layout",this.statusBarDiv,this.webButton,"Continuous"===this.documentEditor.layoutType),this.pageButton.addEventListener("click",this.onPageLayoutClickHandler),this.webButton.addEventListener("click",this.onWebLayoutClickHandler),this.zoomBtn=(0,a.createElement)("button",{className:"e-de-statusbar-zoom",attrs:{type:"button"}}),this.statusBarDiv.appendChild(this.zoomBtn),this.zoomBtn.setAttribute("title",this.localObj.getConstant("ZoomLevelTooltip"));var n=[{text:"200%"},{text:"175%"},{text:"150%"},{text:"125%"},{text:"100%"},{text:"75%"},{text:"50%"},{text:"25%"},{separator:!0},{text:this.localObj.getConstant("Fit one page")},{text:this.localObj.getConstant("Fit page width")}];this.zoom=new pl.DropDownButton({content:"100%",items:n,enableRtl:this.container.enableRtl,select:this.onZoom.bind(this)}),this.zoom.isStringTemplate=!0,this.zoom.appendTo(this.zoomBtn)},e.prototype.addSpellCheckElement=function(){var e=this,t=(0,a.createElement)("button",{className:"e-de-statusbar-spellcheck"});this.statusBarDiv.appendChild(t),t.setAttribute("title","Spell Checker options");var i=[{text:this.localObj.getConstant("Spell Check")},{text:this.localObj.getConstant("Underline errors")}];return this.spellCheckButton=new pl.DropDownButton({content:this.localObj.getConstant("Spelling"),items:i,enableRtl:this.container.enableRtl,select:this.onSpellCheck.bind(this),beforeItemRender:function(t){t.element.innerHTML="<span></span>"+t.item.text,(0,a.isNullOrUndefined)(e.currentLanguage)&&(e.currentLanguage=e.documentEditor.spellCheckerModule.languageID),(0,a.isNullOrUndefined)(e.allowSuggestion)&&(e.allowSuggestion=e.documentEditor.spellCheckerModule.allowSpellCheckAndSuggestion);var i=t.element.children[0];t.item.text===e.localObj.getConstant("Spell Check")&&e.documentEditor.enableSpellCheck&&e.documentEditor.spellCheckerModule.enableSpellCheck?(i.style.marginRight="10px",i.setAttribute("class","e-de-selected-spellcheck-item")):t.item.text===e.localObj.getConstant("Underline errors")&&e.documentEditor.enableSpellCheck&&e.documentEditor.spellCheckerModule.enableSpellCheck&&!e.documentEditor.spellCheckerModule.removeUnderline?(i.style.marginRight="10px",i.setAttribute("class","e-de-selected-underline-item")):(i.style.marginRight="25px",t.element.children[0].classList.remove("e-de-selected-spellcheck-item"),t.element.children[0].classList.remove("e-de-selected-underline-item"))}}),t},e.prototype.onZoom=function(e){this.setZoomValue(e.item.text),this.updateZoomContent()},e.prototype.onSpellCheck=function(e){this.setSpellCheckValue(e.item.text)},e.prototype.updateZoomContent=function(){this.zoom.content=Math.round(100*this.documentEditor.zoomFactor)+"%"},e.prototype.setSpellCheckValue=function(e){this.spellCheckButton.content=this.localObj.getConstant("Spelling"),e.match(this.localObj.getConstant("Spell Check"))?(this.documentEditor.spellCheckerModule.enableSpellCheck=!this.documentEditor.spellCheckerModule.enableSpellCheck,this.documentEditor.documentHelper.triggerSpellCheck=!1,this.documentEditor.documentHelper.triggerElementsOnLoading=!1):e.match(this.localObj.getConstant("Underline errors"))&&this.documentEditor.enableSpellCheck&&this.documentEditor.spellCheckerModule.enableSpellCheck&&(this.documentEditor.spellCheckerModule.removeUnderline=!this.documentEditor.spellCheckerModule.removeUnderline)},e.prototype.setZoomValue=function(e){e.match(this.localObj.getConstant("Fit one page"))?this.documentEditor.fitPage("FitOnePage"):e.match(this.localObj.getConstant("Fit page width"))?this.documentEditor.fitPage("FitPageWidth"):this.documentEditor.zoomFactor=parseInt(e,10)/100},e.prototype.updatePageCount=function(){this.pageCount.textContent=this.editorPageCount.toString()},e.prototype.updatePageNumber=function(){this.pageNumberInput.value=this.startPage.toString(),this.updatePageNumberWidth()},e.prototype.updatePageNumberOnViewChange=function(e){this.documentEditor.selectionModule&&this.documentEditor.selectionModule.startPage>=e.startPage&&this.documentEditor.selectionModule.startPage<=e.endPage?this.startPage=this.documentEditor.selectionModule.startPage:this.startPage=e.startPage,this.updatePageNumber(),this.updatePageCount()},e.prototype.wireEvents=function(){this.pageNumberInput.addEventListener("keydown",this.onPageNumberKeyDownHandler),this.pageNumberInput.addEventListener("keyup",this.onPageNumberKeyUpHandler),this.pageNumberInput.addEventListener("blur",this.onPageNumberBlurHandler),this.pageNumberInput.addEventListener("focus",this.onPageNumberFocusHandler)},e.prototype.unWireEvents=function(){this.pageButton.removeEventListener("click",this.onPageLayoutClickHandler),this.webButton.removeEventListener("click",this.onWebLayoutClickHandler),this.pageNumberInput.removeEventListener("keydown",this.onPageNumberKeyDownHandler),this.pageNumberInput.removeEventListener("keyup",this.onPageNumberKeyUpHandler),this.pageNumberInput.removeEventListener("blur",this.onPageNumberBlurHandler),this.pageNumberInput.removeEventListener("focus",this.onPageNumberFocusHandler)},e.prototype.updatePageNumberWidth=function(){this.pageNumberInput&&(this.pageNumberInput.style.width=this.pageNumberInput.value.length>=3?"30px":"22px")},e.prototype.toggleWebLayout=function(){this.addRemoveClass(this.pageButton,this.webButton)},e.prototype.togglePageLayout=function(){this.addRemoveClass(this.webButton,this.pageButton)},e.prototype.addRemoveClass=function(e,t){e.classList.add("e-btn-toggle"),t.classList.contains("e-btn-toggle")&&t.classList.remove("e-btn-toggle")},e.prototype.createButtonTemplate=function(e,t,i,n,r,o){r=(0,a.createElement)("Button",{className:e,attrs:{type:"button"}}),n.appendChild(r);var s=new tl.Button({cssClass:e,iconCss:t,enableRtl:this.container.enableRtl});return!0===o&&r.classList.add("e-btn-toggle"),s.appendTo(r),r.setAttribute("title",this.localObj.getConstant(i)),"Web layout"===i?this.webBtn=s:this.pageBtn=s,r},e.prototype.destroy=function(){this.unWireEvents(),this.removeHTMLDom(),this.dependentComponentsDestroy(),this.pageButton=void 0,this.webButton=void 0,this.pageNumberInput=void 0,this.statusBarDiv=void 0,this.pageCount=void 0,this.editablePageNumber=void 0,this.localObj=void 0,this.container=void 0},e.prototype.dependentComponentsDestroy=function(){this.zoom&&(this.zoom.destroy(),this.zoom=void 0),this.spellCheckButton&&(this.spellCheckButton.destroy(),this.spellCheckButton=void 0),this.pageBtn&&(this.pageBtn.destroy(),this.pageBtn=void 0),this.webBtn&&(this.webBtn.destroy(),this.webBtn=void 0)},e.prototype.removeHTMLDom=function(){this.pageNumDiv.remove(),this.statusBarDiv.remove(),this.pageCount.remove(),this.pageLabel.remove(),this.pageNumberInput.remove(),this.editablePageNumber.remove(),this.ofLabel.remove(),this.zoomBtn.remove(),this.pageButton.remove(),this.webButton.remove(),(0,a.isNullOrUndefined)(this.verticalLine)||this.verticalLine.remove(),(0,a.isNullOrUndefined)(this.spellCheckBtn)||this.spellCheckBtn.remove()},e}(),Hu=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Eu=function(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},Nu=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.previousContext="",n.showHeaderProperties=!0,n.defaultLocale={New:"New","Insert Footnote":"Insert Footnote","Insert Endnote":"Insert Endnote","Footnote Tooltip":"Insert Footnote (Alt+Ctrl+F).","Endnote Tooltip":"Insert Endnote (Alt+Ctrl+D).",Open:"Open",Undo:"Undo",Redo:"Redo",Image:"Image",Table:"Table",Link:"Link",Bookmark:"Bookmark","Table of Contents":"Table of Contents","HEADING - - - - 1":"HEADING - - - - 1","HEADING - - - - 2":"HEADING - - - - 2","HEADING - - - - 3":"HEADING - - - - 3",Header:"Header",Footer:"Footer","XML Mapping Pane":"XML Mapping Pane","Page Setup":"Page Setup","Page Number":"Page Number",Break:"Break",Find:"Find","Local Clipboard":"Local Clipboard","Restrict Editing":"Restrict Editing","Upload from computer":"Upload from computer","By URL":"By URL",Page:"Page","Show properties pane":"Show properties pane","Hide properties pane":"Hide properties pane","Next Page":"Next Page",Continuous:"Continuous","Header And Footer":"Header & Footer",Options:"Options","XML Mapping":"XML Mapping","Custom XML Part:":"Custom XML Part:","Core Properties":"Core Properties",Levels:"Levels","Different First Page":"Different First Page","Different header and footer for odd and even pages":"Different header and footer for odd and even pages.","Different Odd And Even Pages":"Different Odd & Even Pages","Different header and footer for first page":"Different header and footer for first page.",Position:"Position","Header from Top":"Header from Top","Footer from Bottom":"Footer from Bottom","Distance from top of the page to top of the header":"Distance from top of the page to top of the header.","Distance from bottom of the page to bottom of the footer":"Distance from bottom of the page to bottom of the footer.","Aspect ratio":"Aspect ratio",W:"W",H:"H",Width:"Width",Height:"Height",Text:"Text",Paragraph:"Paragraph",Fill:"Fill","Fill color":"Fill color","Border Style":"Border Style","Outside borders":"Outside borders","All borders":"All borders","Inside borders":"Inside borders","Left border":"Left border","Inside vertical border":"Inside vertical border","Right border":"Right border","Top border":"Top border","Inside horizontal border":"Inside horizontal border","Bottom border":"Bottom border","Border color":"Border color","Border width":"Border width",Cell:"Cell","Merge cells":"Merge cells","Insert Or Delete":"Insert / Delete","Insert columns to the left":"Insert columns to the left","Insert columns to the right":"Insert columns to the right","Insert rows above":"Insert rows above","Insert rows below":"Insert rows below","Delete rows":"Delete rows","Delete columns":"Delete columns","Cell Margin":"Cell Margin",Top:"Top",Bottom:"Bottom",Left:"Left",Right:"Right","Align Text":"Align Text","Align top":"Align top","Align bottom":"Align bottom","Align center":"Align center","Number of heading or outline levels to be shown in table of contents":"Number of heading or outline levels to be shown in table of contents.","Show page numbers":"Show page numbers","Show page numbers in table of contents":"Show page numbers in table of contents.","Right align page numbers":"Right align page numbers","Right align page numbers in table of contents":"Right align page numbers in table of contents.","Use hyperlinks":"Use hyperlinks","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers.",Font:"Font","Font Size":"Font Size","Font color":"Font color","Text highlight color":"Text highlight color","Clear all formatting":"Clear all formatting","Bold Tooltip":"Bold (Ctrl+B)","Italic Tooltip":"Italic (Ctrl+I)","Underline Tooltip":"Underline (Ctrl+U)",Strikethrough:"Strikethrough","Superscript Tooltip":"Superscript (Ctrl+Shift++)","Subscript Tooltip":"Subscript (Ctrl+=)","Align left Tooltip":"Align left (Ctrl+L)","Center Tooltip":"Center (Ctrl+E)","Align right Tooltip":"Align right (Ctrl+R)","Justify Tooltip":"Justify (Ctrl+J)","Decrease indent":"Decrease indent","Increase indent":"Increase indent","Line spacing":"Line spacing",Bullets:"Bullets",Numbering:"Numbering",Styles:"Styles","Manage Styles":"Manage Styles",of:"of","Fit one page":"Fit one page","Spell Check":"Spell Check",Spelling:"Spelling","Underline errors":"Underline errors","Fit page width":"Fit page width",Update:"Update",Cancel:"Cancel",Insert:"Insert","No Border":"No Border","Create a new document":"Create a new document.","Open a document":"Open a document.","Undo Tooltip":"Undo the last operation (Ctrl+Z).","Redo Tooltip":"Redo the last operation (Ctrl+Y).","Insert inline picture from a file":"Insert inline picture from a file.","Insert a table into the document":"Insert a table into the document","Create Hyperlink":"Create a link in your document for quick access to web pages and files (Ctrl+K).","Insert a bookmark in a specific place in this document":"Insert a bookmark in a specific place in this document.","Provide an overview of your document by adding a table of contents":"Provide an overview of your document by adding a table of contents.","Add or edit the header":"Add or edit the header.","Add or edit the footer":"Add or edit the footer.","Open the page setup dialog":"Open the page setup dialog.","Content Control":"Content Control","Insert Content Control":"Insert Content Control","Add page numbers":"Add page numbers.","Find Text":"Find text in the document (Ctrl+F).","Toggle between the internal clipboard and system clipboard":"Toggle between the internal clipboard and system clipboard.</br>Access to system clipboard through script is denied due to browsers security policy. Instead, </br> 1. You can enable internal clipboard to cut, copy and paste within the component.</br> 2. You can use the keyboard shortcuts (Ctrl+X, Ctrl+C and Ctrl+V) to cut, copy and paste with system clipboard.","Current Page Number":"The current page number in the document. Click or tap to navigate specific page.","Read only":"Read only",Protections:"Protections","Error in establishing connection with web server":"Error in establishing connection with web server",Single:"Single",Double:"Double","New comment":"New comment",Comments:"Comments","Print layout":"Print layout","Web layout":"Web layout","Form Fields":"Form Fields","Text Form":"Text Form","Check Box":"Check Box",DropDown:"Drop-Down","Update Fields":"Update Fields","Update cross reference fields":"Update cross reference fields","Track Changes":"Keep track of the changes made in the document",TrackChanges:"Track Changes",AllCaps:"AllCaps","Change case Tooltip":"Change case",UPPERCASE:"UPPERCASE",SentenceCase:"Sentence case",Lowercase:"Lowercase",CapitalizeEachWord:"Capitalize each word",ToggleCase:"tOGGLE cASE","No color":"No color","Top margin":"Top margin","Bottom margin":"Bottom margin","Left margin":"Left margin","Right margin":"Right margin",Normal:"Normal",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6","Heading 7":"Heading 7","Heading 8":"Heading 8","Heading 9":"Heading 9",ZoomLevelTooltip:"Zoom level. Click or tap to open the Zoom options.",None:"None",Borders:"Borders","ShowHiddenMarks Tooltip":"Show the hidden characters like spaces, tab, paragraph marks, and breaks.(Ctrl + *)",Columns:"Columns",Column:"Column","Page Breaks":"Page Breaks","Section Breaks":"Section Breaks","Link to Previous":"Link to Previous","Link to PreviousTooltip":"Link this section with previous section header or footer","Alternate Text":"Alternate Text","The address of this site is not valid. Check the address and try again.":"The address of this site is not valid. Check the address and try again.",OK:"OK",Information:"Information","Rich Text Content Control":"Rich Text Content Control","Plain Text Content Control":"Plain Text Content Control","Picture Content Control":"Picture Content Control","Combo Box Content Control":"Combo Box Content Control","Drop-Down List Content Control":"Drop-Down List Content Control","Date Picker Content Control":"Date Picker Content Control","Check Box Content Control":"Check Box Content Control"},n}return Hu(t,e),Object.defineProperty(t.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toolbar",{get:function(){return this.toolbarModule},enumerable:!0,configurable:!0}),t.prototype.getModuleName=function(){return"DocumentEditorContainer"},t.prototype.onPropertyChanged=function(e,t){for(var i=0,n=Object.keys(e);i<n.length;i++){switch(n[i]){case"restrictEditing":this.restrictEditingToggleHelper(e.restrictEditing);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor.documentHelper.isTrackedOnlyMode&&!e.enableTrackChanges&&e.enableTrackChanges!==this.enableTrackChanges&&(this.enableTrackChanges=!0),this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.toolbarModule&&this.toolbarModule.toggleTrackChanges(e.enableTrackChanges),this.documentEditor.enableTrackChanges&&(this.documentEditor.documentHelper.showRevision=!0),this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":this.documentEditor&&(this.documentEditor.headers=e.headers);break;case"locale":case"enableRtl":this.refresh();break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment),this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentSettings":this.documentEditor&&(this.documentEditor.documentSettings.compatibilityMode=this.documentSettings.compatibilityMode);break;case"documentEditorSettings":if(this.documentEditor&&this.customizeDocumentEditorSettings(),!(0,a.isNullOrUndefined)(e.documentEditorSettings.fontFamilies)){var r=e.documentEditorSettings.fontFamilies;this.refreshFontFamilies(r)}break;case"toolbarItems":this.toolbarModule&&this.toolbarModule.reInitToolbarItems(e.toolbarItems);break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType,"Continuous"===e.layoutType?this.statusBar.togglePageLayout():this.statusBar.toggleWebLayout());break;case"enableToolbar":this.createToolbarContainer(this.enableRtl,!0),e.enableToolbar&&this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment),this.toolbarModule.toggleTrackChanges(this.enableTrackChanges)),this.documentEditor&&this.documentEditor.resize();break;case"height":this.element.style.height=(0,a.formatUnit)(this.height),this.documentEditor&&this.documentEditor.resize(),this.resize();break;case"width":this.element.style.width=(0,a.formatUnit)(this.width),this.documentEditor&&this.documentEditor.resize();break;case"enableAutoFocus":this.documentEditor&&(this.documentEditor.enableAutoFocus=e.enableAutoFocus);break;case"autoResizeOnVisibilityChange":this.documentEditor&&(this.documentEditor.autoResizeOnVisibilityChange=e.autoResizeOnVisibilityChange)}}},t.prototype.preRender=function(){this.localObj=new a.L10n("documenteditorcontainer",this.defaultLocale,this.locale),(0,a.isNullOrUndefined)(this.element)||""!==this.element.id||(this.element.id=Pa.getUniqueElementId()),this.initContainerElement()},t.prototype.render=function(){this.toolbarModule&&(this.toolbarModule.initToolBar(this.toolbarItems),this.toolbarModule.enableDisableInsertComment(this.enableComment)),""!==this.height&&(this.element.style.height=(0,a.formatUnit)(this.height)),""!==this.width&&(this.element.style.width=(0,a.formatUnit)(this.width)),this.element.style.minHeight="320px",this.initializeDocumentEditor(),this.restrictEditing&&this.restrictEditingToggleHelper(this.restrictEditing),this.headerFooterProperties=new Cu(this,this.enableRtl),this.imageProperties=new xu(this,this.enableRtl),this.tocProperties=new Iu(this,this.enableRtl),this.tableProperties=new Su(this,this.imageProperties,this.enableRtl),this.statusBar=new Tu(this.statusBarElement,this),(0,el.createSpinner)({target:this.containerTarget,cssClass:"e-spin-overlay"}),this.setserverActionSettings(),this.renderComplete()},t.prototype.restrictEditingToggleHelper=function(e){this.documentEditor.isReadOnly=e,this.toolbarModule&&(this.toolbarModule.enableDisableToolBarItem(!e,!1),this.toolbarModule.toggleRestrictEditing(e)),this.showPropertiesPane=!e,this.showHidePropertiesPane(!e),this.documentEditor.trackChangesPane.enableDisableButton(!e&&!this.documentEditor.documentHelper.isDocumentProtected)},t.prototype.setFormat=function(){this.characterFormat&&this.documentEditor&&this.documentEditor.setDefaultCharacterFormat(this.characterFormat),this.paragraphFormat&&this.documentEditor&&this.documentEditor.setDefaultParagraphFormat(this.paragraphFormat),this.sectionFormat&&this.documentEditor&&this.documentEditor.setDefaultSectionFormat(this.sectionFormat)},t.prototype.setserverActionSettings=function(){this.serviceUrl&&(this.documentEditor.serviceUrl=Pa.sanitizeString(this.serviceUrl)),this.serverActionSettings.spellCheck&&(this.documentEditor.serverActionSettings.spellCheck=Pa.sanitizeString(this.serverActionSettings.spellCheck)),this.serverActionSettings.spellCheckByPage&&(this.documentEditor.serverActionSettings.spellCheckByPage=Pa.sanitizeString(this.serverActionSettings.spellCheckByPage)),this.serverActionSettings.restrictEditing&&(this.documentEditor.serverActionSettings.restrictEditing=Pa.sanitizeString(this.serverActionSettings.restrictEditing)),this.serverActionSettings.systemClipboard&&(this.documentEditor.serverActionSettings.systemClipboard=Pa.sanitizeString(this.serverActionSettings.systemClipboard)),this.serverActionSettings.import&&(this.documentEditor.serverActionSettingsImport=Pa.sanitizeString(this.serverActionSettings.import)),this.headers&&(this.documentEditor.headers=JSON.parse(Pa.sanitizeString(JSON.stringify(this.headers))))},t.prototype.customizeDocumentEditorSettings=function(){if(this.documentEditorSettings.formFieldSettings){var e=this.documentEditorSettings.formFieldSettings,t=this.documentEditor;(0,a.isNullOrUndefined)(e.applyShading)||(t.documentEditorSettings.formFieldSettings.applyShading=e.applyShading),(0,a.isNullOrUndefined)(e.formFillingMode)||(t.documentEditorSettings.formFieldSettings.formFillingMode=e.formFillingMode),(0,a.isNullOrUndefined)(e.formattingExceptions)||(t.documentEditorSettings.formFieldSettings.formattingExceptions=e.formattingExceptions),(0,a.isNullOrUndefined)(e.selectionColor)||(t.documentEditorSettings.formFieldSettings.selectionColor=e.selectionColor),(0,a.isNullOrUndefined)(e.shadingColor)||(t.documentEditorSettings.formFieldSettings.shadingColor=e.shadingColor)}this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=Pa.sanitizeString(this.documentEditorSettings.searchHighlightColor)),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=JSON.parse(Pa.sanitizeString(JSON.stringify(this.documentEditorSettings.fontFamilies)))),this.documentEditorSettings.collaborativeEditingSettings&&(this.documentEditor.documentEditorSettings.collaborativeEditingSettings=this.documentEditorSettings.collaborativeEditingSettings),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),(0,a.isNullOrUndefined)(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),(0,a.isNullOrUndefined)(this.documentEditorSettings.maximumRows)||(this.documentEditor.documentEditorSettings.maximumRows=this.documentEditorSettings.maximumRows),(0,a.isNullOrUndefined)(this.documentEditorSettings.maximumColumns)||(this.documentEditor.documentEditorSettings.maximumColumns=this.documentEditorSettings.maximumColumns),(0,a.isNullOrUndefined)(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks),(0,a.isNullOrUndefined)(this.documentEditorSettings.showBookmarks)||(this.documentEditor.documentEditorSettings.showBookmarks=this.documentEditorSettings.showBookmarks),(0,a.isNullOrUndefined)(this.documentEditorSettings.highlightEditableRanges)||(this.documentEditor.documentEditorSettings.highlightEditableRanges=this.documentEditorSettings.highlightEditableRanges),(0,a.isNullOrUndefined)(this.documentEditorSettings.allowDragAndDrop)||(this.documentEditor.documentEditorSettings.allowDragAndDrop=this.documentEditorSettings.allowDragAndDrop),(0,a.isNullOrUndefined)(this.documentEditorSettings.optimizeSfdt)||(this.documentEditor.documentEditorSettings.optimizeSfdt=this.documentEditorSettings.optimizeSfdt),(0,a.isNullOrUndefined)(this.documentEditorSettings.autoResizeSettings)||(this.documentEditor.documentEditorSettings.autoResizeSettings=this.documentEditorSettings.autoResizeSettings),(0,a.isNullOrUndefined)(this.documentEditorSettings.showRuler)||(this.documentEditor.documentEditorSettings.showRuler=this.documentEditorSettings.showRuler),(0,a.isNullOrUndefined)(this.documentEditorSettings.colorPickerSettings)||(this.documentEditor.documentEditorSettings.colorPickerSettings=this.documentEditorSettings.colorPickerSettings),(0,a.isNullOrUndefined)(this.documentEditorSettings.popupTarget)||(this.documentEditor.documentEditorSettings.popupTarget=this.documentEditorSettings.popupTarget),(0,a.isNullOrUndefined)(this.documentEditorSettings.showNavigationPane)||(this.documentEditor.documentEditorSettings.showNavigationPane=this.documentEditorSettings.showNavigationPane),(0,a.isNullOrUndefined)(this.documentEditorSettings.mentionSettings)||(this.documentEditor.documentEditorSettings.mentionSettings=this.documentEditorSettings.mentionSettings),(0,a.isNullOrUndefined)(this.documentEditorSettings.pasteAsNewParagraph)||(this.documentEditor.documentEditorSettings.pasteAsNewParagraph=this.documentEditorSettings.pasteAsNewParagraph)},t.prototype.getPersistData=function(){return"documenteditor-container"},t.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},t.prototype.initContainerElement=function(){var e,t=this.enableRtl;this.containerTarget=this.createElement("div",{className:"e-de-ctn"}),this.containerTarget.contentEditable="false",this.createToolbarContainer(t),e=t?"e-de-pane-rtl":"e-de-pane",this.propertiesPaneContainer=this.createElement("div",{className:e,styles:"display:none"}),this.editorContainer.appendChild(this.propertiesPaneContainer),this.containerTarget.appendChild(this.editorContainer),this.statusBarElement=this.createElement("div",{className:"e-de-status-bar"}),t&&(this.statusBarElement.style.direction="rtl"),this.containerTarget.appendChild(this.statusBarElement),this.element.appendChild(this.containerTarget)},t.prototype.createToolbarContainer=function(e,t){(0,a.isNullOrUndefined)(this.editorContainer)&&(this.editorContainer=this.createElement("div",{className:"e-de-tool-ctnr-properties-pane"+(e?" e-de-ctnr-rtl":"")})),this.enableToolbar?(this.toolbarContainer=this.createElement("div",{className:"e-de-ctnr-toolbar"+(e?" e-de-ctnr-rtl":"")}),t?this.containerTarget.insertBefore(this.toolbarContainer,this.containerTarget.firstChild):this.containerTarget.appendChild(this.toolbarContainer),this.editorContainer.classList.remove("e-de-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-tool-ctnr-properties-pane")):(this.editorContainer.classList.remove("e-de-tool-ctnr-properties-pane"),this.editorContainer.classList.add("e-de-ctnr-properties-pane"))},t.prototype.initializeDocumentEditor=function(){var e=this.element.id+"_editor",t=this.createElement("div",{id:e,styles:"width:100%;height:100%"});this.documentEditorInternal=new Ip({isReadOnly:!1,enableRtl:this.enableRtl,selectionChange:this.onSelectionChange.bind(this),contentChange:this.onContentChange.bind(this),documentChange:this.onDocumentChange.bind(this),requestNavigate:this.onRequestNavigate.bind(this),viewChange:this.onViewChange.bind(this),customContextMenuSelect:this.onCustomContextMenuSelect.bind(this),customContextMenuBeforeOpen:this.onCustomContextMenuBeforeOpen.bind(this),beforePaneSwitch:this.onBeforePaneSwitch.bind(this),commentBegin:this.onCommentBegin.bind(this),commentEnd:this.onCommentEnd.bind(this),commentDelete:this.onCommentDelete.bind(this),beforeAcceptRejectChanges:this.onBeforeAcceptRejectChanges.bind(this),beforeCommentAction:this.onCommentAction.bind(this),trackChange:this.onTrackChange.bind(this),serviceFailure:this.fireServiceFailure.bind(this),beforeXmlHttpRequestSend:this.beforeXmlHttpSend.bind(this),locale:this.locale,acceptTab:!0,zIndex:this.zIndex,enableLocalPaste:this.enableLocalPaste,layoutType:this.layoutType,pageOutline:"#E0E0E0",currentUser:this.currentUser,userColor:this.userColor,height:"100%",width:"100%",enableTrackChanges:this.enableTrackChanges,showRevisions:!0,showComments:!0,enableLockAndEdit:this.enableLockAndEdit,enableAutoFocus:this.enableAutoFocus}),this.wireEvents(),this.customizeDocumentEditorSettings(),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.editorContainer.insertBefore(t,this.editorContainer.firstChild),this.setFormat(),this.documentEditor.appendTo(t),this.documentEditor.resize()},t.prototype.wireEvents=function(){window.addEventListener("resize",this.onWindowResize.bind(this)),this.documentEditor.on(p,this.onZoomFactorChange,this),this.documentEditor.on(q,this.onViewChange,this),this.documentEditor.on(j,this.showPropertiesPaneOnSelection,this),this.documentEditor.on(G,this.updateShowHiddenMarks,this),this.documentEditor.on(K,this.updateStyleCollection,this),this.documentEditor.on(Z,this.triggerAutoResize,this),this.documentEditor.on(J,this.onBeforeAutoResize,this),this.documentEditor.on(Y,this.onEnableTrackChanges,this),this.documentEditor.on(Q,this.onOptionPaneChange,this)},t.prototype.onWindowResize=function(){(0,a.isNullOrUndefined)(this.documentEditor)||(this.documentEditor.isContainerResize=!0,this.resize())},t.prototype.onOptionPaneChange=function(e){},t.prototype.onEnableTrackChanges=function(e){e.enableTrackChanges!==this.enableTrackChanges&&(this.enableTrackChanges=e.enableTrackChanges)},t.prototype.triggerAutoResize=function(e){e.cancel=!0,this.resize()},t.prototype.onBeforeAutoResize=function(e){e.element=this.element},t.prototype.unWireEvents=function(){(0,a.isNullOrUndefined)(this.documentEditor)||this.documentEditor.isDestroyed||(this.documentEditor.off(p,this.onZoomFactorChange),this.documentEditor.off(q,this.onViewChange),this.documentEditor.off(j,this.showPropertiesPaneOnSelection),this.documentEditor.off(G,this.updateShowHiddenMarks),this.documentEditor.off(K,this.updateStyleCollection))},t.prototype.onCommentBegin=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(!1)},t.prototype.onCommentEnd=function(){this.toolbarModule&&this.toolbarModule.enableDisableInsertComment(this.enableComment)},t.prototype.beforeXmlHttpSend=function(e){this.trigger(_,e)},t.prototype.onCommentDelete=function(e){this.trigger(O,e)},t.prototype.onBeforeAcceptRejectChanges=function(e){this.trigger(B,e)},t.prototype.onCommentAction=function(e){this.trigger(W,e)},t.prototype.onTrackChange=function(e){this.trigger(M,e),this.toolbarModule&&this.toolbarModule.toggleTrackChanges(e.isTrackChangesEnabled)},t.prototype.onBeforePaneSwitch=function(e){this.trigger(L,e)},t.prototype.fireServiceFailure=function(e){this.trigger(I,e)},t.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.propertiesPaneContainer.style.display=e?"block":"none",this.toolbarModule&&(this.toolbarModule.propertiesPaneButton.element.style.opacity=e?"1":"0.5"),this.documentEditor.resize()},t.prototype.updateStyleCollection=function(){(0,a.isNullOrUndefined)(this.tableProperties)||(0,a.isNullOrUndefined)(this.tableProperties.tableTextProperties)||(0,a.isNullOrUndefined)(this.tableProperties.tableTextProperties.paragraph)||this.tableProperties.tableTextProperties.paragraph.updateStyleNames()},t.prototype.resize=function(e,t){this.element&&(this.documentEditor.isContainerResize||((0,a.isNullOrUndefined)(t)&&this.element&&this.element.parentElement&&(t=this.element.parentElement.clientHeight),(0,a.isNullOrUndefined)(e)&&this.element&&this.element.parentElement&&(e=this.element.parentElement.clientWidth),!(0,a.isNullOrUndefined)(e)&&e>200&&(this.width=e.toString(),this.element.style.width=e+"px"),!(0,a.isNullOrUndefined)(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px")),this.documentEditor&&this.documentEditor.resize(),this.toolbarModule&&this.toolbarModule.toolbar.refreshOverflow(),this.showPropertiesPane&&this.tableProperties.updateTabContainerHeight())},t.prototype.refreshFontFamilies=function(e){if(!(0,a.isNullOrUndefined)(this.tableProperties)&&!(0,a.isNullOrUndefined)(this.tableProperties.tableTextProperties)&&!(0,a.isNullOrUndefined)(this.tableProperties.tableTextProperties.text)){var t=this.tableProperties.tableTextProperties.text;t.fontFamily.refresh();for(var i=0;i<e.length;i++){var n=e[i],r={FontName:n,FontValue:n};t.fontFamily.addItem(r,i)}}},t.prototype.onContentChange=function(e){this.toolbarModule&&this.toolbarModule.enableDisableUndoRedo(),this.statusBar&&this.statusBar.updatePageCount();var t={source:this,operations:e.operations};this.trigger(u,t)},t.prototype.onDocumentChange=function(){if(this.enableTrackChanges=this.documentEditor.enableTrackChanges,(0,a.isNullOrUndefined)(this.documentSettings)||(0,a.isNullOrUndefined)(this.documentEditor)||(0,a.isNullOrUndefined)(this.documentEditor.documentSettings)||(this.documentSettings.compatibilityMode=this.documentEditor.documentSettings.compatibilityMode),!(0,a.isNullOrUndefined)(this.documentEditorSettings)&&!(0,a.isNullOrUndefined)(this.documentEditorSettings.fontFamilies)){var e=this.documentEditorSettings.fontFamilies;this.refreshFontFamilies(e)}this.toolbarModule&&(this.toolbarModule.isCommentEditing=!1,this.toolbarModule.enableDisableInsertComment(!0),this.toolbarModule.enableDisableUndoRedo()),this.statusBar&&this.statusBar.updatePageCount();var t={source:this};this.trigger(g,t),this.updateStyleCollection()},t.prototype.onSelectionChange=function(){var e=this;setTimeout((function(){if(!(0,a.isNullOrUndefined)(e.documentEditor)){e.showPropertiesPaneOnSelection();var t={source:e,isCompleted:e.documentEditor.documentHelper.isSelectionCompleted};e.trigger(v,t),e.documentEditor.documentHelper.isSelectionCompleted=!0}}))},t.prototype.onZoomFactorChange=function(){this.statusBar&&this.statusBar.updateZoomContent()},t.prototype.updateShowHiddenMarks=function(e){this.documentEditorSettings.showHiddenMarks=e.showHiddenMarks,this.tableProperties.tableTextProperties.paragraph.toggleHiddenMarks()},t.prototype.onRequestNavigate=function(e){if("Bookmark"!==e.linkType){var t=e.navigationLink,i=a.SanitizeHtmlHelper.sanitize(t);e.localReference.length>0&&(i+="#"+e.localReference),"file:///"===t.substring(0,8)||"http://"===t.substring(0,7)&&t.length>7||"https://"===t.substring(0,8)&&t.length>8||"www."===t.substring(0,4)&&t.length>4||"mailto:"===t.substring(0,7)&&t.length>7?window.open(i):el.DialogUtility.alert({title:this.localObj.getConstant("Information"),content:this.localObj.getConstant("The address of this site is not valid. Check the address and try again."),okButton:{text:this.localObj.getConstant("OK")},closeOnEscape:!0}),e.isHandled=!0}},t.prototype.onViewChange=function(e){this.statusBar&&this.statusBar.updatePageNumberOnViewChange(e)},t.prototype.onCustomContextMenuSelect=function(e){this.trigger(F,e)},t.prototype.onCustomContextMenuBeforeOpen=function(e){this.trigger(P,e)},t.prototype.showPropertiesPaneOnSelection=function(){if(!(this.restrictEditing&&!this.showPropertiesPane||(0,a.isNullOrUndefined)(this.tableProperties))){var e="NoProtection"!==this.documentEditor.documentHelper.protectionType,t=e&&this.documentEditor.documentHelper.restrictFormatting,i=this.documentEditor.editorModule.restrictEditing;if(e)this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(!i,!0),this.tableProperties.enableDisableElements(!t&&!i),this.tocProperties.enableDisableElements(!i),this.headerFooterProperties.enableDisableElements(!i),this.imageProperties.enableDisableElements(!i);else{var n=!this.documentEditor.isReadOnly;this.toolbarModule&&this.toolbarModule.enableDisableToolBarItem(n,!0),this.tableProperties.enableDisableElements(!0),this.tocProperties.enableDisableElements(!0),this.headerFooterProperties.enableDisableElements(!0),this.imageProperties.enableDisableElements(!0)}var r=this.documentEditor.selectionModule.contextType,o=r.indexOf("Header")>=0||r.indexOf("Footer")>=0;o||(this.showHeaderProperties=!0),this.showPropertiesPane?(this.propertiesPaneContainer.style.display="block",o&&this.showHeaderProperties?this.showProperties("headerfooter"):r.indexOf("List")>=0||r.indexOf("Text")>=0&&r.indexOf("Table")<0?this.showProperties("text"):r.indexOf("Image")>=0?this.showProperties("image"):r.indexOf("TableOfContents")>=0?this.showProperties("toc"):r.indexOf("Table")>=0&&this.showProperties("table")):(this.showHidePropertiesPane(!1),this.propertiesPaneContainer.style.display="none"),this.previousContext=this.documentEditor.selectionModule.contextType,this.toolbarModule&&this.toolbarModule.toolbar&&this.toolbarModule.enableDisableInsertComment(!this.documentEditor.enableHeaderAndFooter&&this.enableComment&&!this.documentEditor.isReadOnlyMode&&!this.documentEditor.selectionModule.isinFootnote&&!this.documentEditor.selectionModule.isinEndnote&&!this.documentEditor.selectionModule.isPlainContentControl())}},t.prototype.showProperties=function(e){this.toolbarModule&&"headerfooter"!==e&&"toc"!==e&&this.toolbarModule.enableDisablePropertyPaneButton(!0),this.tableProperties.showTableProperties("table"===e||"text"===e,e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},t.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=e,this.setFormat()},t.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=e,this.setFormat()},t.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=e,this.setFormat()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.element&&(this.refreshing||this.element.classList.remove("e-documenteditorcontainer"),this.element.innerHTML=""),this.refreshing||(this.element=void 0,this.paragraphFormat=void 0,this.sectionFormat=void 0,this.characterFormat=void 0),this.toolbarContainer&&this.toolbarContainer.parentElement&&(this.toolbarContainer.innerHTML="",this.toolbarContainer.parentElement.removeChild(this.toolbarContainer)),this.toolbarContainer=void 0,this.documentEditorInternal&&(this.unWireEvents(),this.documentEditorInternal.destroy(),this.documentEditorInternal=void 0),this.headerFooterProperties&&this.headerFooterProperties.destroy(),this.headerFooterProperties=void 0,this.imageProperties&&this.imageProperties.destroy(),this.imageProperties=void 0,this.tocProperties&&this.tocProperties.destroy(),this.tocProperties=void 0,this.tableProperties&&this.tableProperties.destroy(),this.tableProperties=void 0,this.statusBar&&this.statusBar.destroy(),this.propertiesPaneContainer&&this.propertiesPaneContainer.parentElement&&this.propertiesPaneContainer.remove(),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0,this.statusBar=void 0,this.previousContext=void 0},Eu([(0,a.Property)(!0)],t.prototype,"showPropertiesPane",void 0),Eu([(0,a.Property)(!0)],t.prototype,"enableToolbar",void 0),Eu([(0,a.Property)(!1)],t.prototype,"restrictEditing",void 0),Eu([(0,a.Property)(!1)],t.prototype,"enableSpellCheck",void 0),Eu([(0,a.Property)(!1)],t.prototype,"enableTrackChanges",void 0),Eu([(0,a.Property)("Pages")],t.prototype,"layoutType",void 0),Eu([(0,a.Property)("")],t.prototype,"currentUser",void 0),Eu([(0,a.Property)("#FFFF00")],t.prototype,"userColor",void 0),Eu([(0,a.Property)(!1)],t.prototype,"enableLocalPaste",void 0),Eu([(0,a.Property)()],t.prototype,"serviceUrl",void 0),Eu([(0,a.Property)(2e3)],t.prototype,"zIndex",void 0),Eu([(0,a.Property)(!1)],t.prototype,"enableCsp",void 0),Eu([(0,a.Property)(!0)],t.prototype,"enableComment",void 0),Eu([(0,a.Property)("100%")],t.prototype,"width",void 0),Eu([(0,a.Property)("320px")],t.prototype,"height",void 0),Eu([(0,a.Property)(!0)],t.prototype,"enableAutoFocus",void 0),Eu([(0,a.Property)(!1)],t.prototype,"enableLockAndEdit",void 0),Eu([(0,a.Property)(!1)],t.prototype,"autoResizeOnVisibilityChange",void 0),Eu([(0,a.Event)()],t.prototype,"created",void 0),Eu([(0,a.Event)()],t.prototype,"destroyed",void 0),Eu([(0,a.Event)()],t.prototype,"contentChange",void 0),Eu([(0,a.Event)()],t.prototype,"selectionChange",void 0),Eu([(0,a.Event)()],t.prototype,"documentChange",void 0),Eu([(0,a.Event)()],t.prototype,"toolbarClick",void 0),Eu([(0,a.Event)()],t.prototype,"customContextMenuSelect",void 0),Eu([(0,a.Event)()],t.prototype,"customContextMenuBeforeOpen",void 0),Eu([(0,a.Event)()],t.prototype,"beforePaneSwitch",void 0),Eu([(0,a.Event)()],t.prototype,"commentDelete",void 0),Eu([(0,a.Event)()],t.prototype,"beforeAcceptRejectChanges",void 0),Eu([(0,a.Event)()],t.prototype,"beforeCommentAction",void 0),Eu([(0,a.Event)()],t.prototype,"serviceFailure",void 0),Eu([(0,a.Event)()],t.prototype,"trackChange",void 0),Eu([(0,a.Event)()],t.prototype,"contentControl",void 0),Eu([(0,a.Event)()],t.prototype,"beforeXmlHttpRequestSend",void 0),Eu([(0,a.Complex)({},bp)],t.prototype,"documentEditorSettings",void 0),Eu([(0,a.Complex)({},Cp)],t.prototype,"documentSettings",void 0),Eu([(0,a.Property)({import:"Import",systemClipboard:"SystemClipboard",spellCheck:"SpellCheck",spellCheckByPage:"SpellCheckByPage",restrictEditing:"RestrictEditing",canLock:"CanLock",getPendingActions:"GetPendingActions"})],t.prototype,"serverActionSettings",void 0),Eu([(0,a.Property)(["New","Open","Separator","Undo","Redo","Separator","Image","Table","Hyperlink","Bookmark","TableOfContents","Separator","Header","Footer","PageSetup","PageNumber","Break","InsertFootnote","InsertEndnote","Separator","Find","Separator","Comments","TrackChanges","Separator","LocalClipboard","RestrictEditing","Separator","FormFields","UpdateFields","ContentControl","XML Mapping"])],t.prototype,"toolbarItems",void 0),Eu([(0,a.Property)([])],t.prototype,"headers",void 0),t=Eu([a.NotifyPropertyChanges],t)}(a.Component)})(),f})()));